var OGVDemuxerOggW=(()=>{var e="undefined"!=typeof document?document.currentScript?.src:void 0;return"undefined"!=typeof __filename&&(e||=__filename),function(t={}){var n,r,i,o,a,u=t,s=new Promise(((e,t)=>{n=e,r=t})),f=Object.assign({},u),c="object"==typeof window,d="function"==typeof importScripts,l="object"==typeof process&&"object"==typeof process.versions&&"string"==typeof process.versions.node,m="";if(l){var p=require("fs"),_=require("path");m=d?_.dirname(m)+"/":__dirname+"/",i=(e,t)=>(e=I(e)?new URL(e):_.normalize(e),p.readFileSync(e,t?void 0:"utf8")),a=e=>((e=i(e,!0)).buffer||(e=new Uint8Array(e)),e),o=(e,t,n,r=!0)=>{e=I(e)?new URL(e):_.normalize(e),p.readFile(e,r?void 0:"utf8",((e,i)=>{e?n(e):t(r?i.buffer:i)}))},process.argv.slice(2)}else(c||d)&&(d?m=self.location.href:"undefined"!=typeof document&&document.currentScript&&(m=document.currentScript.src),e&&(m=e),m=m.startsWith("blob:")?"":m.substr(0,m.replace(/[?#].*/,"").lastIndexOf("/")+1),i=e=>{var t=new XMLHttpRequest;return t.open("GET",e,!1),t.send(null),t.responseText},d&&(a=e=>{var t=new XMLHttpRequest;return t.open("GET",e,!1),t.responseType="arraybuffer",t.send(null),new Uint8Array(t.response)}),o=(e,t,n)=>{var r=new XMLHttpRequest;r.open("GET",e,!0),r.responseType="arraybuffer",r.onload=()=>{200==r.status||0==r.status&&r.response?t(r.response):n()},r.onerror=n,r.send(null)});u.print||function(){}.bind();var v,y=u.printErr||function(){}.bind();Object.assign(u,f),f=null,u.wasmBinary&&(v=u.wasmBinary);var g,h,b=!1;function k(){var e=g.buffer;u.HEAP8=new Int8Array(e),u.HEAP16=new Int16Array(e),u.HEAPU8=h=new Uint8Array(e),u.HEAPU16=new Uint16Array(e),u.HEAP32=new Int32Array(e),u.HEAPU32=new Uint32Array(e),u.HEAPF32=new Float32Array(e),u.HEAPF64=new Float64Array(e)}var P=[],w=[],x=[];function A(){var e=u.preRun.shift();P.unshift(e)}var R,O=0,U=null,j=null,T=e=>e.startsWith("data:application/octet-stream;base64,"),I=e=>e.startsWith("file://");if(!T(R="ogv-demuxer-ogg-wasm.wasm")){var E=R;R=u.locateFile?u.locateFile(E,m):m+E}function S(e){if(e==R&&v)return new Uint8Array(v);if(a)return a(e);throw"both async and sync fetching of the wasm failed"}function W(e,t,n){return function(e){if(!v&&(c||d)){if("function"==typeof fetch&&!I(e))return fetch(e,{credentials:"same-origin"}).then((t=>{if(!t.ok)throw`failed to load wasm binary file at '${e}'`;return t.arrayBuffer()})).catch((()=>S(e)));if(o)return new Promise(((t,n)=>{o(e,(e=>t(new Uint8Array(e))),n)}))}return Promise.resolve().then((()=>S(e)))}(e).then((e=>WebAssembly.instantiate(e,t))).then(n,(e=>{throw y(`failed to asynchronously prepare wasm: ${e}`),u.onAbort?.(e),y(e="Aborted("+e+")"),b=!0,e=new WebAssembly.RuntimeError(e+". Build with -sASSERTIONS for more info."),r(e),e}))}var H,M,q,C,F=e=>{for(;0<e.length;)e.shift()(u)},L={f:(e,t,n)=>h.copyWithin(e,t,t+n),d:e=>{var t=h.length;if(2147483648<(e>>>=0))return!1;for(var n=1;4>=n;n*=2){var r=t*(1+.2/n);r=Math.min(r,e+100663296);var i=Math;r=Math.max(e,r);e:{i=(i.min.call(i,2147483648,r+(65536-r%65536)%65536)-g.buffer.byteLength+65535)/65536;try{g.grow(i),k();var o=1;break e}catch(e){}o=void 0}if(o)return!0}return!1},e:()=>52,a:function(e,t,n,r){var i=g.buffer;u.audioPackets.push({data:i.slice?i.slice(e,e+t):new Uint8Array(new Uint8Array(i,e,t)).buffer,timestamp:n,discardPadding:r})},c:function(e,t){function n(e){for(var t="",n=new Uint8Array(g.buffer);0!=n[e];e++)t+=String.fromCharCode(n[e]);return t}e&&(u.videoCodec=n(e)),t&&(u.audioCodec=n(t)),e=u._ogv_demuxer_media_duration(),u.duration=0<=e?e:NaN,u.loadedMetadata=!0},b:function(e,t,n,r,i){var o=g.buffer;u.videoPackets.push({data:o.slice?o.slice(e,e+t):new Uint8Array(new Uint8Array(o,e,t)).buffer,timestamp:n,keyframeTimestamp:r,isKeyframe:!!i})}},D=function(){function e(e){return D=e.exports,g=D.g,k(),w.unshift(D.h),O--,u.monitorRunDependencies?.(O),0==O&&(null!==U&&(clearInterval(U),U=null),j&&(e=j,j=null,e())),D}var t={a:L};if(O++,u.monitorRunDependencies?.(O),u.instantiateWasm)try{return u.instantiateWasm(t,e)}catch(e){y(`Module.instantiateWasm callback failed with error: ${e}`),r(e)}return function(e,t){var n=R;return v||"function"!=typeof WebAssembly.instantiateStreaming||T(n)||I(n)||l||"function"!=typeof fetch?W(n,e,t):fetch(n,{credentials:"same-origin"}).then((r=>WebAssembly.instantiateStreaming(r,e).then(t,(function(r){return y(`wasm streaming compile failed: ${r}`),y("falling back to ArrayBuffer instantiation"),W(n,e,t)}))))}(t,(function(t){e(t.instance)})).catch(r),{}}();function G(){function e(){if(!H&&(H=!0,u.calledRun=!0,!b)){if(F(w),n(u),u.onRuntimeInitialized&&u.onRuntimeInitialized(),u.postRun)for("function"==typeof u.postRun&&(u.postRun=[u.postRun]);u.postRun.length;){var e=u.postRun.shift();x.unshift(e)}F(x)}}if(!(0<O)){if(u.preRun)for("function"==typeof u.preRun&&(u.preRun=[u.preRun]);u.preRun.length;)A();F(P),0<O||(u.setStatus?(u.setStatus("Running..."),setTimeout((function(){setTimeout((function(){u.setStatus("")}),1),e()}),1)):e())}}if(u._ogv_demuxer_init=()=>(u._ogv_demuxer_init=D.i)(),u._ogv_demuxer_receive_input=(e,t)=>(u._ogv_demuxer_receive_input=D.j)(e,t),u._ogv_demuxer_process=()=>(u._ogv_demuxer_process=D.k)(),u._ogv_demuxer_destroy=()=>(u._ogv_demuxer_destroy=D.l)(),u._ogv_demuxer_media_length=()=>(u._ogv_demuxer_media_length=D.m)(),u._ogv_demuxer_media_duration=()=>(u._ogv_demuxer_media_duration=D.n)(),u._ogv_demuxer_seekable=()=>(u._ogv_demuxer_seekable=D.o)(),u._ogv_demuxer_keypoint_offset=e=>(u._ogv_demuxer_keypoint_offset=D.p)(e),u._ogv_demuxer_seek_to_keypoint=e=>(u._ogv_demuxer_seek_to_keypoint=D.q)(e),u._ogv_demuxer_flush=()=>(u._ogv_demuxer_flush=D.r)(),u._malloc=e=>(u._malloc=D.t)(e),u._free=e=>(u._free=D.u)(e),j=function e(){H||G(),H||(j=e)},u.preInit)for("function"==typeof u.preInit&&(u.preInit=[u.preInit]);0<u.preInit.length;)u.preInit.pop()();function B(e){var t=C();return e=e(),t=C()-t,u.cpuTime+=t,e}return G(),C="undefined"==typeof performance||void 0===performance.now?Date.now:performance.now.bind(performance),u.loadedMetadata=!1,u.videoCodec=null,u.audioCodec=null,u.duration=NaN,u.onseek=null,u.cpuTime=0,u.audioPackets=[],Object.defineProperty(u,"hasAudio",{get:function(){return u.loadedMetadata&&u.audioCodec}}),Object.defineProperty(u,"audioReady",{get:function(){return 0<u.audioPackets.length}}),Object.defineProperty(u,"audioTimestamp",{get:function(){return 0<u.audioPackets.length?u.audioPackets[0].timestamp:-1}}),u.videoPackets=[],Object.defineProperty(u,"hasVideo",{get:function(){return u.loadedMetadata&&u.videoCodec}}),Object.defineProperty(u,"frameReady",{get:function(){return 0<u.videoPackets.length}}),Object.defineProperty(u,"frameTimestamp",{get:function(){return 0<u.videoPackets.length?u.videoPackets[0].timestamp:-1}}),Object.defineProperty(u,"keyframeTimestamp",{get:function(){return 0<u.videoPackets.length?u.videoPackets[0].keyframeTimestamp:-1}}),Object.defineProperty(u,"nextKeyframeTimestamp",{get:function(){for(var e=0;e<u.videoPackets.length;e++){var t=u.videoPackets[e];if(t.isKeyframe)return t.timestamp}return-1}}),Object.defineProperty(u,"processing",{get:function(){return!1}}),Object.defineProperty(u,"seekable",{get:function(){return!!u._ogv_demuxer_seekable()}}),u.init=function(e){B((function(){u._ogv_demuxer_init()})),e()},u.receiveInput=function(e,t){B((function(){var t=e.byteLength;M&&q>=t||(M&&u._free(M),q=t,M=u._malloc(q));var n=M;new Uint8Array(g.buffer,n,t).set(new Uint8Array(e)),u._ogv_demuxer_receive_input(n,t)})),t()},u.process=function(e){e(!!B((function(){return u._ogv_demuxer_process()})))},u.dequeueVideoPacket=function(e){u.videoPackets.length?e(u.videoPackets.shift().data):e(null)},u.dequeueAudioPacket=function(e){if(u.audioPackets.length){var t=u.audioPackets.shift();e(t.data,t.discardPadding)}else e(null)},u.getKeypointOffset=function(e,t){t(B((function(){return u._ogv_demuxer_keypoint_offset(1e3*e)})))},u.seekToKeypoint=function(e,t){var n=B((function(){return u._ogv_demuxer_seek_to_keypoint(1e3*e)}));n&&(u.audioPackets.splice(0,u.audioPackets.length),u.videoPackets.splice(0,u.videoPackets.length)),t(!!n)},u.flush=function(e){B((function(){u.audioPackets.splice(0,u.audioPackets.length),u.videoPackets.splice(0,u.videoPackets.length),u._ogv_demuxer_flush()})),e()},u.close=function(){},s}})();"object"==typeof exports&&"object"==typeof module?module.exports=OGVDemuxerOggW:"function"==typeof define&&define.amd&&define([],(()=>OGVDemuxerOggW));