var OGVDecoderVideoAV1W=(()=>{var e="undefined"!=typeof document?document.currentScript?.src:void 0;return"undefined"!=typeof __filename&&(e||=__filename),function(r={}){var n,t,o,i,a,f=r,s=new Promise(((e,r)=>{n=e,t=r})),c=Object.assign({},f),u="object"==typeof window,d="function"==typeof importScripts,p="object"==typeof process&&"object"==typeof process.versions&&"string"==typeof process.versions.node,l="";if(p){var v=require("fs"),y=require("path");l=d?y.dirname(l)+"/":__dirname+"/",o=(e,r)=>(e=j(e)?new URL(e):y.normalize(e),v.readFileSync(e,r?void 0:"utf8")),a=e=>((e=o(e,!0)).buffer||(e=new Uint8Array(e)),e),i=(e,r,n,t=!0)=>{e=j(e)?new URL(e):y.normalize(e),v.readFile(e,t?void 0:"utf8",((e,o)=>{e?n(e):r(t?o.buffer:o)}))},process.argv.slice(2)}else(u||d)&&(d?l=self.location.href:"undefined"!=typeof document&&document.currentScript&&(l=document.currentScript.src),e&&(l=e),l=l.startsWith("blob:")?"":l.substr(0,l.replace(/[?#].*/,"").lastIndexOf("/")+1),o=e=>{var r=new XMLHttpRequest;return r.open("GET",e,!1),r.send(null),r.responseText},d&&(a=e=>{var r=new XMLHttpRequest;return r.open("GET",e,!1),r.responseType="arraybuffer",r.send(null),new Uint8Array(r.response)}),i=(e,r,n)=>{var t=new XMLHttpRequest;t.open("GET",e,!0),t.responseType="arraybuffer",t.onload=()=>{200==t.status||0==t.status&&t.response?r(t.response):n()},t.onerror=n,t.send(null)});var h,m=f.print||function(){}.bind(),_=f.printErr||function(){}.bind();Object.assign(f,c),c=null,f.wasmBinary&&(h=f.wasmBinary);var g,b,w,A=!1;function R(){var e=g.buffer;f.HEAP8=new Int8Array(e),f.HEAP16=new Int16Array(e),f.HEAPU8=b=new Uint8Array(e),f.HEAPU16=new Uint16Array(e),f.HEAP32=new Int32Array(e),f.HEAPU32=w=new Uint32Array(e),f.HEAPF32=new Float32Array(e),f.HEAPF64=new Float64Array(e)}var W=[],H=[],U=[];function F(){var e=f.preRun.shift();W.unshift(e)}var S=0,T=null,E=null;function I(e){throw f.onAbort?.(e),_(e="Aborted("+e+")"),A=!0,e=new WebAssembly.RuntimeError(e+". Build with -sASSERTIONS for more info."),t(e),e}var P,L=e=>e.startsWith("data:application/octet-stream;base64,"),j=e=>e.startsWith("file://");if(!L(P="ogv-decoder-video-av1-wasm.wasm")){var V=P;P=f.locateFile?f.locateFile(V,l):l+V}function x(e){if(e==P&&h)return new Uint8Array(h);if(a)return a(e);throw"both async and sync fetching of the wasm failed"}function C(e,r,n){return function(e){if(!h&&(u||d)){if("function"==typeof fetch&&!j(e))return fetch(e,{credentials:"same-origin"}).then((r=>{if(!r.ok)throw`failed to load wasm binary file at '${e}'`;return r.arrayBuffer()})).catch((()=>x(e)));if(i)return new Promise(((r,n)=>{i(e,(e=>r(new Uint8Array(e))),n)}))}return Promise.resolve().then((()=>x(e)))}(e).then((e=>WebAssembly.instantiate(e,r))).then(n,(e=>{_(`failed to asynchronously prepare wasm: ${e}`),I(e)}))}var D,M,O,B,k=e=>{for(;0<e.length;)e.shift()(f)},q=[null,[],[]],G="undefined"!=typeof TextDecoder?new TextDecoder("utf8"):void 0,z={e:(e,r,n)=>b.copyWithin(e,r,r+n),f:()=>{I("")},c:e=>{var r=b.length;if(2147483648<(e>>>=0))return!1;for(var n=1;4>=n;n*=2){var t=r*(1+.2/n);t=Math.min(t,e+100663296);var o=Math;t=Math.max(e,t);e:{o=(o.min.call(o,2147483648,t+(65536-t%65536)%65536)-g.buffer.byteLength+65535)/65536;try{g.grow(o),R();var i=1;break e}catch(e){}i=void 0}if(i)return!0}return!1},d:()=>52,b:function(){return 70},a:(e,r,n,t)=>{for(var o=0,i=0;i<n;i++){var a=w[r>>2],f=w[r+4>>2];r+=8;for(var s=0;s<f;s++){var c=b[a+s],u=q[e];if(0===c||10===c){c=u;for(var d=0,p=d+NaN,l=d;c[l]&&!(l>=p);)++l;if(16<l-d&&c.buffer&&G)c=G.decode(c.subarray(d,l));else{for(p="";d<l;){var v=c[d++];if(128&v){var y=63&c[d++];if(192==(224&v))p+=String.fromCharCode((31&v)<<6|y);else{var h=63&c[d++];65536>(v=224==(240&v)?(15&v)<<12|y<<6|h:(7&v)<<18|y<<12|h<<6|63&c[d++])?p+=String.fromCharCode(v):(v-=65536,p+=String.fromCharCode(55296|v>>10,56320|1023&v))}}else p+=String.fromCharCode(v)}c=p}(1===e?m:_)(c),u.length=0}else u.push(c)}o+=f}return w[t>>2]=o,0},g:function(e,r,n,t,o,i,a,s,c,u,d,p,l,v,y,h){function m(e,r,n,t,o,i,a,f,s){var c,u;for(e.set(new Uint8Array(_,r,n*t)),c=u=0;c<i;c++,u+=n)for(r=0;r<n;r++)e[u+r]=s;for(;c<i+f;c++,u+=n){for(r=0;r<o;r++)e[u+r]=s;for(r=o+a;r<n;r++)e[u+r]=s}for(;c<t;c++,u+=n)for(r=0;r<n;r++)e[u+r]=s;return e}var _=g.buffer,b=f.videoFormat,w=(-2&l)*c/a,A=(-2&v)*u/s,R=d*c/a,W=p*u/s;d===b.cropWidth&&p===b.cropHeight&&(y=b.displayWidth,h=b.displayHeight);for(var H,U=f.recycledFrames,F=s*r,S=u*t,T=u*i;0<U.length;){var E=U.shift();if((b=E.format).width===a&&b.height===s&&b.chromaWidth===c&&b.chromaHeight===u&&b.cropLeft===l&&b.cropTop===v&&b.cropWidth===d&&b.cropHeight===p&&b.displayWidth===y&&b.displayHeight===h&&E.y.bytes.length===F&&E.u.bytes.length===S&&E.v.bytes.length===T){H=E;break}}H||={format:{width:a,height:s,chromaWidth:c,chromaHeight:u,cropLeft:l,cropTop:v,cropWidth:d,cropHeight:p,displayWidth:y,displayHeight:h},y:{bytes:new Uint8Array(F),stride:r},u:{bytes:new Uint8Array(S),stride:t},v:{bytes:new Uint8Array(T),stride:i}},m(H.y.bytes,e,r,s,l,v,d,p,0),m(H.u.bytes,n,t,u,w,A,R,W,128),m(H.v.bytes,o,i,u,w,A,R,W,128),f.frameBuffer=H}},$=function(){function e(e){return $=e.exports,g=$.h,R(),H.unshift($.i),S--,f.monitorRunDependencies?.(S),0==S&&(null!==T&&(clearInterval(T),T=null),E&&(e=E,E=null,e())),$}var r={a:z};if(S++,f.monitorRunDependencies?.(S),f.instantiateWasm)try{return f.instantiateWasm(r,e)}catch(e){_(`Module.instantiateWasm callback failed with error: ${e}`),t(e)}return function(e,r){var n=P;return h||"function"!=typeof WebAssembly.instantiateStreaming||L(n)||j(n)||p||"function"!=typeof fetch?C(n,e,r):fetch(n,{credentials:"same-origin"}).then((t=>WebAssembly.instantiateStreaming(t,e).then(r,(function(t){return _(`wasm streaming compile failed: ${t}`),_("falling back to ArrayBuffer instantiation"),C(n,e,r)}))))}(r,(function(r){e(r.instance)})).catch(t),{}}();function N(){function e(){if(!D&&(D=!0,f.calledRun=!0,!A)){if(k(H),n(f),f.onRuntimeInitialized&&f.onRuntimeInitialized(),f.postRun)for("function"==typeof f.postRun&&(f.postRun=[f.postRun]);f.postRun.length;){var e=f.postRun.shift();U.unshift(e)}k(U)}}if(!(0<S)){if(f.preRun)for("function"==typeof f.preRun&&(f.preRun=[f.preRun]);f.preRun.length;)F();k(W),0<S||(f.setStatus?(f.setStatus("Running..."),setTimeout((function(){setTimeout((function(){f.setStatus("")}),1),e()}),1)):e())}}if(f._ogv_video_decoder_init=()=>(f._ogv_video_decoder_init=$.j)(),f._ogv_video_decoder_async=()=>(f._ogv_video_decoder_async=$.k)(),f._ogv_video_decoder_destroy=()=>(f._ogv_video_decoder_destroy=$.l)(),f._ogv_video_decoder_process_header=(e,r)=>(f._ogv_video_decoder_process_header=$.m)(e,r),f._ogv_video_decoder_process_frame=(e,r)=>(f._ogv_video_decoder_process_frame=$.n)(e,r),f._free=e=>(f._free=$.o)(e),f._malloc=e=>(f._malloc=$.q)(e),E=function e(){D||N(),D||(E=e)},f.preInit)for("function"==typeof f.preInit&&(f.preInit=[f.preInit]);0<f.preInit.length;)f.preInit.pop()();function X(e){var r=B();return e=e(),f.cpuTime+=B()-r,e}return N(),B="undefined"==typeof performance||void 0===performance.now?Date.now:performance.now.bind(performance),f.loadedMetadata=!!f.videoFormat,f.videoFormat=f.videoFormat||null,f.frameBuffer=null,f.cpuTime=0,Object.defineProperty(f,"processing",{get:function(){return!1}}),f.init=function(e){X((function(){f._ogv_video_decoder_init()})),e()},f.processHeader=function(e,r){r(X((function(){var r=e.byteLength;M&&O>=r||(M&&f._free(M),O=r,M=f._malloc(O));var n=M;return new Uint8Array(g.buffer,n,r).set(new Uint8Array(e)),f._ogv_video_decoder_process_header(n,r)})))},f.s=[],f.processFrame=function(e,r){function n(e){f._free(i),r(e)}var t=f._ogv_video_decoder_async(),o=e.byteLength,i=f._malloc(o);t&&f.s.push(n);var a=X((function(){return new Uint8Array(g.buffer,i,o).set(new Uint8Array(e)),f._ogv_video_decoder_process_frame(i,o)}));t||n(a)},f.close=function(){},f.sync=function(){f._ogv_video_decoder_async()&&(f.s.push((function(){})),X((function(){f._ogv_video_decoder_process_frame(0,0)})))},f.recycledFrames=[],f.recycleFrame=function(e){var r=f.recycledFrames;r.push(e),16<r.length&&r.shift()},s}})();"object"==typeof exports&&"object"==typeof module?module.exports=OGVDecoderVideoAV1W:"function"==typeof define&&define.amd&&define([],(()=>OGVDecoderVideoAV1W));