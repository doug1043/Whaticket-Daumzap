var OGVDecoderVideoTheoraW=(()=>{var e="undefined"!=typeof document?document.currentScript?.src:void 0;return"undefined"!=typeof __filename&&(e||=__filename),function(r={}){var t,n,o,i,a,s=r,c=new Promise((e,r)=>{t=e,n=r}),f=Object.assign({},s),d="object"==typeof window,u="function"==typeof importScripts,p="object"==typeof process&&"object"==typeof process.versions&&"string"==typeof process.versions.node,l="";if(p){var h=require("fs"),y=require("path");l=u?y.dirname(l)+"/":__dirname+"/",o=(e,r)=>(e=S(e)?new URL(e):y.normalize(e),h.readFileSync(e,r?void 0:"utf8")),a=e=>((e=o(e,!0)).buffer||(e=new Uint8Array(e)),e),i=(e,r,t,n=!0)=>{e=S(e)?new URL(e):y.normalize(e),h.readFile(e,n?void 0:"utf8",(e,o)=>{e?t(e):r(n?o.buffer:o)})},process.argv.slice(2)}else(d||u)&&(u?l=self.location.href:"undefined"!=typeof document&&document.currentScript&&(l=document.currentScript.src),e&&(l=e),l=l.startsWith("blob:")?"":l.substr(0,l.replace(/[?#].*/,"").lastIndexOf("/")+1),o=e=>{var r=new XMLHttpRequest;return r.open("GET",e,!1),r.send(null),r.responseText},u&&(a=e=>{var r=new XMLHttpRequest;return r.open("GET",e,!1),r.responseType="arraybuffer",r.send(null),new Uint8Array(r.response)}),i=(e,r,t)=>{var n=new XMLHttpRequest;n.open("GET",e,!0),n.responseType="arraybuffer",n.onload=()=>{200==n.status||0==n.status&&n.response?r(n.response):t()},n.onerror=t,n.send(null)});s.print||function(){}.bind();var m,v=s.printErr||function(){}.bind();Object.assign(s,f),f=null,s.wasmBinary&&(m=s.wasmBinary);var _,g,b=!1;function w(){var e=_.buffer;s.HEAP8=new Int8Array(e),s.HEAP16=new Int16Array(e),s.HEAPU8=g=new Uint8Array(e),s.HEAPU16=new Uint16Array(e),s.HEAP32=new Int32Array(e),s.HEAPU32=new Uint32Array(e),s.HEAPF32=new Float32Array(e),s.HEAPF64=new Float64Array(e)}var A=[],R=[],W=[];function H(){var e=s.preRun.shift();A.unshift(e)}var U,F=0,T=null,E=null,I=e=>e.startsWith("data:application/octet-stream;base64,"),S=e=>e.startsWith("file://");if(!I(U="ogv-decoder-video-theora-wasm.wasm")){var P=U;U=s.locateFile?s.locateFile(P,l):l+P}function L(e){if(e==U&&m)return new Uint8Array(m);if(a)return a(e);throw"both async and sync fetching of the wasm failed"}function j(e,r,t){return function(e){if(!m&&(d||u)){if("function"==typeof fetch&&!S(e))return fetch(e,{credentials:"same-origin"}).then(r=>{if(!r.ok)throw`failed to load wasm binary file at '${e}'`;return r.arrayBuffer()}).catch(()=>L(e));if(i)return new Promise((r,t)=>{i(e,e=>r(new Uint8Array(e)),t)})}return Promise.resolve().then(()=>L(e))}(e).then(e=>WebAssembly.instantiate(e,r)).then(t,e=>{throw v(`failed to asynchronously prepare wasm: ${e}`),s.onAbort?.(e),v(e="Aborted("+e+")"),b=!0,e=new WebAssembly.RuntimeError(e+". Build with -sASSERTIONS for more info."),n(e),e})}var M,O,B,k,x=e=>{for(;0<e.length;)e.shift()(s)},D={b:(e,r,t)=>g.copyWithin(e,r,r+t),a:e=>{var r=g.length;if(2147483648<(e>>>=0))return!1;for(var t=1;4>=t;t*=2){var n=r*(1+.2/t);n=Math.min(n,e+100663296);var o=Math;n=Math.max(e,n);e:{o=(o.min.call(o,2147483648,n+(65536-n%65536)%65536)-_.buffer.byteLength+65535)/65536;try{_.grow(o),w();var i=1;break e}catch(e){}i=void 0}if(i)return!0}return!1},c:function(e,r,t,n,o,i,a,c,f,d,u,p,l,h,y,m){function v(e,r,t,n,o,i,a,s,c){var f,d;for(e.set(new Uint8Array(g,r,t*n)),f=d=0;f<i;f++,d+=t)for(r=0;r<t;r++)e[d+r]=c;for(;f<i+s;f++,d+=t){for(r=0;r<o;r++)e[d+r]=c;for(r=o+a;r<t;r++)e[d+r]=c}for(;f<n;f++,d+=t)for(r=0;r<t;r++)e[d+r]=c;return e}var g=_.buffer,b=s.videoFormat,w=(-2&l)*f/a,A=(-2&h)*d/c,R=u*f/a,W=p*d/c;u===b.cropWidth&&p===b.cropHeight&&(y=b.displayWidth,m=b.displayHeight);for(var H,U=s.recycledFrames,F=c*r,T=d*n,E=d*i;0<U.length;){var I=U.shift();if((b=I.format).width===a&&b.height===c&&b.chromaWidth===f&&b.chromaHeight===d&&b.cropLeft===l&&b.cropTop===h&&b.cropWidth===u&&b.cropHeight===p&&b.displayWidth===y&&b.displayHeight===m&&I.y.bytes.length===F&&I.u.bytes.length===T&&I.v.bytes.length===E){H=I;break}}H||={format:{width:a,height:c,chromaWidth:f,chromaHeight:d,cropLeft:l,cropTop:h,cropWidth:u,cropHeight:p,displayWidth:y,displayHeight:m},y:{bytes:new Uint8Array(F),stride:r},u:{bytes:new Uint8Array(T),stride:n},v:{bytes:new Uint8Array(E),stride:i}},v(H.y.bytes,e,r,c,l,h,u,p,0),v(H.u.bytes,t,n,d,w,A,R,W,128),v(H.v.bytes,o,i,d,w,A,R,W,128),s.frameBuffer=H},d:function(e,r,t,n,o,i,a,c,f,d,u){s.videoFormat={width:e,height:r,chromaWidth:t,chromaHeight:n,cropLeft:c,cropTop:f,cropWidth:i,cropHeight:a,displayWidth:d,displayHeight:u,fps:o},s.loadedMetadata=!0}},G=function(){function e(e){return G=e.exports,_=G.e,w(),R.unshift(G.f),F--,s.monitorRunDependencies?.(F),0==F&&(null!==T&&(clearInterval(T),T=null),E&&(e=E,E=null,e())),G}var r={a:D};if(F++,s.monitorRunDependencies?.(F),s.instantiateWasm)try{return s.instantiateWasm(r,e)}catch(e){v(`Module.instantiateWasm callback failed with error: ${e}`),n(e)}return function(e,r){var t=U;return m||"function"!=typeof WebAssembly.instantiateStreaming||I(t)||S(t)||p||"function"!=typeof fetch?j(t,e,r):fetch(t,{credentials:"same-origin"}).then(n=>WebAssembly.instantiateStreaming(n,e).then(r,function(n){return v(`wasm streaming compile failed: ${n}`),v("falling back to ArrayBuffer instantiation"),j(t,e,r)}))}(r,function(r){e(r.instance)}).catch(n),{}}();function V(){function e(){if(!M&&(M=!0,s.calledRun=!0,!b)){if(x(R),t(s),s.onRuntimeInitialized&&s.onRuntimeInitialized(),s.postRun)for("function"==typeof s.postRun&&(s.postRun=[s.postRun]);s.postRun.length;){var e=s.postRun.shift();W.unshift(e)}x(W)}}if(!(0<F)){if(s.preRun)for("function"==typeof s.preRun&&(s.preRun=[s.preRun]);s.preRun.length;)H();x(A),0<F||(s.setStatus?(s.setStatus("Running..."),setTimeout(function(){setTimeout(function(){s.setStatus("")},1),e()},1)):e())}}if(s._ogv_video_decoder_init=()=>(s._ogv_video_decoder_init=G.g)(),s._ogv_video_decoder_async=()=>(s._ogv_video_decoder_async=G.h)(),s._ogv_video_decoder_process_header=(e,r)=>(s._ogv_video_decoder_process_header=G.i)(e,r),s._ogv_video_decoder_process_frame=(e,r)=>(s._ogv_video_decoder_process_frame=G.j)(e,r),s._ogv_video_decoder_destroy=()=>(s._ogv_video_decoder_destroy=G.k)(),s._free=e=>(s._free=G.l)(e),s._malloc=e=>(s._malloc=G.m)(e),E=function e(){M||V(),M||(E=e)},s.preInit)for("function"==typeof s.preInit&&(s.preInit=[s.preInit]);0<s.preInit.length;)s.preInit.pop()();function q(e){var r=k();return e=e(),s.cpuTime+=k()-r,e}return V(),k="undefined"==typeof performance||void 0===performance.now?Date.now:performance.now.bind(performance),s.loadedMetadata=!!s.videoFormat,s.videoFormat=s.videoFormat||null,s.frameBuffer=null,s.cpuTime=0,Object.defineProperty(s,"processing",{get:function(){return!1}}),s.init=function(e){q(function(){s._ogv_video_decoder_init()}),e()},s.processHeader=function(e,r){r(q(function(){var r=e.byteLength;O&&B>=r||(O&&s._free(O),B=r,O=s._malloc(B));var t=O;return new Uint8Array(_.buffer,t,r).set(new Uint8Array(e)),s._ogv_video_decoder_process_header(t,r)}))},s.o=[],s.processFrame=function(e,r){function t(e){s._free(i),r(e)}var n=s._ogv_video_decoder_async(),o=e.byteLength,i=s._malloc(o);n&&s.o.push(t);var a=q(function(){return new Uint8Array(_.buffer,i,o).set(new Uint8Array(e)),s._ogv_video_decoder_process_frame(i,o)});n||t(a)},s.close=function(){},s.sync=function(){s._ogv_video_decoder_async()&&(s.o.push(function(){}),q(function(){s._ogv_video_decoder_process_frame(0,0)}))},s.recycledFrames=[],s.recycleFrame=function(e){var r=s.recycledFrames;r.push(e),16<r.length&&r.shift()},c}})();"object"==typeof exports&&"object"==typeof module?module.exports=OGVDecoderVideoTheoraW:"function"==typeof define&&define.amd&&define([],()=>OGVDecoderVideoTheoraW);