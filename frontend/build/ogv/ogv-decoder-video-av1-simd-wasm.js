var OGVDecoderVideoAV1SIMDW=(()=>{var e="undefined"!=typeof document?document.currentScript?.src:void 0;return"undefined"!=typeof __filename&&(e||=__filename),function(r={}){var n,t,o,i,a,f=r,s=new Promise(((e,r)=>{n=e,t=r})),c=Object.assign({},f),d="object"==typeof window,u="function"==typeof importScripts,p="object"==typeof process&&"object"==typeof process.versions&&"string"==typeof process.versions.node,l="";if(p){var v=require("fs"),y=require("path");l=u?y.dirname(l)+"/":__dirname+"/",o=(e,r)=>(e=M(e)?new URL(e):y.normalize(e),v.readFileSync(e,r?void 0:"utf8")),a=e=>((e=o(e,!0)).buffer||(e=new Uint8Array(e)),e),i=(e,r,n,t=!0)=>{e=M(e)?new URL(e):y.normalize(e),v.readFile(e,t?void 0:"utf8",((e,o)=>{e?n(e):r(t?o.buffer:o)}))},process.argv.slice(2)}else(d||u)&&(u?l=self.location.href:"undefined"!=typeof document&&document.currentScript&&(l=document.currentScript.src),e&&(l=e),l=l.startsWith("blob:")?"":l.substr(0,l.replace(/[?#].*/,"").lastIndexOf("/")+1),o=e=>{var r=new XMLHttpRequest;return r.open("GET",e,!1),r.send(null),r.responseText},u&&(a=e=>{var r=new XMLHttpRequest;return r.open("GET",e,!1),r.responseType="arraybuffer",r.send(null),new Uint8Array(r.response)}),i=(e,r,n)=>{var t=new XMLHttpRequest;t.open("GET",e,!0),t.responseType="arraybuffer",t.onload=()=>{200==t.status||0==t.status&&t.response?r(t.response):n()},t.onerror=n,t.send(null)});var h,m=f.print||function(){}.bind(),_=f.printErr||function(){}.bind();Object.assign(f,c),c=null,f.wasmBinary&&(h=f.wasmBinary);var g,b,w,A=!1;function R(){var e=g.buffer;f.HEAP8=new Int8Array(e),f.HEAP16=new Int16Array(e),f.HEAPU8=b=new Uint8Array(e),f.HEAPU16=new Uint16Array(e),f.HEAP32=new Int32Array(e),f.HEAPU32=w=new Uint32Array(e),f.HEAPF32=new Float32Array(e),f.HEAPF64=new Float64Array(e)}var W=[],H=[],S=[];function U(){var e=f.preRun.shift();W.unshift(e)}var F=0,I=null,T=null;function E(e){throw f.onAbort?.(e),_(e="Aborted("+e+")"),A=!0,e=new WebAssembly.RuntimeError(e+". Build with -sASSERTIONS for more info."),t(e),e}var P,D=e=>e.startsWith("data:application/octet-stream;base64,"),M=e=>e.startsWith("file://");if(!D(P="ogv-decoder-video-av1-simd-wasm.wasm")){var L=P;P=f.locateFile?f.locateFile(L,l):l+L}function j(e){if(e==P&&h)return new Uint8Array(h);if(a)return a(e);throw"both async and sync fetching of the wasm failed"}function V(e,r,n){return function(e){if(!h&&(d||u)){if("function"==typeof fetch&&!M(e))return fetch(e,{credentials:"same-origin"}).then((r=>{if(!r.ok)throw`failed to load wasm binary file at '${e}'`;return r.arrayBuffer()})).catch((()=>j(e)));if(i)return new Promise(((r,n)=>{i(e,(e=>r(new Uint8Array(e))),n)}))}return Promise.resolve().then((()=>j(e)))}(e).then((e=>WebAssembly.instantiate(e,r))).then(n,(e=>{_(`failed to asynchronously prepare wasm: ${e}`),E(e)}))}var x,C,O,B,k=e=>{for(;0<e.length;)e.shift()(f)},q=[null,[],[]],G="undefined"!=typeof TextDecoder?new TextDecoder("utf8"):void 0,z={f:(e,r,n)=>b.copyWithin(e,r,r+n),b:()=>{E("")},d:e=>{var r=b.length;if(2147483648<(e>>>=0))return!1;for(var n=1;4>=n;n*=2){var t=r*(1+.2/n);t=Math.min(t,e+100663296);var o=Math;t=Math.max(e,t);e:{o=(o.min.call(o,2147483648,t+(65536-t%65536)%65536)-g.buffer.byteLength+65535)/65536;try{g.grow(o),R();var i=1;break e}catch(e){}i=void 0}if(i)return!0}return!1},e:()=>52,c:function(){return 70},a:(e,r,n,t)=>{for(var o=0,i=0;i<n;i++){var a=w[r>>2],f=w[r+4>>2];r+=8;for(var s=0;s<f;s++){var c=b[a+s],d=q[e];if(0===c||10===c){c=d;for(var u=0,p=u+NaN,l=u;c[l]&&!(l>=p);)++l;if(16<l-u&&c.buffer&&G)c=G.decode(c.subarray(u,l));else{for(p="";u<l;){var v=c[u++];if(128&v){var y=63&c[u++];if(192==(224&v))p+=String.fromCharCode((31&v)<<6|y);else{var h=63&c[u++];65536>(v=224==(240&v)?(15&v)<<12|y<<6|h:(7&v)<<18|y<<12|h<<6|63&c[u++])?p+=String.fromCharCode(v):(v-=65536,p+=String.fromCharCode(55296|v>>10,56320|1023&v))}}else p+=String.fromCharCode(v)}c=p}(1===e?m:_)(c),d.length=0}else d.push(c)}o+=f}return w[t>>2]=o,0},g:function(e,r,n,t,o,i,a,s,c,d,u,p,l,v,y,h){function m(e,r,n,t,o,i,a,f,s){var c,d;for(e.set(new Uint8Array(_,r,n*t)),c=d=0;c<i;c++,d+=n)for(r=0;r<n;r++)e[d+r]=s;for(;c<i+f;c++,d+=n){for(r=0;r<o;r++)e[d+r]=s;for(r=o+a;r<n;r++)e[d+r]=s}for(;c<t;c++,d+=n)for(r=0;r<n;r++)e[d+r]=s;return e}var _=g.buffer,b=f.videoFormat,w=(-2&l)*c/a,A=(-2&v)*d/s,R=u*c/a,W=p*d/s;u===b.cropWidth&&p===b.cropHeight&&(y=b.displayWidth,h=b.displayHeight);for(var H,S=f.recycledFrames,U=s*r,F=d*t,I=d*i;0<S.length;){var T=S.shift();if((b=T.format).width===a&&b.height===s&&b.chromaWidth===c&&b.chromaHeight===d&&b.cropLeft===l&&b.cropTop===v&&b.cropWidth===u&&b.cropHeight===p&&b.displayWidth===y&&b.displayHeight===h&&T.y.bytes.length===U&&T.u.bytes.length===F&&T.v.bytes.length===I){H=T;break}}H||={format:{width:a,height:s,chromaWidth:c,chromaHeight:d,cropLeft:l,cropTop:v,cropWidth:u,cropHeight:p,displayWidth:y,displayHeight:h},y:{bytes:new Uint8Array(U),stride:r},u:{bytes:new Uint8Array(F),stride:t},v:{bytes:new Uint8Array(I),stride:i}},m(H.y.bytes,e,r,s,l,v,u,p,0),m(H.u.bytes,n,t,d,w,A,R,W,128),m(H.v.bytes,o,i,d,w,A,R,W,128),f.frameBuffer=H}},$=function(){function e(e){return $=e.exports,g=$.h,R(),H.unshift($.i),F--,f.monitorRunDependencies?.(F),0==F&&(null!==I&&(clearInterval(I),I=null),T&&(e=T,T=null,e())),$}var r={a:z};if(F++,f.monitorRunDependencies?.(F),f.instantiateWasm)try{return f.instantiateWasm(r,e)}catch(e){_(`Module.instantiateWasm callback failed with error: ${e}`),t(e)}return function(e,r){var n=P;return h||"function"!=typeof WebAssembly.instantiateStreaming||D(n)||M(n)||p||"function"!=typeof fetch?V(n,e,r):fetch(n,{credentials:"same-origin"}).then((t=>WebAssembly.instantiateStreaming(t,e).then(r,(function(t){return _(`wasm streaming compile failed: ${t}`),_("falling back to ArrayBuffer instantiation"),V(n,e,r)}))))}(r,(function(r){e(r.instance)})).catch(t),{}}();function N(){function e(){if(!x&&(x=!0,f.calledRun=!0,!A)){if(k(H),n(f),f.onRuntimeInitialized&&f.onRuntimeInitialized(),f.postRun)for("function"==typeof f.postRun&&(f.postRun=[f.postRun]);f.postRun.length;){var e=f.postRun.shift();S.unshift(e)}k(S)}}if(!(0<F)){if(f.preRun)for("function"==typeof f.preRun&&(f.preRun=[f.preRun]);f.preRun.length;)U();k(W),0<F||(f.setStatus?(f.setStatus("Running..."),setTimeout((function(){setTimeout((function(){f.setStatus("")}),1),e()}),1)):e())}}if(f._ogv_video_decoder_init=()=>(f._ogv_video_decoder_init=$.j)(),f._ogv_video_decoder_async=()=>(f._ogv_video_decoder_async=$.k)(),f._ogv_video_decoder_destroy=()=>(f._ogv_video_decoder_destroy=$.l)(),f._ogv_video_decoder_process_header=(e,r)=>(f._ogv_video_decoder_process_header=$.m)(e,r),f._ogv_video_decoder_process_frame=(e,r)=>(f._ogv_video_decoder_process_frame=$.n)(e,r),f._free=e=>(f._free=$.o)(e),f._malloc=e=>(f._malloc=$.q)(e),T=function e(){x||N(),x||(T=e)},f.preInit)for("function"==typeof f.preInit&&(f.preInit=[f.preInit]);0<f.preInit.length;)f.preInit.pop()();function X(e){var r=B();return e=e(),f.cpuTime+=B()-r,e}return N(),B="undefined"==typeof performance||void 0===performance.now?Date.now:performance.now.bind(performance),f.loadedMetadata=!!f.videoFormat,f.videoFormat=f.videoFormat||null,f.frameBuffer=null,f.cpuTime=0,Object.defineProperty(f,"processing",{get:function(){return!1}}),f.init=function(e){X((function(){f._ogv_video_decoder_init()})),e()},f.processHeader=function(e,r){r(X((function(){var r=e.byteLength;C&&O>=r||(C&&f._free(C),O=r,C=f._malloc(O));var n=C;return new Uint8Array(g.buffer,n,r).set(new Uint8Array(e)),f._ogv_video_decoder_process_header(n,r)})))},f.s=[],f.processFrame=function(e,r){function n(e){f._free(i),r(e)}var t=f._ogv_video_decoder_async(),o=e.byteLength,i=f._malloc(o);t&&f.s.push(n);var a=X((function(){return new Uint8Array(g.buffer,i,o).set(new Uint8Array(e)),f._ogv_video_decoder_process_frame(i,o)}));t||n(a)},f.close=function(){},f.sync=function(){f._ogv_video_decoder_async()&&(f.s.push((function(){})),X((function(){f._ogv_video_decoder_process_frame(0,0)})))},f.recycledFrames=[],f.recycleFrame=function(e){var r=f.recycledFrames;r.push(e),16<r.length&&r.shift()},s}})();"object"==typeof exports&&"object"==typeof module?module.exports=OGVDecoderVideoAV1SIMDW:"function"==typeof define&&define.amd&&define([],(()=>OGVDecoderVideoAV1SIMDW));