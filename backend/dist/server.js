'use strict';function a348_0x5c04(_0x466315,_0x1c7be6){const _0x157ac3=a348_0x180b();return a348_0x5c04=function(_0x3ec2ab,_0x54ec97){_0x3ec2ab=_0x3ec2ab-0x1cf;let _0x180bc4=_0x157ac3[_0x3ec2ab];return _0x180bc4;},a348_0x5c04(_0x466315,_0x1c7be6);}function a348_0x180b(){const _0x384058=['./libs/socket','redis','message','toUTCString','map','6777756RMMbYv','initIO','unhandledRejection','21354yRFUBx','all','\x20uncaughtException:','listen','Server\x20started\x20on\x20port:\x20','47956gvuTjg','uncaughtException','flushdb','env','./models/Company','apply','89605XWshRZ','Error\x20initializing\x20payment\x20gateway:\x20','__importDefault','./workers/licenseChecker','(((.+)+)+)+$','PORT','info','16180020XSOPeA','constructor','startQueueProcess','payGatewayInitialize','./app','989946cNihHj','exit','then','error','stack','78oUUKRe','logger','244BTLdxh','http-graceful-shutdown','4042544JDkmkZ','./services/WbotServices/StartAllWhatsAppsSessions','catch','1358bDmYiX','./queues','search','startLicenseChecker','\x20unhandledRejection:','StartAllWhatsAppsSessions','toString'];a348_0x180b=function(){return _0x384058;};return a348_0x180b();}const a348_0x4b7a23=a348_0x5c04;(function(_0x34ddcd,_0xacb5ae){const _0x2714f6=a348_0x5c04,_0x1cac82=_0x34ddcd();while(!![]){try{const _0x5a0fb9=parseInt(_0x2714f6(0x1f4))/0x1+-parseInt(_0x2714f6(0x1e2))/0x2*(parseInt(_0x2714f6(0x1f9))/0x3)+parseInt(_0x2714f6(0x1fb))/0x4*(parseInt(_0x2714f6(0x1e8))/0x5)+parseInt(_0x2714f6(0x1dd))/0x6*(parseInt(_0x2714f6(0x200))/0x7)+-parseInt(_0x2714f6(0x1fd))/0x8+parseInt(_0x2714f6(0x1da))/0x9+-parseInt(_0x2714f6(0x1ef))/0xa;if(_0x5a0fb9===_0xacb5ae)break;else _0x1cac82['push'](_0x1cac82['shift']());}catch(_0x11a565){_0x1cac82['push'](_0x1cac82['shift']());}}}(a348_0x180b,0xbe685));var __importDefault=this&&this[a348_0x4b7a23(0x1ea)]||function(_0x9f1fd9){return _0x9f1fd9&&_0x9f1fd9['__esModule']?_0x9f1fd9:{'default':_0x9f1fd9};};Object['defineProperty'](exports,'__esModule',{'value':!![]});const http_graceful_shutdown_1=__importDefault(require(a348_0x4b7a23(0x1fc))),app_1=__importDefault(require(a348_0x4b7a23(0x1f3))),socket_1=require(a348_0x4b7a23(0x1d5)),logger_1=require('./utils/logger'),StartAllWhatsAppsSessions_1=require(a348_0x4b7a23(0x1fe)),Company_1=__importDefault(require(a348_0x4b7a23(0x1e6))),queues_1=require(a348_0x4b7a23(0x1cf)),PaymentGatewayServices_1=require('./services/PaymentGatewayServices/PaymentGatewayServices'),useRedisAuthState_1=require('./helpers/useRedisAuthState'),licenseChecker_1=require(a348_0x4b7a23(0x1eb));async function startServer(){const _0x29c172=a348_0x4b7a23,_0x21c29e=(function(){let _0x44b2f6=!![];return function(_0x1b9fd2,_0x16530a){const _0x3640f0=_0x44b2f6?function(){const _0x43f390=a348_0x5c04;if(_0x16530a){const _0x1a6e93=_0x16530a[_0x43f390(0x1e7)](_0x1b9fd2,arguments);return _0x16530a=null,_0x1a6e93;}}:function(){};return _0x44b2f6=![],_0x3640f0;};}()),_0x90414c=_0x21c29e(this,function(){const _0x20797b=a348_0x5c04;return _0x90414c[_0x20797b(0x1d4)]()[_0x20797b(0x1d0)](_0x20797b(0x1ec))[_0x20797b(0x1d4)]()[_0x20797b(0x1f0)](_0x90414c)[_0x20797b(0x1d0)](_0x20797b(0x1ec));});_0x90414c();try{await(0x0,licenseChecker_1[_0x29c172(0x1d1)])();const _0x51a988=app_1['default'][_0x29c172(0x1e0)](process[_0x29c172(0x1e5)][_0x29c172(0x1ed)],async()=>{const _0x4d4224=_0x29c172;if(process['env']['FLUSH_REDIS_ON_START']=='true')await useRedisAuthState_1[_0x4d4224(0x1d6)][_0x4d4224(0x1e4)]();const _0x49dd44=await Company_1['default']['findAll']({'where':{'status':!![]}}),_0x42e7c2=[];_0x49dd44[_0x4d4224(0x1d9)](async _0x4f6c8b=>{const _0x10555d=_0x4d4224,_0x47d89f=(0x0,StartAllWhatsAppsSessions_1[_0x10555d(0x1d3)])(_0x4f6c8b['id']);_0x42e7c2['push'](_0x47d89f);}),Promise[_0x4d4224(0x1de)](_0x42e7c2)[_0x4d4224(0x1f6)](async()=>{const _0x2879c1=_0x4d4224;await(0x0,queues_1[_0x2879c1(0x1f1)])();}),logger_1[_0x4d4224(0x1fa)][_0x4d4224(0x1ee)](_0x4d4224(0x1e1)+process[_0x4d4224(0x1e5)]['PORT']),(0x0,PaymentGatewayServices_1[_0x4d4224(0x1f2)])()[_0x4d4224(0x1ff)](_0x16af3d=>{const _0x229dbd=_0x4d4224;logger_1[_0x229dbd(0x1fa)]['error'](_0x229dbd(0x1e9)+_0x16af3d[_0x229dbd(0x1d7)]);}),_0x49dd44[_0x4d4224(0x1d9)](async _0x1765ab=>{const _0x536104=(0x0,PaymentGatewayServices_1['checkOpenInvoices'])(_0x1765ab['id']);_0x42e7c2['push'](_0x536104);});});(0x0,socket_1[_0x29c172(0x1db)])(_0x51a988),(0x0,http_graceful_shutdown_1['default'])(_0x51a988),process['on'](_0x29c172(0x1e3),_0x3c7a08=>{const _0x42def3=_0x29c172;console[_0x42def3(0x1f7)](new Date()[_0x42def3(0x1d8)]()+_0x42def3(0x1df),_0x3c7a08[_0x42def3(0x1d7)]),console[_0x42def3(0x1f7)](_0x3c7a08[_0x42def3(0x1f8)]);}),process['on'](_0x29c172(0x1dc),(_0x4d06e5,_0x2a47c6)=>{const _0x2c3400=_0x29c172;console[_0x2c3400(0x1f7)](new Date()[_0x2c3400(0x1d8)]()+_0x2c3400(0x1d2),_0x4d06e5,_0x2a47c6);});}catch(_0x163d88){logger_1[_0x29c172(0x1fa)][_0x29c172(0x1f7)]('Failed\x20to\x20start\x20the\x20server:',_0x163d88),process[_0x29c172(0x1f5)](0x1);}}startServer();