const a383_0x17f40c=a383_0x149b;function a383_0x149b(_0x4de716,_0xd14dee){const _0x176e66=a383_0x2d7d();return a383_0x149b=function(_0x3ba4aa,_0x396d83){_0x3ba4aa=_0x3ba4aa-0xc7;let _0x2d7d0a=_0x176e66[_0x3ba4aa];return _0x2d7d0a;},a383_0x149b(_0x4de716,_0xd14dee);}(function(_0x421283,_0x13c437){const _0x40ff9a=a383_0x149b,_0x3aa76d=_0x421283();while(!![]){try{const _0xd669b6=parseInt(_0x40ff9a(0xde))/0x1+-parseInt(_0x40ff9a(0xd6))/0x2+parseInt(_0x40ff9a(0xd2))/0x3+-parseInt(_0x40ff9a(0xe8))/0x4*(-parseInt(_0x40ff9a(0xcd))/0x5)+parseInt(_0x40ff9a(0xc9))/0x6*(-parseInt(_0x40ff9a(0xf6))/0x7)+parseInt(_0x40ff9a(0xe3))/0x8*(parseInt(_0x40ff9a(0xe7))/0x9)+-parseInt(_0x40ff9a(0xdd))/0xa;if(_0xd669b6===_0x13c437)break;else _0x3aa76d['push'](_0x3aa76d['shift']());}catch(_0x4548e7){_0x3aa76d['push'](_0x3aa76d['shift']());}}}(a383_0x2d7d,0x8ac99));function a383_0x2d7d(){const _0x113d77=['message','Started\x20WhatsApp\x20session\x20for\x20company\x20ID:\x20','map','all','./utils/logger','PORT','startQueueProcess','default','uncaughtException','889erUHqx','__esModule','code','4812AdOEUF','env','__importDefault','PORT\x20environment\x20variable\x20is\x20not\x20set.','186545fAODvk','initIO','SIGINT\x20SIGTERM','Shutdown\x20initiated.\x20Cleaning\x20up...','listen','1250667utEmVz','Server\x20started\x20on\x20port:\x20','error','findAll','1172206qBJFVS','unhandledRejection','./services/PaymentGatewayServices/PaymentGatewayServices','info','apply','startLicenseChecker','exit','15775770TZqOFg','1006497gkBPaK','debug','Server\x20is\x20listening\x20on\x20port:\x20','./libs/socket','search','4718584AdJGah','\x20-\x20','./workers/licenseChecker','toString','9yNldwg','88GOqVfd','logger','payGatewayInitialize','./queues','StartAllWhatsAppsSessions'];a383_0x2d7d=function(){return _0x113d77;};return a383_0x2d7d();}const a383_0x396d83=(function(){let _0x9235cd=!![];return function(_0x3e6163,_0x28f855){const _0x1ad489=_0x9235cd?function(){const _0x275898=a383_0x149b;if(_0x28f855){const _0x33a20b=_0x28f855[_0x275898(0xda)](_0x3e6163,arguments);return _0x28f855=null,_0x33a20b;}}:function(){};return _0x9235cd=![],_0x1ad489;};}()),a383_0x3ba4aa=a383_0x396d83(this,function(){const _0x2764ba=a383_0x149b;return a383_0x3ba4aa[_0x2764ba(0xe6)]()[_0x2764ba(0xe2)]('(((.+)+)+)+$')[_0x2764ba(0xe6)]()['constructor'](a383_0x3ba4aa)[_0x2764ba(0xe2)]('(((.+)+)+)+$');});a383_0x3ba4aa();'use strict';var __importDefault=this&&this[a383_0x17f40c(0xcb)]||function(_0x3855fd){const _0x3125e9=a383_0x17f40c;return _0x3855fd&&_0x3855fd[_0x3125e9(0xc7)]?_0x3855fd:{'default':_0x3855fd};};Object['defineProperty'](exports,a383_0x17f40c(0xc7),{'value':!![]});const http_graceful_shutdown_1=__importDefault(require('http-graceful-shutdown')),app_1=__importDefault(require('./app')),socket_1=require(a383_0x17f40c(0xe1)),logger_1=require(a383_0x17f40c(0xf1)),StartAllWhatsAppsSessions_1=require('./services/WbotServices/StartAllWhatsAppsSessions'),Company_1=__importDefault(require('./models/Company')),queues_1=require(a383_0x17f40c(0xeb)),PaymentGatewayServices_1=require(a383_0x17f40c(0xd8)),licenseChecker_1=require(a383_0x17f40c(0xe5));!process[a383_0x17f40c(0xca)][a383_0x17f40c(0xf2)]&&(logger_1[a383_0x17f40c(0xe9)][a383_0x17f40c(0xd4)](a383_0x17f40c(0xcc)),process[a383_0x17f40c(0xdc)](0x1));async function startServer(){const _0x1cbfbc=a383_0x17f40c;try{await(0x0,licenseChecker_1[_0x1cbfbc(0xdb)])();const _0x43f26b=await Company_1[_0x1cbfbc(0xf4)][_0x1cbfbc(0xd5)](),_0x43d6bf=_0x43f26b[_0x1cbfbc(0xef)](async _0x21778b=>{const _0x1a0123=_0x1cbfbc;try{await(0x0,StartAllWhatsAppsSessions_1[_0x1a0123(0xec)])(_0x21778b['id']),logger_1['logger']['info'](_0x1a0123(0xee)+_0x21778b['id']);}catch(_0x3013e2){logger_1[_0x1a0123(0xe9)][_0x1a0123(0xd4)]('Error\x20starting\x20WhatsApp\x20session\x20for\x20company\x20ID:\x20'+_0x21778b['id']+_0x1a0123(0xe4)+_0x3013e2[_0x1a0123(0xed)]);}});await Promise[_0x1cbfbc(0xf0)](_0x43d6bf),(0x0,queues_1[_0x1cbfbc(0xf3)])(),logger_1[_0x1cbfbc(0xe9)][_0x1cbfbc(0xd9)](_0x1cbfbc(0xd3)+process['env']['PORT']);try{await(0x0,PaymentGatewayServices_1[_0x1cbfbc(0xea)])();}catch(_0x216ffc){logger_1['logger'][_0x1cbfbc(0xd4)]('Error\x20initializing\x20payment\x20gateway:\x20'+_0x216ffc[_0x1cbfbc(0xed)]);}(0x0,PaymentGatewayServices_1['checkOpenInvoices'])();}catch(_0x4c58f2){logger_1['logger']['error']('Error\x20during\x20server\x20startup:\x20'+_0x4c58f2[_0x1cbfbc(0xed)]),process['exit'](0x1);}}const server=app_1['default'][a383_0x17f40c(0xd1)](process[a383_0x17f40c(0xca)][a383_0x17f40c(0xf2)],async()=>{const _0x1d0d41=a383_0x17f40c;logger_1[_0x1d0d41(0xe9)]['info'](_0x1d0d41(0xe0)+process[_0x1d0d41(0xca)]['PORT']),await startServer();});(0x0,socket_1[a383_0x17f40c(0xce)])(server),(0x0,http_graceful_shutdown_1[a383_0x17f40c(0xf4)])(server,{'signals':a383_0x17f40c(0xcf),'timeout':0x7530,'onShutdown':async()=>{const _0x10db27=a383_0x17f40c;logger_1[_0x10db27(0xe9)]['info'](_0x10db27(0xd0));},'finally':()=>{const _0xe90601=a383_0x17f40c;logger_1['logger'][_0xe90601(0xd9)]('Server\x20has\x20shut\x20down.');}}),process['on'](a383_0x17f40c(0xf5),_0x598c10=>{const _0x22c4c7=a383_0x17f40c;logger_1[_0x22c4c7(0xe9)][_0x22c4c7(0xd4)]({'err':_0x598c10},'Uncaught\x20Exception:\x20'+_0x598c10[_0x22c4c7(0xed)]);if(_0x598c10[_0x22c4c7(0xc8)]==='ERR_OSSL_BAD_DECRYPT')return;process[_0x22c4c7(0xdc)](0x1);}),process['on'](a383_0x17f40c(0xd7),(_0x3253ed,_0x1c2a50)=>{const _0x5d0313=a383_0x17f40c;logger_1[_0x5d0313(0xe9)][_0x5d0313(0xdf)]({'promise':_0x1c2a50,'reason':_0x3253ed},'Unhandled\x20Rejection');});