'use strict';function a348_0x3143(){const _0x47bfb3=['map','catch','./services/WbotServices/StartAllWhatsAppsSessions','apply','flushdb','search','error','1077544vAqCyK','519380dUGrxA','3618738YTGJSb','FLUSH_REDIS_ON_START','130tAVSVD','logger','defineProperty','Error\x20initializing\x20payment\x20gateway:\x20','push','494415viZPHV','all','StartAllWhatsAppsSessions','message','true','7zzlQDD','./models/Company','startLicenseChecker','./libs/socket','default','unhandledRejection','env','Failed\x20to\x20start\x20the\x20server:','info','startQueueProcess','\x20unhandledRejection:','listen','2616505mzuMbb','./utils/logger','\x20uncaughtException:','toString','12HuCrGE','(((.+)+)+)+$','218551xROxQK','redis','PORT','./workers/licenseChecker','constructor','uncaughtException','Server\x20started\x20on\x20port:\x20','./app','12955943vYfxgE','./helpers/useRedisAuthState','exit','__esModule','2oPmkle','toUTCString','./services/PaymentGatewayServices/PaymentGatewayServices'];a348_0x3143=function(){return _0x47bfb3;};return a348_0x3143();}const a348_0x4db7ed=a348_0x5559;(function(_0x3b77ff,_0x4301f4){const _0x5544f3=a348_0x5559,_0x373520=_0x3b77ff();while(!![]){try{const _0x542567=-parseInt(_0x5544f3(0x98))/0x1*(-parseInt(_0x5544f3(0xa4))/0x2)+-parseInt(_0x5544f3(0x96))/0x3*(parseInt(_0x5544f3(0x79))/0x4)+-parseInt(_0x5544f3(0x92))/0x5+parseInt(_0x5544f3(0x7a))/0x6*(parseInt(_0x5544f3(0x86))/0x7)+parseInt(_0x5544f3(0x78))/0x8+-parseInt(_0x5544f3(0x81))/0x9*(parseInt(_0x5544f3(0x7c))/0xa)+parseInt(_0x5544f3(0xa0))/0xb;if(_0x542567===_0x4301f4)break;else _0x373520['push'](_0x373520['shift']());}catch(_0x3cc79b){_0x373520['push'](_0x373520['shift']());}}}(a348_0x3143,0x5c200));function a348_0x5559(_0x29932b,_0x5b9e9e){const _0x595668=a348_0x3143();return a348_0x5559=function(_0x3f6496,_0x3294fb){_0x3f6496=_0x3f6496-0x73;let _0x3143c6=_0x595668[_0x3f6496];return _0x3143c6;},a348_0x5559(_0x29932b,_0x5b9e9e);}var __importDefault=this&&this['__importDefault']||function(_0x467aed){return _0x467aed&&_0x467aed['__esModule']?_0x467aed:{'default':_0x467aed};};Object[a348_0x4db7ed(0x7e)](exports,a348_0x4db7ed(0xa3),{'value':!![]});const http_graceful_shutdown_1=__importDefault(require('http-graceful-shutdown')),app_1=__importDefault(require(a348_0x4db7ed(0x9f))),socket_1=require(a348_0x4db7ed(0x89)),logger_1=require(a348_0x4db7ed(0x93)),StartAllWhatsAppsSessions_1=require(a348_0x4db7ed(0x73)),Company_1=__importDefault(require(a348_0x4db7ed(0x87))),queues_1=require('./queues'),PaymentGatewayServices_1=require(a348_0x4db7ed(0xa6)),useRedisAuthState_1=require(a348_0x4db7ed(0xa1)),licenseChecker_1=require(a348_0x4db7ed(0x9b));async function startServer(){const _0x425f84=a348_0x4db7ed,_0x59126c=(function(){let _0x5e9bf9=!![];return function(_0x3a57ce,_0x3fa4ab){const _0x9edd61=_0x5e9bf9?function(){const _0x189c05=a348_0x5559;if(_0x3fa4ab){const _0x37fe7f=_0x3fa4ab[_0x189c05(0x74)](_0x3a57ce,arguments);return _0x3fa4ab=null,_0x37fe7f;}}:function(){};return _0x5e9bf9=![],_0x9edd61;};}()),_0x5b4807=_0x59126c(this,function(){const _0x2cec3c=a348_0x5559;return _0x5b4807[_0x2cec3c(0x95)]()[_0x2cec3c(0x76)](_0x2cec3c(0x97))[_0x2cec3c(0x95)]()[_0x2cec3c(0x9c)](_0x5b4807)['search'](_0x2cec3c(0x97));});_0x5b4807();try{await(0x0,licenseChecker_1[_0x425f84(0x88)])();const _0x2a4d2=app_1['default'][_0x425f84(0x91)](process[_0x425f84(0x8c)][_0x425f84(0x9a)],async()=>{const _0x40e24b=_0x425f84;if(process[_0x40e24b(0x8c)][_0x40e24b(0x7b)]==_0x40e24b(0x85))await useRedisAuthState_1[_0x40e24b(0x99)][_0x40e24b(0x75)]();const _0x120463=await Company_1[_0x40e24b(0x8a)]['findAll']({'where':{'status':!![]}}),_0x21576c=[];_0x120463[_0x40e24b(0xa7)](async _0x15581a=>{const _0x287d83=_0x40e24b,_0x2ada44=(0x0,StartAllWhatsAppsSessions_1[_0x287d83(0x83)])(_0x15581a['id']);_0x21576c[_0x287d83(0x80)](_0x2ada44);}),Promise[_0x40e24b(0x82)](_0x21576c)['then'](async()=>{const _0x172255=_0x40e24b;await(0x0,queues_1[_0x172255(0x8f)])();}),logger_1[_0x40e24b(0x7d)][_0x40e24b(0x8e)](_0x40e24b(0x9e)+process[_0x40e24b(0x8c)][_0x40e24b(0x9a)]),(0x0,PaymentGatewayServices_1['payGatewayInitialize'])()[_0x40e24b(0xa8)](_0x5ea32e=>{const _0x348522=_0x40e24b;logger_1['logger'][_0x348522(0x77)](_0x348522(0x7f)+_0x5ea32e[_0x348522(0x84)]);}),_0x120463['map'](async _0x375f7c=>{const _0x5b212a=_0x40e24b,_0x568628=(0x0,PaymentGatewayServices_1['checkOpenInvoices'])(_0x375f7c['id']);_0x21576c[_0x5b212a(0x80)](_0x568628);});});(0x0,socket_1['initIO'])(_0x2a4d2),(0x0,http_graceful_shutdown_1['default'])(_0x2a4d2),process['on'](_0x425f84(0x9d),_0x2800e0=>{const _0xda5968=_0x425f84;console[_0xda5968(0x77)](new Date()[_0xda5968(0xa5)]()+_0xda5968(0x94),_0x2800e0['message']),console[_0xda5968(0x77)](_0x2800e0['stack']);}),process['on'](_0x425f84(0x8b),(_0x449702,_0x2cfb00)=>{const _0x1f0f19=_0x425f84;console[_0x1f0f19(0x77)](new Date()[_0x1f0f19(0xa5)]()+_0x1f0f19(0x90),_0x449702,_0x2cfb00);});}catch(_0x28eae1){logger_1[_0x425f84(0x7d)][_0x425f84(0x77)](_0x425f84(0x8d),_0x28eae1),process[_0x425f84(0xa2)](0x1);}}startServer();