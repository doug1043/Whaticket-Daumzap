const a414_0x452d12=a414_0x850a;(function(_0x533115,_0x3ac4c9){const _0x10f7e1=a414_0x850a,_0x1b5db2=_0x533115();while(!![]){try{const _0x335848=-parseInt(_0x10f7e1(0x1e8))/0x1+parseInt(_0x10f7e1(0x1fc))/0x2+parseInt(_0x10f7e1(0x1f5))/0x3+-parseInt(_0x10f7e1(0x1fa))/0x4*(-parseInt(_0x10f7e1(0x1db))/0x5)+parseInt(_0x10f7e1(0x1e3))/0x6*(parseInt(_0x10f7e1(0x1e9))/0x7)+-parseInt(_0x10f7e1(0x1f9))/0x8*(parseInt(_0x10f7e1(0x1e0))/0x9)+-parseInt(_0x10f7e1(0x1f1))/0xa*(parseInt(_0x10f7e1(0x1fd))/0xb);if(_0x335848===_0x3ac4c9)break;else _0x1b5db2['push'](_0x1b5db2['shift']());}catch(_0x1ea5da){_0x1b5db2['push'](_0x1b5db2['shift']());}}}(a414_0x1ad6,0xb1dee));const a414_0x5ccf9c=(function(){let _0x1cbfb5=!![];return function(_0x5744a7,_0x490a11){const _0xb7f9c5=_0x1cbfb5?function(){const _0x5e88d8=a414_0x850a;if(_0x490a11){const _0x1ba871=_0x490a11[_0x5e88d8(0x1d6)](_0x5744a7,arguments);return _0x490a11=null,_0x1ba871;}}:function(){};return _0x1cbfb5=![],_0xb7f9c5;};}()),a414_0x14face=a414_0x5ccf9c(this,function(){const _0x4a2d5a=a414_0x850a;return a414_0x14face[_0x4a2d5a(0x1d7)]()[_0x4a2d5a(0x1ea)]('(((.+)+)+)+$')[_0x4a2d5a(0x1d7)]()[_0x4a2d5a(0x1f7)](a414_0x14face)[_0x4a2d5a(0x1ea)](_0x4a2d5a(0x1df));});a414_0x14face();'use strict';var __importDefault=this&&this[a414_0x452d12(0x1e5)]||function(_0x499d08){const _0x3e2245=a414_0x452d12;return _0x499d08&&_0x499d08[_0x3e2245(0x1dd)]?_0x499d08:{'default':_0x499d08};};function a414_0x850a(_0x1ae407,_0x1efcd8){const _0x1891f1=a414_0x1ad6();return a414_0x850a=function(_0x14face,_0x5ccf9c){_0x14face=_0x14face-0x1d6;let _0x1ad677=_0x1891f1[_0x14face];return _0x1ad677;},a414_0x850a(_0x1ae407,_0x1efcd8);}Object['defineProperty'](exports,a414_0x452d12(0x1dd),{'value':!![]});const socket_1=require('../../libs/socket'),Contact_1=__importDefault(require(a414_0x452d12(0x1e4))),lodash_1=require(a414_0x452d12(0x1d9)),GetProfilePicUrl_1=__importDefault(require(a414_0x452d12(0x1f0))),CreateOrUpdateContactService=async({name:_0x29f868,number:_0x54f6f7,remoteJid:_0x4a2e4b,isGroup:_0x46f937,email:email='',companyId:_0x554143,extraInfo:extraInfo=[],disableBot:disableBot=![],whatsappId:_0x656ec},_0x476783,_0x377bf0)=>{const _0x34764b=a414_0x452d12,_0x5c9253=_0x46f937?_0x54f6f7:_0x54f6f7['replace'](/[^0-9]/g,''),_0x463673=(0x0,socket_1[_0x34764b(0x1eb)])();let _0x4199d4;_0x4199d4=await Contact_1[_0x34764b(0x1f2)][_0x34764b(0x1fb)]({'where':{'number':_0x5c9253,'companyId':_0x554143}});if(_0x4199d4){if(_0x29f868&&(!_0x4199d4['name']||_0x4199d4[_0x34764b(0x200)][_0x34764b(0x1ed)](/^[0-9]*$/))&&!_0x29f868[_0x34764b(0x1ed)](/^[0-9]*$/)){_0x4199d4[_0x34764b(0x1da)](_0x34764b(0x200),!![]),_0x4199d4[_0x34764b(0x1da)](_0x34764b(0x1fe),!![]);let _0x33d808;try{_0x33d808=await(0x0,GetProfilePicUrl_1[_0x34764b(0x1f2)])(_0x54f6f7,_0x554143);}catch(_0x3c1ec5){console[_0x34764b(0x1e2)](_0x34764b(0x1f3)+_0x3c1ec5);}_0x33d808?.[_0x34764b(0x1f6)]('nopicture.png')&&(_0x33d808=_0x4199d4[_0x34764b(0x1e7)]),_0x4199d4[_0x34764b(0x1f4)]({'name':_0x29f868,'profilePicUrl':_0x33d808});}const _0x2a2e3b=new Date(_0x4199d4['updatedAt']),_0x5aad96=new Date(),_0x4ff333=_0x5aad96['getTime']()-_0x2a2e3b[_0x34764b(0x1e6)](),_0x3034d8=Math[_0x34764b(0x1ef)](_0x4ff333/(0x3e8*0xe10*0x18));if(_0x3034d8>=0x3){let _0x18807d;try{_0x18807d=await(0x0,GetProfilePicUrl_1['default'])(_0x54f6f7,_0x554143);}catch(_0x49aa43){console[_0x34764b(0x1e2)](_0x34764b(0x1ff)+_0x49aa43);}_0x4199d4[_0x34764b(0x1da)](_0x34764b(0x1fe),!![]),!_0x18807d?.[_0x34764b(0x1f6)](_0x34764b(0x1dc))?_0x4199d4[_0x34764b(0x1f4)]({'profilePicUrl':_0x18807d,'updatedAt':new Date()}):_0x4199d4[_0x34764b(0x1f4)]({'updatedAt':new Date()});}(0x0,lodash_1[_0x34764b(0x1ec)])(_0x4199d4['whatsappId']===null)&&_0x4199d4[_0x34764b(0x1f4)]({'whatsappId':_0x656ec}),_0x463673['to'](_0x34764b(0x1f8)+_0x554143+_0x34764b(0x1de))['emit']('company-'+_0x554143+_0x34764b(0x1ee),{'action':_0x34764b(0x1f4),'contact':_0x4199d4});}else{let _0x3ebed9;try{_0x3ebed9=await(0x0,GetProfilePicUrl_1[_0x34764b(0x1f2)])(_0x54f6f7,_0x554143);}catch(_0x5b1655){_0x3ebed9=process[_0x34764b(0x1d8)]['FRONTEND_URL']+'/nopicture.png';}_0x4199d4=await Contact_1[_0x34764b(0x1f2)][_0x34764b(0x1e1)]({'name':_0x29f868,'number':_0x5c9253,'profilePicUrl':_0x3ebed9,'email':email,'isGroup':_0x46f937,'extraInfo':extraInfo,'companyId':_0x554143,'disableBot':disableBot,'whatsappId':_0x656ec}),_0x463673['to'](_0x34764b(0x1f8)+_0x554143+_0x34764b(0x1de))['emit'](_0x34764b(0x1f8)+_0x554143+_0x34764b(0x1ee),{'action':_0x34764b(0x1e1),'contact':_0x4199d4});}return _0x4199d4;};function a414_0x1ad6(){const _0x4c0ebd=['2007644XhVRdH','33pEHkby','updatedAt','Error\x20getting\x20profile\x20picture:\x20','name','apply','toString','env','lodash','changed','30fhoclH','nopicture.png','__esModule','-mainchannel','(((.+)+)+)+$','31599TtNFAZ','create','log','480tSbIbQ','../../models/Contact','__importDefault','getTime','profilePicUrl','493023eqjvUI','22764XqwtfM','search','getIO','isNil','match','-contact','ceil','../WbotServices/GetProfilePicUrl','4583470GZSdhU','default','Error\x20getting\x20profile\x20picture\x202:\x20','update','129951gmdwGB','endsWith','constructor','company-','40yGMPLG','871252OwFYSf','findOne'];a414_0x1ad6=function(){return _0x4c0ebd;};return a414_0x1ad6();}exports[a414_0x452d12(0x1f2)]=CreateOrUpdateContactService;