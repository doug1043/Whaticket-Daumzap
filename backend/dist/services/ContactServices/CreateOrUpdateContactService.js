const a413_0x1d0e63=a413_0x2d50;(function(_0x36b68a,_0xe25f9f){const _0x256e68=a413_0x2d50,_0x19a27f=_0x36b68a();while(!![]){try{const _0x259aea=parseInt(_0x256e68(0xa3))/0x1*(-parseInt(_0x256e68(0x9c))/0x2)+-parseInt(_0x256e68(0x95))/0x3*(parseInt(_0x256e68(0x7f))/0x4)+parseInt(_0x256e68(0x7b))/0x5*(-parseInt(_0x256e68(0x86))/0x6)+parseInt(_0x256e68(0xa0))/0x7+-parseInt(_0x256e68(0x7e))/0x8*(parseInt(_0x256e68(0x78))/0x9)+parseInt(_0x256e68(0xa4))/0xa*(parseInt(_0x256e68(0x88))/0xb)+parseInt(_0x256e68(0x9e))/0xc;if(_0x259aea===_0xe25f9f)break;else _0x19a27f['push'](_0x19a27f['shift']());}catch(_0x202bd4){_0x19a27f['push'](_0x19a27f['shift']());}}}(a413_0x513f,0xe589a));const a413_0x38cbd4=(function(){let _0x325ad3=!![];return function(_0x1248ec,_0x1681b0){const _0x3c2899=_0x325ad3?function(){const _0x2e1f09=a413_0x2d50;if(_0x1681b0){const _0x3448a8=_0x1681b0[_0x2e1f09(0x9a)](_0x1248ec,arguments);return _0x1681b0=null,_0x3448a8;}}:function(){};return _0x325ad3=![],_0x3c2899;};}()),a413_0x1dbcfe=a413_0x38cbd4(this,function(){const _0xc8fa0a=a413_0x2d50;return a413_0x1dbcfe[_0xc8fa0a(0x77)]()[_0xc8fa0a(0x82)](_0xc8fa0a(0x91))[_0xc8fa0a(0x77)]()['constructor'](a413_0x1dbcfe)[_0xc8fa0a(0x82)](_0xc8fa0a(0x91));});function a413_0x513f(){const _0x448053=['6859935rLbKky','lodash','ceil','32MFBxEM','32jVfyQy','FRONTEND_URL','log','search','Error\x20getting\x20profile\x20picture:\x20','getTime','__esModule','6opURoz','findOne','1463LhgFrD','update','../../libs/socket','create','company-','../../models/Contact','emit','default','-contact','(((.+)+)+)+$','name','match','nopicture.png','543948OkSRXB','changed','isNil','-mainchannel','whatsappId','apply','profilePicUrl','2025718aoZKuB','env','68596248etjKvo','updatedAt','1304359XjECEq','/nopicture.png','__importDefault','1OtDdwE','50010qMwymn','toString','4032594hVMJvJ','endsWith','getIO'];a413_0x513f=function(){return _0x448053;};return a413_0x513f();}a413_0x1dbcfe();'use strict';var __importDefault=this&&this[a413_0x1d0e63(0xa2)]||function(_0x35a7b3){const _0x3b8df3=a413_0x1d0e63;return _0x35a7b3&&_0x35a7b3[_0x3b8df3(0x85)]?_0x35a7b3:{'default':_0x35a7b3};};Object['defineProperty'](exports,a413_0x1d0e63(0x85),{'value':!![]});function a413_0x2d50(_0x382ef6,_0x4be009){const _0x4a8910=a413_0x513f();return a413_0x2d50=function(_0x1dbcfe,_0x38cbd4){_0x1dbcfe=_0x1dbcfe-0x77;let _0x513fb6=_0x4a8910[_0x1dbcfe];return _0x513fb6;},a413_0x2d50(_0x382ef6,_0x4be009);}const socket_1=require(a413_0x1d0e63(0x8a)),Contact_1=__importDefault(require(a413_0x1d0e63(0x8d))),lodash_1=require(a413_0x1d0e63(0x7c)),GetProfilePicUrl_1=__importDefault(require('../WbotServices/GetProfilePicUrl')),CreateOrUpdateContactService=async({name:_0x4e6180,number:_0x46e444,remoteJid:_0x251588,isGroup:_0x276fad,email:email='',companyId:_0x1350d1,extraInfo:extraInfo=[],disableBot:disableBot=![],whatsappId:_0x273d7b},_0x16ff9e,_0x703903)=>{const _0x401490=a413_0x1d0e63,_0x293f8c=_0x276fad?_0x46e444:_0x46e444['replace'](/[^0-9]/g,''),_0x162bcb=(0x0,socket_1[_0x401490(0x7a)])();let _0x51aec3;_0x51aec3=await Contact_1[_0x401490(0x8f)][_0x401490(0x87)]({'where':{'number':_0x293f8c,'companyId':_0x1350d1}});if(_0x51aec3){if(_0x4e6180&&(!_0x51aec3[_0x401490(0x92)]||_0x51aec3['name'][_0x401490(0x93)](/^[0-9]*$/))&&!_0x4e6180[_0x401490(0x93)](/^[0-9]*$/)){_0x51aec3[_0x401490(0x96)](_0x401490(0x92),!![]),_0x51aec3[_0x401490(0x96)](_0x401490(0x9f),!![]);let _0x21aa23;try{_0x21aa23=await(0x0,GetProfilePicUrl_1[_0x401490(0x8f)])(_0x46e444,_0x1350d1);}catch(_0x508e00){console[_0x401490(0x81)]('Error\x20getting\x20profile\x20picture\x202:\x20'+_0x508e00);}_0x21aa23?.['endsWith'](_0x401490(0x94))&&(_0x21aa23=_0x51aec3[_0x401490(0x9b)]),_0x51aec3[_0x401490(0x89)]({'name':_0x4e6180,'profilePicUrl':_0x21aa23});}const _0x3f9791=new Date(_0x51aec3[_0x401490(0x9f)]),_0x1786c7=new Date(),_0x2f5bed=_0x1786c7[_0x401490(0x84)]()-_0x3f9791['getTime'](),_0x3af688=Math[_0x401490(0x7d)](_0x2f5bed/(0x3e8*0xe10*0x18));if(_0x3af688>=0x3){let _0x3f359b;try{_0x3f359b=await(0x0,GetProfilePicUrl_1[_0x401490(0x8f)])(_0x46e444,_0x1350d1);}catch(_0x2ea993){console[_0x401490(0x81)](_0x401490(0x83)+_0x2ea993);}_0x51aec3[_0x401490(0x96)](_0x401490(0x9f),!![]),!_0x3f359b?.[_0x401490(0x79)](_0x401490(0x94))?_0x51aec3[_0x401490(0x89)]({'profilePicUrl':_0x3f359b,'updatedAt':new Date()}):_0x51aec3['update']({'updatedAt':new Date()});}(0x0,lodash_1[_0x401490(0x97)])(_0x51aec3[_0x401490(0x99)]===null)&&_0x51aec3[_0x401490(0x89)]({'whatsappId':_0x273d7b}),_0x162bcb['to'](_0x401490(0x8c)+_0x1350d1+_0x401490(0x98))['emit'](_0x401490(0x8c)+_0x1350d1+'-contact',{'action':'update','contact':_0x51aec3});}else{let _0x314c7b;try{_0x314c7b=await(0x0,GetProfilePicUrl_1[_0x401490(0x8f)])(_0x46e444,_0x1350d1);}catch(_0xfa9ff6){_0x314c7b=process[_0x401490(0x9d)][_0x401490(0x80)]+_0x401490(0xa1);}_0x51aec3=await Contact_1[_0x401490(0x8f)][_0x401490(0x8b)]({'name':_0x4e6180,'number':_0x293f8c,'profilePicUrl':_0x314c7b,'email':email,'isGroup':_0x276fad,'extraInfo':extraInfo,'companyId':_0x1350d1,'disableBot':disableBot,'whatsappId':_0x273d7b}),_0x162bcb['to'](_0x401490(0x8c)+_0x1350d1+'-mainchannel')[_0x401490(0x8e)](_0x401490(0x8c)+_0x1350d1+_0x401490(0x90),{'action':_0x401490(0x8b),'contact':_0x51aec3});}return _0x51aec3;};exports[a413_0x1d0e63(0x8f)]=CreateOrUpdateContactService;