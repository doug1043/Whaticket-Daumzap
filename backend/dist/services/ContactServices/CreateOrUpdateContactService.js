const a416_0x315721=a416_0x17ce;(function(_0x29dd73,_0x87a2a2){const _0xc84135=a416_0x17ce,_0x53bdb0=_0x29dd73();while(!![]){try{const _0xb377ca=-parseInt(_0xc84135(0x105))/0x1*(parseInt(_0xc84135(0x110))/0x2)+parseInt(_0xc84135(0x104))/0x3*(-parseInt(_0xc84135(0xf3))/0x4)+-parseInt(_0xc84135(0xf1))/0x5*(parseInt(_0xc84135(0xfb))/0x6)+parseInt(_0xc84135(0xfa))/0x7+parseInt(_0xc84135(0x102))/0x8*(parseInt(_0xc84135(0x119))/0x9)+parseInt(_0xc84135(0x109))/0xa*(parseInt(_0xc84135(0x118))/0xb)+parseInt(_0xc84135(0xf9))/0xc*(-parseInt(_0xc84135(0xf6))/0xd);if(_0xb377ca===_0x87a2a2)break;else _0x53bdb0['push'](_0x53bdb0['shift']());}catch(_0x2269eb){_0x53bdb0['push'](_0x53bdb0['shift']());}}}(a416_0x5e1b,0x5a392));const a416_0x5f22a8=(function(){let _0x5baf7d=!![];return function(_0x590d10,_0x20befd){const _0x450e93=_0x5baf7d?function(){const _0x4bef86=a416_0x17ce;if(_0x20befd){const _0x3b4976=_0x20befd[_0x4bef86(0xf5)](_0x590d10,arguments);return _0x20befd=null,_0x3b4976;}}:function(){};return _0x5baf7d=![],_0x450e93;};}()),a416_0x5b01a0=a416_0x5f22a8(this,function(){const _0x98cdd7=a416_0x17ce;return a416_0x5b01a0['toString']()[_0x98cdd7(0x107)](_0x98cdd7(0x111))[_0x98cdd7(0x11c)]()[_0x98cdd7(0xf7)](a416_0x5b01a0)[_0x98cdd7(0x107)]('(((.+)+)+)+$');});a416_0x5b01a0();'use strict';var __importDefault=this&&this[a416_0x315721(0xf4)]||function(_0x143b15){const _0x330e24=a416_0x315721;return _0x143b15&&_0x143b15[_0x330e24(0x11d)]?_0x143b15:{'default':_0x143b15};};function a416_0x17ce(_0x4c6a60,_0x4c1dfc){const _0x4944b9=a416_0x5e1b();return a416_0x17ce=function(_0x5b01a0,_0x5f22a8){_0x5b01a0=_0x5b01a0-0xf0;let _0x5e1b0d=_0x4944b9[_0x5b01a0];return _0x5e1b0d;},a416_0x17ce(_0x4c6a60,_0x4c1dfc);}Object[a416_0x315721(0x115)](exports,a416_0x315721(0x11d),{'value':!![]});const socket_1=require(a416_0x315721(0x10c)),Contact_1=__importDefault(require(a416_0x315721(0xff))),lodash_1=require(a416_0x315721(0x101)),GetProfilePicUrl_1=__importDefault(require(a416_0x315721(0xfd))),CreateOrUpdateContactService=async({name:_0x33c199,number:_0x18c6a1,remoteJid:_0x3d16b2,isGroup:_0x3093c9,email:email='',companyId:_0x544a60,extraInfo:extraInfo=[],disableBot:disableBot=![],whatsappId:_0xf99187},_0x183182,_0x34473c)=>{const _0x5f27ee=a416_0x315721,_0x26bee0=_0x3093c9?_0x18c6a1:_0x18c6a1[_0x5f27ee(0x11b)](/[^0-9]/g,''),_0x117cf7=(0x0,socket_1[_0x5f27ee(0xf2)])();let _0x54d346;_0x54d346=await Contact_1[_0x5f27ee(0x116)]['findOne']({'where':{'number':_0x26bee0,'companyId':_0x544a60}});if(_0x54d346){if(_0x33c199&&(!_0x54d346[_0x5f27ee(0x10b)]||_0x54d346[_0x5f27ee(0x10b)][_0x5f27ee(0x114)](/^[0-9]*$/))&&!_0x33c199['match'](/^[0-9]*$/)){_0x54d346['changed']('name',!![]),_0x54d346['changed'](_0x5f27ee(0xf8),!![]);let _0xf2d414;try{_0xf2d414=await(0x0,GetProfilePicUrl_1[_0x5f27ee(0x116)])(_0x18c6a1,_0x544a60);}catch(_0x1eeeb5){console[_0x5f27ee(0x106)](_0x5f27ee(0x10d)+_0x1eeeb5);}_0xf2d414?.[_0x5f27ee(0x112)](_0x5f27ee(0xfe))&&(_0xf2d414=_0x54d346[_0x5f27ee(0x10e)]),_0x54d346[_0x5f27ee(0x10a)]({'name':_0x33c199,'profilePicUrl':_0xf2d414});}const _0x77d89f=new Date(_0x54d346[_0x5f27ee(0xf8)]),_0x5d7174=new Date(),_0x55be68=_0x5d7174[_0x5f27ee(0x100)]()-_0x77d89f[_0x5f27ee(0x100)](),_0x27dc84=Math[_0x5f27ee(0xf0)](_0x55be68/(0x3e8*0xe10*0x18));if(_0x27dc84>=0x3){let _0x4ea39c;try{_0x4ea39c=await(0x0,GetProfilePicUrl_1[_0x5f27ee(0x116)])(_0x18c6a1,_0x544a60);}catch(_0xa424fc){console[_0x5f27ee(0x106)](_0x5f27ee(0xfc)+_0xa424fc);}_0x54d346['changed'](_0x5f27ee(0xf8),!![]),!_0x4ea39c?.[_0x5f27ee(0x112)](_0x5f27ee(0xfe))?_0x54d346[_0x5f27ee(0x10a)]({'profilePicUrl':_0x4ea39c,'updatedAt':new Date()}):_0x54d346[_0x5f27ee(0x10a)]({'updatedAt':new Date()});}(0x0,lodash_1[_0x5f27ee(0x11e)])(_0x54d346['whatsappId']===null)&&_0x54d346[_0x5f27ee(0x10a)]({'whatsappId':_0xf99187}),_0x117cf7['to']('company-'+_0x544a60+_0x5f27ee(0x11a))[_0x5f27ee(0x103)](_0x5f27ee(0x113)+_0x544a60+_0x5f27ee(0x11f),{'action':_0x5f27ee(0x10a),'contact':_0x54d346});}else{let _0x2546a6;try{_0x2546a6=await(0x0,GetProfilePicUrl_1[_0x5f27ee(0x116)])(_0x18c6a1,_0x544a60);}catch(_0x385609){_0x2546a6=process[_0x5f27ee(0x108)]['FRONTEND_URL']+_0x5f27ee(0x117);}_0x54d346=await Contact_1[_0x5f27ee(0x116)][_0x5f27ee(0x10f)]({'name':_0x33c199,'number':_0x26bee0,'profilePicUrl':_0x2546a6,'email':email,'isGroup':_0x3093c9,'extraInfo':extraInfo,'companyId':_0x544a60,'disableBot':disableBot,'whatsappId':_0xf99187}),_0x117cf7['to'](_0x5f27ee(0x113)+_0x544a60+_0x5f27ee(0x11a))[_0x5f27ee(0x103)](_0x5f27ee(0x113)+_0x544a60+_0x5f27ee(0x11f),{'action':_0x5f27ee(0x10f),'contact':_0x54d346});}return _0x54d346;};function a416_0x5e1b(){const _0x56a180=['search','env','850rEYwGA','update','name','../../libs/socket','Error\x20getting\x20profile\x20picture\x202:\x20','profilePicUrl','create','124MqGrmH','(((.+)+)+)+$','endsWith','company-','match','defineProperty','default','/nopicture.png','94941sMjMkx','144uvPmiO','-mainchannel','replace','toString','__esModule','isNil','-contact','ceil','85605gnlruP','getIO','4YEDJIf','__importDefault','apply','208smSVFM','constructor','updatedAt','100500OYdFTn','1861538uIiXHn','138cqHnix','Error\x20getting\x20profile\x20picture:\x20','../WbotServices/GetProfilePicUrl','nopicture.png','../../models/Contact','getTime','lodash','196136RagVuv','emit','1290630spSMOQ','1037EVTIoz','log'];a416_0x5e1b=function(){return _0x56a180;};return a416_0x5e1b();}exports[a416_0x315721(0x116)]=CreateOrUpdateContactService;