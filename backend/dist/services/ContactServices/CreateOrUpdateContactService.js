const a413_0x54e3f8=a413_0x119c;function a413_0x3574(){const _0x1e45d7=['search','/nopicture.png','name','../../libs/socket','getIO','3197580dXKlcv','getTime','FRONTEND_URL','toString','../../models/Contact','Error\x20getting\x20profile\x20picture\x202:\x20','updatedAt','__importDefault','constructor','614665WZoOoC','1287874FZamfO','-contact','-mainchannel','12582350jgAMkz','lodash','isNil','__esModule','21507YYqqBH','2QISgAa','env','8cyrAWN','nopicture.png','whatsappId','220gKJWLh','replace','default','835321iNxVlp','apply','(((.+)+)+)+$','log','ceil','create','emit','changed','endsWith','match','update','company-','Error\x20getting\x20profile\x20picture:\x20','profilePicUrl','2879757pDahYP'];a413_0x3574=function(){return _0x1e45d7;};return a413_0x3574();}(function(_0x1c95da,_0x2e68f5){const _0x13dcbf=a413_0x119c,_0x40f402=_0x1c95da();while(!![]){try{const _0x145595=-parseInt(_0x13dcbf(0x7c))/0x1*(parseInt(_0x13dcbf(0xa2))/0x2)+-parseInt(_0x13dcbf(0xa1))/0x3*(parseInt(_0x13dcbf(0x79))/0x4)+-parseInt(_0x13dcbf(0x99))/0x5+parseInt(_0x13dcbf(0x90))/0x6+-parseInt(_0x13dcbf(0x9a))/0x7+-parseInt(_0x13dcbf(0x76))/0x8*(-parseInt(_0x13dcbf(0x8a))/0x9)+parseInt(_0x13dcbf(0x9d))/0xa;if(_0x145595===_0x2e68f5)break;else _0x40f402['push'](_0x40f402['shift']());}catch(_0x542724){_0x40f402['push'](_0x40f402['shift']());}}}(a413_0x3574,0x8c48f));const a413_0x32ef01=(function(){let _0x199279=!![];return function(_0x232165,_0x4c60a3){const _0x55e60f=_0x199279?function(){const _0x348d28=a413_0x119c;if(_0x4c60a3){const _0x36faee=_0x4c60a3[_0x348d28(0x7d)](_0x232165,arguments);return _0x4c60a3=null,_0x36faee;}}:function(){};return _0x199279=![],_0x55e60f;};}()),a413_0x20c95e=a413_0x32ef01(this,function(){const _0x1dad83=a413_0x119c;return a413_0x20c95e['toString']()[_0x1dad83(0x8b)](_0x1dad83(0x7e))[_0x1dad83(0x93)]()[_0x1dad83(0x98)](a413_0x20c95e)[_0x1dad83(0x8b)](_0x1dad83(0x7e));});a413_0x20c95e();'use strict';var __importDefault=this&&this[a413_0x54e3f8(0x97)]||function(_0x162fe6){const _0x41fa63=a413_0x54e3f8;return _0x162fe6&&_0x162fe6[_0x41fa63(0xa0)]?_0x162fe6:{'default':_0x162fe6};};Object['defineProperty'](exports,a413_0x54e3f8(0xa0),{'value':!![]});const socket_1=require(a413_0x54e3f8(0x8e)),Contact_1=__importDefault(require(a413_0x54e3f8(0x94))),lodash_1=require(a413_0x54e3f8(0x9e)),GetProfilePicUrl_1=__importDefault(require('../WbotServices/GetProfilePicUrl')),CreateOrUpdateContactService=async({name:_0x4f2b5f,number:_0x5c4c6d,remoteJid:_0x18b226,isGroup:_0x6226f3,email:email='',companyId:_0x1a23e9,extraInfo:extraInfo=[],disableBot:disableBot=![],whatsappId:_0x10d0dc},_0xfcf2e2,_0x825931)=>{const _0x40d048=a413_0x54e3f8,_0xd2f308=_0x6226f3?_0x5c4c6d:_0x5c4c6d[_0x40d048(0x7a)](/[^0-9]/g,''),_0x304fa9=(0x0,socket_1[_0x40d048(0x8f)])();let _0x35ade1;_0x35ade1=await Contact_1[_0x40d048(0x7b)]['findOne']({'where':{'number':_0xd2f308,'companyId':_0x1a23e9}});if(_0x35ade1){if(_0x4f2b5f&&(!_0x35ade1['name']||_0x35ade1[_0x40d048(0x8d)][_0x40d048(0x85)](/^[0-9]*$/))&&!_0x4f2b5f[_0x40d048(0x85)](/^[0-9]*$/)){_0x35ade1[_0x40d048(0x83)](_0x40d048(0x8d),!![]),_0x35ade1['changed'](_0x40d048(0x96),!![]);let _0x55a92e;try{_0x55a92e=await(0x0,GetProfilePicUrl_1[_0x40d048(0x7b)])(_0x5c4c6d,_0x1a23e9);}catch(_0xc36633){console[_0x40d048(0x7f)](_0x40d048(0x95)+_0xc36633);}_0x55a92e?.[_0x40d048(0x84)](_0x40d048(0x77))&&(_0x55a92e=_0x35ade1[_0x40d048(0x89)]),_0x35ade1[_0x40d048(0x86)]({'name':_0x4f2b5f,'profilePicUrl':_0x55a92e});}const _0x45a29a=new Date(_0x35ade1[_0x40d048(0x96)]),_0x38fe4c=new Date(),_0x1023ec=_0x38fe4c['getTime']()-_0x45a29a[_0x40d048(0x91)](),_0x24069b=Math[_0x40d048(0x80)](_0x1023ec/(0x3e8*0xe10*0x18));if(_0x24069b>=0x3){let _0x13ce3b;try{_0x13ce3b=await(0x0,GetProfilePicUrl_1[_0x40d048(0x7b)])(_0x5c4c6d,_0x1a23e9);}catch(_0x440bf5){console[_0x40d048(0x7f)](_0x40d048(0x88)+_0x440bf5);}_0x35ade1[_0x40d048(0x83)](_0x40d048(0x96),!![]),!_0x13ce3b?.[_0x40d048(0x84)](_0x40d048(0x77))?_0x35ade1[_0x40d048(0x86)]({'profilePicUrl':_0x13ce3b,'updatedAt':new Date()}):_0x35ade1[_0x40d048(0x86)]({'updatedAt':new Date()});}(0x0,lodash_1[_0x40d048(0x9f)])(_0x35ade1[_0x40d048(0x78)]===null)&&_0x35ade1[_0x40d048(0x86)]({'whatsappId':_0x10d0dc}),_0x304fa9['to'](_0x40d048(0x87)+_0x1a23e9+_0x40d048(0x9c))[_0x40d048(0x82)]('company-'+_0x1a23e9+_0x40d048(0x9b),{'action':_0x40d048(0x86),'contact':_0x35ade1});}else{let _0x5171b7;try{_0x5171b7=await(0x0,GetProfilePicUrl_1['default'])(_0x5c4c6d,_0x1a23e9);}catch(_0x246d8d){_0x5171b7=process[_0x40d048(0x75)][_0x40d048(0x92)]+_0x40d048(0x8c);}_0x35ade1=await Contact_1[_0x40d048(0x7b)][_0x40d048(0x81)]({'name':_0x4f2b5f,'number':_0xd2f308,'profilePicUrl':_0x5171b7,'email':email,'isGroup':_0x6226f3,'extraInfo':extraInfo,'companyId':_0x1a23e9,'disableBot':disableBot,'whatsappId':_0x10d0dc}),_0x304fa9['to']('company-'+_0x1a23e9+_0x40d048(0x9c))[_0x40d048(0x82)](_0x40d048(0x87)+_0x1a23e9+_0x40d048(0x9b),{'action':_0x40d048(0x81),'contact':_0x35ade1});}return _0x35ade1;};function a413_0x119c(_0x581e32,_0x3a3eac){const _0x35042a=a413_0x3574();return a413_0x119c=function(_0x20c95e,_0x32ef01){_0x20c95e=_0x20c95e-0x75;let _0x3574ab=_0x35042a[_0x20c95e];return _0x3574ab;},a413_0x119c(_0x581e32,_0x3a3eac);}exports['default']=CreateOrUpdateContactService;