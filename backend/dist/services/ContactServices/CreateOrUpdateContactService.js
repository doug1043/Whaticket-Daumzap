const a415_0x32e717=a415_0x4d41;(function(_0x54da9d,_0x3deccb){const _0x408466=a415_0x4d41,_0x5495f8=_0x54da9d();while(!![]){try{const _0x2db151=-parseInt(_0x408466(0xdc))/0x1+parseInt(_0x408466(0xf0))/0x2*(parseInt(_0x408466(0xef))/0x3)+parseInt(_0x408466(0xf5))/0x4+-parseInt(_0x408466(0xe3))/0x5+parseInt(_0x408466(0xe1))/0x6+-parseInt(_0x408466(0xea))/0x7*(-parseInt(_0x408466(0xdf))/0x8)+-parseInt(_0x408466(0xfd))/0x9;if(_0x2db151===_0x3deccb)break;else _0x5495f8['push'](_0x5495f8['shift']());}catch(_0x20a00e){_0x5495f8['push'](_0x5495f8['shift']());}}}(a415_0x58bd,0x48245));function a415_0x4d41(_0x96096c,_0x562c29){const _0x1021d2=a415_0x58bd();return a415_0x4d41=function(_0x37b76a,_0x36d5f3){_0x37b76a=_0x37b76a-0xd9;let _0x58bdd3=_0x1021d2[_0x37b76a];return _0x58bdd3;},a415_0x4d41(_0x96096c,_0x562c29);}const a415_0x36d5f3=(function(){let _0x5a17c6=!![];return function(_0x43b8c4,_0x5de603){const _0x1eb48b=_0x5a17c6?function(){const _0x599615=a415_0x4d41;if(_0x5de603){const _0x127a25=_0x5de603[_0x599615(0xe6)](_0x43b8c4,arguments);return _0x5de603=null,_0x127a25;}}:function(){};return _0x5a17c6=![],_0x1eb48b;};}()),a415_0x37b76a=a415_0x36d5f3(this,function(){const _0x4746dd=a415_0x4d41;return a415_0x37b76a[_0x4746dd(0x100)]()['search'](_0x4746dd(0xfb))['toString']()['constructor'](a415_0x37b76a)['search'](_0x4746dd(0xfb));});a415_0x37b76a();'use strict';var __importDefault=this&&this[a415_0x32e717(0xe8)]||function(_0x805bb0){const _0x139ff4=a415_0x32e717;return _0x805bb0&&_0x805bb0[_0x139ff4(0xdb)]?_0x805bb0:{'default':_0x805bb0};};function a415_0x58bd(){const _0x4c06ee=['39504AbuPnU','default','company-','updatedAt','ceil','nopicture.png','(((.+)+)+)+$','create','3313368lwlztq','getTime','-mainchannel','toString','profilePicUrl','emit','../WbotServices/GetProfilePicUrl','lodash','../../libs/socket','__esModule','258735ttekso','findOne','defineProperty','1243824beCRFH','getIO','3022374nduhag','match','584955NwPGmK','-contact','replace','apply','isNil','__importDefault','Error\x20getting\x20profile\x20picture\x202:\x20','14moXjTb','/nopicture.png','endsWith','../../models/Contact','changed','3oQsWHi','429620TruUoh','update','env','name','FRONTEND_URL'];a415_0x58bd=function(){return _0x4c06ee;};return a415_0x58bd();}Object[a415_0x32e717(0xde)](exports,a415_0x32e717(0xdb),{'value':!![]});const socket_1=require(a415_0x32e717(0xda)),Contact_1=__importDefault(require(a415_0x32e717(0xed))),lodash_1=require(a415_0x32e717(0xd9)),GetProfilePicUrl_1=__importDefault(require(a415_0x32e717(0x103))),CreateOrUpdateContactService=async({name:_0xdcd1de,number:_0x4a03d5,remoteJid:_0x1ba9c8,isGroup:_0x23faf4,email:email='',companyId:_0x443cfb,extraInfo:extraInfo=[],disableBot:disableBot=![],whatsappId:_0x28d29c},_0x1d6fd2,_0x360eb6)=>{const _0x1d2ae0=a415_0x32e717,_0x588d16=_0x23faf4?_0x4a03d5:_0x4a03d5[_0x1d2ae0(0xe5)](/[^0-9]/g,''),_0x3f6833=(0x0,socket_1[_0x1d2ae0(0xe0)])();let _0x563a16;_0x563a16=await Contact_1[_0x1d2ae0(0xf6)][_0x1d2ae0(0xdd)]({'where':{'number':_0x588d16,'companyId':_0x443cfb}});if(_0x563a16){if(_0xdcd1de&&(!_0x563a16[_0x1d2ae0(0xf3)]||_0x563a16[_0x1d2ae0(0xf3)][_0x1d2ae0(0xe2)](/^[0-9]*$/))&&!_0xdcd1de[_0x1d2ae0(0xe2)](/^[0-9]*$/)){_0x563a16['changed'](_0x1d2ae0(0xf3),!![]),_0x563a16[_0x1d2ae0(0xee)](_0x1d2ae0(0xf8),!![]);let _0x578a98;try{_0x578a98=await(0x0,GetProfilePicUrl_1[_0x1d2ae0(0xf6)])(_0x4a03d5,_0x443cfb);}catch(_0x24b3b8){console['log'](_0x1d2ae0(0xe9)+_0x24b3b8);}_0x578a98?.[_0x1d2ae0(0xec)](_0x1d2ae0(0xfa))&&(_0x578a98=_0x563a16[_0x1d2ae0(0x101)]),_0x563a16[_0x1d2ae0(0xf1)]({'name':_0xdcd1de,'profilePicUrl':_0x578a98});}const _0x24980c=new Date(_0x563a16[_0x1d2ae0(0xf8)]),_0x19ec35=new Date(),_0x4f1e6d=_0x19ec35[_0x1d2ae0(0xfe)]()-_0x24980c[_0x1d2ae0(0xfe)](),_0x6cb9cb=Math[_0x1d2ae0(0xf9)](_0x4f1e6d/(0x3e8*0xe10*0x18));if(_0x6cb9cb>=0x3){let _0x4d0895;try{_0x4d0895=await(0x0,GetProfilePicUrl_1[_0x1d2ae0(0xf6)])(_0x4a03d5,_0x443cfb);}catch(_0x1771d7){console['log']('Error\x20getting\x20profile\x20picture:\x20'+_0x1771d7);}_0x563a16[_0x1d2ae0(0xee)](_0x1d2ae0(0xf8),!![]),!_0x4d0895?.[_0x1d2ae0(0xec)](_0x1d2ae0(0xfa))?_0x563a16[_0x1d2ae0(0xf1)]({'profilePicUrl':_0x4d0895,'updatedAt':new Date()}):_0x563a16[_0x1d2ae0(0xf1)]({'updatedAt':new Date()});}(0x0,lodash_1[_0x1d2ae0(0xe7)])(_0x563a16['whatsappId']===null)&&_0x563a16[_0x1d2ae0(0xf1)]({'whatsappId':_0x28d29c}),_0x3f6833['to']('company-'+_0x443cfb+_0x1d2ae0(0xff))['emit']('company-'+_0x443cfb+'-contact',{'action':_0x1d2ae0(0xf1),'contact':_0x563a16});}else{let _0x4573a6;try{_0x4573a6=await(0x0,GetProfilePicUrl_1['default'])(_0x4a03d5,_0x443cfb);}catch(_0x2bbc16){_0x4573a6=process[_0x1d2ae0(0xf2)][_0x1d2ae0(0xf4)]+_0x1d2ae0(0xeb);}_0x563a16=await Contact_1['default'][_0x1d2ae0(0xfc)]({'name':_0xdcd1de,'number':_0x588d16,'profilePicUrl':_0x4573a6,'email':email,'isGroup':_0x23faf4,'extraInfo':extraInfo,'companyId':_0x443cfb,'disableBot':disableBot,'whatsappId':_0x28d29c}),_0x3f6833['to'](_0x1d2ae0(0xf7)+_0x443cfb+_0x1d2ae0(0xff))[_0x1d2ae0(0x102)](_0x1d2ae0(0xf7)+_0x443cfb+_0x1d2ae0(0xe4),{'action':_0x1d2ae0(0xfc),'contact':_0x563a16});}return _0x563a16;};exports[a415_0x32e717(0xf6)]=CreateOrUpdateContactService;