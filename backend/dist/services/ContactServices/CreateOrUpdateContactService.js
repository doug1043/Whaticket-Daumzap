const a411_0x58be97=a411_0x4006;(function(_0x276765,_0x463857){const _0x2f33a1=a411_0x4006,_0x5ef42b=_0x276765();while(!![]){try{const _0x4efa44=parseInt(_0x2f33a1(0x1d0))/0x1*(-parseInt(_0x2f33a1(0x1b4))/0x2)+-parseInt(_0x2f33a1(0x1b2))/0x3+-parseInt(_0x2f33a1(0x1bf))/0x4+-parseInt(_0x2f33a1(0x1bb))/0x5*(-parseInt(_0x2f33a1(0x1d8))/0x6)+parseInt(_0x2f33a1(0x1d1))/0x7*(-parseInt(_0x2f33a1(0x1b6))/0x8)+parseInt(_0x2f33a1(0x1c5))/0x9+parseInt(_0x2f33a1(0x1be))/0xa;if(_0x4efa44===_0x463857)break;else _0x5ef42b['push'](_0x5ef42b['shift']());}catch(_0x4bb9c5){_0x5ef42b['push'](_0x5ef42b['shift']());}}}(a411_0x1e5c,0x9fdbd));const a411_0x58451e=(function(){let _0x232ad7=!![];return function(_0x22d155,_0x231dad){const _0x2e1bef=_0x232ad7?function(){if(_0x231dad){const _0x29c056=_0x231dad['apply'](_0x22d155,arguments);return _0x231dad=null,_0x29c056;}}:function(){};return _0x232ad7=![],_0x2e1bef;};}()),a411_0x3e4b30=a411_0x58451e(this,function(){const _0xd1b300=a411_0x4006;return a411_0x3e4b30[_0xd1b300(0x1b1)]()[_0xd1b300(0x1d5)](_0xd1b300(0x1d9))[_0xd1b300(0x1b1)]()[_0xd1b300(0x1cc)](a411_0x3e4b30)[_0xd1b300(0x1d5)](_0xd1b300(0x1d9));});a411_0x3e4b30();'use strict';var __importDefault=this&&this[a411_0x58be97(0x1c6)]||function(_0x3fc623){const _0x19ef48=a411_0x58be97;return _0x3fc623&&_0x3fc623[_0x19ef48(0x1d6)]?_0x3fc623:{'default':_0x3fc623};};function a411_0x1e5c(){const _0x185d22=['isNil','/nopicture.png','15dOKdnJ','whatsappId','updatedAt','19445160bqzPmX','460704AaKGLq','-mainchannel','replace','changed','profilePicUrl','create','6771033QbhHaV','__importDefault','defineProperty','company-','name','Error\x20getting\x20profile\x20picture:\x20','-contact','constructor','ceil','../WbotServices/GetProfilePicUrl','nopicture.png','7xhcjhC','8407049NuBltq','../../libs/socket','update','getTime','search','__esModule','match','1708890JCKbGS','(((.+)+)+)+$','log','FRONTEND_URL','toString','884205YLgCSj','default','367314NRHXmO','../../models/Contact','8jwOjDC','env','endsWith'];a411_0x1e5c=function(){return _0x185d22;};return a411_0x1e5c();}function a411_0x4006(_0x186a79,_0x363978){const _0x357f9f=a411_0x1e5c();return a411_0x4006=function(_0x3e4b30,_0x58451e){_0x3e4b30=_0x3e4b30-0x1af;let _0x1e5cd7=_0x357f9f[_0x3e4b30];return _0x1e5cd7;},a411_0x4006(_0x186a79,_0x363978);}Object[a411_0x58be97(0x1c7)](exports,'__esModule',{'value':!![]});const socket_1=require(a411_0x58be97(0x1d2)),Contact_1=__importDefault(require(a411_0x58be97(0x1b5))),lodash_1=require('lodash'),GetProfilePicUrl_1=__importDefault(require(a411_0x58be97(0x1ce))),CreateOrUpdateContactService=async({name:_0x481f37,number:_0x186543,remoteJid:_0x1ac091,isGroup:_0x424093,email:email='',companyId:_0x2d0bb2,extraInfo:extraInfo=[],disableBot:disableBot=![],whatsappId:_0x2e1941},_0x1901f1,_0x2f5ec8)=>{const _0x37c740=a411_0x58be97,_0x296a28=_0x424093?_0x186543:_0x186543[_0x37c740(0x1c1)](/[^0-9]/g,''),_0x56caae=(0x0,socket_1['getIO'])();let _0x2c55bd;_0x2c55bd=await Contact_1[_0x37c740(0x1b3)]['findOne']({'where':{'number':_0x296a28,'companyId':_0x2d0bb2}});if(_0x2c55bd){if(_0x481f37&&(!_0x2c55bd[_0x37c740(0x1c9)]||_0x2c55bd[_0x37c740(0x1c9)][_0x37c740(0x1d7)](/^[0-9]*$/))&&!_0x481f37['match'](/^[0-9]*$/)){_0x2c55bd[_0x37c740(0x1c2)](_0x37c740(0x1c9),!![]),_0x2c55bd[_0x37c740(0x1c2)](_0x37c740(0x1bd),!![]);let _0x550e1e;try{_0x550e1e=await(0x0,GetProfilePicUrl_1[_0x37c740(0x1b3)])(_0x186543,_0x2d0bb2);}catch(_0xb1541b){console[_0x37c740(0x1af)]('Error\x20getting\x20profile\x20picture\x202:\x20'+_0xb1541b);}_0x550e1e?.[_0x37c740(0x1b8)](_0x37c740(0x1cf))&&(_0x550e1e=_0x2c55bd[_0x37c740(0x1c3)]),_0x2c55bd[_0x37c740(0x1d3)]({'name':_0x481f37,'profilePicUrl':_0x550e1e});}const _0x46365f=new Date(_0x2c55bd[_0x37c740(0x1bd)]),_0x4a35d1=new Date(),_0x1d4e0e=_0x4a35d1[_0x37c740(0x1d4)]()-_0x46365f['getTime'](),_0x49c5eb=Math[_0x37c740(0x1cd)](_0x1d4e0e/(0x3e8*0xe10*0x18));if(_0x49c5eb>=0x3){let _0x1492d6;try{_0x1492d6=await(0x0,GetProfilePicUrl_1[_0x37c740(0x1b3)])(_0x186543,_0x2d0bb2);}catch(_0x352843){console[_0x37c740(0x1af)](_0x37c740(0x1ca)+_0x352843);}_0x2c55bd['changed'](_0x37c740(0x1bd),!![]),!_0x1492d6?.[_0x37c740(0x1b8)](_0x37c740(0x1cf))?_0x2c55bd['update']({'profilePicUrl':_0x1492d6,'updatedAt':new Date()}):_0x2c55bd['update']({'updatedAt':new Date()});}(0x0,lodash_1[_0x37c740(0x1b9)])(_0x2c55bd[_0x37c740(0x1bc)]===null)&&_0x2c55bd['update']({'whatsappId':_0x2e1941}),_0x56caae['to']('company-'+_0x2d0bb2+'-mainchannel')['emit'](_0x37c740(0x1c8)+_0x2d0bb2+_0x37c740(0x1cb),{'action':_0x37c740(0x1d3),'contact':_0x2c55bd});}else{let _0x17ffac;try{_0x17ffac=await(0x0,GetProfilePicUrl_1[_0x37c740(0x1b3)])(_0x186543,_0x2d0bb2);}catch(_0x2c4fcb){_0x17ffac=process[_0x37c740(0x1b7)][_0x37c740(0x1b0)]+_0x37c740(0x1ba);}_0x2c55bd=await Contact_1[_0x37c740(0x1b3)][_0x37c740(0x1c4)]({'name':_0x481f37,'number':_0x296a28,'profilePicUrl':_0x17ffac,'email':email,'isGroup':_0x424093,'extraInfo':extraInfo,'companyId':_0x2d0bb2,'disableBot':disableBot,'whatsappId':_0x2e1941}),_0x56caae['to'](_0x37c740(0x1c8)+_0x2d0bb2+_0x37c740(0x1c0))['emit'](_0x37c740(0x1c8)+_0x2d0bb2+_0x37c740(0x1cb),{'action':_0x37c740(0x1c4),'contact':_0x2c55bd});}return _0x2c55bd;};exports[a411_0x58be97(0x1b3)]=CreateOrUpdateContactService;