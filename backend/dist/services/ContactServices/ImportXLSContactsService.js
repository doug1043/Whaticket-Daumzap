const a418_0x5b7a05=a418_0x44a1;(function(_0x576493,_0x53e73f){const _0x4bdb0c=a418_0x44a1,_0x3328b1=_0x576493();while(!![]){try{const _0x12cce1=parseInt(_0x4bdb0c(0x19b))/0x1+-parseInt(_0x4bdb0c(0x174))/0x2*(-parseInt(_0x4bdb0c(0x180))/0x3)+-parseInt(_0x4bdb0c(0x185))/0x4*(-parseInt(_0x4bdb0c(0x194))/0x5)+parseInt(_0x4bdb0c(0x19e))/0x6*(-parseInt(_0x4bdb0c(0x182))/0x7)+parseInt(_0x4bdb0c(0x186))/0x8*(parseInt(_0x4bdb0c(0x181))/0x9)+parseInt(_0x4bdb0c(0x176))/0xa*(-parseInt(_0x4bdb0c(0x188))/0xb)+parseInt(_0x4bdb0c(0x17a))/0xc*(-parseInt(_0x4bdb0c(0x197))/0xd);if(_0x12cce1===_0x53e73f)break;else _0x3328b1['push'](_0x3328b1['shift']());}catch(_0x11cd6c){_0x3328b1['push'](_0x3328b1['shift']());}}}(a418_0x449a,0x79a11));const a418_0x2f2bec=(function(){let _0x6f00f=!![];return function(_0x12df52,_0x31c297){const _0x173013=_0x6f00f?function(){if(_0x31c297){const _0x2262d6=_0x31c297['apply'](_0x12df52,arguments);return _0x31c297=null,_0x2262d6;}}:function(){};return _0x6f00f=![],_0x173013;};}()),a418_0x114ea6=a418_0x2f2bec(this,function(){const _0x197988=a418_0x44a1;return a418_0x114ea6[_0x197988(0x19d)]()['search']('(((.+)+)+)+$')[_0x197988(0x19d)]()[_0x197988(0x184)](a418_0x114ea6)[_0x197988(0x16f)](_0x197988(0x196));});a418_0x114ea6();'use strict';function a418_0x449a(){const _0xb1df78=['NUMBER','../../utils/logger','default','135aZFNnH','lodash','(((.+)+)+)+$','26XsLOUL','head','E-mail','ImportXLSContactsService','968821CtVPXB','__esModule','toString','87060xqNtHr','map','sheet_to_json','NAME','search','Numero','xlsx','../../models/Contact','logger','110754hBbkgv','number','4240090wtBBOG','Número\x20de\x20contato\x20inválido:\x20','número','error','2980392UHYSKs','has','EMAIL','jid','e-mail','path','15naPEzg','126EoQVWh','161wacpvI','replace','constructor','109892ztCagO','108112NNNfCv','numero','22fNlDDl','Número','email','../WbotServices/CheckNumber','readFile','push','save','findOrCreate','defineProperty'];a418_0x449a=function(){return _0xb1df78;};return a418_0x449a();}function a418_0x44a1(_0x3cd291,_0x54ded3){const _0x2c0448=a418_0x449a();return a418_0x44a1=function(_0x114ea6,_0x2f2bec){_0x114ea6=_0x114ea6-0x16f;let _0x449a25=_0x2c0448[_0x114ea6];return _0x449a25;},a418_0x44a1(_0x3cd291,_0x54ded3);}var __importDefault=this&&this['__importDefault']||function(_0x543f15){return _0x543f15&&_0x543f15['__esModule']?_0x543f15:{'default':_0x543f15};};Object[a418_0x5b7a05(0x190)](exports,a418_0x5b7a05(0x19c),{'value':!![]}),exports['ImportXLSContactsService']=void 0x0;const lodash_1=require(a418_0x5b7a05(0x195)),xlsx_1=__importDefault(require(a418_0x5b7a05(0x171))),lodash_2=require(a418_0x5b7a05(0x195)),CheckNumber_1=__importDefault(require(a418_0x5b7a05(0x18b))),logger_1=require(a418_0x5b7a05(0x192)),Contact_1=__importDefault(require(a418_0x5b7a05(0x172))),attrNames={'NAME':['nome','Nome'],'NUMBER':[a418_0x5b7a05(0x187),a418_0x5b7a05(0x178),a418_0x5b7a05(0x170),a418_0x5b7a05(0x189)],'EMAIL':[a418_0x5b7a05(0x18a),a418_0x5b7a05(0x17e),'Email',a418_0x5b7a05(0x199)]};function extractContact(_0x5488c6,_0x21c51b){const _0x28960a=a418_0x5b7a05,_0x11a41d=getValue(_0x5488c6,attrNames[_0x28960a(0x1a1)]);let _0x2ee074=getValue(_0x5488c6,attrNames[_0x28960a(0x191)]);_0x2ee074=(''+_0x2ee074)[_0x28960a(0x183)](/\D/g,'');const _0x191678=getValue(_0x5488c6,attrNames[_0x28960a(0x17c)]);return{'name':_0x11a41d,'number':_0x2ee074,'email':_0x191678,'companyId':_0x21c51b};}function getValue(_0x36b0e3,_0x696878){const _0x5b07d8=a418_0x5b7a05;for(const _0x52239e of _0x696878){if((0x0,lodash_2[_0x5b07d8(0x17b)])(_0x36b0e3,_0x52239e))return _0x36b0e3[_0x52239e];}return'';}async function ImportXLSContactsService(_0x322ed8,_0x140f78){const _0x5b639a=a418_0x5b7a05,_0x4cb110=xlsx_1['default'][_0x5b639a(0x18c)](_0x140f78?.[_0x5b639a(0x17f)]),_0x3fc727=(0x0,lodash_1[_0x5b639a(0x198)])(Object['values'](_0x4cb110['Sheets'])),_0x22b438=xlsx_1[_0x5b639a(0x193)]['utils'][_0x5b639a(0x1a0)](_0x3fc727,{'header':0x0}),_0x4bf727=_0x22b438[_0x5b639a(0x19f)](_0xd234df=>extractContact(_0xd234df,_0x322ed8)),_0x556ae1=[];for(const _0x11a5d4 of _0x4bf727){const [_0x1229c3,_0x211cf4]=await Contact_1['default'][_0x5b639a(0x18f)]({'where':{'number':''+_0x11a5d4['number'],'companyId':_0x11a5d4['companyId']},'defaults':_0x11a5d4});_0x211cf4&&_0x556ae1[_0x5b639a(0x18d)](_0x1229c3);}if(_0x556ae1)for(let _0x56f59e of _0x556ae1){try{const _0x49e6d5=await(0x0,CheckNumber_1[_0x5b639a(0x193)])(_0x56f59e['number'],_0x322ed8),_0x301535=_0x49e6d5[_0x5b639a(0x17d)][_0x5b639a(0x183)](/\D/g,'');_0x56f59e[_0x5b639a(0x175)]=_0x301535,await _0x56f59e[_0x5b639a(0x18e)]();}catch(_0x3a6dd3){logger_1[_0x5b639a(0x173)][_0x5b639a(0x179)](_0x5b639a(0x177)+_0x56f59e[_0x5b639a(0x175)]);}}return _0x556ae1;}exports[a418_0x5b7a05(0x19a)]=ImportXLSContactsService;