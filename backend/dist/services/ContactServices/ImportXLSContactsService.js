function a417_0x15c7(){const _0x167624=['defineProperty','__esModule','Número\x20de\x20contato\x20inválido:\x20','has','Número','head','EMAIL','numero','../WbotServices/CheckNumber','Sheets','(((.+)+)+)+$','companyId','Email','findOrCreate','push','6FNZKlr','logger','lodash','save','__importDefault','2915iLUOfZ','3239000tRMkrC','default','search','../../utils/logger','nome','../../models/Contact','values','2208017OKXCJS','replace','4632RyLfkB','toString','e-mail','path','NAME','428542peIKcK','987628Zjqrcf','1834767lRPiLA','utils','number','Nome','xlsx','Numero','map','error','137265owEMaW','ImportXLSContactsService','readFile'];a417_0x15c7=function(){return _0x167624;};return a417_0x15c7();}const a417_0x1df9ec=a417_0x3ad6;(function(_0x4687b0,_0x3ee075){const _0x22ba08=a417_0x3ad6,_0x26b770=_0x4687b0();while(!![]){try{const _0x3e7ebd=-parseInt(_0x22ba08(0x16f))/0x1+-parseInt(_0x22ba08(0x165))/0x2+parseInt(_0x22ba08(0x151))/0x3*(parseInt(_0x22ba08(0x166))/0x4)+-parseInt(_0x22ba08(0x156))/0x5*(-parseInt(_0x22ba08(0x160))/0x6)+parseInt(_0x22ba08(0x15e))/0x7+-parseInt(_0x22ba08(0x157))/0x8+-parseInt(_0x22ba08(0x167))/0x9;if(_0x3e7ebd===_0x3ee075)break;else _0x26b770['push'](_0x26b770['shift']());}catch(_0x1ae111){_0x26b770['push'](_0x26b770['shift']());}}}(a417_0x15c7,0x49027));const a417_0x31a4e8=(function(){let _0x1e9ac1=!![];return function(_0x3f76da,_0x29ddef){const _0x149850=_0x1e9ac1?function(){if(_0x29ddef){const _0x58ec44=_0x29ddef['apply'](_0x3f76da,arguments);return _0x29ddef=null,_0x58ec44;}}:function(){};return _0x1e9ac1=![],_0x149850;};}()),a417_0x5a8386=a417_0x31a4e8(this,function(){const _0x3a2d9a=a417_0x3ad6;return a417_0x5a8386[_0x3a2d9a(0x161)]()['search'](_0x3a2d9a(0x17c))[_0x3a2d9a(0x161)]()['constructor'](a417_0x5a8386)[_0x3a2d9a(0x159)](_0x3a2d9a(0x17c));});a417_0x5a8386();'use strict';var __importDefault=this&&this[a417_0x1df9ec(0x155)]||function(_0x40c6d6){const _0x3655ad=a417_0x1df9ec;return _0x40c6d6&&_0x40c6d6[_0x3655ad(0x173)]?_0x40c6d6:{'default':_0x40c6d6};};function a417_0x3ad6(_0x751821,_0x84c5a3){const _0x3132de=a417_0x15c7();return a417_0x3ad6=function(_0x5a8386,_0x31a4e8){_0x5a8386=_0x5a8386-0x150;let _0x15c722=_0x3132de[_0x5a8386];return _0x15c722;},a417_0x3ad6(_0x751821,_0x84c5a3);}Object[a417_0x1df9ec(0x172)](exports,'__esModule',{'value':!![]}),exports[a417_0x1df9ec(0x170)]=void 0x0;const lodash_1=require(a417_0x1df9ec(0x153)),xlsx_1=__importDefault(require(a417_0x1df9ec(0x16b))),lodash_2=require(a417_0x1df9ec(0x153)),CheckNumber_1=__importDefault(require(a417_0x1df9ec(0x17a))),logger_1=require(a417_0x1df9ec(0x15a)),Contact_1=__importDefault(require(a417_0x1df9ec(0x15c))),attrNames={'NAME':[a417_0x1df9ec(0x15b),a417_0x1df9ec(0x16a)],'NUMBER':[a417_0x1df9ec(0x179),'número',a417_0x1df9ec(0x16c),a417_0x1df9ec(0x176)],'EMAIL':['email',a417_0x1df9ec(0x162),a417_0x1df9ec(0x17e),'E-mail']};function extractContact(_0x348567,_0x4912b4){const _0x1909f1=a417_0x1df9ec,_0x17b518=getValue(_0x348567,attrNames[_0x1909f1(0x164)]);let _0x531606=getValue(_0x348567,attrNames['NUMBER']);_0x531606=(''+_0x531606)[_0x1909f1(0x15f)](/\D/g,'');const _0x440a93=getValue(_0x348567,attrNames[_0x1909f1(0x178)]);return{'name':_0x17b518,'number':_0x531606,'email':_0x440a93,'companyId':_0x4912b4};}function getValue(_0x59fe61,_0xb43f91){const _0x5e54d1=a417_0x1df9ec;for(const _0x5c37a6 of _0xb43f91){if((0x0,lodash_2[_0x5e54d1(0x175)])(_0x59fe61,_0x5c37a6))return _0x59fe61[_0x5c37a6];}return'';}async function ImportXLSContactsService(_0x597ce2,_0x40de7d){const _0x4ca39f=a417_0x1df9ec,_0x4280d5=xlsx_1['default'][_0x4ca39f(0x171)](_0x40de7d?.[_0x4ca39f(0x163)]),_0x22d90a=(0x0,lodash_1[_0x4ca39f(0x177)])(Object[_0x4ca39f(0x15d)](_0x4280d5[_0x4ca39f(0x17b)])),_0x3a5e5f=xlsx_1[_0x4ca39f(0x158)][_0x4ca39f(0x168)]['sheet_to_json'](_0x22d90a,{'header':0x0}),_0x5e2dc7=_0x3a5e5f[_0x4ca39f(0x16d)](_0x3bac70=>extractContact(_0x3bac70,_0x597ce2)),_0x2417c9=[];for(const _0x158e9c of _0x5e2dc7){const [_0x44843e,_0x39d0a1]=await Contact_1['default'][_0x4ca39f(0x17f)]({'where':{'number':''+_0x158e9c[_0x4ca39f(0x169)],'companyId':_0x158e9c[_0x4ca39f(0x17d)]},'defaults':_0x158e9c});_0x39d0a1&&_0x2417c9[_0x4ca39f(0x150)](_0x44843e);}if(_0x2417c9)for(let _0x5d029e of _0x2417c9){try{const _0x5aa300=await(0x0,CheckNumber_1[_0x4ca39f(0x158)])(_0x5d029e[_0x4ca39f(0x169)],_0x597ce2),_0x30f102=_0x5aa300['jid'][_0x4ca39f(0x15f)](/\D/g,'');_0x5d029e[_0x4ca39f(0x169)]=_0x30f102,await _0x5d029e[_0x4ca39f(0x154)]();}catch(_0x1033c1){logger_1[_0x4ca39f(0x152)][_0x4ca39f(0x16e)](_0x4ca39f(0x174)+_0x5d029e[_0x4ca39f(0x169)]);}}return _0x2417c9;}exports[a417_0x1df9ec(0x170)]=ImportXLSContactsService;