const a415_0x45c387=a415_0x1ade;(function(_0x2fc4ab,_0xe0da05){const _0x4673b5=a415_0x1ade,_0x4dc27a=_0x2fc4ab();while(!![]){try{const _0xe119ce=parseInt(_0x4673b5(0x15e))/0x1*(parseInt(_0x4673b5(0x156))/0x2)+parseInt(_0x4673b5(0x151))/0x3*(parseInt(_0x4673b5(0x15d))/0x4)+-parseInt(_0x4673b5(0x16b))/0x5+parseInt(_0x4673b5(0x152))/0x6+parseInt(_0x4673b5(0x164))/0x7+parseInt(_0x4673b5(0x16e))/0x8*(-parseInt(_0x4673b5(0x177))/0x9)+-parseInt(_0x4673b5(0x175))/0xa*(parseInt(_0x4673b5(0x14f))/0xb);if(_0xe119ce===_0xe0da05)break;else _0x4dc27a['push'](_0x4dc27a['shift']());}catch(_0x5de1a4){_0x4dc27a['push'](_0x4dc27a['shift']());}}}(a415_0x537d,0x27811));const a415_0x4f9f3a=(function(){let _0x131719=!![];return function(_0x3d8d5c,_0xbe8439){const _0x3768aa=_0x131719?function(){const _0x25ef5f=a415_0x1ade;if(_0xbe8439){const _0x50c98e=_0xbe8439[_0x25ef5f(0x165)](_0x3d8d5c,arguments);return _0xbe8439=null,_0x50c98e;}}:function(){};return _0x131719=![],_0x3768aa;};}()),a415_0x215c5c=a415_0x4f9f3a(this,function(){const _0xd7eacd=a415_0x1ade;return a415_0x215c5c[_0xd7eacd(0x160)]()['search']('(((.+)+)+)+$')['toString']()[_0xd7eacd(0x166)](a415_0x215c5c)[_0xd7eacd(0x161)](_0xd7eacd(0x16c));});a415_0x215c5c();'use strict';var __importDefault=this&&this[a415_0x45c387(0x16d)]||function(_0x58ba58){return _0x58ba58&&_0x58ba58['__esModule']?_0x58ba58:{'default':_0x58ba58};};function a415_0x1ade(_0x4a5b27,_0x323eac){const _0x2441b2=a415_0x537d();return a415_0x1ade=function(_0x215c5c,_0x4f9f3a){_0x215c5c=_0x215c5c-0x14e;let _0x537d08=_0x2441b2[_0x215c5c];return _0x537d08;},a415_0x1ade(_0x4a5b27,_0x323eac);}Object[a415_0x45c387(0x170)](exports,'__esModule',{'value':!![]}),exports[a415_0x45c387(0x16f)]=void 0x0;const lodash_1=require('lodash'),xlsx_1=__importDefault(require(a415_0x45c387(0x159))),lodash_2=require(a415_0x45c387(0x169)),CheckNumber_1=__importDefault(require('../WbotServices/CheckNumber')),logger_1=require('../../utils/logger'),Contact_1=__importDefault(require(a415_0x45c387(0x171))),attrNames={'NAME':['nome','Nome'],'NUMBER':[a415_0x45c387(0x15f),'número',a415_0x45c387(0x14e),a415_0x45c387(0x15a)],'EMAIL':['email',a415_0x45c387(0x153),a415_0x45c387(0x155),'E-mail']};function a415_0x537d(){const _0x36ffd0=['path','jid','lodash','NAME','523080IeyVpw','(((.+)+)+)+$','__importDefault','8ZVLeAd','ImportXLSContactsService','defineProperty','../../models/Contact','EMAIL','has','readFile','40cMNWqU','values','1747647BoeWpO','number','findOrCreate','Numero','274637TujXLV','map','1977AlFNvu','224910OPTcPs','e-mail','utils','Email','286yYKVsJ','Número\x20de\x20contato\x20inválido:\x20','default','xlsx','Número','head','error','1124BaOZyT','2054xXedse','numero','toString','search','replace','NUMBER','308630twJNjZ','apply','constructor'];a415_0x537d=function(){return _0x36ffd0;};return a415_0x537d();}function extractContact(_0x21ba50,_0x464863){const _0x4b9e5a=a415_0x45c387,_0x8871bf=getValue(_0x21ba50,attrNames[_0x4b9e5a(0x16a)]);let _0x400fad=getValue(_0x21ba50,attrNames[_0x4b9e5a(0x163)]);_0x400fad=(''+_0x400fad)[_0x4b9e5a(0x162)](/\D/g,'');const _0xf1d8be=getValue(_0x21ba50,attrNames[_0x4b9e5a(0x172)]);return{'name':_0x8871bf,'number':_0x400fad,'email':_0xf1d8be,'companyId':_0x464863};}function getValue(_0x2eda7d,_0x52a460){const _0x29c849=a415_0x45c387;for(const _0x156eff of _0x52a460){if((0x0,lodash_2[_0x29c849(0x173)])(_0x2eda7d,_0x156eff))return _0x2eda7d[_0x156eff];}return'';}async function ImportXLSContactsService(_0x29e1eb,_0x546144){const _0x41505a=a415_0x45c387,_0x1cd9fe=xlsx_1[_0x41505a(0x158)][_0x41505a(0x174)](_0x546144?.[_0x41505a(0x167)]),_0x4ddc13=(0x0,lodash_1[_0x41505a(0x15b)])(Object[_0x41505a(0x176)](_0x1cd9fe['Sheets'])),_0x4abe05=xlsx_1[_0x41505a(0x158)][_0x41505a(0x154)]['sheet_to_json'](_0x4ddc13,{'header':0x0}),_0x21e6a1=_0x4abe05[_0x41505a(0x150)](_0x46b93b=>extractContact(_0x46b93b,_0x29e1eb)),_0x3ffba2=[];for(const _0x425d31 of _0x21e6a1){try{const _0x1b26a2=await(0x0,CheckNumber_1[_0x41505a(0x158)])(_0x425d31[_0x41505a(0x178)],_0x29e1eb),_0x3f1930=_0x1b26a2[_0x41505a(0x168)][_0x41505a(0x162)](/\D/g,''),[_0x365438,_0x198092]=await Contact_1['default'][_0x41505a(0x179)]({'where':{'number':''+_0x3f1930,'companyId':_0x425d31['companyId']},'defaults':{..._0x425d31,'number':_0x3f1930}});_0x198092&&_0x3ffba2['push'](_0x365438);}catch(_0x14e927){logger_1['logger'][_0x41505a(0x15c)](_0x41505a(0x157)+_0x425d31[_0x41505a(0x178)]);}}return _0x3ffba2;}exports['ImportXLSContactsService']=ImportXLSContactsService;