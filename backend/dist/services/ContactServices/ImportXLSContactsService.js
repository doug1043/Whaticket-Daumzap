const a419_0x3093c1=a419_0x5981;(function(_0x201056,_0x234ee9){const _0x68abf1=a419_0x5981,_0x5ac9a2=_0x201056();while(!![]){try{const _0x4bef66=parseInt(_0x68abf1(0x158))/0x1*(parseInt(_0x68abf1(0x154))/0x2)+parseInt(_0x68abf1(0x16c))/0x3*(parseInt(_0x68abf1(0x16a))/0x4)+-parseInt(_0x68abf1(0x175))/0x5+parseInt(_0x68abf1(0x16b))/0x6*(parseInt(_0x68abf1(0x165))/0x7)+-parseInt(_0x68abf1(0x14f))/0x8*(-parseInt(_0x68abf1(0x16d))/0x9)+parseInt(_0x68abf1(0x16f))/0xa+parseInt(_0x68abf1(0x169))/0xb;if(_0x4bef66===_0x234ee9)break;else _0x5ac9a2['push'](_0x5ac9a2['shift']());}catch(_0x25ecdd){_0x5ac9a2['push'](_0x5ac9a2['shift']());}}}(a419_0x586c,0x89eee));const a419_0x50bbfc=(function(){let _0x48d367=!![];return function(_0x1d6a38,_0x280336){const _0x5d8b32=_0x48d367?function(){const _0x48815b=a419_0x5981;if(_0x280336){const _0x351da4=_0x280336[_0x48815b(0x168)](_0x1d6a38,arguments);return _0x280336=null,_0x351da4;}}:function(){};return _0x48d367=![],_0x5d8b32;};}()),a419_0x39e6bf=a419_0x50bbfc(this,function(){const _0x2708e3=a419_0x5981;return a419_0x39e6bf[_0x2708e3(0x177)]()['search'](_0x2708e3(0x157))[_0x2708e3(0x177)]()[_0x2708e3(0x173)](a419_0x39e6bf)[_0x2708e3(0x16e)](_0x2708e3(0x157));});a419_0x39e6bf();function a419_0x586c(){const _0x786e6c=['ImportXLSContactsService','utils','NUMBER','constructor','companyId','5536975PZmYVR','logger','toString','has','jid','E-mail','457712aHeLXx','EMAIL','e-mail','Email','readFile','230cVZsmn','Sheets','save','(((.+)+)+)+$','3849IkpPgN','numero','replace','path','Número\x20de\x20contato\x20inválido:\x20','findOrCreate','default','xlsx','lodash','__esModule','../WbotServices/CheckNumber','Numero','error','2081163QFScuA','number','head','apply','2419813QkORuU','20uCzCro','6MfhOqb','154209CNsxmJ','36mQcLZc','search','2265710YOQFTd'];a419_0x586c=function(){return _0x786e6c;};return a419_0x586c();}'use strict';function a419_0x5981(_0x4d1fa6,_0x168e2a){const _0x2f86e7=a419_0x586c();return a419_0x5981=function(_0x39e6bf,_0x50bbfc){_0x39e6bf=_0x39e6bf-0x14c;let _0x586c74=_0x2f86e7[_0x39e6bf];return _0x586c74;},a419_0x5981(_0x4d1fa6,_0x168e2a);}var __importDefault=this&&this['__importDefault']||function(_0x310607){const _0x1abd79=a419_0x5981;return _0x310607&&_0x310607[_0x1abd79(0x161)]?_0x310607:{'default':_0x310607};};Object['defineProperty'](exports,'__esModule',{'value':!![]}),exports[a419_0x3093c1(0x170)]=void 0x0;const lodash_1=require(a419_0x3093c1(0x160)),xlsx_1=__importDefault(require(a419_0x3093c1(0x15f))),lodash_2=require(a419_0x3093c1(0x160)),CheckNumber_1=__importDefault(require(a419_0x3093c1(0x162))),logger_1=require('../../utils/logger'),Contact_1=__importDefault(require('../../models/Contact')),attrNames={'NAME':['nome','Nome'],'NUMBER':[a419_0x3093c1(0x159),'número',a419_0x3093c1(0x163),'Número'],'EMAIL':['email',a419_0x3093c1(0x151),a419_0x3093c1(0x152),a419_0x3093c1(0x14e)]};function extractContact(_0x29a96c,_0x19e36d){const _0x15b854=a419_0x3093c1,_0x2d7897=getValue(_0x29a96c,attrNames['NAME']);let _0x575521=getValue(_0x29a96c,attrNames[_0x15b854(0x172)]);_0x575521=(''+_0x575521)[_0x15b854(0x15a)](/\D/g,'');const _0x42e962=getValue(_0x29a96c,attrNames[_0x15b854(0x150)]);return{'name':_0x2d7897,'number':_0x575521,'email':_0x42e962,'companyId':_0x19e36d};}function getValue(_0x4d3e1b,_0xed6609){const _0x1e3303=a419_0x3093c1;for(const _0x2645b8 of _0xed6609){if((0x0,lodash_2[_0x1e3303(0x14c)])(_0x4d3e1b,_0x2645b8))return _0x4d3e1b[_0x2645b8];}return'';}async function ImportXLSContactsService(_0xe99bbf,_0xb8c26){const _0x2829ab=a419_0x3093c1,_0x36b78d=xlsx_1[_0x2829ab(0x15e)][_0x2829ab(0x153)](_0xb8c26?.[_0x2829ab(0x15b)]),_0x3c42b5=(0x0,lodash_1[_0x2829ab(0x167)])(Object['values'](_0x36b78d[_0x2829ab(0x155)])),_0x2ab254=xlsx_1[_0x2829ab(0x15e)][_0x2829ab(0x171)]['sheet_to_json'](_0x3c42b5,{'header':0x0}),_0x49de87=_0x2ab254['map'](_0x59b1f4=>extractContact(_0x59b1f4,_0xe99bbf)),_0x26b212=[];for(const _0x93056b of _0x49de87){const [_0x48e180,_0x146352]=await Contact_1['default'][_0x2829ab(0x15d)]({'where':{'number':''+_0x93056b[_0x2829ab(0x166)],'companyId':_0x93056b[_0x2829ab(0x174)]},'defaults':_0x93056b});_0x146352&&_0x26b212['push'](_0x48e180);}if(_0x26b212)for(let _0xea7c56 of _0x26b212){try{const _0x53ce4c=await(0x0,CheckNumber_1[_0x2829ab(0x15e)])(_0xea7c56[_0x2829ab(0x166)],_0xe99bbf),_0xde8e33=_0x53ce4c[_0x2829ab(0x14d)][_0x2829ab(0x15a)](/\D/g,'');_0xea7c56[_0x2829ab(0x166)]=_0xde8e33,await _0xea7c56[_0x2829ab(0x156)]();}catch(_0x55be59){logger_1[_0x2829ab(0x176)][_0x2829ab(0x164)](_0x2829ab(0x15c)+_0xea7c56[_0x2829ab(0x166)]);}}return _0x26b212;}exports['ImportXLSContactsService']=ImportXLSContactsService;