const a417_0x26ab3c=a417_0x24e9;(function(_0x1fd5f7,_0x5c46f4){const _0x5bed43=a417_0x24e9,_0x219665=_0x1fd5f7();while(!![]){try{const _0x41cccd=parseInt(_0x5bed43(0x153))/0x1+-parseInt(_0x5bed43(0x15b))/0x2+-parseInt(_0x5bed43(0x143))/0x3*(-parseInt(_0x5bed43(0x14a))/0x4)+parseInt(_0x5bed43(0x149))/0x5*(-parseInt(_0x5bed43(0x13f))/0x6)+parseInt(_0x5bed43(0x15c))/0x7+-parseInt(_0x5bed43(0x136))/0x8+-parseInt(_0x5bed43(0x13b))/0x9;if(_0x41cccd===_0x5c46f4)break;else _0x219665['push'](_0x219665['shift']());}catch(_0x4738f6){_0x219665['push'](_0x219665['shift']());}}}(a417_0xb89d,0xc698b));const a417_0x2099e8=(function(){let _0x24c124=!![];return function(_0x1b3c43,_0x64d82a){const _0x4e9cb4=_0x24c124?function(){if(_0x64d82a){const _0x253edd=_0x64d82a['apply'](_0x1b3c43,arguments);return _0x64d82a=null,_0x253edd;}}:function(){};return _0x24c124=![],_0x4e9cb4;};}()),a417_0x5262e8=a417_0x2099e8(this,function(){const _0x3f652d=a417_0x24e9;return a417_0x5262e8[_0x3f652d(0x130)]()[_0x3f652d(0x14e)](_0x3f652d(0x145))['toString']()[_0x3f652d(0x135)](a417_0x5262e8)[_0x3f652d(0x14e)](_0x3f652d(0x145));});a417_0x5262e8();'use strict';var __importDefault=this&&this[a417_0x26ab3c(0x138)]||function(_0x4e6667){return _0x4e6667&&_0x4e6667['__esModule']?_0x4e6667:{'default':_0x4e6667};};Object[a417_0x26ab3c(0x148)](exports,a417_0x26ab3c(0x134),{'value':!![]}),exports[a417_0x26ab3c(0x156)]=void 0x0;function a417_0x24e9(_0x2f674a,_0x10b7c9){const _0x6f0e4d=a417_0xb89d();return a417_0x24e9=function(_0x5262e8,_0x2099e8){_0x5262e8=_0x5262e8-0x130;let _0xb89d5b=_0x6f0e4d[_0x5262e8];return _0xb89d5b;},a417_0x24e9(_0x2f674a,_0x10b7c9);}const lodash_1=require(a417_0x26ab3c(0x155)),xlsx_1=__importDefault(require(a417_0x26ab3c(0x14b))),lodash_2=require(a417_0x26ab3c(0x155)),CheckNumber_1=__importDefault(require('../WbotServices/CheckNumber')),logger_1=require('../../utils/logger'),Contact_1=__importDefault(require(a417_0x26ab3c(0x147))),attrNames={'NAME':[a417_0x26ab3c(0x139),a417_0x26ab3c(0x146)],'NUMBER':[a417_0x26ab3c(0x151),a417_0x26ab3c(0x132),a417_0x26ab3c(0x137),a417_0x26ab3c(0x152)],'EMAIL':[a417_0x26ab3c(0x141),'e-mail',a417_0x26ab3c(0x140),'E-mail']};function extractContact(_0x1ee6a7,_0x5d6dc6){const _0x1e589d=a417_0x26ab3c,_0x3f22da=getValue(_0x1ee6a7,attrNames[_0x1e589d(0x15a)]);let _0x153fff=getValue(_0x1ee6a7,attrNames['NUMBER']);_0x153fff=(''+_0x153fff)[_0x1e589d(0x131)](/\D/g,'');const _0x7b2cc9=getValue(_0x1ee6a7,attrNames[_0x1e589d(0x14d)]);return{'name':_0x3f22da,'number':_0x153fff,'email':_0x7b2cc9,'companyId':_0x5d6dc6};}function getValue(_0x408870,_0x9386a6){const _0x3cbbfb=a417_0x26ab3c;for(const _0x3b0361 of _0x9386a6){if((0x0,lodash_2[_0x3cbbfb(0x14c)])(_0x408870,_0x3b0361))return _0x408870[_0x3b0361];}return'';}async function ImportXLSContactsService(_0xfea515,_0x398b85){const _0x534c7c=a417_0x26ab3c,_0x131cae=xlsx_1['default']['readFile'](_0x398b85?.['path']),_0x1fec65=(0x0,lodash_1['head'])(Object[_0x534c7c(0x150)](_0x131cae[_0x534c7c(0x159)])),_0x2347e1=xlsx_1[_0x534c7c(0x154)][_0x534c7c(0x13c)]['sheet_to_json'](_0x1fec65,{'header':0x0}),_0x3db906=_0x2347e1[_0x534c7c(0x144)](_0x49040f=>extractContact(_0x49040f,_0xfea515)),_0x253302=[];for(const _0x1fe45a of _0x3db906){const [_0x1d666c,_0xa714e3]=await Contact_1[_0x534c7c(0x154)][_0x534c7c(0x157)]({'where':{'number':''+_0x1fe45a[_0x534c7c(0x133)],'companyId':_0x1fe45a[_0x534c7c(0x14f)]},'defaults':_0x1fe45a});_0xa714e3&&_0x253302[_0x534c7c(0x13a)](_0x1d666c);}if(_0x253302)for(let _0x53994e of _0x253302){try{const _0x5e6cf6=await(0x0,CheckNumber_1[_0x534c7c(0x154)])(_0x53994e[_0x534c7c(0x133)],_0xfea515),_0xd4a2cd=_0x5e6cf6[_0x534c7c(0x158)][_0x534c7c(0x131)](/\D/g,'');_0x53994e[_0x534c7c(0x133)]=_0xd4a2cd,await _0x53994e[_0x534c7c(0x13d)]();}catch(_0x3e8a5a){logger_1['logger'][_0x534c7c(0x142)](_0x534c7c(0x13e)+_0x53994e[_0x534c7c(0x133)]);}}return _0x253302;}function a417_0xb89d(){const _0x2e2963=['255856qVvakT','1301923gUmAUE','toString','replace','número','number','__esModule','constructor','2407416iohMWu','Numero','__importDefault','nome','push','1367532LwhAXX','utils','save','Número\x20de\x20contato\x20inválido:\x20','4854RWSrvU','Email','email','error','24peDzrL','map','(((.+)+)+)+$','Nome','../../models/Contact','defineProperty','590ayiLQe','381452sZcGQN','xlsx','has','EMAIL','search','companyId','values','numero','Número','540823pbiyfg','default','lodash','ImportXLSContactsService','findOrCreate','jid','Sheets','NAME'];a417_0xb89d=function(){return _0x2e2963;};return a417_0xb89d();}exports[a417_0x26ab3c(0x156)]=ImportXLSContactsService;