const a418_0x5d1b67=a418_0x1b35;(function(_0x5090e0,_0x212e50){const _0x4009e3=a418_0x1b35,_0x173432=_0x5090e0();while(!![]){try{const _0x4647eb=-parseInt(_0x4009e3(0x164))/0x1*(-parseInt(_0x4009e3(0x16b))/0x2)+parseInt(_0x4009e3(0x17b))/0x3+-parseInt(_0x4009e3(0x172))/0x4*(-parseInt(_0x4009e3(0x15f))/0x5)+parseInt(_0x4009e3(0x15a))/0x6*(parseInt(_0x4009e3(0x177))/0x7)+-parseInt(_0x4009e3(0x187))/0x8*(-parseInt(_0x4009e3(0x16a))/0x9)+parseInt(_0x4009e3(0x180))/0xa+-parseInt(_0x4009e3(0x16d))/0xb;if(_0x4647eb===_0x212e50)break;else _0x173432['push'](_0x173432['shift']());}catch(_0x302979){_0x173432['push'](_0x173432['shift']());}}}(a418_0x4c9c,0xeb7d2));const a418_0x4b58fa=(function(){let _0x1f20de=!![];return function(_0x706aaa,_0x30d523){const _0x43b620=_0x1f20de?function(){const _0x5ed27c=a418_0x1b35;if(_0x30d523){const _0x5caaa7=_0x30d523[_0x5ed27c(0x184)](_0x706aaa,arguments);return _0x30d523=null,_0x5caaa7;}}:function(){};return _0x1f20de=![],_0x43b620;};}()),a418_0x4a7615=a418_0x4b58fa(this,function(){const _0x4de36a=a418_0x1b35;return a418_0x4a7615[_0x4de36a(0x17c)]()['search'](_0x4de36a(0x186))[_0x4de36a(0x17c)]()[_0x4de36a(0x161)](a418_0x4a7615)[_0x4de36a(0x175)](_0x4de36a(0x186));});a418_0x4a7615();'use strict';function a418_0x4c9c(){const _0x4082ea=['__importDefault','numero','212UIzKER','e-mail','Número\x20de\x20contato\x20inválido:\x20','search','path','6490855uswLHP','default','map','Sheets','2549661XOvGkS','toString','../../utils/logger','readFile','Email','10702480cDJEDf','NAME','NUMBER','número','apply','logger','(((.+)+)+)+$','2373056GguCMi','has','__esModule','6EWOrcQ','replace','../WbotServices/CheckNumber','E-mail','sheet_to_json','141500EbPvsS','jid','constructor','push','save','992677RCmCnX','defineProperty','head','findOrCreate','ImportXLSContactsService','number','18aYRvvY','2odrJSR','lodash','54655469XkKLzo','../../models/Contact','values'];a418_0x4c9c=function(){return _0x4082ea;};return a418_0x4c9c();}var __importDefault=this&&this[a418_0x5d1b67(0x170)]||function(_0x4aae27){const _0x5af87d=a418_0x5d1b67;return _0x4aae27&&_0x4aae27[_0x5af87d(0x189)]?_0x4aae27:{'default':_0x4aae27};};function a418_0x1b35(_0x3c9ad7,_0x122f77){const _0x3a944b=a418_0x4c9c();return a418_0x1b35=function(_0x4a7615,_0x4b58fa){_0x4a7615=_0x4a7615-0x15a;let _0x4c9c71=_0x3a944b[_0x4a7615];return _0x4c9c71;},a418_0x1b35(_0x3c9ad7,_0x122f77);}Object[a418_0x5d1b67(0x165)](exports,a418_0x5d1b67(0x189),{'value':!![]}),exports[a418_0x5d1b67(0x168)]=void 0x0;const lodash_1=require(a418_0x5d1b67(0x16c)),xlsx_1=__importDefault(require('xlsx')),lodash_2=require('lodash'),CheckNumber_1=__importDefault(require(a418_0x5d1b67(0x15c))),logger_1=require(a418_0x5d1b67(0x17d)),Contact_1=__importDefault(require(a418_0x5d1b67(0x16e))),attrNames={'NAME':['nome','Nome'],'NUMBER':[a418_0x5d1b67(0x171),a418_0x5d1b67(0x183),'Numero','Número'],'EMAIL':['email',a418_0x5d1b67(0x173),a418_0x5d1b67(0x17f),a418_0x5d1b67(0x15d)]};function extractContact(_0x23f79c,_0x36c4d2){const _0x1724f2=a418_0x5d1b67,_0x258950=getValue(_0x23f79c,attrNames[_0x1724f2(0x181)]);let _0x2fbee1=getValue(_0x23f79c,attrNames[_0x1724f2(0x182)]);_0x2fbee1=(''+_0x2fbee1)[_0x1724f2(0x15b)](/\D/g,'');const _0x16dc4f=getValue(_0x23f79c,attrNames['EMAIL']);return{'name':_0x258950,'number':_0x2fbee1,'email':_0x16dc4f,'companyId':_0x36c4d2};}function getValue(_0x1dde30,_0x209d4d){const _0x3dc62b=a418_0x5d1b67;for(const _0x2edc87 of _0x209d4d){if((0x0,lodash_2[_0x3dc62b(0x188)])(_0x1dde30,_0x2edc87))return _0x1dde30[_0x2edc87];}return'';}async function ImportXLSContactsService(_0xf70298,_0x2fa58d){const _0x5db57d=a418_0x5d1b67,_0x147631=xlsx_1[_0x5db57d(0x178)][_0x5db57d(0x17e)](_0x2fa58d?.[_0x5db57d(0x176)]),_0x42e102=(0x0,lodash_1[_0x5db57d(0x166)])(Object[_0x5db57d(0x16f)](_0x147631[_0x5db57d(0x17a)])),_0x52cde8=xlsx_1[_0x5db57d(0x178)]['utils'][_0x5db57d(0x15e)](_0x42e102,{'header':0x0}),_0x7901ef=_0x52cde8[_0x5db57d(0x179)](_0x2dede3=>extractContact(_0x2dede3,_0xf70298)),_0x5a541a=[];for(const _0xddbef9 of _0x7901ef){const [_0x2ef552,_0x5e1de3]=await Contact_1[_0x5db57d(0x178)][_0x5db57d(0x167)]({'where':{'number':''+_0xddbef9[_0x5db57d(0x169)],'companyId':_0xddbef9['companyId']},'defaults':_0xddbef9});_0x5e1de3&&_0x5a541a[_0x5db57d(0x162)](_0x2ef552);}if(_0x5a541a)for(let _0x4bdc88 of _0x5a541a){try{const _0x281ad0=await(0x0,CheckNumber_1[_0x5db57d(0x178)])(_0x4bdc88['number'],_0xf70298),_0x39f0aa=_0x281ad0[_0x5db57d(0x160)]['replace'](/\D/g,'');_0x4bdc88[_0x5db57d(0x169)]=_0x39f0aa,await _0x4bdc88[_0x5db57d(0x163)]();}catch(_0x4956f6){logger_1[_0x5db57d(0x185)]['error'](_0x5db57d(0x174)+_0x4bdc88[_0x5db57d(0x169)]);}}return _0x5a541a;}exports['ImportXLSContactsService']=ImportXLSContactsService;