const a420_0x37bf4f=a420_0x3deb;(function(_0x2e62f7,_0x479042){const _0x1dcf81=a420_0x3deb,_0x47ba5a=_0x2e62f7();while(!![]){try{const _0x252e74=parseInt(_0x1dcf81(0xc3))/0x1*(parseInt(_0x1dcf81(0xb0))/0x2)+-parseInt(_0x1dcf81(0xbd))/0x3+-parseInt(_0x1dcf81(0xb8))/0x4*(-parseInt(_0x1dcf81(0xae))/0x5)+-parseInt(_0x1dcf81(0xa4))/0x6*(parseInt(_0x1dcf81(0xa0))/0x7)+parseInt(_0x1dcf81(0xb6))/0x8+parseInt(_0x1dcf81(0xb3))/0x9*(-parseInt(_0x1dcf81(0xa5))/0xa)+parseInt(_0x1dcf81(0xba))/0xb*(-parseInt(_0x1dcf81(0xb2))/0xc);if(_0x252e74===_0x479042)break;else _0x47ba5a['push'](_0x47ba5a['shift']());}catch(_0x1b419a){_0x47ba5a['push'](_0x47ba5a['shift']());}}}(a420_0x2562,0xcb920));const a420_0x586a16=(function(){let _0x332cfa=!![];return function(_0x542a0f,_0x325e2f){const _0x2bfd5d=_0x332cfa?function(){const _0x24a662=a420_0x3deb;if(_0x325e2f){const _0x413a9d=_0x325e2f[_0x24a662(0xc8)](_0x542a0f,arguments);return _0x325e2f=null,_0x413a9d;}}:function(){};return _0x332cfa=![],_0x2bfd5d;};}()),a420_0x58eb35=a420_0x586a16(this,function(){const _0x27cab6=a420_0x3deb;return a420_0x58eb35[_0x27cab6(0xaf)]()[_0x27cab6(0xbe)]('(((.+)+)+)+$')['toString']()['constructor'](a420_0x58eb35)['search']('(((.+)+)+)+$');});a420_0x58eb35();'use strict';var __importDefault=this&&this[a420_0x37bf4f(0xc4)]||function(_0x438dfe){const _0x654f79=a420_0x37bf4f;return _0x438dfe&&_0x438dfe[_0x654f79(0xc2)]?_0x438dfe:{'default':_0x438dfe};};Object['defineProperty'](exports,a420_0x37bf4f(0xc2),{'value':!![]}),exports[a420_0x37bf4f(0xa8)]=void 0x0;const lodash_1=require(a420_0x37bf4f(0xcd)),xlsx_1=__importDefault(require(a420_0x37bf4f(0x9f))),lodash_2=require('lodash'),CheckNumber_1=__importDefault(require(a420_0x37bf4f(0xbc))),logger_1=require('../../utils/logger'),Contact_1=__importDefault(require('../../models/Contact')),attrNames={'NAME':['nome',a420_0x37bf4f(0xa1)],'NUMBER':[a420_0x37bf4f(0xcb),a420_0x37bf4f(0xc6),'Numero',a420_0x37bf4f(0x9e)],'EMAIL':[a420_0x37bf4f(0xb7),a420_0x37bf4f(0xac),a420_0x37bf4f(0xb4),a420_0x37bf4f(0x9d)]};function a420_0x2562(){const _0x1c416f=['__importDefault','sheet_to_json','número','map','apply','number','Número\x20de\x20contato\x20inválido:\x20','numero','replace','lodash','E-mail','Número','xlsx','623BRUKfK','Nome','logger','path','7422luSIdg','10LgbHqU','save','Sheets','ImportXLSContactsService','error','has','head','e-mail','findOrCreate','216415LKcOda','toString','36734nSobbT','NAME','12XVKveN','510894BUJJTV','Email','utils','10092960huOyxY','email','72GfXVGr','values','4390683JmVqZI','default','../WbotServices/CheckNumber','3796068obErBB','search','jid','push','readFile','__esModule','34LYLOxO'];a420_0x2562=function(){return _0x1c416f;};return a420_0x2562();}function a420_0x3deb(_0x124d95,_0x178445){const _0x5eae79=a420_0x2562();return a420_0x3deb=function(_0x58eb35,_0x586a16){_0x58eb35=_0x58eb35-0x9d;let _0x256298=_0x5eae79[_0x58eb35];return _0x256298;},a420_0x3deb(_0x124d95,_0x178445);}function extractContact(_0x3758d2,_0x3871e7){const _0x365d50=a420_0x37bf4f,_0x300406=getValue(_0x3758d2,attrNames[_0x365d50(0xb1)]);let _0x2cc15b=getValue(_0x3758d2,attrNames['NUMBER']);_0x2cc15b=(''+_0x2cc15b)[_0x365d50(0xcc)](/\D/g,'');const _0x370040=getValue(_0x3758d2,attrNames['EMAIL']);return{'name':_0x300406,'number':_0x2cc15b,'email':_0x370040,'companyId':_0x3871e7};}function getValue(_0x570eff,_0x366189){const _0x4baf30=a420_0x37bf4f;for(const _0x51ba22 of _0x366189){if((0x0,lodash_2[_0x4baf30(0xaa)])(_0x570eff,_0x51ba22))return _0x570eff[_0x51ba22];}return'';}async function ImportXLSContactsService(_0x2a925c,_0x57f2e2){const _0x57c819=a420_0x37bf4f,_0x52d428=xlsx_1[_0x57c819(0xbb)][_0x57c819(0xc1)](_0x57f2e2?.[_0x57c819(0xa3)]),_0x11d340=(0x0,lodash_1[_0x57c819(0xab)])(Object[_0x57c819(0xb9)](_0x52d428[_0x57c819(0xa7)])),_0x3339e5=xlsx_1[_0x57c819(0xbb)][_0x57c819(0xb5)][_0x57c819(0xc5)](_0x11d340,{'header':0x0}),_0x3e3ace=_0x3339e5[_0x57c819(0xc7)](_0x33e276=>extractContact(_0x33e276,_0x2a925c)),_0x455fff=[];for(const _0x579619 of _0x3e3ace){const [_0x5d09c4,_0x4b817b]=await Contact_1[_0x57c819(0xbb)][_0x57c819(0xad)]({'where':{'number':''+_0x579619[_0x57c819(0xc9)],'companyId':_0x579619['companyId']},'defaults':_0x579619});_0x4b817b&&_0x455fff[_0x57c819(0xc0)](_0x5d09c4);}if(_0x455fff)for(let _0x3b4b55 of _0x455fff){try{const _0x115e9b=await(0x0,CheckNumber_1[_0x57c819(0xbb)])(_0x3b4b55[_0x57c819(0xc9)],_0x2a925c),_0x5cda52=_0x115e9b[_0x57c819(0xbf)]['replace'](/\D/g,'');_0x3b4b55['number']=_0x5cda52,await _0x3b4b55[_0x57c819(0xa6)]();}catch(_0x34d479){logger_1[_0x57c819(0xa2)][_0x57c819(0xa9)](_0x57c819(0xca)+_0x3b4b55['number']);}}return _0x455fff;}exports[a420_0x37bf4f(0xa8)]=ImportXLSContactsService;