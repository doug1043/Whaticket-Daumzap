const a427_0x5d822c=a427_0x4f96;(function(_0x49ab13,_0x34a892){const _0x29c82c=a427_0x4f96,_0x58cf5c=_0x49ab13();while(!![]){try{const _0x12f036=-parseInt(_0x29c82c(0x142))/0x1*(-parseInt(_0x29c82c(0x146))/0x2)+-parseInt(_0x29c82c(0x155))/0x3*(parseInt(_0x29c82c(0x14b))/0x4)+-parseInt(_0x29c82c(0x14d))/0x5+parseInt(_0x29c82c(0x147))/0x6+-parseInt(_0x29c82c(0x156))/0x7+parseInt(_0x29c82c(0x158))/0x8+parseInt(_0x29c82c(0x150))/0x9;if(_0x12f036===_0x34a892)break;else _0x58cf5c['push'](_0x58cf5c['shift']());}catch(_0x19242b){_0x58cf5c['push'](_0x58cf5c['shift']());}}}(a427_0x387e,0x46cc6));const a427_0x3791bf=(function(){let _0x3d49db=!![];return function(_0x422c28,_0x5965ac){const _0xe4b01=_0x3d49db?function(){const _0x117925=a427_0x4f96;if(_0x5965ac){const _0x15cd83=_0x5965ac[_0x117925(0x14f)](_0x422c28,arguments);return _0x5965ac=null,_0x15cd83;}}:function(){};return _0x3d49db=![],_0xe4b01;};}()),a427_0x45eb9a=a427_0x3791bf(this,function(){const _0x338dd3=a427_0x4f96;return a427_0x45eb9a[_0x338dd3(0x157)]()[_0x338dd3(0x153)]('(((.+)+)+)+$')[_0x338dd3(0x157)]()[_0x338dd3(0x159)](a427_0x45eb9a)[_0x338dd3(0x153)](_0x338dd3(0x149));});a427_0x45eb9a();'use strict';var __importDefault=this&&this['__importDefault']||function(_0x23f7c7){const _0x4206ab=a427_0x4f96;return _0x23f7c7&&_0x23f7c7[_0x4206ab(0x13e)]?_0x23f7c7:{'default':_0x23f7c7};};function a427_0x4f96(_0x16cc4e,_0x554510){const _0xbceac0=a427_0x387e();return a427_0x4f96=function(_0x45eb9a,_0x3791bf){_0x45eb9a=_0x45eb9a-0x13e;let _0x387e69=_0xbceac0[_0x45eb9a];return _0x387e69;},a427_0x4f96(_0x16cc4e,_0x554510);}function a427_0x387e(){const _0xec0e38=['currentschedule','search','log','11553TGAUhM','1247239ccJNfZ','toString','1390640nCvsfQ','constructor','__esModule','inActivity','sequelize','endtime','19nQyKlh','QueryTypes','../../database','error','850saKWco','469914DkAbtc','SELECT','(((.+)+)+)+$','default','4MlDood','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20SELECT\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20q.id,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20TRIM(to_char(current_date,\x20\x27day\x27))\x20as\x20currentweekday,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20s\x20as\x20currentschedule,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20s->>\x27startTime\x27\x20as\x20starttime,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20s->>\x27endTime\x27\x20as\x20endtime,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20s->>\x27startLunchTime\x27\x20as\x20startlunchtime,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20s->>\x27endLunchTime\x27\x20as\x20endlunchtime\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20FROM\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22Queues\x22\x20q,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20jsonb_array_elements(q.schedules)\x20s\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20WHERE\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20LOWER(s->>\x27weekdayEn\x27)\x20=\x20LOWER(TRIM(to_char(current_date,\x20\x27day\x27)))\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20AND\x20q.id\x20=\x20:queueId\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20AND\x20q.\x22companyId\x22\x20=\x20:companyId\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20AND\x20s->>\x27active\x27\x20=\x20\x27true\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20','1489750dUsfTq','Nenhuma\x20configuração\x20encontrada\x20para\x20o\x20dia\x20atual','apply','4587696fXEakZ',')\x20as\x20inner_query)\x20as\x20outer_query'];a427_0x387e=function(){return _0xec0e38;};return a427_0x387e();}Object['defineProperty'](exports,a427_0x5d822c(0x13e),{'value':!![]});const sequelize_1=require(a427_0x5d822c(0x140)),database_1=__importDefault(require(a427_0x5d822c(0x144))),VerifyCurrentSchedule=async(_0x4867dc,_0x935f11)=>{const _0x4e1bc0=a427_0x5d822c;try{const _0x13c426='\x0a\x20\x20\x20\x20\x20\x20SELECT\x0a\x20\x20\x20\x20\x20\x20\x20\x20id,\x0a\x20\x20\x20\x20\x20\x20\x20\x20currentweekday,\x0a\x20\x20\x20\x20\x20\x20\x20\x20currentschedule,\x0a\x20\x20\x20\x20\x20\x20\x20\x20starttime,\x0a\x20\x20\x20\x20\x20\x20\x20\x20endtime,\x0a\x20\x20\x20\x20\x20\x20\x20\x20startlunchtime,\x0a\x20\x20\x20\x20\x20\x20\x20\x20endlunchtime,\x0a\x20\x20\x20\x20\x20\x20\x20\x20(NOT\x20inactivity)\x20AS\x20\x22inActivity\x22\x0a\x20\x20\x20\x20\x20\x20FROM\x20(\x0a\x20\x20\x20\x20\x20\x20\x20\x20SELECT\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20id,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20currentweekday,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20currentschedule,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20starttime,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20endtime,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20startlunchtime,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20endlunchtime,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20CASE\x20WHEN\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20--\x20Se\x20fora\x20do\x20horário\x20de\x20trabalho\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20NOW()::time\x20<\x20to_timestamp(starttime,\x20\x27HH24MI\x27)::time\x20OR\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20NOW()::time\x20>\x20to_timestamp(endtime,\x20\x27HH24MI\x27)::time\x20OR\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20--\x20Ou\x20se\x20estiver\x20no\x20horário\x20de\x20almoço\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20(startlunchtime\x20!=\x20\x27\x27\x20AND\x20endlunchtime\x20!=\x20\x27\x27\x20AND\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20NOW()::time\x20>=\x20to_timestamp(startlunchtime,\x20\x27HH24MI\x27)::time\x20AND\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20NOW()::time\x20<=\x20to_timestamp(endlunchtime,\x20\x27HH24MI\x27)::time)\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20THEN\x20true\x20ELSE\x20false\x20END\x20AS\x20inactivity\x0a\x20\x20\x20\x20\x20\x20\x20\x20FROM\x20(';let _0xf4c25b;_0x935f11===null||_0x935f11===undefined?_0xf4c25b='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20SELECT\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20c.id,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20TRIM(to_char(current_date,\x20\x27day\x27))\x20as\x20currentweekday,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20s\x20as\x20currentschedule,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20s->>\x27startTime\x27\x20as\x20starttime,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20s->>\x27endTime\x27\x20as\x20endtime,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20s->>\x27startLunchTime\x27\x20as\x20startlunchtime,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20s->>\x27endLunchTime\x27\x20as\x20endlunchtime\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20FROM\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22Companies\x22\x20c,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20jsonb_array_elements(c.schedules)\x20s\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20WHERE\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20LOWER(s->>\x27weekdayEn\x27)\x20=\x20LOWER(TRIM(to_char(current_date,\x20\x27day\x27)))\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20AND\x20c.id\x20=\x20:companyId\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20AND\x20s->>\x27active\x27\x20=\x20\x27true\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20':_0xf4c25b=_0x4e1bc0(0x14c);const _0x22f1e4=_0x4e1bc0(0x151),_0x561a8d=_0x13c426+_0xf4c25b+_0x22f1e4,_0x47abf9=await database_1[_0x4e1bc0(0x14a)]['query'](_0x561a8d,{'replacements':_0x935f11?{'companyId':_0x4867dc,'queueId':_0x935f11}:{'companyId':_0x4867dc},'type':sequelize_1[_0x4e1bc0(0x143)][_0x4e1bc0(0x148)],'plain':!![]});if(!_0x47abf9)return console[_0x4e1bc0(0x154)](_0x4e1bc0(0x14e)),{'id':Number(_0x935f11||_0x4867dc),'currentSchedule':[],'startTime':'','endTime':'','inActivity':![]};return{'id':_0x47abf9['id'],'currentSchedule':_0x47abf9[_0x4e1bc0(0x152)],'startTime':_0x47abf9['starttime'],'endTime':_0x47abf9[_0x4e1bc0(0x141)],'inActivity':_0x47abf9[_0x4e1bc0(0x13f)]};}catch(_0x2ce5dc){return console[_0x4e1bc0(0x145)]('Erro\x20na\x20verificação\x20de\x20horário:',_0x2ce5dc),{'id':Number(_0x935f11||_0x4867dc),'currentSchedule':[],'startTime':'','endTime':'','inActivity':![]};}};exports['default']=VerifyCurrentSchedule;