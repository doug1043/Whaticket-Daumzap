'use strict';const a424_0x18b413=a424_0xf76d;function a424_0xf76d(_0x22ed6d,_0x52a5c){const _0x35f8b7=a424_0x2be5();return a424_0xf76d=function(_0xace5bc,_0x47eca4){_0xace5bc=_0xace5bc-0x1f3;let _0x2be5c0=_0x35f8b7[_0xace5bc];return _0x2be5c0;},a424_0xf76d(_0x22ed6d,_0x52a5c);}(function(_0x3fff56,_0x587b05){const _0x4ead0c=a424_0xf76d,_0x23a6b1=_0x3fff56();while(!![]){try{const _0x3e59c1=parseInt(_0x4ead0c(0x20d))/0x1+parseInt(_0x4ead0c(0x21b))/0x2*(-parseInt(_0x4ead0c(0x200))/0x3)+parseInt(_0x4ead0c(0x225))/0x4*(parseInt(_0x4ead0c(0x21d))/0x5)+-parseInt(_0x4ead0c(0x206))/0x6*(parseInt(_0x4ead0c(0x209))/0x7)+parseInt(_0x4ead0c(0x203))/0x8+parseInt(_0x4ead0c(0x221))/0x9*(-parseInt(_0x4ead0c(0x1fd))/0xa)+parseInt(_0x4ead0c(0x202))/0xb;if(_0x3e59c1===_0x587b05)break;else _0x23a6b1['push'](_0x23a6b1['shift']());}catch(_0x199581){_0x23a6b1['push'](_0x23a6b1['shift']());}}}(a424_0x2be5,0x5b8f8));var __createBinding=this&&this[a424_0x18b413(0x222)]||(Object[a424_0x18b413(0x20c)]?function(_0x44d607,_0x3fb163,_0x56aedb,_0x3cb148){const _0xc905e2=a424_0x18b413;if(_0x3cb148===undefined)_0x3cb148=_0x56aedb;var _0x48ba23=Object[_0xc905e2(0x205)](_0x3fb163,_0x56aedb);(!_0x48ba23||(_0xc905e2(0x223)in _0x48ba23?!_0x3fb163['__esModule']:_0x48ba23[_0xc905e2(0x218)]||_0x48ba23[_0xc905e2(0x216)]))&&(_0x48ba23={'enumerable':!![],'get':function(){return _0x3fb163[_0x56aedb];}}),Object[_0xc905e2(0x208)](_0x44d607,_0x3cb148,_0x48ba23);}:function(_0x426f83,_0x150575,_0x499868,_0x699e02){if(_0x699e02===undefined)_0x699e02=_0x499868;_0x426f83[_0x699e02]=_0x150575[_0x499868];}),__setModuleDefault=this&&this[a424_0x18b413(0x21c)]||(Object[a424_0x18b413(0x20c)]?function(_0x40d742,_0x52a24e){const _0xa32bee=a424_0x18b413;Object[_0xa32bee(0x208)](_0x40d742,_0xa32bee(0x1f4),{'enumerable':!![],'value':_0x52a24e});}:function(_0x3985ab,_0x4ae658){const _0x55b50b=a424_0x18b413;_0x3985ab[_0x55b50b(0x1f4)]=_0x4ae658;}),__importStar=this&&this[a424_0x18b413(0x20a)]||(function(){const _0xf6daf8=(function(){let _0x5f2088=!![];return function(_0x59847c,_0x226c74){const _0x5d5f3d=_0x5f2088?function(){if(_0x226c74){const _0x400869=_0x226c74['apply'](_0x59847c,arguments);return _0x226c74=null,_0x400869;}}:function(){};return _0x5f2088=![],_0x5d5f3d;};}()),_0x51a628=_0xf6daf8(this,function(){const _0x389c03=a424_0xf76d;return _0x51a628[_0x389c03(0x204)]()[_0x389c03(0x1f5)]('(((.+)+)+)+$')['toString']()[_0x389c03(0x220)](_0x51a628)[_0x389c03(0x1f5)]('(((.+)+)+)+$');});_0x51a628();var _0x31314d=function(_0x175467){const _0x22c1ae=a424_0xf76d;return _0x31314d=Object[_0x22c1ae(0x211)]||function(_0x5a19d9){const _0x31a42a=_0x22c1ae;var _0x673aa=[];for(var _0xf325ce in _0x5a19d9)if(Object[_0x31a42a(0x1f6)]['hasOwnProperty']['call'](_0x5a19d9,_0xf325ce))_0x673aa[_0x673aa[_0x31a42a(0x21a)]]=_0xf325ce;return _0x673aa;},_0x31314d(_0x175467);};return function(_0x518ff){const _0x122ccd=a424_0xf76d;if(_0x518ff&&_0x518ff[_0x122ccd(0x217)])return _0x518ff;var _0xebcb5a={};if(_0x518ff!=null){for(var _0x532ff9=_0x31314d(_0x518ff),_0x512828=0x0;_0x512828<_0x532ff9[_0x122ccd(0x21a)];_0x512828++)if(_0x532ff9[_0x512828]!==_0x122ccd(0x1f4))__createBinding(_0xebcb5a,_0x518ff,_0x532ff9[_0x512828]);}return __setModuleDefault(_0xebcb5a,_0x518ff),_0xebcb5a;};}()),__importDefault=this&&this[a424_0x18b413(0x215)]||function(_0x47e6d1){const _0x1feba7=a424_0x18b413;return _0x47e6d1&&_0x47e6d1[_0x1feba7(0x217)]?_0x47e6d1:{'default':_0x47e6d1};};Object[a424_0x18b413(0x208)](exports,'__esModule',{'value':!![]});const Yup=__importStar(require('yup')),AppError_1=__importDefault(require(a424_0x18b413(0x219))),Company_1=__importDefault(require('../../models/Company')),User_1=__importDefault(require(a424_0x18b413(0x201))),Setting_1=__importDefault(require(a424_0x18b413(0x1fb))),CreateCompanyService=async _0x247458=>{const _0x4490d4=a424_0x18b413,{name:_0x1b552e,phone:_0x4a31d1,email:_0x2d04d8,status:_0x2176bb,planId:_0x56b3d0,password:_0x38d012,campaignsEnabled:_0x3b5e93,dueDate:_0x52af45,recurrence:_0x1e5499}=_0x247458,_0x33e980=Yup['object']()[_0x4490d4(0x20f)]({'name':Yup['string']()[_0x4490d4(0x1f7)](0x2,_0x4490d4(0x1fc))['required'](_0x4490d4(0x1fc))['test']('Check-unique-name',_0x4490d4(0x1ff),async _0x54da8e=>{const _0x3c49a3=_0x4490d4;if(_0x54da8e){const _0x13ed10=await Company_1[_0x3c49a3(0x1f4)][_0x3c49a3(0x20e)]({'where':{'name':_0x54da8e}});return!_0x13ed10;}return![];})});try{await _0x33e980['validate']({'name':_0x1b552e});}catch(_0x59ac12){throw new AppError_1[(_0x4490d4(0x1f4))](_0x59ac12[_0x4490d4(0x1fe)]);}const _0x2fa720=await Company_1[_0x4490d4(0x1f4)]['create']({'name':_0x1b552e,'phone':_0x4a31d1,'email':_0x2d04d8,'status':_0x2176bb,'planId':_0x56b3d0,'dueDate':_0x52af45,'recurrence':_0x1e5499}),[_0x509ee4,_0x2165b0]=await User_1[_0x4490d4(0x1f4)][_0x4490d4(0x21e)]({'where':{'name':_0x1b552e,'email':_0x2d04d8},'defaults':{'name':_0x1b552e,'email':_0x2d04d8,'password':_0x38d012||_0x4490d4(0x207),'profile':_0x4490d4(0x1f3),'companyId':_0x2fa720['id']}});!_0x2165b0&&await _0x509ee4['update']({'companyId':_0x2fa720['id']});await Setting_1['default']['findOrCreate']({'where':{'companyId':_0x2fa720['id'],'key':'CheckMsgIsGroup'},'defaults':{'companyId':_0x2fa720['id'],'key':_0x4490d4(0x1f8),'value':''}}),await Setting_1[_0x4490d4(0x1f4)][_0x4490d4(0x21e)]({'where':{'companyId':_0x2fa720['id'],'key':''},'defaults':{'companyId':_0x2fa720['id'],'key':_0x4490d4(0x214),'value':_0x4490d4(0x212)}}),await Setting_1[_0x4490d4(0x1f4)][_0x4490d4(0x21e)]({'where':{'companyId':_0x2fa720['id'],'key':_0x4490d4(0x1fa)},'defaults':{'companyId':_0x2fa720['id'],'key':_0x4490d4(0x1fa),'value':'disabled'}}),await Setting_1[_0x4490d4(0x1f4)][_0x4490d4(0x21e)]({'where':{'companyId':_0x2fa720['id'],'key':_0x4490d4(0x1f9)},'defaults':{'companyId':_0x2fa720['id'],'key':'sendGreetingAccepted','value':'disabled'}}),await Setting_1[_0x4490d4(0x1f4)]['findOrCreate']({'where':{'companyId':_0x2fa720['id'],'key':'sendMsgTransfTicket'},'defaults':{'companyId':_0x2fa720['id'],'key':_0x4490d4(0x224),'value':_0x4490d4(0x212)}}),await Setting_1[_0x4490d4(0x1f4)][_0x4490d4(0x21e)]({'where':{'companyId':_0x2fa720['id'],'key':_0x4490d4(0x210)},'defaults':{'companyId':_0x2fa720['id'],'key':_0x4490d4(0x210),'value':'text'}}),await Setting_1['default']['findOrCreate']({'where':{'companyId':_0x2fa720['id'],'key':_0x4490d4(0x21f),'value':_0x4490d4(0x20b)}});if(_0x247458[_0x4490d4(0x213)]!==undefined){const [_0x4119c2,_0x32f2b2]=await Setting_1[_0x4490d4(0x1f4)]['findOrCreate']({'where':{'companyId':_0x2fa720['id'],'key':_0x4490d4(0x213)},'defaults':{'companyId':_0x2fa720['id'],'key':_0x4490d4(0x213),'value':''+_0x3b5e93}});!_0x32f2b2&&await _0x4119c2['update']({'value':''+_0x3b5e93});}return _0x2fa720;};function a424_0x2be5(){const _0xe06f62=['shape','chatBotType','getOwnPropertyNames','disabled','campaignsEnabled','call','__importDefault','configurable','__esModule','writable','../../errors/AppError','length','98954UXrxSl','__setModuleDefault','1444165PaVTJs','findOrCreate','versionWA','constructor','171tGXOmj','__createBinding','get','sendMsgTransfTicket','4zyEwag','admin','default','search','prototype','min','enabled','sendGreetingAccepted','scheduleType','../../models/Setting','ERR_COMPANY_INVALID_NAME','87610gcFDcB','message','ERR_COMPANY_NAME_ALREADY_EXISTS','6LYWTRE','../../models/User','1251613CXdaUM','2427816nKndJX','toString','getOwnPropertyDescriptor','330tMoknd','mudar123','defineProperty','66647IfxdGa','__importStar','2.3000.1020713899','create','458007eSWDhd','findOne'];a424_0x2be5=function(){return _0xe06f62;};return a424_0x2be5();}exports[a424_0x18b413(0x1f4)]=CreateCompanyService;