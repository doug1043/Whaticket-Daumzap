'use strict';const a420_0x42bcdc=a420_0x1898;function a420_0x1898(_0x18ce9f,_0x430fa9){const _0x44ff7d=a420_0x51a0();return a420_0x1898=function(_0x1c1629,_0x24e5ca){_0x1c1629=_0x1c1629-0x1c4;let _0x51a024=_0x44ff7d[_0x1c1629];return _0x51a024;},a420_0x1898(_0x18ce9f,_0x430fa9);}(function(_0x5a407d,_0x44ef65){const _0x318cc3=a420_0x1898,_0x4f3fcf=_0x5a407d();while(!![]){try{const _0x3be3e2=parseInt(_0x318cc3(0x1c5))/0x1*(parseInt(_0x318cc3(0x1cc))/0x2)+parseInt(_0x318cc3(0x1da))/0x3*(parseInt(_0x318cc3(0x1e5))/0x4)+parseInt(_0x318cc3(0x1d7))/0x5+parseInt(_0x318cc3(0x1dd))/0x6+parseInt(_0x318cc3(0x1c4))/0x7*(-parseInt(_0x318cc3(0x1f8))/0x8)+parseInt(_0x318cc3(0x1f4))/0x9*(parseInt(_0x318cc3(0x1ec))/0xa)+-parseInt(_0x318cc3(0x1f6))/0xb;if(_0x3be3e2===_0x44ef65)break;else _0x4f3fcf['push'](_0x4f3fcf['shift']());}catch(_0x534a16){_0x4f3fcf['push'](_0x4f3fcf['shift']());}}}(a420_0x51a0,0x71735));var __createBinding=this&&this[a420_0x42bcdc(0x1c6)]||(Object[a420_0x42bcdc(0x1d8)]?function(_0xd3a918,_0x5c127d,_0x1478b2,_0x3f54ea){const _0x275b3b=a420_0x42bcdc;if(_0x3f54ea===undefined)_0x3f54ea=_0x1478b2;var _0x5147b7=Object[_0x275b3b(0x1d1)](_0x5c127d,_0x1478b2);(!_0x5147b7||('get'in _0x5147b7?!_0x5c127d[_0x275b3b(0x1d9)]:_0x5147b7[_0x275b3b(0x1d2)]||_0x5147b7[_0x275b3b(0x1f0)]))&&(_0x5147b7={'enumerable':!![],'get':function(){return _0x5c127d[_0x1478b2];}}),Object['defineProperty'](_0xd3a918,_0x3f54ea,_0x5147b7);}:function(_0x354e74,_0x3b1f14,_0x1ef259,_0x2a4c6f){if(_0x2a4c6f===undefined)_0x2a4c6f=_0x1ef259;_0x354e74[_0x2a4c6f]=_0x3b1f14[_0x1ef259];}),__setModuleDefault=this&&this[a420_0x42bcdc(0x1de)]||(Object[a420_0x42bcdc(0x1d8)]?function(_0xbe234e,_0x1727e9){const _0x5de958=a420_0x42bcdc;Object[_0x5de958(0x1e2)](_0xbe234e,_0x5de958(0x1eb),{'enumerable':!![],'value':_0x1727e9});}:function(_0x3f5746,_0x3e8a1e){const _0x50356d=a420_0x42bcdc;_0x3f5746[_0x50356d(0x1eb)]=_0x3e8a1e;}),__importStar=this&&this[a420_0x42bcdc(0x1f5)]||(function(){const _0x2cbdc4=(function(){let _0x240f61=!![];return function(_0x588810,_0x550787){const _0x2d4d52=_0x240f61?function(){const _0x26899f=a420_0x1898;if(_0x550787){const _0x222a3a=_0x550787[_0x26899f(0x1df)](_0x588810,arguments);return _0x550787=null,_0x222a3a;}}:function(){};return _0x240f61=![],_0x2d4d52;};}()),_0x2dfa03=_0x2cbdc4(this,function(){const _0x2a1480=a420_0x1898;return _0x2dfa03[_0x2a1480(0x1ed)]()['search'](_0x2a1480(0x1f7))[_0x2a1480(0x1ed)]()['constructor'](_0x2dfa03)['search']('(((.+)+)+)+$');});_0x2dfa03();var _0x372161=function(_0x1b3d07){const _0x27dd93=a420_0x1898;return _0x372161=Object[_0x27dd93(0x1e9)]||function(_0x6478ab){const _0x48c2be=_0x27dd93;var _0xee04d3=[];for(var _0x3cd9f9 in _0x6478ab)if(Object[_0x48c2be(0x1d0)][_0x48c2be(0x1e8)][_0x48c2be(0x1e6)](_0x6478ab,_0x3cd9f9))_0xee04d3[_0xee04d3['length']]=_0x3cd9f9;return _0xee04d3;},_0x372161(_0x1b3d07);};return function(_0x153ff0){const _0x4f59ea=a420_0x1898;if(_0x153ff0&&_0x153ff0[_0x4f59ea(0x1d9)])return _0x153ff0;var _0x2249b6={};if(_0x153ff0!=null){for(var _0xf66a91=_0x372161(_0x153ff0),_0x2ea37b=0x0;_0x2ea37b<_0xf66a91['length'];_0x2ea37b++)if(_0xf66a91[_0x2ea37b]!==_0x4f59ea(0x1eb))__createBinding(_0x2249b6,_0x153ff0,_0xf66a91[_0x2ea37b]);}return __setModuleDefault(_0x2249b6,_0x153ff0),_0x2249b6;};}()),__importDefault=this&&this[a420_0x42bcdc(0x1e3)]||function(_0x9fffe9){const _0x52d5ed=a420_0x42bcdc;return _0x9fffe9&&_0x9fffe9[_0x52d5ed(0x1d9)]?_0x9fffe9:{'default':_0x9fffe9};};Object[a420_0x42bcdc(0x1e2)](exports,a420_0x42bcdc(0x1d9),{'value':!![]});const Yup=__importStar(require('yup')),AppError_1=__importDefault(require(a420_0x42bcdc(0x1c7))),Company_1=__importDefault(require('../../models/Company')),User_1=__importDefault(require(a420_0x42bcdc(0x1cb))),Setting_1=__importDefault(require(a420_0x42bcdc(0x1cf))),CreateCompanyService=async _0x42c2ab=>{const _0x57d803=a420_0x42bcdc,{name:_0x2c27dd,phone:_0x12bec6,email:_0x394b9d,status:_0x2a033b,planId:_0x41f6f6,password:_0x41a5a6,campaignsEnabled:_0x255000,dueDate:_0x4ad75f,recurrence:_0x358b8f}=_0x42c2ab,_0x11f4f6=Yup['object']()[_0x57d803(0x1f2)]({'name':Yup[_0x57d803(0x1d5)]()[_0x57d803(0x1e4)](0x2,_0x57d803(0x1ee))[_0x57d803(0x1d6)](_0x57d803(0x1ee))['test'](_0x57d803(0x1ef),_0x57d803(0x1c8),async _0x22d707=>{if(_0x22d707){const _0x58869c=await Company_1['default']['findOne']({'where':{'name':_0x22d707}});return!_0x58869c;}return![];})});try{await _0x11f4f6[_0x57d803(0x1db)]({'name':_0x2c27dd});}catch(_0x269de2){throw new AppError_1[(_0x57d803(0x1eb))](_0x269de2[_0x57d803(0x1e1)]);}const _0x1664ef=await Company_1[_0x57d803(0x1eb)][_0x57d803(0x1d8)]({'name':_0x2c27dd,'phone':_0x12bec6,'email':_0x394b9d,'status':_0x2a033b,'planId':_0x41f6f6,'dueDate':_0x4ad75f,'recurrence':_0x358b8f}),[_0x48030c,_0x1e9a5a]=await User_1[_0x57d803(0x1eb)][_0x57d803(0x1ea)]({'where':{'name':_0x2c27dd,'email':_0x394b9d},'defaults':{'name':_0x2c27dd,'email':_0x394b9d,'password':_0x41a5a6||_0x57d803(0x1cd),'profile':_0x57d803(0x1e0),'companyId':_0x1664ef['id']}});!_0x1e9a5a&&await _0x48030c[_0x57d803(0x1f3)]({'companyId':_0x1664ef['id']});await Setting_1['default'][_0x57d803(0x1ea)]({'where':{'companyId':_0x1664ef['id'],'key':_0x57d803(0x1ce)},'defaults':{'companyId':_0x1664ef['id'],'key':'enabled','value':''}}),await Setting_1[_0x57d803(0x1eb)][_0x57d803(0x1ea)]({'where':{'companyId':_0x1664ef['id'],'key':''},'defaults':{'companyId':_0x1664ef['id'],'key':_0x57d803(0x1e6),'value':'disabled'}}),await Setting_1[_0x57d803(0x1eb)]['findOrCreate']({'where':{'companyId':_0x1664ef['id'],'key':_0x57d803(0x1d4)},'defaults':{'companyId':_0x1664ef['id'],'key':'scheduleType','value':'disabled'}}),await Setting_1[_0x57d803(0x1eb)][_0x57d803(0x1ea)]({'where':{'companyId':_0x1664ef['id'],'key':_0x57d803(0x1e7)},'defaults':{'companyId':_0x1664ef['id'],'key':_0x57d803(0x1e7),'value':_0x57d803(0x1ca)}}),await Setting_1[_0x57d803(0x1eb)][_0x57d803(0x1ea)]({'where':{'companyId':_0x1664ef['id'],'key':'sendMsgTransfTicket'},'defaults':{'companyId':_0x1664ef['id'],'key':_0x57d803(0x1c9),'value':_0x57d803(0x1ca)}}),await Setting_1[_0x57d803(0x1eb)]['findOrCreate']({'where':{'companyId':_0x1664ef['id'],'key':'chatBotType'},'defaults':{'companyId':_0x1664ef['id'],'key':_0x57d803(0x1f1),'value':'text'}}),await Setting_1[_0x57d803(0x1eb)]['findOrCreate']({'where':{'companyId':_0x1664ef['id'],'key':_0x57d803(0x1dc),'value':'2.3000.1020713899'}});if(_0x42c2ab['campaignsEnabled']!==undefined){const [_0x552802,_0x18a8ca]=await Setting_1['default'][_0x57d803(0x1ea)]({'where':{'companyId':_0x1664ef['id'],'key':_0x57d803(0x1d3)},'defaults':{'companyId':_0x1664ef['id'],'key':'campaignsEnabled','value':''+_0x255000}});!_0x18a8ca&&await _0x552802[_0x57d803(0x1f3)]({'value':''+_0x255000});}return _0x1664ef;};function a420_0x51a0(){const _0x4c0531=['prototype','getOwnPropertyDescriptor','writable','campaignsEnabled','scheduleType','string','required','2409255zZPPmT','create','__esModule','817923RvSEuz','validate','versionWA','1412088GtRudY','__setModuleDefault','apply','admin','message','defineProperty','__importDefault','min','4GmZjtf','call','sendGreetingAccepted','hasOwnProperty','getOwnPropertyNames','findOrCreate','default','4960180MUtbGb','toString','ERR_COMPANY_INVALID_NAME','Check-unique-name','configurable','chatBotType','shape','update','9NSrTTF','__importStar','11477587amHVyy','(((.+)+)+)+$','35240VCmRFG','7RBXKai','19DxHOqO','__createBinding','../../errors/AppError','ERR_COMPANY_NAME_ALREADY_EXISTS','sendMsgTransfTicket','disabled','../../models/User','2806xWrXBN','mudar123','CheckMsgIsGroup','../../models/Setting'];a420_0x51a0=function(){return _0x4c0531;};return a420_0x51a0();}exports[a420_0x42bcdc(0x1eb)]=CreateCompanyService;