'use strict';function a414_0x4e77(_0x3c8021,_0x33f9e6){const _0x1781be=a414_0x5031();return a414_0x4e77=function(_0x2641f0,_0xf51935){_0x2641f0=_0x2641f0-0x11f;let _0x503114=_0x1781be[_0x2641f0];return _0x503114;},a414_0x4e77(_0x3c8021,_0x33f9e6);}const a414_0xcd69f=a414_0x4e77;(function(_0x3954a9,_0x4a41d5){const _0x47527f=a414_0x4e77,_0x12b422=_0x3954a9();while(!![]){try{const _0x5ab5ca=parseInt(_0x47527f(0x12f))/0x1+parseInt(_0x47527f(0x14f))/0x2*(parseInt(_0x47527f(0x12c))/0x3)+parseInt(_0x47527f(0x129))/0x4*(parseInt(_0x47527f(0x12d))/0x5)+-parseInt(_0x47527f(0x123))/0x6*(parseInt(_0x47527f(0x14d))/0x7)+-parseInt(_0x47527f(0x14a))/0x8+parseInt(_0x47527f(0x12e))/0x9+-parseInt(_0x47527f(0x143))/0xa;if(_0x5ab5ca===_0x4a41d5)break;else _0x12b422['push'](_0x12b422['shift']());}catch(_0x3d32ad){_0x12b422['push'](_0x12b422['shift']());}}}(a414_0x5031,0xb86f7));function a414_0x5031(){const _0xcca37f=['2.3000.1020713899','text','321433QDUJKq','defineProperty','2aLUIau','scheduleType','constructor','apply','call','configurable','__importStar','disabled','test','findOrCreate','versionWA','__importDefault','min','ERR_COMPANY_NAME_ALREADY_EXISTS','default','66SYsSJQ','admin','toString','userRating','chatBotType','__createBinding','4936692pXsgDI','getOwnPropertyDescriptor','../../models/User','4033011NFOQtR','5SKMGaT','12442536nSTzIm','317064fsLmAs','__esModule','sendGreetingAccepted','string','update','(((.+)+)+)+$','shape','getOwnPropertyNames','sendMsgTransfTicket','create','required','validate','length','prototype','Check-unique-name','yup','CheckMsgIsGroup','../../models/Setting','enabled','ERR_COMPANY_INVALID_NAME','16145260fUjUzo','__setModuleDefault','../../errors/AppError','findOne','campaignsEnabled','message','hasOwnProperty','11223968mbSALg'];a414_0x5031=function(){return _0xcca37f;};return a414_0x5031();}var __createBinding=this&&this[a414_0xcd69f(0x128)]||(Object['create']?function(_0x2f2495,_0x10d7d2,_0x3e7be8,_0x26d6df){const _0x1e9dbe=a414_0xcd69f;if(_0x26d6df===undefined)_0x26d6df=_0x3e7be8;var _0x378b1a=Object[_0x1e9dbe(0x12a)](_0x10d7d2,_0x3e7be8);(!_0x378b1a||('get'in _0x378b1a?!_0x10d7d2[_0x1e9dbe(0x130)]:_0x378b1a['writable']||_0x378b1a[_0x1e9dbe(0x154)]))&&(_0x378b1a={'enumerable':!![],'get':function(){return _0x10d7d2[_0x3e7be8];}}),Object[_0x1e9dbe(0x14e)](_0x2f2495,_0x26d6df,_0x378b1a);}:function(_0x1c9444,_0x4cf63b,_0x35b02e,_0x6aae0c){if(_0x6aae0c===undefined)_0x6aae0c=_0x35b02e;_0x1c9444[_0x6aae0c]=_0x4cf63b[_0x35b02e];}),__setModuleDefault=this&&this[a414_0xcd69f(0x144)]||(Object[a414_0xcd69f(0x138)]?function(_0x4baada,_0x22e2c3){const _0x1ab3c5=a414_0xcd69f;Object[_0x1ab3c5(0x14e)](_0x4baada,_0x1ab3c5(0x122),{'enumerable':!![],'value':_0x22e2c3});}:function(_0x36f40a,_0x83d116){const _0x1e7b42=a414_0xcd69f;_0x36f40a[_0x1e7b42(0x122)]=_0x83d116;}),__importStar=this&&this[a414_0xcd69f(0x155)]||(function(){const _0x4f0710=(function(){let _0x112e06=!![];return function(_0x5ba94a,_0x28aebd){const _0x20a84d=_0x112e06?function(){const _0x18dee3=a414_0x4e77;if(_0x28aebd){const _0x395f5b=_0x28aebd[_0x18dee3(0x152)](_0x5ba94a,arguments);return _0x28aebd=null,_0x395f5b;}}:function(){};return _0x112e06=![],_0x20a84d;};}()),_0x53a27c=_0x4f0710(this,function(){const _0x54aaaf=a414_0x4e77;return _0x53a27c[_0x54aaaf(0x125)]()['search'](_0x54aaaf(0x134))['toString']()[_0x54aaaf(0x151)](_0x53a27c)['search'](_0x54aaaf(0x134));});_0x53a27c();var _0x41d12c=function(_0x32147d){const _0x2a803b=a414_0x4e77;return _0x41d12c=Object[_0x2a803b(0x136)]||function(_0xeb9aa2){const _0x578d21=_0x2a803b;var _0x4bac23=[];for(var _0x267656 in _0xeb9aa2)if(Object[_0x578d21(0x13c)][_0x578d21(0x149)]['call'](_0xeb9aa2,_0x267656))_0x4bac23[_0x4bac23['length']]=_0x267656;return _0x4bac23;},_0x41d12c(_0x32147d);};return function(_0x17e212){const _0x4314f8=a414_0x4e77;if(_0x17e212&&_0x17e212[_0x4314f8(0x130)])return _0x17e212;var _0x115e58={};if(_0x17e212!=null){for(var _0x33e061=_0x41d12c(_0x17e212),_0x2aa2a7=0x0;_0x2aa2a7<_0x33e061[_0x4314f8(0x13b)];_0x2aa2a7++)if(_0x33e061[_0x2aa2a7]!=='default')__createBinding(_0x115e58,_0x17e212,_0x33e061[_0x2aa2a7]);}return __setModuleDefault(_0x115e58,_0x17e212),_0x115e58;};}()),__importDefault=this&&this[a414_0xcd69f(0x11f)]||function(_0x42a542){const _0x943e0f=a414_0xcd69f;return _0x42a542&&_0x42a542[_0x943e0f(0x130)]?_0x42a542:{'default':_0x42a542};};Object['defineProperty'](exports,'__esModule',{'value':!![]});const Yup=__importStar(require(a414_0xcd69f(0x13e))),AppError_1=__importDefault(require(a414_0xcd69f(0x145))),Company_1=__importDefault(require('../../models/Company')),User_1=__importDefault(require(a414_0xcd69f(0x12b))),Setting_1=__importDefault(require(a414_0xcd69f(0x140))),CreateCompanyService=async _0x5e3c8a=>{const _0x338ad0=a414_0xcd69f,{name:_0xc11268,phone:_0x3aeda9,email:_0x1468d5,status:_0xead890,planId:_0x24b4a4,password:_0x2b1cb3,campaignsEnabled:_0x4c9430,dueDate:_0x282dce,recurrence:_0x1131bb}=_0x5e3c8a,_0x253495=Yup['object']()[_0x338ad0(0x135)]({'name':Yup[_0x338ad0(0x132)]()[_0x338ad0(0x120)](0x2,_0x338ad0(0x142))[_0x338ad0(0x139)](_0x338ad0(0x142))[_0x338ad0(0x157)](_0x338ad0(0x13d),_0x338ad0(0x121),async _0x1393ec=>{const _0x347a34=_0x338ad0;if(_0x1393ec){const _0x3312ba=await Company_1[_0x347a34(0x122)][_0x347a34(0x146)]({'where':{'name':_0x1393ec}});return!_0x3312ba;}return![];})});try{await _0x253495[_0x338ad0(0x13a)]({'name':_0xc11268});}catch(_0xf57844){throw new AppError_1[(_0x338ad0(0x122))](_0xf57844[_0x338ad0(0x148)]);}const _0x3785b9=await Company_1[_0x338ad0(0x122)][_0x338ad0(0x138)]({'name':_0xc11268,'phone':_0x3aeda9,'email':_0x1468d5,'status':_0xead890,'planId':_0x24b4a4,'dueDate':_0x282dce,'recurrence':_0x1131bb}),[_0x54b296,_0xa9683c]=await User_1[_0x338ad0(0x122)][_0x338ad0(0x158)]({'where':{'name':_0xc11268,'email':_0x1468d5},'defaults':{'name':_0xc11268,'email':_0x1468d5,'password':_0x2b1cb3||'mudar123','profile':_0x338ad0(0x124),'companyId':_0x3785b9['id']}});!_0xa9683c&&await _0x54b296[_0x338ad0(0x133)]({'companyId':_0x3785b9['id']});await Setting_1[_0x338ad0(0x122)]['findOrCreate']({'where':{'companyId':_0x3785b9['id'],'key':_0x338ad0(0x13f)},'defaults':{'companyId':_0x3785b9['id'],'key':_0x338ad0(0x141),'value':''}}),await Setting_1[_0x338ad0(0x122)][_0x338ad0(0x158)]({'where':{'companyId':_0x3785b9['id'],'key':''},'defaults':{'companyId':_0x3785b9['id'],'key':_0x338ad0(0x153),'value':_0x338ad0(0x156)}}),await Setting_1['default'][_0x338ad0(0x158)]({'where':{'companyId':_0x3785b9['id'],'key':_0x338ad0(0x150)},'defaults':{'companyId':_0x3785b9['id'],'key':_0x338ad0(0x150),'value':'disabled'}}),await Setting_1[_0x338ad0(0x122)]['findOrCreate']({'where':{'companyId':_0x3785b9['id'],'key':_0x338ad0(0x131)},'defaults':{'companyId':_0x3785b9['id'],'key':_0x338ad0(0x131),'value':_0x338ad0(0x156)}}),await Setting_1['default'][_0x338ad0(0x158)]({'where':{'companyId':_0x3785b9['id'],'key':_0x338ad0(0x137)},'defaults':{'companyId':_0x3785b9['id'],'key':_0x338ad0(0x137),'value':_0x338ad0(0x156)}}),await Setting_1[_0x338ad0(0x122)][_0x338ad0(0x158)]({'where':{'companyId':_0x3785b9['id'],'key':_0x338ad0(0x126)},'defaults':{'companyId':_0x3785b9['id'],'key':_0x338ad0(0x126),'value':_0x338ad0(0x156)}}),await Setting_1['default'][_0x338ad0(0x158)]({'where':{'companyId':_0x3785b9['id'],'key':_0x338ad0(0x127)},'defaults':{'companyId':_0x3785b9['id'],'key':'chatBotType','value':_0x338ad0(0x14c)}}),await Setting_1[_0x338ad0(0x122)][_0x338ad0(0x158)]({'where':{'companyId':_0x3785b9['id'],'key':_0x338ad0(0x159),'value':_0x338ad0(0x14b)}});if(_0x5e3c8a[_0x338ad0(0x147)]!==undefined){const [_0x1d6d81,_0x415903]=await Setting_1[_0x338ad0(0x122)][_0x338ad0(0x158)]({'where':{'companyId':_0x3785b9['id'],'key':_0x338ad0(0x147)},'defaults':{'companyId':_0x3785b9['id'],'key':'campaignsEnabled','value':''+_0x4c9430}});!_0x415903&&await _0x1d6d81[_0x338ad0(0x133)]({'value':''+_0x4c9430});}return _0x3785b9;};exports['default']=CreateCompanyService;