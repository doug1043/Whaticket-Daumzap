'use strict';const a559_0x2c087b=a559_0x4f20;(function(_0x386cd6,_0x58369b){const _0x4d74d9=a559_0x4f20,_0x2efc38=_0x386cd6();while(!![]){try{const _0x401c61=-parseInt(_0x4d74d9(0xff))/0x1*(-parseInt(_0x4d74d9(0x120))/0x2)+-parseInt(_0x4d74d9(0x169))/0x3+-parseInt(_0x4d74d9(0x168))/0x4*(parseInt(_0x4d74d9(0x152))/0x5)+-parseInt(_0x4d74d9(0x12e))/0x6+-parseInt(_0x4d74d9(0xf8))/0x7+-parseInt(_0x4d74d9(0x146))/0x8*(parseInt(_0x4d74d9(0x117))/0x9)+parseInt(_0x4d74d9(0xf9))/0xa;if(_0x401c61===_0x58369b)break;else _0x2efc38['push'](_0x2efc38['shift']());}catch(_0x18cf6c){_0x2efc38['push'](_0x2efc38['shift']());}}}(a559_0xdf5f,0x57824));var __createBinding=this&&this[a559_0x2c087b(0x173)]||(Object['create']?function(_0x291df8,_0x5c3974,_0x4642f8,_0x298171){const _0x5a58b6=a559_0x2c087b;if(_0x298171===undefined)_0x298171=_0x4642f8;var _0x44e6a3=Object[_0x5a58b6(0x129)](_0x5c3974,_0x4642f8);(!_0x44e6a3||(_0x5a58b6(0x14d)in _0x44e6a3?!_0x5c3974[_0x5a58b6(0x150)]:_0x44e6a3['writable']||_0x44e6a3[_0x5a58b6(0x115)]))&&(_0x44e6a3={'enumerable':!![],'get':function(){return _0x5c3974[_0x4642f8];}}),Object[_0x5a58b6(0x154)](_0x291df8,_0x298171,_0x44e6a3);}:function(_0x288907,_0x457b13,_0x18ef5b,_0x4400a2){if(_0x4400a2===undefined)_0x4400a2=_0x18ef5b;_0x288907[_0x4400a2]=_0x457b13[_0x18ef5b];}),__setModuleDefault=this&&this[a559_0x2c087b(0x163)]||(Object[a559_0x2c087b(0x12f)]?function(_0x2b4af8,_0x3dad53){const _0x2ba059=a559_0x2c087b;Object[_0x2ba059(0x154)](_0x2b4af8,_0x2ba059(0x16b),{'enumerable':!![],'value':_0x3dad53});}:function(_0x4944bd,_0x2695fc){_0x4944bd['default']=_0x2695fc;}),__importStar=this&&this['__importStar']||(function(){const _0x5d7889=(function(){let _0x59200a=!![];return function(_0x3f64a7,_0x455d0f){const _0x54c185=_0x59200a?function(){if(_0x455d0f){const _0x2687d1=_0x455d0f['apply'](_0x3f64a7,arguments);return _0x455d0f=null,_0x2687d1;}}:function(){};return _0x59200a=![],_0x54c185;};}()),_0x364b18=_0x5d7889(this,function(){const _0x42b46a=a559_0x4f20;return _0x364b18[_0x42b46a(0x102)]()[_0x42b46a(0x161)](_0x42b46a(0xf6))[_0x42b46a(0x102)]()[_0x42b46a(0x167)](_0x364b18)['search'](_0x42b46a(0xf6));});_0x364b18();var _0x1587fe=function(_0x52a601){const _0x377dd5=a559_0x4f20;return _0x1587fe=Object[_0x377dd5(0x12c)]||function(_0x3b9133){const _0x2b98b6=_0x377dd5;var _0x45c94e=[];for(var _0x8d7616 in _0x3b9133)if(Object[_0x2b98b6(0x15b)][_0x2b98b6(0xfe)]['call'](_0x3b9133,_0x8d7616))_0x45c94e[_0x45c94e[_0x2b98b6(0x160)]]=_0x8d7616;return _0x45c94e;},_0x1587fe(_0x52a601);};return function(_0x2886da){const _0x3ef614=a559_0x4f20;if(_0x2886da&&_0x2886da[_0x3ef614(0x150)])return _0x2886da;var _0x1f81af={};if(_0x2886da!=null){for(var _0x285a97=_0x1587fe(_0x2886da),_0x27818a=0x0;_0x27818a<_0x285a97['length'];_0x27818a++)if(_0x285a97[_0x27818a]!==_0x3ef614(0x16b))__createBinding(_0x1f81af,_0x2886da,_0x285a97[_0x27818a]);}return __setModuleDefault(_0x1f81af,_0x2886da),_0x1f81af;};}()),__importDefault=this&&this[a559_0x2c087b(0x12d)]||function(_0x34b392){const _0x3e5d70=a559_0x2c087b;return _0x34b392&&_0x34b392[_0x3e5d70(0x150)]?_0x34b392:{'default':_0x34b392};};Object[a559_0x2c087b(0x154)](exports,a559_0x2c087b(0x150),{'value':!![]});const axios_1=__importDefault(require('axios')),GetHandlers_1=require('../WbotServices/GetHandlers'),logger_1=require('../../utils/logger'),lodash_1=require(a559_0x2c087b(0x111)),UpdateTicketService_1=__importDefault(require('../TicketServices/UpdateTicketService')),SendPresenceStatus_1=require(a559_0x2c087b(0x174)),SendWhatsAppMedia_1=__importDefault(require('../WbotServices/SendWhatsAppMedia')),Sentry=__importStar(require('@sentry/node')),SendWhatsAppMessage_1=__importDefault(require(a559_0x2c087b(0x138))),typebotListener=async({wbot:_0x327c13,msg:_0xa99dd5,ticket:_0x135acf,typebot:_0x17cac8})=>{const _0x146b3d=a559_0x2c087b;if(_0xa99dd5['key']['remoteJid']===_0x146b3d(0x136))return;const {urlN8N:_0x174aea,typebotExpires:_0x209ed4,typebotKeywordFinish:_0x44d504,typebotKeywordRestart:_0x278be6,typebotUnknownMessage:_0x325711,typebotSlug:_0x4ee5c2,typebotDelayMessage:_0x2b6a64,typebotRestartMessage:_0xe3346}=_0x17cac8;if(_0xa99dd5[_0x146b3d(0x140)][_0x146b3d(0x10f)]){console['log'](_0x146b3d(0x12b));return;}const _0x586446=_0xa99dd5[_0x146b3d(0x140)][_0x146b3d(0xfc)]['replace'](/\D/g,'');let _0x33edc7=(0x0,GetHandlers_1['getBodyMessage'])(_0xa99dd5);console[_0x146b3d(0x124)](_0x146b3d(0x14c)+_0x33edc7+'\x22');async function _0x49738a(_0x19a2fa,_0x4a9a1d,_0x447364){const _0x17f614=_0x146b3d;try{console[_0x17f614(0x124)]('[typebotListener]\x20Criando\x20nova\x20sessão\x20para\x20o\x20número:\x20'+_0x447364);const _0x4e6dee=JSON[_0x17f614(0x16d)]({'isStreamEnabled':!![],'message':_0x17f614(0x151),'resultId':_0x17f614(0x151),'isOnlyRegistering':![],'prefilledVariables':{'number':_0x447364,'pushName':_0x19a2fa[_0x17f614(0x134)]||'','remoteJid':_0x135acf?.['contact']?.[_0x17f614(0xfc)]}});console[_0x17f614(0x124)](_0x17f614(0x112)+_0x4e6dee);const _0x5696b7={'method':'post','maxBodyLength':Infinity,'url':_0x174aea+_0x17f614(0x170)+_0x4ee5c2+_0x17f614(0x125),'headers':{'Content-Type':_0x17f614(0x159),'Accept':_0x17f614(0x159)},'data':_0x4e6dee};console['log'](_0x17f614(0x119)+_0x5696b7[_0x17f614(0x104)]);const _0x4b6e55=await axios_1[_0x17f614(0x16b)][_0x17f614(0x103)](_0x5696b7);return console['log'](_0x17f614(0x165)+_0x4b6e55[_0x17f614(0x171)]?.['sessionId']),_0x4b6e55[_0x17f614(0x171)];}catch(_0x429d46){console[_0x17f614(0x132)](_0x17f614(0x13d),_0x429d46);_0x429d46['response']&&(console[_0x17f614(0x132)](_0x17f614(0x100)+JSON[_0x17f614(0x16d)](_0x429d46[_0x17f614(0x177)][_0x17f614(0x171)])),console[_0x17f614(0x132)](_0x17f614(0x156)+_0x429d46['response']['status']));logger_1['logger'][_0x17f614(0x121)](_0x17f614(0x13c),_0x429d46);throw _0x429d46;}}let _0x317ed9,_0x2157c5;try{const _0x1fda63=new Date();_0x1fda63[_0x146b3d(0x108)](_0x1fda63[_0x146b3d(0x113)]()-Number(_0x209ed4)),console[_0x146b3d(0x124)](_0x146b3d(0x135)+_0x209ed4+_0x146b3d(0x123)+_0x135acf[_0x146b3d(0x16a)]);_0x209ed4>0x0&&_0x135acf[_0x146b3d(0x16a)]<_0x1fda63&&(console[_0x146b3d(0x124)](_0x146b3d(0x11d)),await _0x135acf['update']({'typebotSessionId':null,'chatbot':!![]}),await _0x135acf[_0x146b3d(0x109)]());!_0x135acf[_0x146b3d(0x116)]?(console[_0x146b3d(0x124)](_0x146b3d(0x148)),_0x2157c5=await _0x49738a(_0xa99dd5,_0x17cac8,_0x586446),_0x317ed9=_0x2157c5[_0x146b3d(0xfa)],console['log'](_0x146b3d(0x137)+_0x317ed9),await _0x135acf[_0x146b3d(0x166)]({'typebotSessionId':_0x317ed9,'useIntegration':!![],'integrationId':_0x17cac8['id'],'chatbot':!![]}),await _0x135acf[_0x146b3d(0x109)]()):(console[_0x146b3d(0x124)](_0x146b3d(0x13e)+_0x135acf['typebotSessionId']),_0x317ed9=_0x135acf[_0x146b3d(0x116)],_0x2157c5=undefined);if(_0x33edc7!==_0x44d504&&_0x33edc7!==_0x278be6){let _0x180a69,_0x613758,_0x13725a;if(_0x2157c5?.[_0x146b3d(0x131)]?.[_0x146b3d(0x160)]===0x0||_0x2157c5===undefined){console[_0x146b3d(0x124)](_0x146b3d(0x130)+_0x33edc7+'\x22');(!_0x33edc7||_0x33edc7[_0x146b3d(0x139)]()==='')&&(_0x33edc7=_0x146b3d(0x164),console['log']('[typebotListener]\x20Mensagem\x20vazia\x20detectada,\x20usando\x20texto\x20padrão:\x20\x22'+_0x33edc7+'\x22'));const _0x32a527=JSON['stringify']({'message':_0x33edc7});let _0x4ed429={'method':_0x146b3d(0x114),'maxBodyLength':Infinity,'url':_0x174aea+_0x146b3d(0x15d)+_0x317ed9+_0x146b3d(0x147),'headers':{'Content-Type':_0x146b3d(0x159),'Accept':_0x146b3d(0x159)},'data':_0x32a527};console[_0x146b3d(0x124)]('[typebotListener]\x20Enviando\x20requisição\x20para\x20continuar\x20chat.\x20URL:\x20'+_0x4ed429[_0x146b3d(0x104)]+_0x146b3d(0x141)+_0x32a527);try{_0x180a69=await axios_1[_0x146b3d(0x16b)]['request'](_0x4ed429),console[_0x146b3d(0x124)](_0x146b3d(0x105)+JSON[_0x146b3d(0x16d)](_0x180a69[_0x146b3d(0x171)]));if(!_0x180a69[_0x146b3d(0x171)]){console['error'](_0x146b3d(0x143));throw new Error(_0x146b3d(0x17b));}_0x613758=_0x180a69['data']?.[_0x146b3d(0x131)],_0x13725a=_0x180a69[_0x146b3d(0x171)]?.[_0x146b3d(0x179)],console[_0x146b3d(0x124)](_0x146b3d(0x133)+(_0x613758?.[_0x146b3d(0x160)]||0x0)+',\x20Input\x20recebido:\x20'+(_0x13725a?_0x146b3d(0x12a):_0x146b3d(0x14f))),!_0x13725a&&(console[_0x146b3d(0x124)]('atualizando\x20typebotStatus...'),await _0x135acf['update']({'typebotStatus':!![]}));}catch(_0x37a692){console['error'](_0x146b3d(0x144),_0x37a692);_0x37a692[_0x146b3d(0x177)]&&(console['error'](_0x146b3d(0x100)+JSON['stringify'](_0x37a692[_0x146b3d(0x177)]['data'])),console['error'](_0x146b3d(0x156)+_0x37a692[_0x146b3d(0x177)][_0x146b3d(0x162)]));await _0x135acf['update']({'typebotSessionId':null}),await(0x0,SendWhatsAppMessage_1[_0x146b3d(0x16b)])({'body':'Desculpe,\x20ocorreu\x20um\x20erro\x20na\x20nossa\x20comunicação.\x20Por\x20favor,\x20envie\x20uma\x20nova\x20mensagem\x20para\x20recomeçar.','ticket':_0x135acf});return;}}else console['log'](_0x146b3d(0x10a)),_0x613758=_0x2157c5?.[_0x146b3d(0x131)],_0x13725a=_0x2157c5?.[_0x146b3d(0x179)];if(!_0x613758||_0x613758?.['length']===0x0){console[_0x146b3d(0x124)](_0x146b3d(0x128));if(_0x180a69&&_0x180a69['data']&&_0x13725a===null){console[_0x146b3d(0x124)](_0x146b3d(0x127)),await _0x135acf[_0x146b3d(0x166)]({'chatbot':![],'useIntegration':![]});return;}await(0x0,SendWhatsAppMessage_1[_0x146b3d(0x16b)])({'body':_0x325711,'ticket':_0x135acf});}else{console['log'](_0x146b3d(0x175)+_0x613758[_0x146b3d(0x160)]+_0x146b3d(0x11b));for(const _0x1d35b1 of _0x613758){if(_0x1d35b1['type']===_0x146b3d(0x118)){let _0x95d52d='',_0x1b9006=![];console[_0x146b3d(0x124)]('[typebotListener]\x20Processando\x20mensagem\x20de\x20texto:\x20'+JSON[_0x146b3d(0x16d)](_0x1d35b1[_0x146b3d(0x178)]));for(const _0x1c71cf of _0x1d35b1['content']['richText']){for(const _0x3f5657 of _0x1c71cf[_0x146b3d(0x10d)]){let _0x1fa33f='';_0x3f5657[_0x146b3d(0x118)]&&(_0x1fa33f=_0x3f5657['text']);if(_0x3f5657[_0x146b3d(0x107)]&&_0x3f5657[_0x146b3d(0x10d)])for(const _0x39659c of _0x3f5657[_0x146b3d(0x10d)]){let _0x585670='';_0x39659c[_0x146b3d(0x118)]&&(_0x585670=_0x39659c['text']);if(_0x39659c[_0x146b3d(0x107)]&&_0x39659c[_0x146b3d(0x10d)])for(const _0x354c94 of _0x39659c[_0x146b3d(0x10d)]){let _0x65d61f='';_0x354c94['text']&&(_0x65d61f=_0x354c94['text']);_0x354c94['bold']&&(_0x65d61f='*'+_0x65d61f+'*');_0x354c94[_0x146b3d(0x158)]&&(_0x65d61f='_'+_0x65d61f+'_');_0x354c94[_0x146b3d(0x142)]&&(_0x65d61f='~'+_0x65d61f+'~');if(_0x354c94[_0x146b3d(0x104)]){const _0x103bfd=_0x354c94[_0x146b3d(0x10d)][0x0]?.[_0x146b3d(0x118)]||_0x146b3d(0x15e);_0x65d61f='['+_0x103bfd+']('+_0x354c94[_0x146b3d(0x104)]+')',_0x1b9006=!![];}_0x95d52d+=_0x65d61f;}_0x39659c[_0x146b3d(0x16f)]&&(_0x585670='*'+_0x585670+'*');_0x39659c[_0x146b3d(0x158)]&&(_0x585670='_'+_0x585670+'_');_0x39659c[_0x146b3d(0x142)]&&(_0x585670='~'+_0x585670+'~');if(_0x39659c[_0x146b3d(0x104)]){const _0x2a8f7f=_0x39659c['children'][0x0]?.[_0x146b3d(0x118)]||_0x146b3d(0x15e);_0x585670='['+_0x2a8f7f+']('+_0x39659c[_0x146b3d(0x104)]+')',_0x1b9006=!![];}_0x95d52d+=_0x585670;}_0x3f5657[_0x146b3d(0x16f)]&&(_0x1fa33f='*'+_0x1fa33f+'*');_0x3f5657[_0x146b3d(0x158)]&&(_0x1fa33f='_'+_0x1fa33f+'_');_0x3f5657[_0x146b3d(0x142)]&&(_0x1fa33f='~'+_0x1fa33f+'~');if(_0x3f5657[_0x146b3d(0x104)]){const _0x366d86=_0x3f5657[_0x146b3d(0x10d)][0x0]?.[_0x146b3d(0x118)]||'link';_0x1fa33f='['+_0x366d86+']('+_0x3f5657[_0x146b3d(0x104)]+')',_0x1b9006=!![];}_0x95d52d+=_0x1fa33f;}_0x95d52d+='\x0a';}_0x95d52d=_0x95d52d['replace']('**','')[_0x146b3d(0x14a)](/\n$/,'');_0x95d52d===_0x146b3d(0x13f)&&(_0x95d52d=_0x325711);if(_0x95d52d[_0x146b3d(0x11c)]('#')){let _0x2eb95e=_0x95d52d[_0x146b3d(0x14a)]('#','');try{console[_0x146b3d(0x124)](_0x146b3d(0x11f)+_0x2eb95e);let _0x4a6a63=JSON[_0x146b3d(0x101)](_0x2eb95e);if(_0x4a6a63[_0x146b3d(0x15f)]&&(0x0,lodash_1[_0x146b3d(0x110)])(_0x4a6a63[_0x146b3d(0x106)])&&(0x0,lodash_1['isNil'])(_0x4a6a63[_0x146b3d(0x16c)])){console[_0x146b3d(0x124)](_0x146b3d(0xfd)),await _0x135acf[_0x146b3d(0x166)]({'useIntegration':![],'chatbot':![]});return;}if(!(0x0,lodash_1[_0x146b3d(0x110)])(_0x4a6a63[_0x146b3d(0x16c)])&&_0x4a6a63[_0x146b3d(0x16c)]>0x0&&(0x0,lodash_1[_0x146b3d(0x110)])(_0x4a6a63['userId'])){console[_0x146b3d(0x124)](_0x146b3d(0x122)+_0x4a6a63[_0x146b3d(0x16c)]),await(0x0,UpdateTicketService_1['default'])({'ticketData':{'queueId':_0x4a6a63['queueId'],'chatbot':![],'useIntegration':![],'integrationId':null},'ticketId':_0x135acf['id'],'companyId':_0x135acf[_0x146b3d(0x155)]});return;}if(!(0x0,lodash_1[_0x146b3d(0x110)])(_0x4a6a63[_0x146b3d(0x16c)])&&_0x4a6a63[_0x146b3d(0x16c)]>0x0&&!(0x0,lodash_1[_0x146b3d(0x110)])(_0x4a6a63[_0x146b3d(0x106)])&&_0x4a6a63[_0x146b3d(0x106)]>0x0){console[_0x146b3d(0x124)](_0x146b3d(0x15c)+_0x4a6a63[_0x146b3d(0x16c)]+_0x146b3d(0x10c)+_0x4a6a63[_0x146b3d(0x106)]),await(0x0,UpdateTicketService_1[_0x146b3d(0x16b)])({'ticketData':{'queueId':_0x4a6a63['queueId'],'userId':_0x4a6a63[_0x146b3d(0x106)],'chatbot':![],'useIntegration':![],'integrationId':null},'ticketId':_0x135acf['id'],'companyId':_0x135acf[_0x146b3d(0x155)]});return;}}catch(_0x4fd945){console[_0x146b3d(0x132)]('[typebotListener]\x20Erro\x20ao\x20processar\x20gatilho\x20JSON:',_0x4fd945);throw _0x4fd945;}}console[_0x146b3d(0x124)](_0x146b3d(0x14e)+_0x95d52d[_0x146b3d(0x13b)](0x0,0x32)+(_0x95d52d[_0x146b3d(0x160)]>0x32?_0x146b3d(0x15a):'')+'\x22'),await(0x0,SendPresenceStatus_1[_0x146b3d(0x11a)])(_0x327c13,_0xa99dd5[_0x146b3d(0x140)][_0x146b3d(0xfc)],_0x2b6a64),await(0x0,SendWhatsAppMessage_1[_0x146b3d(0x16b)])({'body':_0x95d52d,'ticket':_0x135acf});}if(_0x1d35b1[_0x146b3d(0x107)]===_0x146b3d(0x149)){console[_0x146b3d(0x124)](_0x146b3d(0x10e)+_0x1d35b1[_0x146b3d(0x178)][_0x146b3d(0x104)]),await(0x0,SendPresenceStatus_1[_0x146b3d(0x11a)])(_0x327c13,_0xa99dd5[_0x146b3d(0x140)][_0x146b3d(0xfc)],_0x2b6a64);try{await(0x0,SendWhatsAppMedia_1[_0x146b3d(0x16b)])({'media':_0x1d35b1[_0x146b3d(0x178)][_0x146b3d(0x104)],'ticket':_0x135acf}),console['log']('[typebotListener]\x20Áudio\x20enviado\x20com\x20sucesso.');}catch(_0x27b7a7){console[_0x146b3d(0x132)](_0x146b3d(0x10b),_0x27b7a7),Sentry['captureException'](_0x27b7a7);throw _0x27b7a7;}}if(_0x1d35b1[_0x146b3d(0x107)]===_0x146b3d(0x145)){console[_0x146b3d(0x124)](_0x146b3d(0xf7)+_0x1d35b1[_0x146b3d(0x178)][_0x146b3d(0x104)]),await(0x0,SendPresenceStatus_1['SendPresenceStatus'])(_0x327c13,_0xa99dd5['key'][_0x146b3d(0xfc)],_0x2b6a64);try{await(0x0,SendWhatsAppMedia_1[_0x146b3d(0x16b)])({'media':_0x1d35b1[_0x146b3d(0x178)]['url'],'ticket':_0x135acf}),console[_0x146b3d(0x124)]('[typebotListener]\x20Imagem\x20enviada\x20com\x20sucesso.');}catch(_0x1e57a3){console[_0x146b3d(0x132)](_0x146b3d(0x153),_0x1e57a3),Sentry[_0x146b3d(0x16e)](_0x1e57a3);throw _0x1e57a3;}}if(_0x1d35b1[_0x146b3d(0x107)]==='document'){console[_0x146b3d(0x124)](_0x146b3d(0x126)+_0x1d35b1['content'][_0x146b3d(0x104)]),await(0x0,SendPresenceStatus_1[_0x146b3d(0x11a)])(_0x327c13,_0xa99dd5[_0x146b3d(0x140)][_0x146b3d(0xfc)],_0x2b6a64);try{await(0x0,SendWhatsAppMedia_1[_0x146b3d(0x16b)])({'media':_0x1d35b1[_0x146b3d(0x178)]['url'],'ticket':_0x135acf}),console[_0x146b3d(0x124)](_0x146b3d(0x14b));}catch(_0xfd9581){console[_0x146b3d(0x132)](_0x146b3d(0x13a),_0xfd9581),Sentry[_0x146b3d(0x16e)](_0xfd9581);throw _0xfd9581;}}}}}_0x33edc7===_0x278be6&&(console[_0x146b3d(0x124)](_0x146b3d(0x176)),await _0x135acf[_0x146b3d(0x166)]({'chatbot':!![],'typebotSessionId':null}),await _0x135acf[_0x146b3d(0x109)](),await(0x0,SendWhatsAppMessage_1[_0x146b3d(0x16b)])({'body':_0xe3346,'ticket':_0x135acf}));if(_0x33edc7===_0x44d504){console[_0x146b3d(0x124)](_0x146b3d(0x17a)),await(0x0,UpdateTicketService_1['default'])({'ticketData':{'status':_0x146b3d(0x172),'useIntegration':![],'integrationId':null},'ticketId':_0x135acf['id'],'companyId':_0x135acf[_0x146b3d(0x155)]});return;}}catch(_0x8f0ef6){console[_0x146b3d(0x132)](_0x146b3d(0xfb),_0x8f0ef6);_0x8f0ef6[_0x146b3d(0x177)]&&(console[_0x146b3d(0x132)]('[typebotListener]\x20Resposta\x20de\x20erro:\x20'+JSON[_0x146b3d(0x16d)](_0x8f0ef6[_0x146b3d(0x177)][_0x146b3d(0x171)])),console[_0x146b3d(0x132)](_0x146b3d(0x156)+_0x8f0ef6[_0x146b3d(0x177)][_0x146b3d(0x162)]));logger_1[_0x146b3d(0x157)][_0x146b3d(0x121)]('Error\x20on\x20typebotListener:\x20',_0x8f0ef6),await _0x135acf['update']({'typebotSessionId':null});try{await(0x0,SendWhatsAppMessage_1[_0x146b3d(0x16b)])({'body':'Desculpe,\x20ocorreu\x20um\x20erro\x20na\x20nossa\x20comunicação.\x20Por\x20favor,\x20envie\x20uma\x20nova\x20mensagem\x20para\x20recomeçar.','ticket':_0x135acf});}catch(_0x39a3ac){console[_0x146b3d(0x132)](_0x146b3d(0x11e),_0x39a3ac);}}};function a559_0x4f20(_0x435938,_0x4333e6){const _0x390b4a=a559_0xdf5f();return a559_0x4f20=function(_0x13bcbe,_0x3c7e65){_0x13bcbe=_0x13bcbe-0xf6;let _0xdf5f71=_0x390b4a[_0x13bcbe];return _0xdf5f71;},a559_0x4f20(_0x435938,_0x4333e6);}exports[a559_0x2c087b(0x16b)]=typebotListener;function a559_0xdf5f(){const _0x24b251=['[typebotListener]\x20Processando\x20comando\x20de\x20finalização','Resposta\x20vazia\x20do\x20Typebot','(((.+)+)+)+$','[typebotListener]\x20Processando\x20mensagem\x20de\x20imagem:\x20','1353583PzuWdj','20556100rBaXsR','sessionId','[typebotListener]\x20Erro\x20geral:','remoteJid','[typebotListener]\x20Executando\x20comando\x20stopBot','hasOwnProperty','1QTOPtf','[typebotListener]\x20Resposta\x20de\x20erro:\x20','parse','toString','request','url','[typebotListener]\x20Resposta\x20recebida\x20do\x20Typebot:\x20','userId','type','setMinutes','reload','[typebotListener]\x20Usando\x20dados\x20da\x20sessão\x20recém-criada','[typebotListener]\x20Erro\x20ao\x20enviar\x20áudio:','\x20e\x20usuário\x20','children','[typebotListener]\x20Processando\x20mensagem\x20de\x20áudio:\x20','fromMe','isNil','lodash','[typebotListener]\x20Dados\x20da\x20requisição\x20para\x20criar\x20sessão:\x20','getMinutes','post','configurable','typebotSessionId','5719878SmSJWZ','text','[typebotListener]\x20URL\x20da\x20requisição:\x20','SendPresenceStatus','\x20mensagens','startsWith','[typebotListener]\x20Sessão\x20expirada\x20por\x20tempo\x20limite.\x20Resetando\x20sessão.','[typebotListener]\x20Erro\x20ao\x20enviar\x20mensagem\x20de\x20erro:','[typebotListener]\x20Processando\x20gatilho\x20JSON:\x20','97846wPmHrY','info','[typebotListener]\x20Redirecionando\x20para\x20fila:\x20',',\x20updatedAt:\x20','log','/startChat','[typebotListener]\x20Processando\x20mensagem\x20de\x20documento:\x20','[typebotListener]\x20Fim\x20natural\x20do\x20fluxo\x20detectado.\x20Finalizando\x20sem\x20erro.','[typebotListener]\x20Nenhuma\x20mensagem\x20recebida.\x20Verificando\x20status\x20do\x20fluxo.','getOwnPropertyDescriptor','Sim','[typebotListener]\x20Mensagem\x20enviada\x20pelo\x20sistema.\x20Ignorando.','getOwnPropertyNames','__importDefault','2218218hBuXfx','create','[typebotListener]\x20Continuando\x20conversa\x20com\x20a\x20mensagem:\x20\x22','messages','error','[typebotListener]\x20Mensagens\x20recebidas:\x20','pushName','[typebotListener]\x20Verificando\x20expiração\x20da\x20sessão.\x20typebotExpires:\x20','status@broadcast','[typebotListener]\x20Nova\x20sessão\x20criada:\x20','../WbotServices/SendWhatsAppMessage','trim','[typebotListener]\x20Erro\x20ao\x20enviar\x20documento:','substring','Erro\x20ao\x20criar\x20sessão\x20do\x20typebot:\x20','[typebotListener]\x20Erro\x20ao\x20criar\x20sessão\x20do\x20typebot:','[typebotListener]\x20Usando\x20sessão\x20existente:\x20','Invalid\x20message.\x20Please,\x20try\x20again.','key',',\x20Dados:\x20','underline','[typebotListener]\x20Resposta\x20vazia\x20do\x20Typebot','[typebotListener]\x20Erro\x20ao\x20continuar\x20chat:','image','8sFpHIe','/continueChat','[typebotListener]\x20Ticket\x20sem\x20sessão\x20ativa.\x20Criando\x20nova\x20sessão.','audio','replace','[typebotListener]\x20Documento\x20enviado\x20com\x20sucesso.','[typebotListener]\x20Mensagem\x20recebida:\x20\x22','get','[typebotListener]\x20Enviando\x20mensagem\x20formatada:\x20\x22','Não','__esModule','string','35ESYJmg','[typebotListener]\x20Erro\x20ao\x20enviar\x20imagem:','defineProperty','companyId','[typebotListener]\x20Status\x20de\x20erro:\x20','logger','italic','application/json','...','prototype','[typebotListener]\x20Redirecionando\x20para\x20fila\x20','/api/v1/sessions/','link','stopBot','length','search','status','__setModuleDefault','Mensagem\x20vazia','[typebotListener]\x20Sessão\x20criada\x20com\x20sucesso.\x20SessionID:\x20','update','constructor','4504UpCIxF','1618803dFJfkA','updatedAt','default','queueId','stringify','captureException','bold','/api/v1/typebots/','data','closed','__createBinding','../../helpers/SendPresenceStatus','[typebotListener]\x20Processando\x20','[typebotListener]\x20Processando\x20comando\x20de\x20reinício','response','content','input'];a559_0xdf5f=function(){return _0x24b251;};return a559_0xdf5f();}