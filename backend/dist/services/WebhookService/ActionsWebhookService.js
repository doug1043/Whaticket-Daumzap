'use strict';const a700_0x3b5d18=a700_0xfc95;(function(_0x5c7bd6,_0x4aea7c){const _0x3ef555=a700_0xfc95,_0x47db2d=_0x5c7bd6();while(!![]){try{const _0x5d340e=-parseInt(_0x3ef555(0x122))/0x1*(parseInt(_0x3ef555(0xf6))/0x2)+-parseInt(_0x3ef555(0x18b))/0x3*(-parseInt(_0x3ef555(0x114))/0x4)+-parseInt(_0x3ef555(0x187))/0x5+parseInt(_0x3ef555(0x178))/0x6+parseInt(_0x3ef555(0x104))/0x7*(-parseInt(_0x3ef555(0x18e))/0x8)+parseInt(_0x3ef555(0x119))/0x9*(parseInt(_0x3ef555(0x184))/0xa)+parseInt(_0x3ef555(0x13e))/0xb;if(_0x5d340e===_0x4aea7c)break;else _0x47db2d['push'](_0x47db2d['shift']());}catch(_0x22ff32){_0x47db2d['push'](_0x47db2d['shift']());}}}(a700_0x1902,0x8339c));function a700_0xfc95(_0x5da003,_0x42e23c){const _0x22ea55=a700_0x1902();return a700_0xfc95=function(_0x2946ba,_0x166d4b){_0x2946ba=_0x2946ba-0xce;let _0x190208=_0x22ea55[_0x2946ba];return _0x190208;},a700_0xfc95(_0x5da003,_0x42e23c);}var __createBinding=this&&this['__createBinding']||(Object[a700_0x3b5d18(0x127)]?function(_0x21b716,_0x586743,_0x5a58d9,_0x6677b5){const _0x5b8213=a700_0x3b5d18;if(_0x6677b5===undefined)_0x6677b5=_0x5a58d9;var _0x5e51a8=Object[_0x5b8213(0x168)](_0x586743,_0x5a58d9);(!_0x5e51a8||('get'in _0x5e51a8?!_0x586743[_0x5b8213(0x156)]:_0x5e51a8[_0x5b8213(0x112)]||_0x5e51a8[_0x5b8213(0xdd)]))&&(_0x5e51a8={'enumerable':!![],'get':function(){return _0x586743[_0x5a58d9];}}),Object[_0x5b8213(0xd8)](_0x21b716,_0x6677b5,_0x5e51a8);}:function(_0x248184,_0x88b1e2,_0x371dfb,_0x22b1f2){if(_0x22b1f2===undefined)_0x22b1f2=_0x371dfb;_0x248184[_0x22b1f2]=_0x88b1e2[_0x371dfb];}),__setModuleDefault=this&&this[a700_0x3b5d18(0x130)]||(Object['create']?function(_0x5498fe,_0x4b42f0){const _0x336d8c=a700_0x3b5d18;Object['defineProperty'](_0x5498fe,_0x336d8c(0x116),{'enumerable':!![],'value':_0x4b42f0});}:function(_0x33edb2,_0x4582ef){_0x33edb2['default']=_0x4582ef;}),__importStar=this&&this[a700_0x3b5d18(0x123)]||(function(){const _0xe5249d=(function(){let _0xcc8e4e=!![];return function(_0x2dd83f,_0xac4a79){const _0x3b7165=_0xcc8e4e?function(){if(_0xac4a79){const _0x3a9145=_0xac4a79['apply'](_0x2dd83f,arguments);return _0xac4a79=null,_0x3a9145;}}:function(){};return _0xcc8e4e=![],_0x3b7165;};}()),_0x24c3c0=_0xe5249d(this,function(){const _0x4d1568=a700_0xfc95;return _0x24c3c0[_0x4d1568(0xe7)]()[_0x4d1568(0x176)]('(((.+)+)+)+$')['toString']()['constructor'](_0x24c3c0)[_0x4d1568(0x176)](_0x4d1568(0xe0));});_0x24c3c0();var _0x26506d=function(_0xdd8b3e){const _0x431e9b=a700_0xfc95;return _0x26506d=Object[_0x431e9b(0x194)]||function(_0x4b792a){const _0x45b794=_0x431e9b;var _0x1c1ffc=[];for(var _0x292ecd in _0x4b792a)if(Object[_0x45b794(0xea)][_0x45b794(0x1b4)][_0x45b794(0x150)](_0x4b792a,_0x292ecd))_0x1c1ffc[_0x1c1ffc[_0x45b794(0xe8)]]=_0x292ecd;return _0x1c1ffc;},_0x26506d(_0xdd8b3e);};return function(_0x51f9d1){const _0x1e9a3f=a700_0xfc95;if(_0x51f9d1&&_0x51f9d1[_0x1e9a3f(0x156)])return _0x51f9d1;var _0x3c3b3e={};if(_0x51f9d1!=null){for(var _0x4bb5c5=_0x26506d(_0x51f9d1),_0x5b9e78=0x0;_0x5b9e78<_0x4bb5c5[_0x1e9a3f(0xe8)];_0x5b9e78++)if(_0x4bb5c5[_0x5b9e78]!=='default')__createBinding(_0x3c3b3e,_0x51f9d1,_0x4bb5c5[_0x5b9e78]);}return __setModuleDefault(_0x3c3b3e,_0x51f9d1),_0x3c3b3e;};}()),__importDefault=this&&this[a700_0x3b5d18(0x197)]||function(_0x1773f9){const _0x5a1e94=a700_0x3b5d18;return _0x1773f9&&_0x1773f9[_0x5a1e94(0x156)]?_0x1773f9:{'default':_0x1773f9};};Object[a700_0x3b5d18(0xd8)](exports,'__esModule',{'value':!![]}),exports[a700_0x3b5d18(0x14b)]=void 0x0;const Contact_1=__importDefault(require(a700_0x3b5d18(0x1b7))),SendMessage_1=require(a700_0x3b5d18(0x115)),Ticket_1=__importDefault(require(a700_0x3b5d18(0xd5))),SendWhatsAppMedia_1=__importDefault(require(a700_0x3b5d18(0x125))),SendWhatsAppMediaFlow_1=__importStar(require(a700_0x3b5d18(0x1a0))),randomizador_1=require(a700_0x3b5d18(0x154)),Mustache_1=__importDefault(require(a700_0x3b5d18(0x1cc))),SetTicketMessagesAsRead_1=__importDefault(require(a700_0x3b5d18(0x140))),SendWhatsAppMessage_1=__importDefault(require(a700_0x3b5d18(0x1d2))),ShowTicketService_1=__importDefault(require('../TicketServices/ShowTicketService')),randomCode_1=require(a700_0x3b5d18(0x144)),ShowQueueService_1=__importDefault(require('../QueueService/ShowQueueService')),socket_1=require(a700_0x3b5d18(0x13a)),UpdateTicketService_1=__importDefault(require(a700_0x3b5d18(0x143))),FindOrCreateATicketTrakingService_1=__importDefault(require(a700_0x3b5d18(0x1d7))),logger_1=require(a700_0x3b5d18(0x190)),CreateLogTicketService_1=__importDefault(require(a700_0x3b5d18(0xfd))),Setting_1=__importDefault(require(a700_0x3b5d18(0x1a2))),ShowWhatsAppService_1=__importDefault(require(a700_0x3b5d18(0xd7))),bluebird_1=require('bluebird'),typebotListener_1=__importDefault(require('../TypebotServices/typebotListener')),wbot_1=require('../../libs/wbot'),ExecuteHttpRequestService_1=__importDefault(require('../FlowBuilderService/ExecuteHttpRequestService')),axios_1=__importDefault(require(a700_0x3b5d18(0x180))),path_1=__importDefault(require(a700_0x3b5d18(0x14a))),fs_1=__importDefault(require('fs')),mime_types_1=__importDefault(require(a700_0x3b5d18(0x1b0))),StorageService_1=__importDefault(require(a700_0x3b5d18(0x160))),IMAGE_EXTENSIONS=['.jpg',a700_0x3b5d18(0x1cb),'.png',a700_0x3b5d18(0x1d8),a700_0x3b5d18(0x1aa),a700_0x3b5d18(0x12a),a700_0x3b5d18(0x158)],VIDEO_EXTENSIONS=[a700_0x3b5d18(0x1a7),a700_0x3b5d18(0x1cd),a700_0x3b5d18(0x103),a700_0x3b5d18(0x1d0),a700_0x3b5d18(0x138),a700_0x3b5d18(0x191)],AUDIO_EXTENSIONS=[a700_0x3b5d18(0x1d3),'.wav',a700_0x3b5d18(0x188),a700_0x3b5d18(0x18d),a700_0x3b5d18(0x16f),a700_0x3b5d18(0x177)],isMediaUrl=_0x360fd5=>{const _0x4efb59=a700_0x3b5d18;if(!_0x360fd5||typeof _0x360fd5!==_0x4efb59(0x121))return{'isMedia':![],'type':null,'url':null};const _0x4feb2d=_0x360fd5['trim'](),_0x7bb34a=_0x4feb2d[_0x4efb59(0xec)]('\x0a')[_0x4efb59(0xf2)](_0x17410e=>_0x17410e[_0x4efb59(0x110)]());if(_0x7bb34a[_0x4efb59(0xe8)]>0x1)return{'isMedia':![],'type':null,'url':null};const _0x330847=_0x7bb34a[0x0]?.[_0x4efb59(0x110)]()||_0x4feb2d;if(!_0x330847[_0x4efb59(0xd9)](_0x4efb59(0x135))&&!_0x330847['startsWith'](_0x4efb59(0x1bf)))return{'isMedia':![],'type':null,'url':null};if(_0x330847[_0x4efb59(0x165)]('\x20'))return{'isMedia':![],'type':null,'url':null};const _0x5ae1c9=_0x330847['split']('?')[0x0]['split']('#')[0x0][_0x4efb59(0x1bb)]();for(const _0x360490 of IMAGE_EXTENSIONS){if(_0x5ae1c9[_0x4efb59(0x111)](_0x360490))return{'isMedia':!![],'type':'image','url':_0x330847};}for(const _0x36a032 of VIDEO_EXTENSIONS){if(_0x5ae1c9['endsWith'](_0x36a032))return{'isMedia':!![],'type':_0x4efb59(0xf3),'url':_0x330847};}for(const _0x5880d8 of AUDIO_EXTENSIONS){if(_0x5ae1c9[_0x4efb59(0x111)](_0x5880d8))return{'isMedia':!![],'type':_0x4efb59(0x11e),'url':_0x330847};}return{'isMedia':![],'type':null,'url':null};},downloadAndSaveMedia=async(_0x58cd15,_0x2f7397,_0x1d79fb)=>{const _0x47c7fb=a700_0x3b5d18;try{logger_1['logger']['info'](_0x47c7fb(0x174)+_0x58cd15);const _0xfd4c3f=await(0x0,axios_1['default'])({'url':_0x58cd15,'method':'GET','responseType':_0x47c7fb(0x1bd),'timeout':0x7530,'headers':{'User-Agent':_0x47c7fb(0x162)}}),_0x2a1a7f=_0xfd4c3f[_0x47c7fb(0x170)][_0x47c7fb(0x100)]||'';let _0x57b56d=mime_types_1[_0x47c7fb(0x116)]['extension'](_0x2a1a7f);if(!_0x57b56d){const _0x1bad1b=_0x58cd15[_0x47c7fb(0xec)]('?')[0x0][_0x47c7fb(0xec)]('#')[0x0]['toLowerCase'](),_0x165bad=[...IMAGE_EXTENSIONS,...VIDEO_EXTENSIONS,...AUDIO_EXTENSIONS];for(const _0x3a920b of _0x165bad){if(_0x1bad1b[_0x47c7fb(0x111)](_0x3a920b)){_0x57b56d=_0x3a920b[_0x47c7fb(0x1b8)]('.','');break;}}}if(!_0x57b56d)switch(_0x1d79fb){case _0x47c7fb(0xd3):_0x57b56d=_0x47c7fb(0x10f);break;case'video':_0x57b56d=_0x47c7fb(0x19b);break;case _0x47c7fb(0x11e):_0x57b56d=_0x47c7fb(0x18a);break;}const _0x8b3a92='flowbuilder_'+Date[_0x47c7fb(0xfe)]()+'_'+Math[_0x47c7fb(0x1c7)]()[_0x47c7fb(0xe7)](0x24)[_0x47c7fb(0x1b1)](0x7)+'.'+_0x57b56d,{url:_0x5f7de0,storageType:_0x367ef0}=await StorageService_1[_0x47c7fb(0x116)][_0x47c7fb(0x1a9)](_0x2f7397,'flowBuilder',_0x8b3a92,Buffer[_0x47c7fb(0x164)](_0xfd4c3f[_0x47c7fb(0x167)]),_0x2a1a7f||_0x1d79fb+'/'+_0x57b56d);logger_1[_0x47c7fb(0x17c)][_0x47c7fb(0x13c)](_0x47c7fb(0x145)+_0x5f7de0+'\x20('+_0x367ef0+')');if(_0x367ef0===_0x47c7fb(0x1c2))return _0x5f7de0;else{const _0x273774=__dirname[_0x47c7fb(0x165)](_0x47c7fb(0x13f)),_0x172f72=_0x273774?path_1['default'][_0x47c7fb(0x1a1)](__dirname,'..','..','..',_0x47c7fb(0x102)):path_1['default'][_0x47c7fb(0x1a1)](__dirname,'..','..','..',_0x47c7fb(0x102));return path_1[_0x47c7fb(0x116)][_0x47c7fb(0x18c)](_0x172f72,_0x5f7de0);}}catch(_0x32d3db){return logger_1[_0x47c7fb(0x17c)][_0x47c7fb(0x16c)](_0x47c7fb(0x169)+_0x32d3db['message']),null;}},ActionsWebhookService=async(_0x3749a3,_0x1368ad,_0x4fc75a,_0x5e262f,_0x303f3d,_0x53533c,_0x577edc,_0x307658,_0x3c314c,_0x48c674,_0x25fb13,_0x8db522='',_0x18d229)=>{const _0x284dd5=a700_0x3b5d18;try{const _0x444be1=(0x0,socket_1[_0x284dd5(0x16e)])();let _0x254b26=_0x53533c;console['log'](_0x284dd5(0x131),_0x1368ad,_0x4fc75a,_0x5e262f,_0x303f3d,_0x53533c,_0x577edc,_0x307658,_0x3c314c,_0x48c674,_0x25fb13,_0x8db522);let _0x30a525='';const _0xcc3e40=_0x303f3d;if(_0x8db522===''){const _0x355420=_0x307658[_0x284dd5(0x186)][_0x284dd5(0x199)](_0x4d4368=>_0x4d4368[_0x284dd5(0xe1)]===_0x284dd5(0x1b5));_0x355420['data'][_0x284dd5(0xec)](',')[_0x284dd5(0x1da)](_0x4b1d58=>{const _0x209261=_0x284dd5,_0xe3a62a=_0x307658[_0x209261(0x1b2)][_0x209261(0x199)](_0x1011c6=>_0x1011c6===_0x4b1d58);let _0x1b1310='';!_0xe3a62a?_0x1b1310=_0x4b1d58:_0x1b1310=constructJsonLine(_0xe3a62a,_0x577edc),_0x30a525=_0x30a525+_0x1b1310;});}else _0x30a525=_0x8db522[_0x284dd5(0x139)];let _0x4153db='';if(_0x8db522===''){const _0x121c59=_0x307658[_0x284dd5(0x186)][_0x284dd5(0x199)](_0x30f369=>_0x30f369[_0x284dd5(0xe1)]===_0x284dd5(0x11c));_0x121c59[_0x284dd5(0x167)][_0x284dd5(0xec)](',')[_0x284dd5(0x1da)](_0x20e6a1=>{const _0x17d75e=_0x284dd5,_0x1a0d61=_0x307658[_0x17d75e(0x1b2)][_0x17d75e(0x199)](_0x4e2900=>_0x4e2900===_0x20e6a1);let _0x5ce8ff='';!_0x1a0d61?_0x5ce8ff=_0x20e6a1:_0x5ce8ff=constructJsonLine(_0x1a0d61,_0x577edc),_0x4153db=_0x4153db+_0x5ce8ff;});}else _0x4153db=_0x8db522[_0x284dd5(0x193)];_0x4153db=removerNaoLetrasNumeros(_0x4153db);_0x4153db['substring'](0x0,0x2)==='55'&&(parseInt(_0x4153db[_0x284dd5(0x1b1)](0x2,0x4))>=0x1f&&(_0x4153db['length']===0xd&&(_0x4153db=_0x4153db[_0x284dd5(0x1b1)](0x0,0x4)+_0x4153db[_0x284dd5(0x1b1)](0x5,0xd))));let _0xad86b6='';if(_0x8db522===''){const _0x5418a5=_0x307658[_0x284dd5(0x186)][_0x284dd5(0x199)](_0x125967=>_0x125967[_0x284dd5(0xe1)]==='email');_0x5418a5[_0x284dd5(0x167)][_0x284dd5(0xec)](',')[_0x284dd5(0x1da)](_0x1955b2=>{const _0x1ac74b=_0x284dd5,_0x3d1787=_0x307658[_0x1ac74b(0x1b2)][_0x1ac74b(0x199)](_0x5b826c=>_0x5b826c[_0x1ac74b(0x111)](_0x1ac74b(0x19f)));let _0x48a009='';!_0x3d1787?_0x48a009=_0x1955b2:_0x48a009=constructJsonLine(_0x3d1787,_0x577edc),_0xad86b6=_0xad86b6+_0x48a009;});}else _0xad86b6=_0x8db522[_0x284dd5(0x19f)];const _0x147a60=_0x5e262f[_0x284dd5(0xe8)],_0x19cd58=await(0x0,ShowWhatsAppService_1[_0x284dd5(0x116)])(_0x3749a3,_0x4fc75a);if(_0x19cd58[_0x284dd5(0x1a8)]!==_0x284dd5(0x101))return;let _0x35aa26=0x0,_0x2cdf1e='',_0x5686e2=null,_0x247799=![];_0x25fb13&&(_0x5686e2=await Ticket_1[_0x284dd5(0x116)]['findOne']({'where':{'id':_0x25fb13,'whatsappId':_0x3749a3,'companyId':_0x4fc75a},'include':[_0x284dd5(0xf8),_0x284dd5(0x192)]}));for(var _0x2e4126=0x0;_0x2e4126<_0x147a60;_0x2e4126++){let _0x4d261b=undefined,_0x1ca4ba;if(_0x48c674){console[_0x284dd5(0x12c)]('UPDATE2...');if(_0x48c674===_0x284dd5(0x152)){console[_0x284dd5(0x12c)](_0x284dd5(0xcf));_0x25fb13&&(console[_0x284dd5(0x12c)](_0x284dd5(0x161)),_0x1ca4ba=await Ticket_1[_0x284dd5(0x116)][_0x284dd5(0x11a)]({'where':{'id':_0x25fb13,'whatsappId':_0x3749a3}}),await _0x5686e2['update']({'status':_0x284dd5(0x1a5)}));break;}if(_0x2cdf1e===''){console[_0x284dd5(0x12c)](_0x284dd5(0x1ae));if(_0x5686e2&&_0x5686e2[_0x284dd5(0xda)]){const _0x589ebc=_0x5e262f[_0x284dd5(0x199)](_0x16f66a=>_0x16f66a['id']===_0x5686e2[_0x284dd5(0xda)]);_0x589ebc?(_0x4d261b=_0x589ebc,_0x2cdf1e=_0x589ebc['id'],console[_0x284dd5(0x12c)]('Retomando\x20do\x20último\x20nó:\x20'+_0x2cdf1e+'\x20(tipo:\x20'+_0x589ebc[_0x284dd5(0x17e)]+')')):_0x4d261b={'type':_0x284dd5(0xce)};}else _0x4d261b={'type':'menu'};}else console[_0x284dd5(0x12c)](_0x284dd5(0x118)),_0x4d261b=_0x5e262f['filter'](_0x4ba0b5=>_0x4ba0b5['id']===_0x2cdf1e)[0x0];}else{console[_0x284dd5(0x12c)](_0x284dd5(0x195));const _0x2d2e8a=_0x5e262f[_0x284dd5(0xf2)](_0x3cac42=>_0x3cac42['id']===_0x254b26)[0x0];_0x2d2e8a&&(_0x4d261b=_0x2d2e8a);}if(!_0x4d261b){console[_0x284dd5(0x12c)](_0x284dd5(0x13b));break;}if(_0x4d261b[_0x284dd5(0x17e)]===_0x284dd5(0x10e)){let _0x4c20de;const _0x5bcc5e=_0x5686e2['dataWebhook'];_0x5bcc5e&&_0x5bcc5e['hasOwnProperty']('variables')?_0x4c20de={'body':replaceMessages(_0x5bcc5e,_0x4d261b[_0x284dd5(0x167)]['label'])}:_0x4c20de={'body':_0x4d261b[_0x284dd5(0x167)][_0x284dd5(0x12e)]},await(0x0,SendMessage_1[_0x284dd5(0x183)])(_0x19cd58,{'number':_0x4153db,'body':_0x4c20de[_0x284dd5(0x1a4)]}),await intervalWhats('1');}console[_0x284dd5(0x12c)](_0x284dd5(0xed));if(_0x4d261b[_0x284dd5(0x17e)]===_0x284dd5(0x15b)){console['log'](_0x284dd5(0x1c9));const _0x59d36f=(0x0,wbot_1[_0x284dd5(0x159)])(_0x19cd58['id']);await(0x0,typebotListener_1['default'])({'wbot':_0x59d36f,'msg':_0x18d229,'ticket':_0x5686e2,'typebot':_0x4d261b[_0x284dd5(0x167)][_0x284dd5(0x1d6)]});}if(_0x4d261b[_0x284dd5(0x17e)]==='question'){const _0x290493=_0x5686e2?.['dataWebhook'],_0x650e00=_0x5686e2?.[_0x284dd5(0x1db)]?.[_0x284dd5(0x1d4)];if(!_0x650e00||_0x650e00===undefined||_0x650e00===null){const {message:_0x5ad0c3}=_0x4d261b[_0x284dd5(0x167)][_0x284dd5(0x1d6)],_0x1e6fe8=await(0x0,ShowTicketService_1[_0x284dd5(0x116)])(_0x5686e2['id'],_0x4fc75a),_0x5420b1=(0x0,Mustache_1[_0x284dd5(0x116)])(''+_0x5ad0c3,_0x5686e2);await(0x0,bluebird_1['delay'])(0xbb8),await(0x0,SendWhatsAppMediaFlow_1['typeSimulation'])(_0x5686e2,'composing'),await(0x0,SendWhatsAppMessage_1['default'])({'body':_0x5420b1,'ticket':_0x1e6fe8,'quotedMsg':null}),(0x0,SetTicketMessagesAsRead_1[_0x284dd5(0x116)])(_0x1e6fe8),await _0x1e6fe8['update']({'lastMessage':_0x5420b1}),await _0x5686e2['update']({'userId':null,'companyId':_0x4fc75a,'lastFlowId':_0x4d261b['id'],'hashFlowId':_0x3c314c,'flowStopped':_0x1368ad[_0x284dd5(0xe7)]()});}break;}if(_0x4d261b[_0x284dd5(0x17e)]==='ticket'){const _0x450339=_0x4d261b[_0x284dd5(0x167)]?.['data']?.['id']||_0x4d261b[_0x284dd5(0x167)]?.['id'],_0x17badb=await(0x0,ShowQueueService_1['default'])(_0x450339,_0x4fc75a);await _0x5686e2[_0x284dd5(0x1b9)]({'status':_0x284dd5(0xe6),'queueId':_0x17badb['id'],'userId':_0x5686e2[_0x284dd5(0xe9)],'companyId':_0x4fc75a,'flowWebhook':!![],'lastFlowId':_0x4d261b['id'],'hashFlowId':_0x3c314c,'flowStopped':_0x1368ad[_0x284dd5(0xe7)]()}),await(0x0,FindOrCreateATicketTrakingService_1[_0x284dd5(0x116)])({'ticketId':_0x5686e2['id'],'companyId':_0x4fc75a,'whatsappId':_0x5686e2[_0x284dd5(0x163)],'userId':_0x5686e2[_0x284dd5(0xe9)]}),await(0x0,UpdateTicketService_1[_0x284dd5(0x116)])({'ticketData':{'status':'pending','queueId':_0x17badb['id']},'ticketId':_0x5686e2['id'],'companyId':_0x4fc75a}),await(0x0,CreateLogTicketService_1[_0x284dd5(0x116)])({'ticketId':_0x5686e2['id'],'type':_0x284dd5(0x192),'queueId':_0x17badb['id']});const _0x30de0c=await Setting_1[_0x284dd5(0x116)]['findOne']({'where':{'companyId':_0x4fc75a,'key':'sendQueuePosition'}}),_0x8a98c7=_0x30de0c?.['value']===_0x284dd5(0xeb);if(_0x8a98c7){const _0x3d5130=await Ticket_1[_0x284dd5(0x116)]['findAndCountAll']({'where':{'userId':null,'status':_0x284dd5(0xe6),'companyId':_0x4fc75a,'queueId':_0x17badb['id'],'whatsappId':_0x19cd58['id'],'isGroup':![]}}),_0x5436fd=_0x3d5130[_0x284dd5(0x128)]===0x0?0x1:_0x3d5130[_0x284dd5(0x128)],_0x3daaba=await Setting_1[_0x284dd5(0x116)][_0x284dd5(0x11a)]({'where':{'companyId':_0x4fc75a,'key':_0x284dd5(0x109)}}),_0x5bedaa=(_0x3daaba?.['value']||_0x284dd5(0x1be))+'\x20*'+_0x5436fd+'*',_0x272b07=await(0x0,ShowTicketService_1[_0x284dd5(0x116)])(_0x5686e2['id'],_0x4fc75a),_0x217817=(0x0,Mustache_1[_0x284dd5(0x116)])(''+_0x5bedaa,_0x5686e2);await(0x0,bluebird_1[_0x284dd5(0x175)])(0xbb8),await(0x0,SendWhatsAppMediaFlow_1[_0x284dd5(0xf0)])(_0x5686e2,_0x284dd5(0x17b)),await(0x0,SendWhatsAppMessage_1[_0x284dd5(0x116)])({'body':_0x217817,'ticket':_0x272b07,'quotedMsg':null}),(0x0,SetTicketMessagesAsRead_1[_0x284dd5(0x116)])(_0x272b07),await _0x272b07[_0x284dd5(0x1b9)]({'lastMessage':_0x217817});}}if(_0x4d261b['type']===_0x284dd5(0x136)){logger_1['logger'][_0x284dd5(0x13c)]('[FlowBuilder]\x20Processando\x20nó\x20HTTP\x20Request:\x20'+_0x4d261b[_0x284dd5(0x167)]?.[_0x284dd5(0x126)]);const _0x36c94a=await Contact_1['default'][_0x284dd5(0x11a)]({'where':{'number':_0x4153db,'companyId':_0x4fc75a}}),_0x1fb2e0={'contact':{'name':_0x36c94a?.[_0x284dd5(0x139)]||_0x30a525,'number':_0x4153db,'email':_0x36c94a?.[_0x284dd5(0x19f)]||_0xad86b6},'ticket':{'id':_0x5686e2?.['id']},'queue':{'name':_0x5686e2?.[_0x284dd5(0x192)]?.[_0x284dd5(0x139)]||''},'user':{'name':_0x5686e2?.[_0x284dd5(0xf9)]?.[_0x284dd5(0x139)]||''},'company':{'name':_0x19cd58?.[_0x284dd5(0xdb)]?.[_0x284dd5(0x139)]||''},'datetime':new Date()[_0x284dd5(0x10d)](_0x284dd5(0x1a6)),'date':new Date()[_0x284dd5(0x1c8)]('pt-BR'),'time':new Date()[_0x284dd5(0x1c1)]('pt-BR')};_0x5686e2?.[_0x284dd5(0x1db)]&&_0x5686e2[_0x284dd5(0x1db)]?.[_0x284dd5(0x1d4)]&&Object[_0x284dd5(0x171)](_0x1fb2e0,_0x5686e2[_0x284dd5(0x1db)][_0x284dd5(0x1d4)]);try{const _0x11870c=await(0x0,ExecuteHttpRequestService_1[_0x284dd5(0x116)])(_0x4d261b[_0x284dd5(0x167)],_0x1fb2e0);logger_1['logger']['info'](_0x284dd5(0x10c)+JSON[_0x284dd5(0x1bc)](_0x11870c));const _0x1eb6bd={},_0xf0d3e7=_0x4d261b[_0x284dd5(0x167)]?.[_0x284dd5(0x189)]||[];if(_0x11870c[_0x284dd5(0xee)]&&_0x11870c[_0x284dd5(0x167)]&&_0xf0d3e7[_0x284dd5(0xe8)]>0x0)for(const _0x4402ba of _0xf0d3e7){const {jsonPath:_0x518623,variableName:_0x2c83de}=_0x4402ba;if(_0x518623&&_0x2c83de){let _0x528557=_0x11870c[_0x284dd5(0x167)];const _0x29e48f=_0x518623[_0x284dd5(0xec)](/\.|\[/)[_0x284dd5(0x1da)](_0x386fd3=>_0x386fd3[_0x284dd5(0x1b8)](']',''));for(const _0x1e843a of _0x29e48f){if(_0x1e843a==='')continue;const _0x35a2ee=parseInt(_0x1e843a);if(!isNaN(_0x35a2ee)&&Array['isArray'](_0x528557))_0x528557=_0x528557[_0x35a2ee];else{if(_0x528557&&typeof _0x528557===_0x284dd5(0x17d)&&_0x1e843a in _0x528557)_0x528557=_0x528557[_0x1e843a];else{_0x528557=undefined;break;}}}_0x528557!==undefined&&(typeof _0x528557===_0x284dd5(0x17d)?_0x1eb6bd[_0x2c83de]=JSON[_0x284dd5(0x1bc)](_0x528557):_0x1eb6bd[_0x2c83de]=_0x528557,logger_1[_0x284dd5(0x17c)][_0x284dd5(0x13c)](_0x284dd5(0x157)+_0x2c83de+_0x284dd5(0x12b)+JSON['stringify'](_0x1eb6bd[_0x2c83de])));}}const _0xd124b6=_0x5686e2?.[_0x284dd5(0x1db)]?.[_0x284dd5(0x1d4)]||{},_0x3b20b9={..._0x5686e2?.[_0x284dd5(0x1db)]||{},'variables':{..._0xd124b6,..._0x1eb6bd,[(_0x4d261b['data']?.[_0x284dd5(0x126)]||_0x284dd5(0xdf))+_0x284dd5(0x172)]:_0x11870c[_0x284dd5(0x167)],[(_0x4d261b[_0x284dd5(0x167)]?.['requestName']||_0x284dd5(0xdf))+_0x284dd5(0x14c)]:_0x11870c[_0x284dd5(0xee)],[(_0x4d261b[_0x284dd5(0x167)]?.['requestName']||'http')+_0x284dd5(0x1c6)]:_0x11870c[_0x284dd5(0x166)]}};await _0x5686e2?.[_0x284dd5(0x1b9)]({'dataWebhook':_0x3b20b9,'lastFlowId':_0x4d261b['id'],'hashFlowId':_0x3c314c,'flowStopped':_0x1368ad[_0x284dd5(0xe7)]()});const _0x295088=_0xcc3e40[_0x284dd5(0xf2)](_0xc10cff=>_0xc10cff['source']===_0x4d261b['id']);if(_0x11870c[_0x284dd5(0xee)]){const _0x22d7c9=_0x295088['find'](_0x381df3=>_0x381df3['sourceHandle']===_0x284dd5(0xee)||!_0x381df3[_0x284dd5(0x137)]);_0x22d7c9&&(_0x254b26=_0x22d7c9[_0x284dd5(0x153)],_0x247799=!![]);}else{const _0x2a9957=_0x295088[_0x284dd5(0x199)](_0x16fd98=>_0x16fd98[_0x284dd5(0x137)]===_0x284dd5(0x16c));if(_0x2a9957)_0x254b26=_0x2a9957[_0x284dd5(0x153)],_0x247799=!![];else{const _0x2c46c8=_0x295088['find'](_0x522a02=>_0x522a02[_0x284dd5(0x137)]===_0x284dd5(0xee)||!_0x522a02['sourceHandle']);_0x2c46c8&&(_0x254b26=_0x2c46c8[_0x284dd5(0x153)],_0x247799=!![]);}}logger_1['logger']['info']('[FlowBuilder]\x20HTTP\x20Request\x20concluído.\x20Próximo\x20nó:\x20'+_0x254b26);}catch(_0x1b7a62){logger_1[_0x284dd5(0x17c)][_0x284dd5(0x16c)](_0x284dd5(0xd4)+_0x1b7a62[_0x284dd5(0x10e)]);const _0x3fdf61=_0xcc3e40['find'](_0xb1427d=>_0xb1427d[_0x284dd5(0x17f)]===_0x4d261b['id']&&_0xb1427d[_0x284dd5(0x137)]===_0x284dd5(0x16c));_0x3fdf61&&(_0x254b26=_0x3fdf61[_0x284dd5(0x153)],_0x247799=!![]);}}if(_0x4d261b[_0x284dd5(0x17e)]==='capture'){logger_1[_0x284dd5(0x17c)][_0x284dd5(0x13c)](_0x284dd5(0x11b)+_0x4d261b[_0x284dd5(0x167)]?.['variableName']);const {message:_0x107de3,variableName:_0x1439dd,validation:_0x3608ae,errorMessage:_0x1e3724,timeout:_0xe4870c,timeoutAction:_0x6069d8,options:_0xb0414b}=_0x4d261b[_0x284dd5(0x167)]||{};if(_0x48c674&&_0x48c674!==_0x284dd5(0x152)){let _0x439f08=!![],_0x2442a1='';switch(_0x3608ae){case _0x284dd5(0xff):_0x439f08=/^[a-zA-ZÀ-ÿ\s]+$/[_0x284dd5(0xde)](_0x48c674),_0x2442a1=_0x284dd5(0x1c0);break;case _0x284dd5(0x193):_0x439f08=/^\d+$/['test'](_0x48c674),_0x2442a1='Apenas\x20números\x20são\x20permitidos.';break;case _0x284dd5(0x19f):_0x439f08=/^[^\s@]+@[^\s@]+\.[^\s@]+$/[_0x284dd5(0xde)](_0x48c674),_0x2442a1=_0x284dd5(0xf5);break;case _0x284dd5(0x11d):_0x439f08=/^\d{11}$/['test'](_0x48c674[_0x284dd5(0x1b8)](/\D/g,'')),_0x2442a1=_0x284dd5(0x108);break;case _0x284dd5(0x132):_0x439f08=/^\d{10,15}$/[_0x284dd5(0xde)](_0x48c674['replace'](/\D/g,'')),_0x2442a1=_0x284dd5(0xd0);break;case _0x284dd5(0x14f):_0x439f08=/^\d{2}\/\d{2}\/\d{4}$/[_0x284dd5(0xde)](_0x48c674),_0x2442a1='Data\x20inválida\x20(use\x20DD/MM/AAAA).';break;case _0x284dd5(0x1b6):const _0x117fc4=(_0xb0414b||'')[_0x284dd5(0xec)](',')[_0x284dd5(0x1da)](_0xb0676=>_0xb0676[_0x284dd5(0x110)]()[_0x284dd5(0x1bb)]());_0x439f08=_0x117fc4[_0x284dd5(0x165)](_0x48c674[_0x284dd5(0x1bb)]()['trim']()),_0x2442a1=_0x284dd5(0x1c5)+_0x117fc4[_0x284dd5(0x18c)](',\x20');break;default:_0x439f08=!![];}if(!_0x439f08){const _0x4549a1=await(0x0,ShowTicketService_1[_0x284dd5(0x116)])(_0x5686e2['id'],_0x4fc75a),_0x380a0f=_0x1e3724||_0x2442a1;await(0x0,bluebird_1[_0x284dd5(0x175)])(0x3e8),await(0x0,SendWhatsAppMediaFlow_1[_0x284dd5(0xf0)])(_0x5686e2,_0x284dd5(0x17b)),await(0x0,SendWhatsAppMessage_1[_0x284dd5(0x116)])({'body':_0x380a0f,'ticket':_0x4549a1,'quotedMsg':null}),await _0x5686e2[_0x284dd5(0x1b9)]({'lastFlowId':_0x4d261b['id'],'hashFlowId':_0x3c314c,'flowStopped':_0x1368ad[_0x284dd5(0xe7)]()});break;}const _0x409f81=_0x5686e2?.[_0x284dd5(0x1db)]?.['variables']||{},_0x1a8bb0={..._0x5686e2?.[_0x284dd5(0x1db)]||{},'variables':{..._0x409f81,[_0x1439dd]:_0x48c674}};await _0x5686e2[_0x284dd5(0x1b9)]({'dataWebhook':_0x1a8bb0,'lastFlowId':_0x4d261b['id'],'hashFlowId':_0x3c314c,'flowStopped':_0x1368ad[_0x284dd5(0xe7)]()}),logger_1['logger']['info'](_0x284dd5(0x19d)+_0x1439dd+'\x20=\x20\x22'+_0x48c674+_0x284dd5(0x1c4));const _0x45492e=_0xcc3e40[_0x284dd5(0x199)](_0x2406de=>_0x2406de['source']===_0x4d261b['id']&&(_0x2406de[_0x284dd5(0x137)]===_0x284dd5(0x155)||!_0x2406de[_0x284dd5(0x137)]));if(_0x45492e)_0x254b26=_0x45492e[_0x284dd5(0x153)],_0x247799=!![],await _0x5686e2[_0x284dd5(0x1b9)]({'lastFlowId':_0x254b26,'hashFlowId':_0x3c314c,'flowStopped':_0x1368ad[_0x284dd5(0xe7)]()}),_0x48c674=undefined;else{logger_1[_0x284dd5(0x17c)][_0x284dd5(0x13c)](_0x284dd5(0xd1));break;}}else{const _0x52cd4e=await(0x0,ShowTicketService_1[_0x284dd5(0x116)])(_0x5686e2['id'],_0x4fc75a);let _0x1b2fdb=_0x107de3;const _0x59c6fa=_0x5686e2?.[_0x284dd5(0x1db)]?.[_0x284dd5(0x1d4)];_0x59c6fa&&(_0x1b2fdb=replaceMessages(_0x59c6fa,_0x107de3));await(0x0,bluebird_1[_0x284dd5(0x175)])(0x3e8),await(0x0,SendWhatsAppMediaFlow_1[_0x284dd5(0xf0)])(_0x5686e2,_0x284dd5(0x17b)),await(0x0,SendWhatsAppMessage_1[_0x284dd5(0x116)])({'body':_0x1b2fdb,'ticket':_0x52cd4e,'quotedMsg':null}),(0x0,SetTicketMessagesAsRead_1[_0x284dd5(0x116)])(_0x52cd4e),await _0x52cd4e['update']({'lastMessage':_0x1b2fdb}),await _0x5686e2[_0x284dd5(0x1b9)]({'userId':null,'companyId':_0x4fc75a,'lastFlowId':_0x4d261b['id'],'hashFlowId':_0x3c314c,'flowStopped':_0x1368ad[_0x284dd5(0xe7)]()}),logger_1[_0x284dd5(0x17c)]['info'](_0x284dd5(0x15c)+_0x1439dd);break;}}if(_0x4d261b[_0x284dd5(0x17e)]===_0x284dd5(0x173))for(var _0x266bd9=0x0;_0x266bd9<_0x4d261b[_0x284dd5(0x167)][_0x284dd5(0x134)][_0x284dd5(0xe8)];_0x266bd9++){const _0x1f959b=_0x4d261b[_0x284dd5(0x167)][_0x284dd5(0x134)][_0x266bd9];_0x5686e2=await Ticket_1[_0x284dd5(0x116)][_0x284dd5(0x11a)]({'where':{'id':_0x25fb13,'companyId':_0x4fc75a}});if(_0x1f959b[_0x284dd5(0x165)](_0x284dd5(0x10e))){const _0x3ae42a=_0x4d261b['data'][_0x284dd5(0x1a3)]['filter'](_0x1de998=>_0x1de998[_0x284dd5(0x193)]===_0x1f959b)[0x0][_0x284dd5(0xfc)],_0x35177c=await(0x0,ShowTicketService_1['default'])(_0x25fb13,_0x4fc75a);let _0x751906;const _0x473796=_0x5686e2[_0x284dd5(0x1db)];_0x473796&&_0x473796[_0x284dd5(0x1b4)](_0x284dd5(0x1d4))?_0x751906=replaceMessages(_0x473796[_0x284dd5(0x1d4)],_0x3ae42a):_0x751906=_0x3ae42a;await(0x0,bluebird_1[_0x284dd5(0x175)])(0xbb8),await(0x0,SendWhatsAppMediaFlow_1[_0x284dd5(0xf0)])(_0x5686e2,_0x284dd5(0x17b)),logger_1[_0x284dd5(0x17c)][_0x284dd5(0x13c)]('[FlowBuilder]\x20Verificando\x20mídia\x20para\x20mensagem:\x20\x22'+_0x751906+'\x22');const _0x2b3c63=isMediaUrl(_0x751906);logger_1[_0x284dd5(0x17c)]['info']('[FlowBuilder]\x20Resultado\x20verificação\x20mídia:\x20isMedia='+_0x2b3c63[_0x284dd5(0x146)]+_0x284dd5(0xef)+_0x2b3c63[_0x284dd5(0x17e)]+_0x284dd5(0x141)+_0x2b3c63[_0x284dd5(0xd2)]);if(_0x2b3c63[_0x284dd5(0x146)]&&_0x2b3c63[_0x284dd5(0xd2)]){const _0x503225=await Ticket_1[_0x284dd5(0x116)][_0x284dd5(0x11a)]({'where':{'id':_0x5686e2['id']},'include':[Contact_1['default']]});_0x503225&&(logger_1[_0x284dd5(0x17c)][_0x284dd5(0x13c)](_0x284dd5(0xf4)+_0x2b3c63['type']+':\x20'+_0x2b3c63[_0x284dd5(0xd2)]),_0x2b3c63[_0x284dd5(0x17e)]==='audio'?await(0x0,SendWhatsAppMediaFlow_1[_0x284dd5(0x116)])({'media':_0x2b3c63[_0x284dd5(0xd2)],'ticket':_0x503225,'isRecord':![]}):await(0x0,SendWhatsAppMedia_1[_0x284dd5(0x116)])({'media':_0x2b3c63[_0x284dd5(0xd2)],'ticket':_0x503225}));}else await(0x0,SendWhatsAppMessage_1[_0x284dd5(0x116)])({'body':_0x751906,'ticket':_0x35177c,'quotedMsg':null});(0x0,SetTicketMessagesAsRead_1[_0x284dd5(0x116)])(_0x35177c),await _0x35177c[_0x284dd5(0x1b9)]({'lastMessage':(0x0,Mustache_1['default'])(_0x3ae42a,_0x5686e2)}),await intervalWhats('1');}_0x1f959b[_0x284dd5(0x165)]('interval')&&await intervalWhats(_0x4d261b[_0x284dd5(0x167)]['elements'][_0x284dd5(0xf2)](_0x6e6a7d=>_0x6e6a7d[_0x284dd5(0x193)]===_0x1f959b)[0x0]['value']);if(_0x1f959b['includes'](_0x284dd5(0x1ac))){await(0x0,SendWhatsAppMediaFlow_1[_0x284dd5(0xf0)])(_0x5686e2,'composing');const _0x55e385=_0x4d261b['data'][_0x284dd5(0x1a3)]['find'](_0x4c5e7a=>_0x4c5e7a['number']===_0x1f959b);if(!_0x55e385||!_0x55e385['value']){console[_0x284dd5(0x16c)](_0x284dd5(0x133)+_0x1f959b);return;}let _0x2087d7=_0x55e385[_0x284dd5(0xfc)];logger_1[_0x284dd5(0x17c)][_0x284dd5(0x13c)](_0x284dd5(0x10a)+_0x2087d7+',\x20isVariable:\x20'+_0x55e385[_0x284dd5(0xe5)]);if(_0x55e385[_0x284dd5(0xe5)]||_0x2087d7[_0x284dd5(0x165)]('{{')&&_0x2087d7[_0x284dd5(0x165)]('}}')){const _0x4e1614=await Ticket_1[_0x284dd5(0x116)][_0x284dd5(0x11a)]({'where':{'id':_0x5686e2['id']}}),_0x2791d6=_0x4e1614?.[_0x284dd5(0x1db)]||_0x5686e2[_0x284dd5(0x1db)];logger_1[_0x284dd5(0x17c)][_0x284dd5(0x13c)](_0x284dd5(0x19c)+JSON[_0x284dd5(0x1bc)](_0x2791d6?.['variables']||{}));if(_0x2791d6&&_0x2791d6[_0x284dd5(0x1d4)]){const _0x24b21e=_0x2087d7;_0x2087d7=replaceMessages(_0x2791d6[_0x284dd5(0x1d4)],_0x2087d7),logger_1[_0x284dd5(0x17c)][_0x284dd5(0x13c)](_0x284dd5(0x106)+_0x24b21e+_0x284dd5(0xfb)+_0x2087d7);if(_0x2087d7[_0x284dd5(0x165)]('{{')){logger_1[_0x284dd5(0x17c)][_0x284dd5(0x16c)]('[FlowBuilder]\x20Variável\x20não\x20encontrada\x20na\x20imagem:\x20'+_0x2087d7);return;}}else{logger_1[_0x284dd5(0x17c)]['error'](_0x284dd5(0x10b));return;}}if(_0x2087d7['startsWith'](_0x284dd5(0x135))||_0x2087d7[_0x284dd5(0xd9)](_0x284dd5(0x1bf))){const _0x3e5763=process['env'][_0x284dd5(0x19e)]||'',_0x2710e7=!_0x2087d7[_0x284dd5(0x165)](_0x3e5763)&&!_0x2087d7['includes']('localhost')&&!_0x2087d7[_0x284dd5(0x165)](_0x284dd5(0x1d9));if(_0x2710e7){logger_1[_0x284dd5(0x17c)][_0x284dd5(0x13c)]('[FlowBuilder]\x20URL\x20externa\x20detectada,\x20baixando\x20imagem:\x20'+_0x2087d7);const _0x467915=await downloadAndSaveMedia(_0x2087d7,_0x4fc75a,_0x284dd5(0xd3));if(_0x467915)_0x2087d7=_0x467915,logger_1[_0x284dd5(0x17c)]['info'](_0x284dd5(0x14e)+_0x2087d7);else{logger_1[_0x284dd5(0x17c)][_0x284dd5(0x16c)](_0x284dd5(0xfa)+_0x2087d7);return;}}}else{const _0x1ce872=__dirname[_0x284dd5(0x165)](_0x284dd5(0x13f)),_0x4cd630=_0x1ce872?path_1[_0x284dd5(0x116)][_0x284dd5(0x1a1)](__dirname,'..','..','..',_0x284dd5(0x102)):path_1[_0x284dd5(0x116)]['resolve'](__dirname,'..','..','..',_0x284dd5(0x102));_0x2087d7=path_1[_0x284dd5(0x116)][_0x284dd5(0x18c)](_0x4cd630,_0x2087d7);if(!fs_1['default']['existsSync'](_0x2087d7)){console[_0x284dd5(0x16c)](_0x284dd5(0x14d)+_0x2087d7);return;}}const _0x3a7c60=await Ticket_1[_0x284dd5(0x116)]['findOne']({'where':{'id':_0x5686e2['id']},'include':[Contact_1[_0x284dd5(0x116)]]});if(!_0x3a7c60){console[_0x284dd5(0x16c)](_0x284dd5(0x17a)+_0x5686e2['id']+'\x20não\x20encontrado');return;}logger_1[_0x284dd5(0x17c)][_0x284dd5(0x13c)](_0x284dd5(0x113)+_0x2087d7),await(0x0,SendWhatsAppMedia_1[_0x284dd5(0x116)])({'media':_0x2087d7,'ticket':_0x3a7c60}),await intervalWhats('1');}if(_0x1f959b['includes'](_0x284dd5(0x11e))){const _0x139b95=_0x4d261b[_0x284dd5(0x167)][_0x284dd5(0x1a3)]['find'](_0x38d225=>_0x38d225['number']===_0x1f959b);if(!_0x139b95||!_0x139b95['value']){console[_0x284dd5(0x16c)](_0x284dd5(0x16b)+_0x1f959b);return;}let _0x14d9d9=_0x139b95[_0x284dd5(0xfc)];logger_1[_0x284dd5(0x17c)][_0x284dd5(0x13c)](_0x284dd5(0x11f)+_0x14d9d9+_0x284dd5(0x142)+_0x139b95[_0x284dd5(0xe5)]);if(_0x139b95['isVariable']||_0x14d9d9[_0x284dd5(0x165)]('{{')&&_0x14d9d9[_0x284dd5(0x165)]('}}')){const _0x40f403=await Ticket_1[_0x284dd5(0x116)][_0x284dd5(0x11a)]({'where':{'id':_0x5686e2['id']}}),_0x1e59f4=_0x40f403?.[_0x284dd5(0x1db)]||_0x5686e2[_0x284dd5(0x1db)];logger_1[_0x284dd5(0x17c)][_0x284dd5(0x13c)](_0x284dd5(0x19c)+JSON[_0x284dd5(0x1bc)](_0x1e59f4?.[_0x284dd5(0x1d4)]||{}));if(_0x1e59f4&&_0x1e59f4[_0x284dd5(0x1d4)]){const _0x15b597=_0x14d9d9;_0x14d9d9=replaceMessages(_0x1e59f4[_0x284dd5(0x1d4)],_0x14d9d9),logger_1['logger'][_0x284dd5(0x13c)](_0x284dd5(0x1d5)+_0x15b597+_0x284dd5(0xfb)+_0x14d9d9);if(_0x14d9d9[_0x284dd5(0x165)]('{{')){logger_1[_0x284dd5(0x17c)]['error'](_0x284dd5(0x1c3)+_0x14d9d9);return;}}else{logger_1['logger'][_0x284dd5(0x16c)](_0x284dd5(0x12f));return;}}if(_0x14d9d9[_0x284dd5(0xd9)]('http://')||_0x14d9d9[_0x284dd5(0xd9)](_0x284dd5(0x1bf))){const _0x4c3a4d=process[_0x284dd5(0x19a)][_0x284dd5(0x19e)]||'',_0x2db952=!_0x14d9d9['includes'](_0x4c3a4d)&&!_0x14d9d9[_0x284dd5(0x165)](_0x284dd5(0x182))&&!_0x14d9d9[_0x284dd5(0x165)](_0x284dd5(0x1d9));if(_0x2db952){logger_1['logger']['info']('[FlowBuilder]\x20URL\x20externa\x20detectada,\x20baixando\x20áudio:\x20'+_0x14d9d9);const _0x3e8887=await downloadAndSaveMedia(_0x14d9d9,_0x4fc75a,_0x284dd5(0x11e));if(_0x3e8887)_0x14d9d9=_0x3e8887,logger_1['logger'][_0x284dd5(0x13c)](_0x284dd5(0x129)+_0x14d9d9);else{logger_1[_0x284dd5(0x17c)][_0x284dd5(0x16c)](_0x284dd5(0x1ca)+_0x14d9d9);return;}}}else{const _0x489163=__dirname[_0x284dd5(0x165)]('dist'),_0x587625=_0x489163?path_1[_0x284dd5(0x116)]['resolve'](__dirname,'..','..','..',_0x284dd5(0x102)):path_1[_0x284dd5(0x116)][_0x284dd5(0x1a1)](__dirname,'..','..','..','public');_0x14d9d9=path_1['default'][_0x284dd5(0x18c)](_0x587625,_0x14d9d9);if(!fs_1[_0x284dd5(0x116)][_0x284dd5(0xe4)](_0x14d9d9)){console[_0x284dd5(0x16c)](_0x284dd5(0x1ad)+_0x14d9d9);return;}}const _0x465a01=await Ticket_1[_0x284dd5(0x116)][_0x284dd5(0x11a)]({'where':{'id':_0x5686e2['id']},'include':[Contact_1[_0x284dd5(0x116)]]});if(!_0x465a01){console['error'](_0x284dd5(0x17a)+_0x5686e2['id']+'\x20não\x20encontrado');return;}await(0x0,SendWhatsAppMediaFlow_1['typeSimulation'])(_0x5686e2,_0x284dd5(0x185)),logger_1['logger'][_0x284dd5(0x13c)](_0x284dd5(0x107)+_0x14d9d9),await(0x0,SendWhatsAppMediaFlow_1[_0x284dd5(0x116)])({'media':_0x14d9d9,'ticket':_0x465a01,'isRecord':_0x139b95[_0x284dd5(0x15a)]||![]}),await intervalWhats('1');}if(_0x1f959b[_0x284dd5(0x165)](_0x284dd5(0xf3))){const _0x190cff=_0x4d261b[_0x284dd5(0x167)][_0x284dd5(0x1a3)][_0x284dd5(0x199)](_0x478544=>_0x478544['number']===_0x1f959b);if(!_0x190cff||!_0x190cff['value']){console[_0x284dd5(0x16c)](_0x284dd5(0xe3)+_0x1f959b);return;}let _0x3bbcc6=_0x190cff['value'];logger_1['logger'][_0x284dd5(0x13c)](_0x284dd5(0x196)+_0x3bbcc6+_0x284dd5(0x142)+_0x190cff['isVariable']);if(_0x190cff['isVariable']||_0x3bbcc6[_0x284dd5(0x165)]('{{')&&_0x3bbcc6[_0x284dd5(0x165)]('}}')){const _0x16048b=await Ticket_1['default'][_0x284dd5(0x11a)]({'where':{'id':_0x5686e2['id']}}),_0x26256b=_0x16048b?.[_0x284dd5(0x1db)]||_0x5686e2[_0x284dd5(0x1db)];logger_1[_0x284dd5(0x17c)][_0x284dd5(0x13c)](_0x284dd5(0x19c)+JSON['stringify'](_0x26256b?.['variables']||{}));if(_0x26256b&&_0x26256b[_0x284dd5(0x1d4)]){const _0x592957=_0x3bbcc6;_0x3bbcc6=replaceMessages(_0x26256b[_0x284dd5(0x1d4)],_0x3bbcc6),logger_1[_0x284dd5(0x17c)][_0x284dd5(0x13c)](_0x284dd5(0xd6)+_0x592957+_0x284dd5(0xfb)+_0x3bbcc6);if(_0x3bbcc6[_0x284dd5(0x165)]('{{')){logger_1['logger'][_0x284dd5(0x16c)](_0x284dd5(0x12d)+_0x3bbcc6);return;}}else{logger_1[_0x284dd5(0x17c)][_0x284dd5(0x16c)](_0x284dd5(0xf1));return;}}if(_0x3bbcc6['startsWith'](_0x284dd5(0x135))||_0x3bbcc6[_0x284dd5(0xd9)](_0x284dd5(0x1bf))){const _0x2e994b=process[_0x284dd5(0x19a)][_0x284dd5(0x19e)]||'',_0x4bb1ca=!_0x3bbcc6[_0x284dd5(0x165)](_0x2e994b)&&!_0x3bbcc6[_0x284dd5(0x165)](_0x284dd5(0x182))&&!_0x3bbcc6['includes'](_0x284dd5(0x1d9));if(_0x4bb1ca){logger_1[_0x284dd5(0x17c)][_0x284dd5(0x13c)]('[FlowBuilder]\x20URL\x20externa\x20detectada,\x20baixando\x20vídeo:\x20'+_0x3bbcc6);const _0x14b187=await downloadAndSaveMedia(_0x3bbcc6,_0x4fc75a,'video');if(_0x14b187)_0x3bbcc6=_0x14b187,logger_1['logger']['info']('[FlowBuilder]\x20Vídeo\x20baixado\x20e\x20salvo:\x20'+_0x3bbcc6);else{logger_1[_0x284dd5(0x17c)][_0x284dd5(0x16c)](_0x284dd5(0x124)+_0x3bbcc6);return;}}}else{const _0x25255e=__dirname[_0x284dd5(0x165)]('dist'),_0x5f0725=_0x25255e?path_1['default'][_0x284dd5(0x1a1)](__dirname,'..','..','..',_0x284dd5(0x102)):path_1[_0x284dd5(0x116)][_0x284dd5(0x1a1)](__dirname,'..','..','..',_0x284dd5(0x102));_0x3bbcc6=path_1[_0x284dd5(0x116)][_0x284dd5(0x18c)](_0x5f0725,_0x3bbcc6);if(!fs_1[_0x284dd5(0x116)]['existsSync'](_0x3bbcc6)){console[_0x284dd5(0x16c)](_0x284dd5(0x1b3)+_0x3bbcc6);return;}}const _0x54bf1e=await Ticket_1['default'][_0x284dd5(0x11a)]({'where':{'id':_0x5686e2['id']},'include':[Contact_1[_0x284dd5(0x116)]]});if(!_0x54bf1e){console[_0x284dd5(0x16c)](_0x284dd5(0x17a)+_0x5686e2['id']+_0x284dd5(0x149));return;}await(0x0,SendWhatsAppMediaFlow_1[_0x284dd5(0xf0)])(_0x5686e2,_0x284dd5(0x17b)),logger_1[_0x284dd5(0x17c)][_0x284dd5(0x13c)](_0x284dd5(0x147)+_0x3bbcc6),await(0x0,SendWhatsAppMediaFlow_1[_0x284dd5(0x116)])({'media':_0x3bbcc6,'ticket':_0x54bf1e}),await intervalWhats('1');}}let _0x4e5d66;if(_0x4d261b[_0x284dd5(0x17e)]===_0x284dd5(0x181)){const _0x3e4070=(0x0,randomizador_1[_0x284dd5(0x1ce)])(_0x4d261b[_0x284dd5(0x167)][_0x284dd5(0x16d)]/0x64),_0x2b6eb5=_0x303f3d['filter'](_0x3127b7=>_0x3127b7[_0x284dd5(0x17f)]===_0x4d261b['id']);_0x3e4070==='A'?(_0x254b26=_0x2b6eb5[_0x284dd5(0xf2)](_0x19d45e=>_0x19d45e[_0x284dd5(0x137)]==='a')[0x0][_0x284dd5(0x153)],_0x247799=!![]):(_0x254b26=_0x2b6eb5['filter'](_0x26836c=>_0x26836c['sourceHandle']==='b')[0x0][_0x284dd5(0x153)],_0x247799=!![]),_0x4e5d66=!![];}let _0x5cbc4a;if(_0x4d261b['type']===_0x284dd5(0xce)){console[_0x284dd5(0x12c)](0x28a,'menu');if(_0x48c674){const _0x3630d9=_0x4d261b['id'];console[_0x284dd5(0x12c)](_0x284dd5(0x15e)+_0x48c674+_0x284dd5(0xdc)+_0x3630d9);const _0x2067ce=_0xcc3e40['filter'](_0x20c9fe=>_0x20c9fe['source']===_0x3630d9),_0x4ad571=_0x2067ce[_0x284dd5(0xf2)](_0x82f6a5=>_0x82f6a5[_0x284dd5(0x137)]==='a'+_0x48c674);console[_0x284dd5(0x12c)](_0x284dd5(0x13d)+_0x2067ce[_0x284dd5(0xe8)]+_0x284dd5(0xe2)+_0x48c674+':\x20'+_0x4ad571['length']);_0x4ad571[_0x284dd5(0xe8)]>0x0?(_0x2cdf1e=_0x4ad571[0x0][_0x284dd5(0x153)],console[_0x284dd5(0x12c)]('Opção\x20válida!\x20Próximo\x20nó:\x20'+_0x2cdf1e)):_0x2cdf1e=undefined;if(_0x2cdf1e===undefined){console[_0x284dd5(0x12c)]('Opção\x20inválida\x20digitada\x20no\x20menu:\x20'+_0x48c674);if(_0x5686e2){const _0x582707=_0x4d261b;if(_0x582707&&_0x582707[_0x284dd5(0x17e)]===_0x284dd5(0xce)){let _0x1a3ca3='';_0x582707['data']['arrayOption'][_0x284dd5(0x1da)](_0x177f9f=>{const _0x5b8e08=_0x284dd5;_0x1a3ca3+=_0x177f9f[_0x5b8e08(0x193)]+_0x5b8e08(0x1af)+_0x177f9f[_0x5b8e08(0xfc)]+'\x0a';});const _0x4b3136=_0x284dd5(0x15f)+_0x582707[_0x284dd5(0x167)][_0x284dd5(0x10e)]+'\x0a\x0a'+_0x1a3ca3,_0x3631ff=await(0x0,ShowTicketService_1[_0x284dd5(0x116)])(_0x5686e2['id'],_0x4fc75a);await(0x0,SendWhatsAppMessage_1[_0x284dd5(0x116)])({'body':_0x4b3136,'ticket':_0x3631ff,'quotedMsg':null}),(0x0,SetTicketMessagesAsRead_1['default'])(_0x3631ff),await _0x3631ff[_0x284dd5(0x1b9)]({'lastMessage':_0x4b3136});}}break;}_0x48c674=_0x284dd5(0x198);const _0x40a6cf=_0x5e262f['filter'](_0xf81380=>_0xf81380['id']===_0x2cdf1e);console['log'](0x2a2,_0x284dd5(0xce)),_0x40a6cf[_0x284dd5(0xe8)]>0x0?_0x5cbc4a=_0x40a6cf[0x0][_0x284dd5(0x17e)]===_0x284dd5(0xce)?!![]:![]:_0x5cbc4a=![];}else{console['log'](0x2a9,_0x284dd5(0xce));let _0x528097='';_0x4d261b[_0x284dd5(0x167)][_0x284dd5(0x1ab)]['map'](_0x15d0c9=>{const _0x36a491=_0x284dd5;_0x528097+=_0x15d0c9[_0x36a491(0x193)]+_0x36a491(0x1af)+_0x15d0c9[_0x36a491(0xfc)]+'\x0a';});const _0xb9e30b=_0x4d261b[_0x284dd5(0x167)]['message']+'\x0a\x0a'+_0x528097,_0x3ff833=_0x5686e2[_0x284dd5(0x1db)];let _0x2681e2;_0x3ff833&&_0x3ff833['hasOwnProperty'](_0x284dd5(0x1d4))?_0x2681e2={'body':replaceMessages(_0x3ff833,_0xb9e30b),'number':_0x4153db,'companyId':_0x4fc75a}:_0x2681e2={'body':_0xb9e30b,'number':_0x4153db,'companyId':_0x4fc75a};const _0x2a1a9f=await(0x0,ShowTicketService_1['default'])(_0x5686e2['id'],_0x4fc75a),_0x55c57f={'id':(0x0,randomCode_1[_0x284dd5(0x151)])(0x32),'ticketId':_0x5686e2['id'],'body':_0x2681e2[_0x284dd5(0x1a4)],'fromMe':!![],'read':!![]};await(0x0,SendWhatsAppMediaFlow_1[_0x284dd5(0xf0)])(_0x5686e2,'composing'),await(0x0,SendWhatsAppMessage_1[_0x284dd5(0x116)])({'body':_0x2681e2[_0x284dd5(0x1a4)],'ticket':_0x2a1a9f,'quotedMsg':null}),(0x0,SetTicketMessagesAsRead_1[_0x284dd5(0x116)])(_0x2a1a9f),await _0x2a1a9f['update']({'lastMessage':(0x0,Mustache_1[_0x284dd5(0x116)])(_0x2681e2['body'],_0x5686e2)}),await intervalWhats('1');_0x5686e2?_0x5686e2=await Ticket_1[_0x284dd5(0x116)][_0x284dd5(0x11a)]({'where':{'id':_0x5686e2['id'],'whatsappId':_0x3749a3,'companyId':_0x4fc75a}}):_0x5686e2=await Ticket_1[_0x284dd5(0x116)][_0x284dd5(0x11a)]({'where':{'id':_0x25fb13,'whatsappId':_0x3749a3,'companyId':_0x4fc75a}});_0x5686e2&&await _0x5686e2[_0x284dd5(0x1b9)]({'queueId':_0x5686e2[_0x284dd5(0x1ba)]?_0x5686e2['queueId']:null,'userId':null,'companyId':_0x4fc75a,'flowWebhook':!![],'lastFlowId':_0x4d261b['id'],'dataWebhook':_0x577edc,'hashFlowId':_0x3c314c,'flowStopped':_0x1368ad[_0x284dd5(0xe7)]()});break;}}let _0x5a482d=![];if(!_0x247799){if(_0x48c674===_0x284dd5(0x198)&&_0x35aa26>0x0){console[_0x284dd5(0x12c)](0x24b,_0x284dd5(0xf7)),_0x48c674=undefined;let _0x2f9dae=_0x303f3d['filter'](_0xfc7569=>_0xfc7569[_0x284dd5(0x17f)]===_0x2cdf1e)[0x0];typeof _0x2f9dae===_0x284dd5(0x16a)?_0x254b26='':_0x254b26=_0x2f9dae[_0x284dd5(0x153)];}else{let _0x3610c6;if(_0x5cbc4a)_0x3610c6={'target':_0x2cdf1e},_0x5a482d=!![],_0x48c674=undefined;else _0x4e5d66?(_0x4e5d66=![],_0x3610c6=_0x254b26):_0x3610c6=_0x303f3d[_0x284dd5(0xf2)](_0x77f1e1=>_0x77f1e1[_0x284dd5(0x17f)]===_0x254b26)[0x0];typeof _0x3610c6===_0x284dd5(0x16a)?_0x254b26='':_0x254b26=_0x3610c6['target'],console[_0x284dd5(0x12c)](0x26b,_0x284dd5(0x14b));}}else console[_0x284dd5(0x12c)](_0x284dd5(0x1d1),_0x254b26);if(!_0x48c674&&!_0x5a482d&&!_0x247799){const _0x4e6d1b=_0x303f3d[_0x284dd5(0xf2)](_0x265cef=>_0x265cef[_0x284dd5(0x17f)]===_0x4d261b['id'])[_0x284dd5(0xe8)];console[_0x284dd5(0x12c)](0x272,_0x284dd5(0x14b));if(_0x4e6d1b===0x0){console['log'](0x28e,'ActionsWebhookService'),console[_0x284dd5(0x12c)](_0x284dd5(0x105)+_0x4d261b['id']),await Ticket_1['default'][_0x284dd5(0x11a)]({'where':{'id':_0x25fb13,'whatsappId':_0x3749a3,'companyId':_0x4fc75a}}),await _0x5686e2[_0x284dd5(0x1b9)]({'lastFlowId':null,'hashFlowId':null,'flowWebhook':![],'flowStopped':null,'flowBuilderId':null,'dataWebhook':null,'chatbot':![]}),console[_0x284dd5(0x12c)]('Ticket\x20#'+_0x5686e2['id']+'\x20saiu\x20do\x20flow.\x20flowWebhook:\x20false');break;}}_0x5a482d=![];if(_0x254b26==='')break;console[_0x284dd5(0x12c)](0x2a6,_0x284dd5(0x14b)),console['log'](_0x284dd5(0x120)),_0x5686e2=await Ticket_1['default'][_0x284dd5(0x11a)]({'where':{'id':_0x25fb13,'whatsappId':_0x3749a3,'companyId':_0x4fc75a}});_0x5686e2[_0x284dd5(0x1a8)]===_0x284dd5(0x1a5)&&_0x444be1['of'](String(_0x4fc75a))['emit'](_0x284dd5(0x148)+_0x5686e2['companyId']+_0x284dd5(0x1cf),{'action':_0x284dd5(0x117),'ticketId':_0x5686e2['id']});console[_0x284dd5(0x12c)](_0x284dd5(0x15d));const _0x387de1={'whatsappId':_0x3749a3,'queueId':_0x5686e2?.[_0x284dd5(0x1ba)],'userId':null,'companyId':_0x4fc75a,'flowWebhook':!![],'hashFlowId':_0x3c314c,'flowStopped':_0x1368ad[_0x284dd5(0xe7)]()};!_0x247799&&(_0x387de1[_0x284dd5(0xda)]=_0x4d261b['id']),await _0x5686e2[_0x284dd5(0x1b9)](_0x387de1),_0x247799=![],_0x35aa26++;}return'ds';}catch(_0x4db352){logger_1[_0x284dd5(0x17c)][_0x284dd5(0x16c)](_0x4db352);}};exports[a700_0x3b5d18(0x14b)]=ActionsWebhookService;function a700_0x1902(){const _0x3fc829=['../TicketServices/UpdateTicketService','../../utils/randomCode','[FlowBuilder]\x20Mídia\x20salva\x20com\x20sucesso:\x20','isMedia','[FlowBuilder]\x20Enviando\x20vídeo:\x20','company-','\x20não\x20encontrado','path','ActionsWebhookService','_success','Arquivo\x20de\x20mídia\x20não\x20encontrado:\x20','[FlowBuilder]\x20Imagem\x20baixada\x20e\x20salva:\x20','date','call','randomString','parar','target','../../utils/randomizador','response','__esModule','[FlowBuilder]\x20Variável\x20extraída:\x20','.svg','getWbot','record','typebot','[FlowBuilder]\x20Aguardando\x20resposta\x20para\x20variável:\x20','UPDATE12...','Validando\x20opção\x20','❌\x20Opção\x20inválida!\x0a\x0a','../StorageService/StorageService','UPDATE4...','Mozilla/5.0\x20(Windows\x20NT\x2010.0;\x20Win64;\x20x64)\x20AppleWebKit/537.36','whatsappId','from','includes','statusCode','data','getOwnPropertyDescriptor','[FlowBuilder]\x20Erro\x20ao\x20baixar\x20mídia\x20de\x20URL:\x20','undefined','Elemento\x20de\x20áudio\x20não\x20encontrado:\x20','error','percent','getIO','.aac','headers','assign','_response','singleBlock','[FlowBuilder]\x20Baixando\x20mídia\x20de\x20URL:\x20','delay','search','.opus','6046338JowHRq','match','Ticket\x20','composing','logger','object','type','source','axios','randomizer','localhost','SendMessage','3590ouYQLA','recording','inputs','3388005ewutSn','.ogg','outputVariables','mp3','6dWOEqs','join','.m4a','8VZkUjW','numero','../../utils/logger','.3gp','queue','number','getOwnPropertyNames','UPDATE7...','[FlowBuilder]\x20Processando\x20vídeo\x20-\x20valor\x20original:\x20','__importDefault','999','find','env','mp4','[FlowBuilder]\x20Variáveis\x20disponíveis:\x20','[FlowBuilder]\x20Variável\x20','BACKEND_URL','email','../WbotServices/SendWhatsAppMediaFlow','resolve','../../models/Setting','elements','body','closed','pt-BR','.mp4','status','uploadFile','.webp','arrayOption','img','Arquivo\x20de\x20áudio\x20não\x20encontrado:\x20','UPDATE5...','\x20-\x20','mime-types','substring','keysFull','Arquivo\x20de\x20vídeo\x20não\x20encontrado:\x20','hasOwnProperty','nome','options','../../models/Contact','replace','update','queueId','toLowerCase','stringify','arraybuffer','Sua\x20posição\x20na\x20fila:','https://','Apenas\x20texto\x20é\x20permitido.','toLocaleTimeString','minio','[FlowBuilder]\x20Variável\x20não\x20encontrada\x20no\x20áudio:\x20','\x22\x20salva','Opção\x20inválida.\x20Opções\x20válidas:\x20','_status','random','toLocaleDateString','275','[FlowBuilder]\x20Falha\x20ao\x20baixar\x20áudio\x20de:\x20','.jpeg','../../helpers/Mustache','.avi','randomizarCaminho','-ticket','.mkv','[FlowBuilder]\x20noAlterNext=true,\x20mantendo\x20next:','../WbotServices/SendWhatsAppMessage','.mp3','variables','[FlowBuilder]\x20Áudio\x20de\x20variável\x20processado:\x20','typebotIntegration','../TicketServices/FindOrCreateATicketTrakingService','.gif','127.0.0.1','map','dataWebhook','menu','UPDATE3...','Telefone\x20inválido.','[FlowBuilder]\x20Nó\x20capture\x20sem\x20conexão\x20de\x20saída.\x20Encerrando\x20fluxo.','url','image','[FlowBuilder]\x20Erro\x20ao\x20executar\x20HTTP\x20Request:\x20','../../models/Ticket','[FlowBuilder]\x20Vídeo\x20de\x20variável\x20processado:\x20','../WhatsappService/ShowWhatsAppService','defineProperty','startsWith','lastFlowId','company','\x20no\x20menu\x20','configurable','test','http','(((.+)+)+)+$','keyValue',',\x20com\x20handle\x20a','Elemento\x20de\x20vídeo\x20não\x20encontrado:\x20','existsSync','isVariable','pending','toString','length','userId','prototype','enabled','split','273','success',',\x20type=','typeSimulation','[FlowBuilder]\x20Sem\x20variáveis\x20disponíveis\x20para\x20substituição\x20de\x20vídeo','filter','video','[FlowBuilder]\x20Enviando\x20mídia\x20do\x20tipo\x20','Email\x20inválido.','2039718wAfPAq','ActionsWebhookService\x20|\x20587','contact','user','[FlowBuilder]\x20Falha\x20ao\x20baixar\x20imagem\x20de:\x20','\x20=>\x20','value','../TicketServices/CreateLogTicketService','now','text','content-type','CONNECTED','public','.mov','4890214Avkxrt','Flow\x20finalizado.\x20Último\x20nó:\x20','[FlowBuilder]\x20Imagem\x20de\x20variável\x20processada:\x20','[FlowBuilder]\x20Enviando\x20áudio:\x20','CPF\x20inválido.','sendQueuePositionMessage','[FlowBuilder]\x20Processando\x20imagem\x20-\x20valor\x20original:\x20','[FlowBuilder]\x20Sem\x20variáveis\x20disponíveis\x20para\x20substituição\x20de\x20imagem','[FlowBuilder]\x20Resultado\x20HTTP\x20Request:\x20','toLocaleString','message','jpg','trim','endsWith','writable','[FlowBuilder]\x20Enviando\x20imagem:\x20','1298984mkimdG','../../helpers/SendMessage','default','delete','UPDATE6...','11484IffiQx','findOne','[FlowBuilder]\x20Processando\x20nó\x20Captura:\x20','celular','cpf','audio','[FlowBuilder]\x20Processando\x20áudio\x20-\x20valor\x20original:\x20','UPDATE10...','string','1HkayWb','__importStar','[FlowBuilder]\x20Falha\x20ao\x20baixar\x20vídeo\x20de:\x20','../WbotServices/SendWhatsAppMedia','requestName','create','count','[FlowBuilder]\x20Áudio\x20baixado\x20e\x20salvo:\x20','.bmp','\x20=\x20','log','[FlowBuilder]\x20Variável\x20não\x20encontrada\x20no\x20vídeo:\x20','label','[FlowBuilder]\x20Sem\x20variáveis\x20disponíveis\x20para\x20substituição\x20de\x20áudio','__setModuleDefault','ActionWebhookService\x20|\x2053','phone','Elemento\x20de\x20imagem\x20não\x20encontrado:\x20','seq','http://','httpRequest','sourceHandle','.webm','name','../../libs/socket','Nó\x20não\x20encontrado.\x20Encerrando\x20execução\x20do\x20fluxo.','info','Conexões\x20do\x20menu:\x20','9000893rgkPVb','dist','../../helpers/SetTicketMessagesAsRead',',\x20url=',',\x20isVariable:\x20'];a700_0x1902=function(){return _0x3fc829;};return a700_0x1902();}const constructJsonLine=(_0x3e8408,_0x530852)=>{const _0x1b19d9=a700_0x3b5d18;let _0x4a06a3=_0x530852;const _0x3eb3b0=_0x3e8408['split']('.');if(_0x3eb3b0[_0x1b19d9(0xe8)]===0x1)return _0x4a06a3[_0x3eb3b0[0x0]];for(const _0xe3fd25 of _0x3eb3b0){_0x4a06a3=_0x4a06a3[_0xe3fd25];}return _0x4a06a3;};function removerNaoLetrasNumeros(_0x3927e8){const _0x217266=a700_0x3b5d18;return _0x3927e8[_0x217266(0x1b8)](/[^a-zA-Z0-9]/g,'');}const intervalWhats=_0x24e872=>{const _0x46bdc2=parseInt(_0x24e872)*0x3e8;return new Promise(_0x6af450=>setTimeout(_0x6af450,_0x46bdc2));},replaceMessages=(_0x467ce1,_0x83ab02)=>{const _0x113f92=a700_0x3b5d18;return _0x83ab02[_0x113f92(0x1b8)](/{{\s*([^{}\s]+)\s*}}/g,(_0x5ad365,_0x1bc1e9)=>_0x467ce1[_0x1bc1e9]||'');},replaceMessagesOld=(_0x19942d,_0x5509cb,_0x4c0fee,_0x2d7a43)=>{const _0x5eb6fb=a700_0x3b5d18,_0x20ab4b=_0x19942d[_0x5eb6fb(0x179)](/\{([^}]+)\}/g);if(_0x4c0fee){let _0xbbb220=_0x19942d['replace'](/{+nome}+/,_0x2d7a43[_0x5eb6fb(0x1b5)]);return _0xbbb220=_0xbbb220[_0x5eb6fb(0x1b8)](/{+numero}+/,_0x2d7a43[_0x5eb6fb(0x18f)]),_0xbbb220=_0xbbb220[_0x5eb6fb(0x1b8)](/{+email}+/,_0x2d7a43[_0x5eb6fb(0x19f)]),_0xbbb220;}if(_0x20ab4b&&_0x20ab4b[_0x5eb6fb(0x165)](_0x5eb6fb(0x186))){const _0x55e7b1=_0x20ab4b[_0x5eb6fb(0x1da)](_0x14795e=>_0x14795e[_0x5eb6fb(0x1b8)](/\{|\}/g,''));let _0x56932f=_0x19942d;return _0x55e7b1['map'](_0x79ebd6=>{const _0x37f8db=_0x5eb6fb,_0x365a72=_0x5509cb[_0x37f8db(0x186)][_0x37f8db(0x199)](_0x2d001=>_0x2d001[_0x37f8db(0xe1)]===_0x79ebd6),_0x4bab05=_0x5509cb['keysFull'][_0x37f8db(0x199)](_0xd54dbf=>_0xd54dbf[_0x37f8db(0x111)]('.'+_0x365a72[_0x37f8db(0x167)])),_0x26dcd9=constructJsonLine(_0x4bab05,_0x4c0fee);_0x56932f=_0x56932f[_0x37f8db(0x1b8)]('{'+_0x79ebd6+'}',_0x26dcd9);}),_0x56932f;}else return _0x19942d;};