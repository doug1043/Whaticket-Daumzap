const a378_0x5884a0=a378_0x2b44;(function(_0x4440a0,_0x13ed12){const _0x363e20=a378_0x2b44,_0x23866d=_0x4440a0();while(!![]){try{const _0x14f299=-parseInt(_0x363e20(0x9f))/0x1*(-parseInt(_0x363e20(0xa2))/0x2)+-parseInt(_0x363e20(0x84))/0x3+parseInt(_0x363e20(0x99))/0x4+-parseInt(_0x363e20(0x9b))/0x5+-parseInt(_0x363e20(0x95))/0x6*(parseInt(_0x363e20(0x98))/0x7)+-parseInt(_0x363e20(0x9e))/0x8+-parseInt(_0x363e20(0x8d))/0x9*(-parseInt(_0x363e20(0x8b))/0xa);if(_0x14f299===_0x13ed12)break;else _0x23866d['push'](_0x23866d['shift']());}catch(_0x26255b){_0x23866d['push'](_0x23866d['shift']());}}}(a378_0x57cc,0x22dd2));const a378_0x1731cb=(function(){let _0x3a187e=!![];return function(_0x7a076e,_0x5ac240){const _0x5068ca=_0x3a187e?function(){const _0x364d73=a378_0x2b44;if(_0x5ac240){const _0x48e739=_0x5ac240[_0x364d73(0x9c)](_0x7a076e,arguments);return _0x5ac240=null,_0x48e739;}}:function(){};return _0x3a187e=![],_0x5068ca;};}()),a378_0xe82332=a378_0x1731cb(this,function(){const _0x25f721=a378_0x2b44;return a378_0xe82332[_0x25f721(0xa1)]()[_0x25f721(0x97)](_0x25f721(0x8a))['toString']()[_0x25f721(0x89)](a378_0xe82332)[_0x25f721(0x97)](_0x25f721(0x8a));});a378_0xe82332();function a378_0x57cc(){const _0x5afbb7=['18QSGMln','default','search','64799oSTGkC','230456fjvODD','defineProperty','1168820sdgJds','apply','reload','1219872xSbHaw','1dZvjeB','../../models/ChatMessage','toString','163006WefNJX','userId','437244DQDbGz','__esModule','findByPk','unreads','update','constructor','(((.+)+)+)+$','1408630hnJzRR','create','36JPXKIy','findAll','../../models/Chat','../../models/User','users','name','sender','../../models/ChatUser'];a378_0x57cc=function(){return _0x5afbb7;};return a378_0x57cc();}function a378_0x2b44(_0x29e9ec,_0x51306b){const _0x3d0bfe=a378_0x57cc();return a378_0x2b44=function(_0xe82332,_0x1731cb){_0xe82332=_0xe82332-0x83;let _0x57cc90=_0x3d0bfe[_0xe82332];return _0x57cc90;},a378_0x2b44(_0x29e9ec,_0x51306b);}'use strict';var __importDefault=this&&this['__importDefault']||function(_0x418ad8){const _0x2e5901=a378_0x2b44;return _0x418ad8&&_0x418ad8[_0x2e5901(0x85)]?_0x418ad8:{'default':_0x418ad8};};Object[a378_0x5884a0(0x9a)](exports,a378_0x5884a0(0x85),{'value':!![]});const Chat_1=__importDefault(require(a378_0x5884a0(0x8f))),ChatMessage_1=__importDefault(require(a378_0x5884a0(0xa0))),ChatUser_1=__importDefault(require(a378_0x5884a0(0x94))),User_1=__importDefault(require(a378_0x5884a0(0x90)));async function CreateMessageService({senderId:_0x20d3bf,chatId:_0xdb5ec9,message:_0x1f5abd}){const _0x2cff5f=a378_0x5884a0,_0x365e2a=await ChatMessage_1['default'][_0x2cff5f(0x8c)]({'senderId':_0x20d3bf,'chatId':_0xdb5ec9,'message':_0x1f5abd});await _0x365e2a[_0x2cff5f(0x9d)]({'include':[{'model':User_1[_0x2cff5f(0x96)],'as':_0x2cff5f(0x93),'attributes':['id',_0x2cff5f(0x92)]},{'model':Chat_1[_0x2cff5f(0x96)],'as':'chat','include':[{'model':ChatUser_1['default'],'as':_0x2cff5f(0x91)}]}]});const _0x1558ef=await User_1['default'][_0x2cff5f(0x86)](_0x20d3bf);await _0x365e2a['chat']['update']({'lastMessage':_0x1558ef[_0x2cff5f(0x92)]+':\x20'+_0x1f5abd});const _0x1750fd=await ChatUser_1['default'][_0x2cff5f(0x8e)]({'where':{'chatId':_0xdb5ec9}});for(let _0x58be54 of _0x1750fd){_0x58be54[_0x2cff5f(0x83)]===_0x20d3bf?await _0x58be54[_0x2cff5f(0x88)]({'unreads':0x0}):await _0x58be54[_0x2cff5f(0x88)]({'unreads':_0x58be54[_0x2cff5f(0x87)]+0x1});}return _0x365e2a;}exports[a378_0x5884a0(0x96)]=CreateMessageService;