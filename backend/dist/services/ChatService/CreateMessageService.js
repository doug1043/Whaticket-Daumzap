const a377_0x17c9e0=a377_0x5471;(function(_0x56ce3f,_0x1ae5d1){const _0x507b14=a377_0x5471,_0x3c5c8a=_0x56ce3f();while(!![]){try{const _0x14e2fe=parseInt(_0x507b14(0x1cf))/0x1*(parseInt(_0x507b14(0x1da))/0x2)+parseInt(_0x507b14(0x1ce))/0x3*(parseInt(_0x507b14(0x1d0))/0x4)+parseInt(_0x507b14(0x1e1))/0x5+-parseInt(_0x507b14(0x1df))/0x6*(-parseInt(_0x507b14(0x1c6))/0x7)+parseInt(_0x507b14(0x1d4))/0x8*(parseInt(_0x507b14(0x1ca))/0x9)+parseInt(_0x507b14(0x1c8))/0xa+-parseInt(_0x507b14(0x1db))/0xb*(parseInt(_0x507b14(0x1c9))/0xc);if(_0x14e2fe===_0x1ae5d1)break;else _0x3c5c8a['push'](_0x3c5c8a['shift']());}catch(_0x133730){_0x3c5c8a['push'](_0x3c5c8a['shift']());}}}(a377_0x135d,0x509e7));const a377_0x47adad=(function(){let _0x5d0875=!![];return function(_0x36c154,_0x4bac6e){const _0x560027=_0x5d0875?function(){const _0x1e5133=a377_0x5471;if(_0x4bac6e){const _0x5ad079=_0x4bac6e[_0x1e5133(0x1d1)](_0x36c154,arguments);return _0x4bac6e=null,_0x5ad079;}}:function(){};return _0x5d0875=![],_0x560027;};}()),a377_0x3cad32=a377_0x47adad(this,function(){const _0x34e881=a377_0x5471;return a377_0x3cad32[_0x34e881(0x1cc)]()[_0x34e881(0x1d2)](_0x34e881(0x1dd))[_0x34e881(0x1cc)]()[_0x34e881(0x1d8)](a377_0x3cad32)[_0x34e881(0x1d2)](_0x34e881(0x1dd));});a377_0x3cad32();'use strict';var __importDefault=this&&this[a377_0x17c9e0(0x1e4)]||function(_0x18f3d2){const _0x3bc01d=a377_0x17c9e0;return _0x18f3d2&&_0x18f3d2[_0x3bc01d(0x1de)]?_0x18f3d2:{'default':_0x18f3d2};};Object[a377_0x17c9e0(0x1c7)](exports,a377_0x17c9e0(0x1de),{'value':!![]});const Chat_1=__importDefault(require(a377_0x17c9e0(0x1d7))),ChatMessage_1=__importDefault(require(a377_0x17c9e0(0x1e6))),ChatUser_1=__importDefault(require(a377_0x17c9e0(0x1d5))),User_1=__importDefault(require(a377_0x17c9e0(0x1cd)));function a377_0x135d(){const _0x4900ac=['8guIrHc','../../models/ChatUser','reload','../../models/Chat','constructor','name','613946zJDFMy','16930133CmjXIR','users','(((.+)+)+)+$','__esModule','6jjIKae','chat','392225lGBYeJ','default','findByPk','__importDefault','unreads','../../models/ChatMessage','findAll','update','2306633lIagID','defineProperty','3607450eZfMHv','12OZAezN','5425911LvAHjw','userId','toString','../../models/User','4809DtRyfI','1twPnJW','476DIQXZg','apply','search','create'];a377_0x135d=function(){return _0x4900ac;};return a377_0x135d();}function a377_0x5471(_0x3d8561,_0x4bfc14){const _0x337ea0=a377_0x135d();return a377_0x5471=function(_0x3cad32,_0x47adad){_0x3cad32=_0x3cad32-0x1c6;let _0x135d2f=_0x337ea0[_0x3cad32];return _0x135d2f;},a377_0x5471(_0x3d8561,_0x4bfc14);}async function CreateMessageService({senderId:_0x28edd1,chatId:_0xcf2057,message:_0x2fe4f1}){const _0x22b81d=a377_0x17c9e0,_0x1d384b=await ChatMessage_1['default'][_0x22b81d(0x1d3)]({'senderId':_0x28edd1,'chatId':_0xcf2057,'message':_0x2fe4f1});await _0x1d384b[_0x22b81d(0x1d6)]({'include':[{'model':User_1['default'],'as':'sender','attributes':['id',_0x22b81d(0x1d9)]},{'model':Chat_1[_0x22b81d(0x1e2)],'as':_0x22b81d(0x1e0),'include':[{'model':ChatUser_1[_0x22b81d(0x1e2)],'as':_0x22b81d(0x1dc)}]}]});const _0x4f106f=await User_1[_0x22b81d(0x1e2)][_0x22b81d(0x1e3)](_0x28edd1);await _0x1d384b[_0x22b81d(0x1e0)][_0x22b81d(0x1e8)]({'lastMessage':_0x4f106f['name']+':\x20'+_0x2fe4f1});const _0x1e7a79=await ChatUser_1[_0x22b81d(0x1e2)][_0x22b81d(0x1e7)]({'where':{'chatId':_0xcf2057}});for(let _0x2592d1 of _0x1e7a79){_0x2592d1[_0x22b81d(0x1cb)]===_0x28edd1?await _0x2592d1[_0x22b81d(0x1e8)]({'unreads':0x0}):await _0x2592d1['update']({'unreads':_0x2592d1[_0x22b81d(0x1e5)]+0x1});}return _0x1d384b;}exports[a377_0x17c9e0(0x1e2)]=CreateMessageService;