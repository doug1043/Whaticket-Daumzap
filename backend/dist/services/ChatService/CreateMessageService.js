const a412_0x2c91ec=a412_0x3861;(function(_0x3b5216,_0x38f86b){const _0x343dcc=a412_0x3861,_0x4f2970=_0x3b5216();while(!![]){try{const _0x1bf2af=-parseInt(_0x343dcc(0x71))/0x1+-parseInt(_0x343dcc(0x78))/0x2+parseInt(_0x343dcc(0x70))/0x3*(-parseInt(_0x343dcc(0x82))/0x4)+parseInt(_0x343dcc(0x73))/0x5*(-parseInt(_0x343dcc(0x6a))/0x6)+-parseInt(_0x343dcc(0x79))/0x7+-parseInt(_0x343dcc(0x85))/0x8*(-parseInt(_0x343dcc(0x7d))/0x9)+parseInt(_0x343dcc(0x7a))/0xa;if(_0x1bf2af===_0x38f86b)break;else _0x4f2970['push'](_0x4f2970['shift']());}catch(_0x570432){_0x4f2970['push'](_0x4f2970['shift']());}}}(a412_0x3e6a,0x3214a));const a412_0x4b9744=(function(){let _0x23a17d=!![];return function(_0x3eabad,_0x25d783){const _0x11f837=_0x23a17d?function(){const _0xd381f7=a412_0x3861;if(_0x25d783){const _0x3752f6=_0x25d783[_0xd381f7(0x6e)](_0x3eabad,arguments);return _0x25d783=null,_0x3752f6;}}:function(){};return _0x23a17d=![],_0x11f837;};}()),a412_0x27bbb9=a412_0x4b9744(this,function(){const _0x3128b8=a412_0x3861;return a412_0x27bbb9['toString']()[_0x3128b8(0x7f)](_0x3128b8(0x6c))['toString']()[_0x3128b8(0x7e)](a412_0x27bbb9)['search'](_0x3128b8(0x6c));});a412_0x27bbb9();function a412_0x3e6a(){const _0x41a0c1=['reload','69jQQCir','186506azSEzL','__importDefault','45xxOjMG','unreads','text','../../models/User','userId','727652WYPWXh','1624700zrKboA','12522270pjnFBJ','default','sender','9xUPrDb','constructor','search','../../models/ChatUser','findByPk','61788eTItbz','name','__esModule','1283792wuEpWI','users','update','defineProperty','46572AmZcfk','chat','(((.+)+)+)+$','create','apply'];a412_0x3e6a=function(){return _0x41a0c1;};return a412_0x3e6a();}'use strict';var __importDefault=this&&this[a412_0x2c91ec(0x72)]||function(_0x242cc7){const _0x29b721=a412_0x2c91ec;return _0x242cc7&&_0x242cc7[_0x29b721(0x84)]?_0x242cc7:{'default':_0x242cc7};};function a412_0x3861(_0x58b1d4,_0x5160fa){const _0x248b0d=a412_0x3e6a();return a412_0x3861=function(_0x27bbb9,_0x4b9744){_0x27bbb9=_0x27bbb9-0x68;let _0x3e6a71=_0x248b0d[_0x27bbb9];return _0x3e6a71;},a412_0x3861(_0x58b1d4,_0x5160fa);}Object[a412_0x2c91ec(0x69)](exports,a412_0x2c91ec(0x84),{'value':!![]}),exports[a412_0x2c91ec(0x7b)]=CreateMessageService;const Chat_1=__importDefault(require('../../models/Chat')),ChatMessage_1=__importDefault(require('../../models/ChatMessage')),ChatUser_1=__importDefault(require(a412_0x2c91ec(0x80))),User_1=__importDefault(require(a412_0x2c91ec(0x76)));async function CreateMessageService({senderId:_0x4d38df,chatId:_0x3fb2c7,message:_0x3ef1cb,mediaName:_0x2e86dd,mediaPath:_0x4cb9c8,mediaType:mediaType=a412_0x2c91ec(0x75)}){const _0x3079f0=a412_0x2c91ec,_0x271d60=await ChatMessage_1['default'][_0x3079f0(0x6d)]({'senderId':_0x4d38df,'chatId':_0x3fb2c7,'message':_0x3ef1cb,'mediaName':_0x2e86dd,'mediaPath':_0x4cb9c8,'mediaType':mediaType});await _0x271d60[_0x3079f0(0x6f)]({'include':[{'model':User_1['default'],'as':_0x3079f0(0x7c),'attributes':['id',_0x3079f0(0x83)]},{'model':Chat_1['default'],'as':_0x3079f0(0x6b),'include':[{'model':ChatUser_1[_0x3079f0(0x7b)],'as':_0x3079f0(0x86)}]}]});const _0x18dd8e=await User_1[_0x3079f0(0x7b)][_0x3079f0(0x81)](_0x4d38df);await _0x271d60[_0x3079f0(0x6b)][_0x3079f0(0x68)]({'lastMessage':_0x18dd8e[_0x3079f0(0x83)]+':\x20'+(_0x2e86dd!=null?_0x2e86dd:_0x3ef1cb)});const _0x468bfe=await ChatUser_1['default']['findAll']({'where':{'chatId':_0x3fb2c7}});for(let _0x404611 of _0x468bfe){_0x404611[_0x3079f0(0x77)]===_0x4d38df?await _0x404611[_0x3079f0(0x68)]({'unreads':0x0}):await _0x404611[_0x3079f0(0x68)]({'unreads':_0x404611[_0x3079f0(0x74)]+0x1});}return _0x271d60;}