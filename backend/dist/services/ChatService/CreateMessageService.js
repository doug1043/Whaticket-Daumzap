function a408_0x5e7e(_0x2be5e1,_0x551c41){const _0xdaf2b9=a408_0x549b();return a408_0x5e7e=function(_0x18350b,_0x2d3dc9){_0x18350b=_0x18350b-0x158;let _0x549b54=_0xdaf2b9[_0x18350b];return _0x549b54;},a408_0x5e7e(_0x2be5e1,_0x551c41);}const a408_0x208632=a408_0x5e7e;(function(_0x4bd152,_0xb490cc){const _0x5ce9c9=a408_0x5e7e,_0x30af8a=_0x4bd152();while(!![]){try{const _0x22f527=-parseInt(_0x5ce9c9(0x167))/0x1*(parseInt(_0x5ce9c9(0x162))/0x2)+-parseInt(_0x5ce9c9(0x16a))/0x3+parseInt(_0x5ce9c9(0x169))/0x4+parseInt(_0x5ce9c9(0x15a))/0x5+-parseInt(_0x5ce9c9(0x16c))/0x6+parseInt(_0x5ce9c9(0x16f))/0x7+parseInt(_0x5ce9c9(0x170))/0x8;if(_0x22f527===_0xb490cc)break;else _0x30af8a['push'](_0x30af8a['shift']());}catch(_0x3b83a7){_0x30af8a['push'](_0x30af8a['shift']());}}}(a408_0x549b,0xc319c));const a408_0x2d3dc9=(function(){let _0x4530c3=!![];return function(_0x5c2784,_0x397f15){const _0x2f64d6=_0x4530c3?function(){const _0x2bb1c9=a408_0x5e7e;if(_0x397f15){const _0x31d341=_0x397f15[_0x2bb1c9(0x164)](_0x5c2784,arguments);return _0x397f15=null,_0x31d341;}}:function(){};return _0x4530c3=![],_0x2f64d6;};}()),a408_0x18350b=a408_0x2d3dc9(this,function(){const _0x2857b3=a408_0x5e7e;return a408_0x18350b['toString']()[_0x2857b3(0x15d)](_0x2857b3(0x161))['toString']()[_0x2857b3(0x15e)](a408_0x18350b)[_0x2857b3(0x15d)]('(((.+)+)+)+$');});function a408_0x549b(){const _0x72d42f=['userId','search','constructor','sender','chat','(((.+)+)+)+$','52ksWwhT','../../models/ChatMessage','apply','__importDefault','name','25980ikycSY','create','2828336PfYfjk','3022284XqRUWL','reload','7144284qszmkJ','findByPk','users','8370677BxYmvp','10627112hHsdeZ','default','findAll','../../models/User','text','2207350vapBDe','update'];a408_0x549b=function(){return _0x72d42f;};return a408_0x549b();}a408_0x18350b();'use strict';var __importDefault=this&&this[a408_0x208632(0x165)]||function(_0x654861){return _0x654861&&_0x654861['__esModule']?_0x654861:{'default':_0x654861};};Object['defineProperty'](exports,'__esModule',{'value':!![]}),exports[a408_0x208632(0x171)]=CreateMessageService;const Chat_1=__importDefault(require('../../models/Chat')),ChatMessage_1=__importDefault(require(a408_0x208632(0x163))),ChatUser_1=__importDefault(require('../../models/ChatUser')),User_1=__importDefault(require(a408_0x208632(0x158)));async function CreateMessageService({senderId:_0x24b153,chatId:_0xf6417b,message:_0x1a123a,mediaName:_0x5f10c2,mediaPath:_0x34a7c8,mediaType:mediaType=a408_0x208632(0x159)}){const _0x2048e3=a408_0x208632,_0xa68a2e=await ChatMessage_1[_0x2048e3(0x171)][_0x2048e3(0x168)]({'senderId':_0x24b153,'chatId':_0xf6417b,'message':_0x1a123a,'mediaName':_0x5f10c2,'mediaPath':_0x34a7c8,'mediaType':mediaType});await _0xa68a2e[_0x2048e3(0x16b)]({'include':[{'model':User_1[_0x2048e3(0x171)],'as':_0x2048e3(0x15f),'attributes':['id',_0x2048e3(0x166)]},{'model':Chat_1[_0x2048e3(0x171)],'as':'chat','include':[{'model':ChatUser_1[_0x2048e3(0x171)],'as':_0x2048e3(0x16e)}]}]});const _0xa8cf65=await User_1[_0x2048e3(0x171)][_0x2048e3(0x16d)](_0x24b153);await _0xa68a2e[_0x2048e3(0x160)][_0x2048e3(0x15b)]({'lastMessage':_0xa8cf65['name']+':\x20'+(_0x5f10c2!=null?_0x5f10c2:_0x1a123a)});const _0x8bf2bd=await ChatUser_1[_0x2048e3(0x171)][_0x2048e3(0x172)]({'where':{'chatId':_0xf6417b}});for(let _0xc17b45 of _0x8bf2bd){_0xc17b45[_0x2048e3(0x15c)]===_0x24b153?await _0xc17b45[_0x2048e3(0x15b)]({'unreads':0x0}):await _0xc17b45[_0x2048e3(0x15b)]({'unreads':_0xc17b45['unreads']+0x1});}return _0xa68a2e;}