const a376_0xf768f5=a376_0x21b3;(function(_0x3cb725,_0xf4877e){const _0x5cce2e=a376_0x21b3,_0x4e746e=_0x3cb725();while(!![]){try{const _0x4d0597=parseInt(_0x5cce2e(0x1e0))/0x1+-parseInt(_0x5cce2e(0x1eb))/0x2+-parseInt(_0x5cce2e(0x1d8))/0x3+parseInt(_0x5cce2e(0x1da))/0x4*(parseInt(_0x5cce2e(0x1d9))/0x5)+-parseInt(_0x5cce2e(0x1ed))/0x6*(parseInt(_0x5cce2e(0x1ef))/0x7)+parseInt(_0x5cce2e(0x1d6))/0x8+parseInt(_0x5cce2e(0x1de))/0x9;if(_0x4d0597===_0xf4877e)break;else _0x4e746e['push'](_0x4e746e['shift']());}catch(_0x23e892){_0x4e746e['push'](_0x4e746e['shift']());}}}(a376_0xce63,0x27043));const a376_0x191b2f=(function(){let _0x92d941=!![];return function(_0x56bb15,_0x1b3e08){const _0x2afc0e=_0x92d941?function(){const _0x3a80b3=a376_0x21b3;if(_0x1b3e08){const _0x2a9dfa=_0x1b3e08[_0x3a80b3(0x1ec)](_0x56bb15,arguments);return _0x1b3e08=null,_0x2a9dfa;}}:function(){};return _0x92d941=![],_0x2afc0e;};}()),a376_0x69e911=a376_0x191b2f(this,function(){const _0x5b2404=a376_0x21b3;return a376_0x69e911[_0x5b2404(0x1e1)]()['search']('(((.+)+)+)+$')['toString']()[_0x5b2404(0x1e6)](a376_0x69e911)[_0x5b2404(0x1dc)]('(((.+)+)+)+$');});a376_0x69e911();function a376_0x21b3(_0x162add,_0x2f05fe){const _0x11122b=a376_0xce63();return a376_0x21b3=function(_0x69e911,_0x191b2f){_0x69e911=_0x69e911-0x1d4;let _0xce63b8=_0x11122b[_0x69e911];return _0xce63b8;},a376_0x21b3(_0x162add,_0x2f05fe);}'use strict';var __importDefault=this&&this[a376_0xf768f5(0x1df)]||function(_0xf3dbb3){return _0xf3dbb3&&_0xf3dbb3['__esModule']?_0xf3dbb3:{'default':_0xf3dbb3};};Object['defineProperty'](exports,a376_0xf768f5(0x1e9),{'value':!![]});const Chat_1=__importDefault(require(a376_0xf768f5(0x1d7))),ChatMessage_1=__importDefault(require(a376_0xf768f5(0x1dd))),ChatUser_1=__importDefault(require('../../models/ChatUser')),User_1=__importDefault(require(a376_0xf768f5(0x1ea)));async function CreateMessageService({senderId:_0x1408b1,chatId:_0x2caee1,message:_0x4f48c2}){const _0x31f05e=a376_0xf768f5,_0x23d4c9=await ChatMessage_1[_0x31f05e(0x1e7)][_0x31f05e(0x1e4)]({'senderId':_0x1408b1,'chatId':_0x2caee1,'message':_0x4f48c2});await _0x23d4c9['reload']({'include':[{'model':User_1[_0x31f05e(0x1e7)],'as':_0x31f05e(0x1e2),'attributes':['id',_0x31f05e(0x1d4)]},{'model':Chat_1[_0x31f05e(0x1e7)],'as':_0x31f05e(0x1e3),'include':[{'model':ChatUser_1['default'],'as':_0x31f05e(0x1db)}]}]});const _0x3c2b14=await User_1['default'][_0x31f05e(0x1ee)](_0x1408b1);await _0x23d4c9[_0x31f05e(0x1e3)]['update']({'lastMessage':_0x3c2b14[_0x31f05e(0x1d4)]+':\x20'+_0x4f48c2});const _0x5e0322=await ChatUser_1[_0x31f05e(0x1e7)][_0x31f05e(0x1d5)]({'where':{'chatId':_0x2caee1}});for(let _0x172f5d of _0x5e0322){_0x172f5d[_0x31f05e(0x1e5)]===_0x1408b1?await _0x172f5d['update']({'unreads':0x0}):await _0x172f5d['update']({'unreads':_0x172f5d[_0x31f05e(0x1e8)]+0x1});}return _0x23d4c9;}exports['default']=CreateMessageService;function a376_0xce63(){const _0x10b071=['toString','sender','chat','create','userId','constructor','default','unreads','__esModule','../../models/User','371092YBaQhp','apply','54306gVPGzN','findByPk','175MXgjfM','name','findAll','1663584YAXbMc','../../models/Chat','352500INgDkq','417790GRbKPb','4DyKmiZ','users','search','../../models/ChatMessage','1009161HKQvkz','__importDefault','285497DybELh'];a376_0xce63=function(){return _0x10b071;};return a376_0xce63();}