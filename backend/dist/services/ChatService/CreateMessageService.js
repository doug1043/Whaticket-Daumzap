const a412_0x3c0723=a412_0x4c3d;(function(_0x1c77b7,_0x2c4219){const _0x32bf50=a412_0x4c3d,_0x346142=_0x1c77b7();while(!![]){try{const _0x392a0c=parseInt(_0x32bf50(0x180))/0x1+parseInt(_0x32bf50(0x198))/0x2*(-parseInt(_0x32bf50(0x19c))/0x3)+-parseInt(_0x32bf50(0x181))/0x4*(parseInt(_0x32bf50(0x18e))/0x5)+-parseInt(_0x32bf50(0x182))/0x6*(-parseInt(_0x32bf50(0x18a))/0x7)+-parseInt(_0x32bf50(0x183))/0x8*(-parseInt(_0x32bf50(0x193))/0x9)+parseInt(_0x32bf50(0x18c))/0xa+-parseInt(_0x32bf50(0x18d))/0xb*(parseInt(_0x32bf50(0x184))/0xc);if(_0x392a0c===_0x2c4219)break;else _0x346142['push'](_0x346142['shift']());}catch(_0x37a2c4){_0x346142['push'](_0x346142['shift']());}}}(a412_0x2b92,0xe0c32));const a412_0xa228ca=(function(){let _0x53b336=!![];return function(_0x41c5bc,_0x11413d){const _0x29d279=_0x53b336?function(){const _0x23b021=a412_0x4c3d;if(_0x11413d){const _0x317500=_0x11413d[_0x23b021(0x194)](_0x41c5bc,arguments);return _0x11413d=null,_0x317500;}}:function(){};return _0x53b336=![],_0x29d279;};}()),a412_0x125ef6=a412_0xa228ca(this,function(){const _0x122976=a412_0x4c3d;return a412_0x125ef6['toString']()[_0x122976(0x19a)](_0x122976(0x19d))['toString']()['constructor'](a412_0x125ef6)['search'](_0x122976(0x19d));});a412_0x125ef6();'use strict';var __importDefault=this&&this[a412_0x3c0723(0x188)]||function(_0x962c25){const _0x5c3387=a412_0x3c0723;return _0x962c25&&_0x962c25[_0x5c3387(0x18b)]?_0x962c25:{'default':_0x962c25};};Object[a412_0x3c0723(0x19b)](exports,a412_0x3c0723(0x18b),{'value':!![]}),exports['default']=CreateMessageService;const Chat_1=__importDefault(require(a412_0x3c0723(0x18f))),ChatMessage_1=__importDefault(require('../../models/ChatMessage')),ChatUser_1=__importDefault(require(a412_0x3c0723(0x187))),User_1=__importDefault(require('../../models/User'));function a412_0x2b92(){const _0x43de42=['6030SkXLJt','../../models/Chat','text','findAll','chat','18dogDrN','apply','update','name','default','2kzcyLC','userId','search','defineProperty','3591702hrXzDq','(((.+)+)+)+$','reload','748856OEKLvS','844DSDQmO','6NMFCAR','2506064zGPgMl','840elPiuN','users','unreads','../../models/ChatUser','__importDefault','findByPk','4451041RxaHTO','__esModule','9441210HraReY','91619BdaoOS'];a412_0x2b92=function(){return _0x43de42;};return a412_0x2b92();}function a412_0x4c3d(_0x17e21c,_0x234dfb){const _0x5bc55b=a412_0x2b92();return a412_0x4c3d=function(_0x125ef6,_0xa228ca){_0x125ef6=_0x125ef6-0x17f;let _0x2b92da=_0x5bc55b[_0x125ef6];return _0x2b92da;},a412_0x4c3d(_0x17e21c,_0x234dfb);}async function CreateMessageService({senderId:_0xb12113,chatId:_0xfa536a,message:_0x2a9d7e,mediaName:_0xcffdeb,mediaPath:_0x3660ed,mediaType:mediaType=a412_0x3c0723(0x190)}){const _0x338c09=a412_0x3c0723,_0x92188f=await ChatMessage_1[_0x338c09(0x197)]['create']({'senderId':_0xb12113,'chatId':_0xfa536a,'message':_0x2a9d7e,'mediaName':_0xcffdeb,'mediaPath':_0x3660ed,'mediaType':mediaType});await _0x92188f[_0x338c09(0x17f)]({'include':[{'model':User_1[_0x338c09(0x197)],'as':'sender','attributes':['id',_0x338c09(0x196)]},{'model':Chat_1[_0x338c09(0x197)],'as':_0x338c09(0x192),'include':[{'model':ChatUser_1[_0x338c09(0x197)],'as':_0x338c09(0x185)}]}]});const _0x1c7f7f=await User_1['default'][_0x338c09(0x189)](_0xb12113);await _0x92188f[_0x338c09(0x192)][_0x338c09(0x195)]({'lastMessage':_0x1c7f7f[_0x338c09(0x196)]+':\x20'+(_0xcffdeb!=null?_0xcffdeb:_0x2a9d7e)});const _0x7a75a6=await ChatUser_1['default'][_0x338c09(0x191)]({'where':{'chatId':_0xfa536a}});for(let _0x1a8557 of _0x7a75a6){_0x1a8557[_0x338c09(0x199)]===_0xb12113?await _0x1a8557[_0x338c09(0x195)]({'unreads':0x0}):await _0x1a8557[_0x338c09(0x195)]({'unreads':_0x1a8557[_0x338c09(0x186)]+0x1});}return _0x92188f;}