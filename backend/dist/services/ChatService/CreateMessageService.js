const a378_0x29bfca=a378_0x5450;(function(_0x3c1e93,_0x48a2e2){const _0x28e8d3=a378_0x5450,_0x30122f=_0x3c1e93();while(!![]){try{const _0x2c3ae1=-parseInt(_0x28e8d3(0x1c6))/0x1*(parseInt(_0x28e8d3(0x1d7))/0x2)+-parseInt(_0x28e8d3(0x1d8))/0x3*(-parseInt(_0x28e8d3(0x1d4))/0x4)+parseInt(_0x28e8d3(0x1d5))/0x5*(parseInt(_0x28e8d3(0x1c8))/0x6)+parseInt(_0x28e8d3(0x1ce))/0x7+parseInt(_0x28e8d3(0x1c0))/0x8*(-parseInt(_0x28e8d3(0x1d1))/0x9)+-parseInt(_0x28e8d3(0x1da))/0xa+-parseInt(_0x28e8d3(0x1ca))/0xb*(-parseInt(_0x28e8d3(0x1d2))/0xc);if(_0x2c3ae1===_0x48a2e2)break;else _0x30122f['push'](_0x30122f['shift']());}catch(_0x2bbe0b){_0x30122f['push'](_0x30122f['shift']());}}}(a378_0x6ffb,0x8f7dc));const a378_0x33c062=(function(){let _0x29df8e=!![];return function(_0x5aa24f,_0x416b8b){const _0x398c12=_0x29df8e?function(){if(_0x416b8b){const _0x24bd84=_0x416b8b['apply'](_0x5aa24f,arguments);return _0x416b8b=null,_0x24bd84;}}:function(){};return _0x29df8e=![],_0x398c12;};}()),a378_0x52a761=a378_0x33c062(this,function(){const _0x1c40f7=a378_0x5450;return a378_0x52a761['toString']()[_0x1c40f7(0x1c9)](_0x1c40f7(0x1c7))['toString']()[_0x1c40f7(0x1d0)](a378_0x52a761)[_0x1c40f7(0x1c9)]('(((.+)+)+)+$');});function a378_0x5450(_0x3d6054,_0x383257){const _0x400a6d=a378_0x6ffb();return a378_0x5450=function(_0x52a761,_0x33c062){_0x52a761=_0x52a761-0x1bf;let _0x6ffbd4=_0x400a6d[_0x52a761];return _0x6ffbd4;},a378_0x5450(_0x3d6054,_0x383257);}a378_0x52a761();'use strict';var __importDefault=this&&this['__importDefault']||function(_0xbb6bf2){return _0xbb6bf2&&_0xbb6bf2['__esModule']?_0xbb6bf2:{'default':_0xbb6bf2};};Object[a378_0x29bfca(0x1c4)](exports,a378_0x29bfca(0x1cb),{'value':!![]});const Chat_1=__importDefault(require(a378_0x29bfca(0x1c2))),ChatMessage_1=__importDefault(require('../../models/ChatMessage')),ChatUser_1=__importDefault(require('../../models/ChatUser')),User_1=__importDefault(require(a378_0x29bfca(0x1d9)));function a378_0x6ffb(){const _0x1838cc=['chat','constructor','6669ItiElk','2335128wIiCtl','findAll','4afOKuc','5AGXXuJ','unreads','1674922HqMSaR','3474393mLLjrA','../../models/User','11108270MnosIm','reload','8496CuEsVx','default','../../models/Chat','update','defineProperty','userId','1NyGqpQ','(((.+)+)+)+$','5922762ZWAoqA','search','11LRpVLD','__esModule','name','users','6881826Xjxjst'];a378_0x6ffb=function(){return _0x1838cc;};return a378_0x6ffb();}async function CreateMessageService({senderId:_0x174e8c,chatId:_0x5a9a68,message:_0x506230}){const _0x4a3850=a378_0x29bfca,_0x1c389f=await ChatMessage_1[_0x4a3850(0x1c1)]['create']({'senderId':_0x174e8c,'chatId':_0x5a9a68,'message':_0x506230});await _0x1c389f[_0x4a3850(0x1bf)]({'include':[{'model':User_1[_0x4a3850(0x1c1)],'as':'sender','attributes':['id',_0x4a3850(0x1cc)]},{'model':Chat_1[_0x4a3850(0x1c1)],'as':_0x4a3850(0x1cf),'include':[{'model':ChatUser_1[_0x4a3850(0x1c1)],'as':_0x4a3850(0x1cd)}]}]});const _0x5d7693=await User_1['default']['findByPk'](_0x174e8c);await _0x1c389f[_0x4a3850(0x1cf)][_0x4a3850(0x1c3)]({'lastMessage':_0x5d7693[_0x4a3850(0x1cc)]+':\x20'+_0x506230});const _0x5a31a3=await ChatUser_1[_0x4a3850(0x1c1)][_0x4a3850(0x1d3)]({'where':{'chatId':_0x5a9a68}});for(let _0x1a87cc of _0x5a31a3){_0x1a87cc[_0x4a3850(0x1c5)]===_0x174e8c?await _0x1a87cc[_0x4a3850(0x1c3)]({'unreads':0x0}):await _0x1a87cc['update']({'unreads':_0x1a87cc[_0x4a3850(0x1d6)]+0x1});}return _0x1c389f;}exports['default']=CreateMessageService;