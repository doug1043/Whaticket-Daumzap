const a494_0x5cfcc4=a494_0x2550;function a494_0x2550(_0x47608a,_0x4434b0){const _0x334ea9=a494_0x4541();return a494_0x2550=function(_0x8e5d06,_0x2be74b){_0x8e5d06=_0x8e5d06-0x132;let _0x4541c9=_0x334ea9[_0x8e5d06];return _0x4541c9;},a494_0x2550(_0x47608a,_0x4434b0);}(function(_0xfaa2e5,_0xf3426){const _0x39aea4=a494_0x2550,_0x3ad4db=_0xfaa2e5();while(!![]){try{const _0x2a3792=parseInt(_0x39aea4(0x140))/0x1*(parseInt(_0x39aea4(0x147))/0x2)+-parseInt(_0x39aea4(0x139))/0x3+parseInt(_0x39aea4(0x14e))/0x4+parseInt(_0x39aea4(0x14f))/0x5+-parseInt(_0x39aea4(0x146))/0x6*(-parseInt(_0x39aea4(0x134))/0x7)+-parseInt(_0x39aea4(0x13b))/0x8*(-parseInt(_0x39aea4(0x137))/0x9)+-parseInt(_0x39aea4(0x143))/0xa;if(_0x2a3792===_0xf3426)break;else _0x3ad4db['push'](_0x3ad4db['shift']());}catch(_0x25df19){_0x3ad4db['push'](_0x3ad4db['shift']());}}}(a494_0x4541,0xa241f));const a494_0x2be74b=(function(){let _0x4b2a95=!![];return function(_0x109280,_0x2dd950){const _0x297515=_0x4b2a95?function(){const _0x2ffbe6=a494_0x2550;if(_0x2dd950){const _0x46edd1=_0x2dd950[_0x2ffbe6(0x148)](_0x109280,arguments);return _0x2dd950=null,_0x46edd1;}}:function(){};return _0x4b2a95=![],_0x297515;};}()),a494_0x8e5d06=a494_0x2be74b(this,function(){const _0x2494a4=a494_0x2550;return a494_0x8e5d06[_0x2494a4(0x13c)]()[_0x2494a4(0x138)](_0x2494a4(0x14b))[_0x2494a4(0x13c)]()[_0x2494a4(0x14d)](a494_0x8e5d06)[_0x2494a4(0x138)](_0x2494a4(0x14b));});a494_0x8e5d06();function a494_0x4541(){const _0x1f68dc=['findAll','sender','23059870ODPZHT','users','../../models/User','4004862knreQZ','2CIJeXo','apply','defineProperty','name','(((.+)+)+)+$','../../models/ChatUser','constructor','4527144IkDbBi','4803290xSrlot','default','text','__esModule','__importDefault','7zPcCOw','reload','update','882612PARiur','search','401463GrFwRq','../../models/Chat','8lPbPcr','toString','../../models/ChatMessage','findByPk','unreads','246426BMAIDe'];a494_0x4541=function(){return _0x1f68dc;};return a494_0x4541();}'use strict';var __importDefault=this&&this[a494_0x5cfcc4(0x133)]||function(_0x1230bf){return _0x1230bf&&_0x1230bf['__esModule']?_0x1230bf:{'default':_0x1230bf};};Object[a494_0x5cfcc4(0x149)](exports,a494_0x5cfcc4(0x132),{'value':!![]}),exports[a494_0x5cfcc4(0x150)]=CreateMessageService;const Chat_1=__importDefault(require(a494_0x5cfcc4(0x13a))),ChatMessage_1=__importDefault(require(a494_0x5cfcc4(0x13d))),ChatUser_1=__importDefault(require(a494_0x5cfcc4(0x14c))),User_1=__importDefault(require(a494_0x5cfcc4(0x145)));async function CreateMessageService({senderId:_0xf76243,chatId:_0x2913d9,message:_0x5a2861,mediaName:_0x353b26,mediaPath:_0x314e19,mediaType:mediaType=a494_0x5cfcc4(0x151)}){const _0x3622d9=a494_0x5cfcc4,_0x26654c=await ChatMessage_1[_0x3622d9(0x150)]['create']({'senderId':_0xf76243,'chatId':_0x2913d9,'message':_0x5a2861,'mediaName':_0x353b26,'mediaPath':_0x314e19,'mediaType':mediaType});await _0x26654c[_0x3622d9(0x135)]({'include':[{'model':User_1[_0x3622d9(0x150)],'as':_0x3622d9(0x142),'attributes':['id',_0x3622d9(0x14a)]},{'model':Chat_1[_0x3622d9(0x150)],'as':'chat','include':[{'model':ChatUser_1['default'],'as':_0x3622d9(0x144)}]}]});const _0x15eb5a=await User_1[_0x3622d9(0x150)][_0x3622d9(0x13e)](_0xf76243);await _0x26654c['chat']['update']({'lastMessage':_0x15eb5a[_0x3622d9(0x14a)]+':\x20'+(_0x353b26!=null?_0x353b26:_0x5a2861)});const _0x2f3b91=await ChatUser_1[_0x3622d9(0x150)][_0x3622d9(0x141)]({'where':{'chatId':_0x2913d9}});for(let _0x2906e3 of _0x2f3b91){_0x2906e3['userId']===_0xf76243?await _0x2906e3['update']({'unreads':0x0}):await _0x2906e3[_0x3622d9(0x136)]({'unreads':_0x2906e3[_0x3622d9(0x13f)]+0x1});}return _0x26654c;}