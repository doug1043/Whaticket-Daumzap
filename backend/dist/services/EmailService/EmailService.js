'use strict';function a539_0x2439(_0x3f436a,_0x34dde9){const _0x5045c8=a539_0x32b8();return a539_0x2439=function(_0x376e57,_0x28e6a6){_0x376e57=_0x376e57-0x79;let _0x32b850=_0x5045c8[_0x376e57];return _0x32b850;},a539_0x2439(_0x3f436a,_0x34dde9);}function a539_0x32b8(){const _0x431ed5=['Erro\x20ao\x20agendar\x20e-mail:\x20','SendMail','add','175909AgRuLP','defineProperty','writable','__esModule','5eXGJlA','value','default','(((.+)+)+)+$','schedule','toString','search','792790kKRISf','E-mail\x20agendado\x20e\x20salvo\x20com\x20sucesso','__importStar','nodemailer','getOwnPropertyDescriptor','clientsecretsmtpauth','__createBinding','__setModuleDefault','get','12LzwUoB','format','__importDefault','smtpport','node-cron','903343zAvtto','constructor','error','Agendamento\x20de\x20e-mail\x20realizado\x20com\x20sucesso','8748378cUPXpj','Erro\x20ao\x20enviar\x20e-mail:','hasOwnProperty','44567232ukbwiX','findOne','length','E-mail\x20enviado\x20imediatamente','smtpauth','YYYY-MM-DDTHH:mm','8WYsYMW','prototype','moment','8OZePbL','2477304xLxpBU','16182793pMRInp','9AKjCWK','create'];a539_0x32b8=function(){return _0x431ed5;};return a539_0x32b8();}const a539_0x24f024=a539_0x2439;(function(_0x32d8c4,_0x12f48e){const _0x1a65ad=a539_0x2439,_0x5dfdbd=_0x32d8c4();while(!![]){try{const _0xb21112=parseInt(_0x1a65ad(0xa6))/0x1*(-parseInt(_0x1a65ad(0x89))/0x2)+-parseInt(_0x1a65ad(0x9f))/0x3*(parseInt(_0x1a65ad(0x9e))/0x4)+parseInt(_0x1a65ad(0x79))/0x5*(parseInt(_0x1a65ad(0x92))/0x6)+-parseInt(_0x1a65ad(0x8e))/0x7*(parseInt(_0x1a65ad(0x9b))/0x8)+parseInt(_0x1a65ad(0xa1))/0x9*(parseInt(_0x1a65ad(0x80))/0xa)+-parseInt(_0x1a65ad(0xa0))/0xb+parseInt(_0x1a65ad(0x95))/0xc;if(_0xb21112===_0x12f48e)break;else _0x5dfdbd['push'](_0x5dfdbd['shift']());}catch(_0x1af7ee){_0x5dfdbd['push'](_0x5dfdbd['shift']());}}}(a539_0x32b8,0xe67cc));var __createBinding=this&&this[a539_0x24f024(0x86)]||(Object[a539_0x24f024(0xa2)]?function(_0x38d0fb,_0x114ede,_0x2a3024,_0x5f2c59){const _0x29e7e=a539_0x24f024;if(_0x5f2c59===undefined)_0x5f2c59=_0x2a3024;var _0x356c04=Object[_0x29e7e(0x84)](_0x114ede,_0x2a3024);(!_0x356c04||(_0x29e7e(0x88)in _0x356c04?!_0x114ede[_0x29e7e(0xa9)]:_0x356c04[_0x29e7e(0xa8)]||_0x356c04['configurable']))&&(_0x356c04={'enumerable':!![],'get':function(){return _0x114ede[_0x2a3024];}}),Object['defineProperty'](_0x38d0fb,_0x5f2c59,_0x356c04);}:function(_0x229dbe,_0x14c4d3,_0x203af7,_0x14c555){if(_0x14c555===undefined)_0x14c555=_0x203af7;_0x229dbe[_0x14c555]=_0x14c4d3[_0x203af7];}),__setModuleDefault=this&&this[a539_0x24f024(0x87)]||(Object['create']?function(_0x1d3c48,_0x184456){const _0x48ce85=a539_0x24f024;Object[_0x48ce85(0xa7)](_0x1d3c48,_0x48ce85(0x7b),{'enumerable':!![],'value':_0x184456});}:function(_0x2a2c7e,_0x253b8a){_0x2a2c7e['default']=_0x253b8a;}),__importStar=this&&this[a539_0x24f024(0x82)]||(function(){const _0x26ac85=(function(){let _0xa141dd=!![];return function(_0x34fee6,_0x1c30f1){const _0x51934e=_0xa141dd?function(){if(_0x1c30f1){const _0x3a9ac7=_0x1c30f1['apply'](_0x34fee6,arguments);return _0x1c30f1=null,_0x3a9ac7;}}:function(){};return _0xa141dd=![],_0x51934e;};}()),_0x824f9=_0x26ac85(this,function(){const _0xebb902=a539_0x2439;return _0x824f9[_0xebb902(0x7e)]()[_0xebb902(0x7f)]('(((.+)+)+)+$')[_0xebb902(0x7e)]()[_0xebb902(0x8f)](_0x824f9)[_0xebb902(0x7f)](_0xebb902(0x7c));});_0x824f9();var _0x3f1a63=function(_0x125e78){return _0x3f1a63=Object['getOwnPropertyNames']||function(_0x197a41){const _0x33fbd1=a539_0x2439;var _0x201246=[];for(var _0xe1a756 in _0x197a41)if(Object[_0x33fbd1(0x9c)][_0x33fbd1(0x94)]['call'](_0x197a41,_0xe1a756))_0x201246[_0x201246[_0x33fbd1(0x97)]]=_0xe1a756;return _0x201246;},_0x3f1a63(_0x125e78);};return function(_0x50dbbb){const _0x125abf=a539_0x2439;if(_0x50dbbb&&_0x50dbbb['__esModule'])return _0x50dbbb;var _0x589421={};if(_0x50dbbb!=null){for(var _0x2ad9e9=_0x3f1a63(_0x50dbbb),_0x230527=0x0;_0x230527<_0x2ad9e9[_0x125abf(0x97)];_0x230527++)if(_0x2ad9e9[_0x230527]!==_0x125abf(0x7b))__createBinding(_0x589421,_0x50dbbb,_0x2ad9e9[_0x230527]);}return __setModuleDefault(_0x589421,_0x50dbbb),_0x589421;};}()),__importDefault=this&&this[a539_0x24f024(0x8b)]||function(_0x2691a5){const _0x2f5b3f=a539_0x24f024;return _0x2691a5&&_0x2691a5[_0x2f5b3f(0xa9)]?_0x2691a5:{'default':_0x2691a5};};Object[a539_0x24f024(0xa7)](exports,'__esModule',{'value':!![]}),exports['SendMail']=void 0x0;const nodemailer_1=__importDefault(require(a539_0x24f024(0x83))),Setting_1=__importDefault(require('../../models/Setting')),Email_1=__importDefault(require('../../models/Email')),cron=__importStar(require(a539_0x24f024(0x8d))),moment_1=__importDefault(require(a539_0x24f024(0x9d))),SendMail=async(_0x30453b,_0x2765d5,_0x2ad338,_0x4b99be,_0x4b5f5a,_0x3e1176,_0x3c8f59)=>{const _0x264225=a539_0x24f024;try{const _0x5322af=await Setting_1[_0x264225(0x7b)][_0x264225(0x96)]({'where':{'companyId':_0x30453b,'key':_0x264225(0x99)}}),_0x4b0b63=await Setting_1[_0x264225(0x7b)][_0x264225(0x96)]({'where':{'companyId':_0x30453b,'key':'usersmtpauth'}}),_0x513c2f=await Setting_1[_0x264225(0x7b)][_0x264225(0x96)]({'where':{'companyId':_0x30453b,'key':_0x264225(0x85)}}),_0x3839ba=await Setting_1['default'][_0x264225(0x96)]({'where':{'companyId':_0x30453b,'key':_0x264225(0x8c)}}),_0x315e87=_0x5322af[_0x264225(0x7a)],_0x2e7255=_0x4b0b63['value'],_0x48f86e=_0x513c2f['value'],_0x1893ce=_0x3839ba['value'],_0x19c342=nodemailer_1['default']['createTransport']({'host':_0x315e87,'port':Number(_0x1893ce),'secure':![],'auth':{'user':_0x2e7255,'pass':_0x48f86e}});async function _0x5ed283(_0x58380f){const _0x48e802=_0x264225;try{const _0x48bf3d={'from':_0x2e7255,'to':_0x2765d5,'subject':_0x4b99be,'text':_0x4b5f5a};return await _0x19c342['sendMail'](_0x48bf3d),await Email_1['default']['create']({'sender':_0x2765d5,'subject':_0x4b99be,'message':_0x4b5f5a,'companyId':_0x30453b}),{'message':_0x48e802(0x81)};}catch(_0x440b23){console[_0x48e802(0x90)](_0x48e802(0x93),_0x440b23);throw new Error('Erro\x20ao\x20enviar\x20e-mail:\x20'+_0x440b23);}}if(_0x3c8f59)return cron[_0x264225(0x7d)](_0x3c8f59,()=>{const _0x8bcec8=_0x264225,_0x3d7108=(0x0,moment_1['default'])()[_0x8bcec8(0xa5)](0x1,'hour')[_0x8bcec8(0x8a)](_0x8bcec8(0x9a));_0x5ed283(_0x3d7108);}),{'message':_0x264225(0x91)};else{const _0x34269b=(0x0,moment_1[_0x264225(0x7b)])()[_0x264225(0xa5)](0x1,'hour')[_0x264225(0x8a)](_0x264225(0x9a));return _0x5ed283(_0x34269b),{'message':_0x264225(0x98)};}}catch(_0x1deea8){return console[_0x264225(0x90)]('Erro\x20ao\x20agendar\x20e-mail:',_0x1deea8),{'error':_0x264225(0xa3)+_0x1deea8['message']};}};exports['SendMail']=SendMail,exports[a539_0x24f024(0x7b)]=exports[a539_0x24f024(0xa4)];