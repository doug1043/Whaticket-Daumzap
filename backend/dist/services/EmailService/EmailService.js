'use strict';const a458_0x279c93=a458_0x3584;function a458_0x3584(_0x205daf,_0x4da6bf){const _0x240b75=a458_0x3612();return a458_0x3584=function(_0x3e9099,_0x3318f3){_0x3e9099=_0x3e9099-0x1b4;let _0x361245=_0x240b75[_0x3e9099];return _0x361245;},a458_0x3584(_0x205daf,_0x4da6bf);}function a458_0x3612(){const _0x2bc16f=['__createBinding','537214AmtXtJ','Erro\x20ao\x20agendar\x20e-mail:','smtpport','sendMail','__importStar','E-mail\x20enviado\x20imediatamente','schedule','default','clientsecretsmtpauth','E-mail\x20agendado\x20e\x20salvo\x20com\x20sucesso','272jxOMna','createTransport','Erro\x20ao\x20enviar\x20e-mail:','__setModuleDefault','moment','error','1471620Kllnzo','../../models/Email','call','(((.+)+)+)+$','YYYY-MM-DDTHH:mm','2442ruXBXi','hasOwnProperty','SendMail','53810IWlsqe','399GSnVPz','get','apply','11988BOdBVO','Erro\x20ao\x20agendar\x20e-mail:\x20','defineProperty','format','configurable','smtpauth','87642kgWAiT','value','toString','constructor','findOne','709080yihjMR','__esModule','message','getOwnPropertyNames','getOwnPropertyDescriptor','usersmtpauth','prototype','../../models/Setting','search','create','__importDefault','Erro\x20ao\x20enviar\x20e-mail:\x20'];a458_0x3612=function(){return _0x2bc16f;};return a458_0x3612();}(function(_0x49560f,_0x3655ad){const _0x5dae73=a458_0x3584,_0x5d1cf3=_0x49560f();while(!![]){try{const _0x159853=parseInt(_0x5dae73(0x1e7))/0x1+-parseInt(_0x5dae73(0x1cf))/0x2+parseInt(_0x5dae73(0x1bd))/0x3+parseInt(_0x5dae73(0x1df))/0x4+parseInt(_0x5dae73(0x1c2))/0x5+parseInt(_0x5dae73(0x1e4))/0x6*(parseInt(_0x5dae73(0x1b4))/0x7)+-parseInt(_0x5dae73(0x1d9))/0x8*(parseInt(_0x5dae73(0x1b7))/0x9);if(_0x159853===_0x3655ad)break;else _0x5d1cf3['push'](_0x5d1cf3['shift']());}catch(_0x2995f6){_0x5d1cf3['push'](_0x5d1cf3['shift']());}}}(a458_0x3612,0x49be1));var __createBinding=this&&this[a458_0x279c93(0x1ce)]||(Object[a458_0x279c93(0x1cb)]?function(_0x49df17,_0x1fcfdf,_0x426940,_0x4312bc){const _0x12fdf1=a458_0x279c93;if(_0x4312bc===undefined)_0x4312bc=_0x426940;var _0x1eec42=Object[_0x12fdf1(0x1c6)](_0x1fcfdf,_0x426940);(!_0x1eec42||(_0x12fdf1(0x1b5)in _0x1eec42?!_0x1fcfdf['__esModule']:_0x1eec42['writable']||_0x1eec42[_0x12fdf1(0x1bb)]))&&(_0x1eec42={'enumerable':!![],'get':function(){return _0x1fcfdf[_0x426940];}}),Object[_0x12fdf1(0x1b9)](_0x49df17,_0x4312bc,_0x1eec42);}:function(_0x39fb35,_0x3ba904,_0xd5698,_0x3aec18){if(_0x3aec18===undefined)_0x3aec18=_0xd5698;_0x39fb35[_0x3aec18]=_0x3ba904[_0xd5698];}),__setModuleDefault=this&&this[a458_0x279c93(0x1dc)]||(Object[a458_0x279c93(0x1cb)]?function(_0x5bcd17,_0x367819){const _0x10db2a=a458_0x279c93;Object[_0x10db2a(0x1b9)](_0x5bcd17,_0x10db2a(0x1d6),{'enumerable':!![],'value':_0x367819});}:function(_0x246958,_0x1875cf){const _0x42d123=a458_0x279c93;_0x246958[_0x42d123(0x1d6)]=_0x1875cf;}),__importStar=this&&this[a458_0x279c93(0x1d3)]||(function(){const _0x48a2c9=(function(){let _0x5a11b8=!![];return function(_0x47dc52,_0x485988){const _0x82e126=_0x5a11b8?function(){const _0x1c61f8=a458_0x3584;if(_0x485988){const _0x24d352=_0x485988[_0x1c61f8(0x1b6)](_0x47dc52,arguments);return _0x485988=null,_0x24d352;}}:function(){};return _0x5a11b8=![],_0x82e126;};}()),_0x24299a=_0x48a2c9(this,function(){const _0x47c480=a458_0x3584;return _0x24299a['toString']()[_0x47c480(0x1ca)]('(((.+)+)+)+$')[_0x47c480(0x1bf)]()[_0x47c480(0x1c0)](_0x24299a)['search'](_0x47c480(0x1e2));});_0x24299a();var _0x372c68=function(_0x565ece){const _0x145de5=a458_0x3584;return _0x372c68=Object[_0x145de5(0x1c5)]||function(_0x51dbed){const _0x5e968f=_0x145de5;var _0x3482fd=[];for(var _0x5f8b6a in _0x51dbed)if(Object[_0x5e968f(0x1c8)][_0x5e968f(0x1e5)][_0x5e968f(0x1e1)](_0x51dbed,_0x5f8b6a))_0x3482fd[_0x3482fd['length']]=_0x5f8b6a;return _0x3482fd;},_0x372c68(_0x565ece);};return function(_0x57b356){const _0xbcdcbd=a458_0x3584;if(_0x57b356&&_0x57b356[_0xbcdcbd(0x1c3)])return _0x57b356;var _0x4b53c4={};if(_0x57b356!=null){for(var _0x2ceac1=_0x372c68(_0x57b356),_0x3a8288=0x0;_0x3a8288<_0x2ceac1['length'];_0x3a8288++)if(_0x2ceac1[_0x3a8288]!==_0xbcdcbd(0x1d6))__createBinding(_0x4b53c4,_0x57b356,_0x2ceac1[_0x3a8288]);}return __setModuleDefault(_0x4b53c4,_0x57b356),_0x4b53c4;};}()),__importDefault=this&&this[a458_0x279c93(0x1cc)]||function(_0x28898a){return _0x28898a&&_0x28898a['__esModule']?_0x28898a:{'default':_0x28898a};};Object['defineProperty'](exports,a458_0x279c93(0x1c3),{'value':!![]}),exports[a458_0x279c93(0x1e6)]=void 0x0;const nodemailer_1=__importDefault(require('nodemailer')),Setting_1=__importDefault(require(a458_0x279c93(0x1c9))),Email_1=__importDefault(require(a458_0x279c93(0x1e0))),cron=__importStar(require('node-cron')),moment_1=__importDefault(require(a458_0x279c93(0x1dd))),SendMail=async(_0x581e05,_0x3ff268,_0x22fd4f,_0x5e85d9,_0x2c4806,_0x5517db,_0xfc5f92)=>{const _0x3441be=a458_0x279c93;try{const _0x2d7efb=await Setting_1[_0x3441be(0x1d6)]['findOne']({'where':{'companyId':_0x581e05,'key':_0x3441be(0x1bc)}}),_0x55049a=await Setting_1[_0x3441be(0x1d6)][_0x3441be(0x1c1)]({'where':{'companyId':_0x581e05,'key':_0x3441be(0x1c7)}}),_0x5e6ae0=await Setting_1[_0x3441be(0x1d6)]['findOne']({'where':{'companyId':_0x581e05,'key':_0x3441be(0x1d7)}}),_0x246840=await Setting_1['default'][_0x3441be(0x1c1)]({'where':{'companyId':_0x581e05,'key':_0x3441be(0x1d1)}}),_0x3924ca=_0x2d7efb[_0x3441be(0x1be)],_0x46e562=_0x55049a[_0x3441be(0x1be)],_0x520824=_0x5e6ae0[_0x3441be(0x1be)],_0x1a2648=_0x246840[_0x3441be(0x1be)],_0x2bae47=nodemailer_1['default'][_0x3441be(0x1da)]({'host':_0x3924ca,'port':Number(_0x1a2648),'secure':![],'auth':{'user':_0x46e562,'pass':_0x520824}});async function _0x53b0cb(_0x45e732){const _0x5a5695=_0x3441be;try{const _0x569473={'from':_0x46e562,'to':_0x3ff268,'subject':_0x5e85d9,'text':_0x2c4806};return await _0x2bae47[_0x5a5695(0x1d2)](_0x569473),await Email_1[_0x5a5695(0x1d6)][_0x5a5695(0x1cb)]({'sender':_0x3ff268,'subject':_0x5e85d9,'message':_0x2c4806,'companyId':_0x581e05}),{'message':_0x5a5695(0x1d8)};}catch(_0x262646){console['error'](_0x5a5695(0x1db),_0x262646);throw new Error(_0x5a5695(0x1cd)+_0x262646);}}if(_0xfc5f92)return cron[_0x3441be(0x1d5)](_0xfc5f92,()=>{const _0x24d7f7=_0x3441be,_0x570934=(0x0,moment_1['default'])()['add'](0x1,'hour')[_0x24d7f7(0x1ba)](_0x24d7f7(0x1e3));_0x53b0cb(_0x570934);}),{'message':'Agendamento\x20de\x20e-mail\x20realizado\x20com\x20sucesso'};else{const _0x3bfe45=(0x0,moment_1[_0x3441be(0x1d6)])()['add'](0x1,'hour')['format'](_0x3441be(0x1e3));return _0x53b0cb(_0x3bfe45),{'message':_0x3441be(0x1d4)};}}catch(_0x22cf50){return console[_0x3441be(0x1de)](_0x3441be(0x1d0),_0x22cf50),{'error':_0x3441be(0x1b8)+_0x22cf50[_0x3441be(0x1c4)]};}};exports[a458_0x279c93(0x1e6)]=SendMail,exports[a458_0x279c93(0x1d6)]=exports[a458_0x279c93(0x1e6)];