'use strict';function a540_0x2d02(){const _0x412478=['__esModule','E-mail\x20agendado\x20e\x20salvo\x20com\x20sucesso','error','__importDefault','constructor','clientsecretsmtpauth','3416273eZWIxE','14SzFhlP','smtpauth','2068578DgoEER','Erro\x20ao\x20enviar\x20e-mail:\x20','nodemailer','hour','getOwnPropertyNames','defineProperty','findOne','length','add','configurable','toString','value','create','search','205620SMQkzS','sendMail','3707344gjgAAB','get','schedule','hasOwnProperty','YYYY-MM-DDTHH:mm','5AcPJqt','__importStar','95382pWmJFc','apply','format','Erro\x20ao\x20agendar\x20e-mail:','Erro\x20ao\x20enviar\x20e-mail:','default','E-mail\x20enviado\x20imediatamente','moment','583Dqcskv','SendMail','Agendamento\x20de\x20e-mail\x20realizado\x20com\x20sucesso','writable','usersmtpauth','48845hjkTeg','(((.+)+)+)+$','156219cOmuHe','../../models/Email','8FzBNff'];a540_0x2d02=function(){return _0x412478;};return a540_0x2d02();}const a540_0x1984c8=a540_0x3896;(function(_0x308e78,_0x56ab90){const _0x1eaba8=a540_0x3896,_0x37ca47=_0x308e78();while(!![]){try{const _0x3e5e6a=parseInt(_0x1eaba8(0xc0))/0x1*(-parseInt(_0x1eaba8(0x9a))/0x2)+parseInt(_0x1eaba8(0x90))/0x3+-parseInt(_0x1eaba8(0xac))/0x4+parseInt(_0x1eaba8(0xb1))/0x5*(-parseInt(_0x1eaba8(0xb3))/0x6)+-parseInt(_0x1eaba8(0x99))/0x7*(-parseInt(_0x1eaba8(0x92))/0x8)+parseInt(_0x1eaba8(0x9c))/0x9+parseInt(_0x1eaba8(0xaa))/0xa*(parseInt(_0x1eaba8(0xbb))/0xb);if(_0x3e5e6a===_0x56ab90)break;else _0x37ca47['push'](_0x37ca47['shift']());}catch(_0x292301){_0x37ca47['push'](_0x37ca47['shift']());}}}(a540_0x2d02,0x8c674));var __createBinding=this&&this['__createBinding']||(Object[a540_0x1984c8(0xa8)]?function(_0x5105db,_0x14b44a,_0x3eec3f,_0x45cdd8){const _0x228263=a540_0x1984c8;if(_0x45cdd8===undefined)_0x45cdd8=_0x3eec3f;var _0x4142f3=Object['getOwnPropertyDescriptor'](_0x14b44a,_0x3eec3f);(!_0x4142f3||(_0x228263(0xad)in _0x4142f3?!_0x14b44a['__esModule']:_0x4142f3[_0x228263(0xbe)]||_0x4142f3[_0x228263(0xa5)]))&&(_0x4142f3={'enumerable':!![],'get':function(){return _0x14b44a[_0x3eec3f];}}),Object['defineProperty'](_0x5105db,_0x45cdd8,_0x4142f3);}:function(_0x545a0f,_0x1e835f,_0x3cc17e,_0x293718){if(_0x293718===undefined)_0x293718=_0x3cc17e;_0x545a0f[_0x293718]=_0x1e835f[_0x3cc17e];}),__setModuleDefault=this&&this['__setModuleDefault']||(Object[a540_0x1984c8(0xa8)]?function(_0xb6b441,_0x2186a1){const _0xa627b4=a540_0x1984c8;Object['defineProperty'](_0xb6b441,_0xa627b4(0xb8),{'enumerable':!![],'value':_0x2186a1});}:function(_0x365927,_0x1b276c){const _0x52195a=a540_0x1984c8;_0x365927[_0x52195a(0xb8)]=_0x1b276c;}),__importStar=this&&this[a540_0x1984c8(0xb2)]||(function(){const _0x59ec6a=(function(){let _0x3a1f21=!![];return function(_0x565558,_0x5fb11d){const _0x34aeff=_0x3a1f21?function(){const _0x31c38c=a540_0x3896;if(_0x5fb11d){const _0x22f4d0=_0x5fb11d[_0x31c38c(0xb4)](_0x565558,arguments);return _0x5fb11d=null,_0x22f4d0;}}:function(){};return _0x3a1f21=![],_0x34aeff;};}()),_0xc72de=_0x59ec6a(this,function(){const _0x1a7df7=a540_0x3896;return _0xc72de[_0x1a7df7(0xa6)]()[_0x1a7df7(0xa9)]('(((.+)+)+)+$')[_0x1a7df7(0xa6)]()[_0x1a7df7(0x97)](_0xc72de)['search'](_0x1a7df7(0xc1));});_0xc72de();var _0x4353c0=function(_0x1ab382){const _0x4d81ab=a540_0x3896;return _0x4353c0=Object[_0x4d81ab(0xa0)]||function(_0x3c0352){const _0x18b41d=_0x4d81ab;var _0x13b094=[];for(var _0x7c2a03 in _0x3c0352)if(Object['prototype'][_0x18b41d(0xaf)]['call'](_0x3c0352,_0x7c2a03))_0x13b094[_0x13b094[_0x18b41d(0xa3)]]=_0x7c2a03;return _0x13b094;},_0x4353c0(_0x1ab382);};return function(_0x49e074){const _0x2ab225=a540_0x3896;if(_0x49e074&&_0x49e074[_0x2ab225(0x93)])return _0x49e074;var _0x1ebc83={};if(_0x49e074!=null){for(var _0x1d1dfc=_0x4353c0(_0x49e074),_0x3c03f5=0x0;_0x3c03f5<_0x1d1dfc[_0x2ab225(0xa3)];_0x3c03f5++)if(_0x1d1dfc[_0x3c03f5]!==_0x2ab225(0xb8))__createBinding(_0x1ebc83,_0x49e074,_0x1d1dfc[_0x3c03f5]);}return __setModuleDefault(_0x1ebc83,_0x49e074),_0x1ebc83;};}()),__importDefault=this&&this[a540_0x1984c8(0x96)]||function(_0x558077){const _0x36cae4=a540_0x1984c8;return _0x558077&&_0x558077[_0x36cae4(0x93)]?_0x558077:{'default':_0x558077};};function a540_0x3896(_0x23abdd,_0x220bc5){const _0x496665=a540_0x2d02();return a540_0x3896=function(_0x311854,_0x1da3c4){_0x311854=_0x311854-0x90;let _0x2d026a=_0x496665[_0x311854];return _0x2d026a;},a540_0x3896(_0x23abdd,_0x220bc5);}Object[a540_0x1984c8(0xa1)](exports,a540_0x1984c8(0x93),{'value':!![]}),exports[a540_0x1984c8(0xbc)]=void 0x0;const nodemailer_1=__importDefault(require(a540_0x1984c8(0x9e))),Setting_1=__importDefault(require('../../models/Setting')),Email_1=__importDefault(require(a540_0x1984c8(0x91))),cron=__importStar(require('node-cron')),moment_1=__importDefault(require(a540_0x1984c8(0xba))),SendMail=async(_0x4d8423,_0xc923c9,_0x33f8cd,_0x3242f5,_0x248128,_0x2229a9,_0x35962f)=>{const _0xd4a9e0=a540_0x1984c8;try{const _0x50d4ea=await Setting_1[_0xd4a9e0(0xb8)][_0xd4a9e0(0xa2)]({'where':{'companyId':_0x4d8423,'key':_0xd4a9e0(0x9b)}}),_0x1e07cc=await Setting_1['default'][_0xd4a9e0(0xa2)]({'where':{'companyId':_0x4d8423,'key':_0xd4a9e0(0xbf)}}),_0x2eddbe=await Setting_1[_0xd4a9e0(0xb8)]['findOne']({'where':{'companyId':_0x4d8423,'key':_0xd4a9e0(0x98)}}),_0xe00835=await Setting_1[_0xd4a9e0(0xb8)][_0xd4a9e0(0xa2)]({'where':{'companyId':_0x4d8423,'key':'smtpport'}}),_0xc5e18a=_0x50d4ea[_0xd4a9e0(0xa7)],_0x5c3341=_0x1e07cc[_0xd4a9e0(0xa7)],_0x14b618=_0x2eddbe[_0xd4a9e0(0xa7)],_0x2fe7df=_0xe00835[_0xd4a9e0(0xa7)],_0x441d33=nodemailer_1[_0xd4a9e0(0xb8)]['createTransport']({'host':_0xc5e18a,'port':Number(_0x2fe7df),'secure':![],'auth':{'user':_0x5c3341,'pass':_0x14b618}});async function _0x487057(_0x3ee76a){const _0x25aab0=_0xd4a9e0;try{const _0x312b6c={'from':_0x5c3341,'to':_0xc923c9,'subject':_0x3242f5,'text':_0x248128};return await _0x441d33[_0x25aab0(0xab)](_0x312b6c),await Email_1['default'][_0x25aab0(0xa8)]({'sender':_0xc923c9,'subject':_0x3242f5,'message':_0x248128,'companyId':_0x4d8423}),{'message':_0x25aab0(0x94)};}catch(_0x43a18d){console[_0x25aab0(0x95)](_0x25aab0(0xb7),_0x43a18d);throw new Error(_0x25aab0(0x9d)+_0x43a18d);}}if(_0x35962f)return cron[_0xd4a9e0(0xae)](_0x35962f,()=>{const _0x30c882=_0xd4a9e0,_0x24f4c7=(0x0,moment_1[_0x30c882(0xb8)])()[_0x30c882(0xa4)](0x1,_0x30c882(0x9f))[_0x30c882(0xb5)](_0x30c882(0xb0));_0x487057(_0x24f4c7);}),{'message':_0xd4a9e0(0xbd)};else{const _0x41246b=(0x0,moment_1['default'])()[_0xd4a9e0(0xa4)](0x1,_0xd4a9e0(0x9f))[_0xd4a9e0(0xb5)](_0xd4a9e0(0xb0));return _0x487057(_0x41246b),{'message':_0xd4a9e0(0xb9)};}}catch(_0x4be576){return console[_0xd4a9e0(0x95)](_0xd4a9e0(0xb6),_0x4be576),{'error':'Erro\x20ao\x20agendar\x20e-mail:\x20'+_0x4be576['message']};}};exports['SendMail']=SendMail,exports[a540_0x1984c8(0xb8)]=exports[a540_0x1984c8(0xbc)];