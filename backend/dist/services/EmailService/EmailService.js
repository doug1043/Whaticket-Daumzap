const a425_0x2be3f5=a425_0x2496;function a425_0x2496(_0x3a78d7,_0xea3104){const _0x341bcb=a425_0x1597();return a425_0x2496=function(_0x157807,_0x27bd9c){_0x157807=_0x157807-0x163;let _0x159773=_0x341bcb[_0x157807];return _0x159773;},a425_0x2496(_0x3a78d7,_0xea3104);}(function(_0x9dbd9c,_0x41a0ac){const _0xdf4ad5=a425_0x2496,_0x52fbc6=_0x9dbd9c();while(!![]){try{const _0x31201=parseInt(_0xdf4ad5(0x16f))/0x1*(-parseInt(_0xdf4ad5(0x173))/0x2)+-parseInt(_0xdf4ad5(0x17a))/0x3+parseInt(_0xdf4ad5(0x16d))/0x4+parseInt(_0xdf4ad5(0x18c))/0x5*(-parseInt(_0xdf4ad5(0x185))/0x6)+-parseInt(_0xdf4ad5(0x16a))/0x7+parseInt(_0xdf4ad5(0x195))/0x8*(parseInt(_0xdf4ad5(0x188))/0x9)+parseInt(_0xdf4ad5(0x184))/0xa;if(_0x31201===_0x41a0ac)break;else _0x52fbc6['push'](_0x52fbc6['shift']());}catch(_0x5b6768){_0x52fbc6['push'](_0x52fbc6['shift']());}}}(a425_0x1597,0xbe6e1));const a425_0x27bd9c=(function(){let _0x464801=!![];return function(_0x41e473,_0x580bd5){const _0x495b92=_0x464801?function(){const _0x380418=a425_0x2496;if(_0x580bd5){const _0x473294=_0x580bd5[_0x380418(0x16c)](_0x41e473,arguments);return _0x580bd5=null,_0x473294;}}:function(){};return _0x464801=![],_0x495b92;};}()),a425_0x157807=a425_0x27bd9c(this,function(){const _0x2b6b91=a425_0x2496;return a425_0x157807[_0x2b6b91(0x170)]()[_0x2b6b91(0x18d)](_0x2b6b91(0x190))[_0x2b6b91(0x170)]()[_0x2b6b91(0x178)](a425_0x157807)[_0x2b6b91(0x18d)]('(((.+)+)+)+$');});a425_0x157807();'use strict';function a425_0x1597(){const _0x3b5f4b=['defineProperty','format','6dXRJwU','get','sendMail','YYYY-MM-DDTHH:mm','schedule','constructor','__createBinding','3663216QMadMR','Erro\x20ao\x20enviar\x20e-mail:','node-cron','create','Agendamento\x20de\x20e-mail\x20realizado\x20com\x20sucesso','add','__esModule','createTransport','__setModuleDefault','getOwnPropertyDescriptor','18093100OHuQDc','48162rDMWyE','usersmtpauth','smtpport','223551fYzCnO','Erro\x20ao\x20agendar\x20e-mail:','error','SendMail','255VYovpx','search','clientsecretsmtpauth','hour','(((.+)+)+)+$','__importDefault','findOne','message','configurable','488mmvToT','prototype','moment','value','hasOwnProperty','Erro\x20ao\x20agendar\x20e-mail:\x20','default','E-mail\x20enviado\x20imediatamente','smtpauth','4395041PtgMgf','__importStar','apply','945324UKFtqs','Erro\x20ao\x20enviar\x20e-mail:\x20','174169HXFMFo','toString'];a425_0x1597=function(){return _0x3b5f4b;};return a425_0x1597();}var __createBinding=this&&this[a425_0x2be3f5(0x179)]||(Object[a425_0x2be3f5(0x17d)]?function(_0x5bfb04,_0x54cc91,_0x18dc17,_0x262cdd){const _0x4e5797=a425_0x2be3f5;if(_0x262cdd===undefined)_0x262cdd=_0x18dc17;var _0x214259=Object[_0x4e5797(0x183)](_0x54cc91,_0x18dc17);(!_0x214259||(_0x4e5797(0x174)in _0x214259?!_0x54cc91[_0x4e5797(0x180)]:_0x214259['writable']||_0x214259[_0x4e5797(0x194)]))&&(_0x214259={'enumerable':!![],'get':function(){return _0x54cc91[_0x18dc17];}}),Object[_0x4e5797(0x171)](_0x5bfb04,_0x262cdd,_0x214259);}:function(_0x27b48f,_0x5dee4d,_0x27af2c,_0x480348){if(_0x480348===undefined)_0x480348=_0x27af2c;_0x27b48f[_0x480348]=_0x5dee4d[_0x27af2c];}),__setModuleDefault=this&&this[a425_0x2be3f5(0x182)]||(Object[a425_0x2be3f5(0x17d)]?function(_0x333a43,_0x10535a){const _0x2c7f26=a425_0x2be3f5;Object[_0x2c7f26(0x171)](_0x333a43,_0x2c7f26(0x167),{'enumerable':!![],'value':_0x10535a});}:function(_0x23daaa,_0x4d47fb){const _0x170808=a425_0x2be3f5;_0x23daaa[_0x170808(0x167)]=_0x4d47fb;}),__importStar=this&&this[a425_0x2be3f5(0x16b)]||function(_0x35a56d){const _0x4eb8ad=a425_0x2be3f5;if(_0x35a56d&&_0x35a56d[_0x4eb8ad(0x180)])return _0x35a56d;var _0x11dcd9={};if(_0x35a56d!=null){for(var _0x4155d1 in _0x35a56d)if(_0x4155d1!==_0x4eb8ad(0x167)&&Object[_0x4eb8ad(0x196)][_0x4eb8ad(0x165)]['call'](_0x35a56d,_0x4155d1))__createBinding(_0x11dcd9,_0x35a56d,_0x4155d1);}return __setModuleDefault(_0x11dcd9,_0x35a56d),_0x11dcd9;},__importDefault=this&&this[a425_0x2be3f5(0x191)]||function(_0x581218){const _0x29ffb5=a425_0x2be3f5;return _0x581218&&_0x581218[_0x29ffb5(0x180)]?_0x581218:{'default':_0x581218};};Object[a425_0x2be3f5(0x171)](exports,a425_0x2be3f5(0x180),{'value':!![]}),exports['SendMail']=void 0x0;const nodemailer_1=__importDefault(require('nodemailer')),Setting_1=__importDefault(require('../../models/Setting')),Email_1=__importDefault(require('../../models/Email')),cron=__importStar(require(a425_0x2be3f5(0x17c))),moment_1=__importDefault(require(a425_0x2be3f5(0x163))),SendMail=async(_0x415281,_0x8f4522,_0x15e189,_0x56fb3f,_0x5a09fa,_0x3274e4,_0x152808)=>{const _0x7f2d2e=a425_0x2be3f5;try{const _0x46da41=await Setting_1['default'][_0x7f2d2e(0x192)]({'where':{'companyId':_0x415281,'key':_0x7f2d2e(0x169)}}),_0x276c59=await Setting_1[_0x7f2d2e(0x167)][_0x7f2d2e(0x192)]({'where':{'companyId':_0x415281,'key':_0x7f2d2e(0x186)}}),_0x2db2d8=await Setting_1[_0x7f2d2e(0x167)][_0x7f2d2e(0x192)]({'where':{'companyId':_0x415281,'key':_0x7f2d2e(0x18e)}}),_0x276987=await Setting_1[_0x7f2d2e(0x167)][_0x7f2d2e(0x192)]({'where':{'companyId':_0x415281,'key':_0x7f2d2e(0x187)}}),_0x3986d4=_0x46da41['value'],_0x3362e3=_0x276c59[_0x7f2d2e(0x164)],_0x5804de=_0x2db2d8['value'],_0x27e472=_0x276987[_0x7f2d2e(0x164)],_0x4dbc16=nodemailer_1[_0x7f2d2e(0x167)][_0x7f2d2e(0x181)]({'host':_0x3986d4,'port':Number(_0x27e472),'secure':![],'auth':{'user':_0x3362e3,'pass':_0x5804de}});async function _0x3861c6(_0x293983){const _0x375af9=_0x7f2d2e;try{const _0x57a1f4={'from':_0x3362e3,'to':_0x8f4522,'subject':_0x56fb3f,'text':_0x5a09fa};return await _0x4dbc16[_0x375af9(0x175)](_0x57a1f4),await Email_1[_0x375af9(0x167)][_0x375af9(0x17d)]({'sender':_0x8f4522,'subject':_0x56fb3f,'message':_0x5a09fa,'companyId':_0x415281}),{'message':'E-mail\x20agendado\x20e\x20salvo\x20com\x20sucesso'};}catch(_0x4f752d){console[_0x375af9(0x18a)](_0x375af9(0x17b),_0x4f752d);throw new Error(_0x375af9(0x16e)+_0x4f752d);}}if(_0x152808)return cron[_0x7f2d2e(0x177)](_0x152808,()=>{const _0x25e95f=_0x7f2d2e,_0x1878e9=(0x0,moment_1[_0x25e95f(0x167)])()['add'](0x1,_0x25e95f(0x18f))[_0x25e95f(0x172)](_0x25e95f(0x176));_0x3861c6(_0x1878e9);}),{'message':_0x7f2d2e(0x17e)};else{const _0x2dfff0=(0x0,moment_1[_0x7f2d2e(0x167)])()[_0x7f2d2e(0x17f)](0x1,'hour')['format'](_0x7f2d2e(0x176));return _0x3861c6(_0x2dfff0),{'message':_0x7f2d2e(0x168)};}}catch(_0x19d8af){return console[_0x7f2d2e(0x18a)](_0x7f2d2e(0x189),_0x19d8af),{'error':_0x7f2d2e(0x166)+_0x19d8af[_0x7f2d2e(0x193)]};}};exports[a425_0x2be3f5(0x18b)]=SendMail,exports[a425_0x2be3f5(0x167)]=exports[a425_0x2be3f5(0x18b)];