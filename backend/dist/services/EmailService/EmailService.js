'use strict';function a453_0x1833(_0x56eac7,_0x5b72ab){const _0x4929c2=a453_0x48cd();return a453_0x1833=function(_0x3f1fb0,_0x26debb){_0x3f1fb0=_0x3f1fb0-0x126;let _0x48cddd=_0x4929c2[_0x3f1fb0];return _0x48cddd;},a453_0x1833(_0x56eac7,_0x5b72ab);}function a453_0x48cd(){const _0x5501c6=['error','SendMail','18PNDnML','../../models/Setting','length','3319715pUkCLB','apply','2848008nyjCEF','hasOwnProperty','4ljYINU','getOwnPropertyDescriptor','writable','call','nodemailer','Erro\x20ao\x20enviar\x20e-mail:','create','get','value','smtpauth','Erro\x20ao\x20agendar\x20e-mail:','schedule','add','findOne','default','format','(((.+)+)+)+$','hour','3663465BuTabS','__setModuleDefault','813302vLnPDg','smtpport','defineProperty','1199767lVRcSG','__importStar','toString','2159335lhCYqt','constructor','E-mail\x20enviado\x20imediatamente','usersmtpauth','__esModule','776496svGQtV','__createBinding','Erro\x20ao\x20enviar\x20e-mail:\x20','Erro\x20ao\x20agendar\x20e-mail:\x20','prototype','YYYY-MM-DDTHH:mm','search','../../models/Email','node-cron'];a453_0x48cd=function(){return _0x5501c6;};return a453_0x48cd();}const a453_0x559bd0=a453_0x1833;(function(_0x9c37ff,_0x3951f2){const _0x13cc7c=a453_0x1833,_0x386cf7=_0x9c37ff();while(!![]){try{const _0x49f9aa=-parseInt(_0x13cc7c(0x152))/0x1+parseInt(_0x13cc7c(0x14f))/0x2+parseInt(_0x13cc7c(0x14d))/0x3+parseInt(_0x13cc7c(0x13b))/0x4*(parseInt(_0x13cc7c(0x155))/0x5)+parseInt(_0x13cc7c(0x139))/0x6+-parseInt(_0x13cc7c(0x137))/0x7+-parseInt(_0x13cc7c(0x129))/0x8*(parseInt(_0x13cc7c(0x134))/0x9);if(_0x49f9aa===_0x3951f2)break;else _0x386cf7['push'](_0x386cf7['shift']());}catch(_0x559a1d){_0x386cf7['push'](_0x386cf7['shift']());}}}(a453_0x48cd,0xa2a5d));var __createBinding=this&&this[a453_0x559bd0(0x12a)]||(Object['create']?function(_0x5c4bde,_0x258d6b,_0x542347,_0x406cc5){const _0x5a0963=a453_0x559bd0;if(_0x406cc5===undefined)_0x406cc5=_0x542347;var _0x3f592d=Object[_0x5a0963(0x13c)](_0x258d6b,_0x542347);(!_0x3f592d||(_0x5a0963(0x142)in _0x3f592d?!_0x258d6b[_0x5a0963(0x128)]:_0x3f592d[_0x5a0963(0x13d)]||_0x3f592d['configurable']))&&(_0x3f592d={'enumerable':!![],'get':function(){return _0x258d6b[_0x542347];}}),Object[_0x5a0963(0x151)](_0x5c4bde,_0x406cc5,_0x3f592d);}:function(_0x5c7328,_0x3cf0cc,_0x389405,_0x1ee19a){if(_0x1ee19a===undefined)_0x1ee19a=_0x389405;_0x5c7328[_0x1ee19a]=_0x3cf0cc[_0x389405];}),__setModuleDefault=this&&this[a453_0x559bd0(0x14e)]||(Object[a453_0x559bd0(0x141)]?function(_0x171738,_0x491b4a){const _0xf00016=a453_0x559bd0;Object[_0xf00016(0x151)](_0x171738,_0xf00016(0x149),{'enumerable':!![],'value':_0x491b4a});}:function(_0x1c70be,_0x4adf65){const _0x38fbb0=a453_0x559bd0;_0x1c70be[_0x38fbb0(0x149)]=_0x4adf65;}),__importStar=this&&this[a453_0x559bd0(0x153)]||(function(){const _0x4ee40d=(function(){let _0x344fdd=!![];return function(_0x35cd52,_0x22e64e){const _0x149694=_0x344fdd?function(){const _0x2eee51=a453_0x1833;if(_0x22e64e){const _0x18e3a7=_0x22e64e[_0x2eee51(0x138)](_0x35cd52,arguments);return _0x22e64e=null,_0x18e3a7;}}:function(){};return _0x344fdd=![],_0x149694;};}()),_0x3816f8=_0x4ee40d(this,function(){const _0x427074=a453_0x1833;return _0x3816f8[_0x427074(0x154)]()[_0x427074(0x12f)](_0x427074(0x14b))[_0x427074(0x154)]()[_0x427074(0x156)](_0x3816f8)[_0x427074(0x12f)](_0x427074(0x14b));});_0x3816f8();var _0x2670c7=function(_0x550e38){return _0x2670c7=Object['getOwnPropertyNames']||function(_0x12ead8){const _0x56b3fd=a453_0x1833;var _0x1662d3=[];for(var _0x5a9ef2 in _0x12ead8)if(Object[_0x56b3fd(0x12d)][_0x56b3fd(0x13a)][_0x56b3fd(0x13e)](_0x12ead8,_0x5a9ef2))_0x1662d3[_0x1662d3['length']]=_0x5a9ef2;return _0x1662d3;},_0x2670c7(_0x550e38);};return function(_0x29ad84){const _0x2d1240=a453_0x1833;if(_0x29ad84&&_0x29ad84[_0x2d1240(0x128)])return _0x29ad84;var _0x2499a3={};if(_0x29ad84!=null){for(var _0x48bb47=_0x2670c7(_0x29ad84),_0x58ec66=0x0;_0x58ec66<_0x48bb47[_0x2d1240(0x136)];_0x58ec66++)if(_0x48bb47[_0x58ec66]!==_0x2d1240(0x149))__createBinding(_0x2499a3,_0x29ad84,_0x48bb47[_0x58ec66]);}return __setModuleDefault(_0x2499a3,_0x29ad84),_0x2499a3;};}()),__importDefault=this&&this['__importDefault']||function(_0x3b3efa){const _0x3b20ec=a453_0x559bd0;return _0x3b3efa&&_0x3b3efa[_0x3b20ec(0x128)]?_0x3b3efa:{'default':_0x3b3efa};};Object[a453_0x559bd0(0x151)](exports,a453_0x559bd0(0x128),{'value':!![]}),exports['SendMail']=void 0x0;const nodemailer_1=__importDefault(require(a453_0x559bd0(0x13f))),Setting_1=__importDefault(require(a453_0x559bd0(0x135))),Email_1=__importDefault(require(a453_0x559bd0(0x130))),cron=__importStar(require(a453_0x559bd0(0x131))),moment_1=__importDefault(require('moment')),SendMail=async(_0x217e06,_0x5d0955,_0x3ebf97,_0x28bd7b,_0x38db6a,_0x31f2ba,_0x2e7f2c)=>{const _0x35e961=a453_0x559bd0;try{const _0xa8cdcb=await Setting_1['default'][_0x35e961(0x148)]({'where':{'companyId':_0x217e06,'key':_0x35e961(0x144)}}),_0x12e884=await Setting_1[_0x35e961(0x149)][_0x35e961(0x148)]({'where':{'companyId':_0x217e06,'key':_0x35e961(0x127)}}),_0x226d0b=await Setting_1[_0x35e961(0x149)][_0x35e961(0x148)]({'where':{'companyId':_0x217e06,'key':'clientsecretsmtpauth'}}),_0x20246b=await Setting_1[_0x35e961(0x149)][_0x35e961(0x148)]({'where':{'companyId':_0x217e06,'key':_0x35e961(0x150)}}),_0xb5dec0=_0xa8cdcb['value'],_0x263b08=_0x12e884[_0x35e961(0x143)],_0x3ceb56=_0x226d0b[_0x35e961(0x143)],_0xdf5a73=_0x20246b[_0x35e961(0x143)],_0x16c19d=nodemailer_1[_0x35e961(0x149)]['createTransport']({'host':_0xb5dec0,'port':Number(_0xdf5a73),'secure':![],'auth':{'user':_0x263b08,'pass':_0x3ceb56}});async function _0x44c09b(_0x15512e){const _0x3a866b=_0x35e961;try{const _0x58856a={'from':_0x263b08,'to':_0x5d0955,'subject':_0x28bd7b,'text':_0x38db6a};return await _0x16c19d['sendMail'](_0x58856a),await Email_1[_0x3a866b(0x149)][_0x3a866b(0x141)]({'sender':_0x5d0955,'subject':_0x28bd7b,'message':_0x38db6a,'companyId':_0x217e06}),{'message':'E-mail\x20agendado\x20e\x20salvo\x20com\x20sucesso'};}catch(_0x55bf71){console[_0x3a866b(0x132)](_0x3a866b(0x140),_0x55bf71);throw new Error(_0x3a866b(0x12b)+_0x55bf71);}}if(_0x2e7f2c)return cron[_0x35e961(0x146)](_0x2e7f2c,()=>{const _0x173a72=_0x35e961,_0xaa269b=(0x0,moment_1['default'])()[_0x173a72(0x147)](0x1,_0x173a72(0x14c))[_0x173a72(0x14a)]('YYYY-MM-DDTHH:mm');_0x44c09b(_0xaa269b);}),{'message':'Agendamento\x20de\x20e-mail\x20realizado\x20com\x20sucesso'};else{const _0x3e93bf=(0x0,moment_1[_0x35e961(0x149)])()['add'](0x1,'hour')[_0x35e961(0x14a)](_0x35e961(0x12e));return _0x44c09b(_0x3e93bf),{'message':_0x35e961(0x126)};}}catch(_0x4cfe5d){return console[_0x35e961(0x132)](_0x35e961(0x145),_0x4cfe5d),{'error':_0x35e961(0x12c)+_0x4cfe5d['message']};}};exports[a453_0x559bd0(0x133)]=SendMail,exports[a453_0x559bd0(0x149)]=exports[a453_0x559bd0(0x133)];