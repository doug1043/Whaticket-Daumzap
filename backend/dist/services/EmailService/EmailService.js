'use strict';function a458_0x2d6e(){const _0x11a728=['nodemailer','smtpport','__createBinding','configurable','error','add','(((.+)+)+)+$','getOwnPropertyDescriptor','__importStar','Agendamento\x20de\x20e-mail\x20realizado\x20com\x20sucesso','getOwnPropertyNames','Erro\x20ao\x20agendar\x20e-mail:','findOne','29779JmkojY','createTransport','__esModule','apply','__setModuleDefault','smtpauth','2827305egLbuv','1791726pwRkhN','node-cron','7jRibqU','value','message','default','clientsecretsmtpauth','35eugfbG','../../models/Email','Erro\x20ao\x20enviar\x20e-mail:','SendMail','1633022aioTbH','create','sendMail','hour','Erro\x20ao\x20enviar\x20e-mail:\x20','moment','schedule','958524rOBcNp','defineProperty','27816nokrWW','E-mail\x20enviado\x20imediatamente','length','format','Erro\x20ao\x20agendar\x20e-mail:\x20','get','YYYY-MM-DDTHH:mm','__importDefault','285872GurpFL'];a458_0x2d6e=function(){return _0x11a728;};return a458_0x2d6e();}function a458_0x58cf(_0xcc02fc,_0x465abc){const _0x346918=a458_0x2d6e();return a458_0x58cf=function(_0x3fd468,_0x23cc4d){_0x3fd468=_0x3fd468-0x1ce;let _0x2d6ee8=_0x346918[_0x3fd468];return _0x2d6ee8;},a458_0x58cf(_0xcc02fc,_0x465abc);}const a458_0x15d827=a458_0x58cf;(function(_0xf927cb,_0x13e960){const _0x38148a=a458_0x58cf,_0x18af81=_0xf927cb();while(!![]){try{const _0x523adf=-parseInt(_0x38148a(0x1f7))/0x1+-parseInt(_0x38148a(0x1d8))/0x2+parseInt(_0x38148a(0x1df))/0x3+-parseInt(_0x38148a(0x1e9))/0x4*(-parseInt(_0x38148a(0x1d4))/0x5)+parseInt(_0x38148a(0x1fe))/0x6*(parseInt(_0x38148a(0x1cf))/0x7)+parseInt(_0x38148a(0x1e1))/0x8+parseInt(_0x38148a(0x1fd))/0x9;if(_0x523adf===_0x13e960)break;else _0x18af81['push'](_0x18af81['shift']());}catch(_0x37cf9b){_0x18af81['push'](_0x18af81['shift']());}}}(a458_0x2d6e,0x8ffa9));var __createBinding=this&&this[a458_0x15d827(0x1ec)]||(Object[a458_0x15d827(0x1d9)]?function(_0x3318ae,_0x451f47,_0x217701,_0x3996e7){const _0x5c0ed=a458_0x15d827;if(_0x3996e7===undefined)_0x3996e7=_0x217701;var _0x1c568f=Object[_0x5c0ed(0x1f1)](_0x451f47,_0x217701);(!_0x1c568f||(_0x5c0ed(0x1e6)in _0x1c568f?!_0x451f47[_0x5c0ed(0x1f9)]:_0x1c568f['writable']||_0x1c568f[_0x5c0ed(0x1ed)]))&&(_0x1c568f={'enumerable':!![],'get':function(){return _0x451f47[_0x217701];}}),Object[_0x5c0ed(0x1e0)](_0x3318ae,_0x3996e7,_0x1c568f);}:function(_0xd908a7,_0x3a1fa3,_0x77f60c,_0xedaad){if(_0xedaad===undefined)_0xedaad=_0x77f60c;_0xd908a7[_0xedaad]=_0x3a1fa3[_0x77f60c];}),__setModuleDefault=this&&this[a458_0x15d827(0x1fb)]||(Object[a458_0x15d827(0x1d9)]?function(_0x5c1694,_0x447d92){const _0x59d517=a458_0x15d827;Object[_0x59d517(0x1e0)](_0x5c1694,'default',{'enumerable':!![],'value':_0x447d92});}:function(_0x431384,_0xe1ff74){const _0x5f3739=a458_0x15d827;_0x431384[_0x5f3739(0x1d2)]=_0xe1ff74;}),__importStar=this&&this[a458_0x15d827(0x1f2)]||(function(){const _0x45eecc=(function(){let _0x320c7f=!![];return function(_0x467f91,_0x27681f){const _0x599fb1=_0x320c7f?function(){const _0x36c9d5=a458_0x58cf;if(_0x27681f){const _0x429e17=_0x27681f[_0x36c9d5(0x1fa)](_0x467f91,arguments);return _0x27681f=null,_0x429e17;}}:function(){};return _0x320c7f=![],_0x599fb1;};}()),_0x2c71bd=_0x45eecc(this,function(){const _0x23462c=a458_0x58cf;return _0x2c71bd['toString']()['search']('(((.+)+)+)+$')['toString']()['constructor'](_0x2c71bd)['search'](_0x23462c(0x1f0));});_0x2c71bd();var _0x4f69fc=function(_0x201568){const _0x444df1=a458_0x58cf;return _0x4f69fc=Object[_0x444df1(0x1f4)]||function(_0x421dec){const _0x15e5a2=_0x444df1;var _0x230b4d=[];for(var _0x7496aa in _0x421dec)if(Object['prototype']['hasOwnProperty']['call'](_0x421dec,_0x7496aa))_0x230b4d[_0x230b4d[_0x15e5a2(0x1e3)]]=_0x7496aa;return _0x230b4d;},_0x4f69fc(_0x201568);};return function(_0x214139){const _0x28685c=a458_0x58cf;if(_0x214139&&_0x214139[_0x28685c(0x1f9)])return _0x214139;var _0x3a1c6d={};if(_0x214139!=null){for(var _0x28b036=_0x4f69fc(_0x214139),_0x201b49=0x0;_0x201b49<_0x28b036[_0x28685c(0x1e3)];_0x201b49++)if(_0x28b036[_0x201b49]!==_0x28685c(0x1d2))__createBinding(_0x3a1c6d,_0x214139,_0x28b036[_0x201b49]);}return __setModuleDefault(_0x3a1c6d,_0x214139),_0x3a1c6d;};}()),__importDefault=this&&this[a458_0x15d827(0x1e8)]||function(_0x2b2dc3){const _0x2ad3e2=a458_0x15d827;return _0x2b2dc3&&_0x2b2dc3[_0x2ad3e2(0x1f9)]?_0x2b2dc3:{'default':_0x2b2dc3};};Object['defineProperty'](exports,'__esModule',{'value':!![]}),exports[a458_0x15d827(0x1d7)]=void 0x0;const nodemailer_1=__importDefault(require(a458_0x15d827(0x1ea))),Setting_1=__importDefault(require('../../models/Setting')),Email_1=__importDefault(require(a458_0x15d827(0x1d5))),cron=__importStar(require(a458_0x15d827(0x1ce))),moment_1=__importDefault(require(a458_0x15d827(0x1dd))),SendMail=async(_0x5ce1b4,_0x30e0a7,_0x910012,_0xc4c8f2,_0x585ede,_0x1c9e02,_0x63ea38)=>{const _0x3f72b6=a458_0x15d827;try{const _0x24999a=await Setting_1['default'][_0x3f72b6(0x1f6)]({'where':{'companyId':_0x5ce1b4,'key':_0x3f72b6(0x1fc)}}),_0x3c0a0f=await Setting_1[_0x3f72b6(0x1d2)][_0x3f72b6(0x1f6)]({'where':{'companyId':_0x5ce1b4,'key':'usersmtpauth'}}),_0x4fd3ba=await Setting_1[_0x3f72b6(0x1d2)]['findOne']({'where':{'companyId':_0x5ce1b4,'key':_0x3f72b6(0x1d3)}}),_0x300249=await Setting_1[_0x3f72b6(0x1d2)][_0x3f72b6(0x1f6)]({'where':{'companyId':_0x5ce1b4,'key':_0x3f72b6(0x1eb)}}),_0x2b13a5=_0x24999a['value'],_0x26f6be=_0x3c0a0f['value'],_0x28ca63=_0x4fd3ba[_0x3f72b6(0x1d0)],_0x259ff0=_0x300249[_0x3f72b6(0x1d0)],_0x3d0e21=nodemailer_1[_0x3f72b6(0x1d2)][_0x3f72b6(0x1f8)]({'host':_0x2b13a5,'port':Number(_0x259ff0),'secure':![],'auth':{'user':_0x26f6be,'pass':_0x28ca63}});async function _0x589172(_0xdd8d53){const _0x1d1cf1=_0x3f72b6;try{const _0x41115d={'from':_0x26f6be,'to':_0x30e0a7,'subject':_0xc4c8f2,'text':_0x585ede};return await _0x3d0e21[_0x1d1cf1(0x1da)](_0x41115d),await Email_1[_0x1d1cf1(0x1d2)]['create']({'sender':_0x30e0a7,'subject':_0xc4c8f2,'message':_0x585ede,'companyId':_0x5ce1b4}),{'message':'E-mail\x20agendado\x20e\x20salvo\x20com\x20sucesso'};}catch(_0x307b04){console[_0x1d1cf1(0x1ee)](_0x1d1cf1(0x1d6),_0x307b04);throw new Error(_0x1d1cf1(0x1dc)+_0x307b04);}}if(_0x63ea38)return cron[_0x3f72b6(0x1de)](_0x63ea38,()=>{const _0x58e6bf=_0x3f72b6,_0x5cbd7b=(0x0,moment_1[_0x58e6bf(0x1d2)])()[_0x58e6bf(0x1ef)](0x1,_0x58e6bf(0x1db))[_0x58e6bf(0x1e4)](_0x58e6bf(0x1e7));_0x589172(_0x5cbd7b);}),{'message':_0x3f72b6(0x1f3)};else{const _0x1a2e55=(0x0,moment_1['default'])()[_0x3f72b6(0x1ef)](0x1,_0x3f72b6(0x1db))[_0x3f72b6(0x1e4)]('YYYY-MM-DDTHH:mm');return _0x589172(_0x1a2e55),{'message':_0x3f72b6(0x1e2)};}}catch(_0x19fd96){return console[_0x3f72b6(0x1ee)](_0x3f72b6(0x1f5),_0x19fd96),{'error':_0x3f72b6(0x1e5)+_0x19fd96[_0x3f72b6(0x1d1)]};}};exports['SendMail']=SendMail,exports[a458_0x15d827(0x1d2)]=exports['SendMail'];