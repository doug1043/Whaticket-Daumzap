const a423_0x5185ad=a423_0x38c2;(function(_0x5b7b00,_0x13a982){const _0x4d2a9d=a423_0x38c2,_0x3a5461=_0x5b7b00();while(!![]){try{const _0x301886=parseInt(_0x4d2a9d(0x153))/0x1+parseInt(_0x4d2a9d(0x156))/0x2*(parseInt(_0x4d2a9d(0x15b))/0x3)+-parseInt(_0x4d2a9d(0x14d))/0x4+parseInt(_0x4d2a9d(0x151))/0x5+-parseInt(_0x4d2a9d(0x14a))/0x6*(parseInt(_0x4d2a9d(0x163))/0x7)+parseInt(_0x4d2a9d(0x16f))/0x8*(parseInt(_0x4d2a9d(0x174))/0x9)+parseInt(_0x4d2a9d(0x159))/0xa*(-parseInt(_0x4d2a9d(0x17a))/0xb);if(_0x301886===_0x13a982)break;else _0x3a5461['push'](_0x3a5461['shift']());}catch(_0x49f510){_0x3a5461['push'](_0x3a5461['shift']());}}}(a423_0x2265,0x1d8f2));const a423_0x1785b5=(function(){let _0x2002ca=!![];return function(_0x342b92,_0x3ba942){const _0x2fb210=_0x2002ca?function(){const _0xf374f8=a423_0x38c2;if(_0x3ba942){const _0x2201cc=_0x3ba942[_0xf374f8(0x16c)](_0x342b92,arguments);return _0x3ba942=null,_0x2201cc;}}:function(){};return _0x2002ca=![],_0x2fb210;};}()),a423_0x444a2d=a423_0x1785b5(this,function(){const _0x373078=a423_0x38c2;return a423_0x444a2d[_0x373078(0x167)]()['search'](_0x373078(0x161))[_0x373078(0x167)]()[_0x373078(0x15c)](a423_0x444a2d)[_0x373078(0x14f)](_0x373078(0x161));});function a423_0x2265(){const _0x32e944=['search','Agendamento\x20de\x20e-mail\x20realizado\x20com\x20sucesso','1087575TutTUW','Erro\x20ao\x20enviar\x20e-mail:\x20','200129QLTBUC','node-cron','add','626nbbNnJ','SendMail','__setModuleDefault','13480MBbwZV','nodemailer','1824yCdhmk','constructor','schedule','YYYY-MM-DDTHH:mm','get','Erro\x20ao\x20agendar\x20e-mail:','(((.+)+)+)+$','format','14FtCztM','hasOwnProperty','sendMail','message','toString','__importDefault','hour','__createBinding','default','apply','value','prototype','216TnkHBF','__esModule','../../models/Email','smtpport','moment','423YJzPbo','create','findOne','configurable','clientsecretsmtpauth','writable','2222XxzvFY','../../models/Setting','usersmtpauth','139080QmiHcL','error','defineProperty','677948BzPrZZ','createTransport'];a423_0x2265=function(){return _0x32e944;};return a423_0x2265();}a423_0x444a2d();'use strict';function a423_0x38c2(_0x2ca5b5,_0x497ea2){const _0x5efd46=a423_0x2265();return a423_0x38c2=function(_0x444a2d,_0x1785b5){_0x444a2d=_0x444a2d-0x148;let _0x2265e8=_0x5efd46[_0x444a2d];return _0x2265e8;},a423_0x38c2(_0x2ca5b5,_0x497ea2);}var __createBinding=this&&this[a423_0x5185ad(0x16a)]||(Object['create']?function(_0x17f334,_0x38f87d,_0x3357f1,_0x125dca){const _0x3fa924=a423_0x5185ad;if(_0x125dca===undefined)_0x125dca=_0x3357f1;var _0xe2160b=Object['getOwnPropertyDescriptor'](_0x38f87d,_0x3357f1);(!_0xe2160b||(_0x3fa924(0x15f)in _0xe2160b?!_0x38f87d[_0x3fa924(0x170)]:_0xe2160b[_0x3fa924(0x179)]||_0xe2160b[_0x3fa924(0x177)]))&&(_0xe2160b={'enumerable':!![],'get':function(){return _0x38f87d[_0x3357f1];}}),Object[_0x3fa924(0x14c)](_0x17f334,_0x125dca,_0xe2160b);}:function(_0x3c7df7,_0x5873e9,_0x5a8614,_0x32e804){if(_0x32e804===undefined)_0x32e804=_0x5a8614;_0x3c7df7[_0x32e804]=_0x5873e9[_0x5a8614];}),__setModuleDefault=this&&this[a423_0x5185ad(0x158)]||(Object['create']?function(_0x4d19ce,_0x529c88){const _0x1f713b=a423_0x5185ad;Object[_0x1f713b(0x14c)](_0x4d19ce,_0x1f713b(0x16b),{'enumerable':!![],'value':_0x529c88});}:function(_0x26e216,_0x4ca0b8){const _0x105d09=a423_0x5185ad;_0x26e216[_0x105d09(0x16b)]=_0x4ca0b8;}),__importStar=this&&this['__importStar']||function(_0x14c99b){const _0x28d159=a423_0x5185ad;if(_0x14c99b&&_0x14c99b[_0x28d159(0x170)])return _0x14c99b;var _0x2d36b5={};if(_0x14c99b!=null){for(var _0x1e3997 in _0x14c99b)if(_0x1e3997!==_0x28d159(0x16b)&&Object[_0x28d159(0x16e)][_0x28d159(0x164)]['call'](_0x14c99b,_0x1e3997))__createBinding(_0x2d36b5,_0x14c99b,_0x1e3997);}return __setModuleDefault(_0x2d36b5,_0x14c99b),_0x2d36b5;},__importDefault=this&&this[a423_0x5185ad(0x168)]||function(_0xeb481c){const _0x555220=a423_0x5185ad;return _0xeb481c&&_0xeb481c[_0x555220(0x170)]?_0xeb481c:{'default':_0xeb481c};};Object[a423_0x5185ad(0x14c)](exports,a423_0x5185ad(0x170),{'value':!![]}),exports['SendMail']=void 0x0;const nodemailer_1=__importDefault(require(a423_0x5185ad(0x15a))),Setting_1=__importDefault(require(a423_0x5185ad(0x148))),Email_1=__importDefault(require(a423_0x5185ad(0x171))),cron=__importStar(require(a423_0x5185ad(0x154))),moment_1=__importDefault(require(a423_0x5185ad(0x173))),SendMail=async(_0x33f0af,_0x12dec9,_0x160813,_0x263627,_0x3c439f,_0x3a916b,_0x34424f)=>{const _0x142b82=a423_0x5185ad;try{const _0x51b096=await Setting_1[_0x142b82(0x16b)][_0x142b82(0x176)]({'where':{'companyId':_0x33f0af,'key':'smtpauth'}}),_0x519140=await Setting_1[_0x142b82(0x16b)][_0x142b82(0x176)]({'where':{'companyId':_0x33f0af,'key':_0x142b82(0x149)}}),_0x4a14f5=await Setting_1[_0x142b82(0x16b)][_0x142b82(0x176)]({'where':{'companyId':_0x33f0af,'key':_0x142b82(0x178)}}),_0x5ce0c9=await Setting_1[_0x142b82(0x16b)][_0x142b82(0x176)]({'where':{'companyId':_0x33f0af,'key':_0x142b82(0x172)}}),_0x3b8e5b=_0x51b096['value'],_0x5a26ba=_0x519140[_0x142b82(0x16d)],_0x4fe3de=_0x4a14f5['value'],_0x412a11=_0x5ce0c9[_0x142b82(0x16d)],_0x38cfd8=nodemailer_1[_0x142b82(0x16b)][_0x142b82(0x14e)]({'host':_0x3b8e5b,'port':Number(_0x412a11),'secure':![],'auth':{'user':_0x5a26ba,'pass':_0x4fe3de}});async function _0x4b4b07(_0x3ccf20){const _0x5f5b8=_0x142b82;try{const _0x58dae6={'from':_0x5a26ba,'to':_0x12dec9,'subject':_0x263627,'text':_0x3c439f};return await _0x38cfd8[_0x5f5b8(0x165)](_0x58dae6),await Email_1[_0x5f5b8(0x16b)][_0x5f5b8(0x175)]({'sender':_0x12dec9,'subject':_0x263627,'message':_0x3c439f,'companyId':_0x33f0af}),{'message':'E-mail\x20agendado\x20e\x20salvo\x20com\x20sucesso'};}catch(_0x354c44){console[_0x5f5b8(0x14b)]('Erro\x20ao\x20enviar\x20e-mail:',_0x354c44);throw new Error(_0x5f5b8(0x152)+_0x354c44);}}if(_0x34424f)return cron[_0x142b82(0x15d)](_0x34424f,()=>{const _0x255786=_0x142b82,_0x2f8f21=(0x0,moment_1[_0x255786(0x16b)])()['add'](0x1,_0x255786(0x169))[_0x255786(0x162)](_0x255786(0x15e));_0x4b4b07(_0x2f8f21);}),{'message':_0x142b82(0x150)};else{const _0x2f72ba=(0x0,moment_1[_0x142b82(0x16b)])()[_0x142b82(0x155)](0x1,'hour')[_0x142b82(0x162)]('YYYY-MM-DDTHH:mm');return _0x4b4b07(_0x2f72ba),{'message':'E-mail\x20enviado\x20imediatamente'};}}catch(_0x2f5e36){return console[_0x142b82(0x14b)](_0x142b82(0x160),_0x2f5e36),{'error':'Erro\x20ao\x20agendar\x20e-mail:\x20'+_0x2f5e36[_0x142b82(0x166)]};}};exports[a423_0x5185ad(0x157)]=SendMail,exports['default']=exports['SendMail'];