'use strict';const a455_0x5abd78=a455_0x437e;function a455_0x802a(){const _0x556456=['smtpport','hasOwnProperty','node-cron','configurable','E-mail\x20agendado\x20e\x20salvo\x20com\x20sucesso','898639LbqEWg','getOwnPropertyNames','value','6110739BhUadR','hour','message','E-mail\x20enviado\x20imediatamente','(((.+)+)+)+$','4PGDrRJ','8WRqIwQ','constructor','nodemailer','defineProperty','10676532bUcLjk','__setModuleDefault','create','Erro\x20ao\x20agendar\x20e-mail:','format','1133030WqTeln','2bBNqLC','2270715PywtOz','../../models/Email','Erro\x20ao\x20agendar\x20e-mail:\x20','clientsecretsmtpauth','toString','__esModule','55oQQtCv','2595273KXMnly','search','getOwnPropertyDescriptor','Erro\x20ao\x20enviar\x20e-mail:','get','prototype','error','YYYY-MM-DDTHH:mm','apply','add','sendMail','Agendamento\x20de\x20e-mail\x20realizado\x20com\x20sucesso','length','default','1005515fGrVzc','12jNXaWg','findOne','schedule','SendMail'];a455_0x802a=function(){return _0x556456;};return a455_0x802a();}function a455_0x437e(_0xbf565d,_0x1df64a){const _0x5ed96c=a455_0x802a();return a455_0x437e=function(_0x53fe89,_0xb7bf47){_0x53fe89=_0x53fe89-0x18a;let _0x802a88=_0x5ed96c[_0x53fe89];return _0x802a88;},a455_0x437e(_0xbf565d,_0x1df64a);}(function(_0x5a303f,_0x231833){const _0x2cc87c=a455_0x437e,_0x5abeb7=_0x5a303f();while(!![]){try{const _0x4ba8de=-parseInt(_0x2cc87c(0x1a5))/0x1*(parseInt(_0x2cc87c(0x18f))/0x2)+-parseInt(_0x2cc87c(0x197))/0x3*(-parseInt(_0x2cc87c(0x1b7))/0x4)+parseInt(_0x2cc87c(0x190))/0x5*(parseInt(_0x2cc87c(0x1a6))/0x6)+-parseInt(_0x2cc87c(0x1af))/0x7*(-parseInt(_0x2cc87c(0x1b8))/0x8)+-parseInt(_0x2cc87c(0x1b2))/0x9+-parseInt(_0x2cc87c(0x18e))/0xa*(parseInt(_0x2cc87c(0x196))/0xb)+parseInt(_0x2cc87c(0x1bc))/0xc;if(_0x4ba8de===_0x231833)break;else _0x5abeb7['push'](_0x5abeb7['shift']());}catch(_0x40a2a8){_0x5abeb7['push'](_0x5abeb7['shift']());}}}(a455_0x802a,0x83f30));var __createBinding=this&&this['__createBinding']||(Object[a455_0x5abd78(0x18b)]?function(_0x29e5c8,_0x19579c,_0x44b081,_0x26aa29){const _0x1e1e32=a455_0x5abd78;if(_0x26aa29===undefined)_0x26aa29=_0x44b081;var _0x5c16a4=Object[_0x1e1e32(0x199)](_0x19579c,_0x44b081);(!_0x5c16a4||(_0x1e1e32(0x19b)in _0x5c16a4?!_0x19579c[_0x1e1e32(0x195)]:_0x5c16a4['writable']||_0x5c16a4[_0x1e1e32(0x1ad)]))&&(_0x5c16a4={'enumerable':!![],'get':function(){return _0x19579c[_0x44b081];}}),Object[_0x1e1e32(0x1bb)](_0x29e5c8,_0x26aa29,_0x5c16a4);}:function(_0x7d4b2,_0xcb6bdf,_0x500abf,_0x22e011){if(_0x22e011===undefined)_0x22e011=_0x500abf;_0x7d4b2[_0x22e011]=_0xcb6bdf[_0x500abf];}),__setModuleDefault=this&&this[a455_0x5abd78(0x18a)]||(Object[a455_0x5abd78(0x18b)]?function(_0x93aada,_0x29c251){const _0x46adae=a455_0x5abd78;Object[_0x46adae(0x1bb)](_0x93aada,'default',{'enumerable':!![],'value':_0x29c251});}:function(_0x1ffcc6,_0x1f6f23){_0x1ffcc6['default']=_0x1f6f23;}),__importStar=this&&this['__importStar']||(function(){const _0x7db552=(function(){let _0x115ebd=!![];return function(_0xef3ea1,_0x4d121d){const _0x5d00ce=_0x115ebd?function(){const _0x3d8972=a455_0x437e;if(_0x4d121d){const _0x5e4e8f=_0x4d121d[_0x3d8972(0x19f)](_0xef3ea1,arguments);return _0x4d121d=null,_0x5e4e8f;}}:function(){};return _0x115ebd=![],_0x5d00ce;};}()),_0x5eef19=_0x7db552(this,function(){const _0x325793=a455_0x437e;return _0x5eef19[_0x325793(0x194)]()[_0x325793(0x198)](_0x325793(0x1b6))[_0x325793(0x194)]()[_0x325793(0x1b9)](_0x5eef19)[_0x325793(0x198)](_0x325793(0x1b6));});_0x5eef19();var _0x401952=function(_0x3b6146){const _0x3f2894=a455_0x437e;return _0x401952=Object[_0x3f2894(0x1b0)]||function(_0x130334){const _0x107f4e=_0x3f2894;var _0x1a1dca=[];for(var _0xb48bf4 in _0x130334)if(Object[_0x107f4e(0x19c)][_0x107f4e(0x1ab)]['call'](_0x130334,_0xb48bf4))_0x1a1dca[_0x1a1dca[_0x107f4e(0x1a3)]]=_0xb48bf4;return _0x1a1dca;},_0x401952(_0x3b6146);};return function(_0x3a2059){const _0x135bd7=a455_0x437e;if(_0x3a2059&&_0x3a2059[_0x135bd7(0x195)])return _0x3a2059;var _0x5e99dd={};if(_0x3a2059!=null){for(var _0xcb9f12=_0x401952(_0x3a2059),_0x58f72d=0x0;_0x58f72d<_0xcb9f12['length'];_0x58f72d++)if(_0xcb9f12[_0x58f72d]!==_0x135bd7(0x1a4))__createBinding(_0x5e99dd,_0x3a2059,_0xcb9f12[_0x58f72d]);}return __setModuleDefault(_0x5e99dd,_0x3a2059),_0x5e99dd;};}()),__importDefault=this&&this['__importDefault']||function(_0x5a2777){const _0x10f4c0=a455_0x5abd78;return _0x5a2777&&_0x5a2777[_0x10f4c0(0x195)]?_0x5a2777:{'default':_0x5a2777};};Object['defineProperty'](exports,'__esModule',{'value':!![]}),exports[a455_0x5abd78(0x1a9)]=void 0x0;const nodemailer_1=__importDefault(require(a455_0x5abd78(0x1ba))),Setting_1=__importDefault(require('../../models/Setting')),Email_1=__importDefault(require(a455_0x5abd78(0x191))),cron=__importStar(require(a455_0x5abd78(0x1ac))),moment_1=__importDefault(require('moment')),SendMail=async(_0x192ca3,_0x385646,_0x20ffe0,_0x1a6f26,_0x449cfc,_0x3c8d7c,_0xc8a82)=>{const _0x10ae90=a455_0x5abd78;try{const _0x1db103=await Setting_1[_0x10ae90(0x1a4)]['findOne']({'where':{'companyId':_0x192ca3,'key':'smtpauth'}}),_0x1b672d=await Setting_1[_0x10ae90(0x1a4)][_0x10ae90(0x1a7)]({'where':{'companyId':_0x192ca3,'key':'usersmtpauth'}}),_0x1e8874=await Setting_1[_0x10ae90(0x1a4)][_0x10ae90(0x1a7)]({'where':{'companyId':_0x192ca3,'key':_0x10ae90(0x193)}}),_0x443b2f=await Setting_1[_0x10ae90(0x1a4)][_0x10ae90(0x1a7)]({'where':{'companyId':_0x192ca3,'key':_0x10ae90(0x1aa)}}),_0xab8a38=_0x1db103['value'],_0x546c2c=_0x1b672d[_0x10ae90(0x1b1)],_0x34d685=_0x1e8874[_0x10ae90(0x1b1)],_0x2ae7a8=_0x443b2f[_0x10ae90(0x1b1)],_0x104d76=nodemailer_1[_0x10ae90(0x1a4)]['createTransport']({'host':_0xab8a38,'port':Number(_0x2ae7a8),'secure':![],'auth':{'user':_0x546c2c,'pass':_0x34d685}});async function _0x10a514(_0x139715){const _0x40f641=_0x10ae90;try{const _0x5dfb66={'from':_0x546c2c,'to':_0x385646,'subject':_0x1a6f26,'text':_0x449cfc};return await _0x104d76[_0x40f641(0x1a1)](_0x5dfb66),await Email_1[_0x40f641(0x1a4)][_0x40f641(0x18b)]({'sender':_0x385646,'subject':_0x1a6f26,'message':_0x449cfc,'companyId':_0x192ca3}),{'message':_0x40f641(0x1ae)};}catch(_0x21e72f){console['error'](_0x40f641(0x19a),_0x21e72f);throw new Error('Erro\x20ao\x20enviar\x20e-mail:\x20'+_0x21e72f);}}if(_0xc8a82)return cron[_0x10ae90(0x1a8)](_0xc8a82,()=>{const _0x5c078a=_0x10ae90,_0x38d4e9=(0x0,moment_1[_0x5c078a(0x1a4)])()['add'](0x1,'hour')[_0x5c078a(0x18d)]('YYYY-MM-DDTHH:mm');_0x10a514(_0x38d4e9);}),{'message':_0x10ae90(0x1a2)};else{const _0x884045=(0x0,moment_1['default'])()[_0x10ae90(0x1a0)](0x1,_0x10ae90(0x1b3))['format'](_0x10ae90(0x19e));return _0x10a514(_0x884045),{'message':_0x10ae90(0x1b5)};}}catch(_0x21eef1){return console[_0x10ae90(0x19d)](_0x10ae90(0x18c),_0x21eef1),{'error':_0x10ae90(0x192)+_0x21eef1[_0x10ae90(0x1b4)]};}};exports[a455_0x5abd78(0x1a9)]=SendMail,exports[a455_0x5abd78(0x1a4)]=exports[a455_0x5abd78(0x1a9)];