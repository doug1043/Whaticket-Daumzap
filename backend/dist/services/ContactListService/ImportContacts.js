const a441_0x16c557=a441_0x13bb;(function(_0x447699,_0xe8e8c1){const _0x5cb956=a441_0x13bb,_0x332c65=_0x447699();while(!![]){try{const _0x3477cf=parseInt(_0x5cb956(0xfd))/0x1+-parseInt(_0x5cb956(0x100))/0x2+parseInt(_0x5cb956(0x118))/0x3+parseInt(_0x5cb956(0x11c))/0x4+parseInt(_0x5cb956(0x10f))/0x5*(-parseInt(_0x5cb956(0x105))/0x6)+parseInt(_0x5cb956(0x116))/0x7*(-parseInt(_0x5cb956(0xfa))/0x8)+-parseInt(_0x5cb956(0x111))/0x9*(-parseInt(_0x5cb956(0x10c))/0xa);if(_0x3477cf===_0xe8e8c1)break;else _0x332c65['push'](_0x332c65['shift']());}catch(_0x3197a3){_0x332c65['push'](_0x332c65['shift']());}}}(a441_0x2946,0xd9448));const a441_0x4527b6=(function(){let _0x45f66b=!![];return function(_0x4c892d,_0x28507d){const _0x491621=_0x45f66b?function(){const _0x139cd5=a441_0x13bb;if(_0x28507d){const _0x199719=_0x28507d[_0x139cd5(0xfe)](_0x4c892d,arguments);return _0x28507d=null,_0x199719;}}:function(){};return _0x45f66b=![],_0x491621;};}()),a441_0x21d30e=a441_0x4527b6(this,function(){const _0x595a5f=a441_0x13bb;return a441_0x21d30e[_0x595a5f(0x112)]()[_0x595a5f(0x107)]('(((.+)+)+)+$')[_0x595a5f(0x112)]()['constructor'](a441_0x21d30e)[_0x595a5f(0x107)](_0x595a5f(0x11b));});a441_0x21d30e();function a441_0x13bb(_0x544fbe,_0x5d234e){const _0x2b8f16=a441_0x2946();return a441_0x13bb=function(_0x21d30e,_0x4527b6){_0x21d30e=_0x21d30e-0xf9;let _0x29463e=_0x2b8f16[_0x21d30e];return _0x29463e;},a441_0x13bb(_0x544fbe,_0x5d234e);}'use strict';var __importDefault=this&&this[a441_0x16c557(0xff)]||function(_0x83a6f8){const _0x5d5ec7=a441_0x16c557;return _0x83a6f8&&_0x83a6f8[_0x5d5ec7(0x114)]?_0x83a6f8:{'default':_0x83a6f8};};Object[a441_0x16c557(0x113)](exports,a441_0x16c557(0x114),{'value':!![]}),exports['ImportContacts']=ImportContacts;const lodash_1=require('lodash'),xlsx_1=__importDefault(require('xlsx')),lodash_2=require('lodash'),ContactListItem_1=__importDefault(require(a441_0x16c557(0x11f))),CheckNumber_1=__importDefault(require(a441_0x16c557(0x124))),logger_1=require(a441_0x16c557(0x115));function a441_0x2946(){const _0x324f24=['apply','__importDefault','1654940bSDVNE','map','values','default','Numero','108522DPikCQ','has','search','E-mail','head','número','logger','5878550eSZjOD','error','sheet_to_json','245XZhUps','Email','9ULoPOT','toString','defineProperty','__esModule','../../utils/logger','17759GUdyHW','push','4708491YcsOVx','path','Número','(((.+)+)+)+$','2427348UpvEfN','isWhatsappValid','Nome','../../models/ContactListItem','e-mail','exists','numero','nome','../WbotServices/CheckNumber','readFile','number','632JYOzta','email','Sheets','39895QqDOps'];a441_0x2946=function(){return _0x324f24;};return a441_0x2946();}async function ImportContacts(_0x83da36,_0x35ab63,_0x4cbe62){const _0x2648aa=a441_0x16c557,_0x54f0e1=xlsx_1[_0x2648aa(0x103)][_0x2648aa(0x125)](_0x4cbe62?.[_0x2648aa(0x119)]),_0xdaeeec=(0x0,lodash_1[_0x2648aa(0x109)])(Object[_0x2648aa(0x102)](_0x54f0e1[_0x2648aa(0xfc)])),_0x296218=xlsx_1[_0x2648aa(0x103)]['utils'][_0x2648aa(0x10e)](_0xdaeeec,{'header':0x0}),_0x1c02b5=_0x296218[_0x2648aa(0x101)](_0x229813=>{const _0x58ec6f=_0x2648aa;let _0x7de031='',_0x256db8='',_0x4f3ded='';return((0x0,lodash_2[_0x58ec6f(0x106)])(_0x229813,_0x58ec6f(0x123))||(0x0,lodash_2[_0x58ec6f(0x106)])(_0x229813,_0x58ec6f(0x11e)))&&(_0x7de031=_0x229813[_0x58ec6f(0x123)]||_0x229813[_0x58ec6f(0x11e)]),((0x0,lodash_2[_0x58ec6f(0x106)])(_0x229813,'numero')||(0x0,lodash_2[_0x58ec6f(0x106)])(_0x229813,_0x58ec6f(0x10a))||(0x0,lodash_2[_0x58ec6f(0x106)])(_0x229813,_0x58ec6f(0x104))||(0x0,lodash_2[_0x58ec6f(0x106)])(_0x229813,_0x58ec6f(0x11a)))&&(_0x256db8=_0x229813[_0x58ec6f(0x122)]||_0x229813['número']||_0x229813[_0x58ec6f(0x104)]||_0x229813[_0x58ec6f(0x11a)],_0x256db8=(''+_0x256db8)['replace'](/\D/g,'')),((0x0,lodash_2['has'])(_0x229813,_0x58ec6f(0xfb))||(0x0,lodash_2[_0x58ec6f(0x106)])(_0x229813,_0x58ec6f(0x120))||(0x0,lodash_2[_0x58ec6f(0x106)])(_0x229813,'Email')||(0x0,lodash_2[_0x58ec6f(0x106)])(_0x229813,'E-mail'))&&(_0x4f3ded=_0x229813[_0x58ec6f(0xfb)]||_0x229813[_0x58ec6f(0x120)]||_0x229813[_0x58ec6f(0x110)]||_0x229813[_0x58ec6f(0x108)]),{'name':_0x7de031,'number':_0x256db8,'email':_0x4f3ded,'contactListId':_0x83da36,'companyId':_0x35ab63};}),_0x1bad3d=[];for(const _0x340e2b of _0x1c02b5){const [_0x187d1e,_0x4c2a2c]=await ContactListItem_1[_0x2648aa(0x103)]['findOrCreate']({'where':{'number':''+_0x340e2b[_0x2648aa(0xf9)],'contactListId':_0x340e2b['contactListId'],'companyId':_0x340e2b['companyId']},'defaults':_0x340e2b});_0x4c2a2c&&_0x1bad3d[_0x2648aa(0x117)](_0x187d1e);}if(_0x1bad3d)for(let _0x417916 of _0x1bad3d){try{const _0x4ded51=await(0x0,CheckNumber_1[_0x2648aa(0x103)])(_0x417916[_0x2648aa(0xf9)],_0x35ab63);_0x417916[_0x2648aa(0x11d)]=_0x4ded51[_0x2648aa(0x121)];const _0xc4f2fb=_0x4ded51['jid']['replace'](/\D/g,'');_0x417916[_0x2648aa(0xf9)]=_0xc4f2fb,await _0x417916['save']();}catch(_0x4a3d1b){logger_1[_0x2648aa(0x10b)][_0x2648aa(0x10d)]('Número\x20de\x20contato\x20inválido:\x20'+_0x417916[_0x2648aa(0xf9)]);}}return _0x1bad3d;}