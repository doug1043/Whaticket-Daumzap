function a406_0x213a(){const _0x577249=['428XNnAsS','Número','contactListId','ImportContacts','email','e-mail','nome','isWhatsappValid','has','search','Nome','857830cMXqNt','default','598077JuubVz','../WbotServices/CheckNumber','2614003QkmOgV','replace','Email','map','2828730QqOKWn','sheet_to_json','push','number','7368kFFenx','../../utils/logger','lodash','jid','error','__esModule','exists','toString','Erro\x20ao\x20verificar\x20número\x20de\x20contato:\x20','(((.+)+)+)+$','Numero','path','logger','readFile','__importDefault','Sheets','defineProperty','warn','constructor','número','utils','2514000sAKDsI','164NeICxf','991dnlCxk','E-mail','numero','findOrCreate'];a406_0x213a=function(){return _0x577249;};return a406_0x213a();}const a406_0xfc75d=a406_0x5aa9;(function(_0x520a97,_0x5b5e37){const _0x91931f=a406_0x5aa9,_0x3770e5=_0x520a97();while(!![]){try{const _0x37ccad=parseInt(_0x91931f(0x109))/0x1*(parseInt(_0x91931f(0x108))/0x2)+parseInt(_0x91931f(0xf2))/0x3*(-parseInt(_0x91931f(0x10d))/0x4)+parseInt(_0x91931f(0x118))/0x5+-parseInt(_0x91931f(0xee))/0x6+parseInt(_0x91931f(0x11c))/0x7+parseInt(_0x91931f(0x107))/0x8+parseInt(_0x91931f(0x11a))/0x9;if(_0x37ccad===_0x5b5e37)break;else _0x3770e5['push'](_0x3770e5['shift']());}catch(_0x51232c){_0x3770e5['push'](_0x3770e5['shift']());}}}(a406_0x213a,0x42949));const a406_0x1a228e=(function(){let _0xa52694=!![];return function(_0x5837c8,_0x18023f){const _0x5b9af9=_0xa52694?function(){if(_0x18023f){const _0x24a3a1=_0x18023f['apply'](_0x5837c8,arguments);return _0x18023f=null,_0x24a3a1;}}:function(){};return _0xa52694=![],_0x5b9af9;};}()),a406_0x5ae150=a406_0x1a228e(this,function(){const _0x42cb26=a406_0x5aa9;return a406_0x5ae150[_0x42cb26(0xf9)]()[_0x42cb26(0x116)](_0x42cb26(0xfb))['toString']()[_0x42cb26(0x104)](a406_0x5ae150)[_0x42cb26(0x116)](_0x42cb26(0xfb));});a406_0x5ae150();'use strict';var __importDefault=this&&this[a406_0xfc75d(0x100)]||function(_0x2a6a98){const _0xe4e39=a406_0xfc75d;return _0x2a6a98&&_0x2a6a98[_0xe4e39(0xf7)]?_0x2a6a98:{'default':_0x2a6a98};};Object[a406_0xfc75d(0x102)](exports,'__esModule',{'value':!![]}),exports[a406_0xfc75d(0x110)]=void 0x0;function a406_0x5aa9(_0x5a894c,_0x11b772){const _0x122889=a406_0x213a();return a406_0x5aa9=function(_0x5ae150,_0x1a228e){_0x5ae150=_0x5ae150-0xee;let _0x213a61=_0x122889[_0x5ae150];return _0x213a61;},a406_0x5aa9(_0x5a894c,_0x11b772);}const lodash_1=require(a406_0xfc75d(0xf4)),xlsx_1=__importDefault(require('xlsx')),lodash_2=require(a406_0xfc75d(0xf4)),ContactListItem_1=__importDefault(require('../../models/ContactListItem')),CheckNumber_1=__importDefault(require(a406_0xfc75d(0x11b))),logger_1=require(a406_0xfc75d(0xf3));async function ImportContacts(_0x68a2b1,_0x52888a,_0x2c0bde){const _0x3ef172=a406_0xfc75d,_0x172690=xlsx_1[_0x3ef172(0x119)][_0x3ef172(0xff)](_0x2c0bde?.[_0x3ef172(0xfd)]),_0x19e20a=(0x0,lodash_1['head'])(Object['values'](_0x172690[_0x3ef172(0x101)])),_0x236e87=xlsx_1[_0x3ef172(0x119)][_0x3ef172(0x106)][_0x3ef172(0xef)](_0x19e20a,{'header':0x0}),_0x1db793=_0x236e87[_0x3ef172(0x11f)](_0x32b824=>{const _0x1a24f1=_0x3ef172;let _0x4db209='',_0x163da6='',_0x4392a5='';return((0x0,lodash_2[_0x1a24f1(0x115)])(_0x32b824,_0x1a24f1(0x113))||(0x0,lodash_2['has'])(_0x32b824,'Nome'))&&(_0x4db209=_0x32b824[_0x1a24f1(0x113)]||_0x32b824[_0x1a24f1(0x117)]),((0x0,lodash_2[_0x1a24f1(0x115)])(_0x32b824,_0x1a24f1(0x10b))||(0x0,lodash_2[_0x1a24f1(0x115)])(_0x32b824,'número')||(0x0,lodash_2['has'])(_0x32b824,_0x1a24f1(0xfc))||(0x0,lodash_2[_0x1a24f1(0x115)])(_0x32b824,'Número'))&&(_0x163da6=_0x32b824[_0x1a24f1(0x10b)]||_0x32b824[_0x1a24f1(0x105)]||_0x32b824[_0x1a24f1(0xfc)]||_0x32b824[_0x1a24f1(0x10e)],_0x163da6=(''+_0x163da6)['replace'](/\D/g,'')),((0x0,lodash_2[_0x1a24f1(0x115)])(_0x32b824,'email')||(0x0,lodash_2['has'])(_0x32b824,'e-mail')||(0x0,lodash_2[_0x1a24f1(0x115)])(_0x32b824,_0x1a24f1(0x11e))||(0x0,lodash_2[_0x1a24f1(0x115)])(_0x32b824,_0x1a24f1(0x10a)))&&(_0x4392a5=_0x32b824[_0x1a24f1(0x111)]||_0x32b824[_0x1a24f1(0x112)]||_0x32b824[_0x1a24f1(0x11e)]||_0x32b824['E-mail']),{'name':_0x4db209,'number':_0x163da6,'email':_0x4392a5,'contactListId':_0x68a2b1,'companyId':_0x52888a};}),_0x3006eb=[];for(const _0x3d14c3 of _0x1db793){try{const _0x5706fd=await(0x0,CheckNumber_1['default'])(_0x3d14c3[_0x3ef172(0xf1)],_0x52888a);if(_0x5706fd[_0x3ef172(0xf8)]){const [_0xac41d6,_0x28ca73]=await ContactListItem_1[_0x3ef172(0x119)][_0x3ef172(0x10c)]({'where':{'number':''+_0x3d14c3[_0x3ef172(0xf1)],'contactListId':_0x3d14c3[_0x3ef172(0x10f)],'companyId':_0x3d14c3['companyId']},'defaults':_0x3d14c3});if(_0x28ca73){_0xac41d6[_0x3ef172(0x114)]=!![];const _0xb0f5c1=_0x5706fd[_0x3ef172(0xf5)][_0x3ef172(0x11d)](/\D/g,'');_0xac41d6[_0x3ef172(0xf1)]=_0xb0f5c1,await _0xac41d6['save'](),_0x3006eb[_0x3ef172(0xf0)](_0xac41d6);}}else logger_1['logger'][_0x3ef172(0x103)]('Número\x20de\x20contato\x20inválido\x20ignorado:\x20'+_0x3d14c3['number']);}catch(_0x1e11eb){logger_1[_0x3ef172(0xfe)][_0x3ef172(0xf6)](_0x3ef172(0xfa)+_0x3d14c3[_0x3ef172(0xf1)]);}}return _0x3006eb;}exports['ImportContacts']=ImportContacts;