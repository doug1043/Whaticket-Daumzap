'use strict';const a613_0x1c83f6=a613_0x11ca;(function(_0x428d90,_0x10c8f1){const _0x121472=a613_0x11ca,_0xc718ea=_0x428d90();while(!![]){try{const _0x6d656d=-parseInt(_0x121472(0xef))/0x1+-parseInt(_0x121472(0xfc))/0x2*(parseInt(_0x121472(0x107))/0x3)+-parseInt(_0x121472(0xe3))/0x4+-parseInt(_0x121472(0xde))/0x5*(parseInt(_0x121472(0x101))/0x6)+parseInt(_0x121472(0xd4))/0x7*(parseInt(_0x121472(0xd6))/0x8)+parseInt(_0x121472(0xf6))/0x9*(-parseInt(_0x121472(0xf5))/0xa)+parseInt(_0x121472(0xf1))/0xb;if(_0x6d656d===_0x10c8f1)break;else _0xc718ea['push'](_0xc718ea['shift']());}catch(_0x44f36e){_0xc718ea['push'](_0xc718ea['shift']());}}}(a613_0x3b24,0x3f657));function a613_0x3b24(){const _0x4ab9d7=['__importStar','length','8436lasEha','ERR_QUEUE_INVALID_NAME','typeError','__esModule','ERR_QUEUE_COLOR_ALREADY_EXISTS','call','../../models/Plan','ERR_QUEUE_ORDER_INVALID','167965tKxEcH','shape','72OHLhXt','count','ERR_QUEUE_INVALID_COLOR','yup','transform','Check-unique-name','Check-color-exists','../../errors/AppError','883955DJoBNM','message','ERR_QUEUE_NAME_ALREADY_EXISTS','ERR_QUEUE_ORDER_ALREADY_EXISTS','ERR_QUEUE_ORDER_REQUIRED','1029552XZUmKF','Check-color','getOwnPropertyDescriptor','Número\x20máximo\x20de\x20filas\x20já\x20alcançado:\x20','(((.+)+)+)+$','hasOwnProperty','prototype','required','string','apply','test','integer','34232emTLKy','search','12973015KLJLzv','plan','constructor','validate','10DtuJQo','2765718vokgFG','../../models/Queue','__createBinding','defineProperty','queues','findOne','256RtPOHk','toString','number','min','create','6DQAMWk','Check-unique-order','__setModuleDefault','default'];a613_0x3b24=function(){return _0x4ab9d7;};return a613_0x3b24();}var __createBinding=this&&this[a613_0x1c83f6(0xf8)]||(Object[a613_0x1c83f6(0x100)]?function(_0x3594df,_0xc48fa2,_0x5d176c,_0x59b21d){const _0x2b88ad=a613_0x1c83f6;if(_0x59b21d===undefined)_0x59b21d=_0x5d176c;var _0x76003a=Object[_0x2b88ad(0xe5)](_0xc48fa2,_0x5d176c);(!_0x76003a||('get'in _0x76003a?!_0xc48fa2[_0x2b88ad(0xcf)]:_0x76003a['writable']||_0x76003a['configurable']))&&(_0x76003a={'enumerable':!![],'get':function(){return _0xc48fa2[_0x5d176c];}}),Object[_0x2b88ad(0xf9)](_0x3594df,_0x59b21d,_0x76003a);}:function(_0x226ff7,_0x5a62ba,_0x1f869c,_0x250192){if(_0x250192===undefined)_0x250192=_0x1f869c;_0x226ff7[_0x250192]=_0x5a62ba[_0x1f869c];}),__setModuleDefault=this&&this[a613_0x1c83f6(0x103)]||(Object[a613_0x1c83f6(0x100)]?function(_0x48195d,_0x467434){const _0x448695=a613_0x1c83f6;Object['defineProperty'](_0x48195d,_0x448695(0x104),{'enumerable':!![],'value':_0x467434});}:function(_0x4520f0,_0x3264e1){const _0x5637cd=a613_0x1c83f6;_0x4520f0[_0x5637cd(0x104)]=_0x3264e1;}),__importStar=this&&this[a613_0x1c83f6(0x105)]||(function(){const _0x3ec257=(function(){let _0x3a573f=!![];return function(_0x4ed089,_0x271f0f){const _0x5bdc9e=_0x3a573f?function(){const _0x5ce226=a613_0x11ca;if(_0x271f0f){const _0x3e67d9=_0x271f0f[_0x5ce226(0xec)](_0x4ed089,arguments);return _0x271f0f=null,_0x3e67d9;}}:function(){};return _0x3a573f=![],_0x5bdc9e;};}()),_0xd2a751=_0x3ec257(this,function(){const _0x2126ae=a613_0x11ca;return _0xd2a751['toString']()[_0x2126ae(0xf0)](_0x2126ae(0xe7))[_0x2126ae(0xfd)]()[_0x2126ae(0xf3)](_0xd2a751)[_0x2126ae(0xf0)]('(((.+)+)+)+$');});_0xd2a751();var _0x55a743=function(_0x3dc2f4){return _0x55a743=Object['getOwnPropertyNames']||function(_0x64aa0e){const _0x4effe8=a613_0x11ca;var _0x1b82ec=[];for(var _0x14dc57 in _0x64aa0e)if(Object[_0x4effe8(0xe9)][_0x4effe8(0xe8)][_0x4effe8(0xd1)](_0x64aa0e,_0x14dc57))_0x1b82ec[_0x1b82ec[_0x4effe8(0x106)]]=_0x14dc57;return _0x1b82ec;},_0x55a743(_0x3dc2f4);};return function(_0x10a2bf){const _0x4bd02b=a613_0x11ca;if(_0x10a2bf&&_0x10a2bf[_0x4bd02b(0xcf)])return _0x10a2bf;var _0x3d10de={};if(_0x10a2bf!=null){for(var _0x487dd4=_0x55a743(_0x10a2bf),_0x52be46=0x0;_0x52be46<_0x487dd4[_0x4bd02b(0x106)];_0x52be46++)if(_0x487dd4[_0x52be46]!==_0x4bd02b(0x104))__createBinding(_0x3d10de,_0x10a2bf,_0x487dd4[_0x52be46]);}return __setModuleDefault(_0x3d10de,_0x10a2bf),_0x3d10de;};}()),__importDefault=this&&this['__importDefault']||function(_0x2d442a){const _0x23ae0f=a613_0x1c83f6;return _0x2d442a&&_0x2d442a[_0x23ae0f(0xcf)]?_0x2d442a:{'default':_0x2d442a};};Object[a613_0x1c83f6(0xf9)](exports,a613_0x1c83f6(0xcf),{'value':!![]});function a613_0x11ca(_0x53ac5c,_0x5b5c8f){const _0x1aa58a=a613_0x3b24();return a613_0x11ca=function(_0x453950,_0x1b6faa){_0x453950=_0x453950-0xce;let _0x3b242b=_0x1aa58a[_0x453950];return _0x3b242b;},a613_0x11ca(_0x53ac5c,_0x5b5c8f);}const Yup=__importStar(require(a613_0x1c83f6(0xd9))),AppError_1=__importDefault(require(a613_0x1c83f6(0xdd))),Queue_1=__importDefault(require(a613_0x1c83f6(0xf7))),Company_1=__importDefault(require('../../models/Company')),Plan_1=__importDefault(require(a613_0x1c83f6(0xd2))),CreateQueueService=async _0x122298=>{const _0x381374=a613_0x1c83f6,{color:_0x23e915,name:_0x3705db,companyId:_0x5dbc0d,orderQueue:_0x56006b}=_0x122298,_0x3502f4=await Company_1[_0x381374(0x104)]['findOne']({'where':{'id':_0x5dbc0d},'include':[{'model':Plan_1[_0x381374(0x104)],'as':_0x381374(0xf2)}]});if(_0x3502f4!==null){const _0x329feb=await Queue_1[_0x381374(0x104)][_0x381374(0xd7)]({'where':{'companyId':_0x5dbc0d}});if(_0x329feb>=_0x3502f4['plan'][_0x381374(0xfa)])throw new AppError_1[(_0x381374(0x104))](_0x381374(0xe6)+_0x329feb);}const _0x1ceb53=Yup['object']()[_0x381374(0xd5)]({'name':Yup[_0x381374(0xeb)]()['min'](0x2,_0x381374(0x108))['required'](_0x381374(0x108))[_0x381374(0xed)](_0x381374(0xdb),_0x381374(0xe0),async _0x43d8d4=>{const _0x4b92a4=_0x381374;if(_0x43d8d4){const _0x60c2b3=await Queue_1[_0x4b92a4(0x104)][_0x4b92a4(0xfb)]({'where':{'name':_0x43d8d4,'companyId':_0x5dbc0d}});return!_0x60c2b3;}return![];}),'color':Yup[_0x381374(0xeb)]()[_0x381374(0xea)](_0x381374(0xd8))[_0x381374(0xed)](_0x381374(0xe4),'ERR_QUEUE_INVALID_COLOR',async _0x2e93f9=>{const _0x4b51cc=_0x381374;if(_0x2e93f9){const _0x23e5c4=/^#[0-9a-f]{3,6}$/i;return _0x23e5c4[_0x4b51cc(0xed)](_0x2e93f9);}return![];})[_0x381374(0xed)](_0x381374(0xdc),_0x381374(0xd0),async _0x18ec98=>{const _0x5a6128=_0x381374;if(_0x18ec98){const _0x216446=await Queue_1[_0x5a6128(0x104)][_0x5a6128(0xfb)]({'where':{'color':_0x18ec98,'companyId':_0x5dbc0d}});return!_0x216446;}return![];}),'orderQueue':Yup[_0x381374(0xfe)]()[_0x381374(0xda)]((_0x49775c,_0x52bd90)=>{return _0x52bd90===''?undefined:_0x49775c;})[_0x381374(0xce)]('ERR_QUEUE_ORDER_REQUIRED')[_0x381374(0xea)](_0x381374(0xe2))[_0x381374(0xff)](0x1,_0x381374(0xd3))[_0x381374(0xee)](_0x381374(0xd3))[_0x381374(0xed)](_0x381374(0x102),_0x381374(0xe1),async _0xe1c5e3=>{const _0x25019d=_0x381374;if(_0xe1c5e3&&_0xe1c5e3>=0x1){const _0x4d3a46=await Queue_1['default'][_0x25019d(0xfb)]({'where':{'orderQueue':_0xe1c5e3,'companyId':_0x5dbc0d}});return!_0x4d3a46;}return!![];})});try{await _0x1ceb53[_0x381374(0xf4)]({'color':_0x23e915,'name':_0x3705db,'orderQueue':_0x56006b});}catch(_0x1f434c){throw new AppError_1[(_0x381374(0x104))](_0x1f434c[_0x381374(0xdf)]);}const _0x199542=await Queue_1[_0x381374(0x104)]['create'](_0x122298);return _0x199542;};exports[a613_0x1c83f6(0x104)]=CreateQueueService;