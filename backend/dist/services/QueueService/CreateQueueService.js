'use strict';const a498_0x35b5fd=a498_0x3bd0;function a498_0x5f0f(){const _0x4ad8c7=['6990245FLGkwK','defineProperty','372KwGQEr','hasOwnProperty','__setModuleDefault','816112soldEh','default','plan','__importStar','validate','getOwnPropertyDescriptor','24670870rvwuhU','call','(((.+)+)+)+$','required','getOwnPropertyNames','apply','1422176nUPOqt','25578nlreTd','findOne','string','object','__esModule','ERR_QUEUE_NAME_ALREADY_EXISTS','Check-color','search','length','queues','message','9594011UdGqfu','6peXvJi','__createBinding','772547SkpFcB','ERR_QUEUE_INVALID_NAME','test','../../models/Queue','36rKIRMC','min','prototype','Número\x20máximo\x20de\x20filas\x20já\x20alcançado:\x20','get','toString','shape','configurable','writable','__importDefault','../../models/Plan','create','../../models/Company'];a498_0x5f0f=function(){return _0x4ad8c7;};return a498_0x5f0f();}(function(_0x1efafd,_0x1a92d4){const _0x2d438a=a498_0x3bd0,_0x231d8d=_0x1efafd();while(!![]){try{const _0x22c661=-parseInt(_0x2d438a(0x185))/0x1+parseInt(_0x2d438a(0x177))/0x2*(-parseInt(_0x2d438a(0x198))/0x3)+parseInt(_0x2d438a(0x176))/0x4+-parseInt(_0x2d438a(0x196))/0x5+parseInt(_0x2d438a(0x183))/0x6*(parseInt(_0x2d438a(0x182))/0x7)+parseInt(_0x2d438a(0x19b))/0x8*(parseInt(_0x2d438a(0x189))/0x9)+parseInt(_0x2d438a(0x170))/0xa;if(_0x22c661===_0x1a92d4)break;else _0x231d8d['push'](_0x231d8d['shift']());}catch(_0x241874){_0x231d8d['push'](_0x231d8d['shift']());}}}(a498_0x5f0f,0xce41c));function a498_0x3bd0(_0x39bb1e,_0xd6b257){const _0x249baf=a498_0x5f0f();return a498_0x3bd0=function(_0xb1b5b1,_0x30a6a5){_0xb1b5b1=_0xb1b5b1-0x16c;let _0x5f0f99=_0x249baf[_0xb1b5b1];return _0x5f0f99;},a498_0x3bd0(_0x39bb1e,_0xd6b257);}var __createBinding=this&&this[a498_0x35b5fd(0x184)]||(Object[a498_0x35b5fd(0x194)]?function(_0x589f1a,_0x902bea,_0x5b367b,_0x370a89){const _0x13d577=a498_0x35b5fd;if(_0x370a89===undefined)_0x370a89=_0x5b367b;var _0x244451=Object[_0x13d577(0x16f)](_0x902bea,_0x5b367b);(!_0x244451||(_0x13d577(0x18d)in _0x244451?!_0x902bea[_0x13d577(0x17b)]:_0x244451[_0x13d577(0x191)]||_0x244451[_0x13d577(0x190)]))&&(_0x244451={'enumerable':!![],'get':function(){return _0x902bea[_0x5b367b];}}),Object[_0x13d577(0x197)](_0x589f1a,_0x370a89,_0x244451);}:function(_0x31911b,_0x5a7ead,_0x2cdec1,_0x36af13){if(_0x36af13===undefined)_0x36af13=_0x2cdec1;_0x31911b[_0x36af13]=_0x5a7ead[_0x2cdec1];}),__setModuleDefault=this&&this[a498_0x35b5fd(0x19a)]||(Object[a498_0x35b5fd(0x194)]?function(_0x188f0e,_0x4db1fa){const _0x5d3f06=a498_0x35b5fd;Object[_0x5d3f06(0x197)](_0x188f0e,_0x5d3f06(0x19c),{'enumerable':!![],'value':_0x4db1fa});}:function(_0x40ac1d,_0x4a3b34){const _0x380a5b=a498_0x35b5fd;_0x40ac1d[_0x380a5b(0x19c)]=_0x4a3b34;}),__importStar=this&&this[a498_0x35b5fd(0x16d)]||(function(){const _0x457587=(function(){let _0x7791ee=!![];return function(_0x5614ad,_0xf1dd98){const _0x1cf030=_0x7791ee?function(){const _0x1f53f8=a498_0x3bd0;if(_0xf1dd98){const _0x57538d=_0xf1dd98[_0x1f53f8(0x175)](_0x5614ad,arguments);return _0xf1dd98=null,_0x57538d;}}:function(){};return _0x7791ee=![],_0x1cf030;};}()),_0x3c244f=_0x457587(this,function(){const _0x20174c=a498_0x3bd0;return _0x3c244f[_0x20174c(0x18e)]()[_0x20174c(0x17e)](_0x20174c(0x172))[_0x20174c(0x18e)]()['constructor'](_0x3c244f)[_0x20174c(0x17e)](_0x20174c(0x172));});_0x3c244f();var _0x327a38=function(_0x349b7c){const _0xad12da=a498_0x3bd0;return _0x327a38=Object[_0xad12da(0x174)]||function(_0x103f6d){const _0x16324e=_0xad12da;var _0x322a52=[];for(var _0x1705d8 in _0x103f6d)if(Object[_0x16324e(0x18b)][_0x16324e(0x199)][_0x16324e(0x171)](_0x103f6d,_0x1705d8))_0x322a52[_0x322a52[_0x16324e(0x17f)]]=_0x1705d8;return _0x322a52;},_0x327a38(_0x349b7c);};return function(_0x43feab){const _0x5e2312=a498_0x3bd0;if(_0x43feab&&_0x43feab[_0x5e2312(0x17b)])return _0x43feab;var _0x1cadd2={};if(_0x43feab!=null){for(var _0x445f8c=_0x327a38(_0x43feab),_0x217f35=0x0;_0x217f35<_0x445f8c[_0x5e2312(0x17f)];_0x217f35++)if(_0x445f8c[_0x217f35]!=='default')__createBinding(_0x1cadd2,_0x43feab,_0x445f8c[_0x217f35]);}return __setModuleDefault(_0x1cadd2,_0x43feab),_0x1cadd2;};}()),__importDefault=this&&this[a498_0x35b5fd(0x192)]||function(_0x5b9c8f){const _0x29a6e0=a498_0x35b5fd;return _0x5b9c8f&&_0x5b9c8f[_0x29a6e0(0x17b)]?_0x5b9c8f:{'default':_0x5b9c8f};};Object[a498_0x35b5fd(0x197)](exports,a498_0x35b5fd(0x17b),{'value':!![]});const Yup=__importStar(require('yup')),AppError_1=__importDefault(require('../../errors/AppError')),Queue_1=__importDefault(require(a498_0x35b5fd(0x188))),Company_1=__importDefault(require(a498_0x35b5fd(0x195))),Plan_1=__importDefault(require(a498_0x35b5fd(0x193))),CreateQueueService=async _0x592dff=>{const _0x56b469=a498_0x35b5fd,{color:_0xe37dc8,name:_0x2fe0e6,companyId:_0x482e4b}=_0x592dff,_0x30b64b=await Company_1[_0x56b469(0x19c)][_0x56b469(0x178)]({'where':{'id':_0x482e4b},'include':[{'model':Plan_1[_0x56b469(0x19c)],'as':_0x56b469(0x16c)}]});if(_0x30b64b!==null){const _0xf7c1fa=await Queue_1[_0x56b469(0x19c)]['count']({'where':{'companyId':_0x482e4b}});if(_0xf7c1fa>=_0x30b64b[_0x56b469(0x16c)][_0x56b469(0x180)])throw new AppError_1[(_0x56b469(0x19c))](_0x56b469(0x18c)+_0xf7c1fa);}const _0xc2d577=Yup[_0x56b469(0x17a)]()[_0x56b469(0x18f)]({'name':Yup[_0x56b469(0x179)]()[_0x56b469(0x18a)](0x2,_0x56b469(0x186))['required'](_0x56b469(0x186))[_0x56b469(0x187)]('Check-unique-name',_0x56b469(0x17c),async _0xf4ecbb=>{const _0x3b4e61=_0x56b469;if(_0xf4ecbb){const _0x4f37c3=await Queue_1[_0x3b4e61(0x19c)][_0x3b4e61(0x178)]({'where':{'name':_0xf4ecbb,'companyId':_0x482e4b}});return!_0x4f37c3;}return![];}),'color':Yup[_0x56b469(0x179)]()[_0x56b469(0x173)]('ERR_QUEUE_INVALID_COLOR')[_0x56b469(0x187)](_0x56b469(0x17d),'ERR_QUEUE_INVALID_COLOR',async _0x169dc4=>{const _0x39d446=_0x56b469;if(_0x169dc4){const _0x52c783=/^#[0-9a-f]{3,6}$/i;return _0x52c783[_0x39d446(0x187)](_0x169dc4);}return![];})[_0x56b469(0x187)]('Check-color-exists','ERR_QUEUE_COLOR_ALREADY_EXISTS',async _0x3dff4f=>{const _0x2966d8=_0x56b469;if(_0x3dff4f){const _0x2f367b=await Queue_1[_0x2966d8(0x19c)][_0x2966d8(0x178)]({'where':{'color':_0x3dff4f,'companyId':_0x482e4b}});return!_0x2f367b;}return![];})});try{await _0xc2d577[_0x56b469(0x16e)]({'color':_0xe37dc8,'name':_0x2fe0e6});}catch(_0x59dcab){throw new AppError_1[(_0x56b469(0x19c))](_0x59dcab[_0x56b469(0x181)]);}const _0x3151be=await Queue_1[_0x56b469(0x19c)][_0x56b469(0x194)](_0x592dff);return _0x3151be;};exports[a498_0x35b5fd(0x19c)]=CreateQueueService;