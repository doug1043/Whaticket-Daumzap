const a474_0x38b8bf=a474_0x136e;(function(_0x24607c,_0x4dbc04){const _0x21f15b=a474_0x136e,_0x45ff77=_0x24607c();while(!![]){try{const _0x15d157=-parseInt(_0x21f15b(0x8e))/0x1+parseInt(_0x21f15b(0x95))/0x2+parseInt(_0x21f15b(0xa6))/0x3*(parseInt(_0x21f15b(0xb2))/0x4)+parseInt(_0x21f15b(0x9e))/0x5*(parseInt(_0x21f15b(0x8c))/0x6)+-parseInt(_0x21f15b(0xa2))/0x7+parseInt(_0x21f15b(0xb1))/0x8*(parseInt(_0x21f15b(0xac))/0x9)+parseInt(_0x21f15b(0xa9))/0xa*(-parseInt(_0x21f15b(0xba))/0xb);if(_0x15d157===_0x4dbc04)break;else _0x45ff77['push'](_0x45ff77['shift']());}catch(_0x3262f3){_0x45ff77['push'](_0x45ff77['shift']());}}}(a474_0x1ac4,0xf2ee6));function a474_0x1ac4(){const _0x130ca5=['min','ERR_QUEUE_INVALID_COLOR','7628292zfhfuk','hasOwnProperty','../../models/Queue','call','123TyxMML','count','Check-color-exists','24534010UsjfpH','prototype','__esModule','648plZnam','apply','plan','message','shape','211072cOnYXJ','142252apoSdE','queues','findOne','default','Check-unique-name','__importDefault','Número\x20máximo\x20de\x20filas\x20já\x20alcançado:\x20','ERR_QUEUE_COLOR_ALREADY_EXISTS','11zzTomi','6jJZWUQ','string','983186egYBWe','ERR_QUEUE_NAME_ALREADY_EXISTS','validate','writable','../../models/Company','../../models/Plan','test','3816226MucFgg','required','search','getOwnPropertyDescriptor','toString','create','ERR_QUEUE_INVALID_NAME','defineProperty','(((.+)+)+)+$','1277725arZCPW','constructor'];a474_0x1ac4=function(){return _0x130ca5;};return a474_0x1ac4();}const a474_0x1a66ce=(function(){let _0x4a90fd=!![];return function(_0x1c4bf3,_0x5ede26){const _0x583393=_0x4a90fd?function(){const _0x2ea608=a474_0x136e;if(_0x5ede26){const _0x287252=_0x5ede26[_0x2ea608(0xad)](_0x1c4bf3,arguments);return _0x5ede26=null,_0x287252;}}:function(){};return _0x4a90fd=![],_0x583393;};}()),a474_0x490c71=a474_0x1a66ce(this,function(){const _0x26c30e=a474_0x136e;return a474_0x490c71[_0x26c30e(0x99)]()[_0x26c30e(0x97)](_0x26c30e(0x9d))[_0x26c30e(0x99)]()[_0x26c30e(0x9f)](a474_0x490c71)[_0x26c30e(0x97)](_0x26c30e(0x9d));});a474_0x490c71();'use strict';function a474_0x136e(_0x4858f3,_0x4444ca){const _0x4e6fd3=a474_0x1ac4();return a474_0x136e=function(_0x490c71,_0x1a66ce){_0x490c71=_0x490c71-0x8c;let _0x1ac470=_0x4e6fd3[_0x490c71];return _0x1ac470;},a474_0x136e(_0x4858f3,_0x4444ca);}var __createBinding=this&&this['__createBinding']||(Object[a474_0x38b8bf(0x9a)]?function(_0x129b3c,_0x51f777,_0x2defdb,_0x21a643){const _0x33c578=a474_0x38b8bf;if(_0x21a643===undefined)_0x21a643=_0x2defdb;var _0x450009=Object[_0x33c578(0x98)](_0x51f777,_0x2defdb);(!_0x450009||('get'in _0x450009?!_0x51f777[_0x33c578(0xab)]:_0x450009[_0x33c578(0x91)]||_0x450009['configurable']))&&(_0x450009={'enumerable':!![],'get':function(){return _0x51f777[_0x2defdb];}}),Object[_0x33c578(0x9c)](_0x129b3c,_0x21a643,_0x450009);}:function(_0x1fd941,_0x32ebee,_0x329b41,_0x723f2e){if(_0x723f2e===undefined)_0x723f2e=_0x329b41;_0x1fd941[_0x723f2e]=_0x32ebee[_0x329b41];}),__setModuleDefault=this&&this['__setModuleDefault']||(Object[a474_0x38b8bf(0x9a)]?function(_0x139b76,_0x5a46a7){const _0x2ea434=a474_0x38b8bf;Object[_0x2ea434(0x9c)](_0x139b76,'default',{'enumerable':!![],'value':_0x5a46a7});}:function(_0x580580,_0x3c633b){_0x580580['default']=_0x3c633b;}),__importStar=this&&this['__importStar']||function(_0x2f3f94){const _0x2f0ec0=a474_0x38b8bf;if(_0x2f3f94&&_0x2f3f94[_0x2f0ec0(0xab)])return _0x2f3f94;var _0x42b919={};if(_0x2f3f94!=null){for(var _0x4cf484 in _0x2f3f94)if(_0x4cf484!=='default'&&Object[_0x2f0ec0(0xaa)][_0x2f0ec0(0xa3)][_0x2f0ec0(0xa5)](_0x2f3f94,_0x4cf484))__createBinding(_0x42b919,_0x2f3f94,_0x4cf484);}return __setModuleDefault(_0x42b919,_0x2f3f94),_0x42b919;},__importDefault=this&&this[a474_0x38b8bf(0xb7)]||function(_0x1f6d01){const _0x3ed4af=a474_0x38b8bf;return _0x1f6d01&&_0x1f6d01[_0x3ed4af(0xab)]?_0x1f6d01:{'default':_0x1f6d01};};Object[a474_0x38b8bf(0x9c)](exports,a474_0x38b8bf(0xab),{'value':!![]});const Yup=__importStar(require('yup')),AppError_1=__importDefault(require('../../errors/AppError')),Queue_1=__importDefault(require(a474_0x38b8bf(0xa4))),Company_1=__importDefault(require(a474_0x38b8bf(0x92))),Plan_1=__importDefault(require(a474_0x38b8bf(0x93))),CreateQueueService=async _0x44519c=>{const _0x16aa2c=a474_0x38b8bf,{color:_0x26741d,name:_0x4c1fcb,companyId:_0xd110de}=_0x44519c,_0x42587e=await Company_1[_0x16aa2c(0xb5)][_0x16aa2c(0xb4)]({'where':{'id':_0xd110de},'include':[{'model':Plan_1[_0x16aa2c(0xb5)],'as':_0x16aa2c(0xae)}]});if(_0x42587e!==null){const _0x5de68e=await Queue_1[_0x16aa2c(0xb5)][_0x16aa2c(0xa7)]({'where':{'companyId':_0xd110de}});if(_0x5de68e>=_0x42587e[_0x16aa2c(0xae)][_0x16aa2c(0xb3)])throw new AppError_1[(_0x16aa2c(0xb5))](_0x16aa2c(0xb8)+_0x5de68e);}const _0x35f6d6=Yup['object']()[_0x16aa2c(0xb0)]({'name':Yup[_0x16aa2c(0x8d)]()[_0x16aa2c(0xa0)](0x2,_0x16aa2c(0x9b))[_0x16aa2c(0x96)]('ERR_QUEUE_INVALID_NAME')['test'](_0x16aa2c(0xb6),_0x16aa2c(0x8f),async _0x28402d=>{const _0x26db1d=_0x16aa2c;if(_0x28402d){const _0x19454f=await Queue_1[_0x26db1d(0xb5)][_0x26db1d(0xb4)]({'where':{'name':_0x28402d,'companyId':_0xd110de}});return!_0x19454f;}return![];}),'color':Yup['string']()['required']('ERR_QUEUE_INVALID_COLOR')[_0x16aa2c(0x94)]('Check-color',_0x16aa2c(0xa1),async _0x7643a7=>{const _0x23f128=_0x16aa2c;if(_0x7643a7){const _0x58988c=/^#[0-9a-f]{3,6}$/i;return _0x58988c[_0x23f128(0x94)](_0x7643a7);}return![];})[_0x16aa2c(0x94)](_0x16aa2c(0xa8),_0x16aa2c(0xb9),async _0x353e64=>{const _0x2b7a06=_0x16aa2c;if(_0x353e64){const _0x121a21=await Queue_1['default'][_0x2b7a06(0xb4)]({'where':{'color':_0x353e64,'companyId':_0xd110de}});return!_0x121a21;}return![];})});try{await _0x35f6d6[_0x16aa2c(0x90)]({'color':_0x26741d,'name':_0x4c1fcb});}catch(_0x493552){throw new AppError_1[(_0x16aa2c(0xb5))](_0x493552[_0x16aa2c(0xaf)]);}const _0x3cce1e=await Queue_1['default'][_0x16aa2c(0x9a)](_0x44519c);return _0x3cce1e;};exports[a474_0x38b8bf(0xb5)]=CreateQueueService;