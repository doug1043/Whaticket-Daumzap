const a388_0x51fb6e=a388_0x4125;(function(_0x17ad78,_0x3a1ae2){const _0x12f648=a388_0x4125,_0x504798=_0x17ad78();while(!![]){try{const _0x8d95fc=parseInt(_0x12f648(0x1a8))/0x1+parseInt(_0x12f648(0x1bc))/0x2*(parseInt(_0x12f648(0x1bf))/0x3)+parseInt(_0x12f648(0x1b7))/0x4*(parseInt(_0x12f648(0x1a6))/0x5)+-parseInt(_0x12f648(0x1a0))/0x6+parseInt(_0x12f648(0x1b9))/0x7+parseInt(_0x12f648(0x1af))/0x8+-parseInt(_0x12f648(0x1ab))/0x9;if(_0x8d95fc===_0x3a1ae2)break;else _0x504798['push'](_0x504798['shift']());}catch(_0x36adbc){_0x504798['push'](_0x504798['shift']());}}}(a388_0x3489,0x7a2e4));const a388_0x5a5a96=(function(){let _0x1b3b80=!![];return function(_0x6ccdb2,_0xc97a64){const _0x6d7bc5=_0x1b3b80?function(){const _0x5bbf97=a388_0x4125;if(_0xc97a64){const _0x8d97bb=_0xc97a64[_0x5bbf97(0x1b5)](_0x6ccdb2,arguments);return _0xc97a64=null,_0x8d97bb;}}:function(){};return _0x1b3b80=![],_0x6d7bc5;};}()),a388_0x3ea68b=a388_0x5a5a96(this,function(){const _0x5456c3=a388_0x4125;return a388_0x3ea68b[_0x5456c3(0x1a3)]()[_0x5456c3(0x1a5)](_0x5456c3(0x1a4))[_0x5456c3(0x1a3)]()[_0x5456c3(0x1b2)](a388_0x3ea68b)[_0x5456c3(0x1a5)](_0x5456c3(0x1a4));});a388_0x3ea68b();'use strict';function a388_0x3489(){const _0xb7ab8b=['ERR_SESSION_EXPIRED','toString','(((.+)+)+)+$','search','5qvLDaB','clearCookie','312911sHLyIj','__esModule','createAccessToken','13704318CsKcPq','../../helpers/CreateTokens','../../config/auth','company','5513160UzXAyG','ERR_SUBSCRIPTION_EXPIRED','verify','constructor','jsonwebtoken','createRefreshToken','apply','RefreshTokenService','111236rlVJgo','default','1418410IbODuD','defineProperty','refreshSecret','66FGVSXP','../UserServices/ShowUserService','jrt','77769NqQaEW','388800xSfFWw','__importDefault'];a388_0x3489=function(){return _0xb7ab8b;};return a388_0x3489();}function a388_0x4125(_0x1dd656,_0x411511){const _0x1b6950=a388_0x3489();return a388_0x4125=function(_0x3ea68b,_0x5a5a96){_0x3ea68b=_0x3ea68b-0x1a0;let _0x348979=_0x1b6950[_0x3ea68b];return _0x348979;},a388_0x4125(_0x1dd656,_0x411511);}var __importDefault=this&&this[a388_0x51fb6e(0x1a1)]||function(_0x54b02d){return _0x54b02d&&_0x54b02d['__esModule']?_0x54b02d:{'default':_0x54b02d};};Object[a388_0x51fb6e(0x1ba)](exports,a388_0x51fb6e(0x1a9),{'value':!![]}),exports[a388_0x51fb6e(0x1b6)]=void 0x0;const jsonwebtoken_1=require(a388_0x51fb6e(0x1b3)),AppError_1=__importDefault(require('../../errors/AppError')),ShowUserService_1=__importDefault(require(a388_0x51fb6e(0x1bd))),auth_1=__importDefault(require(a388_0x51fb6e(0x1ad))),CreateTokens_1=require(a388_0x51fb6e(0x1ac)),RefreshTokenService=async(_0x17e724,_0x49b524)=>{const _0x1f2d28=a388_0x51fb6e;try{const _0x41e022=(0x0,jsonwebtoken_1[_0x1f2d28(0x1b1)])(_0x49b524,auth_1['default'][_0x1f2d28(0x1bb)]),{id:_0x2bd5c3,tokenVersion:_0x502898}=_0x41e022,_0x903268=await(0x0,ShowUserService_1[_0x1f2d28(0x1b8)])(_0x2bd5c3);if(_0x903268['tokenVersion']!==_0x502898){_0x17e724[_0x1f2d28(0x1a7)](_0x1f2d28(0x1be));throw new AppError_1[(_0x1f2d28(0x1b8))](_0x1f2d28(0x1a2),0x191);}const _0x5dca99=new Date(_0x903268[_0x1f2d28(0x1ae)]['dueDate']);if(new Date()>_0x5dca99)throw new AppError_1[(_0x1f2d28(0x1b8))](_0x1f2d28(0x1b0),0x191);const _0x390490=(0x0,CreateTokens_1[_0x1f2d28(0x1aa)])(_0x903268),_0x262e84=(0x0,CreateTokens_1[_0x1f2d28(0x1b4)])(_0x903268);return{'user':_0x903268,'newToken':_0x390490,'refreshToken':_0x262e84};}catch(_0x56fbc7){_0x17e724[_0x1f2d28(0x1a7)](_0x1f2d28(0x1be));throw new AppError_1[(_0x1f2d28(0x1b8))](_0x1f2d28(0x1a2),0x191);}};exports[a388_0x51fb6e(0x1b6)]=RefreshTokenService;