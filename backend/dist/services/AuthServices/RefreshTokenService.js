const a478_0x44be20=a478_0x2142;(function(_0x1360d0,_0x3aba10){const _0x486dab=a478_0x2142,_0x3b0566=_0x1360d0();while(!![]){try{const _0x5b6d10=parseInt(_0x486dab(0xd9))/0x1+parseInt(_0x486dab(0xe8))/0x2*(-parseInt(_0x486dab(0xe7))/0x3)+parseInt(_0x486dab(0xd8))/0x4*(parseInt(_0x486dab(0xde))/0x5)+parseInt(_0x486dab(0xf5))/0x6*(-parseInt(_0x486dab(0xf2))/0x7)+-parseInt(_0x486dab(0xe9))/0x8+parseInt(_0x486dab(0xec))/0x9+parseInt(_0x486dab(0xdb))/0xa*(parseInt(_0x486dab(0xda))/0xb);if(_0x5b6d10===_0x3aba10)break;else _0x3b0566['push'](_0x3b0566['shift']());}catch(_0x3df294){_0x3b0566['push'](_0x3b0566['shift']());}}}(a478_0x318c,0xf0250));const a478_0x3a10a6=(function(){let _0x3f605f=!![];return function(_0x378ec7,_0x5a9634){const _0x157129=_0x3f605f?function(){if(_0x5a9634){const _0x31cf85=_0x5a9634['apply'](_0x378ec7,arguments);return _0x5a9634=null,_0x31cf85;}}:function(){};return _0x3f605f=![],_0x157129;};}()),a478_0xa1bc1b=a478_0x3a10a6(this,function(){const _0x5924e2=a478_0x2142;return a478_0xa1bc1b[_0x5924e2(0xe6)]()[_0x5924e2(0xe3)](_0x5924e2(0xdf))[_0x5924e2(0xe6)]()[_0x5924e2(0xea)](a478_0xa1bc1b)[_0x5924e2(0xe3)](_0x5924e2(0xdf));});function a478_0x318c(){const _0x389494=['../../helpers/CreateTokens','company','toString','8094Kqjecg','710EupgSU','1192272sBvxcg','constructor','refreshSecret','5093154ZayRXa','SerializeUser','jsonwebtoken','RefreshTokenService','../../helpers/SerializeUser','createRefreshToken','41090kAbdUL','createAccessToken','jrt','534PZtrIQ','__importDefault','dueDate','4gPqVwI','1282930AowgNt','286NDfCNz','136960nhiFjh','../UserServices/ShowUserService','ERR_SESSION_EXPIRED','2039770HqBTte','(((.+)+)+)+$','clearCookie','default','defineProperty','search'];a478_0x318c=function(){return _0x389494;};return a478_0x318c();}a478_0xa1bc1b();'use strict';var __importDefault=this&&this[a478_0x44be20(0xf6)]||function(_0x4e79d0){return _0x4e79d0&&_0x4e79d0['__esModule']?_0x4e79d0:{'default':_0x4e79d0};};function a478_0x2142(_0x5de59a,_0x588bdf){const _0x6728b3=a478_0x318c();return a478_0x2142=function(_0xa1bc1b,_0x3a10a6){_0xa1bc1b=_0xa1bc1b-0xd8;let _0x318ca3=_0x6728b3[_0xa1bc1b];return _0x318ca3;},a478_0x2142(_0x5de59a,_0x588bdf);}Object[a478_0x44be20(0xe2)](exports,'__esModule',{'value':!![]}),exports[a478_0x44be20(0xef)]=void 0x0;const jsonwebtoken_1=require(a478_0x44be20(0xee)),AppError_1=__importDefault(require('../../errors/AppError')),ShowUserService_1=__importDefault(require(a478_0x44be20(0xdc))),auth_1=__importDefault(require('../../config/auth')),CreateTokens_1=require(a478_0x44be20(0xe4)),SerializeUser_1=require(a478_0x44be20(0xf0)),RefreshTokenService=async(_0x3d5bb8,_0x69ce87)=>{const _0x1d0254=a478_0x44be20;try{const _0x59e5ac=(0x0,jsonwebtoken_1['verify'])(_0x69ce87,auth_1['default'][_0x1d0254(0xeb)]),{id:_0x2d18c1,tokenVersion:_0x3d3dfb}=_0x59e5ac,_0x23e3b8=await(0x0,ShowUserService_1['default'])(_0x2d18c1);if(_0x23e3b8['tokenVersion']!==_0x3d3dfb){_0x3d5bb8[_0x1d0254(0xe0)](_0x1d0254(0xf4));throw new AppError_1[(_0x1d0254(0xe1))](_0x1d0254(0xdd),0x191);}const _0xa2cca0=new Date(_0x23e3b8[_0x1d0254(0xe5)][_0x1d0254(0xf7)]);if(new Date()>_0xa2cca0)throw new AppError_1[(_0x1d0254(0xe1))]('ERR_SUBSCRIPTION_EXPIRED',0x191);const _0x51d27d=(0x0,CreateTokens_1[_0x1d0254(0xf3)])(_0x23e3b8),_0x1da774=(0x0,CreateTokens_1[_0x1d0254(0xf1)])(_0x23e3b8),_0x1532b0=await(0x0,SerializeUser_1[_0x1d0254(0xed)])(_0x23e3b8);return{'user':_0x1532b0,'newToken':_0x51d27d,'refreshToken':_0x1da774};}catch(_0x1ae957){_0x3d5bb8['clearCookie'](_0x1d0254(0xf4));throw new AppError_1[(_0x1d0254(0xe1))](_0x1d0254(0xdd),0x191);}};exports[a478_0x44be20(0xef)]=RefreshTokenService;