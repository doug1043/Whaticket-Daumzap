const a398_0x3a9949=a398_0x12b3;(function(_0x231f9e,_0x193b29){const _0xbae028=a398_0x12b3,_0x311d21=_0x231f9e();while(!![]){try{const _0x5f4f6a=-parseInt(_0xbae028(0x1f5))/0x1+-parseInt(_0xbae028(0x1ff))/0x2*(parseInt(_0xbae028(0x1fb))/0x3)+-parseInt(_0xbae028(0x1f2))/0x4*(parseInt(_0xbae028(0x203))/0x5)+-parseInt(_0xbae028(0x1f1))/0x6*(-parseInt(_0xbae028(0x1fa))/0x7)+-parseInt(_0xbae028(0x208))/0x8*(-parseInt(_0xbae028(0x1f9))/0x9)+parseInt(_0xbae028(0x1f7))/0xa+parseInt(_0xbae028(0x1f4))/0xb*(parseInt(_0xbae028(0x1fd))/0xc);if(_0x5f4f6a===_0x193b29)break;else _0x311d21['push'](_0x311d21['shift']());}catch(_0x101647){_0x311d21['push'](_0x311d21['shift']());}}}(a398_0x3675,0x5450d));const a398_0x444281=(function(){let _0x38dc5e=!![];return function(_0x167e15,_0x3a54ff){const _0x4a9b59=_0x38dc5e?function(){const _0x46672e=a398_0x12b3;if(_0x3a54ff){const _0x54d13d=_0x3a54ff[_0x46672e(0x201)](_0x167e15,arguments);return _0x3a54ff=null,_0x54d13d;}}:function(){};return _0x38dc5e=![],_0x4a9b59;};}()),a398_0x1d9eb7=a398_0x444281(this,function(){const _0x298ea7=a398_0x12b3;return a398_0x1d9eb7[_0x298ea7(0x205)]()[_0x298ea7(0x209)]('(((.+)+)+)+$')[_0x298ea7(0x205)]()['constructor'](a398_0x1d9eb7)['search']('(((.+)+)+)+$');});a398_0x1d9eb7();function a398_0x12b3(_0x5a56e1,_0x4511cc){const _0x5c79a7=a398_0x3675();return a398_0x12b3=function(_0x1d9eb7,_0x444281){_0x1d9eb7=_0x1d9eb7-0x1ec;let _0x367551=_0x5c79a7[_0x1d9eb7];return _0x367551;},a398_0x12b3(_0x5a56e1,_0x4511cc);}'use strict';function a398_0x3675(){const _0x787dcb=['RefreshTokenService','refreshSecret','defineProperty','../UserServices/ShowUserService','../../config/auth','3228hVRiiq','45868CzPCEA','ERR_SESSION_EXPIRED','11Cpqqan','164441mqHUWE','../../helpers/CreateTokens','4846400dqlpuc','../../errors/AppError','6534YOfYwg','1652qOXvbI','6rljczJ','__importDefault','8446476kRWImU','tokenVersion','200278TBZDfZ','verify','apply','default','295WMcArx','__esModule','toString','createRefreshToken','createAccessToken','784ASYxVw','search','jrt'];a398_0x3675=function(){return _0x787dcb;};return a398_0x3675();}var __importDefault=this&&this[a398_0x3a9949(0x1fc)]||function(_0x484199){const _0x46bc96=a398_0x3a9949;return _0x484199&&_0x484199[_0x46bc96(0x204)]?_0x484199:{'default':_0x484199};};Object[a398_0x3a9949(0x1ee)](exports,a398_0x3a9949(0x204),{'value':!![]}),exports[a398_0x3a9949(0x1ec)]=void 0x0;const jsonwebtoken_1=require('jsonwebtoken'),AppError_1=__importDefault(require(a398_0x3a9949(0x1f8))),ShowUserService_1=__importDefault(require(a398_0x3a9949(0x1ef))),auth_1=__importDefault(require(a398_0x3a9949(0x1f0))),CreateTokens_1=require(a398_0x3a9949(0x1f6)),RefreshTokenService=async(_0x2ce77b,_0x445b17)=>{const _0x3b2b85=a398_0x3a9949;try{const _0x47ae86=(0x0,jsonwebtoken_1[_0x3b2b85(0x200)])(_0x445b17,auth_1['default'][_0x3b2b85(0x1ed)]),{id:_0x37bf13,tokenVersion:_0x7b1d3c}=_0x47ae86,_0x6a14d6=await(0x0,ShowUserService_1['default'])(_0x37bf13);if(_0x6a14d6[_0x3b2b85(0x1fe)]!==_0x7b1d3c){_0x2ce77b['clearCookie']('jrt');throw new AppError_1['default']('ERR_SESSION_EXPIRED',0x191);}const _0x3c744c=new Date(_0x6a14d6['company']['dueDate']);if(new Date()>_0x3c744c)throw new AppError_1['default']('ERR_SUBSCRIPTION_EXPIRED',0x191);const _0x590c0f=(0x0,CreateTokens_1[_0x3b2b85(0x207)])(_0x6a14d6),_0x14c7aa=(0x0,CreateTokens_1[_0x3b2b85(0x206)])(_0x6a14d6);return{'user':_0x6a14d6,'newToken':_0x590c0f,'refreshToken':_0x14c7aa};}catch(_0x27953b){_0x2ce77b['clearCookie'](_0x3b2b85(0x20a));throw new AppError_1[(_0x3b2b85(0x202))](_0x3b2b85(0x1f3),0x191);}};exports[a398_0x3a9949(0x1ec)]=RefreshTokenService;