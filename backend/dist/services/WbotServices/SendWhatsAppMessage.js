const a551_0x405bac=a551_0x3934;(function(_0x2bd46c,_0x552fa4){const _0x589bce=a551_0x3934,_0x434bc4=_0x2bd46c();while(!![]){try{const _0xa4b8bc=parseInt(_0x589bce(0x1df))/0x1*(parseInt(_0x589bce(0x1f7))/0x2)+parseInt(_0x589bce(0x1d1))/0x3+parseInt(_0x589bce(0x1fd))/0x4*(-parseInt(_0x589bce(0x1f8))/0x5)+parseInt(_0x589bce(0x1e1))/0x6*(-parseInt(_0x589bce(0x1c8))/0x7)+parseInt(_0x589bce(0x1f6))/0x8+parseInt(_0x589bce(0x1eb))/0x9*(-parseInt(_0x589bce(0x1e6))/0xa)+parseInt(_0x589bce(0x1e4))/0xb;if(_0xa4b8bc===_0x552fa4)break;else _0x434bc4['push'](_0x434bc4['shift']());}catch(_0x1285d7){_0x434bc4['push'](_0x434bc4['shift']());}}}(a551_0x3925,0x79f78));const a551_0x3fa230=(function(){let _0x3d9e69=!![];return function(_0x946061,_0xa82860){const _0x3c7e90=_0x3d9e69?function(){if(_0xa82860){const _0xa3a262=_0xa82860['apply'](_0x946061,arguments);return _0xa82860=null,_0xa3a262;}}:function(){};return _0x3d9e69=![],_0x3c7e90;};}()),a551_0x1bdc00=a551_0x3fa230(this,function(){const _0x2fec1c=a551_0x3934;return a551_0x1bdc00[_0x2fec1c(0x1ea)]()[_0x2fec1c(0x1e8)]('(((.+)+)+)+$')[_0x2fec1c(0x1ea)]()[_0x2fec1c(0x1f4)](a551_0x1bdc00)['search'](_0x2fec1c(0x1f5));});a551_0x1bdc00();'use strict';var __createBinding=this&&this[a551_0x405bac(0x1d3)]||(Object[a551_0x405bac(0x1d6)]?function(_0x272a63,_0x37ac13,_0x1718d1,_0x4a2a4e){const _0x102a72=a551_0x405bac;if(_0x4a2a4e===undefined)_0x4a2a4e=_0x1718d1;var _0x34fd7d=Object[_0x102a72(0x1ef)](_0x37ac13,_0x1718d1);(!_0x34fd7d||(_0x102a72(0x1ee)in _0x34fd7d?!_0x37ac13[_0x102a72(0x1fc)]:_0x34fd7d[_0x102a72(0x1e3)]||_0x34fd7d['configurable']))&&(_0x34fd7d={'enumerable':!![],'get':function(){return _0x37ac13[_0x1718d1];}}),Object[_0x102a72(0x1d5)](_0x272a63,_0x4a2a4e,_0x34fd7d);}:function(_0x3974ba,_0x1d4ca8,_0x2aa4b3,_0x11e5d1){if(_0x11e5d1===undefined)_0x11e5d1=_0x2aa4b3;_0x3974ba[_0x11e5d1]=_0x1d4ca8[_0x2aa4b3];}),__setModuleDefault=this&&this[a551_0x405bac(0x1f2)]||(Object[a551_0x405bac(0x1d6)]?function(_0x316d10,_0x21e978){const _0x1c4cac=a551_0x405bac;Object['defineProperty'](_0x316d10,_0x1c4cac(0x1d7),{'enumerable':!![],'value':_0x21e978});}:function(_0xf9bf6d,_0x26c25f){_0xf9bf6d['default']=_0x26c25f;}),__importStar=this&&this[a551_0x405bac(0x1d0)]||function(_0x167cab){const _0x467472=a551_0x405bac;if(_0x167cab&&_0x167cab[_0x467472(0x1fc)])return _0x167cab;var _0x17bfce={};if(_0x167cab!=null){for(var _0x5d7db5 in _0x167cab)if(_0x5d7db5!==_0x467472(0x1d7)&&Object[_0x467472(0x1dd)][_0x467472(0x1cb)]['call'](_0x167cab,_0x5d7db5))__createBinding(_0x17bfce,_0x167cab,_0x5d7db5);}return __setModuleDefault(_0x17bfce,_0x167cab),_0x17bfce;},__importDefault=this&&this['__importDefault']||function(_0x5b573e){const _0x5550b5=a551_0x405bac;return _0x5b573e&&_0x5b573e[_0x5550b5(0x1fc)]?_0x5b573e:{'default':_0x5b573e};};function a551_0x3934(_0x35cf39,_0x5a6a2f){const _0x1f37b9=a551_0x3925();return a551_0x3934=function(_0x1bdc00,_0x3fa230){_0x1bdc00=_0x1bdc00-0x1c7;let _0x39252f=_0x1f37b9[_0x1bdc00];return _0x39252f;},a551_0x3934(_0x35cf39,_0x5a6a2f);}Object[a551_0x405bac(0x1d5)](exports,a551_0x405bac(0x1fc),{'value':!![]});const Sentry=__importStar(require(a551_0x405bac(0x1cc))),AppError_1=__importDefault(require(a551_0x405bac(0x1fa))),GetTicketWbot_1=__importDefault(require(a551_0x405bac(0x1f3))),Message_1=__importDefault(require(a551_0x405bac(0x1ce))),lodash_1=__importDefault(require(a551_0x405bac(0x1d2))),Mustache_1=__importDefault(require(a551_0x405bac(0x1de))),SendWhatsAppMessage=async({body:_0x500498,ticket:_0x29173f,quotedMsg:_0x3f533b,vCard:_0x1b4807})=>{const _0x385f3e=a551_0x405bac;let _0x167734={};const _0x280664=await(0x0,GetTicketWbot_1[_0x385f3e(0x1d7)])(_0x29173f);if(!_0x280664)throw new AppError_1[(_0x385f3e(0x1d7))](_0x385f3e(0x1fb));const _0xfe9f2d=_0x29173f[_0x385f3e(0x1ec)][_0x385f3e(0x1e0)]+'@'+(_0x29173f['isGroup']?_0x385f3e(0x1dc):_0x385f3e(0x1e7));if(_0x3f533b){const _0x5a4945=await Message_1[_0x385f3e(0x1d7)][_0x385f3e(0x1d8)]({'where':{'id':_0x3f533b['id']}});if(_0x5a4945){const _0x4824d6=JSON[_0x385f3e(0x1c7)](_0x5a4945[_0x385f3e(0x1cf)]);_0x167734={'quoted':{'key':_0x4824d6[_0x385f3e(0x1e9)]||_0x5a4945['id'],'message':{'extendedTextMessage':_0x4824d6?.[_0x385f3e(0x1ca)]['extendedTextMessage']}}};}}if(!lodash_1[_0x385f3e(0x1d7)]['isNil'](_0x1b4807)){const _0x153c74=_0x1b4807[_0x385f3e(0x1e0)],_0x4f7a28=_0x1b4807[_0x385f3e(0x1ed)][_0x385f3e(0x1fe)]('\x20')[0x0],_0x581113=String(_0x1b4807['name'])[_0x385f3e(0x1e5)](_0x1b4807['name'][_0x385f3e(0x1fe)]('\x20')[0x0],''),_0x9eab92=_0x385f3e(0x1d9)+('N:'+_0x581113+';'+_0x4f7a28+_0x385f3e(0x1c9))+(_0x385f3e(0x1e2)+_0x1b4807[_0x385f3e(0x1ed)]+'\x0a')+(_0x385f3e(0x1da)+_0x153c74+':+'+_0x153c74+'\x0a')+_0x385f3e(0x1cd);try{const _0x50ad0d=await _0x280664[_0x385f3e(0x1f9)](_0xfe9f2d,{'contacts':{'displayName':''+_0x1b4807['name'],'contacts':[{'vcard':_0x9eab92}]}});return await _0x29173f['update']({'lastMessage':(0x0,Mustache_1['default'])(_0x9eab92,_0x29173f),'imported':null}),_0x50ad0d;}catch(_0x53d846){Sentry[_0x385f3e(0x1d4)](_0x53d846),console[_0x385f3e(0x1f1)](_0x53d846);throw new AppError_1[(_0x385f3e(0x1d7))](_0x385f3e(0x1db));}}try{const _0x8cb66c=await _0x280664[_0x385f3e(0x1f9)](_0xfe9f2d,{'text':(0x0,Mustache_1['default'])(_0x500498,_0x29173f)},{..._0x167734});return await _0x29173f['update']({'lastMessage':(0x0,Mustache_1[_0x385f3e(0x1d7)])(_0x500498,_0x29173f)}),_0x8cb66c;}catch(_0xe18e6f){Sentry[_0x385f3e(0x1d4)](_0xe18e6f),console[_0x385f3e(0x1f0)](_0xe18e6f);throw new AppError_1[(_0x385f3e(0x1d7))](_0x385f3e(0x1db));}};function a551_0x3925(){const _0x176d75=['defineProperty','create','default','findOne','BEGIN:VCARD\x0aVERSION:3.0\x0a','TEL;type=CELL;waid=','ERR_SENDING_WAPP_MSG','g.us','prototype','../../helpers/Mustache','1MRqOUQ','number','6xUZVRD','FN:','writable','4475779RxIUqW','replace','1064330EzzxBP','s.whatsapp.net','search','key','toString','9sVUTEC','contact','name','get','getOwnPropertyDescriptor','log','trace','__setModuleDefault','../../helpers/GetTicketWbot','constructor','(((.+)+)+)+$','1074448SaGRjM','1505026tlMhBv','635VFiiZG','sendMessage','../../errors/AppError','ERR_WBOT_NOT_FOUND','__esModule','27868YzPmie','split','parse','5240515SqcpgL',';;;\x0a','message','hasOwnProperty','@sentry/node','END:VCARD','../../models/Message','dataJson','__importStar','2837265NvKPMi','lodash','__createBinding','captureException'];a551_0x3925=function(){return _0x176d75;};return a551_0x3925();}exports[a551_0x405bac(0x1d7)]=SendWhatsAppMessage;