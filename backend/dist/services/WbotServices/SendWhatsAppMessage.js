function a542_0x580a(){const _0x540f08=['BEGIN:VCARD\x0aVERSION:3.0\x0a','ERR_WBOT_NOT_FOUND','23962xuZuIo','constructor','601610RBBOxW','../../errors/AppError','(((.+)+)+)+$','28iNNFwm','../../models/Message','includes','3472197PXUCFg','75SByVSv','error','../../helpers/Mustache','call','18fzrjtR','writable','findOne','message','ERR_INVALID_QUOTED_MSG','g.us','__esModule','getOwnPropertyDescriptor','replace','toString','create','split','dataJson','update','captureException','key','parse','contact','__createBinding','default','hasOwnProperty','defineProperty','isNil','FN:','number','name','4541390qjNVKU','ERR_INVALID_MESSAGE_BODY','__importStar','__setModuleDefault','Erro\x20ao\x20enviar\x20vCard:','ERR_INVALID_JID','lodash','extendedTextMessage','546984HBMBSC','isGroup','prototype','Erro\x20ao\x20enviar\x20mensagem\x20de\x20texto:','get','9739806sLznmy',';;;\x0a','sendMessage','configurable','11883140OKcbOo','search','ERR_INVALID_TICKET','ERR_SENDING_WAPP_MSG','apply','__importDefault'];a542_0x580a=function(){return _0x540f08;};return a542_0x580a();}const a542_0x4a02cf=a542_0xac32;(function(_0x29057f,_0x4da87c){const _0x4db8c1=a542_0xac32,_0x175f17=_0x29057f();while(!![]){try{const _0x1e8ef1=parseInt(_0x4db8c1(0xa5))/0x1*(-parseInt(_0x4db8c1(0x9c))/0x2)+parseInt(_0x4db8c1(0xa4))/0x3+-parseInt(_0x4db8c1(0xa1))/0x4*(parseInt(_0x4db8c1(0x9e))/0x5)+-parseInt(_0x4db8c1(0x90))/0x6+parseInt(_0x4db8c1(0x83))/0x7+parseInt(_0x4db8c1(0x8b))/0x8+-parseInt(_0x4db8c1(0xa9))/0x9*(-parseInt(_0x4db8c1(0x94))/0xa);if(_0x1e8ef1===_0x4da87c)break;else _0x175f17['push'](_0x175f17['shift']());}catch(_0x1ad0df){_0x175f17['push'](_0x175f17['shift']());}}}(a542_0x580a,0xd8900));function a542_0xac32(_0xe2478c,_0x56ef9f){const _0x71da60=a542_0x580a();return a542_0xac32=function(_0x7fedb6,_0xacace7){_0x7fedb6=_0x7fedb6-0x7c;let _0x580aa2=_0x71da60[_0x7fedb6];return _0x580aa2;},a542_0xac32(_0xe2478c,_0x56ef9f);}const a542_0xacace7=(function(){let _0x1031a8=!![];return function(_0x4deed8,_0x34b2f3){const _0xc804b3=_0x1031a8?function(){const _0x2a4ca5=a542_0xac32;if(_0x34b2f3){const _0x46e31d=_0x34b2f3[_0x2a4ca5(0x98)](_0x4deed8,arguments);return _0x34b2f3=null,_0x46e31d;}}:function(){};return _0x1031a8=![],_0xc804b3;};}()),a542_0x7fedb6=a542_0xacace7(this,function(){const _0x401c69=a542_0xac32;return a542_0x7fedb6[_0x401c69(0xb2)]()[_0x401c69(0x95)](_0x401c69(0xa0))['toString']()[_0x401c69(0x9d)](a542_0x7fedb6)[_0x401c69(0x95)]('(((.+)+)+)+$');});a542_0x7fedb6();'use strict';var __createBinding=this&&this[a542_0x4a02cf(0xbb)]||(Object[a542_0x4a02cf(0xb3)]?function(_0x5e0c1b,_0x13fd1d,_0x4199c9,_0x2d9a90){const _0x84b0e0=a542_0x4a02cf;if(_0x2d9a90===undefined)_0x2d9a90=_0x4199c9;var _0x194a24=Object[_0x84b0e0(0xb0)](_0x13fd1d,_0x4199c9);(!_0x194a24||(_0x84b0e0(0x8f)in _0x194a24?!_0x13fd1d[_0x84b0e0(0xaf)]:_0x194a24[_0x84b0e0(0xaa)]||_0x194a24[_0x84b0e0(0x93)]))&&(_0x194a24={'enumerable':!![],'get':function(){return _0x13fd1d[_0x4199c9];}}),Object[_0x84b0e0(0x7e)](_0x5e0c1b,_0x2d9a90,_0x194a24);}:function(_0x56834c,_0x4cedae,_0x5f2022,_0x35d4f0){if(_0x35d4f0===undefined)_0x35d4f0=_0x5f2022;_0x56834c[_0x35d4f0]=_0x4cedae[_0x5f2022];}),__setModuleDefault=this&&this[a542_0x4a02cf(0x86)]||(Object[a542_0x4a02cf(0xb3)]?function(_0x612110,_0x570b7b){Object['defineProperty'](_0x612110,'default',{'enumerable':!![],'value':_0x570b7b});}:function(_0x26d157,_0x3fe928){const _0x206e6e=a542_0x4a02cf;_0x26d157[_0x206e6e(0x7c)]=_0x3fe928;}),__importStar=this&&this[a542_0x4a02cf(0x85)]||function(_0x5ab91f){const _0x4ecdd8=a542_0x4a02cf;if(_0x5ab91f&&_0x5ab91f[_0x4ecdd8(0xaf)])return _0x5ab91f;var _0x3f9c24={};if(_0x5ab91f!=null){for(var _0x224130 in _0x5ab91f)if(_0x224130!==_0x4ecdd8(0x7c)&&Object[_0x4ecdd8(0x8d)][_0x4ecdd8(0x7d)][_0x4ecdd8(0xa8)](_0x5ab91f,_0x224130))__createBinding(_0x3f9c24,_0x5ab91f,_0x224130);}return __setModuleDefault(_0x3f9c24,_0x5ab91f),_0x3f9c24;},__importDefault=this&&this[a542_0x4a02cf(0x99)]||function(_0x49fcb0){const _0x11c1eb=a542_0x4a02cf;return _0x49fcb0&&_0x49fcb0[_0x11c1eb(0xaf)]?_0x49fcb0:{'default':_0x49fcb0};};Object['defineProperty'](exports,a542_0x4a02cf(0xaf),{'value':!![]});const Sentry=__importStar(require('@sentry/node')),AppError_1=__importDefault(require(a542_0x4a02cf(0x9f))),GetTicketWbot_1=__importDefault(require('../../helpers/GetTicketWbot')),Message_1=__importDefault(require(a542_0x4a02cf(0xa2))),lodash_1=__importDefault(require(a542_0x4a02cf(0x89))),Mustache_1=__importDefault(require(a542_0x4a02cf(0xa7))),SendWhatsAppMessage=async({body:_0x9cbe3b,ticket:_0x19a799,quotedMsg:_0x31af3f,vCard:_0x4c2e8a})=>{const _0x2f8b18=a542_0x4a02cf;let _0x421746={};if(!_0x19a799||!_0x19a799[_0x2f8b18(0xba)]||!_0x19a799[_0x2f8b18(0xba)][_0x2f8b18(0x81)])throw new AppError_1['default'](_0x2f8b18(0x96));const _0x3837b7=await(0x0,GetTicketWbot_1[_0x2f8b18(0x7c)])(_0x19a799);if(!_0x3837b7)throw new AppError_1[(_0x2f8b18(0x7c))](_0x2f8b18(0x9b));const _0x66961e=_0x19a799[_0x2f8b18(0xba)]['number']+'@'+(_0x19a799[_0x2f8b18(0x8c)]?_0x2f8b18(0xae):'s.whatsapp.net');console['log'](_0x66961e);if(_0x31af3f){const _0x3b3f1f=await Message_1[_0x2f8b18(0x7c)][_0x2f8b18(0xab)]({'where':{'id':_0x31af3f['id']}});if(!_0x3b3f1f||!_0x3b3f1f[_0x2f8b18(0xb5)])throw new AppError_1[(_0x2f8b18(0x7c))](_0x2f8b18(0xad));try{const _0x31dc0b=JSON[_0x2f8b18(0xb9)](_0x3b3f1f['dataJson']);_0x421746={'quoted':{'key':_0x31dc0b[_0x2f8b18(0xb8)]||_0x3b3f1f['id'],'message':{'extendedTextMessage':_0x31dc0b?.[_0x2f8b18(0xac)]?.[_0x2f8b18(0x8a)]}}};}catch(_0x52df40){throw new AppError_1['default']('ERR_PARSING_QUOTED_MSG');}}if(!lodash_1[_0x2f8b18(0x7c)][_0x2f8b18(0x7f)](_0x4c2e8a)){if(!_0x4c2e8a['name']||!_0x4c2e8a['number'])throw new AppError_1[(_0x2f8b18(0x7c))]('ERR_INVALID_VCARD');const _0x37dc50=_0x4c2e8a[_0x2f8b18(0x81)],_0x3f3940=_0x4c2e8a[_0x2f8b18(0x82)][_0x2f8b18(0xb4)]('\x20')[0x0],_0x794c86=String(_0x4c2e8a[_0x2f8b18(0x82)])[_0x2f8b18(0xb1)](_0x3f3940,'')['trim'](),_0x59891f=_0x2f8b18(0x9a)+('N:'+_0x794c86+';'+_0x3f3940+_0x2f8b18(0x91))+(_0x2f8b18(0x80)+_0x4c2e8a[_0x2f8b18(0x82)]+'\x0a')+('TEL;type=CELL;waid='+_0x37dc50+':+'+_0x37dc50+'\x0a')+'END:VCARD';try{const _0xf042e3=await _0x3837b7[_0x2f8b18(0x92)](_0x66961e,{'contacts':{'displayName':_0x4c2e8a[_0x2f8b18(0x82)],'contacts':[{'vcard':_0x59891f}]}});return await _0x19a799[_0x2f8b18(0xb6)]({'lastMessage':(0x0,Mustache_1[_0x2f8b18(0x7c)])(_0x59891f,_0x19a799),'imported':null}),_0xf042e3;}catch(_0x2cad78){Sentry['captureException'](_0x2cad78),console[_0x2f8b18(0xa6)](_0x2f8b18(0x87),_0x2cad78);throw new AppError_1[(_0x2f8b18(0x7c))](_0x2f8b18(0x97));}}if(!_0x9cbe3b&&lodash_1['default']['isNil'](_0x4c2e8a))throw new AppError_1[(_0x2f8b18(0x7c))](_0x2f8b18(0x84));try{const _0x294f72=await _0x3837b7[_0x2f8b18(0x92)](_0x66961e,{'text':(0x0,Mustache_1['default'])(_0x9cbe3b,_0x19a799)},{..._0x421746});return await _0x19a799[_0x2f8b18(0xb6)]({'lastMessage':(0x0,Mustache_1[_0x2f8b18(0x7c)])(_0x9cbe3b,_0x19a799)}),_0x294f72;}catch(_0x3b117c){Sentry[_0x2f8b18(0xb7)](_0x3b117c),console['error'](_0x2f8b18(0x8e),_0x3b117c);if(_0x3b117c['message'][_0x2f8b18(0xa3)]('invalid-jid'))throw new AppError_1[(_0x2f8b18(0x7c))](_0x2f8b18(0x88));else{if(_0x3b117c['message'][_0x2f8b18(0xa3)]('connection'))throw new AppError_1[(_0x2f8b18(0x7c))]('ERR_NETWORK');else throw new AppError_1[(_0x2f8b18(0x7c))](_0x2f8b18(0x97));}}};exports[a542_0x4a02cf(0x7c)]=SendWhatsAppMessage;