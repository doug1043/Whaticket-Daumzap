'use strict';function a576_0x2525(){const _0x589061=['(((.+)+)+)+$','number','extendedTextMessage','3JzGEtn','84054yNuoLM','parse','../../models/Message','3247280eEHdvo','../../helpers/Mustache','default','writable','Using\x20user\x20from\x20ticket.userId:','429hprVme','userId','user','verifyMessage','1NmNsne','prototype','481NnzNoy','Using\x20ticket.user:','__importDefault','__setModuleDefault','1023652ZytNoy','create','547020cJAqBv','contact','log','@s.whatsapp.net','isGroup','ERR_SENDING_WAPP_MSG','./VerifyHandlers','__createBinding','__esModule','captureException','hasOwnProperty','844856bahmLo','call','key','dataJson','findByPk','search','toString','75170ELSKyk','get','cacheMessage','thumbnailDirectPath','length','name','message','24arEoHB','202596peodfU','verifyMediaMessage','55HCczyx','defineProperty'];a576_0x2525=function(){return _0x589061;};return a576_0x2525();}const a576_0x11ce33=a576_0x3be7;(function(_0x35144e,_0x28e4da){const _0x4b4339=a576_0x3be7,_0x16f635=_0x35144e();while(!![]){try{const _0x1747be=parseInt(_0x4b4339(0xdc))/0x1*(parseInt(_0x4b4339(0xef))/0x2)+-parseInt(_0x4b4339(0xcf))/0x3*(-parseInt(_0x4b4339(0xd3))/0x4)+parseInt(_0x4b4339(0xca))/0x5*(parseInt(_0x4b4339(0xd0))/0x6)+parseInt(_0x4b4339(0xe2))/0x7*(-parseInt(_0x4b4339(0xc7))/0x8)+-parseInt(_0x4b4339(0xe4))/0x9+parseInt(_0x4b4339(0xc0))/0xa*(parseInt(_0x4b4339(0xd8))/0xb)+-parseInt(_0x4b4339(0xc8))/0xc*(parseInt(_0x4b4339(0xde))/0xd);if(_0x1747be===_0x28e4da)break;else _0x16f635['push'](_0x16f635['shift']());}catch(_0x202b26){_0x16f635['push'](_0x16f635['shift']());}}}(a576_0x2525,0x88127));function a576_0x3be7(_0x20ed3d,_0x296939){const _0x3ccc09=a576_0x2525();return a576_0x3be7=function(_0x2821a1,_0xcd99b8){_0x2821a1=_0x2821a1-0xc0;let _0x2525a5=_0x3ccc09[_0x2821a1];return _0x2525a5;},a576_0x3be7(_0x20ed3d,_0x296939);}var __createBinding=this&&this[a576_0x11ce33(0xeb)]||(Object[a576_0x11ce33(0xe3)]?function(_0x13ebd9,_0x20e681,_0x3f17bf,_0x168b0b){const _0x339819=a576_0x11ce33;if(_0x168b0b===undefined)_0x168b0b=_0x3f17bf;var _0x49a474=Object['getOwnPropertyDescriptor'](_0x20e681,_0x3f17bf);(!_0x49a474||(_0x339819(0xc1)in _0x49a474?!_0x20e681[_0x339819(0xec)]:_0x49a474[_0x339819(0xd6)]||_0x49a474['configurable']))&&(_0x49a474={'enumerable':!![],'get':function(){return _0x20e681[_0x3f17bf];}}),Object[_0x339819(0xcb)](_0x13ebd9,_0x168b0b,_0x49a474);}:function(_0x50e7cb,_0x3a4fbb,_0x1f7663,_0x1eaad2){if(_0x1eaad2===undefined)_0x1eaad2=_0x1f7663;_0x50e7cb[_0x1eaad2]=_0x3a4fbb[_0x1f7663];}),__setModuleDefault=this&&this[a576_0x11ce33(0xe1)]||(Object[a576_0x11ce33(0xe3)]?function(_0x3429f0,_0x238c69){const _0x222c64=a576_0x11ce33;Object['defineProperty'](_0x3429f0,_0x222c64(0xd5),{'enumerable':!![],'value':_0x238c69});}:function(_0x3b3af1,_0x7d6c9c){const _0x5ccf04=a576_0x11ce33;_0x3b3af1[_0x5ccf04(0xd5)]=_0x7d6c9c;}),__importStar=this&&this['__importStar']||(function(){const _0x32c512=(function(){let _0xa99f95=!![];return function(_0x5c2bc1,_0x1bcd31){const _0xe71b4=_0xa99f95?function(){if(_0x1bcd31){const _0x277eee=_0x1bcd31['apply'](_0x5c2bc1,arguments);return _0x1bcd31=null,_0x277eee;}}:function(){};return _0xa99f95=![],_0xe71b4;};}()),_0x4af79a=_0x32c512(this,function(){const _0x2c613d=a576_0x3be7;return _0x4af79a[_0x2c613d(0xf5)]()[_0x2c613d(0xf4)](_0x2c613d(0xcc))[_0x2c613d(0xf5)]()['constructor'](_0x4af79a)[_0x2c613d(0xf4)](_0x2c613d(0xcc));});_0x4af79a();var _0x3083d3=function(_0x33464e){return _0x3083d3=Object['getOwnPropertyNames']||function(_0x3bd940){const _0x194d6d=a576_0x3be7;var _0x17e93d=[];for(var _0x3d5436 in _0x3bd940)if(Object[_0x194d6d(0xdd)][_0x194d6d(0xee)][_0x194d6d(0xf0)](_0x3bd940,_0x3d5436))_0x17e93d[_0x17e93d['length']]=_0x3d5436;return _0x17e93d;},_0x3083d3(_0x33464e);};return function(_0x35a595){const _0x150168=a576_0x3be7;if(_0x35a595&&_0x35a595[_0x150168(0xec)])return _0x35a595;var _0x326940={};if(_0x35a595!=null){for(var _0x1fbcfe=_0x3083d3(_0x35a595),_0x4f9557=0x0;_0x4f9557<_0x1fbcfe[_0x150168(0xc4)];_0x4f9557++)if(_0x1fbcfe[_0x4f9557]!==_0x150168(0xd5))__createBinding(_0x326940,_0x35a595,_0x1fbcfe[_0x4f9557]);}return __setModuleDefault(_0x326940,_0x35a595),_0x326940;};}()),__importDefault=this&&this[a576_0x11ce33(0xe0)]||function(_0x59199b){const _0x5086d6=a576_0x11ce33;return _0x59199b&&_0x59199b[_0x5086d6(0xec)]?_0x59199b:{'default':_0x59199b};};Object[a576_0x11ce33(0xcb)](exports,'__esModule',{'value':!![]});const Sentry=__importStar(require('@sentry/node')),AppError_1=__importDefault(require('../../errors/AppError')),GetTicketWbot_1=__importDefault(require('../../helpers/GetTicketWbot')),Message_1=__importDefault(require(a576_0x11ce33(0xd2))),Mustache_1=__importDefault(require(a576_0x11ce33(0xd4))),VerifyHandlers_1=require(a576_0x11ce33(0xea)),User_1=__importDefault(require('../../models/User')),SendWhatsAppMessage=async({body:_0x2ebcbc,ticket:_0x189d9d,userId:_0x3ac528,quotedMsg:_0x46ee50})=>{const _0x357856=a576_0x11ce33;let _0x2e344f={};const _0x43412e=await(0x0,GetTicketWbot_1['default'])(_0x189d9d),_0x50e5dc=_0x189d9d[_0x357856(0xe8)]?_0x189d9d['contact'][_0x357856(0xcd)]+'@g.us':_0x189d9d[_0x357856(0xe5)][_0x357856(0xcd)]+_0x357856(0xe7);if(_0x46ee50){const _0x111cde=await Message_1[_0x357856(0xd5)]['findOne']({'where':{'id':_0x46ee50['id']}});if(_0x111cde){const _0x1ce595=JSON['parse'](_0x111cde[_0x357856(0xf2)]);_0x2e344f={'quoted':{'key':_0x1ce595?.[_0x357856(0xf1)]||_0x111cde['id'],'message':_0x1ce595?.['message']}};}}try{let _0xaa19b5=undefined;_0x3ac528&&(!_0x189d9d[_0x357856(0xda)]||_0x189d9d[_0x357856(0xda)]['id']!==_0x3ac528)&&(_0xaa19b5=await User_1['default'][_0x357856(0xf3)](_0x3ac528),console[_0x357856(0xe6)]('User\x20found\x20by\x20ID:',_0xaa19b5?.[_0x357856(0xc5)]));!_0xaa19b5&&_0x189d9d['user']&&(_0xaa19b5=_0x189d9d[_0x357856(0xda)],console[_0x357856(0xe6)](_0x357856(0xdf),_0x189d9d['user']?.['name']));!_0xaa19b5&&_0x189d9d[_0x357856(0xd9)]&&(_0xaa19b5=await User_1[_0x357856(0xd5)]['findByPk'](_0x189d9d['userId']),console[_0x357856(0xe6)](_0x357856(0xd7),_0xaa19b5?.[_0x357856(0xc5)]));const _0x4da59d=(0x0,Mustache_1[_0x357856(0xd5)])(_0x2ebcbc,_0x189d9d,_0xaa19b5),_0x2519c9={..._0x46ee50&&{'quoted':{'key':_0x46ee50['id'],'message':JSON[_0x357856(0xd1)](_0x46ee50[_0x357856(0xf2)])?.['message']}}},_0x1e359a=await _0x43412e['sendMessage'](_0x50e5dc,{'text':_0x4da59d,..._0x2519c9});return _0x43412e[_0x357856(0xc2)](_0x1e359a),_0x1e359a?.[_0x357856(0xc6)]?.[_0x357856(0xce)]?.[_0x357856(0xc3)]?await(0x0,VerifyHandlers_1[_0x357856(0xc9)])(_0x1e359a,_0x189d9d,_0x189d9d[_0x357856(0xe5)],_0x43412e):await(0x0,VerifyHandlers_1[_0x357856(0xdb)])(_0x1e359a,_0x189d9d,_0x189d9d[_0x357856(0xe5)]),_0x1e359a;}catch(_0x16c87c){Sentry[_0x357856(0xed)](_0x16c87c),console[_0x357856(0xe6)](_0x16c87c);throw new AppError_1[(_0x357856(0xd5))](_0x357856(0xe9));}};exports[a576_0x11ce33(0xd5)]=SendWhatsAppMessage;