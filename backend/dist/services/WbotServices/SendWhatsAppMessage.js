'use strict';const a578_0x57e511=a578_0x3ac5;(function(_0x2b48c1,_0x28cb41){const _0xb09e51=a578_0x3ac5,_0x14e2e1=_0x2b48c1();while(!![]){try{const _0x497b3f=parseInt(_0xb09e51(0x1b9))/0x1*(-parseInt(_0xb09e51(0x1d2))/0x2)+-parseInt(_0xb09e51(0x1c8))/0x3+parseInt(_0xb09e51(0x1d8))/0x4*(parseInt(_0xb09e51(0x1c2))/0x5)+parseInt(_0xb09e51(0x1b8))/0x6+-parseInt(_0xb09e51(0x1de))/0x7+parseInt(_0xb09e51(0x1e1))/0x8*(-parseInt(_0xb09e51(0x1c5))/0x9)+parseInt(_0xb09e51(0x1c9))/0xa;if(_0x497b3f===_0x28cb41)break;else _0x14e2e1['push'](_0x14e2e1['shift']());}catch(_0x2001ce){_0x14e2e1['push'](_0x14e2e1['shift']());}}}(a578_0x2fff,0x97af2));function a578_0x2fff(){const _0x15eb57=['948390GFaTLa','17576990jaCXAB','userId','Using\x20user\x20from\x20ticket.userId:','parse','../../errors/AppError','create','search','../../models/User','Using\x20ticket.user:','14tnMjtp','sendMessage','(((.+)+)+)+$','call','isGroup','__esModule','8yghwvd','../../models/Message','defineProperty','length','default','apply','6171704waqXbc','user','writable','4016YDcfwR','__importDefault','get','findOne','log','constructor','User\x20found\x20by\x20ID:','thumbnailDirectPath','__createBinding','name','prototype','findByPk','configurable','3110436gRhHIZ','16413yKUaCK','./VerifyHandlers','extendedTextMessage','toString','getOwnPropertyDescriptor','number','@g.us','contact','dataJson','639420QxJbbj','@sentry/node','captureException','10719UMFYiI','message','cacheMessage'];a578_0x2fff=function(){return _0x15eb57;};return a578_0x2fff();}function a578_0x3ac5(_0x3057e7,_0x303ee4){const _0x2e33db=a578_0x2fff();return a578_0x3ac5=function(_0x5acdf0,_0x2af8dd){_0x5acdf0=_0x5acdf0-0x1b5;let _0x2fff69=_0x2e33db[_0x5acdf0];return _0x2fff69;},a578_0x3ac5(_0x3057e7,_0x303ee4);}var __createBinding=this&&this[a578_0x57e511(0x1e9)]||(Object[a578_0x57e511(0x1ce)]?function(_0x533ab9,_0x3e2095,_0x1e0191,_0x5c587f){const _0x26eb46=a578_0x57e511;if(_0x5c587f===undefined)_0x5c587f=_0x1e0191;var _0x43bbf1=Object[_0x26eb46(0x1bd)](_0x3e2095,_0x1e0191);(!_0x43bbf1||(_0x26eb46(0x1e3)in _0x43bbf1?!_0x3e2095[_0x26eb46(0x1d7)]:_0x43bbf1[_0x26eb46(0x1e0)]||_0x43bbf1[_0x26eb46(0x1b7)]))&&(_0x43bbf1={'enumerable':!![],'get':function(){return _0x3e2095[_0x1e0191];}}),Object[_0x26eb46(0x1da)](_0x533ab9,_0x5c587f,_0x43bbf1);}:function(_0x560672,_0x5397fa,_0x113206,_0x374687){if(_0x374687===undefined)_0x374687=_0x113206;_0x560672[_0x374687]=_0x5397fa[_0x113206];}),__setModuleDefault=this&&this['__setModuleDefault']||(Object['create']?function(_0x35b915,_0x5518cf){const _0x27cff0=a578_0x57e511;Object[_0x27cff0(0x1da)](_0x35b915,'default',{'enumerable':!![],'value':_0x5518cf});}:function(_0x20e219,_0x38cb54){const _0x4e2420=a578_0x57e511;_0x20e219[_0x4e2420(0x1dc)]=_0x38cb54;}),__importStar=this&&this['__importStar']||(function(){const _0x32aec1=(function(){let _0x37f5b0=!![];return function(_0x18201a,_0xf3d6b1){const _0x3b3c7c=_0x37f5b0?function(){const _0x91bf69=a578_0x3ac5;if(_0xf3d6b1){const _0x358f44=_0xf3d6b1[_0x91bf69(0x1dd)](_0x18201a,arguments);return _0xf3d6b1=null,_0x358f44;}}:function(){};return _0x37f5b0=![],_0x3b3c7c;};}()),_0xa0f583=_0x32aec1(this,function(){const _0x24c67f=a578_0x3ac5;return _0xa0f583[_0x24c67f(0x1bc)]()[_0x24c67f(0x1cf)](_0x24c67f(0x1d4))[_0x24c67f(0x1bc)]()[_0x24c67f(0x1e6)](_0xa0f583)['search'](_0x24c67f(0x1d4));});_0xa0f583();var _0x417495=function(_0x2dcd52){return _0x417495=Object['getOwnPropertyNames']||function(_0x11d83a){const _0x1db167=a578_0x3ac5;var _0x3bf551=[];for(var _0x25f146 in _0x11d83a)if(Object[_0x1db167(0x1b5)]['hasOwnProperty'][_0x1db167(0x1d5)](_0x11d83a,_0x25f146))_0x3bf551[_0x3bf551['length']]=_0x25f146;return _0x3bf551;},_0x417495(_0x2dcd52);};return function(_0x5ef124){const _0x5728a4=a578_0x3ac5;if(_0x5ef124&&_0x5ef124[_0x5728a4(0x1d7)])return _0x5ef124;var _0x491df1={};if(_0x5ef124!=null){for(var _0x53b7e1=_0x417495(_0x5ef124),_0x4b02cc=0x0;_0x4b02cc<_0x53b7e1[_0x5728a4(0x1db)];_0x4b02cc++)if(_0x53b7e1[_0x4b02cc]!==_0x5728a4(0x1dc))__createBinding(_0x491df1,_0x5ef124,_0x53b7e1[_0x4b02cc]);}return __setModuleDefault(_0x491df1,_0x5ef124),_0x491df1;};}()),__importDefault=this&&this[a578_0x57e511(0x1e2)]||function(_0x59b1b1){const _0x522319=a578_0x57e511;return _0x59b1b1&&_0x59b1b1[_0x522319(0x1d7)]?_0x59b1b1:{'default':_0x59b1b1};};Object['defineProperty'](exports,'__esModule',{'value':!![]});const Sentry=__importStar(require(a578_0x57e511(0x1c3))),AppError_1=__importDefault(require(a578_0x57e511(0x1cd))),GetTicketWbot_1=__importDefault(require('../../helpers/GetTicketWbot')),Message_1=__importDefault(require(a578_0x57e511(0x1d9))),Mustache_1=__importDefault(require('../../helpers/Mustache')),VerifyHandlers_1=require(a578_0x57e511(0x1ba)),User_1=__importDefault(require(a578_0x57e511(0x1d0))),SendWhatsAppMessage=async({body:_0x36995b,ticket:_0x576449,userId:_0x1e09b2,quotedMsg:_0x50b90a})=>{const _0x3f5fd9=a578_0x57e511;let _0x5a3121={};const _0x6db18c=await(0x0,GetTicketWbot_1['default'])(_0x576449),_0x4d4aa6=_0x576449[_0x3f5fd9(0x1d6)]?_0x576449[_0x3f5fd9(0x1c0)][_0x3f5fd9(0x1be)]+_0x3f5fd9(0x1bf):_0x576449[_0x3f5fd9(0x1c0)][_0x3f5fd9(0x1be)]+'@s.whatsapp.net';if(_0x50b90a){const _0x1496f2=await Message_1[_0x3f5fd9(0x1dc)][_0x3f5fd9(0x1e4)]({'where':{'id':_0x50b90a['id']}});if(_0x1496f2){const _0x4a7013=JSON['parse'](_0x1496f2[_0x3f5fd9(0x1c1)]);_0x5a3121={'quoted':{'key':_0x4a7013?.['key']||_0x1496f2['id'],'message':_0x4a7013?.[_0x3f5fd9(0x1c6)]}};}}try{let _0x2c242b=undefined;_0x1e09b2&&(!_0x576449['user']||_0x576449[_0x3f5fd9(0x1df)]['id']!==_0x1e09b2)&&(_0x2c242b=await User_1[_0x3f5fd9(0x1dc)][_0x3f5fd9(0x1b6)](_0x1e09b2),console[_0x3f5fd9(0x1e5)](_0x3f5fd9(0x1e7),_0x2c242b?.[_0x3f5fd9(0x1ea)]));!_0x2c242b&&_0x576449[_0x3f5fd9(0x1df)]&&(_0x2c242b=_0x576449[_0x3f5fd9(0x1df)],console[_0x3f5fd9(0x1e5)](_0x3f5fd9(0x1d1),_0x576449[_0x3f5fd9(0x1df)]?.[_0x3f5fd9(0x1ea)]));!_0x2c242b&&_0x576449[_0x3f5fd9(0x1ca)]&&(_0x2c242b=await User_1['default'][_0x3f5fd9(0x1b6)](_0x576449[_0x3f5fd9(0x1ca)]),console['log'](_0x3f5fd9(0x1cb),_0x2c242b?.[_0x3f5fd9(0x1ea)]));const _0x10e092=(0x0,Mustache_1['default'])(_0x36995b,_0x576449,_0x2c242b),_0x6fcbca={..._0x50b90a&&{'quoted':{'key':_0x50b90a['id'],'message':JSON[_0x3f5fd9(0x1cc)](_0x50b90a[_0x3f5fd9(0x1c1)])?.['message']}}},_0x49ae61=await _0x6db18c[_0x3f5fd9(0x1d3)](_0x4d4aa6,{'text':_0x10e092,..._0x6fcbca});return _0x6db18c[_0x3f5fd9(0x1c7)](_0x49ae61),_0x49ae61?.['message']?.[_0x3f5fd9(0x1bb)]?.[_0x3f5fd9(0x1e8)]?await(0x0,VerifyHandlers_1['verifyMediaMessage'])(_0x49ae61,_0x576449,_0x576449[_0x3f5fd9(0x1c0)],_0x6db18c):await(0x0,VerifyHandlers_1['verifyMessage'])(_0x49ae61,_0x576449,_0x576449[_0x3f5fd9(0x1c0)]),_0x49ae61;}catch(_0x17ee4c){Sentry[_0x3f5fd9(0x1c4)](_0x17ee4c),console[_0x3f5fd9(0x1e5)](_0x17ee4c);throw new AppError_1[(_0x3f5fd9(0x1dc))]('ERR_SENDING_WAPP_MSG');}};exports[a578_0x57e511(0x1dc)]=SendWhatsAppMessage;