const a553_0x5092b9=a553_0x2c08;(function(_0x5065f8,_0xe5e41f){const _0x3e8440=a553_0x2c08,_0x3a9042=_0x5065f8();while(!![]){try{const _0x1a546c=parseInt(_0x3e8440(0x100))/0x1*(parseInt(_0x3e8440(0xe6))/0x2)+-parseInt(_0x3e8440(0xfc))/0x3+-parseInt(_0x3e8440(0xda))/0x4*(parseInt(_0x3e8440(0xe8))/0x5)+-parseInt(_0x3e8440(0xe4))/0x6*(-parseInt(_0x3e8440(0xec))/0x7)+-parseInt(_0x3e8440(0xdd))/0x8+-parseInt(_0x3e8440(0xf1))/0x9*(-parseInt(_0x3e8440(0xed))/0xa)+-parseInt(_0x3e8440(0xe2))/0xb;if(_0x1a546c===_0xe5e41f)break;else _0x3a9042['push'](_0x3a9042['shift']());}catch(_0x3127f7){_0x3a9042['push'](_0x3a9042['shift']());}}}(a553_0x7c41,0x7d186));function a553_0x2c08(_0x2c9e0c,_0x90a4f8){const _0x46ac09=a553_0x7c41();return a553_0x2c08=function(_0x5cf5eb,_0x45e92c){_0x5cf5eb=_0x5cf5eb-0xd0;let _0x7c414f=_0x46ac09[_0x5cf5eb];return _0x7c414f;},a553_0x2c08(_0x2c9e0c,_0x90a4f8);}const a553_0x45e92c=(function(){let _0x425624=!![];return function(_0x3cc36e,_0x201459){const _0x34f361=_0x425624?function(){const _0xe1ad36=a553_0x2c08;if(_0x201459){const _0xb8e852=_0x201459[_0xe1ad36(0xf9)](_0x3cc36e,arguments);return _0x201459=null,_0xb8e852;}}:function(){};return _0x425624=![],_0x34f361;};}()),a553_0x5cf5eb=a553_0x45e92c(this,function(){const _0x345439=a553_0x2c08;return a553_0x5cf5eb[_0x345439(0xdb)]()[_0x345439(0x102)](_0x345439(0xf4))[_0x345439(0xdb)]()['constructor'](a553_0x5cf5eb)['search'](_0x345439(0xf4));});a553_0x5cf5eb();'use strict';var __createBinding=this&&this['__createBinding']||(Object['create']?function(_0xd6d820,_0x5098ac,_0x39c996,_0x1ce2df){const _0x1c4728=a553_0x2c08;if(_0x1ce2df===undefined)_0x1ce2df=_0x39c996;var _0x1e4eb4=Object[_0x1c4728(0xf3)](_0x5098ac,_0x39c996);(!_0x1e4eb4||('get'in _0x1e4eb4?!_0x5098ac[_0x1c4728(0xee)]:_0x1e4eb4[_0x1c4728(0xd2)]||_0x1e4eb4[_0x1c4728(0xd0)]))&&(_0x1e4eb4={'enumerable':!![],'get':function(){return _0x5098ac[_0x39c996];}}),Object[_0x1c4728(0xf0)](_0xd6d820,_0x1ce2df,_0x1e4eb4);}:function(_0x267ff9,_0x31113c,_0x525c5f,_0x473fa3){if(_0x473fa3===undefined)_0x473fa3=_0x525c5f;_0x267ff9[_0x473fa3]=_0x31113c[_0x525c5f];}),__setModuleDefault=this&&this[a553_0x5092b9(0xe5)]||(Object['create']?function(_0x4886f5,_0x2177eb){const _0x37369d=a553_0x5092b9;Object[_0x37369d(0xf0)](_0x4886f5,_0x37369d(0xe9),{'enumerable':!![],'value':_0x2177eb});}:function(_0x29e4a9,_0x51845e){const _0x24dd68=a553_0x5092b9;_0x29e4a9[_0x24dd68(0xe9)]=_0x51845e;}),__importStar=this&&this[a553_0x5092b9(0xd8)]||function(_0x52aa03){const _0x7baf3e=a553_0x5092b9;if(_0x52aa03&&_0x52aa03[_0x7baf3e(0xee)])return _0x52aa03;var _0x5d9bb9={};if(_0x52aa03!=null){for(var _0x16aecf in _0x52aa03)if(_0x16aecf!=='default'&&Object[_0x7baf3e(0xfa)][_0x7baf3e(0xf2)][_0x7baf3e(0xe7)](_0x52aa03,_0x16aecf))__createBinding(_0x5d9bb9,_0x52aa03,_0x16aecf);}return __setModuleDefault(_0x5d9bb9,_0x52aa03),_0x5d9bb9;},__importDefault=this&&this[a553_0x5092b9(0xf8)]||function(_0x1232cb){const _0x1099f0=a553_0x5092b9;return _0x1232cb&&_0x1232cb[_0x1099f0(0xee)]?_0x1232cb:{'default':_0x1232cb};};Object[a553_0x5092b9(0xf0)](exports,'__esModule',{'value':!![]});const Sentry=__importStar(require(a553_0x5092b9(0xd1))),AppError_1=__importDefault(require('../../errors/AppError')),GetTicketWbot_1=__importDefault(require(a553_0x5092b9(0xea))),Message_1=__importDefault(require(a553_0x5092b9(0xf7))),lodash_1=__importDefault(require(a553_0x5092b9(0xdc))),Mustache_1=__importDefault(require('../../helpers/Mustache')),SendWhatsAppMessage=async({body:_0x4f6e8e,ticket:_0x2e44f0,quotedMsg:_0x163795,vCard:_0x16a8e2})=>{const _0x4a5981=a553_0x5092b9;let _0x59c262={};const _0x466cb1=await(0x0,GetTicketWbot_1[_0x4a5981(0xe9)])(_0x2e44f0);if(!_0x466cb1)throw new AppError_1[(_0x4a5981(0xe9))]('ERR_WBOT_NOT_FOUND');const _0x1ba2c2=_0x2e44f0[_0x4a5981(0xeb)]['number']+'@'+(_0x2e44f0[_0x4a5981(0xef)]?_0x4a5981(0xd9):_0x4a5981(0xdf));if(_0x163795){const _0x2708ee=await Message_1[_0x4a5981(0xe9)]['findOne']({'where':{'id':_0x163795['id']}});if(_0x2708ee){const _0x54c3c4=JSON['parse'](_0x2708ee['dataJson']);_0x59c262={'quoted':{'key':_0x54c3c4['key']||_0x2708ee['id'],'message':{'extendedTextMessage':_0x54c3c4?.[_0x4a5981(0xe0)][_0x4a5981(0xd7)]}}};}}if(!lodash_1['default']['isNil'](_0x16a8e2)){const _0x27d55c=_0x16a8e2[_0x4a5981(0xf5)],_0x2c8293=_0x16a8e2['name'][_0x4a5981(0xfd)]('\x20')[0x0],_0x2fea8d=String(_0x16a8e2[_0x4a5981(0xd3)])[_0x4a5981(0xfb)](_0x16a8e2[_0x4a5981(0xd3)][_0x4a5981(0xfd)]('\x20')[0x0],''),_0x4ce627=_0x4a5981(0xff)+('N:'+_0x2fea8d+';'+_0x2c8293+_0x4a5981(0xd5))+(_0x4a5981(0xe1)+_0x16a8e2[_0x4a5981(0xd3)]+'\x0a')+(_0x4a5981(0xde)+_0x27d55c+':+'+_0x27d55c+'\x0a')+_0x4a5981(0x101);try{const _0x21df59=await _0x466cb1[_0x4a5981(0xfe)](_0x1ba2c2,{'contacts':{'displayName':''+_0x16a8e2[_0x4a5981(0xd3)],'contacts':[{'vcard':_0x4ce627}]}});return await _0x2e44f0[_0x4a5981(0xf6)]({'lastMessage':(0x0,Mustache_1[_0x4a5981(0xe9)])(_0x4ce627,_0x2e44f0),'imported':null}),_0x21df59;}catch(_0x1c1b6a){Sentry['captureException'](_0x1c1b6a),console[_0x4a5981(0xd4)](_0x1c1b6a);throw new AppError_1[(_0x4a5981(0xe9))]('ERR_SENDING_WAPP_MSG');}}try{const _0x339c1e=await _0x466cb1[_0x4a5981(0xfe)](_0x1ba2c2,{'text':(0x0,Mustache_1[_0x4a5981(0xe9)])(_0x4f6e8e,_0x2e44f0)},{..._0x59c262});return await _0x2e44f0[_0x4a5981(0xf6)]({'lastMessage':(0x0,Mustache_1[_0x4a5981(0xe9)])(_0x4f6e8e,_0x2e44f0)}),_0x339c1e;}catch(_0x1f3206){Sentry[_0x4a5981(0xd6)](_0x1f3206),console[_0x4a5981(0xe3)](_0x1f3206);throw new AppError_1[(_0x4a5981(0xe9))]('ERR_SENDING_WAPP_MSG');}};exports[a553_0x5092b9(0xe9)]=SendWhatsAppMessage;function a553_0x7c41(){const _0x1cf3df=['@sentry/node','writable','name','trace',';;;\x0a','captureException','extendedTextMessage','__importStar','g.us','2054576FbAomS','toString','lodash','943296LPsEzd','TEL;type=CELL;waid=','s.whatsapp.net','message','FN:','17650182RvozvU','log','510hGCDFy','__setModuleDefault','48rAsqzX','call','5NXlhZE','default','../../helpers/GetTicketWbot','contact','83818ccHsHR','7574870nHhsLF','__esModule','isGroup','defineProperty','9xXPItP','hasOwnProperty','getOwnPropertyDescriptor','(((.+)+)+)+$','number','update','../../models/Message','__importDefault','apply','prototype','replace','121011lDLYLW','split','sendMessage','BEGIN:VCARD\x0aVERSION:3.0\x0a','42232sonzpu','END:VCARD','search','configurable'];a553_0x7c41=function(){return _0x1cf3df;};return a553_0x7c41();}