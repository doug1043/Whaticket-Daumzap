'use strict';const a582_0x1cd1a6=a582_0x5a12;(function(_0xe60393,_0x3f8e86){const _0x1dc433=a582_0x5a12,_0x496b60=_0xe60393();while(!![]){try{const _0x5c3b70=-parseInt(_0x1dc433(0x194))/0x1*(parseInt(_0x1dc433(0x19e))/0x2)+-parseInt(_0x1dc433(0x191))/0x3*(-parseInt(_0x1dc433(0x180))/0x4)+-parseInt(_0x1dc433(0x17f))/0x5+parseInt(_0x1dc433(0x1ae))/0x6+parseInt(_0x1dc433(0x19b))/0x7+-parseInt(_0x1dc433(0x18c))/0x8*(parseInt(_0x1dc433(0x1a1))/0x9)+-parseInt(_0x1dc433(0x17c))/0xa;if(_0x5c3b70===_0x3f8e86)break;else _0x496b60['push'](_0x496b60['shift']());}catch(_0x1f5df4){_0x496b60['push'](_0x496b60['shift']());}}}(a582_0x3662,0x7556a));var __createBinding=this&&this[a582_0x1cd1a6(0x1b0)]||(Object[a582_0x1cd1a6(0x1ac)]?function(_0x5575c0,_0x727177,_0x1c302b,_0x3e20b0){const _0x3a3820=a582_0x1cd1a6;if(_0x3e20b0===undefined)_0x3e20b0=_0x1c302b;var _0xa520a1=Object['getOwnPropertyDescriptor'](_0x727177,_0x1c302b);(!_0xa520a1||(_0x3a3820(0x19c)in _0xa520a1?!_0x727177[_0x3a3820(0x19d)]:_0xa520a1[_0x3a3820(0x18b)]||_0xa520a1[_0x3a3820(0x181)]))&&(_0xa520a1={'enumerable':!![],'get':function(){return _0x727177[_0x1c302b];}}),Object['defineProperty'](_0x5575c0,_0x3e20b0,_0xa520a1);}:function(_0x24a89c,_0x56b54a,_0x5e4193,_0xa3f174){if(_0xa3f174===undefined)_0xa3f174=_0x5e4193;_0x24a89c[_0xa3f174]=_0x56b54a[_0x5e4193];}),__setModuleDefault=this&&this['__setModuleDefault']||(Object[a582_0x1cd1a6(0x1ac)]?function(_0x5d1fbd,_0x15ebb1){const _0x51df0b=a582_0x1cd1a6;Object['defineProperty'](_0x5d1fbd,_0x51df0b(0x18a),{'enumerable':!![],'value':_0x15ebb1});}:function(_0x56fe64,_0x19bb46){const _0x287a9a=a582_0x1cd1a6;_0x56fe64[_0x287a9a(0x18a)]=_0x19bb46;}),__importStar=this&&this[a582_0x1cd1a6(0x196)]||(function(){const _0x176d5a=(function(){let _0x1cb82b=!![];return function(_0x133cc2,_0x4db27d){const _0x3e309d=_0x1cb82b?function(){const _0x272260=a582_0x5a12;if(_0x4db27d){const _0xc00923=_0x4db27d[_0x272260(0x183)](_0x133cc2,arguments);return _0x4db27d=null,_0xc00923;}}:function(){};return _0x1cb82b=![],_0x3e309d;};}()),_0x4badf6=_0x176d5a(this,function(){const _0x5280b1=a582_0x5a12;return _0x4badf6[_0x5280b1(0x197)]()[_0x5280b1(0x187)]('(((.+)+)+)+$')[_0x5280b1(0x197)]()[_0x5280b1(0x184)](_0x4badf6)[_0x5280b1(0x187)]('(((.+)+)+)+$');});_0x4badf6();var _0x28337c=function(_0x4c56bd){const _0x151d75=a582_0x5a12;return _0x28337c=Object[_0x151d75(0x1ad)]||function(_0x5d693b){const _0x199a72=_0x151d75;var _0x43e271=[];for(var _0x4e9d13 in _0x5d693b)if(Object[_0x199a72(0x19f)][_0x199a72(0x18d)][_0x199a72(0x1a2)](_0x5d693b,_0x4e9d13))_0x43e271[_0x43e271[_0x199a72(0x1a8)]]=_0x4e9d13;return _0x43e271;},_0x28337c(_0x4c56bd);};return function(_0x5a9267){const _0x5b0e8a=a582_0x5a12;if(_0x5a9267&&_0x5a9267[_0x5b0e8a(0x19d)])return _0x5a9267;var _0x5b5bfc={};if(_0x5a9267!=null){for(var _0x3fa1f6=_0x28337c(_0x5a9267),_0x26a762=0x0;_0x26a762<_0x3fa1f6['length'];_0x26a762++)if(_0x3fa1f6[_0x26a762]!==_0x5b0e8a(0x18a))__createBinding(_0x5b5bfc,_0x5a9267,_0x3fa1f6[_0x26a762]);}return __setModuleDefault(_0x5b5bfc,_0x5a9267),_0x5b5bfc;};}()),__importDefault=this&&this[a582_0x1cd1a6(0x188)]||function(_0x4c5421){const _0x413d1f=a582_0x1cd1a6;return _0x4c5421&&_0x4c5421[_0x413d1f(0x19d)]?_0x4c5421:{'default':_0x4c5421};};function a582_0x5a12(_0x3a8a9a,_0x19c028){const _0x182f92=a582_0x3662();return a582_0x5a12=function(_0x3851c7,_0xc17069){_0x3851c7=_0x3851c7-0x17b;let _0x3662ad=_0x182f92[_0x3851c7];return _0x3662ad;},a582_0x5a12(_0x3a8a9a,_0x19c028);}Object['defineProperty'](exports,a582_0x1cd1a6(0x19d),{'value':!![]});const Sentry=__importStar(require('@sentry/node')),AppError_1=__importDefault(require(a582_0x1cd1a6(0x1aa))),GetTicketWbot_1=__importDefault(require('../../helpers/GetTicketWbot')),Message_1=__importDefault(require(a582_0x1cd1a6(0x1a7))),Mustache_1=__importDefault(require(a582_0x1cd1a6(0x186))),VerifyHandlers_1=require('./VerifyHandlers'),User_1=__importDefault(require(a582_0x1cd1a6(0x192))),SendWhatsAppMessage=async({body:_0x302cd3,ticket:_0x3b2a2d,userId:_0x1b38bf,quotedMsg:_0x47691a})=>{const _0x35d205=a582_0x1cd1a6;let _0x438854={};const _0xcce196=await(0x0,GetTicketWbot_1[_0x35d205(0x18a)])(_0x3b2a2d);let _0x4a40c9;if(_0x3b2a2d['isGroup'])_0x4a40c9=_0x3b2a2d[_0x35d205(0x1ab)][_0x35d205(0x1a3)]+_0x35d205(0x1a4);else{if(_0x3b2a2d[_0x35d205(0x1ab)][_0x35d205(0x1a0)])_0x4a40c9=_0x3b2a2d['contact'][_0x35d205(0x1a0)];else _0x3b2a2d[_0x35d205(0x1ab)][_0x35d205(0x190)]?_0x4a40c9=_0x3b2a2d['contact']['lid']+_0x35d205(0x199):_0x4a40c9=_0x3b2a2d['contact'][_0x35d205(0x1a3)]+_0x35d205(0x193);}if(_0x47691a){const _0x481a5e=await Message_1[_0x35d205(0x18a)]['findOne']({'where':{'id':_0x47691a['id']}});if(_0x481a5e){const _0x5087b0=JSON[_0x35d205(0x18f)](_0x481a5e[_0x35d205(0x17d)]);_0x438854={'quoted':{'key':_0x5087b0?.[_0x35d205(0x195)]||_0x481a5e['id'],'message':_0x5087b0?.[_0x35d205(0x1a9)]}};}}try{let _0x138df3=undefined;_0x1b38bf&&(!_0x3b2a2d['user']||_0x3b2a2d[_0x35d205(0x189)]['id']!==_0x1b38bf)&&(_0x138df3=await User_1[_0x35d205(0x18a)][_0x35d205(0x185)](_0x1b38bf),console[_0x35d205(0x1b1)](_0x35d205(0x19a),_0x138df3?.[_0x35d205(0x17b)]));!_0x138df3&&_0x3b2a2d[_0x35d205(0x189)]&&(_0x138df3=_0x3b2a2d[_0x35d205(0x189)]);!_0x138df3&&_0x3b2a2d['userId']&&(_0x138df3=await User_1['default'][_0x35d205(0x185)](_0x3b2a2d['userId']));const _0x5fca22=(0x0,Mustache_1[_0x35d205(0x18a)])(_0x302cd3,_0x3b2a2d,_0x138df3),_0x598225={..._0x47691a&&{'quoted':{'key':_0x47691a['id'],'message':JSON['parse'](_0x47691a[_0x35d205(0x17d)])?.[_0x35d205(0x1a9)]}}},_0x33961d=await _0xcce196[_0x35d205(0x17e)](_0x4a40c9,{'text':_0x5fca22,..._0x598225});return _0xcce196[_0x35d205(0x1a5)](_0x33961d),_0x33961d?.[_0x35d205(0x1a9)]?.[_0x35d205(0x1af)]?.[_0x35d205(0x198)]?await(0x0,VerifyHandlers_1[_0x35d205(0x182)])(_0x33961d,_0x3b2a2d,_0x3b2a2d[_0x35d205(0x1ab)],_0xcce196):await(0x0,VerifyHandlers_1[_0x35d205(0x1a6)])(_0x33961d,_0x3b2a2d,_0x3b2a2d[_0x35d205(0x1ab)]),_0x33961d;}catch(_0x59aca3){Sentry['captureException'](_0x59aca3),console['log'](_0x59aca3);throw new AppError_1[(_0x35d205(0x18a))](_0x35d205(0x18e));}};function a582_0x3662(){const _0xcaed7d=['hasOwnProperty','ERR_SENDING_WAPP_MSG','parse','lid','15uHWYmo','../../models/User','@s.whatsapp.net','31581fodzQj','key','__importStar','toString','thumbnailDirectPath','@lid','User\x20found\x20by\x20ID:','3344621fJBnSc','get','__esModule','24BCfyaa','prototype','remoteJid','9lgPrqB','call','number','@g.us','cacheMessage','verifyMessage','../../models/Message','length','message','../../errors/AppError','contact','create','getOwnPropertyNames','1026066sRYeys','extendedTextMessage','__createBinding','log','name','1666670FCNsyN','dataJson','sendMessage','625280zbHqCB','663848gPSZme','configurable','verifyMediaMessage','apply','constructor','findByPk','../../helpers/Mustache','search','__importDefault','user','default','writable','2618488UQxaUW'];a582_0x3662=function(){return _0xcaed7d;};return a582_0x3662();}exports['default']=SendWhatsAppMessage;