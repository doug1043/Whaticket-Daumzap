'use strict';const a581_0x4e5f56=a581_0x2e1c;(function(_0x5122ac,_0x36af2f){const _0x3c0ae6=a581_0x2e1c,_0x3b500b=_0x5122ac();while(!![]){try{const _0x460d69=parseInt(_0x3c0ae6(0xb3))/0x1*(parseInt(_0x3c0ae6(0xd6))/0x2)+-parseInt(_0x3c0ae6(0xa6))/0x3*(parseInt(_0x3c0ae6(0xd4))/0x4)+-parseInt(_0x3c0ae6(0xa1))/0x5+parseInt(_0x3c0ae6(0xbe))/0x6*(parseInt(_0x3c0ae6(0xb0))/0x7)+parseInt(_0x3c0ae6(0xb9))/0x8+-parseInt(_0x3c0ae6(0xcc))/0x9*(parseInt(_0x3c0ae6(0xb5))/0xa)+-parseInt(_0x3c0ae6(0xa4))/0xb;if(_0x460d69===_0x36af2f)break;else _0x3b500b['push'](_0x3b500b['shift']());}catch(_0x1b8f84){_0x3b500b['push'](_0x3b500b['shift']());}}}(a581_0x4b9b,0x318af));var __createBinding=this&&this['__createBinding']||(Object[a581_0x4e5f56(0xc0)]?function(_0x97c8d6,_0xea6dce,_0x448eac,_0x548dce){const _0x497194=a581_0x4e5f56;if(_0x548dce===undefined)_0x548dce=_0x448eac;var _0x465138=Object[_0x497194(0xbc)](_0xea6dce,_0x448eac);(!_0x465138||(_0x497194(0xad)in _0x465138?!_0xea6dce[_0x497194(0xa0)]:_0x465138['writable']||_0x465138[_0x497194(0xce)]))&&(_0x465138={'enumerable':!![],'get':function(){return _0xea6dce[_0x448eac];}}),Object[_0x497194(0xb4)](_0x97c8d6,_0x548dce,_0x465138);}:function(_0x3b89a1,_0xb7afc9,_0x5e390c,_0x2a52d6){if(_0x2a52d6===undefined)_0x2a52d6=_0x5e390c;_0x3b89a1[_0x2a52d6]=_0xb7afc9[_0x5e390c];}),__setModuleDefault=this&&this['__setModuleDefault']||(Object[a581_0x4e5f56(0xc0)]?function(_0x175f3e,_0x2ca682){const _0x2734f7=a581_0x4e5f56;Object[_0x2734f7(0xb4)](_0x175f3e,_0x2734f7(0xd2),{'enumerable':!![],'value':_0x2ca682});}:function(_0x42ec1b,_0xaf1a12){const _0x573f64=a581_0x4e5f56;_0x42ec1b[_0x573f64(0xd2)]=_0xaf1a12;}),__importStar=this&&this[a581_0x4e5f56(0xab)]||(function(){const _0x3651cc=(function(){let _0x1d92be=!![];return function(_0x4debe0,_0x25973f){const _0xdcd5ab=_0x1d92be?function(){const _0x2ca979=a581_0x2e1c;if(_0x25973f){const _0x50e2ce=_0x25973f[_0x2ca979(0xba)](_0x4debe0,arguments);return _0x25973f=null,_0x50e2ce;}}:function(){};return _0x1d92be=![],_0xdcd5ab;};}()),_0x51b1b6=_0x3651cc(this,function(){const _0x3ebc45=a581_0x2e1c;return _0x51b1b6[_0x3ebc45(0xd3)]()[_0x3ebc45(0xd1)](_0x3ebc45(0xa2))[_0x3ebc45(0xd3)]()['constructor'](_0x51b1b6)[_0x3ebc45(0xd1)](_0x3ebc45(0xa2));});_0x51b1b6();var _0x11a820=function(_0x5763ef){const _0x5a45da=a581_0x2e1c;return _0x11a820=Object[_0x5a45da(0xac)]||function(_0x5277d7){const _0x1ab859=_0x5a45da;var _0x1aabd8=[];for(var _0x2460be in _0x5277d7)if(Object[_0x1ab859(0xb8)][_0x1ab859(0xd5)][_0x1ab859(0xb7)](_0x5277d7,_0x2460be))_0x1aabd8[_0x1aabd8[_0x1ab859(0xb6)]]=_0x2460be;return _0x1aabd8;},_0x11a820(_0x5763ef);};return function(_0x4da427){const _0x15a80c=a581_0x2e1c;if(_0x4da427&&_0x4da427[_0x15a80c(0xa0)])return _0x4da427;var _0x1641fa={};if(_0x4da427!=null){for(var _0xe585c4=_0x11a820(_0x4da427),_0x50f971=0x0;_0x50f971<_0xe585c4[_0x15a80c(0xb6)];_0x50f971++)if(_0xe585c4[_0x50f971]!==_0x15a80c(0xd2))__createBinding(_0x1641fa,_0x4da427,_0xe585c4[_0x50f971]);}return __setModuleDefault(_0x1641fa,_0x4da427),_0x1641fa;};}()),__importDefault=this&&this[a581_0x4e5f56(0xc3)]||function(_0x36d918){return _0x36d918&&_0x36d918['__esModule']?_0x36d918:{'default':_0x36d918};};Object[a581_0x4e5f56(0xb4)](exports,a581_0x4e5f56(0xa0),{'value':!![]});const Sentry=__importStar(require(a581_0x4e5f56(0xcf))),AppError_1=__importDefault(require(a581_0x4e5f56(0xd0))),GetTicketWbot_1=__importDefault(require('../../helpers/GetTicketWbot')),Message_1=__importDefault(require('../../models/Message')),Mustache_1=__importDefault(require(a581_0x4e5f56(0xaa))),VerifyHandlers_1=require(a581_0x4e5f56(0xae)),User_1=__importDefault(require(a581_0x4e5f56(0xc4))),SendWhatsAppMessage=async({body:_0x235a65,ticket:_0x433f6a,userId:_0x2c7de5,quotedMsg:_0x109933})=>{const _0x15a2f8=a581_0x4e5f56;let _0x5564ea={};const _0x5d1c62=await(0x0,GetTicketWbot_1[_0x15a2f8(0xd2)])(_0x433f6a);let _0x2b5d60;if(_0x433f6a[_0x15a2f8(0xb2)])_0x2b5d60=_0x433f6a[_0x15a2f8(0xa7)]['number']+_0x15a2f8(0xbb);else{if(_0x433f6a[_0x15a2f8(0xa7)][_0x15a2f8(0xa5)])_0x2b5d60=_0x433f6a[_0x15a2f8(0xa7)][_0x15a2f8(0xa5)];else _0x433f6a['contact']['lid']?_0x2b5d60=_0x433f6a['contact'][_0x15a2f8(0xa9)]+'@lid':_0x2b5d60=_0x433f6a[_0x15a2f8(0xa7)][_0x15a2f8(0xaf)]+_0x15a2f8(0x9e);}if(_0x109933){const _0x25e3c9=await Message_1[_0x15a2f8(0xd2)][_0x15a2f8(0xca)]({'where':{'id':_0x109933['id']}});if(_0x25e3c9){const _0x26fa54=JSON['parse'](_0x25e3c9[_0x15a2f8(0xcb)]);_0x5564ea={'quoted':{'key':_0x26fa54?.[_0x15a2f8(0xa8)]||_0x25e3c9['id'],'message':_0x26fa54?.[_0x15a2f8(0x9f)]}};}}try{let _0x161bc3=undefined;_0x2c7de5&&(!_0x433f6a[_0x15a2f8(0xd7)]||_0x433f6a[_0x15a2f8(0xd7)]['id']!==_0x2c7de5)&&(_0x161bc3=await User_1[_0x15a2f8(0xd2)][_0x15a2f8(0xc9)](_0x2c7de5),console[_0x15a2f8(0xa3)](_0x15a2f8(0xb1),_0x161bc3?.[_0x15a2f8(0xbf)]));!_0x161bc3&&_0x433f6a[_0x15a2f8(0xd7)]&&(_0x161bc3=_0x433f6a[_0x15a2f8(0xd7)]);!_0x161bc3&&_0x433f6a['userId']&&(_0x161bc3=await User_1[_0x15a2f8(0xd2)][_0x15a2f8(0xc9)](_0x433f6a['userId']));const _0x11a12b=(0x0,Mustache_1[_0x15a2f8(0xd2)])(_0x235a65,_0x433f6a,_0x161bc3),_0x246acb={..._0x109933&&{'quoted':{'key':_0x109933['id'],'message':JSON[_0x15a2f8(0xc8)](_0x109933[_0x15a2f8(0xcb)])?.[_0x15a2f8(0x9f)]}}},_0x571ce2=await _0x5d1c62[_0x15a2f8(0xbd)](_0x2b5d60,{'text':_0x11a12b,..._0x246acb});return _0x5d1c62[_0x15a2f8(0xc7)](_0x571ce2),_0x571ce2?.[_0x15a2f8(0x9f)]?.[_0x15a2f8(0xc6)]?.[_0x15a2f8(0xc2)]?await(0x0,VerifyHandlers_1['verifyMediaMessage'])(_0x571ce2,_0x433f6a,_0x433f6a[_0x15a2f8(0xa7)],_0x5d1c62):await(0x0,VerifyHandlers_1[_0x15a2f8(0xcd)])(_0x571ce2,_0x433f6a,_0x433f6a[_0x15a2f8(0xa7)]),_0x571ce2;}catch(_0x73d50e){Sentry[_0x15a2f8(0xc1)](_0x73d50e),console[_0x15a2f8(0xa3)](_0x73d50e);throw new AppError_1[(_0x15a2f8(0xd2))](_0x15a2f8(0xc5));}};function a581_0x2e1c(_0x29fca1,_0x1b8f24){const _0x4ddfa2=a581_0x4b9b();return a581_0x2e1c=function(_0x3e2b56,_0x54e79e){_0x3e2b56=_0x3e2b56-0x9e;let _0x4b9b2a=_0x4ddfa2[_0x3e2b56];return _0x4b9b2a;},a581_0x2e1c(_0x29fca1,_0x1b8f24);}function a581_0x4b9b(){const _0x53361d=['@sentry/node','../../errors/AppError','search','default','toString','4BWbrvk','hasOwnProperty','2ICPMNR','user','@s.whatsapp.net','message','__esModule','881260DjKENb','(((.+)+)+)+$','log','177265LgewaH','remoteJid','725229VRfQOf','contact','key','lid','../../helpers/Mustache','__importStar','getOwnPropertyNames','get','./VerifyHandlers','number','251993aEfUse','User\x20found\x20by\x20ID:','isGroup','231953yGZXbV','defineProperty','220JtBNnI','length','call','prototype','1692488lEhLun','apply','@g.us','getOwnPropertyDescriptor','sendMessage','66vWFTYe','name','create','captureException','thumbnailDirectPath','__importDefault','../../models/User','ERR_SENDING_WAPP_MSG','extendedTextMessage','cacheMessage','parse','findByPk','findOne','dataJson','82827KOHWWD','verifyMessage','configurable'];a581_0x4b9b=function(){return _0x53361d;};return a581_0x4b9b();}exports[a581_0x4e5f56(0xd2)]=SendWhatsAppMessage;