'use strict';const a691_0x54784d=a691_0x2871;(function(_0x316230,_0x3f74c3){const _0x2b6300=a691_0x2871,_0xd762c4=_0x316230();while(!![]){try{const _0x47fdc3=parseInt(_0x2b6300(0xbc))/0x1*(parseInt(_0x2b6300(0x97))/0x2)+-parseInt(_0x2b6300(0xbd))/0x3*(parseInt(_0x2b6300(0xbe))/0x4)+parseInt(_0x2b6300(0x8e))/0x5+-parseInt(_0x2b6300(0xba))/0x6+-parseInt(_0x2b6300(0x93))/0x7*(parseInt(_0x2b6300(0xa2))/0x8)+parseInt(_0x2b6300(0xaf))/0x9*(parseInt(_0x2b6300(0xa9))/0xa)+-parseInt(_0x2b6300(0xb5))/0xb*(parseInt(_0x2b6300(0xac))/0xc);if(_0x47fdc3===_0x3f74c3)break;else _0xd762c4['push'](_0xd762c4['shift']());}catch(_0x359ee9){_0xd762c4['push'](_0xd762c4['shift']());}}}(a691_0x527a,0x70afa));function a691_0x527a(){const _0x37f088=['getOwnPropertyNames','4225815kZvsuV','verifyMediaMessage','@s.whatsapp.net','sendMessage','name','7ZedHHr','contact','extendedTextMessage','call','6HzYBdr','hasOwnProperty','toString','isGroup','number','findOne','apply','create','message','constructor','remoteJid','2468520pfNhEV','log','cacheMessage','User\x20found\x20by\x20ID:','length','../../models/Message','parse','330hhFbVs','./VerifyHandlers','writable','101796EGsuWB','search','__esModule','223218YdGfFn','verifyMessage','prototype','lid','dataJson','defineProperty','847yZkPSC','__importDefault','../../helpers/Mustache','__createBinding','(((.+)+)+)+$','2289582ceidTW','user','103913FxehMM','69kYnLXa','29644NCAfrK','userId','default'];a691_0x527a=function(){return _0x37f088;};return a691_0x527a();}var __createBinding=this&&this[a691_0x54784d(0xb8)]||(Object[a691_0x54784d(0x9e)]?function(_0x1a8981,_0x96551d,_0x3d6a9d,_0x4b1b70){const _0x30f86d=a691_0x54784d;if(_0x4b1b70===undefined)_0x4b1b70=_0x3d6a9d;var _0x4d959e=Object['getOwnPropertyDescriptor'](_0x96551d,_0x3d6a9d);(!_0x4d959e||('get'in _0x4d959e?!_0x96551d[_0x30f86d(0xae)]:_0x4d959e[_0x30f86d(0xab)]||_0x4d959e['configurable']))&&(_0x4d959e={'enumerable':!![],'get':function(){return _0x96551d[_0x3d6a9d];}}),Object['defineProperty'](_0x1a8981,_0x4b1b70,_0x4d959e);}:function(_0xd28f80,_0xea267d,_0x698807,_0x43396b){if(_0x43396b===undefined)_0x43396b=_0x698807;_0xd28f80[_0x43396b]=_0xea267d[_0x698807];}),__setModuleDefault=this&&this['__setModuleDefault']||(Object[a691_0x54784d(0x9e)]?function(_0x4f34d2,_0x1e5c81){const _0x20f2f0=a691_0x54784d;Object[_0x20f2f0(0xb4)](_0x4f34d2,_0x20f2f0(0xc0),{'enumerable':!![],'value':_0x1e5c81});}:function(_0x4462b8,_0x1807d7){const _0x1b5c52=a691_0x54784d;_0x4462b8[_0x1b5c52(0xc0)]=_0x1807d7;}),__importStar=this&&this['__importStar']||(function(){const _0x152615=(function(){let _0x4a57f7=!![];return function(_0x141dbb,_0x3ff366){const _0x14f9a5=_0x4a57f7?function(){const _0x512b8a=a691_0x2871;if(_0x3ff366){const _0x172aaa=_0x3ff366[_0x512b8a(0x9d)](_0x141dbb,arguments);return _0x3ff366=null,_0x172aaa;}}:function(){};return _0x4a57f7=![],_0x14f9a5;};}()),_0x146e6e=_0x152615(this,function(){const _0x2b9edc=a691_0x2871;return _0x146e6e[_0x2b9edc(0x99)]()[_0x2b9edc(0xad)](_0x2b9edc(0xb9))['toString']()[_0x2b9edc(0xa0)](_0x146e6e)[_0x2b9edc(0xad)](_0x2b9edc(0xb9));});_0x146e6e();var _0x370a75=function(_0x2db927){const _0xa2d1c1=a691_0x2871;return _0x370a75=Object[_0xa2d1c1(0x8d)]||function(_0x58b5a7){const _0x11c393=_0xa2d1c1;var _0x2f9726=[];for(var _0x25d26c in _0x58b5a7)if(Object[_0x11c393(0xb1)][_0x11c393(0x98)][_0x11c393(0x96)](_0x58b5a7,_0x25d26c))_0x2f9726[_0x2f9726[_0x11c393(0xa6)]]=_0x25d26c;return _0x2f9726;},_0x370a75(_0x2db927);};return function(_0x40afed){const _0x367e6e=a691_0x2871;if(_0x40afed&&_0x40afed[_0x367e6e(0xae)])return _0x40afed;var _0x493426={};if(_0x40afed!=null){for(var _0x187478=_0x370a75(_0x40afed),_0x358bf6=0x0;_0x358bf6<_0x187478[_0x367e6e(0xa6)];_0x358bf6++)if(_0x187478[_0x358bf6]!=='default')__createBinding(_0x493426,_0x40afed,_0x187478[_0x358bf6]);}return __setModuleDefault(_0x493426,_0x40afed),_0x493426;};}()),__importDefault=this&&this[a691_0x54784d(0xb6)]||function(_0x56c982){const _0xa9a734=a691_0x54784d;return _0x56c982&&_0x56c982[_0xa9a734(0xae)]?_0x56c982:{'default':_0x56c982};};Object[a691_0x54784d(0xb4)](exports,a691_0x54784d(0xae),{'value':!![]});const Sentry=__importStar(require('@sentry/node')),AppError_1=__importDefault(require('../../errors/AppError')),GetTicketWbot_1=__importDefault(require('../../helpers/GetTicketWbot')),Message_1=__importDefault(require(a691_0x54784d(0xa7))),Mustache_1=__importDefault(require(a691_0x54784d(0xb7))),VerifyHandlers_1=require(a691_0x54784d(0xaa)),User_1=__importDefault(require('../../models/User')),SendWhatsAppMessage=async({body:_0x376b3f,ticket:_0x300603,userId:_0x5437fb,quotedMsg:_0x3314b3})=>{const _0x238eba=a691_0x54784d;let _0x447e36={};const _0x13fc11=await(0x0,GetTicketWbot_1[_0x238eba(0xc0)])(_0x300603);let _0x422eae;if(_0x300603[_0x238eba(0x9a)])_0x422eae=_0x300603['contact'][_0x238eba(0x9b)]+'@g.us';else{if(_0x300603['contact'][_0x238eba(0xa1)])_0x422eae=_0x300603[_0x238eba(0x94)][_0x238eba(0xa1)];else _0x300603[_0x238eba(0x94)]['lid']?_0x422eae=_0x300603[_0x238eba(0x94)][_0x238eba(0xb2)]+'@lid':_0x422eae=_0x300603['contact']['number']+_0x238eba(0x90);}if(_0x3314b3){const _0x597f65=await Message_1[_0x238eba(0xc0)][_0x238eba(0x9c)]({'where':{'id':_0x3314b3['id']}});if(_0x597f65){const _0x3f1945=JSON['parse'](_0x597f65[_0x238eba(0xb3)]);_0x447e36={'quoted':{'key':_0x3f1945?.['key']||_0x597f65['id'],'message':_0x3f1945?.[_0x238eba(0x9f)]}};}}try{let _0x1aec9a=undefined;_0x5437fb&&(!_0x300603[_0x238eba(0xbb)]||_0x300603[_0x238eba(0xbb)]['id']!==_0x5437fb)&&(_0x1aec9a=await User_1['default']['findByPk'](_0x5437fb),console[_0x238eba(0xa3)](_0x238eba(0xa5),_0x1aec9a?.[_0x238eba(0x92)]));!_0x1aec9a&&_0x300603[_0x238eba(0xbb)]&&(_0x1aec9a=_0x300603['user']);!_0x1aec9a&&_0x300603[_0x238eba(0xbf)]&&(_0x1aec9a=await User_1['default']['findByPk'](_0x300603[_0x238eba(0xbf)]));const _0x44d01e=(0x0,Mustache_1[_0x238eba(0xc0)])(_0x376b3f,_0x300603,_0x1aec9a),_0x556f63={..._0x3314b3&&{'quoted':{'key':_0x3314b3['id'],'message':JSON[_0x238eba(0xa8)](_0x3314b3[_0x238eba(0xb3)])?.[_0x238eba(0x9f)]}}},_0x5875ca=await _0x13fc11[_0x238eba(0x91)](_0x422eae,{'text':_0x44d01e,..._0x556f63});return _0x13fc11[_0x238eba(0xa4)](_0x5875ca),_0x5875ca?.[_0x238eba(0x9f)]?.[_0x238eba(0x95)]?.['thumbnailDirectPath']?await(0x0,VerifyHandlers_1[_0x238eba(0x8f)])(_0x5875ca,_0x300603,_0x300603[_0x238eba(0x94)],_0x13fc11):await(0x0,VerifyHandlers_1[_0x238eba(0xb0)])(_0x5875ca,_0x300603,_0x300603['contact']),_0x5875ca;}catch(_0x38aff5){Sentry['captureException'](_0x38aff5),console[_0x238eba(0xa3)](_0x38aff5);throw new AppError_1[(_0x238eba(0xc0))]('ERR_SENDING_WAPP_MSG');}};function a691_0x2871(_0x4c58f6,_0x17c50e){const _0x1db23e=a691_0x527a();return a691_0x2871=function(_0x3a00b1,_0x274cde){_0x3a00b1=_0x3a00b1-0x8d;let _0x527a73=_0x1db23e[_0x3a00b1];return _0x527a73;},a691_0x2871(_0x4c58f6,_0x17c50e);}exports[a691_0x54784d(0xc0)]=SendWhatsAppMessage;