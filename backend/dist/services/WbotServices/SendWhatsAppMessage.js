'use strict';const a577_0x216888=a577_0x276a;(function(_0xdbd6c5,_0x34f4d7){const _0x3a1cfb=a577_0x276a,_0x290e26=_0xdbd6c5();while(!![]){try{const _0x27de18=parseInt(_0x3a1cfb(0xad))/0x1*(-parseInt(_0x3a1cfb(0xbc))/0x2)+parseInt(_0x3a1cfb(0xcb))/0x3*(parseInt(_0x3a1cfb(0xba))/0x4)+-parseInt(_0x3a1cfb(0xae))/0x5*(parseInt(_0x3a1cfb(0xdf))/0x6)+-parseInt(_0x3a1cfb(0xac))/0x7+-parseInt(_0x3a1cfb(0xd7))/0x8*(parseInt(_0x3a1cfb(0xc5))/0x9)+parseInt(_0x3a1cfb(0xc4))/0xa*(parseInt(_0x3a1cfb(0xe0))/0xb)+parseInt(_0x3a1cfb(0xb7))/0xc*(parseInt(_0x3a1cfb(0xbd))/0xd);if(_0x27de18===_0x34f4d7)break;else _0x290e26['push'](_0x290e26['shift']());}catch(_0x5c4c7e){_0x290e26['push'](_0x290e26['shift']());}}}(a577_0x4145,0x1c013));function a577_0x4145(){const _0x310c98=['create','message','toString','search','__esModule','findByPk','5477196NlBJeC','hasOwnProperty','../../errors/AppError','6924CaffTH','log','178348HVIKoP','13ZvPazD','@sentry/node','default','@g.us','get','getOwnPropertyNames','@s.whatsapp.net','257660fGHsPA','9dQMRtl','user','length','name','isGroup','configurable','9FUXuUP','verifyMediaMessage','dataJson','number','User\x20found\x20by\x20ID:','userId','__createBinding','thumbnailDirectPath','captureException','defineProperty','./VerifyHandlers','verifyMessage','830536povduF','__importStar','parse','ERR_SENDING_WAPP_MSG','__setModuleDefault','cacheMessage','contact','__importDefault','5898QjCZYZ','55NhEIkj','761369vHXLEl','1nEigod','885aFrwhJ','extendedTextMessage','constructor'];a577_0x4145=function(){return _0x310c98;};return a577_0x4145();}function a577_0x276a(_0x21a937,_0x1eedfb){const _0x3f2d12=a577_0x4145();return a577_0x276a=function(_0x4f91ce,_0x3ae166){_0x4f91ce=_0x4f91ce-0xac;let _0x4145b1=_0x3f2d12[_0x4f91ce];return _0x4145b1;},a577_0x276a(_0x21a937,_0x1eedfb);}var __createBinding=this&&this[a577_0x216888(0xd1)]||(Object[a577_0x216888(0xb1)]?function(_0x504d8d,_0x56eb6b,_0xf31b20,_0x567903){const _0x39044d=a577_0x216888;if(_0x567903===undefined)_0x567903=_0xf31b20;var _0x5805c6=Object['getOwnPropertyDescriptor'](_0x56eb6b,_0xf31b20);(!_0x5805c6||(_0x39044d(0xc1)in _0x5805c6?!_0x56eb6b[_0x39044d(0xb5)]:_0x5805c6['writable']||_0x5805c6[_0x39044d(0xca)]))&&(_0x5805c6={'enumerable':!![],'get':function(){return _0x56eb6b[_0xf31b20];}}),Object[_0x39044d(0xd4)](_0x504d8d,_0x567903,_0x5805c6);}:function(_0x56ef16,_0x53c6da,_0x46e629,_0x2f8609){if(_0x2f8609===undefined)_0x2f8609=_0x46e629;_0x56ef16[_0x2f8609]=_0x53c6da[_0x46e629];}),__setModuleDefault=this&&this[a577_0x216888(0xdb)]||(Object['create']?function(_0x22d1f1,_0x40bce3){const _0x40b1cd=a577_0x216888;Object[_0x40b1cd(0xd4)](_0x22d1f1,'default',{'enumerable':!![],'value':_0x40bce3});}:function(_0x465bed,_0x35465b){_0x465bed['default']=_0x35465b;}),__importStar=this&&this[a577_0x216888(0xd8)]||(function(){const _0x59c94a=(function(){let _0x252186=!![];return function(_0x48c76d,_0x1b7ae6){const _0xf11cef=_0x252186?function(){if(_0x1b7ae6){const _0x3d8d29=_0x1b7ae6['apply'](_0x48c76d,arguments);return _0x1b7ae6=null,_0x3d8d29;}}:function(){};return _0x252186=![],_0xf11cef;};}()),_0x310589=_0x59c94a(this,function(){const _0x3fcdbb=a577_0x276a;return _0x310589[_0x3fcdbb(0xb3)]()[_0x3fcdbb(0xb4)]('(((.+)+)+)+$')[_0x3fcdbb(0xb3)]()[_0x3fcdbb(0xb0)](_0x310589)[_0x3fcdbb(0xb4)]('(((.+)+)+)+$');});_0x310589();var _0x252198=function(_0x2431ac){const _0x486efd=a577_0x276a;return _0x252198=Object[_0x486efd(0xc2)]||function(_0x115c59){const _0x572c51=_0x486efd;var _0x59a1a3=[];for(var _0x5146a5 in _0x115c59)if(Object['prototype'][_0x572c51(0xb8)]['call'](_0x115c59,_0x5146a5))_0x59a1a3[_0x59a1a3[_0x572c51(0xc7)]]=_0x5146a5;return _0x59a1a3;},_0x252198(_0x2431ac);};return function(_0x3bd73d){const _0x58f839=a577_0x276a;if(_0x3bd73d&&_0x3bd73d['__esModule'])return _0x3bd73d;var _0x1e5eef={};if(_0x3bd73d!=null){for(var _0x1106f6=_0x252198(_0x3bd73d),_0x31822c=0x0;_0x31822c<_0x1106f6[_0x58f839(0xc7)];_0x31822c++)if(_0x1106f6[_0x31822c]!==_0x58f839(0xbf))__createBinding(_0x1e5eef,_0x3bd73d,_0x1106f6[_0x31822c]);}return __setModuleDefault(_0x1e5eef,_0x3bd73d),_0x1e5eef;};}()),__importDefault=this&&this[a577_0x216888(0xde)]||function(_0x3650e6){const _0x210be0=a577_0x216888;return _0x3650e6&&_0x3650e6[_0x210be0(0xb5)]?_0x3650e6:{'default':_0x3650e6};};Object[a577_0x216888(0xd4)](exports,a577_0x216888(0xb5),{'value':!![]});const Sentry=__importStar(require(a577_0x216888(0xbe))),AppError_1=__importDefault(require(a577_0x216888(0xb9))),GetTicketWbot_1=__importDefault(require('../../helpers/GetTicketWbot')),Message_1=__importDefault(require('../../models/Message')),Mustache_1=__importDefault(require('../../helpers/Mustache')),VerifyHandlers_1=require(a577_0x216888(0xd5)),User_1=__importDefault(require('../../models/User')),SendWhatsAppMessage=async({body:_0x5a6949,ticket:_0x28e61f,userId:_0x3c7fba,quotedMsg:_0x1a6db2})=>{const _0x2e44ad=a577_0x216888;let _0x2add69={};const _0xa10743=await(0x0,GetTicketWbot_1[_0x2e44ad(0xbf)])(_0x28e61f),_0x5061ab=_0x28e61f[_0x2e44ad(0xc9)]?_0x28e61f[_0x2e44ad(0xdd)][_0x2e44ad(0xce)]+_0x2e44ad(0xc0):_0x28e61f[_0x2e44ad(0xdd)][_0x2e44ad(0xce)]+_0x2e44ad(0xc3);if(_0x1a6db2){const _0x36c0e5=await Message_1['default']['findOne']({'where':{'id':_0x1a6db2['id']}});if(_0x36c0e5){const _0x186724=JSON[_0x2e44ad(0xd9)](_0x36c0e5[_0x2e44ad(0xcd)]);_0x2add69={'quoted':{'key':_0x186724?.['key']||_0x36c0e5['id'],'message':_0x186724?.[_0x2e44ad(0xb2)]}};}}try{let _0x4777e8=undefined;_0x3c7fba&&(!_0x28e61f[_0x2e44ad(0xc6)]||_0x28e61f['user']['id']!==_0x3c7fba)&&(_0x4777e8=await User_1['default'][_0x2e44ad(0xb6)](_0x3c7fba),console[_0x2e44ad(0xbb)](_0x2e44ad(0xcf),_0x4777e8?.[_0x2e44ad(0xc8)]));!_0x4777e8&&_0x28e61f[_0x2e44ad(0xc6)]&&(_0x4777e8=_0x28e61f[_0x2e44ad(0xc6)],console[_0x2e44ad(0xbb)]('Using\x20ticket.user:',_0x28e61f['user']?.[_0x2e44ad(0xc8)]));!_0x4777e8&&_0x28e61f[_0x2e44ad(0xd0)]&&(_0x4777e8=await User_1[_0x2e44ad(0xbf)][_0x2e44ad(0xb6)](_0x28e61f[_0x2e44ad(0xd0)]),console[_0x2e44ad(0xbb)]('Using\x20user\x20from\x20ticket.userId:',_0x4777e8?.['name']));const _0x555905=(0x0,Mustache_1[_0x2e44ad(0xbf)])(_0x5a6949,_0x28e61f,_0x4777e8),_0x13c0e1={..._0x1a6db2&&{'quoted':{'key':_0x1a6db2['id'],'message':JSON[_0x2e44ad(0xd9)](_0x1a6db2['dataJson'])?.['message']}}},_0x134a37=await _0xa10743['sendMessage'](_0x5061ab,{'text':_0x555905,..._0x13c0e1});return _0xa10743[_0x2e44ad(0xdc)](_0x134a37),_0x134a37?.[_0x2e44ad(0xb2)]?.[_0x2e44ad(0xaf)]?.[_0x2e44ad(0xd2)]?await(0x0,VerifyHandlers_1[_0x2e44ad(0xcc)])(_0x134a37,_0x28e61f,_0x28e61f[_0x2e44ad(0xdd)],_0xa10743):await(0x0,VerifyHandlers_1[_0x2e44ad(0xd6)])(_0x134a37,_0x28e61f,_0x28e61f[_0x2e44ad(0xdd)]),_0x134a37;}catch(_0x1bead5){Sentry[_0x2e44ad(0xd3)](_0x1bead5),console[_0x2e44ad(0xbb)](_0x1bead5);throw new AppError_1['default'](_0x2e44ad(0xda));}};exports[a577_0x216888(0xbf)]=SendWhatsAppMessage;