const a552_0x406d83=a552_0x241c;(function(_0x34f9c3,_0x3dfda2){const _0xc134a=a552_0x241c,_0x4fb560=_0x34f9c3();while(!![]){try{const _0x1c22f0=parseInt(_0xc134a(0x1a4))/0x1*(parseInt(_0xc134a(0x1a5))/0x2)+parseInt(_0xc134a(0x1b8))/0x3*(-parseInt(_0xc134a(0x1ba))/0x4)+-parseInt(_0xc134a(0x19e))/0x5+-parseInt(_0xc134a(0x195))/0x6*(-parseInt(_0xc134a(0x190))/0x7)+-parseInt(_0xc134a(0x197))/0x8+-parseInt(_0xc134a(0x191))/0x9+-parseInt(_0xc134a(0x1ab))/0xa*(-parseInt(_0xc134a(0x1a9))/0xb);if(_0x1c22f0===_0x3dfda2)break;else _0x4fb560['push'](_0x4fb560['shift']());}catch(_0x2726ab){_0x4fb560['push'](_0x4fb560['shift']());}}}(a552_0x4836,0xcc77e));function a552_0x241c(_0x1ec989,_0x2a8f64){const _0x1f6644=a552_0x4836();return a552_0x241c=function(_0x109b63,_0x599556){_0x109b63=_0x109b63-0x185;let _0x4836f3=_0x1f6644[_0x109b63];return _0x4836f3;},a552_0x241c(_0x1ec989,_0x2a8f64);}const a552_0x599556=(function(){let _0x7712b8=!![];return function(_0x3033f4,_0x2b6630){const _0x4016a5=_0x7712b8?function(){const _0x52996b=a552_0x241c;if(_0x2b6630){const _0x3b81ea=_0x2b6630[_0x52996b(0x1af)](_0x3033f4,arguments);return _0x2b6630=null,_0x3b81ea;}}:function(){};return _0x7712b8=![],_0x4016a5;};}()),a552_0x109b63=a552_0x599556(this,function(){const _0x6ac23e=a552_0x241c;return a552_0x109b63[_0x6ac23e(0x1a3)]()[_0x6ac23e(0x1aa)](_0x6ac23e(0x18f))['toString']()[_0x6ac23e(0x1a1)](a552_0x109b63)[_0x6ac23e(0x1aa)](_0x6ac23e(0x18f));});a552_0x109b63();'use strict';function a552_0x4836(){const _0x49b229=['apply','@sentry/node','number','__importStar','create','parse','s.whatsapp.net','call','split','159OEVisB','lodash','91660LjRljn','default','update','END:VCARD','TEL;type=CELL;waid=','getOwnPropertyDescriptor','hasOwnProperty','dataJson','get','__createBinding','findOne','(((.+)+)+)+$','14dXuZgt','5819229SJFzam','ERR_SENDING_WAPP_MSG','configurable','extendedTextMessage','2092932RPdpaM','log','3593216uaXYyN','__esModule','../../helpers/GetTicketWbot','../../models/Message','message','isGroup','sendMessage','5883755ctcKTA','defineProperty','key','constructor','trace','toString','164FBkOMw','3398hQZEXL','prototype','../../helpers/Mustache','name','11GAtSrx','search','33482010FdtQvq','FN:','contact','BEGIN:VCARD\x0aVERSION:3.0\x0a'];a552_0x4836=function(){return _0x49b229;};return a552_0x4836();}var __createBinding=this&&this[a552_0x406d83(0x18d)]||(Object[a552_0x406d83(0x1b3)]?function(_0x465df8,_0x4ff309,_0x45c3f7,_0x18538c){const _0x3456f0=a552_0x406d83;if(_0x18538c===undefined)_0x18538c=_0x45c3f7;var _0x22f877=Object[_0x3456f0(0x189)](_0x4ff309,_0x45c3f7);(!_0x22f877||(_0x3456f0(0x18c)in _0x22f877?!_0x4ff309['__esModule']:_0x22f877['writable']||_0x22f877[_0x3456f0(0x193)]))&&(_0x22f877={'enumerable':!![],'get':function(){return _0x4ff309[_0x45c3f7];}}),Object[_0x3456f0(0x19f)](_0x465df8,_0x18538c,_0x22f877);}:function(_0x2cc0df,_0x111cc4,_0x43d03a,_0x5ef7d2){if(_0x5ef7d2===undefined)_0x5ef7d2=_0x43d03a;_0x2cc0df[_0x5ef7d2]=_0x111cc4[_0x43d03a];}),__setModuleDefault=this&&this['__setModuleDefault']||(Object[a552_0x406d83(0x1b3)]?function(_0x751dfa,_0x2bc8f0){const _0x590ae8=a552_0x406d83;Object['defineProperty'](_0x751dfa,_0x590ae8(0x185),{'enumerable':!![],'value':_0x2bc8f0});}:function(_0x30877b,_0x1075b9){const _0x4bc1cf=a552_0x406d83;_0x30877b[_0x4bc1cf(0x185)]=_0x1075b9;}),__importStar=this&&this[a552_0x406d83(0x1b2)]||function(_0x3ac2a6){const _0x13000e=a552_0x406d83;if(_0x3ac2a6&&_0x3ac2a6['__esModule'])return _0x3ac2a6;var _0x5119bc={};if(_0x3ac2a6!=null){for(var _0x2b398b in _0x3ac2a6)if(_0x2b398b!==_0x13000e(0x185)&&Object[_0x13000e(0x1a6)][_0x13000e(0x18a)][_0x13000e(0x1b6)](_0x3ac2a6,_0x2b398b))__createBinding(_0x5119bc,_0x3ac2a6,_0x2b398b);}return __setModuleDefault(_0x5119bc,_0x3ac2a6),_0x5119bc;},__importDefault=this&&this['__importDefault']||function(_0x4d5896){const _0xbcae4=a552_0x406d83;return _0x4d5896&&_0x4d5896[_0xbcae4(0x198)]?_0x4d5896:{'default':_0x4d5896};};Object[a552_0x406d83(0x19f)](exports,a552_0x406d83(0x198),{'value':!![]});const Sentry=__importStar(require(a552_0x406d83(0x1b0))),AppError_1=__importDefault(require('../../errors/AppError')),GetTicketWbot_1=__importDefault(require(a552_0x406d83(0x199))),Message_1=__importDefault(require(a552_0x406d83(0x19a))),lodash_1=__importDefault(require(a552_0x406d83(0x1b9))),Mustache_1=__importDefault(require(a552_0x406d83(0x1a7))),SendWhatsAppMessage=async({body:_0x472a09,ticket:_0x61a176,quotedMsg:_0x4d14e0,vCard:_0x39951c})=>{const _0x15a098=a552_0x406d83;let _0x123eb8={};const _0x4f3ba6=await(0x0,GetTicketWbot_1[_0x15a098(0x185)])(_0x61a176);if(!_0x4f3ba6)throw new AppError_1[(_0x15a098(0x185))]('ERR_WBOT_NOT_FOUND');const _0x2c45ed=_0x61a176[_0x15a098(0x1ad)]['number']+'@'+(_0x61a176[_0x15a098(0x19c)]?'g.us':_0x15a098(0x1b5));if(_0x4d14e0){const _0x3faa3f=await Message_1[_0x15a098(0x185)][_0x15a098(0x18e)]({'where':{'id':_0x4d14e0['id']}});if(_0x3faa3f){const _0x432bd7=JSON[_0x15a098(0x1b4)](_0x3faa3f[_0x15a098(0x18b)]);_0x123eb8={'quoted':{'key':_0x432bd7[_0x15a098(0x1a0)]||_0x3faa3f['id'],'message':{'extendedTextMessage':_0x432bd7?.[_0x15a098(0x19b)][_0x15a098(0x194)]}}};}}if(!lodash_1[_0x15a098(0x185)]['isNil'](_0x39951c)){const _0x294c48=_0x39951c[_0x15a098(0x1b1)],_0x32f298=_0x39951c['name'][_0x15a098(0x1b7)]('\x20')[0x0],_0x39b2a0=String(_0x39951c[_0x15a098(0x1a8)])['replace'](_0x39951c[_0x15a098(0x1a8)][_0x15a098(0x1b7)]('\x20')[0x0],''),_0x2ef65f=_0x15a098(0x1ae)+('N:'+_0x39b2a0+';'+_0x32f298+';;;\x0a')+(_0x15a098(0x1ac)+_0x39951c[_0x15a098(0x1a8)]+'\x0a')+(_0x15a098(0x188)+_0x294c48+':+'+_0x294c48+'\x0a')+_0x15a098(0x187);try{const _0x199420=await _0x4f3ba6[_0x15a098(0x19d)](_0x2c45ed,{'contacts':{'displayName':''+_0x39951c[_0x15a098(0x1a8)],'contacts':[{'vcard':_0x2ef65f}]}});return await _0x61a176[_0x15a098(0x186)]({'lastMessage':(0x0,Mustache_1[_0x15a098(0x185)])(_0x2ef65f,_0x61a176),'imported':null}),_0x199420;}catch(_0x3076da){Sentry['captureException'](_0x3076da),console[_0x15a098(0x1a2)](_0x3076da);throw new AppError_1['default']('ERR_SENDING_WAPP_MSG');}}try{const _0x110560=await _0x4f3ba6[_0x15a098(0x19d)](_0x2c45ed,{'text':(0x0,Mustache_1[_0x15a098(0x185)])(_0x472a09,_0x61a176)},{..._0x123eb8});return await _0x61a176[_0x15a098(0x186)]({'lastMessage':(0x0,Mustache_1[_0x15a098(0x185)])(_0x472a09,_0x61a176)}),_0x110560;}catch(_0x4362be){Sentry['captureException'](_0x4362be),console[_0x15a098(0x196)](_0x4362be);throw new AppError_1[(_0x15a098(0x185))](_0x15a098(0x192));}};exports[a552_0x406d83(0x185)]=SendWhatsAppMessage;