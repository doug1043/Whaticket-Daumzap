'use strict';function a572_0x26f6(){const _0x3a46ab=['default','prototype','cacheMessage','message','4259358DtgsQS','key','__importStar','2539260KOoKAa','findByPk','getOwnPropertyDescriptor','22420ffRBYd','3289170AHhvTs','verifyMessage','configurable','length','../../errors/AppError','get','search','232RQQvDS','__setModuleDefault','create','defineProperty','972614MEqYHu','../../helpers/Mustache','__esModule','call','../../models/Message','__importDefault','extendedTextMessage','constructor','captureException','toString','log','1119780xfVPFL','contact','203791CyriKf','(((.+)+)+)+$','dataJson','writable','@sentry/node','parse','__createBinding','129UfBmAg','findOne','../../helpers/GetTicketWbot','number','isGroup'];a572_0x26f6=function(){return _0x3a46ab;};return a572_0x26f6();}function a572_0x1a9b(_0x133bc5,_0x3c4cd5){const _0xe7c7db=a572_0x26f6();return a572_0x1a9b=function(_0x52562c,_0x419ab3){_0x52562c=_0x52562c-0xd9;let _0x26f64d=_0xe7c7db[_0x52562c];return _0x26f64d;},a572_0x1a9b(_0x133bc5,_0x3c4cd5);}const a572_0x2d9666=a572_0x1a9b;(function(_0x30281b,_0x3e6d17){const _0x7c9045=a572_0x1a9b,_0x4e3110=_0x30281b();while(!![]){try{const _0x41c11b=parseInt(_0x7c9045(0xdb))/0x1+parseInt(_0x7c9045(0xff))/0x2+parseInt(_0x7c9045(0xe4))/0x3*(-parseInt(_0x7c9045(0xf3))/0x4)+-parseInt(_0x7c9045(0xf4))/0x5+-parseInt(_0x7c9045(0xf0))/0x6+parseInt(_0x7c9045(0xdd))/0x7*(parseInt(_0x7c9045(0xfb))/0x8)+-parseInt(_0x7c9045(0xed))/0x9;if(_0x41c11b===_0x3e6d17)break;else _0x4e3110['push'](_0x4e3110['shift']());}catch(_0x3d5ee8){_0x4e3110['push'](_0x4e3110['shift']());}}}(a572_0x26f6,0x9fec3));var __createBinding=this&&this[a572_0x2d9666(0xe3)]||(Object[a572_0x2d9666(0xfd)]?function(_0x21f725,_0xf04b73,_0x64b672,_0x5b01be){const _0x2b6084=a572_0x2d9666;if(_0x5b01be===undefined)_0x5b01be=_0x64b672;var _0x2ee47e=Object[_0x2b6084(0xf2)](_0xf04b73,_0x64b672);(!_0x2ee47e||(_0x2b6084(0xf9)in _0x2ee47e?!_0xf04b73['__esModule']:_0x2ee47e[_0x2b6084(0xe0)]||_0x2ee47e[_0x2b6084(0xf6)]))&&(_0x2ee47e={'enumerable':!![],'get':function(){return _0xf04b73[_0x64b672];}}),Object[_0x2b6084(0xfe)](_0x21f725,_0x5b01be,_0x2ee47e);}:function(_0x15b373,_0x2942fa,_0x6609e6,_0xa2f122){if(_0xa2f122===undefined)_0xa2f122=_0x6609e6;_0x15b373[_0xa2f122]=_0x2942fa[_0x6609e6];}),__setModuleDefault=this&&this[a572_0x2d9666(0xfc)]||(Object['create']?function(_0x3790bc,_0x43f578){const _0x121a6f=a572_0x2d9666;Object[_0x121a6f(0xfe)](_0x3790bc,_0x121a6f(0xe9),{'enumerable':!![],'value':_0x43f578});}:function(_0x1add38,_0x580d23){const _0x37cfde=a572_0x2d9666;_0x1add38[_0x37cfde(0xe9)]=_0x580d23;}),__importStar=this&&this[a572_0x2d9666(0xef)]||(function(){const _0x695829=(function(){let _0x3db820=!![];return function(_0x193195,_0x2921d8){const _0x4d7cb9=_0x3db820?function(){if(_0x2921d8){const _0x585719=_0x2921d8['apply'](_0x193195,arguments);return _0x2921d8=null,_0x585719;}}:function(){};return _0x3db820=![],_0x4d7cb9;};}()),_0x17d145=_0x695829(this,function(){const _0x447233=a572_0x1a9b;return _0x17d145[_0x447233(0xd9)]()[_0x447233(0xfa)](_0x447233(0xde))[_0x447233(0xd9)]()[_0x447233(0x106)](_0x17d145)[_0x447233(0xfa)](_0x447233(0xde));});_0x17d145();var _0x5c8327=function(_0x10d865){return _0x5c8327=Object['getOwnPropertyNames']||function(_0x461c4d){const _0x46e5cf=a572_0x1a9b;var _0x54d9a0=[];for(var _0x12bb6c in _0x461c4d)if(Object[_0x46e5cf(0xea)]['hasOwnProperty'][_0x46e5cf(0x102)](_0x461c4d,_0x12bb6c))_0x54d9a0[_0x54d9a0['length']]=_0x12bb6c;return _0x54d9a0;},_0x5c8327(_0x10d865);};return function(_0xacd9f){const _0x2a0758=a572_0x1a9b;if(_0xacd9f&&_0xacd9f[_0x2a0758(0x101)])return _0xacd9f;var _0x315323={};if(_0xacd9f!=null){for(var _0x36c50b=_0x5c8327(_0xacd9f),_0x35f200=0x0;_0x35f200<_0x36c50b[_0x2a0758(0xf7)];_0x35f200++)if(_0x36c50b[_0x35f200]!==_0x2a0758(0xe9))__createBinding(_0x315323,_0xacd9f,_0x36c50b[_0x35f200]);}return __setModuleDefault(_0x315323,_0xacd9f),_0x315323;};}()),__importDefault=this&&this[a572_0x2d9666(0x104)]||function(_0x3504eb){const _0x3efd78=a572_0x2d9666;return _0x3504eb&&_0x3504eb[_0x3efd78(0x101)]?_0x3504eb:{'default':_0x3504eb};};Object[a572_0x2d9666(0xfe)](exports,a572_0x2d9666(0x101),{'value':!![]});const Sentry=__importStar(require(a572_0x2d9666(0xe1))),AppError_1=__importDefault(require(a572_0x2d9666(0xf8))),GetTicketWbot_1=__importDefault(require(a572_0x2d9666(0xe6))),Message_1=__importDefault(require(a572_0x2d9666(0x103))),Mustache_1=__importDefault(require(a572_0x2d9666(0x100))),VerifyHandlers_1=require('./VerifyHandlers'),User_1=__importDefault(require('../../models/User')),SendWhatsAppMessage=async({body:_0x463211,ticket:_0x760f59,userId:_0x44e4ac,quotedMsg:_0x1f5e61})=>{const _0x1bd836=a572_0x2d9666;let _0x12aff7={};const _0x46daf4=await(0x0,GetTicketWbot_1['default'])(_0x760f59),_0x417ad7=_0x760f59[_0x1bd836(0xe8)]?_0x760f59['contact']['number']+'@g.us':_0x760f59[_0x1bd836(0xdc)][_0x1bd836(0xe7)]+'@s.whatsapp.net';if(_0x1f5e61){const _0x5373df=await Message_1[_0x1bd836(0xe9)][_0x1bd836(0xe5)]({'where':{'id':_0x1f5e61['id']}});if(_0x5373df){const _0x4ad02a=JSON['parse'](_0x5373df['dataJson']);_0x12aff7={'quoted':{'key':_0x4ad02a?.[_0x1bd836(0xee)]||_0x5373df['id'],'message':_0x4ad02a?.[_0x1bd836(0xec)]}};}}try{const _0x507e7c=_0x44e4ac&&await User_1[_0x1bd836(0xe9)][_0x1bd836(0xf1)](_0x44e4ac),_0x44850a=(0x0,Mustache_1[_0x1bd836(0xe9)])(_0x463211,_0x760f59,_0x507e7c),_0x56737d={..._0x1f5e61&&{'quoted':{'key':_0x1f5e61['id'],'message':JSON[_0x1bd836(0xe2)](_0x1f5e61[_0x1bd836(0xdf)])?.[_0x1bd836(0xec)]}}},_0xb43c8f=await _0x46daf4['sendMessage'](_0x417ad7,{'text':_0x44850a,..._0x56737d});return _0x46daf4[_0x1bd836(0xeb)](_0xb43c8f),_0xb43c8f?.[_0x1bd836(0xec)]?.[_0x1bd836(0x105)]?.['thumbnailDirectPath']?await(0x0,VerifyHandlers_1['verifyMediaMessage'])(_0xb43c8f,_0x760f59,_0x760f59[_0x1bd836(0xdc)],_0x46daf4):await(0x0,VerifyHandlers_1[_0x1bd836(0xf5)])(_0xb43c8f,_0x760f59,_0x760f59[_0x1bd836(0xdc)]),_0xb43c8f;}catch(_0x17f333){Sentry[_0x1bd836(0x107)](_0x17f333),console[_0x1bd836(0xda)](_0x17f333);throw new AppError_1[(_0x1bd836(0xe9))]('ERR_SENDING_WAPP_MSG');}};exports[a572_0x2d9666(0xe9)]=SendWhatsAppMessage;