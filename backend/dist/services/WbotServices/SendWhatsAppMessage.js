function a551_0x133f(){const _0x1b9272=['../../models/Message','trace','log','22vXeItS','3702432QUGDCc','captureException','defineProperty','getOwnPropertyDescriptor','default','hasOwnProperty','sendMessage','../../helpers/GetTicketWbot','../../errors/AppError','findOne','parse','s.whatsapp.net','key','12354TYnobh','4371720Irmimh','toString',';;;\x0a','16oKtYnA','call','replace','number','prototype','message','2yKNiPn','210875meiEev','constructor','apply','__createBinding','../../helpers/Mustache','__importDefault','name','__setModuleDefault','ERR_WBOT_NOT_FOUND','writable','create','split','ERR_SENDING_WAPP_MSG','__esModule','configurable','7544320dhUHDE','search','2451175GflDCL','FN:','4153563EWxvDE','lodash','update','1236EIehkg','(((.+)+)+)+$'];a551_0x133f=function(){return _0x1b9272;};return a551_0x133f();}const a551_0x50742c=a551_0x21fb;(function(_0x9b1867,_0x8edc0d){const _0x1be17f=a551_0x21fb,_0x4cf16d=_0x9b1867();while(!![]){try{const _0x154e47=-parseInt(_0x1be17f(0x98))/0x1*(parseInt(_0x1be17f(0x97))/0x2)+parseInt(_0x1be17f(0x8d))/0x3*(parseInt(_0x1be17f(0x7a))/0x4)+-parseInt(_0x1be17f(0x75))/0x5+-parseInt(_0x1be17f(0x80))/0x6+-parseInt(_0x1be17f(0x73))/0x7+-parseInt(_0x1be17f(0x91))/0x8*(-parseInt(_0x1be17f(0x77))/0x9)+-parseInt(_0x1be17f(0x8e))/0xa*(-parseInt(_0x1be17f(0x7f))/0xb);if(_0x154e47===_0x8edc0d)break;else _0x4cf16d['push'](_0x4cf16d['shift']());}catch(_0x5270fe){_0x4cf16d['push'](_0x4cf16d['shift']());}}}(a551_0x133f,0xa4856));const a551_0x4ef445=(function(){let _0x1ebbed=!![];return function(_0x34594e,_0x1e23f){const _0x1ffe39=_0x1ebbed?function(){const _0x11ca13=a551_0x21fb;if(_0x1e23f){const _0x32c8e2=_0x1e23f[_0x11ca13(0x9a)](_0x34594e,arguments);return _0x1e23f=null,_0x32c8e2;}}:function(){};return _0x1ebbed=![],_0x1ffe39;};}()),a551_0x4153ba=a551_0x4ef445(this,function(){const _0x1cf761=a551_0x21fb;return a551_0x4153ba['toString']()[_0x1cf761(0x74)](_0x1cf761(0x7b))[_0x1cf761(0x8f)]()[_0x1cf761(0x99)](a551_0x4153ba)[_0x1cf761(0x74)]('(((.+)+)+)+$');});a551_0x4153ba();function a551_0x21fb(_0x4d7cc6,_0x1f489c){const _0x2c0007=a551_0x133f();return a551_0x21fb=function(_0x4153ba,_0x4ef445){_0x4153ba=_0x4153ba-0x73;let _0x133fac=_0x2c0007[_0x4153ba];return _0x133fac;},a551_0x21fb(_0x4d7cc6,_0x1f489c);}'use strict';var __createBinding=this&&this[a551_0x50742c(0x9b)]||(Object[a551_0x50742c(0xa2)]?function(_0x5e1d57,_0x704c9c,_0x4e5a11,_0x3c4d78){const _0xc01f18=a551_0x50742c;if(_0x3c4d78===undefined)_0x3c4d78=_0x4e5a11;var _0x150e54=Object[_0xc01f18(0x83)](_0x704c9c,_0x4e5a11);(!_0x150e54||('get'in _0x150e54?!_0x704c9c['__esModule']:_0x150e54[_0xc01f18(0xa1)]||_0x150e54[_0xc01f18(0xa6)]))&&(_0x150e54={'enumerable':!![],'get':function(){return _0x704c9c[_0x4e5a11];}}),Object[_0xc01f18(0x82)](_0x5e1d57,_0x3c4d78,_0x150e54);}:function(_0x44e12b,_0x43d00d,_0x1d2d0d,_0x5e6ace){if(_0x5e6ace===undefined)_0x5e6ace=_0x1d2d0d;_0x44e12b[_0x5e6ace]=_0x43d00d[_0x1d2d0d];}),__setModuleDefault=this&&this[a551_0x50742c(0x9f)]||(Object[a551_0x50742c(0xa2)]?function(_0x3488bf,_0x35423b){const _0x1fc6e6=a551_0x50742c;Object[_0x1fc6e6(0x82)](_0x3488bf,_0x1fc6e6(0x84),{'enumerable':!![],'value':_0x35423b});}:function(_0x2e8ff4,_0x258838){_0x2e8ff4['default']=_0x258838;}),__importStar=this&&this['__importStar']||function(_0x36adf4){const _0x3c569a=a551_0x50742c;if(_0x36adf4&&_0x36adf4[_0x3c569a(0xa5)])return _0x36adf4;var _0x4fcce5={};if(_0x36adf4!=null){for(var _0x156b66 in _0x36adf4)if(_0x156b66!=='default'&&Object[_0x3c569a(0x95)][_0x3c569a(0x85)][_0x3c569a(0x92)](_0x36adf4,_0x156b66))__createBinding(_0x4fcce5,_0x36adf4,_0x156b66);}return __setModuleDefault(_0x4fcce5,_0x36adf4),_0x4fcce5;},__importDefault=this&&this[a551_0x50742c(0x9d)]||function(_0x23b1d7){const _0x10db10=a551_0x50742c;return _0x23b1d7&&_0x23b1d7[_0x10db10(0xa5)]?_0x23b1d7:{'default':_0x23b1d7};};Object[a551_0x50742c(0x82)](exports,a551_0x50742c(0xa5),{'value':!![]});const Sentry=__importStar(require('@sentry/node')),AppError_1=__importDefault(require(a551_0x50742c(0x88))),GetTicketWbot_1=__importDefault(require(a551_0x50742c(0x87))),Message_1=__importDefault(require(a551_0x50742c(0x7c))),lodash_1=__importDefault(require(a551_0x50742c(0x78))),Mustache_1=__importDefault(require(a551_0x50742c(0x9c))),SendWhatsAppMessage=async({body:_0x73d818,ticket:_0x4fdbc5,quotedMsg:_0x393d6b,vCard:_0x10fdf3})=>{const _0x5ea823=a551_0x50742c;let _0x376511={};const _0x5cd209=await(0x0,GetTicketWbot_1[_0x5ea823(0x84)])(_0x4fdbc5);if(!_0x5cd209)throw new AppError_1['default'](_0x5ea823(0xa0));const _0xf78f5=_0x4fdbc5['contact']['number']+'@'+(_0x4fdbc5['isGroup']?'g.us':_0x5ea823(0x8b));if(_0x393d6b){const _0x539f2c=await Message_1[_0x5ea823(0x84)][_0x5ea823(0x89)]({'where':{'id':_0x393d6b['id']}});if(_0x539f2c){const _0x3a5261=JSON[_0x5ea823(0x8a)](_0x539f2c['dataJson']);_0x376511={'quoted':{'key':_0x3a5261[_0x5ea823(0x8c)]||_0x539f2c['id'],'message':{'extendedTextMessage':_0x3a5261?.[_0x5ea823(0x96)]['extendedTextMessage']}}};}}if(!lodash_1['default']['isNil'](_0x10fdf3)){const _0x5d408d=_0x10fdf3[_0x5ea823(0x94)],_0x418899=_0x10fdf3['name'][_0x5ea823(0xa3)]('\x20')[0x0],_0xaa4d7b=String(_0x10fdf3[_0x5ea823(0x9e)])[_0x5ea823(0x93)](_0x10fdf3[_0x5ea823(0x9e)][_0x5ea823(0xa3)]('\x20')[0x0],''),_0x3f6214='BEGIN:VCARD\x0aVERSION:3.0\x0a'+('N:'+_0xaa4d7b+';'+_0x418899+_0x5ea823(0x90))+(_0x5ea823(0x76)+_0x10fdf3['name']+'\x0a')+('TEL;type=CELL;waid='+_0x5d408d+':+'+_0x5d408d+'\x0a')+'END:VCARD';try{const _0x3b97e4=await _0x5cd209[_0x5ea823(0x86)](_0xf78f5,{'contacts':{'displayName':''+_0x10fdf3[_0x5ea823(0x9e)],'contacts':[{'vcard':_0x3f6214}]}});return await _0x4fdbc5[_0x5ea823(0x79)]({'lastMessage':(0x0,Mustache_1[_0x5ea823(0x84)])(_0x3f6214,_0x4fdbc5),'imported':null}),_0x3b97e4;}catch(_0xfce4e1){Sentry[_0x5ea823(0x81)](_0xfce4e1),console[_0x5ea823(0x7d)](_0xfce4e1);throw new AppError_1['default'](_0x5ea823(0xa4));}}try{const _0x11a58b=await _0x5cd209[_0x5ea823(0x86)](_0xf78f5,{'text':(0x0,Mustache_1[_0x5ea823(0x84)])(_0x73d818,_0x4fdbc5)},{..._0x376511});return await _0x4fdbc5[_0x5ea823(0x79)]({'lastMessage':(0x0,Mustache_1[_0x5ea823(0x84)])(_0x73d818,_0x4fdbc5)}),_0x11a58b;}catch(_0xfe4c8f){Sentry[_0x5ea823(0x81)](_0xfe4c8f),console[_0x5ea823(0x7e)](_0xfe4c8f);throw new AppError_1[(_0x5ea823(0x84))](_0x5ea823(0xa4));}};exports[a551_0x50742c(0x84)]=SendWhatsAppMessage;