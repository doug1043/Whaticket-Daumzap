'use strict';const a689_0x4bd8fd=a689_0x1211;(function(_0x207d03,_0x1cee48){const _0x436e95=a689_0x1211,_0x3048c5=_0x207d03();while(!![]){try{const _0xff0117=-parseInt(_0x436e95(0x17b))/0x1*(-parseInt(_0x436e95(0x1c1))/0x2)+-parseInt(_0x436e95(0x1b6))/0x3+parseInt(_0x436e95(0x186))/0x4+-parseInt(_0x436e95(0x1a7))/0x5*(-parseInt(_0x436e95(0x1a3))/0x6)+-parseInt(_0x436e95(0x1bf))/0x7*(-parseInt(_0x436e95(0x19f))/0x8)+-parseInt(_0x436e95(0x1aa))/0x9+-parseInt(_0x436e95(0x177))/0xa;if(_0xff0117===_0x1cee48)break;else _0x3048c5['push'](_0x3048c5['shift']());}catch(_0x314675){_0x3048c5['push'](_0x3048c5['shift']());}}}(a689_0xbd6f,0x73a50));var __createBinding=this&&this['__createBinding']||(Object['create']?function(_0x5bab92,_0xe4a5be,_0x1e38ff,_0x45dfed){const _0xc8b1b8=a689_0x1211;if(_0x45dfed===undefined)_0x45dfed=_0x1e38ff;var _0xe2bf60=Object[_0xc8b1b8(0x185)](_0xe4a5be,_0x1e38ff);(!_0xe2bf60||(_0xc8b1b8(0x199)in _0xe2bf60?!_0xe4a5be[_0xc8b1b8(0x193)]:_0xe2bf60[_0xc8b1b8(0x174)]||_0xe2bf60[_0xc8b1b8(0x1b0)]))&&(_0xe2bf60={'enumerable':!![],'get':function(){return _0xe4a5be[_0x1e38ff];}}),Object[_0xc8b1b8(0x18a)](_0x5bab92,_0x45dfed,_0xe2bf60);}:function(_0x3037ca,_0x15980d,_0x493324,_0x49834f){if(_0x49834f===undefined)_0x49834f=_0x493324;_0x3037ca[_0x49834f]=_0x15980d[_0x493324];}),__setModuleDefault=this&&this[a689_0x4bd8fd(0x17a)]||(Object[a689_0x4bd8fd(0x19b)]?function(_0x4b8374,_0x14b4ca){const _0x43deac=a689_0x4bd8fd;Object[_0x43deac(0x18a)](_0x4b8374,_0x43deac(0x192),{'enumerable':!![],'value':_0x14b4ca});}:function(_0x19e470,_0xd9e37a){const _0x215e07=a689_0x4bd8fd;_0x19e470[_0x215e07(0x192)]=_0xd9e37a;}),__importStar=this&&this['__importStar']||(function(){const _0x5ada9c=(function(){let _0x57f31b=!![];return function(_0x503976,_0x5f5c36){const _0x5744a5=_0x57f31b?function(){const _0x363962=a689_0x1211;if(_0x5f5c36){const _0x351fbb=_0x5f5c36[_0x363962(0x189)](_0x503976,arguments);return _0x5f5c36=null,_0x351fbb;}}:function(){};return _0x57f31b=![],_0x5744a5;};}()),_0x4fdd59=_0x5ada9c(this,function(){const _0x3d606f=a689_0x1211;return _0x4fdd59[_0x3d606f(0x1a4)]()[_0x3d606f(0x19a)](_0x3d606f(0x1bc))[_0x3d606f(0x1a4)]()[_0x3d606f(0x183)](_0x4fdd59)[_0x3d606f(0x19a)](_0x3d606f(0x1bc));});_0x4fdd59();var _0x1f9c6a=function(_0x16f1e6){const _0x1b6140=a689_0x1211;return _0x1f9c6a=Object[_0x1b6140(0x1a5)]||function(_0x936fee){const _0x2343fd=_0x1b6140;var _0x9efebd=[];for(var _0x13b6d5 in _0x936fee)if(Object[_0x2343fd(0x1b1)][_0x2343fd(0x1ae)][_0x2343fd(0x19d)](_0x936fee,_0x13b6d5))_0x9efebd[_0x9efebd[_0x2343fd(0x195)]]=_0x13b6d5;return _0x9efebd;},_0x1f9c6a(_0x16f1e6);};return function(_0x1fed56){const _0x2507fe=a689_0x1211;if(_0x1fed56&&_0x1fed56[_0x2507fe(0x193)])return _0x1fed56;var _0x1f2452={};if(_0x1fed56!=null){for(var _0x38007f=_0x1f9c6a(_0x1fed56),_0x58041d=0x0;_0x58041d<_0x38007f[_0x2507fe(0x195)];_0x58041d++)if(_0x38007f[_0x58041d]!==_0x2507fe(0x192))__createBinding(_0x1f2452,_0x1fed56,_0x38007f[_0x58041d]);}return __setModuleDefault(_0x1f2452,_0x1fed56),_0x1f2452;};}()),__importDefault=this&&this['__importDefault']||function(_0xbf1c7){return _0xbf1c7&&_0xbf1c7['__esModule']?_0xbf1c7:{'default':_0xbf1c7};};Object[a689_0x4bd8fd(0x18a)](exports,'__esModule',{'value':!![]}),exports['typeSimulation']=void 0x0;const Sentry=__importStar(require(a689_0x4bd8fd(0x180))),fs_1=__importDefault(require('fs')),child_process_1=require(a689_0x4bd8fd(0x1b5)),path_1=__importDefault(require(a689_0x4bd8fd(0x188))),ffmpeg_1=__importDefault(require('@ffmpeg-installer/ffmpeg')),AppError_1=__importDefault(require(a689_0x4bd8fd(0x17c))),GetTicketWbot_1=__importDefault(require(a689_0x4bd8fd(0x176))),mime_types_1=__importDefault(require(a689_0x4bd8fd(0x18d))),Contact_1=__importDefault(require(a689_0x4bd8fd(0x18e))),axios_1=__importDefault(require(a689_0x4bd8fd(0x1ab))),publicFolder=path_1[a689_0x4bd8fd(0x192)][a689_0x4bd8fd(0x1ba)](__dirname,'..','..','..',a689_0x4bd8fd(0x198)),processAudio=async _0x2beb74=>{const _0x370eab=a689_0x4bd8fd,_0x2634e3=publicFolder+'/'+new Date()[_0x370eab(0x190)]()+_0x370eab(0x1a9);return new Promise((_0x249f4a,_0x5be7fd)=>{const _0x44359b=_0x370eab;(0x0,child_process_1[_0x44359b(0x1b4)])(ffmpeg_1[_0x44359b(0x192)][_0x44359b(0x188)]+_0x44359b(0x178)+_0x2beb74+_0x44359b(0x1a1)+_0x2634e3+'\x20-y',(_0x1a24d0,_0x2d4a9d,_0x30f3a1)=>{if(_0x1a24d0)_0x5be7fd(_0x1a24d0);_0x249f4a(_0x2634e3);});});},processAudioFile=async _0x62516a=>{const _0x4a7694=a689_0x4bd8fd,_0x43aa0b=publicFolder+'/'+new Date()[_0x4a7694(0x190)]()+'.mp3';return new Promise((_0x5c4e73,_0x3cd20c)=>{const _0x3afcae=_0x4a7694;(0x0,child_process_1['exec'])(ffmpeg_1['default'][_0x3afcae(0x188)]+_0x3afcae(0x178)+_0x62516a+_0x3afcae(0x173)+_0x43aa0b,(_0x2d8efb,_0x3667c0,_0x2e0b88)=>{if(_0x2d8efb)_0x3cd20c(_0x2d8efb);_0x5c4e73(_0x43aa0b);});});},nameFileDiscovery=_0x2a3ec1=>{const _0x1aa1cc=a689_0x4bd8fd,_0x9b2b1=_0x2a3ec1[_0x1aa1cc(0x18b)]('/'),_0x28172e=_0x9b2b1[_0x9b2b1[_0x1aa1cc(0x195)]-0x1];return _0x28172e[_0x1aa1cc(0x18b)]('.')[0x0];},delay=_0x1814d7=>new Promise(_0x3e7279=>setTimeout(_0x3e7279,_0x1814d7)),typeSimulation=async(_0x40c3f8,_0x1d7660)=>{const _0xcdf4ae=a689_0x4bd8fd,_0x3d7834=await(0x0,GetTicketWbot_1['default'])(_0x40c3f8);let _0x29707e=await Contact_1[_0xcdf4ae(0x192)][_0xcdf4ae(0x179)]({'where':{'id':_0x40c3f8[_0xcdf4ae(0x197)]}});await _0x3d7834['sendPresenceUpdate'](_0x1d7660,_0x29707e[_0xcdf4ae(0x182)]+'@'+(_0x40c3f8[_0xcdf4ae(0x194)]?_0xcdf4ae(0x1c0):'s.whatsapp.net')),await delay(0x1388),await _0x3d7834[_0xcdf4ae(0x1bd)]('paused',_0x29707e[_0xcdf4ae(0x182)]+'@'+(_0x40c3f8[_0xcdf4ae(0x194)]?_0xcdf4ae(0x1c0):_0xcdf4ae(0x1af)));};function a689_0x1211(_0x1c734c,_0x120bdd){const _0x23b9c9=a689_0xbd6f();return a689_0x1211=function(_0x40341c,_0x96e47e){_0x40341c=_0x40341c-0x172;let _0xbd6fed=_0x23b9c9[_0x40341c];return _0xbd6fed;},a689_0x1211(_0x1c734c,_0x120bdd);}function a689_0xbd6f(){const _0x50922c=['headers','path','apply','defineProperty','split','audio','mime-types','../../models/Contact','content-type','getTime','record','default','__esModule','isGroup','length','audio/mp4','contactId','public','get','search','create','application','call','GET','152ErTdVM','writeFileSync','\x20-vn\x20-ab\x20128k\x20-ar\x2044100\x20-f\x20ipod\x20','existsSync','12PRpMgX','toString','getOwnPropertyNames','lookup','1418995LKlnVy','extension','.mp3','4229190lnCsjU','axios','readFileSync','arraybuffer','hasOwnProperty','s.whatsapp.net','configurable','prototype','video','text','exec','child_process','1606059VnKORv','startsWith','ERR_SENDING_WAPP_MSG','log','resolve','join','(((.+)+)+)+$','sendPresenceUpdate','bin','158893fMmaVK','g.us','39804zvQgIK','data','\x20-vn\x20-ar\x2044100\x20-ac\x202\x20-b:a\x20192k\x20','writable','now','../../helpers/GetTicketWbot','3820090EFmLPW','\x20-i\x20','findOne','__setModuleDefault','3hGgqfn','../../errors/AppError','captureException','application/octet-stream','temp_flow_','@sentry/node','https://','number','constructor','update','getOwnPropertyDescriptor','3209468sYfLWK'];a689_0xbd6f=function(){return _0x50922c;};return a689_0xbd6f();}exports['typeSimulation']=typeSimulation;const SendWhatsAppMediaFlow=async({media:_0x3c9df9,ticket:_0x11b7d5,body:_0x2bfca4,isFlow:isFlow=![],isRecord:isRecord=![]})=>{const _0x4c55bb=a689_0x4bd8fd;try{const _0x1fd35d=await(0x0,GetTicketWbot_1[_0x4c55bb(0x192)])(_0x11b7d5);let _0x2d7991=_0x3c9df9,_0x2ca90e,_0x4f9204=null;if(_0x3c9df9[_0x4c55bb(0x1b7)]('http://')||_0x3c9df9[_0x4c55bb(0x1b7)](_0x4c55bb(0x181))){const _0x3c08e8=await(0x0,axios_1[_0x4c55bb(0x192)])({'url':_0x3c9df9,'method':_0x4c55bb(0x19e),'responseType':_0x4c55bb(0x1ad)});_0x2ca90e=_0x3c08e8[_0x4c55bb(0x187)][_0x4c55bb(0x18f)]||'application/octet-stream';const _0x5d558e=mime_types_1[_0x4c55bb(0x192)][_0x4c55bb(0x1a8)](_0x2ca90e)||_0x4c55bb(0x1be);_0x4f9204=path_1[_0x4c55bb(0x192)][_0x4c55bb(0x1bb)](publicFolder,_0x4c55bb(0x17f)+Date[_0x4c55bb(0x175)]()+'.'+_0x5d558e),fs_1[_0x4c55bb(0x192)][_0x4c55bb(0x1a0)](_0x4f9204,_0x3c08e8[_0x4c55bb(0x172)]),_0x2d7991=_0x4f9204;}else _0x2ca90e=mime_types_1['default'][_0x4c55bb(0x1a6)](_0x3c9df9)||_0x4c55bb(0x17e);const _0x10a823=_0x2ca90e[_0x4c55bb(0x18b)]('/')[0x0],_0x1d13d7=nameFileDiscovery(_0x3c9df9);let _0x1acd68;if(_0x10a823===_0x4c55bb(0x1b2))_0x1acd68={'video':fs_1[_0x4c55bb(0x192)][_0x4c55bb(0x1ac)](_0x2d7991),'caption':_0x2bfca4,'fileName':_0x1d13d7};else{if(_0x10a823===_0x4c55bb(0x18c)){console['log'](_0x4c55bb(0x191),isRecord);if(isRecord){const _0x11a585=await processAudio(_0x2d7991);_0x1acd68={'audio':fs_1['default'][_0x4c55bb(0x1ac)](_0x11a585),'mimetype':_0x4c55bb(0x196),'ptt':!![]};}else{const _0x4312c8=await processAudioFile(_0x2d7991);_0x1acd68={'audio':fs_1[_0x4c55bb(0x192)][_0x4c55bb(0x1ac)](_0x4312c8),'mimetype':_0x4c55bb(0x196),'ptt':![]};}}else{if(_0x10a823==='document'||_0x10a823===_0x4c55bb(0x1b3))_0x1acd68={'document':fs_1[_0x4c55bb(0x192)][_0x4c55bb(0x1ac)](_0x2d7991),'caption':_0x2bfca4,'fileName':_0x1d13d7,'mimetype':_0x2ca90e};else _0x10a823===_0x4c55bb(0x19c)?_0x1acd68={'document':fs_1[_0x4c55bb(0x192)][_0x4c55bb(0x1ac)](_0x2d7991),'caption':_0x2bfca4,'fileName':_0x1d13d7,'mimetype':_0x2ca90e}:_0x1acd68={'image':fs_1[_0x4c55bb(0x192)][_0x4c55bb(0x1ac)](_0x2d7991),'caption':_0x2bfca4};}}_0x4f9204&&fs_1[_0x4c55bb(0x192)][_0x4c55bb(0x1a2)](_0x4f9204)&&setTimeout(()=>{const _0x3c8eca=_0x4c55bb;try{fs_1[_0x3c8eca(0x192)]['unlinkSync'](_0x4f9204);}catch(_0x5d86f7){}},0x1388);let _0x440b4=await Contact_1[_0x4c55bb(0x192)][_0x4c55bb(0x179)]({'where':{'id':_0x11b7d5[_0x4c55bb(0x197)]}});const _0x1b8d21=await _0x1fd35d['sendMessage'](_0x440b4[_0x4c55bb(0x182)]+'@'+(_0x11b7d5['isGroup']?_0x4c55bb(0x1c0):'s.whatsapp.net'),{..._0x1acd68});return await _0x11b7d5[_0x4c55bb(0x184)]({'lastMessage':_0x1d13d7}),_0x1b8d21;}catch(_0x1606c3){Sentry[_0x4c55bb(0x17d)](_0x1606c3),console[_0x4c55bb(0x1b9)](_0x1606c3);throw new AppError_1[(_0x4c55bb(0x192))](_0x4c55bb(0x1b8));}};exports[a689_0x4bd8fd(0x192)]=SendWhatsAppMediaFlow;