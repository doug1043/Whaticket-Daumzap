const a575_0x3687c0=a575_0x3cfc;function a575_0xa6f4(){const _0x50a124=['4nFruOv','apply','(((.+)+)+)+$','parse','51020ntCumc','message','constructor','145080OMPvnO','logger','error','234PIOBqL','../../models/Contact','21MnfZUg','toString','\x20-\x20','../ContactServices/CreateContactService','../../libs/wbot','Could\x20not\x20get\x20whatsapp\x20contacts\x20from\x20database.','isArray','default','1581359TUVmBc','status@broadcast','then','forEach','Could\x20not\x20get\x20whatsapp\x20contacts\x20from\x20database.\x20Err:\x20','whatsapp','1258970kmLfxO','22jOUtRk','78IvRBYT','Could\x20not\x20save\x20contact.\x20Err:\x20','warn','name','1175280yktEKV','49544NCnnFZ','defineProperty','search','g.us','getWbot','../../errors/AppError','contacts','36kiZKxK','__esModule','findOne','31171LSliNI','debug','replace','CONNECTED','save'];a575_0xa6f4=function(){return _0x50a124;};return a575_0xa6f4();}(function(_0x10c4f6,_0x2e061a){const _0x3946ef=a575_0x3cfc,_0xf7c7f2=_0x10c4f6();while(!![]){try{const _0x5ad206=parseInt(_0x3946ef(0x1a5))/0x1*(parseInt(_0x3946ef(0x1ac))/0x2)+parseInt(_0x3946ef(0x1b1))/0x3*(-parseInt(_0x3946ef(0x1a9))/0x4)+-parseInt(_0x3946ef(0x1c5))/0x5+parseInt(_0x3946ef(0x1c1))/0x6*(-parseInt(_0x3946ef(0x1a0))/0x7)+parseInt(_0x3946ef(0x1c6))/0x8*(parseInt(_0x3946ef(0x1af))/0x9)+-parseInt(_0x3946ef(0x1bf))/0xa*(parseInt(_0x3946ef(0x1c0))/0xb)+parseInt(_0x3946ef(0x1cd))/0xc*(parseInt(_0x3946ef(0x1b9))/0xd);if(_0x5ad206===_0x2e061a)break;else _0xf7c7f2['push'](_0xf7c7f2['shift']());}catch(_0x1a3b6c){_0xf7c7f2['push'](_0xf7c7f2['shift']());}}}(a575_0xa6f4,0x2c743));const a575_0x260f70=(function(){let _0x266f8d=!![];return function(_0x4869de,_0x1c8a0f){const _0x269d36=_0x266f8d?function(){const _0x23cb30=a575_0x3cfc;if(_0x1c8a0f){const _0x140d05=_0x1c8a0f[_0x23cb30(0x1a6)](_0x4869de,arguments);return _0x1c8a0f=null,_0x140d05;}}:function(){};return _0x266f8d=![],_0x269d36;};}()),a575_0x449410=a575_0x260f70(this,function(){const _0x513a4b=a575_0x3cfc;return a575_0x449410['toString']()[_0x513a4b(0x1c8)](_0x513a4b(0x1a7))[_0x513a4b(0x1b2)]()[_0x513a4b(0x1ab)](a575_0x449410)['search'](_0x513a4b(0x1a7));});a575_0x449410();'use strict';var __importDefault=this&&this['__importDefault']||function(_0x3e7819){return _0x3e7819&&_0x3e7819['__esModule']?_0x3e7819:{'default':_0x3e7819};};Object[a575_0x3687c0(0x1c7)](exports,a575_0x3687c0(0x19e),{'value':!![]});function a575_0x3cfc(_0x5084ad,_0xb49ff9){const _0x121fb6=a575_0xa6f4();return a575_0x3cfc=function(_0x449410,_0x260f70){_0x449410=_0x449410-0x19e;let _0xa6f4bd=_0x121fb6[_0x449410];return _0xa6f4bd;},a575_0x3cfc(_0x5084ad,_0xb49ff9);}const wbot_1=require(a575_0x3687c0(0x1b5)),Contact_1=__importDefault(require(a575_0x3687c0(0x1b0))),logger_1=require('../../utils/logger'),ShowBaileysService_1=__importDefault(require('../BaileysServices/ShowBaileysService')),CreateContactService_1=__importDefault(require(a575_0x3687c0(0x1b4))),AppError_1=__importDefault(require(a575_0x3687c0(0x1cb))),Whatsapp_1=__importDefault(require('../../models/Whatsapp')),ImportContactsService=async(_0x9d4e83,_0x4d4607)=>{const _0x3e8a41=a575_0x3687c0,_0x543a58=await Whatsapp_1[_0x3e8a41(0x1b8)][_0x3e8a41(0x19f)]({'where':{'id':_0x4d4607,'companyId':_0x9d4e83,'channel':_0x3e8a41(0x1be),'status':_0x3e8a41(0x1a3)}});if(!_0x543a58)throw new AppError_1[(_0x3e8a41(0x1b8))]('ERR_NO_WAPP_FOUND',0x194);const _0x3a3ed7=(0x0,wbot_1[_0x3e8a41(0x1ca)])(_0x543a58['id']),_0x479cb1=await(0x0,ShowBaileysService_1[_0x3e8a41(0x1b8)])(_0x3a3ed7['id']);let _0x109017=null;try{_0x109017=_0x479cb1['contacts']&&JSON[_0x3e8a41(0x1a8)](_0x479cb1[_0x3e8a41(0x1cc)]);}catch(_0x5df4d3){logger_1[_0x3e8a41(0x1ad)][_0x3e8a41(0x1c3)]({'baileys':_0x479cb1},_0x3e8a41(0x1bd)+_0x5df4d3);throw new AppError_1[(_0x3e8a41(0x1b8))](_0x3e8a41(0x1b6),0x1f4);}if(Array[_0x3e8a41(0x1b7)](_0x109017)){const _0x18231e=async _0x2f4635=>{const _0x2c8027=_0x3e8a41;_0x2f4635[_0x2c8027(0x1bc)](async({id:_0x54119c,name:_0x3e7cf8,notify:_0x4db20c})=>{const _0xebac31=_0x2c8027;if(_0x54119c===_0xebac31(0x1ba)||_0x54119c['includes'](_0xebac31(0x1c9)))return;const _0x4838e4=_0x54119c[_0xebac31(0x1a2)](/\D/g,''),_0x787242=await Contact_1[_0xebac31(0x1b8)][_0xebac31(0x19f)]({'where':{'number':_0x4838e4,'companyId':_0x9d4e83}});if(_0x787242)_0x787242[_0xebac31(0x1c4)]=_0x3e7cf8||_0x4db20c||_0x4838e4,await _0x787242[_0xebac31(0x1a4)]();else try{await(0x0,CreateContactService_1[_0xebac31(0x1b8)])({'number':_0x4838e4,'name':_0x3e7cf8||_0x4db20c||_0x4838e4,'companyId':_0x9d4e83});}catch(_0x2c2c12){logger_1[_0xebac31(0x1ad)][_0xebac31(0x1ae)]({'name':_0x3e7cf8,'number':_0x4838e4,'companyId':_0x9d4e83},_0xebac31(0x1c2)+_0x2c2c12);}});};_0x18231e(_0x109017)[_0x3e8a41(0x1bb)](()=>{const _0x222be2=_0x3e8a41;logger_1[_0x222be2(0x1ad)][_0x222be2(0x1a1)]('Contacts\x20imported\x20successfully\x20from\x20WhatsApp\x20for\x20company\x20ID:\x20'+_0x9d4e83);},_0xe14283=>{const _0x494c5f=_0x3e8a41;logger_1['logger'][_0x494c5f(0x1ae)]('Error\x20importing\x20contacts\x20from\x20WhatsApp\x20for\x20company\x20ID:\x20'+_0x9d4e83+_0x494c5f(0x1b3)+_0xe14283[_0x494c5f(0x1aa)]);});}};exports[a575_0x3687c0(0x1b8)]=ImportContactsService;