const a544_0x3b21bb=a544_0x554a;(function(_0xce8522,_0x1013bb){const _0x5d7368=a544_0x554a,_0x2158b2=_0xce8522();while(!![]){try{const _0x20e9d3=parseInt(_0x5d7368(0x142))/0x1*(-parseInt(_0x5d7368(0x133))/0x2)+parseInt(_0x5d7368(0x13a))/0x3+-parseInt(_0x5d7368(0x122))/0x4*(-parseInt(_0x5d7368(0x126))/0x5)+-parseInt(_0x5d7368(0x128))/0x6*(parseInt(_0x5d7368(0x12a))/0x7)+parseInt(_0x5d7368(0x12e))/0x8+-parseInt(_0x5d7368(0x14f))/0x9+parseInt(_0x5d7368(0x149))/0xa*(parseInt(_0x5d7368(0x13b))/0xb);if(_0x20e9d3===_0x1013bb)break;else _0x2158b2['push'](_0x2158b2['shift']());}catch(_0x3e4b17){_0x2158b2['push'](_0x2158b2['shift']());}}}(a544_0x2a4f,0x8c6bb));const a544_0x50fdda=(function(){let _0x304a1e=!![];return function(_0x306dec,_0x11bdb1){const _0x30139e=_0x304a1e?function(){if(_0x11bdb1){const _0x28cf6c=_0x11bdb1['apply'](_0x306dec,arguments);return _0x11bdb1=null,_0x28cf6c;}}:function(){};return _0x304a1e=![],_0x30139e;};}()),a544_0x2dbdaf=a544_0x50fdda(this,function(){const _0x331316=a544_0x554a;return a544_0x2dbdaf[_0x331316(0x132)]()[_0x331316(0x137)](_0x331316(0x13c))[_0x331316(0x132)]()[_0x331316(0x152)](a544_0x2dbdaf)[_0x331316(0x137)]('(((.+)+)+)+$');});a544_0x2dbdaf();'use strict';var __createBinding=this&&this['__createBinding']||(Object[a544_0x3b21bb(0x144)]?function(_0x1c7871,_0x164700,_0x3b356e,_0x272719){const _0x2d8ec2=a544_0x3b21bb;if(_0x272719===undefined)_0x272719=_0x3b356e;var _0x41eca4=Object[_0x2d8ec2(0x135)](_0x164700,_0x3b356e);(!_0x41eca4||('get'in _0x41eca4?!_0x164700[_0x2d8ec2(0x153)]:_0x41eca4[_0x2d8ec2(0x154)]||_0x41eca4[_0x2d8ec2(0x156)]))&&(_0x41eca4={'enumerable':!![],'get':function(){return _0x164700[_0x3b356e];}}),Object[_0x2d8ec2(0x14c)](_0x1c7871,_0x272719,_0x41eca4);}:function(_0x576063,_0x36b605,_0x27fb5b,_0x4f2b18){if(_0x4f2b18===undefined)_0x4f2b18=_0x27fb5b;_0x576063[_0x4f2b18]=_0x36b605[_0x27fb5b];}),__setModuleDefault=this&&this[a544_0x3b21bb(0x130)]||(Object[a544_0x3b21bb(0x144)]?function(_0x42d965,_0x5246bf){const _0x3662f4=a544_0x3b21bb;Object[_0x3662f4(0x14c)](_0x42d965,_0x3662f4(0x141),{'enumerable':!![],'value':_0x5246bf});}:function(_0x3ac0f5,_0x182917){const _0x46f456=a544_0x3b21bb;_0x3ac0f5[_0x46f456(0x141)]=_0x182917;}),__importStar=this&&this['__importStar']||function(_0x1b3d24){const _0x5e7bde=a544_0x3b21bb;if(_0x1b3d24&&_0x1b3d24[_0x5e7bde(0x153)])return _0x1b3d24;var _0x429693={};if(_0x1b3d24!=null){for(var _0x12bb78 in _0x1b3d24)if(_0x12bb78!=='default'&&Object[_0x5e7bde(0x123)][_0x5e7bde(0x140)][_0x5e7bde(0x11f)](_0x1b3d24,_0x12bb78))__createBinding(_0x429693,_0x1b3d24,_0x12bb78);}return __setModuleDefault(_0x429693,_0x1b3d24),_0x429693;},__importDefault=this&&this[a544_0x3b21bb(0x124)]||function(_0x2f9f4c){const _0x32e4eb=a544_0x3b21bb;return _0x2f9f4c&&_0x2f9f4c[_0x32e4eb(0x153)]?_0x2f9f4c:{'default':_0x2f9f4c};};function a544_0x554a(_0x1d3eb6,_0x34337c){const _0x5ef0ce=a544_0x2a4f();return a544_0x554a=function(_0x2dbdaf,_0x50fdda){_0x2dbdaf=_0x2dbdaf-0x11d;let _0x2a4fc5=_0x5ef0ce[_0x2dbdaf];return _0x2a4fc5;},a544_0x554a(_0x1d3eb6,_0x34337c);}function a544_0x2a4f(){const _0x223d05=['7312068wcJdJf','isArray','name','constructor','__esModule','writable','captureException','configurable','writeFile','error','call','../ContactServices/CreateContactService','findOne','3084016zsyzRU','prototype','__importDefault','stringify','5CEPmED','../../utils/logger','6YtIYuc','warn','1608796vknupY','replace','Could\x20not\x20get\x20whatsapp\x20contacts\x20from\x20phone.\x20Err:\x20','join','6654664DWqpSv','save','__setModuleDefault','parse','toString','6vblJDo','companyId','getOwnPropertyDescriptor','lodash','search','includes','resolve','1668987JHyOnc','23518brLlQE','(((.+)+)+)+$','isString','company','contatos_depois.txt','hasOwnProperty','default','213357NCTlaX','contacts','create','contatos_antes.txt','g.us','public','@sentry/node','460zwHbYk','Failed\x20to\x20write\x20contacts\x20to\x20file:\x20','path','defineProperty','getWbot','../../libs/wbot'];a544_0x2a4f=function(){return _0x223d05;};return a544_0x2a4f();}Object[a544_0x3b21bb(0x14c)](exports,a544_0x3b21bb(0x153),{'value':!![]});const Sentry=__importStar(require(a544_0x3b21bb(0x148))),GetDefaultWhatsApp_1=__importDefault(require('../../helpers/GetDefaultWhatsApp')),wbot_1=require(a544_0x3b21bb(0x14e)),Contact_1=__importDefault(require('../../models/Contact')),logger_1=require(a544_0x3b21bb(0x127)),ShowBaileysService_1=__importDefault(require('../BaileysServices/ShowBaileysService')),CreateContactService_1=__importDefault(require(a544_0x3b21bb(0x120))),lodash_1=require(a544_0x3b21bb(0x136)),path_1=__importDefault(require(a544_0x3b21bb(0x14b))),fs_1=__importDefault(require('fs')),ImportContactsService=async _0x378c58=>{const _0x40281f=a544_0x3b21bb,_0x529cfe=await(0x0,GetDefaultWhatsApp_1[_0x40281f(0x141)])(_0x378c58),_0x3f8478=(0x0,wbot_1[_0x40281f(0x14d)])(_0x529cfe['id']);let _0x2b0cc6;try{const _0x3aa289=await(0x0,ShowBaileysService_1[_0x40281f(0x141)])(_0x3f8478['id']);_0x2b0cc6=JSON[_0x40281f(0x131)](_0x3aa289[_0x40281f(0x143)]);const _0x2e77b9=path_1[_0x40281f(0x141)][_0x40281f(0x139)](__dirname,'..','..','..',_0x40281f(0x147),'company'+_0x529cfe[_0x40281f(0x134)]),_0x402cb0=path_1[_0x40281f(0x141)][_0x40281f(0x12d)](_0x2e77b9,_0x40281f(0x145));fs_1['default'][_0x40281f(0x11d)](_0x402cb0,JSON[_0x40281f(0x125)](_0x2b0cc6,null,0x2),_0x18b489=>{if(_0x18b489){logger_1['logger']['error']('Failed\x20to\x20write\x20contacts\x20to\x20file:\x20'+_0x18b489);throw _0x18b489;}});}catch(_0x2785fe){Sentry[_0x40281f(0x155)](_0x2785fe),logger_1['logger'][_0x40281f(0x11e)]('Could\x20not\x20get\x20whatsapp\x20contacts\x20from\x20phone.\x20Err:\x20'+_0x2785fe);}const _0x126017=path_1[_0x40281f(0x141)][_0x40281f(0x139)](__dirname,'..','..','..','public',_0x40281f(0x13e)+_0x529cfe[_0x40281f(0x134)]),_0x2f4c3e=path_1['default'][_0x40281f(0x12d)](_0x126017,_0x40281f(0x13f));fs_1['default']['writeFile'](_0x2f4c3e,JSON['stringify'](_0x2b0cc6,null,0x2),_0x617e1c=>{const _0x1532aa=_0x40281f;if(_0x617e1c){logger_1['logger'][_0x1532aa(0x11e)](_0x1532aa(0x14a)+_0x617e1c);throw _0x617e1c;}});const _0x1a3ee4=(0x0,lodash_1[_0x40281f(0x13d)])(_0x2b0cc6)?JSON['parse'](_0x2b0cc6):_0x2b0cc6;if((0x0,lodash_1[_0x40281f(0x150)])(_0x1a3ee4))for(const {id:_0x54685c,name:_0x409d7b,notify:_0x1e809b}of _0x1a3ee4){if(_0x54685c==='status@broadcast'||_0x54685c[_0x40281f(0x138)](_0x40281f(0x146)))continue;const _0x2b33f5=_0x54685c[_0x40281f(0x12b)](/\D/g,''),_0x39b448=await Contact_1[_0x40281f(0x141)][_0x40281f(0x121)]({'where':{'number':_0x2b33f5,'companyId':_0x378c58}});if(_0x39b448)_0x39b448[_0x40281f(0x151)]=_0x409d7b||_0x1e809b,await _0x39b448[_0x40281f(0x12f)]();else try{await(0x0,CreateContactService_1[_0x40281f(0x141)])({'number':_0x2b33f5,'name':_0x409d7b||_0x1e809b,'companyId':_0x378c58});}catch(_0x32bfc6){Sentry[_0x40281f(0x155)](_0x32bfc6),logger_1['logger'][_0x40281f(0x129)](_0x40281f(0x12c)+_0x32bfc6);}}};exports[a544_0x3b21bb(0x141)]=ImportContactsService;