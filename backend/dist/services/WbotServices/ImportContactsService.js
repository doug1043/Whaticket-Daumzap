const a687_0x21172f=a687_0x51f8;(function(_0x3bd6ed,_0x2ab333){const _0x416e69=a687_0x51f8,_0x10becd=_0x3bd6ed();while(!![]){try{const _0x4e8c9d=parseInt(_0x416e69(0x17e))/0x1+-parseInt(_0x416e69(0x165))/0x2*(-parseInt(_0x416e69(0x182))/0x3)+-parseInt(_0x416e69(0x15d))/0x4+-parseInt(_0x416e69(0x16e))/0x5*(-parseInt(_0x416e69(0x16d))/0x6)+parseInt(_0x416e69(0x173))/0x7+parseInt(_0x416e69(0x177))/0x8*(parseInt(_0x416e69(0x17a))/0x9)+-parseInt(_0x416e69(0x15f))/0xa*(parseInt(_0x416e69(0x164))/0xb);if(_0x4e8c9d===_0x2ab333)break;else _0x10becd['push'](_0x10becd['shift']());}catch(_0x4d048c){_0x10becd['push'](_0x10becd['shift']());}}}(a687_0x4554,0x9e03a));function a687_0x4554(){const _0xb61154=['message','replace','parse','2214674EBmPiA','(((.+)+)+)+$','findOne','logger','646136oezkpX','toString','save','72zvuUIm','Error\x20importing\x20contacts\x20from\x20WhatsApp\x20for\x20company\x20ID:\x20','Could\x20not\x20save\x20contact.\x20Err:\x20','error','1257373yXxdMz','../../libs/wbot','Could\x20not\x20get\x20whatsapp\x20contacts\x20from\x20database.','default','2665989xSJgHt','Could\x20not\x20get\x20whatsapp\x20contacts\x20from\x20database.\x20Err:\x20','warn','g.us','CONNECTED','4558308hJkrZu','includes','22390HwhQIW','../../errors/AppError','__importDefault','apply','../../models/Whatsapp','9097SwYywZ','2yiZTqd','isArray','contacts','search','status@broadcast','\x20-\x20','__esModule','getWbot','18aklaTM','883170vBCuAJ','defineProperty'];a687_0x4554=function(){return _0xb61154;};return a687_0x4554();}const a687_0x1a33c7=(function(){let _0x1a3c36=!![];return function(_0x17ee0e,_0xe48c01){const _0x40df36=_0x1a3c36?function(){const _0x1494c8=a687_0x51f8;if(_0xe48c01){const _0x59cd49=_0xe48c01[_0x1494c8(0x162)](_0x17ee0e,arguments);return _0xe48c01=null,_0x59cd49;}}:function(){};return _0x1a3c36=![],_0x40df36;};}()),a687_0x484387=a687_0x1a33c7(this,function(){const _0x5cab30=a687_0x51f8;return a687_0x484387[_0x5cab30(0x178)]()[_0x5cab30(0x168)](_0x5cab30(0x174))[_0x5cab30(0x178)]()['constructor'](a687_0x484387)[_0x5cab30(0x168)](_0x5cab30(0x174));});a687_0x484387();function a687_0x51f8(_0x5a9687,_0x2d2b15){const _0x1eb50c=a687_0x4554();return a687_0x51f8=function(_0x484387,_0x1a33c7){_0x484387=_0x484387-0x159;let _0x4554a8=_0x1eb50c[_0x484387];return _0x4554a8;},a687_0x51f8(_0x5a9687,_0x2d2b15);}'use strict';var __importDefault=this&&this[a687_0x21172f(0x161)]||function(_0x21d3b4){const _0x10e774=a687_0x21172f;return _0x21d3b4&&_0x21d3b4[_0x10e774(0x16b)]?_0x21d3b4:{'default':_0x21d3b4};};Object[a687_0x21172f(0x16f)](exports,'__esModule',{'value':!![]});const wbot_1=require(a687_0x21172f(0x17f)),Contact_1=__importDefault(require('../../models/Contact')),logger_1=require('../../utils/logger'),ShowBaileysService_1=__importDefault(require('../BaileysServices/ShowBaileysService')),CreateContactService_1=__importDefault(require('../ContactServices/CreateContactService')),AppError_1=__importDefault(require(a687_0x21172f(0x160))),Whatsapp_1=__importDefault(require(a687_0x21172f(0x163))),ImportContactsService=async(_0x4cc3c7,_0x1daded)=>{const _0x354990=a687_0x21172f,_0x2c01de=await Whatsapp_1['default'][_0x354990(0x175)]({'where':{'id':_0x1daded,'companyId':_0x4cc3c7,'channel':'whatsapp','status':_0x354990(0x15c)}});if(!_0x2c01de)throw new AppError_1['default']('ERR_NO_WAPP_FOUND',0x194);const _0x32fe89=(0x0,wbot_1[_0x354990(0x16c)])(_0x2c01de['id']),_0x1aa9fd=await(0x0,ShowBaileysService_1[_0x354990(0x181)])(_0x32fe89['id']);let _0x13443a=null;try{_0x13443a=_0x1aa9fd[_0x354990(0x167)]&&JSON[_0x354990(0x172)](_0x1aa9fd[_0x354990(0x167)]);}catch(_0x2a0c7e){logger_1[_0x354990(0x176)][_0x354990(0x15a)]({'baileys':_0x1aa9fd},_0x354990(0x159)+_0x2a0c7e);throw new AppError_1[(_0x354990(0x181))](_0x354990(0x180),0x1f4);}if(Array[_0x354990(0x166)](_0x13443a)){const _0x1592f3=async _0x5e3c4b=>{_0x5e3c4b['forEach'](async({id:_0x3a18a9,name:_0x5a2a1d,notify:_0x587b35})=>{const _0xcd2bb8=a687_0x51f8;if(_0x3a18a9===_0xcd2bb8(0x169)||_0x3a18a9[_0xcd2bb8(0x15e)](_0xcd2bb8(0x15b)))return;const _0x4f6641=_0x3a18a9[_0xcd2bb8(0x171)](/\D/g,''),_0x5a4ba5=await Contact_1[_0xcd2bb8(0x181)][_0xcd2bb8(0x175)]({'where':{'number':_0x4f6641,'companyId':_0x4cc3c7}});if(_0x5a4ba5)_0x5a4ba5['name']=_0x5a2a1d||_0x587b35||_0x4f6641,await _0x5a4ba5[_0xcd2bb8(0x179)]();else try{await(0x0,CreateContactService_1[_0xcd2bb8(0x181)])({'number':_0x4f6641,'name':_0x5a2a1d||_0x587b35||_0x4f6641,'companyId':_0x4cc3c7});}catch(_0x1691c6){logger_1['logger']['error']({'name':_0x5a2a1d,'number':_0x4f6641,'companyId':_0x4cc3c7},_0xcd2bb8(0x17c)+_0x1691c6);}});};_0x1592f3(_0x13443a)['then'](()=>{const _0x420e5c=_0x354990;logger_1[_0x420e5c(0x176)]['debug']('Contacts\x20imported\x20successfully\x20from\x20WhatsApp\x20for\x20company\x20ID:\x20'+_0x4cc3c7);},_0x320e60=>{const _0x3f60d7=_0x354990;logger_1[_0x3f60d7(0x176)][_0x3f60d7(0x17d)](_0x3f60d7(0x17b)+_0x4cc3c7+_0x3f60d7(0x16a)+_0x320e60[_0x3f60d7(0x170)]);});}};exports['default']=ImportContactsService;