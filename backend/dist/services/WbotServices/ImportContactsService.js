const a546_0x1a32ce=a546_0x41c9;function a546_0x105b(){const _0x1bd2ff=['lodash','42ACmjju','hasOwnProperty','isString','60gNPYyk','899970ZLstkt','contatos_antes.txt','__importStar','2waFbZU','2608762kqxKhA','47036arEfBs','toString','resolve','41459hivQYz','1399776szDgrL','logger','parse','warn','stringify','path','(((.+)+)+)+$','companyId','Failed\x20to\x20write\x20contacts\x20to\x20file:\x20','public','replace','defineProperty','configurable','default','prototype','Could\x20not\x20get\x20whatsapp\x20contacts\x20from\x20phone.\x20Err:\x20','7AqZCZa','getOwnPropertyDescriptor','__esModule','includes','company','contacts','../../libs/wbot','1170PALejV','1202922GuCNbi','../BaileysServices/ShowBaileysService','call','@sentry/node','../../models/Contact','isArray','join','name','__setModuleDefault','captureException','get','save','writable','__importDefault','search','findOne','error','9JDiMvX','writeFile','489290KvDSQo'];a546_0x105b=function(){return _0x1bd2ff;};return a546_0x105b();}function a546_0x41c9(_0xce5c0a,_0x1d069a){const _0x12678b=a546_0x105b();return a546_0x41c9=function(_0x405c7e,_0x45dba1){_0x405c7e=_0x405c7e-0x7a;let _0x105b16=_0x12678b[_0x405c7e];return _0x105b16;},a546_0x41c9(_0xce5c0a,_0x1d069a);}(function(_0x1fbb99,_0x43ccd5){const _0xd123d=a546_0x41c9,_0x57ab0b=_0x1fbb99();while(!![]){try{const _0x52eecb=parseInt(_0xd123d(0x9c))/0x1*(parseInt(_0xd123d(0xa5))/0x2)+-parseInt(_0xd123d(0x9e))/0x3*(-parseInt(_0xd123d(0xa7))/0x4)+-parseInt(_0xd123d(0xa2))/0x5+-parseInt(_0xd123d(0x89))/0x6*(-parseInt(_0xd123d(0x81))/0x7)+-parseInt(_0xd123d(0xab))/0x8*(-parseInt(_0xd123d(0x9a))/0x9)+-parseInt(_0xd123d(0x88))/0xa*(-parseInt(_0xd123d(0xaa))/0xb)+parseInt(_0xd123d(0xa1))/0xc*(-parseInt(_0xd123d(0xa6))/0xd);if(_0x52eecb===_0x43ccd5)break;else _0x57ab0b['push'](_0x57ab0b['shift']());}catch(_0x211009){_0x57ab0b['push'](_0x57ab0b['shift']());}}}(a546_0x105b,0x46108));const a546_0x45dba1=(function(){let _0x1af8d2=!![];return function(_0x2ef7df,_0x148851){const _0x2a6786=_0x1af8d2?function(){if(_0x148851){const _0x3e94db=_0x148851['apply'](_0x2ef7df,arguments);return _0x148851=null,_0x3e94db;}}:function(){};return _0x1af8d2=![],_0x2a6786;};}()),a546_0x405c7e=a546_0x45dba1(this,function(){const _0x3fec92=a546_0x41c9;return a546_0x405c7e[_0x3fec92(0xa8)]()[_0x3fec92(0x97)](_0x3fec92(0xb1))[_0x3fec92(0xa8)]()['constructor'](a546_0x405c7e)[_0x3fec92(0x97)](_0x3fec92(0xb1));});a546_0x405c7e();'use strict';var __createBinding=this&&this['__createBinding']||(Object['create']?function(_0x15c697,_0x294ff9,_0x1efa04,_0x347681){const _0x80f5d3=a546_0x41c9;if(_0x347681===undefined)_0x347681=_0x1efa04;var _0x31332f=Object[_0x80f5d3(0x82)](_0x294ff9,_0x1efa04);(!_0x31332f||(_0x80f5d3(0x93)in _0x31332f?!_0x294ff9[_0x80f5d3(0x83)]:_0x31332f[_0x80f5d3(0x95)]||_0x31332f[_0x80f5d3(0x7d)]))&&(_0x31332f={'enumerable':!![],'get':function(){return _0x294ff9[_0x1efa04];}}),Object[_0x80f5d3(0x7c)](_0x15c697,_0x347681,_0x31332f);}:function(_0x389265,_0x28e197,_0xa9e898,_0x90e6c8){if(_0x90e6c8===undefined)_0x90e6c8=_0xa9e898;_0x389265[_0x90e6c8]=_0x28e197[_0xa9e898];}),__setModuleDefault=this&&this[a546_0x1a32ce(0x91)]||(Object['create']?function(_0x282b79,_0x45b584){const _0x2c7ac1=a546_0x1a32ce;Object[_0x2c7ac1(0x7c)](_0x282b79,'default',{'enumerable':!![],'value':_0x45b584});}:function(_0x1cad8f,_0x34b87b){_0x1cad8f['default']=_0x34b87b;}),__importStar=this&&this[a546_0x1a32ce(0xa4)]||function(_0x2a8c77){const _0x2a49e4=a546_0x1a32ce;if(_0x2a8c77&&_0x2a8c77['__esModule'])return _0x2a8c77;var _0x752c30={};if(_0x2a8c77!=null){for(var _0x5c2e5b in _0x2a8c77)if(_0x5c2e5b!=='default'&&Object[_0x2a49e4(0x7f)][_0x2a49e4(0x9f)][_0x2a49e4(0x8b)](_0x2a8c77,_0x5c2e5b))__createBinding(_0x752c30,_0x2a8c77,_0x5c2e5b);}return __setModuleDefault(_0x752c30,_0x2a8c77),_0x752c30;},__importDefault=this&&this[a546_0x1a32ce(0x96)]||function(_0x290ec0){const _0x19eb82=a546_0x1a32ce;return _0x290ec0&&_0x290ec0[_0x19eb82(0x83)]?_0x290ec0:{'default':_0x290ec0};};Object[a546_0x1a32ce(0x7c)](exports,a546_0x1a32ce(0x83),{'value':!![]});const Sentry=__importStar(require(a546_0x1a32ce(0x8c))),GetDefaultWhatsApp_1=__importDefault(require('../../helpers/GetDefaultWhatsApp')),wbot_1=require(a546_0x1a32ce(0x87)),Contact_1=__importDefault(require(a546_0x1a32ce(0x8d))),logger_1=require('../../utils/logger'),ShowBaileysService_1=__importDefault(require(a546_0x1a32ce(0x8a))),CreateContactService_1=__importDefault(require('../ContactServices/CreateContactService')),lodash_1=require(a546_0x1a32ce(0x9d)),path_1=__importDefault(require(a546_0x1a32ce(0xb0))),fs_1=__importDefault(require('fs')),ImportContactsService=async _0x28a676=>{const _0x4d46e0=a546_0x1a32ce,_0x46f676=await(0x0,GetDefaultWhatsApp_1[_0x4d46e0(0x7e)])(_0x28a676),_0x296486=(0x0,wbot_1['getWbot'])(_0x46f676['id']);let _0x3cd793;try{const _0x338fa3=await(0x0,ShowBaileysService_1['default'])(_0x296486['id']);_0x3cd793=JSON[_0x4d46e0(0xad)](_0x338fa3[_0x4d46e0(0x86)]);const _0x1273c4=path_1[_0x4d46e0(0x7e)][_0x4d46e0(0xa9)](__dirname,'..','..','..',_0x4d46e0(0x7a),_0x4d46e0(0x85)+_0x46f676[_0x4d46e0(0xb2)]),_0x16786d=path_1['default'][_0x4d46e0(0x8f)](_0x1273c4,_0x4d46e0(0xa3));fs_1[_0x4d46e0(0x7e)][_0x4d46e0(0x9b)](_0x16786d,JSON[_0x4d46e0(0xaf)](_0x3cd793,null,0x2),_0x13db52=>{const _0x62fd5a=_0x4d46e0;if(_0x13db52){logger_1[_0x62fd5a(0xac)][_0x62fd5a(0x99)](_0x62fd5a(0xb3)+_0x13db52);throw _0x13db52;}});}catch(_0x4d7fb3){Sentry['captureException'](_0x4d7fb3),logger_1[_0x4d46e0(0xac)]['error']('Could\x20not\x20get\x20whatsapp\x20contacts\x20from\x20phone.\x20Err:\x20'+_0x4d7fb3);}const _0x21afc3=path_1[_0x4d46e0(0x7e)]['resolve'](__dirname,'..','..','..',_0x4d46e0(0x7a),_0x4d46e0(0x85)+_0x46f676[_0x4d46e0(0xb2)]),_0x414c95=path_1[_0x4d46e0(0x7e)][_0x4d46e0(0x8f)](_0x21afc3,'contatos_depois.txt');fs_1[_0x4d46e0(0x7e)][_0x4d46e0(0x9b)](_0x414c95,JSON[_0x4d46e0(0xaf)](_0x3cd793,null,0x2),_0x59bc82=>{const _0x38205d=_0x4d46e0;if(_0x59bc82){logger_1[_0x38205d(0xac)][_0x38205d(0x99)](_0x38205d(0xb3)+_0x59bc82);throw _0x59bc82;}});const _0x22b78a=(0x0,lodash_1[_0x4d46e0(0xa0)])(_0x3cd793)?JSON[_0x4d46e0(0xad)](_0x3cd793):_0x3cd793;if((0x0,lodash_1[_0x4d46e0(0x8e)])(_0x22b78a))for(const {id:_0x1b0ace,name:_0x1aade5,notify:_0x37eac8}of _0x22b78a){if(_0x1b0ace==='status@broadcast'||_0x1b0ace[_0x4d46e0(0x84)]('g.us'))continue;const _0x3bd01c=_0x1b0ace[_0x4d46e0(0x7b)](/\D/g,''),_0x3e2f86=await Contact_1[_0x4d46e0(0x7e)][_0x4d46e0(0x98)]({'where':{'number':_0x3bd01c,'companyId':_0x28a676}});if(_0x3e2f86)_0x3e2f86[_0x4d46e0(0x90)]=_0x1aade5||_0x37eac8,await _0x3e2f86[_0x4d46e0(0x94)]();else try{await(0x0,CreateContactService_1[_0x4d46e0(0x7e)])({'number':_0x3bd01c,'name':_0x1aade5||_0x37eac8,'companyId':_0x28a676});}catch(_0x1d65bd){Sentry[_0x4d46e0(0x92)](_0x1d65bd),logger_1[_0x4d46e0(0xac)][_0x4d46e0(0xae)](_0x4d46e0(0x80)+_0x1d65bd);}}};exports[a546_0x1a32ce(0x7e)]=ImportContactsService;