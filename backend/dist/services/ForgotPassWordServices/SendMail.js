const a567_0x59d7d0=a567_0xfe4f;function a567_0xfe4f(_0x20b8f8,_0x194f25){const _0x3c3d79=a567_0x8199();return a567_0xfe4f=function(_0x14ca91,_0x4c0e5b){_0x14ca91=_0x14ca91-0x7d;let _0x8199df=_0x3c3d79[_0x14ca91];return _0x8199df;},a567_0xfe4f(_0x20b8f8,_0x194f25);}(function(_0x434083,_0x13ecd8){const _0x4219d3=a567_0xfe4f,_0x50a33d=_0x434083();while(!![]){try{const _0x27b750=-parseInt(_0x4219d3(0xa0))/0x1+parseInt(_0x4219d3(0x7e))/0x2*(-parseInt(_0x4219d3(0x94))/0x3)+parseInt(_0x4219d3(0x90))/0x4+parseInt(_0x4219d3(0x97))/0x5*(-parseInt(_0x4219d3(0x9f))/0x6)+parseInt(_0x4219d3(0x95))/0x7*(parseInt(_0x4219d3(0xa4))/0x8)+-parseInt(_0x4219d3(0x99))/0x9*(-parseInt(_0x4219d3(0x7f))/0xa)+-parseInt(_0x4219d3(0x87))/0xb;if(_0x27b750===_0x13ecd8)break;else _0x50a33d['push'](_0x50a33d['shift']());}catch(_0x3069fa){_0x50a33d['push'](_0x50a33d['shift']());}}}(a567_0x8199,0xa6323));const a567_0x4c0e5b=(function(){let _0xc0810=!![];return function(_0x220ce9,_0x27c154){const _0x4597d8=_0xc0810?function(){if(_0x27c154){const _0x1265c4=_0x27c154['apply'](_0x220ce9,arguments);return _0x27c154=null,_0x1265c4;}}:function(){};return _0xc0810=![],_0x4597d8;};}()),a567_0x14ca91=a567_0x4c0e5b(this,function(){const _0xdd96c2=a567_0xfe4f;return a567_0x14ca91[_0xdd96c2(0x8c)]()['search'](_0xdd96c2(0x83))['toString']()[_0xdd96c2(0x92)](a567_0x14ca91)[_0xdd96c2(0x81)](_0xdd96c2(0x83));});a567_0x14ca91();function a567_0x8199(){const _0x528bb6=['1970935nnxaqA','default','795852qGSDMN','clientsecretsmtpauth','smtpauth','\x27\x20WHERE\x20email\x20=\x27','__esModule','all','6AiADoi','419032eRIuGb','length','UPDATE\x20\x22Users\x22\x20SET\x20\x22resetPassword\x22=\x20\x27','Erro\x20interno\x20do\x20servidor','396952llvBQu','defineProperty','smtpport','createTransport','2yfQQLi','100SOvMMM','sendMail','search','\x0a\x0aPor\x20favor,\x20copie\x20e\x20cole\x20o\x20Código\x20de\x20Verificação\x20no\x20campo\x20\x27Código\x20de\x20Verificação\x27.\x0a\x0aSe\x20você\x20não\x20solicitou\x20esta\x20redefinição\x20de\x20senha,\x20por\x20favor,\x20ignore\x20este\x20e-mail.\x0a\x0a\x0aAtenciosamente','(((.+)+)+)+$','__importDefault','Não\x20foi\x20possível\x20inserir\x20o\x20token\x20de\x20redefinição','sequelize','3482028jHSGEt','value','../../models/Setting','nodemailer','../../database','toString','companyId','QueryTypes','error','1706640RlkKoB','findOne','constructor','query','1925013hgiiRd','161WWlcZI','UPDATE'];a567_0x8199=function(){return _0x528bb6;};return a567_0x8199();}'use strict';var __importDefault=this&&this[a567_0x59d7d0(0x84)]||function(_0x35cce7){const _0x1102ed=a567_0x59d7d0;return _0x35cce7&&_0x35cce7[_0x1102ed(0x9d)]?_0x35cce7:{'default':_0x35cce7};};Object[a567_0x59d7d0(0xa5)](exports,a567_0x59d7d0(0x9d),{'value':!![]});const nodemailer_1=__importDefault(require(a567_0x59d7d0(0x8a))),sequelize_1=__importDefault(require(a567_0x59d7d0(0x86))),database_1=__importDefault(require(a567_0x59d7d0(0x8b))),Setting_1=__importDefault(require(a567_0x59d7d0(0x89))),SendMail=async(_0x3fa2c1,_0xbf813f)=>{const _0x76dcd=a567_0x59d7d0;try{const _0x32f84f=0x1,{hasResult:_0x324c55,data:_0xc79edb}=await filterEmail(_0x3fa2c1);if(!_0x324c55)return{'status':0x194,'message':'Email\x20não\x20encontrado'};const _0x4c4837=_0xc79edb[0x0];if(!_0x4c4837||_0x4c4837[_0x76dcd(0x8d)]===undefined)return{'status':0x194,'message':'Dados\x20do\x20usuário\x20não\x20encontrados'};const [_0x4e5262,_0x2edfba,_0x3a0126,_0x23d4e5]=await Promise[_0x76dcd(0x9e)]([Setting_1['default'][_0x76dcd(0x91)]({'where':{'companyId':_0x32f84f,'key':_0x76dcd(0x9b)}}),Setting_1['default'][_0x76dcd(0x91)]({'where':{'companyId':_0x32f84f,'key':'usersmtpauth'}}),Setting_1[_0x76dcd(0x98)][_0x76dcd(0x91)]({'where':{'companyId':_0x32f84f,'key':_0x76dcd(0x9a)}}),Setting_1[_0x76dcd(0x98)]['findOne']({'where':{'companyId':_0x32f84f,'key':_0x76dcd(0xa6)}})]),_0x2c508a=_0x4e5262?.[_0x76dcd(0x88)],_0x1a38ca=_0x2edfba?.[_0x76dcd(0x88)],_0x5dc057=_0x3a0126?.[_0x76dcd(0x88)],_0x18c16e=_0x1a38ca,_0x10166e=_0x23d4e5?.[_0x76dcd(0x88)];if(!_0x2c508a||!_0x1a38ca||!_0x5dc057||!_0x10166e)throw new Error('Configurações\x20SMTP\x20estão\x20incompletas');const _0x4a11c0=nodemailer_1[_0x76dcd(0x98)][_0x76dcd(0x7d)]({'host':_0x2c508a,'port':Number(_0x10166e),'secure':![],'auth':{'user':_0x1a38ca,'pass':_0x5dc057}}),{hasResults:_0x3ea742}=await insertToken(_0x3fa2c1,_0xbf813f);if(!_0x3ea742)return{'status':0x194,'message':_0x76dcd(0x85)};const _0x2de3b6={'from':_0x18c16e,'to':_0x3fa2c1,'subject':'Redefinição\x20de\x20Senha','text':'Olá,\x0a\x0aVocê\x20solicitou\x20a\x20redefinição\x20de\x20senha\x20para\x20sua\x20conta,\x20utilize\x20o\x20seguinte\x20Código\x20de\x20Verificação\x20para\x20concluir\x20o\x20processo\x20de\x20redefinição\x20de\x20senha:\x0a\x0aCódigo\x20de\x20Verificação:\x20'+_0xbf813f+_0x76dcd(0x82)},_0x86cd9f=await _0x4a11c0[_0x76dcd(0x80)](_0x2de3b6);return{'status':0xc8,'message':'E-mail\x20enviado\x20com\x20sucesso','info':_0x86cd9f};}catch(_0x2616ee){return console[_0x76dcd(0x8f)]('Erro\x20ao\x20enviar\x20e-mail:',_0x2616ee),{'status':0x1f4,'message':_0x76dcd(0xa3)};}},filterEmail=async _0x99f1f7=>{const _0x5524ef=a567_0x59d7d0,_0x163eaa='SELECT\x20*\x20FROM\x20\x22Users\x22\x20WHERE\x20email\x20=\x27'+_0x99f1f7+'\x27',_0x510e79=await database_1[_0x5524ef(0x98)][_0x5524ef(0x93)](_0x163eaa,{'type':sequelize_1['default'][_0x5524ef(0x8e)]['SELECT']});return{'hasResult':_0x510e79[_0x5524ef(0xa1)]>0x0,'data':_0x510e79};},insertToken=async(_0x58f0b1,_0x4dc96e)=>{const _0xa4e228=a567_0x59d7d0,_0x4257b4=_0xa4e228(0xa2)+_0x4dc96e+_0xa4e228(0x9c)+_0x58f0b1+'\x27',_0x3e85f4=await database_1[_0xa4e228(0x98)][_0xa4e228(0x93)](_0x4257b4,{'type':sequelize_1['default'][_0xa4e228(0x8e)][_0xa4e228(0x96)]});return{'hasResults':_0x3e85f4[0x1]>0x0,'datas':_0x3e85f4};};exports[a567_0x59d7d0(0x98)]=SendMail;