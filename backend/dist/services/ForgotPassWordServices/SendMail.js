const a433_0x1fe5c0=a433_0x252b;(function(_0x5ddf42,_0x82d1a2){const _0x55cef6=a433_0x252b,_0x4586a0=_0x5ddf42();while(!![]){try{const _0xa43f03=parseInt(_0x55cef6(0x1f9))/0x1+-parseInt(_0x55cef6(0x1e5))/0x2+parseInt(_0x55cef6(0x1db))/0x3*(parseInt(_0x55cef6(0x1e7))/0x4)+parseInt(_0x55cef6(0x1d8))/0x5+-parseInt(_0x55cef6(0x1fb))/0x6*(parseInt(_0x55cef6(0x1e4))/0x7)+parseInt(_0x55cef6(0x1ec))/0x8+parseInt(_0x55cef6(0x1e0))/0x9;if(_0xa43f03===_0x82d1a2)break;else _0x4586a0['push'](_0x4586a0['shift']());}catch(_0x198b88){_0x4586a0['push'](_0x4586a0['shift']());}}}(a433_0x19ba,0x3a0fb));const a433_0x248379=(function(){let _0x414453=!![];return function(_0x46e4de,_0x5c86bb){const _0x49763a=_0x414453?function(){const _0x3575f2=a433_0x252b;if(_0x5c86bb){const _0x24db43=_0x5c86bb[_0x3575f2(0x1f5)](_0x46e4de,arguments);return _0x5c86bb=null,_0x24db43;}}:function(){};return _0x414453=![],_0x49763a;};}()),a433_0x3f06e4=a433_0x248379(this,function(){const _0x4444c3=a433_0x252b;return a433_0x3f06e4[_0x4444c3(0x1de)]()['search']('(((.+)+)+)+$')[_0x4444c3(0x1de)]()[_0x4444c3(0x1fd)](a433_0x3f06e4)['search'](_0x4444c3(0x1f0));});a433_0x3f06e4();'use strict';function a433_0x252b(_0x191da5,_0x21468f){const _0x2355f0=a433_0x19ba();return a433_0x252b=function(_0x3f06e4,_0x248379){_0x3f06e4=_0x3f06e4-0x1d7;let _0x19baad=_0x2355f0[_0x3f06e4];return _0x19baad;},a433_0x252b(_0x191da5,_0x21468f);}var __importDefault=this&&this[a433_0x1fe5c0(0x1ed)]||function(_0x333988){const _0x208dfb=a433_0x1fe5c0;return _0x333988&&_0x333988[_0x208dfb(0x1d9)]?_0x333988:{'default':_0x333988};};Object['defineProperty'](exports,'__esModule',{'value':!![]});const nodemailer_1=__importDefault(require(a433_0x1fe5c0(0x1f2))),sequelize_1=__importDefault(require(a433_0x1fe5c0(0x1e2))),database_1=__importDefault(require('../../database')),Setting_1=__importDefault(require(a433_0x1fe5c0(0x1f8))),SendMail=async(_0x34e6d4,_0x1d2884)=>{const _0x42d793=a433_0x1fe5c0;try{const _0x2513a4=0x1,{hasResult:_0x298fbe,data:_0x434132}=await filterEmail(_0x34e6d4);if(!_0x298fbe)return{'status':0x194,'message':_0x42d793(0x1e6)};const _0x2e9241=_0x434132[0x0];if(!_0x2e9241||_0x2e9241[_0x42d793(0x1e8)]===undefined)return{'status':0x194,'message':_0x42d793(0x1f3)};const [_0x495d6c,_0x999831,_0x28be63,_0xad8564]=await Promise['all']([Setting_1[_0x42d793(0x1dd)][_0x42d793(0x1ef)]({'where':{'companyId':_0x2513a4,'key':_0x42d793(0x1ee)}}),Setting_1['default'][_0x42d793(0x1ef)]({'where':{'companyId':_0x2513a4,'key':_0x42d793(0x1ff)}}),Setting_1['default']['findOne']({'where':{'companyId':_0x2513a4,'key':_0x42d793(0x1f6)}}),Setting_1[_0x42d793(0x1dd)]['findOne']({'where':{'companyId':_0x2513a4,'key':_0x42d793(0x1df)}})]),_0x4978a8=_0x495d6c?.[_0x42d793(0x1e3)],_0x530c34=_0x999831?.[_0x42d793(0x1e3)],_0x3ed92a=_0x28be63?.[_0x42d793(0x1e3)],_0x299fe4=_0x530c34,_0xc798a1=_0xad8564?.[_0x42d793(0x1e3)];if(!_0x4978a8||!_0x530c34||!_0x3ed92a||!_0xc798a1)throw new Error(_0x42d793(0x1ea));const _0x52de80=nodemailer_1[_0x42d793(0x1dd)]['createTransport']({'host':_0x4978a8,'port':Number(_0xc798a1),'secure':![],'auth':{'user':_0x530c34,'pass':_0x3ed92a}}),{hasResults:_0x309ded}=await insertToken(_0x34e6d4,_0x1d2884);if(!_0x309ded)return{'status':0x194,'message':'Não\x20foi\x20possível\x20inserir\x20o\x20token\x20de\x20redefinição'};const _0x49cf0f={'from':_0x299fe4,'to':_0x34e6d4,'subject':_0x42d793(0x1e1),'text':_0x42d793(0x1e9)+_0x1d2884+_0x42d793(0x1eb)},_0x537956=await _0x52de80[_0x42d793(0x1fe)](_0x49cf0f);return{'status':0xc8,'message':_0x42d793(0x1fc),'info':_0x537956};}catch(_0xe9604d){return console[_0x42d793(0x1f7)](_0x42d793(0x1f4),_0xe9604d),{'status':0x1f4,'message':'Erro\x20interno\x20do\x20servidor'};}},filterEmail=async _0x665a9a=>{const _0xd9423f=a433_0x1fe5c0,_0xc03c49='SELECT\x20*\x20FROM\x20\x22Users\x22\x20WHERE\x20email\x20=\x27'+_0x665a9a+'\x27',_0x17e625=await database_1[_0xd9423f(0x1dd)]['query'](_0xc03c49,{'type':sequelize_1[_0xd9423f(0x1dd)][_0xd9423f(0x1f1)][_0xd9423f(0x1dc)]});return{'hasResult':_0x17e625[_0xd9423f(0x1da)]>0x0,'data':_0x17e625};},insertToken=async(_0x5c5885,_0x366004)=>{const _0x3a3e88=a433_0x1fe5c0,_0x41ba01=_0x3a3e88(0x1fa)+_0x366004+'\x27\x20WHERE\x20email\x20=\x27'+_0x5c5885+'\x27',_0x107e8b=await database_1[_0x3a3e88(0x1dd)][_0x3a3e88(0x1d7)](_0x41ba01,{'type':sequelize_1[_0x3a3e88(0x1dd)]['QueryTypes']['UPDATE']});return{'hasResults':_0x107e8b[0x1]>0x0,'datas':_0x107e8b};};exports[a433_0x1fe5c0(0x1dd)]=SendMail;function a433_0x19ba(){const _0x5915ab=['default','toString','smtpport','1742616SEsrTc','Redefinição\x20de\x20Senha','sequelize','value','98hxdHFL','828044vtEiem','Email\x20não\x20encontrado','13568uBCXRR','companyId','Olá,\x0a\x0aVocê\x20solicitou\x20a\x20redefinição\x20de\x20senha\x20para\x20sua\x20conta,\x20utilize\x20o\x20seguinte\x20Código\x20de\x20Verificação\x20para\x20concluir\x20o\x20processo\x20de\x20redefinição\x20de\x20senha:\x0a\x0aCódigo\x20de\x20Verificação:\x20','Configurações\x20SMTP\x20estão\x20incompletas','\x0a\x0aPor\x20favor,\x20copie\x20e\x20cole\x20o\x20Código\x20de\x20Verificação\x20no\x20campo\x20\x27Código\x20de\x20Verificação\x27.\x0a\x0aSe\x20você\x20não\x20solicitou\x20esta\x20redefinição\x20de\x20senha,\x20por\x20favor,\x20ignore\x20este\x20e-mail.\x0a\x0a\x0aAtenciosamente','1165408xabLKk','__importDefault','smtpauth','findOne','(((.+)+)+)+$','QueryTypes','nodemailer','Dados\x20do\x20usuário\x20não\x20encontrados','Erro\x20ao\x20enviar\x20e-mail:','apply','clientsecretsmtpauth','error','../../models/Setting','274420rZWAuP','UPDATE\x20\x22Users\x22\x20SET\x20\x22resetPassword\x22=\x20\x27','191094bkehPj','E-mail\x20enviado\x20com\x20sucesso','constructor','sendMail','usersmtpauth','query','96515EQciJq','__esModule','length','411ASJMxv','SELECT'];a433_0x19ba=function(){return _0x5915ab;};return a433_0x19ba();}