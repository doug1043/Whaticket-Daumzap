const a463_0x371076=a463_0x535a;(function(_0xdf75c5,_0x211da2){const _0x55e1d7=a463_0x535a,_0x20f80d=_0xdf75c5();while(!![]){try{const _0x4145e2=-parseInt(_0x55e1d7(0x159))/0x1+parseInt(_0x55e1d7(0x15d))/0x2+parseInt(_0x55e1d7(0x153))/0x3+parseInt(_0x55e1d7(0x146))/0x4+parseInt(_0x55e1d7(0x142))/0x5+parseInt(_0x55e1d7(0x13d))/0x6*(-parseInt(_0x55e1d7(0x14e))/0x7)+-parseInt(_0x55e1d7(0x143))/0x8;if(_0x4145e2===_0x211da2)break;else _0x20f80d['push'](_0x20f80d['shift']());}catch(_0x546d74){_0x20f80d['push'](_0x20f80d['shift']());}}}(a463_0xc66a,0x8e0e2));function a463_0xc66a(){const _0x56f8ba=['length','../../models/Setting','\x0a\x0aPor\x20favor,\x20copie\x20e\x20cole\x20o\x20Código\x20de\x20Verificação\x20no\x20campo\x20\x27Código\x20de\x20Verificação\x27.\x0a\x0aSe\x20você\x20não\x20solicitou\x20esta\x20redefinição\x20de\x20senha,\x20por\x20favor,\x20ignore\x20este\x20e-mail.\x0a\x0a\x0aAtenciosamente','search','error','Configurações\x20SMTP\x20estão\x20incompletas','query','19554uiPejo','sequelize','Não\x20foi\x20possível\x20inserir\x20o\x20token\x20de\x20redefinição','UPDATE','Erro\x20interno\x20do\x20servidor','2468625WdFpKk','5839968KyXgEX','value','default','1889788JAeRZh','companyId','UPDATE\x20\x22Users\x22\x20SET\x20\x22resetPassword\x22=\x20\x27','E-mail\x20enviado\x20com\x20sucesso','createTransport','__importDefault','apply','smtpauth','1057SxUBjx','\x27\x20WHERE\x20email\x20=\x27','(((.+)+)+)+$','constructor','Email\x20não\x20encontrado','2375520BYgwfS','Dados\x20do\x20usuário\x20não\x20encontrados','smtpport','SELECT','Redefinição\x20de\x20Senha','defineProperty','58064XnYbbQ','findOne','__esModule','../../database','208030IrpmVO','toString'];a463_0xc66a=function(){return _0x56f8ba;};return a463_0xc66a();}function a463_0x535a(_0x3494ed,_0x441f8d){const _0x95d2a7=a463_0xc66a();return a463_0x535a=function(_0x1f4a6a,_0x58b98e){_0x1f4a6a=_0x1f4a6a-0x139;let _0xc66a95=_0x95d2a7[_0x1f4a6a];return _0xc66a95;},a463_0x535a(_0x3494ed,_0x441f8d);}const a463_0x58b98e=(function(){let _0x485358=!![];return function(_0x40906b,_0x54b6ce){const _0x53e55b=_0x485358?function(){const _0x1634f4=a463_0x535a;if(_0x54b6ce){const _0x3ed71f=_0x54b6ce[_0x1634f4(0x14c)](_0x40906b,arguments);return _0x54b6ce=null,_0x3ed71f;}}:function(){};return _0x485358=![],_0x53e55b;};}()),a463_0x1f4a6a=a463_0x58b98e(this,function(){const _0x346a58=a463_0x535a;return a463_0x1f4a6a[_0x346a58(0x15e)]()[_0x346a58(0x139)](_0x346a58(0x150))[_0x346a58(0x15e)]()[_0x346a58(0x151)](a463_0x1f4a6a)[_0x346a58(0x139)]('(((.+)+)+)+$');});a463_0x1f4a6a();'use strict';var __importDefault=this&&this[a463_0x371076(0x14b)]||function(_0x4f70ee){const _0x139261=a463_0x371076;return _0x4f70ee&&_0x4f70ee[_0x139261(0x15b)]?_0x4f70ee:{'default':_0x4f70ee};};Object[a463_0x371076(0x158)](exports,a463_0x371076(0x15b),{'value':!![]});const nodemailer_1=__importDefault(require('nodemailer')),sequelize_1=__importDefault(require(a463_0x371076(0x13e))),database_1=__importDefault(require(a463_0x371076(0x15c))),Setting_1=__importDefault(require(a463_0x371076(0x160))),SendMail=async(_0x3dde6c,_0x17799f)=>{const _0x408ed8=a463_0x371076;try{const _0x35fe87=0x1,{hasResult:_0xb38a1f,data:_0x5cc361}=await filterEmail(_0x3dde6c);if(!_0xb38a1f)return{'status':0x194,'message':_0x408ed8(0x152)};const _0x207312=_0x5cc361[0x0];if(!_0x207312||_0x207312[_0x408ed8(0x147)]===undefined)return{'status':0x194,'message':_0x408ed8(0x154)};const [_0x5ed40f,_0x3e7514,_0x3e7b85,_0x39e653]=await Promise['all']([Setting_1['default'][_0x408ed8(0x15a)]({'where':{'companyId':_0x35fe87,'key':_0x408ed8(0x14d)}}),Setting_1['default'][_0x408ed8(0x15a)]({'where':{'companyId':_0x35fe87,'key':'usersmtpauth'}}),Setting_1['default'][_0x408ed8(0x15a)]({'where':{'companyId':_0x35fe87,'key':'clientsecretsmtpauth'}}),Setting_1[_0x408ed8(0x145)][_0x408ed8(0x15a)]({'where':{'companyId':_0x35fe87,'key':_0x408ed8(0x155)}})]),_0xf12b95=_0x5ed40f?.[_0x408ed8(0x144)],_0x425366=_0x3e7514?.[_0x408ed8(0x144)],_0x3d9045=_0x3e7b85?.[_0x408ed8(0x144)],_0x1a4aa4=_0x425366,_0x4e8154=_0x39e653?.['value'];if(!_0xf12b95||!_0x425366||!_0x3d9045||!_0x4e8154)throw new Error(_0x408ed8(0x13b));const _0x5e548b=nodemailer_1[_0x408ed8(0x145)][_0x408ed8(0x14a)]({'host':_0xf12b95,'port':Number(_0x4e8154),'secure':![],'auth':{'user':_0x425366,'pass':_0x3d9045}}),{hasResults:_0x44ed28}=await insertToken(_0x3dde6c,_0x17799f);if(!_0x44ed28)return{'status':0x194,'message':_0x408ed8(0x13f)};const _0x39cf51={'from':_0x1a4aa4,'to':_0x3dde6c,'subject':_0x408ed8(0x157),'text':'Olá,\x0a\x0aVocê\x20solicitou\x20a\x20redefinição\x20de\x20senha\x20para\x20sua\x20conta,\x20utilize\x20o\x20seguinte\x20Código\x20de\x20Verificação\x20para\x20concluir\x20o\x20processo\x20de\x20redefinição\x20de\x20senha:\x0a\x0aCódigo\x20de\x20Verificação:\x20'+_0x17799f+_0x408ed8(0x161)},_0xe6dc8c=await _0x5e548b['sendMail'](_0x39cf51);return{'status':0xc8,'message':_0x408ed8(0x149),'info':_0xe6dc8c};}catch(_0x8b559b){return console[_0x408ed8(0x13a)]('Erro\x20ao\x20enviar\x20e-mail:',_0x8b559b),{'status':0x1f4,'message':_0x408ed8(0x141)};}},filterEmail=async _0x50c3fe=>{const _0x3314c9=a463_0x371076,_0x501a3e='SELECT\x20*\x20FROM\x20\x22Users\x22\x20WHERE\x20email\x20=\x27'+_0x50c3fe+'\x27',_0x4573ff=await database_1[_0x3314c9(0x145)][_0x3314c9(0x13c)](_0x501a3e,{'type':sequelize_1[_0x3314c9(0x145)]['QueryTypes'][_0x3314c9(0x156)]});return{'hasResult':_0x4573ff[_0x3314c9(0x15f)]>0x0,'data':_0x4573ff};},insertToken=async(_0x541bfe,_0x13b88c)=>{const _0x586262=a463_0x371076,_0x1df657=_0x586262(0x148)+_0x13b88c+_0x586262(0x14f)+_0x541bfe+'\x27',_0xe53a4f=await database_1[_0x586262(0x145)][_0x586262(0x13c)](_0x1df657,{'type':sequelize_1['default']['QueryTypes'][_0x586262(0x140)]});return{'hasResults':_0xe53a4f[0x1]>0x0,'datas':_0xe53a4f};};exports[a463_0x371076(0x145)]=SendMail;