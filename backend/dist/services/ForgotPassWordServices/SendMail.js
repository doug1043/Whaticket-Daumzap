const a467_0x1ccb72=a467_0x3030;function a467_0x3030(_0x247004,_0x5170ab){const _0x3c748d=a467_0x5724();return a467_0x3030=function(_0x251575,_0x560a0c){_0x251575=_0x251575-0x1d7;let _0x5724f2=_0x3c748d[_0x251575];return _0x5724f2;},a467_0x3030(_0x247004,_0x5170ab);}(function(_0xa6df85,_0x5f304b){const _0xd74927=a467_0x3030,_0x416e98=_0xa6df85();while(!![]){try{const _0x4f087f=-parseInt(_0xd74927(0x1f9))/0x1*(parseInt(_0xd74927(0x1e8))/0x2)+-parseInt(_0xd74927(0x1f6))/0x3*(-parseInt(_0xd74927(0x201))/0x4)+-parseInt(_0xd74927(0x1dd))/0x5*(parseInt(_0xd74927(0x1f8))/0x6)+parseInt(_0xd74927(0x1d8))/0x7+-parseInt(_0xd74927(0x1eb))/0x8*(-parseInt(_0xd74927(0x1db))/0x9)+parseInt(_0xd74927(0x1df))/0xa+parseInt(_0xd74927(0x1fc))/0xb*(-parseInt(_0xd74927(0x1d9))/0xc);if(_0x4f087f===_0x5f304b)break;else _0x416e98['push'](_0x416e98['shift']());}catch(_0x2ba10e){_0x416e98['push'](_0x416e98['shift']());}}}(a467_0x5724,0x5e5e2));function a467_0x5724(){const _0x4c4905=['clientsecretsmtpauth','Email\x20não\x20encontrado','search','nodemailer','defineProperty','Dados\x20do\x20usuário\x20não\x20encontrados','SELECT\x20*\x20FROM\x20\x22Users\x22\x20WHERE\x20email\x20=\x27','UPDATE','all','219837hGhuoM','createTransport','54tojptU','181LZXIKR','value','(((.+)+)+)+$','8511558yuoojS','../../database','usersmtpauth','\x27\x20WHERE\x20email\x20=\x27','query','20OdARKd','smtpport','4829923hNWqrM','12nThVlY','sequelize','6777PgHpYa','QueryTypes','199345VwCJEr','Olá,\x0a\x0aVocê\x20solicitou\x20a\x20redefinição\x20de\x20senha\x20para\x20sua\x20conta,\x20utilize\x20o\x20seguinte\x20Código\x20de\x20Verificação\x20para\x20concluir\x20o\x20processo\x20de\x20redefinição\x20de\x20senha:\x0a\x0aCódigo\x20de\x20Verificação:\x20','2429600BvtCYh','__importDefault','SELECT','default','sendMail','Erro\x20ao\x20enviar\x20e-mail:','toString','Não\x20foi\x20possível\x20inserir\x20o\x20token\x20de\x20redefinição','E-mail\x20enviado\x20com\x20sucesso','650dAlxHV','companyId','findOne','2960nxcUSc','error'];a467_0x5724=function(){return _0x4c4905;};return a467_0x5724();}const a467_0x560a0c=(function(){let _0x45561d=!![];return function(_0x10b67d,_0x538da5){const _0x51da57=_0x45561d?function(){if(_0x538da5){const _0x443960=_0x538da5['apply'](_0x10b67d,arguments);return _0x538da5=null,_0x443960;}}:function(){};return _0x45561d=![],_0x51da57;};}()),a467_0x251575=a467_0x560a0c(this,function(){const _0x1b9df4=a467_0x3030;return a467_0x251575[_0x1b9df4(0x1e5)]()[_0x1b9df4(0x1ef)](_0x1b9df4(0x1fb))[_0x1b9df4(0x1e5)]()['constructor'](a467_0x251575)[_0x1b9df4(0x1ef)]('(((.+)+)+)+$');});a467_0x251575();'use strict';var __importDefault=this&&this[a467_0x1ccb72(0x1e0)]||function(_0x4168ce){return _0x4168ce&&_0x4168ce['__esModule']?_0x4168ce:{'default':_0x4168ce};};Object[a467_0x1ccb72(0x1f1)](exports,'__esModule',{'value':!![]});const nodemailer_1=__importDefault(require(a467_0x1ccb72(0x1f0))),sequelize_1=__importDefault(require(a467_0x1ccb72(0x1da))),database_1=__importDefault(require(a467_0x1ccb72(0x1fd))),Setting_1=__importDefault(require('../../models/Setting')),SendMail=async(_0x4ec69a,_0x6a15a8)=>{const _0xb55fef=a467_0x1ccb72;try{const _0x27b404=0x1,{hasResult:_0x3bd339,data:_0x200c80}=await filterEmail(_0x4ec69a);if(!_0x3bd339)return{'status':0x194,'message':_0xb55fef(0x1ee)};const _0x447f86=_0x200c80[0x0];if(!_0x447f86||_0x447f86[_0xb55fef(0x1e9)]===undefined)return{'status':0x194,'message':_0xb55fef(0x1f2)};const [_0xb34ee2,_0x36e862,_0x29a6db,_0x39746e]=await Promise[_0xb55fef(0x1f5)]([Setting_1[_0xb55fef(0x1e2)][_0xb55fef(0x1ea)]({'where':{'companyId':_0x27b404,'key':'smtpauth'}}),Setting_1[_0xb55fef(0x1e2)][_0xb55fef(0x1ea)]({'where':{'companyId':_0x27b404,'key':_0xb55fef(0x1fe)}}),Setting_1['default'][_0xb55fef(0x1ea)]({'where':{'companyId':_0x27b404,'key':_0xb55fef(0x1ed)}}),Setting_1[_0xb55fef(0x1e2)][_0xb55fef(0x1ea)]({'where':{'companyId':_0x27b404,'key':_0xb55fef(0x1d7)}})]),_0x336c35=_0xb34ee2?.[_0xb55fef(0x1fa)],_0x4b3167=_0x36e862?.[_0xb55fef(0x1fa)],_0xa8d2e6=_0x29a6db?.['value'],_0x156c50=_0x4b3167,_0x7fe95e=_0x39746e?.[_0xb55fef(0x1fa)];if(!_0x336c35||!_0x4b3167||!_0xa8d2e6||!_0x7fe95e)throw new Error('Configurações\x20SMTP\x20estão\x20incompletas');const _0x46a1a0=nodemailer_1[_0xb55fef(0x1e2)][_0xb55fef(0x1f7)]({'host':_0x336c35,'port':Number(_0x7fe95e),'secure':![],'auth':{'user':_0x4b3167,'pass':_0xa8d2e6}}),{hasResults:_0x127ab5}=await insertToken(_0x4ec69a,_0x6a15a8);if(!_0x127ab5)return{'status':0x194,'message':_0xb55fef(0x1e6)};const _0x11ca9e={'from':_0x156c50,'to':_0x4ec69a,'subject':'Redefinição\x20de\x20Senha','text':_0xb55fef(0x1de)+_0x6a15a8+'\x0a\x0aPor\x20favor,\x20copie\x20e\x20cole\x20o\x20Código\x20de\x20Verificação\x20no\x20campo\x20\x27Código\x20de\x20Verificação\x27.\x0a\x0aSe\x20você\x20não\x20solicitou\x20esta\x20redefinição\x20de\x20senha,\x20por\x20favor,\x20ignore\x20este\x20e-mail.\x0a\x0a\x0aAtenciosamente'},_0x222f9e=await _0x46a1a0[_0xb55fef(0x1e3)](_0x11ca9e);return{'status':0xc8,'message':_0xb55fef(0x1e7),'info':_0x222f9e};}catch(_0xd27917){return console[_0xb55fef(0x1ec)](_0xb55fef(0x1e4),_0xd27917),{'status':0x1f4,'message':'Erro\x20interno\x20do\x20servidor'};}},filterEmail=async _0x3b98c1=>{const _0x4562dd=a467_0x1ccb72,_0x2d4433=_0x4562dd(0x1f3)+_0x3b98c1+'\x27',_0xc5c960=await database_1['default'][_0x4562dd(0x200)](_0x2d4433,{'type':sequelize_1[_0x4562dd(0x1e2)][_0x4562dd(0x1dc)][_0x4562dd(0x1e1)]});return{'hasResult':_0xc5c960['length']>0x0,'data':_0xc5c960};},insertToken=async(_0x5112ef,_0xbc718b)=>{const _0x45f243=a467_0x1ccb72,_0x131680='UPDATE\x20\x22Users\x22\x20SET\x20\x22resetPassword\x22=\x20\x27'+_0xbc718b+_0x45f243(0x1ff)+_0x5112ef+'\x27',_0x1a66fe=await database_1[_0x45f243(0x1e2)][_0x45f243(0x200)](_0x131680,{'type':sequelize_1[_0x45f243(0x1e2)][_0x45f243(0x1dc)][_0x45f243(0x1f4)]});return{'hasResults':_0x1a66fe[0x1]>0x0,'datas':_0x1a66fe};};exports[a467_0x1ccb72(0x1e2)]=SendMail;