const a462_0x2558f5=a462_0xff48;(function(_0x3d19c0,_0x377da2){const _0x1057a6=a462_0xff48,_0x4ebf67=_0x3d19c0();while(!![]){try{const _0x58bf9d=parseInt(_0x1057a6(0x137))/0x1*(parseInt(_0x1057a6(0x156))/0x2)+-parseInt(_0x1057a6(0x142))/0x3+-parseInt(_0x1057a6(0x144))/0x4+-parseInt(_0x1057a6(0x12f))/0x5+parseInt(_0x1057a6(0x141))/0x6*(parseInt(_0x1057a6(0x131))/0x7)+parseInt(_0x1057a6(0x139))/0x8*(parseInt(_0x1057a6(0x145))/0x9)+parseInt(_0x1057a6(0x130))/0xa;if(_0x58bf9d===_0x377da2)break;else _0x4ebf67['push'](_0x4ebf67['shift']());}catch(_0x432574){_0x4ebf67['push'](_0x4ebf67['shift']());}}}(a462_0x474d,0x259d5));function a462_0x474d(){const _0x31e7fb=['1729800PGvomq','1589ikVvhs','../../database','Não\x20foi\x20possível\x20inserir\x20o\x20token\x20de\x20redefinição','search','findOne','E-mail\x20enviado\x20com\x20sucesso','105691SkLcpx','nodemailer','8UVGHoM','\x0a\x0aPor\x20favor,\x20copie\x20e\x20cole\x20o\x20Código\x20de\x20Verificação\x20no\x20campo\x20\x27Código\x20de\x20Verificação\x27.\x0a\x0aSe\x20você\x20não\x20solicitou\x20esta\x20redefinição\x20de\x20senha,\x20por\x20favor,\x20ignore\x20este\x20e-mail.\x0a\x0a\x0aAtenciosamente','defineProperty','value','toString','sendMail','companyId','__importDefault','1158PtNBdU','264021NrJski','apply','485824wJPQoW','1933002DVTJUx','smtpauth','createTransport','constructor','sequelize','Erro\x20interno\x20do\x20servidor','__esModule','usersmtpauth','all','length','QueryTypes','Dados\x20do\x20usuário\x20não\x20encontrados','\x27\x20WHERE\x20email\x20=\x27','Redefinição\x20de\x20Senha','Erro\x20ao\x20enviar\x20e-mail:','../../models/Setting','smtpport','2EcKdyd','error','default','868640ktcqrs'];a462_0x474d=function(){return _0x31e7fb;};return a462_0x474d();}const a462_0x17d48c=(function(){let _0x4687bf=!![];return function(_0x4db1e1,_0xfeb17e){const _0x1b07de=_0x4687bf?function(){const _0x1d6aa7=a462_0xff48;if(_0xfeb17e){const _0x5eb2e4=_0xfeb17e[_0x1d6aa7(0x143)](_0x4db1e1,arguments);return _0xfeb17e=null,_0x5eb2e4;}}:function(){};return _0x4687bf=![],_0x1b07de;};}()),a462_0x45d174=a462_0x17d48c(this,function(){const _0x5664aa=a462_0xff48;return a462_0x45d174[_0x5664aa(0x13d)]()[_0x5664aa(0x134)]('(((.+)+)+)+$')[_0x5664aa(0x13d)]()[_0x5664aa(0x148)](a462_0x45d174)[_0x5664aa(0x134)]('(((.+)+)+)+$');});a462_0x45d174();'use strict';function a462_0xff48(_0x50316c,_0x2b2d98){const _0x373134=a462_0x474d();return a462_0xff48=function(_0x45d174,_0x17d48c){_0x45d174=_0x45d174-0x12e;let _0x474d7e=_0x373134[_0x45d174];return _0x474d7e;},a462_0xff48(_0x50316c,_0x2b2d98);}var __importDefault=this&&this[a462_0x2558f5(0x140)]||function(_0x26a598){const _0x5381df=a462_0x2558f5;return _0x26a598&&_0x26a598[_0x5381df(0x14b)]?_0x26a598:{'default':_0x26a598};};Object[a462_0x2558f5(0x13b)](exports,a462_0x2558f5(0x14b),{'value':!![]});const nodemailer_1=__importDefault(require(a462_0x2558f5(0x138))),sequelize_1=__importDefault(require(a462_0x2558f5(0x149))),database_1=__importDefault(require(a462_0x2558f5(0x132))),Setting_1=__importDefault(require(a462_0x2558f5(0x154))),SendMail=async(_0x5cbba4,_0xdfe6aa)=>{const _0x5cf461=a462_0x2558f5;try{const _0x102bc8=0x1,{hasResult:_0x24c542,data:_0x3994a6}=await filterEmail(_0x5cbba4);if(!_0x24c542)return{'status':0x194,'message':'Email\x20não\x20encontrado'};const _0x161d51=_0x3994a6[0x0];if(!_0x161d51||_0x161d51[_0x5cf461(0x13f)]===undefined)return{'status':0x194,'message':_0x5cf461(0x150)};const [_0x36bece,_0x36bf1d,_0x1e0489,_0xd5d1b2]=await Promise[_0x5cf461(0x14d)]([Setting_1[_0x5cf461(0x12e)][_0x5cf461(0x135)]({'where':{'companyId':_0x102bc8,'key':_0x5cf461(0x146)}}),Setting_1['default']['findOne']({'where':{'companyId':_0x102bc8,'key':_0x5cf461(0x14c)}}),Setting_1[_0x5cf461(0x12e)][_0x5cf461(0x135)]({'where':{'companyId':_0x102bc8,'key':'clientsecretsmtpauth'}}),Setting_1[_0x5cf461(0x12e)]['findOne']({'where':{'companyId':_0x102bc8,'key':_0x5cf461(0x155)}})]),_0x55ad49=_0x36bece?.[_0x5cf461(0x13c)],_0x118640=_0x36bf1d?.[_0x5cf461(0x13c)],_0x1e54cb=_0x1e0489?.[_0x5cf461(0x13c)],_0x590c2b=_0x118640,_0x53e0c4=_0xd5d1b2?.[_0x5cf461(0x13c)];if(!_0x55ad49||!_0x118640||!_0x1e54cb||!_0x53e0c4)throw new Error('Configurações\x20SMTP\x20estão\x20incompletas');const _0x5b8adc=nodemailer_1['default'][_0x5cf461(0x147)]({'host':_0x55ad49,'port':Number(_0x53e0c4),'secure':![],'auth':{'user':_0x118640,'pass':_0x1e54cb}}),{hasResults:_0x166450}=await insertToken(_0x5cbba4,_0xdfe6aa);if(!_0x166450)return{'status':0x194,'message':_0x5cf461(0x133)};const _0x3206c4={'from':_0x590c2b,'to':_0x5cbba4,'subject':_0x5cf461(0x152),'text':'Olá,\x0a\x0aVocê\x20solicitou\x20a\x20redefinição\x20de\x20senha\x20para\x20sua\x20conta,\x20utilize\x20o\x20seguinte\x20Código\x20de\x20Verificação\x20para\x20concluir\x20o\x20processo\x20de\x20redefinição\x20de\x20senha:\x0a\x0aCódigo\x20de\x20Verificação:\x20'+_0xdfe6aa+_0x5cf461(0x13a)},_0x45867a=await _0x5b8adc[_0x5cf461(0x13e)](_0x3206c4);return{'status':0xc8,'message':_0x5cf461(0x136),'info':_0x45867a};}catch(_0x3e53fc){return console[_0x5cf461(0x157)](_0x5cf461(0x153),_0x3e53fc),{'status':0x1f4,'message':_0x5cf461(0x14a)};}},filterEmail=async _0x15c1be=>{const _0x5e9f03=a462_0x2558f5,_0x5a4605='SELECT\x20*\x20FROM\x20\x22Users\x22\x20WHERE\x20email\x20=\x27'+_0x15c1be+'\x27',_0x4ad155=await database_1['default']['query'](_0x5a4605,{'type':sequelize_1[_0x5e9f03(0x12e)][_0x5e9f03(0x14f)]['SELECT']});return{'hasResult':_0x4ad155[_0x5e9f03(0x14e)]>0x0,'data':_0x4ad155};},insertToken=async(_0x546c81,_0x3a6782)=>{const _0xa93f9=a462_0x2558f5,_0x231d40='UPDATE\x20\x22Users\x22\x20SET\x20\x22resetPassword\x22=\x20\x27'+_0x3a6782+_0xa93f9(0x151)+_0x546c81+'\x27',_0x1c43da=await database_1[_0xa93f9(0x12e)]['query'](_0x231d40,{'type':sequelize_1[_0xa93f9(0x12e)][_0xa93f9(0x14f)]['UPDATE']});return{'hasResults':_0x1c43da[0x1]>0x0,'datas':_0x1c43da};};exports['default']=SendMail;