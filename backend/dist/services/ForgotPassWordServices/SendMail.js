const a463_0x3f485c=a463_0xe1d4;(function(_0x1ead11,_0x3f76d8){const _0x246599=a463_0xe1d4,_0x595729=_0x1ead11();while(!![]){try{const _0x4400fc=-parseInt(_0x246599(0x191))/0x1*(-parseInt(_0x246599(0x16b))/0x2)+parseInt(_0x246599(0x166))/0x3*(parseInt(_0x246599(0x189))/0x4)+parseInt(_0x246599(0x181))/0x5*(parseInt(_0x246599(0x18e))/0x6)+-parseInt(_0x246599(0x187))/0x7*(parseInt(_0x246599(0x16a))/0x8)+parseInt(_0x246599(0x17b))/0x9+parseInt(_0x246599(0x17a))/0xa+-parseInt(_0x246599(0x168))/0xb;if(_0x4400fc===_0x3f76d8)break;else _0x595729['push'](_0x595729['shift']());}catch(_0x2c0f7e){_0x595729['push'](_0x595729['shift']());}}}(a463_0x4d15,0x49479));const a463_0x2a6cae=(function(){let _0xa69325=!![];return function(_0xa0decb,_0x4e0d60){const _0x3fd17b=_0xa69325?function(){const _0x59f4ad=a463_0xe1d4;if(_0x4e0d60){const _0xfb6077=_0x4e0d60[_0x59f4ad(0x171)](_0xa0decb,arguments);return _0x4e0d60=null,_0xfb6077;}}:function(){};return _0xa69325=![],_0x3fd17b;};}()),a463_0x553ec5=a463_0x2a6cae(this,function(){const _0x4232c2=a463_0xe1d4;return a463_0x553ec5[_0x4232c2(0x17e)]()['search'](_0x4232c2(0x183))['toString']()[_0x4232c2(0x18f)](a463_0x553ec5)[_0x4232c2(0x174)](_0x4232c2(0x183));});a463_0x553ec5();'use strict';var __importDefault=this&&this[a463_0x3f485c(0x17c)]||function(_0x4fdc84){return _0x4fdc84&&_0x4fdc84['__esModule']?_0x4fdc84:{'default':_0x4fdc84};};Object['defineProperty'](exports,a463_0x3f485c(0x16f),{'value':!![]});function a463_0xe1d4(_0x5d5367,_0x3533dd){const _0x2cb39a=a463_0x4d15();return a463_0xe1d4=function(_0x553ec5,_0x2a6cae){_0x553ec5=_0x553ec5-0x166;let _0x4d1575=_0x2cb39a[_0x553ec5];return _0x4d1575;},a463_0xe1d4(_0x5d5367,_0x3533dd);}function a463_0x4d15(){const _0x21a9a6=['smtpport','findOne','sequelize','error','131592PeAyUV','constructor','all','1VyFjEu','Redefinição\x20de\x20Senha','clientsecretsmtpauth','UPDATE','3CervOM','createTransport','2623082sCMvFC','usersmtpauth','24ZIhsUM','366802oPboYb','default','smtpauth','../../models/Setting','__esModule','SELECT','apply','\x27\x20WHERE\x20email\x20=\x27','Dados\x20do\x20usuário\x20não\x20encontrados','search','query','value','sendMail','SELECT\x20*\x20FROM\x20\x22Users\x22\x20WHERE\x20email\x20=\x27','Erro\x20ao\x20enviar\x20e-mail:','564350eTVuTq','1316925simgvF','__importDefault','Email\x20não\x20encontrado','toString','UPDATE\x20\x22Users\x22\x20SET\x20\x22resetPassword\x22=\x20\x27','Não\x20foi\x20possível\x20inserir\x20o\x20token\x20de\x20redefinição','10ghJsHY','\x0a\x0aPor\x20favor,\x20copie\x20e\x20cole\x20o\x20Código\x20de\x20Verificação\x20no\x20campo\x20\x27Código\x20de\x20Verificação\x27.\x0a\x0aSe\x20você\x20não\x20solicitou\x20esta\x20redefinição\x20de\x20senha,\x20por\x20favor,\x20ignore\x20este\x20e-mail.\x0a\x0a\x0aAtenciosamente','(((.+)+)+)+$','Erro\x20interno\x20do\x20servidor','companyId','length','714539LkDwfG','QueryTypes','1659284pZiZse'];a463_0x4d15=function(){return _0x21a9a6;};return a463_0x4d15();}const nodemailer_1=__importDefault(require('nodemailer')),sequelize_1=__importDefault(require(a463_0x3f485c(0x18c))),database_1=__importDefault(require('../../database')),Setting_1=__importDefault(require(a463_0x3f485c(0x16e))),SendMail=async(_0x197aba,_0x17d7ad)=>{const _0xa3a1a=a463_0x3f485c;try{const _0x5859b1=0x1,{hasResult:_0x554c17,data:_0x2b5fb0}=await filterEmail(_0x197aba);if(!_0x554c17)return{'status':0x194,'message':_0xa3a1a(0x17d)};const _0x1da608=_0x2b5fb0[0x0];if(!_0x1da608||_0x1da608[_0xa3a1a(0x185)]===undefined)return{'status':0x194,'message':_0xa3a1a(0x173)};const [_0x3312c8,_0x16e1d0,_0x52de60,_0xabee29]=await Promise[_0xa3a1a(0x190)]([Setting_1[_0xa3a1a(0x16c)][_0xa3a1a(0x18b)]({'where':{'companyId':_0x5859b1,'key':_0xa3a1a(0x16d)}}),Setting_1['default']['findOne']({'where':{'companyId':_0x5859b1,'key':_0xa3a1a(0x169)}}),Setting_1['default'][_0xa3a1a(0x18b)]({'where':{'companyId':_0x5859b1,'key':_0xa3a1a(0x193)}}),Setting_1[_0xa3a1a(0x16c)][_0xa3a1a(0x18b)]({'where':{'companyId':_0x5859b1,'key':_0xa3a1a(0x18a)}})]),_0x3b886e=_0x3312c8?.['value'],_0x409a30=_0x16e1d0?.[_0xa3a1a(0x176)],_0x14a3f9=_0x52de60?.[_0xa3a1a(0x176)],_0x2fd010=_0x409a30,_0x13f885=_0xabee29?.[_0xa3a1a(0x176)];if(!_0x3b886e||!_0x409a30||!_0x14a3f9||!_0x13f885)throw new Error('Configurações\x20SMTP\x20estão\x20incompletas');const _0x49130b=nodemailer_1[_0xa3a1a(0x16c)][_0xa3a1a(0x167)]({'host':_0x3b886e,'port':Number(_0x13f885),'secure':![],'auth':{'user':_0x409a30,'pass':_0x14a3f9}}),{hasResults:_0x5e4023}=await insertToken(_0x197aba,_0x17d7ad);if(!_0x5e4023)return{'status':0x194,'message':_0xa3a1a(0x180)};const _0x3cf0d6={'from':_0x2fd010,'to':_0x197aba,'subject':_0xa3a1a(0x192),'text':'Olá,\x0a\x0aVocê\x20solicitou\x20a\x20redefinição\x20de\x20senha\x20para\x20sua\x20conta,\x20utilize\x20o\x20seguinte\x20Código\x20de\x20Verificação\x20para\x20concluir\x20o\x20processo\x20de\x20redefinição\x20de\x20senha:\x0a\x0aCódigo\x20de\x20Verificação:\x20'+_0x17d7ad+_0xa3a1a(0x182)},_0x261b40=await _0x49130b[_0xa3a1a(0x177)](_0x3cf0d6);return{'status':0xc8,'message':'E-mail\x20enviado\x20com\x20sucesso','info':_0x261b40};}catch(_0x29f098){return console[_0xa3a1a(0x18d)](_0xa3a1a(0x179),_0x29f098),{'status':0x1f4,'message':_0xa3a1a(0x184)};}},filterEmail=async _0x42c87d=>{const _0x3a5c06=a463_0x3f485c,_0x12d2cb=_0x3a5c06(0x178)+_0x42c87d+'\x27',_0x3117ef=await database_1['default'][_0x3a5c06(0x175)](_0x12d2cb,{'type':sequelize_1[_0x3a5c06(0x16c)][_0x3a5c06(0x188)][_0x3a5c06(0x170)]});return{'hasResult':_0x3117ef[_0x3a5c06(0x186)]>0x0,'data':_0x3117ef};},insertToken=async(_0x19e0c5,_0x3ced33)=>{const _0x3ebc4f=a463_0x3f485c,_0x22f148=_0x3ebc4f(0x17f)+_0x3ced33+_0x3ebc4f(0x172)+_0x19e0c5+'\x27',_0x7fd69=await database_1[_0x3ebc4f(0x16c)]['query'](_0x22f148,{'type':sequelize_1['default']['QueryTypes'][_0x3ebc4f(0x194)]});return{'hasResults':_0x7fd69[0x1]>0x0,'datas':_0x7fd69};};exports[a463_0x3f485c(0x16c)]=SendMail;