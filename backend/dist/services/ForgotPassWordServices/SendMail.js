const a466_0x3fccd7=a466_0x3ad3;(function(_0x242fc9,_0x2e9314){const _0x4f8610=a466_0x3ad3,_0x6e5dd1=_0x242fc9();while(!![]){try{const _0x5c0a4d=parseInt(_0x4f8610(0x195))/0x1+parseInt(_0x4f8610(0x1a1))/0x2*(parseInt(_0x4f8610(0x1b3))/0x3)+-parseInt(_0x4f8610(0x193))/0x4*(-parseInt(_0x4f8610(0x198))/0x5)+parseInt(_0x4f8610(0x1bc))/0x6+-parseInt(_0x4f8610(0x194))/0x7*(-parseInt(_0x4f8610(0x1c1))/0x8)+parseInt(_0x4f8610(0x1a2))/0x9*(parseInt(_0x4f8610(0x1aa))/0xa)+-parseInt(_0x4f8610(0x1bb))/0xb;if(_0x5c0a4d===_0x2e9314)break;else _0x6e5dd1['push'](_0x6e5dd1['shift']());}catch(_0x1a90df){_0x6e5dd1['push'](_0x6e5dd1['shift']());}}}(a466_0xede7,0x2def5));const a466_0x236578=(function(){let _0x4d0272=!![];return function(_0x337640,_0x30d481){const _0x5e2fd2=_0x4d0272?function(){const _0x492f18=a466_0x3ad3;if(_0x30d481){const _0xcfcc66=_0x30d481[_0x492f18(0x1ac)](_0x337640,arguments);return _0x30d481=null,_0xcfcc66;}}:function(){};return _0x4d0272=![],_0x5e2fd2;};}()),a466_0x235ae5=a466_0x236578(this,function(){const _0x44fcd1=a466_0x3ad3;return a466_0x235ae5[_0x44fcd1(0x1c0)]()[_0x44fcd1(0x1b8)]('(((.+)+)+)+$')[_0x44fcd1(0x1c0)]()[_0x44fcd1(0x1a3)](a466_0x235ae5)['search'](_0x44fcd1(0x1a7));});a466_0x235ae5();'use strict';var __importDefault=this&&this[a466_0x3fccd7(0x1ab)]||function(_0x30564b){const _0x3131e7=a466_0x3fccd7;return _0x30564b&&_0x30564b[_0x3131e7(0x1af)]?_0x30564b:{'default':_0x30564b};};Object[a466_0x3fccd7(0x1b0)](exports,a466_0x3fccd7(0x1af),{'value':!![]});const nodemailer_1=__importDefault(require(a466_0x3fccd7(0x1b7))),sequelize_1=__importDefault(require(a466_0x3fccd7(0x196))),database_1=__importDefault(require('../../database')),Setting_1=__importDefault(require(a466_0x3fccd7(0x19a))),SendMail=async(_0x94cbfc,_0x5d0e0e)=>{const _0x3c4d46=a466_0x3fccd7;try{const _0x12f153=0x1,{hasResult:_0x447db1,data:_0x3b6c09}=await filterEmail(_0x94cbfc);if(!_0x447db1)return{'status':0x194,'message':_0x3c4d46(0x1ba)};const _0x3d12b5=_0x3b6c09[0x0];if(!_0x3d12b5||_0x3d12b5[_0x3c4d46(0x1b4)]===undefined)return{'status':0x194,'message':'Dados\x20do\x20usuário\x20não\x20encontrados'};const [_0x166349,_0x4f9dec,_0x187346,_0x44b7fd]=await Promise[_0x3c4d46(0x1b2)]([Setting_1[_0x3c4d46(0x19f)][_0x3c4d46(0x19c)]({'where':{'companyId':_0x12f153,'key':_0x3c4d46(0x1bd)}}),Setting_1['default'][_0x3c4d46(0x19c)]({'where':{'companyId':_0x12f153,'key':_0x3c4d46(0x199)}}),Setting_1[_0x3c4d46(0x19f)][_0x3c4d46(0x19c)]({'where':{'companyId':_0x12f153,'key':'clientsecretsmtpauth'}}),Setting_1[_0x3c4d46(0x19f)][_0x3c4d46(0x19c)]({'where':{'companyId':_0x12f153,'key':_0x3c4d46(0x1a5)}})]),_0x499d07=_0x166349?.[_0x3c4d46(0x19d)],_0x190c67=_0x4f9dec?.[_0x3c4d46(0x19d)],_0x5dc277=_0x187346?.['value'],_0x29821c=_0x190c67,_0x5e5d1e=_0x44b7fd?.[_0x3c4d46(0x19d)];if(!_0x499d07||!_0x190c67||!_0x5dc277||!_0x5e5d1e)throw new Error(_0x3c4d46(0x1a8));const _0x212335=nodemailer_1[_0x3c4d46(0x19f)][_0x3c4d46(0x1be)]({'host':_0x499d07,'port':Number(_0x5e5d1e),'secure':![],'auth':{'user':_0x190c67,'pass':_0x5dc277}}),{hasResults:_0x250021}=await insertToken(_0x94cbfc,_0x5d0e0e);if(!_0x250021)return{'status':0x194,'message':_0x3c4d46(0x1a9)};const _0x28c29f={'from':_0x29821c,'to':_0x94cbfc,'subject':_0x3c4d46(0x19b),'text':_0x3c4d46(0x1a4)+_0x5d0e0e+_0x3c4d46(0x1a6)},_0x4d3ae5=await _0x212335[_0x3c4d46(0x19e)](_0x28c29f);return{'status':0xc8,'message':_0x3c4d46(0x1b1),'info':_0x4d3ae5};}catch(_0x38891a){return console[_0x3c4d46(0x1b5)]('Erro\x20ao\x20enviar\x20e-mail:',_0x38891a),{'status':0x1f4,'message':'Erro\x20interno\x20do\x20servidor'};}},filterEmail=async _0x4f4816=>{const _0x246011=a466_0x3fccd7,_0x5dccd3=_0x246011(0x1a0)+_0x4f4816+'\x27',_0x3f303c=await database_1[_0x246011(0x19f)][_0x246011(0x197)](_0x5dccd3,{'type':sequelize_1[_0x246011(0x19f)]['QueryTypes'][_0x246011(0x1b6)]});return{'hasResult':_0x3f303c[_0x246011(0x1ad)]>0x0,'data':_0x3f303c};},insertToken=async(_0xbabe4c,_0x14969f)=>{const _0xce9c2=a466_0x3fccd7,_0x100601=_0xce9c2(0x1ae)+_0x14969f+'\x27\x20WHERE\x20email\x20=\x27'+_0xbabe4c+'\x27',_0x5c0ec9=await database_1[_0xce9c2(0x19f)]['query'](_0x100601,{'type':sequelize_1[_0xce9c2(0x19f)][_0xce9c2(0x1b9)][_0xce9c2(0x1bf)]});return{'hasResults':_0x5c0ec9[0x1]>0x0,'datas':_0x5c0ec9};};function a466_0xede7(){const _0x293351=['sendMail','default','SELECT\x20*\x20FROM\x20\x22Users\x22\x20WHERE\x20email\x20=\x27','2wjWnwu','34623iDZjri','constructor','Olá,\x0a\x0aVocê\x20solicitou\x20a\x20redefinição\x20de\x20senha\x20para\x20sua\x20conta,\x20utilize\x20o\x20seguinte\x20Código\x20de\x20Verificação\x20para\x20concluir\x20o\x20processo\x20de\x20redefinição\x20de\x20senha:\x0a\x0aCódigo\x20de\x20Verificação:\x20','smtpport','\x0a\x0aPor\x20favor,\x20copie\x20e\x20cole\x20o\x20Código\x20de\x20Verificação\x20no\x20campo\x20\x27Código\x20de\x20Verificação\x27.\x0a\x0aSe\x20você\x20não\x20solicitou\x20esta\x20redefinição\x20de\x20senha,\x20por\x20favor,\x20ignore\x20este\x20e-mail.\x0a\x0a\x0aAtenciosamente','(((.+)+)+)+$','Configurações\x20SMTP\x20estão\x20incompletas','Não\x20foi\x20possível\x20inserir\x20o\x20token\x20de\x20redefinição','290ddaNyn','__importDefault','apply','length','UPDATE\x20\x22Users\x22\x20SET\x20\x22resetPassword\x22=\x20\x27','__esModule','defineProperty','E-mail\x20enviado\x20com\x20sucesso','all','328254DFYmcW','companyId','error','SELECT','nodemailer','search','QueryTypes','Email\x20não\x20encontrado','12702569XHxFrU','1361610QRIitI','smtpauth','createTransport','UPDATE','toString','588320lfYFXw','4JvJbTK','28tLzceT','356776mLYLOo','sequelize','query','1220380Smryys','usersmtpauth','../../models/Setting','Redefinição\x20de\x20Senha','findOne','value'];a466_0xede7=function(){return _0x293351;};return a466_0xede7();}function a466_0x3ad3(_0x5b682c,_0x1492d0){const _0x5b80a8=a466_0xede7();return a466_0x3ad3=function(_0x235ae5,_0x236578){_0x235ae5=_0x235ae5-0x193;let _0xede78d=_0x5b80a8[_0x235ae5];return _0xede78d;},a466_0x3ad3(_0x5b682c,_0x1492d0);}exports[a466_0x3fccd7(0x19f)]=SendMail;