const a431_0x5a0680=a431_0x2679;(function(_0x3d1eb4,_0x3d18e0){const _0x5e54b3=a431_0x2679,_0x5d4983=_0x3d1eb4();while(!![]){try{const _0x35cedb=parseInt(_0x5e54b3(0x196))/0x1*(-parseInt(_0x5e54b3(0x18b))/0x2)+parseInt(_0x5e54b3(0x17f))/0x3+parseInt(_0x5e54b3(0x1a7))/0x4+-parseInt(_0x5e54b3(0x18d))/0x5*(-parseInt(_0x5e54b3(0x181))/0x6)+parseInt(_0x5e54b3(0x188))/0x7*(-parseInt(_0x5e54b3(0x1a5))/0x8)+-parseInt(_0x5e54b3(0x187))/0x9+parseInt(_0x5e54b3(0x19e))/0xa;if(_0x35cedb===_0x3d18e0)break;else _0x5d4983['push'](_0x5d4983['shift']());}catch(_0x1f9159){_0x5d4983['push'](_0x5d4983['shift']());}}}(a431_0x5bea,0xd25b4));const a431_0x6809cc=(function(){let _0x4816ab=!![];return function(_0x43eebd,_0x217dbd){const _0x1d09f8=_0x4816ab?function(){const _0x1dc1d8=a431_0x2679;if(_0x217dbd){const _0x430ee7=_0x217dbd[_0x1dc1d8(0x19c)](_0x43eebd,arguments);return _0x217dbd=null,_0x430ee7;}}:function(){};return _0x4816ab=![],_0x1d09f8;};}()),a431_0x5ce0e7=a431_0x6809cc(this,function(){const _0x50b269=a431_0x2679;return a431_0x5ce0e7[_0x50b269(0x186)]()[_0x50b269(0x180)]('(((.+)+)+)+$')[_0x50b269(0x186)]()[_0x50b269(0x19d)](a431_0x5ce0e7)['search'](_0x50b269(0x18c));});a431_0x5ce0e7();'use strict';function a431_0x5bea(){const _0x366c76=['12079170hneuAo','5298818WshjuG','QueryTypes','query','1654616JPhzOr','(((.+)+)+)+$','5JLsOAJ','Dados\x20do\x20usuário\x20não\x20encontrados','__esModule','nodemailer','Erro\x20interno\x20do\x20servidor','UPDATE\x20\x22Users\x22\x20SET\x20\x22resetPassword\x22=\x20\x27','SELECT','Configurações\x20SMTP\x20estão\x20incompletas','value','1ZPUDBk','../../database','clientsecretsmtpauth','error','findOne','UPDATE','apply','constructor','16023850wBBzpR','default','\x27\x20WHERE\x20email\x20=\x27','sendMail','SELECT\x20*\x20FROM\x20\x22Users\x22\x20WHERE\x20email\x20=\x27','Erro\x20ao\x20enviar\x20e-mail:','defineProperty','16jfkhtb','smtpauth','2606368gxBBdN','\x0a\x0aPor\x20favor,\x20copie\x20e\x20cole\x20o\x20Código\x20de\x20Verificação\x20no\x20campo\x20\x27Código\x20de\x20Verificação\x27.\x0a\x0aSe\x20você\x20não\x20solicitou\x20esta\x20redefinição\x20de\x20senha,\x20por\x20favor,\x20ignore\x20este\x20e-mail.\x0a\x0a\x0aAtenciosamente','length','3141072NHuEFD','search','7464030pyFpIu','Email\x20não\x20encontrado','E-mail\x20enviado\x20com\x20sucesso','__importDefault','Não\x20foi\x20possível\x20inserir\x20o\x20token\x20de\x20redefinição','toString'];a431_0x5bea=function(){return _0x366c76;};return a431_0x5bea();}var __importDefault=this&&this[a431_0x5a0680(0x184)]||function(_0x35ba51){const _0x5132ce=a431_0x5a0680;return _0x35ba51&&_0x35ba51[_0x5132ce(0x18f)]?_0x35ba51:{'default':_0x35ba51};};function a431_0x2679(_0x940bff,_0x406b83){const _0x418498=a431_0x5bea();return a431_0x2679=function(_0x5ce0e7,_0x6809cc){_0x5ce0e7=_0x5ce0e7-0x17e;let _0x5beadc=_0x418498[_0x5ce0e7];return _0x5beadc;},a431_0x2679(_0x940bff,_0x406b83);}Object[a431_0x5a0680(0x1a4)](exports,a431_0x5a0680(0x18f),{'value':!![]});const nodemailer_1=__importDefault(require(a431_0x5a0680(0x190))),sequelize_1=__importDefault(require('sequelize')),database_1=__importDefault(require(a431_0x5a0680(0x197))),Setting_1=__importDefault(require('../../models/Setting')),SendMail=async(_0x13e39a,_0x46ebfc)=>{const _0x3832ce=a431_0x5a0680;try{const _0x3c9c97=0x1,{hasResult:_0x300bfd,data:_0x6b3e71}=await filterEmail(_0x13e39a);if(!_0x300bfd)return{'status':0x194,'message':_0x3832ce(0x182)};const _0x66ff84=_0x6b3e71[0x0];if(!_0x66ff84||_0x66ff84['companyId']===undefined)return{'status':0x194,'message':_0x3832ce(0x18e)};const [_0x100251,_0x550212,_0x9792c2,_0x83a2a0]=await Promise['all']([Setting_1[_0x3832ce(0x19f)]['findOne']({'where':{'companyId':_0x3c9c97,'key':_0x3832ce(0x1a6)}}),Setting_1[_0x3832ce(0x19f)][_0x3832ce(0x19a)]({'where':{'companyId':_0x3c9c97,'key':'usersmtpauth'}}),Setting_1['default']['findOne']({'where':{'companyId':_0x3c9c97,'key':_0x3832ce(0x198)}}),Setting_1[_0x3832ce(0x19f)][_0x3832ce(0x19a)]({'where':{'companyId':_0x3c9c97,'key':'smtpport'}})]),_0x102c0e=_0x100251?.['value'],_0x40f16b=_0x550212?.[_0x3832ce(0x195)],_0x24e544=_0x9792c2?.[_0x3832ce(0x195)],_0x2e901c=_0x40f16b,_0x2088da=_0x83a2a0?.[_0x3832ce(0x195)];if(!_0x102c0e||!_0x40f16b||!_0x24e544||!_0x2088da)throw new Error(_0x3832ce(0x194));const _0x5c41ba=nodemailer_1[_0x3832ce(0x19f)]['createTransport']({'host':_0x102c0e,'port':Number(_0x2088da),'secure':![],'auth':{'user':_0x40f16b,'pass':_0x24e544}}),{hasResults:_0x4f6a7c}=await insertToken(_0x13e39a,_0x46ebfc);if(!_0x4f6a7c)return{'status':0x194,'message':_0x3832ce(0x185)};const _0x57c636={'from':_0x2e901c,'to':_0x13e39a,'subject':'Redefinição\x20de\x20Senha','text':'Olá,\x0a\x0aVocê\x20solicitou\x20a\x20redefinição\x20de\x20senha\x20para\x20sua\x20conta,\x20utilize\x20o\x20seguinte\x20Código\x20de\x20Verificação\x20para\x20concluir\x20o\x20processo\x20de\x20redefinição\x20de\x20senha:\x0a\x0aCódigo\x20de\x20Verificação:\x20'+_0x46ebfc+_0x3832ce(0x1a8)},_0x496de4=await _0x5c41ba[_0x3832ce(0x1a1)](_0x57c636);return{'status':0xc8,'message':_0x3832ce(0x183),'info':_0x496de4};}catch(_0x40a724){return console[_0x3832ce(0x199)](_0x3832ce(0x1a3),_0x40a724),{'status':0x1f4,'message':_0x3832ce(0x191)};}},filterEmail=async _0x5b090b=>{const _0x325f71=a431_0x5a0680,_0x35d9e9=_0x325f71(0x1a2)+_0x5b090b+'\x27',_0x3f3d89=await database_1['default'][_0x325f71(0x18a)](_0x35d9e9,{'type':sequelize_1[_0x325f71(0x19f)][_0x325f71(0x189)][_0x325f71(0x193)]});return{'hasResult':_0x3f3d89[_0x325f71(0x17e)]>0x0,'data':_0x3f3d89};},insertToken=async(_0x308c07,_0x3dfb6c)=>{const _0x1cb8a3=a431_0x5a0680,_0x4bd63f=_0x1cb8a3(0x192)+_0x3dfb6c+_0x1cb8a3(0x1a0)+_0x308c07+'\x27',_0x276677=await database_1[_0x1cb8a3(0x19f)][_0x1cb8a3(0x18a)](_0x4bd63f,{'type':sequelize_1['default'][_0x1cb8a3(0x189)][_0x1cb8a3(0x19b)]});return{'hasResults':_0x276677[0x1]>0x0,'datas':_0x276677};};exports[a431_0x5a0680(0x19f)]=SendMail;