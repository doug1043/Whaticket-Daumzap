const a481_0x53f1b4=a481_0xb0eb;function a481_0x7a71(){const _0x363ee2=['../../helpers/GetDefaultWhatsApp','default','remoteJid','mediaUrl','apply','5424216ojPXYR','whatsapp','length','2465130fqphIZ','userId','parse','../TicketServices/CreateTicketService','number','__importDefault','companyId','@g.us','../../utils/logger','ERR_NO_DEF_WAPP_FOUND','ERR_OTHER_OPEN_TICKET','verifyMediaMessage','416588naXbya','ERR_INVALID_CHANNEL','1190826iWjdCE','constructor','__esModule','search','../../errors/AppError','42070vQoezg','dataJson','../../libs/wbot','error','76FeOZSt','4945080sZwvsn','../WbotServices/VerifyHandlers','846363CdJpmj','toString','isGroup','contact','channel','getWbot','ERR_CREATING_TICKET','(((.+)+)+)+$','lid','ticket','s.whatsapp.net','ERR_SENDING_WAPP_MSG'];a481_0x7a71=function(){return _0x363ee2;};return a481_0x7a71();}(function(_0x469594,_0x3f19a9){const _0xfa3d6a=a481_0xb0eb,_0x3dd42b=_0x469594();while(!![]){try{const _0x2fbb43=parseInt(_0xfa3d6a(0x1ba))/0x1+parseInt(_0xfa3d6a(0x1da))/0x2+parseInt(_0xfa3d6a(0x1dc))/0x3+-parseInt(_0xfa3d6a(0x1b7))/0x4*(-parseInt(_0xfa3d6a(0x1e1))/0x5)+parseInt(_0xfa3d6a(0x1ce))/0x6+-parseInt(_0xfa3d6a(0x1b8))/0x7+-parseInt(_0xfa3d6a(0x1cb))/0x8;if(_0x2fbb43===_0x3f19a9)break;else _0x3dd42b['push'](_0x3dd42b['shift']());}catch(_0xf5614d){_0x3dd42b['push'](_0x3dd42b['shift']());}}}(a481_0x7a71,0x9bb9d));const a481_0x1553e2=(function(){let _0x22f34b=!![];return function(_0x22c01b,_0x4b593f){const _0x4d7ce7=_0x22f34b?function(){const _0x5e1909=a481_0xb0eb;if(_0x4b593f){const _0x5dfee7=_0x4b593f[_0x5e1909(0x1ca)](_0x22c01b,arguments);return _0x4b593f=null,_0x5dfee7;}}:function(){};return _0x22f34b=![],_0x4d7ce7;};}()),a481_0x5e991a=a481_0x1553e2(this,function(){const _0x394a1a=a481_0xb0eb;return a481_0x5e991a[_0x394a1a(0x1bb)]()[_0x394a1a(0x1df)](_0x394a1a(0x1c1))['toString']()[_0x394a1a(0x1dd)](a481_0x5e991a)[_0x394a1a(0x1df)](_0x394a1a(0x1c1));});a481_0x5e991a();'use strict';var __importDefault=this&&this[a481_0x53f1b4(0x1d3)]||function(_0x338113){const _0x204c1a=a481_0x53f1b4;return _0x338113&&_0x338113[_0x204c1a(0x1de)]?_0x338113:{'default':_0x338113};};Object['defineProperty'](exports,'__esModule',{'value':!![]});const logger_1=require(a481_0x53f1b4(0x1d6)),GetDefaultWhatsApp_1=__importDefault(require(a481_0x53f1b4(0x1c6))),AppError_1=__importDefault(require(a481_0x53f1b4(0x1e0))),wbot_1=require(a481_0x53f1b4(0x1e3)),VerifyHandlers_1=require(a481_0x53f1b4(0x1b9)),CheckContactOpenTickets_1=__importDefault(require('../../helpers/CheckContactOpenTickets')),CreateTicketService_1=__importDefault(require(a481_0x53f1b4(0x1d1))),ForwardMessageService=async(_0x4cfcfd,_0xc103c4,_0x517801,_0x463611)=>{const _0x36aaa0=a481_0x53f1b4,_0x4bdb2e=_0xc103c4[_0x36aaa0(0x1c3)][_0x36aaa0(0x1cc)]||await(0x0,GetDefaultWhatsApp_1['default'])(_0x517801['companyId']);if(!_0x4bdb2e)throw new AppError_1[(_0x36aaa0(0x1c7))](_0x36aaa0(0x1d7),0x194);if(_0x4bdb2e[_0x36aaa0(0x1be)]!==_0x36aaa0(0x1cc))throw new AppError_1[(_0x36aaa0(0x1c7))](_0x36aaa0(0x1db),0x190);let _0xed37f=await(0x0,CheckContactOpenTickets_1[_0x36aaa0(0x1c7)])(_0x517801['id'],_0x4bdb2e['id'],!![]);if(_0xed37f&&_0xed37f[_0x36aaa0(0x1cf)]!==_0x4cfcfd['id'])throw new AppError_1[(_0x36aaa0(0x1c7))](_0x36aaa0(0x1d8),0x190);!_0xed37f&&(_0xed37f=await(0x0,CreateTicketService_1[_0x36aaa0(0x1c7)])({'contactId':_0x517801['id'],'userId':_0x4cfcfd['id'],'companyId':_0x517801[_0x36aaa0(0x1d4)],'queueId':_0x463611?.['id']}));if(!_0xed37f)throw new AppError_1[(_0x36aaa0(0x1c7))](_0x36aaa0(0x1c0),0x1f4);if(_0x4bdb2e[_0x36aaa0(0x1be)]===_0x36aaa0(0x1cc))try{const _0x71caf0=(0x0,wbot_1[_0x36aaa0(0x1bf)])(_0x4bdb2e['id']),_0x5aafa2=JSON[_0x36aaa0(0x1d0)](_0xc103c4[_0x36aaa0(0x1e2)]),_0x882bcc=_0x517801[_0x36aaa0(0x1bc)]?_0x517801[_0x36aaa0(0x1d2)]+_0x36aaa0(0x1d5):_0x517801[_0x36aaa0(0x1c8)]||_0x517801[_0x36aaa0(0x1d2)]+'@'+(_0x517801[_0x36aaa0(0x1d2)][_0x36aaa0(0x1cd)]>0xd?_0x36aaa0(0x1c2):_0x36aaa0(0x1c4)),_0x1778e1=await _0x71caf0['sendMessage'](_0x882bcc,{'forward':_0x5aafa2}),_0x5cff87=_0xc103c4[_0x36aaa0(0x1c9)]?await(0x0,VerifyHandlers_1[_0x36aaa0(0x1d9)])(_0x1778e1,_0xed37f,_0xed37f[_0x36aaa0(0x1bd)],_0x71caf0,null,_0x4cfcfd['id']):await(0x0,VerifyHandlers_1['verifyMessage'])(_0x1778e1,_0xed37f,_0xed37f['contact'],_0x4cfcfd['id']);return _0x5cff87;}catch(_0x2cd133){logger_1['logger'][_0x36aaa0(0x1e4)](_0x2cd133);throw new AppError_1[(_0x36aaa0(0x1c7))](_0x36aaa0(0x1c5),0x1f4);}return null;};function a481_0xb0eb(_0x346137,_0x16da31){const _0x54535c=a481_0x7a71();return a481_0xb0eb=function(_0x5e991a,_0x1553e2){_0x5e991a=_0x5e991a-0x1b7;let _0x7a71ef=_0x54535c[_0x5e991a];return _0x7a71ef;},a481_0xb0eb(_0x346137,_0x16da31);}exports[a481_0x53f1b4(0x1c7)]=ForwardMessageService;