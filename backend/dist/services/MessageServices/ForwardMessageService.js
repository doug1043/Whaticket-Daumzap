const a480_0x505b26=a480_0x1813;(function(_0x221b4e,_0x207f54){const _0x1e75d3=a480_0x1813,_0x39e441=_0x221b4e();while(!![]){try{const _0x22441c=parseInt(_0x1e75d3(0x157))/0x1*(parseInt(_0x1e75d3(0x146))/0x2)+parseInt(_0x1e75d3(0x163))/0x3+-parseInt(_0x1e75d3(0x142))/0x4+-parseInt(_0x1e75d3(0x14b))/0x5+parseInt(_0x1e75d3(0x162))/0x6+parseInt(_0x1e75d3(0x15b))/0x7+-parseInt(_0x1e75d3(0x14e))/0x8*(parseInt(_0x1e75d3(0x140))/0x9);if(_0x22441c===_0x207f54)break;else _0x39e441['push'](_0x39e441['shift']());}catch(_0x49859b){_0x39e441['push'](_0x39e441['shift']());}}}(a480_0x5b04,0xe7647));const a480_0x2effd0=(function(){let _0x156070=!![];return function(_0x51d9a7,_0x4e5fce){const _0x40bd04=_0x156070?function(){const _0x309106=a480_0x1813;if(_0x4e5fce){const _0x593e1f=_0x4e5fce[_0x309106(0x14f)](_0x51d9a7,arguments);return _0x4e5fce=null,_0x593e1f;}}:function(){};return _0x156070=![],_0x40bd04;};}()),a480_0x2ee7c8=a480_0x2effd0(this,function(){const _0xbad983=a480_0x1813;return a480_0x2ee7c8[_0xbad983(0x14d)]()[_0xbad983(0x15d)](_0xbad983(0x13e))[_0xbad983(0x14d)]()['constructor'](a480_0x2ee7c8)[_0xbad983(0x15d)]('(((.+)+)+)+$');});a480_0x2ee7c8();function a480_0x1813(_0x2fd709,_0x37252d){const _0x26a939=a480_0x5b04();return a480_0x1813=function(_0x2ee7c8,_0x2effd0){_0x2ee7c8=_0x2ee7c8-0x13e;let _0x5b04f6=_0x26a939[_0x2ee7c8];return _0x5b04f6;},a480_0x1813(_0x2fd709,_0x37252d);}'use strict';function a480_0x5b04(){const _0x42a531=['ERR_OTHER_OPEN_TICKET','(((.+)+)+)+$','../WbotServices/VerifyHandlers','3879ITqxxn','sendMessage','1221912zwHjor','number','defineProperty','userId','22WTVfJW','companyId','contact','parse','__importDefault','7125745zmCoUP','logger','toString','8344sadPqH','apply','../../helpers/GetDefaultWhatsApp','ERR_NO_DEF_WAPP_FOUND','getWbot','length','error','../../utils/logger','../../libs/wbot','127412rLTLgO','default','ticket','ERR_SENDING_WAPP_MSG','6999916EezFSb','channel','search','whatsapp','../../helpers/CheckContactOpenTickets','__esModule','remoteJid','4089660eenxBL','134439MrlBeu'];a480_0x5b04=function(){return _0x42a531;};return a480_0x5b04();}var __importDefault=this&&this[a480_0x505b26(0x14a)]||function(_0x308cfb){return _0x308cfb&&_0x308cfb['__esModule']?_0x308cfb:{'default':_0x308cfb};};Object[a480_0x505b26(0x144)](exports,a480_0x505b26(0x160),{'value':!![]});const logger_1=require(a480_0x505b26(0x155)),GetDefaultWhatsApp_1=__importDefault(require(a480_0x505b26(0x150))),AppError_1=__importDefault(require('../../errors/AppError')),wbot_1=require(a480_0x505b26(0x156)),VerifyHandlers_1=require(a480_0x505b26(0x13f)),CheckContactOpenTickets_1=__importDefault(require(a480_0x505b26(0x15f))),CreateTicketService_1=__importDefault(require('../TicketServices/CreateTicketService')),ForwardMessageService=async(_0x1e1a62,_0x9e70eb,_0x1306e8,_0x29ceb3)=>{const _0x4b4e0d=a480_0x505b26,_0x1d10b4=_0x9e70eb[_0x4b4e0d(0x159)][_0x4b4e0d(0x15e)]||await(0x0,GetDefaultWhatsApp_1[_0x4b4e0d(0x158)])(_0x1306e8[_0x4b4e0d(0x147)]);if(!_0x1d10b4)throw new AppError_1[(_0x4b4e0d(0x158))](_0x4b4e0d(0x151),0x194);if(_0x1d10b4['channel']!=='whatsapp')throw new AppError_1[(_0x4b4e0d(0x158))]('ERR_INVALID_CHANNEL',0x190);let _0x1a9566=await(0x0,CheckContactOpenTickets_1[_0x4b4e0d(0x158)])(_0x1306e8['id'],_0x1d10b4['id'],!![]);if(_0x1a9566&&_0x1a9566[_0x4b4e0d(0x145)]!==_0x1e1a62['id'])throw new AppError_1[(_0x4b4e0d(0x158))](_0x4b4e0d(0x164),0x190);!_0x1a9566&&(_0x1a9566=await(0x0,CreateTicketService_1[_0x4b4e0d(0x158)])({'contactId':_0x1306e8['id'],'userId':_0x1e1a62['id'],'companyId':_0x1306e8[_0x4b4e0d(0x147)],'queueId':_0x29ceb3?.['id']}));if(!_0x1a9566)throw new AppError_1[(_0x4b4e0d(0x158))]('ERR_CREATING_TICKET',0x1f4);if(_0x1d10b4[_0x4b4e0d(0x15c)]==='whatsapp')try{const _0x105719=(0x0,wbot_1[_0x4b4e0d(0x152)])(_0x1d10b4['id']),_0xa24598=JSON[_0x4b4e0d(0x149)](_0x9e70eb['dataJson']),_0x2ff87f=_0x1306e8['isGroup']?_0x1306e8[_0x4b4e0d(0x143)]+'@g.us':_0x1306e8[_0x4b4e0d(0x161)]||_0x1306e8[_0x4b4e0d(0x143)]+'@'+(_0x1306e8[_0x4b4e0d(0x143)][_0x4b4e0d(0x153)]>0xd?'lid':'s.whatsapp.net'),_0x5976ea=await _0x105719[_0x4b4e0d(0x141)](_0x2ff87f,{'forward':_0xa24598}),_0x1cc578=_0x9e70eb['mediaUrl']?await(0x0,VerifyHandlers_1['verifyMediaMessage'])(_0x5976ea,_0x1a9566,_0x1a9566[_0x4b4e0d(0x148)],_0x105719,null,_0x1e1a62['id']):await(0x0,VerifyHandlers_1['verifyMessage'])(_0x5976ea,_0x1a9566,_0x1a9566[_0x4b4e0d(0x148)],_0x1e1a62['id']);return _0x1cc578;}catch(_0x22894e){logger_1[_0x4b4e0d(0x14c)][_0x4b4e0d(0x154)](_0x22894e);throw new AppError_1[(_0x4b4e0d(0x158))](_0x4b4e0d(0x15a),0x1f4);}return null;};exports['default']=ForwardMessageService;