const a582_0x29c3e8=a582_0x5884;(function(_0x26e6b0,_0x1c1233){const _0x4a3829=a582_0x5884,_0x367d6e=_0x26e6b0();while(!![]){try{const _0xaad7d9=parseInt(_0x4a3829(0x156))/0x1*(parseInt(_0x4a3829(0x135))/0x2)+parseInt(_0x4a3829(0x12c))/0x3+-parseInt(_0x4a3829(0x132))/0x4+-parseInt(_0x4a3829(0x13c))/0x5+-parseInt(_0x4a3829(0x158))/0x6+parseInt(_0x4a3829(0x147))/0x7+parseInt(_0x4a3829(0x12a))/0x8*(parseInt(_0x4a3829(0x14c))/0x9);if(_0xaad7d9===_0x1c1233)break;else _0x367d6e['push'](_0x367d6e['shift']());}catch(_0x36d7d4){_0x367d6e['push'](_0x367d6e['shift']());}}}(a582_0x3fb2,0x81902));const a582_0x2accdd=(function(){let _0x3ba3ba=!![];return function(_0x4e65de,_0x27bf2f){const _0x2b519e=_0x3ba3ba?function(){const _0x36d58d=a582_0x5884;if(_0x27bf2f){const _0x304737=_0x27bf2f[_0x36d58d(0x14b)](_0x4e65de,arguments);return _0x27bf2f=null,_0x304737;}}:function(){};return _0x3ba3ba=![],_0x2b519e;};}()),a582_0x3f2700=a582_0x2accdd(this,function(){const _0x4b6f6f=a582_0x5884;return a582_0x3f2700[_0x4b6f6f(0x152)]()[_0x4b6f6f(0x13b)]('(((.+)+)+)+$')[_0x4b6f6f(0x152)]()[_0x4b6f6f(0x12e)](a582_0x3f2700)[_0x4b6f6f(0x13b)](_0x4b6f6f(0x145));});function a582_0x3fb2(){const _0xd43ff3=['2733960dbetZt','../../utils/logger','constructor','verifyMessage','contact','remoteJid','3393292DTtHMc','parse','userId','190902wmPfrt','s.whatsapp.net','logger','lid','ERR_INVALID_CHANNEL','__importDefault','search','3712845NcEZWj','whatsapp','mediaUrl','number','length','../../errors/AppError','ERR_SENDING_WAPP_MSG','ERR_OTHER_OPEN_TICKET','default','(((.+)+)+)+$','dataJson','5517925phqGus','ERR_CREATING_TICKET','sendMessage','ERR_NO_DEF_WAPP_FOUND','apply','9oKkgIf','../../helpers/GetDefaultWhatsApp','channel','__esModule','error','../WbotServices/VerifyHandlers','toString','defineProperty','companyId','ticket','3AMvZWS','../../libs/wbot','428370PpjfXS','../TicketServices/CreateTicketService','1656232lbmSyG','verifyMediaMessage'];a582_0x3fb2=function(){return _0xd43ff3;};return a582_0x3fb2();}a582_0x3f2700();'use strict';var __importDefault=this&&this[a582_0x29c3e8(0x13a)]||function(_0x384e7e){const _0x4ebd07=a582_0x29c3e8;return _0x384e7e&&_0x384e7e[_0x4ebd07(0x14f)]?_0x384e7e:{'default':_0x384e7e};};Object[a582_0x29c3e8(0x153)](exports,a582_0x29c3e8(0x14f),{'value':!![]});const logger_1=require(a582_0x29c3e8(0x12d)),GetDefaultWhatsApp_1=__importDefault(require(a582_0x29c3e8(0x14d))),AppError_1=__importDefault(require(a582_0x29c3e8(0x141))),wbot_1=require(a582_0x29c3e8(0x157)),VerifyHandlers_1=require(a582_0x29c3e8(0x151)),CheckContactOpenTickets_1=__importDefault(require('../../helpers/CheckContactOpenTickets')),CreateTicketService_1=__importDefault(require(a582_0x29c3e8(0x159))),ForwardMessageService=async(_0x138cf5,_0x31e15f,_0x46e222,_0x54c33a)=>{const _0x4f438e=a582_0x29c3e8,_0x3ed58b=_0x31e15f[_0x4f438e(0x155)][_0x4f438e(0x13d)]||await(0x0,GetDefaultWhatsApp_1[_0x4f438e(0x144)])(_0x46e222[_0x4f438e(0x154)]);if(!_0x3ed58b)throw new AppError_1['default'](_0x4f438e(0x14a),0x194);if(_0x3ed58b[_0x4f438e(0x14e)]!==_0x4f438e(0x13d))throw new AppError_1[(_0x4f438e(0x144))](_0x4f438e(0x139),0x190);let _0x2f2b5b=await(0x0,CheckContactOpenTickets_1[_0x4f438e(0x144)])(_0x46e222['id'],_0x3ed58b['id'],!![]);if(_0x2f2b5b&&_0x2f2b5b[_0x4f438e(0x134)]!==_0x138cf5['id'])throw new AppError_1[(_0x4f438e(0x144))](_0x4f438e(0x143),0x190);!_0x2f2b5b&&(_0x2f2b5b=await(0x0,CreateTicketService_1['default'])({'contactId':_0x46e222['id'],'userId':_0x138cf5['id'],'companyId':_0x46e222[_0x4f438e(0x154)],'queueId':_0x54c33a?.['id']}));if(!_0x2f2b5b)throw new AppError_1['default'](_0x4f438e(0x148),0x1f4);if(_0x3ed58b[_0x4f438e(0x14e)]==='whatsapp')try{const _0x8eaaf6=(0x0,wbot_1['getWbot'])(_0x3ed58b['id']),_0x2dce52=JSON[_0x4f438e(0x133)](_0x31e15f[_0x4f438e(0x146)]),_0x11913e=_0x46e222['isGroup']?_0x46e222[_0x4f438e(0x13f)]+'@g.us':_0x46e222[_0x4f438e(0x131)]||_0x46e222[_0x4f438e(0x13f)]+'@'+(_0x46e222['number'][_0x4f438e(0x140)]>0xd?_0x4f438e(0x138):_0x4f438e(0x136)),_0x5e5d77=await _0x8eaaf6[_0x4f438e(0x149)](_0x11913e,{'forward':_0x2dce52}),_0x436bac=_0x31e15f[_0x4f438e(0x13e)]?await(0x0,VerifyHandlers_1[_0x4f438e(0x12b)])(_0x5e5d77,_0x2f2b5b,_0x2f2b5b[_0x4f438e(0x130)],_0x8eaaf6,null,_0x138cf5['id']):await(0x0,VerifyHandlers_1[_0x4f438e(0x12f)])(_0x5e5d77,_0x2f2b5b,_0x2f2b5b['contact'],_0x138cf5['id']);return _0x436bac;}catch(_0x10f2ab){logger_1[_0x4f438e(0x137)][_0x4f438e(0x150)](_0x10f2ab);throw new AppError_1['default'](_0x4f438e(0x142),0x1f4);}return null;};function a582_0x5884(_0x453aea,_0x4890a5){const _0x4ae95b=a582_0x3fb2();return a582_0x5884=function(_0x3f2700,_0x2accdd){_0x3f2700=_0x3f2700-0x12a;let _0x3fb211=_0x4ae95b[_0x3f2700];return _0x3fb211;},a582_0x5884(_0x453aea,_0x4890a5);}exports[a582_0x29c3e8(0x144)]=ForwardMessageService;