const a475_0x299ea2=a475_0xf194;(function(_0x17d825,_0x37dd42){const _0x593073=a475_0xf194,_0x1df26f=_0x17d825();while(!![]){try{const _0x597b78=parseInt(_0x593073(0x1a5))/0x1+-parseInt(_0x593073(0x1a1))/0x2+parseInt(_0x593073(0x19e))/0x3*(-parseInt(_0x593073(0x1ac))/0x4)+parseInt(_0x593073(0x1ab))/0x5+-parseInt(_0x593073(0x19c))/0x6+-parseInt(_0x593073(0x1aa))/0x7*(-parseInt(_0x593073(0x1a2))/0x8)+parseInt(_0x593073(0x19f))/0x9;if(_0x597b78===_0x37dd42)break;else _0x1df26f['push'](_0x1df26f['shift']());}catch(_0x42f488){_0x1df26f['push'](_0x1df26f['shift']());}}}(a475_0x3029,0xbc281));function a475_0xf194(_0x484c3a,_0x2bbf38){const _0x5525ec=a475_0x3029();return a475_0xf194=function(_0x4d31bd,_0x2979dd){_0x4d31bd=_0x4d31bd-0x19b;let _0x302983=_0x5525ec[_0x4d31bd];return _0x302983;},a475_0xf194(_0x484c3a,_0x2bbf38);}const a475_0x2979dd=(function(){let _0x263e7c=!![];return function(_0x5ac63b,_0x49f207){const _0x28fb6a=_0x263e7c?function(){const _0x230c61=a475_0xf194;if(_0x49f207){const _0x375684=_0x49f207[_0x230c61(0x1ae)](_0x5ac63b,arguments);return _0x49f207=null,_0x375684;}}:function(){};return _0x263e7c=![],_0x28fb6a;};}()),a475_0x4d31bd=a475_0x2979dd(this,function(){const _0x38dfb8=a475_0xf194;return a475_0x4d31bd['toString']()[_0x38dfb8(0x1b1)]('(((.+)+)+)+$')[_0x38dfb8(0x1c0)]()['constructor'](a475_0x4d31bd)[_0x38dfb8(0x1b1)](_0x38dfb8(0x1a6));});a475_0x4d31bd();'use strict';var __importDefault=this&&this[a475_0x299ea2(0x1bd)]||function(_0x2e9daf){const _0x526939=a475_0x299ea2;return _0x2e9daf&&_0x2e9daf[_0x526939(0x1a3)]?_0x2e9daf:{'default':_0x2e9daf};};Object['defineProperty'](exports,a475_0x299ea2(0x1a3),{'value':!![]});const logger_1=require('../../utils/logger'),GetDefaultWhatsApp_1=__importDefault(require('../../helpers/GetDefaultWhatsApp')),AppError_1=__importDefault(require('../../errors/AppError')),wbot_1=require(a475_0x299ea2(0x1bc)),VerifyHandlers_1=require('../WbotServices/VerifyHandlers'),CheckContactOpenTickets_1=__importDefault(require(a475_0x299ea2(0x1b7))),CreateTicketService_1=__importDefault(require(a475_0x299ea2(0x1ba))),ForwardMessageService=async(_0x5c1836,_0x12f48e,_0x2f0f24,_0xbaede6)=>{const _0xfbaf54=a475_0x299ea2,_0x18deef=_0x12f48e['ticket'][_0xfbaf54(0x1af)]||await(0x0,GetDefaultWhatsApp_1[_0xfbaf54(0x1ad)])(_0x2f0f24[_0xfbaf54(0x1b3)]);if(!_0x18deef)throw new AppError_1[(_0xfbaf54(0x1ad))](_0xfbaf54(0x19d),0x194);if(_0x18deef['channel']!==_0xfbaf54(0x1af))throw new AppError_1[(_0xfbaf54(0x1ad))](_0xfbaf54(0x1b6),0x190);let _0x4dfdda=await(0x0,CheckContactOpenTickets_1['default'])(_0x2f0f24['id'],_0x18deef['id'],!![]);if(_0x4dfdda&&_0x4dfdda[_0xfbaf54(0x1b4)]!==_0x5c1836['id'])throw new AppError_1[(_0xfbaf54(0x1ad))](_0xfbaf54(0x1a0),0x190);!_0x4dfdda&&(_0x4dfdda=await(0x0,CreateTicketService_1[_0xfbaf54(0x1ad)])({'contactId':_0x2f0f24['id'],'userId':_0x5c1836['id'],'companyId':_0x2f0f24[_0xfbaf54(0x1b3)],'queueId':_0xbaede6?.['id']}));if(!_0x4dfdda)throw new AppError_1[(_0xfbaf54(0x1ad))]('ERR_CREATING_TICKET',0x1f4);if(_0x18deef['channel']==='whatsapp')try{const _0x3ca9e6=(0x0,wbot_1[_0xfbaf54(0x1bf)])(_0x18deef['id']),_0x1b22ee=JSON['parse'](_0x12f48e[_0xfbaf54(0x1b2)]),_0xde88d9=_0x2f0f24[_0xfbaf54(0x1b9)]?_0x2f0f24[_0xfbaf54(0x1b5)]+_0xfbaf54(0x1a9):_0x2f0f24[_0xfbaf54(0x1b5)]+_0xfbaf54(0x1a8),_0x384421=await _0x3ca9e6[_0xfbaf54(0x1be)](_0xde88d9,{'forward':_0x1b22ee}),_0x3d9565=_0x12f48e[_0xfbaf54(0x1bb)]?await(0x0,VerifyHandlers_1[_0xfbaf54(0x1a4)])(_0x384421,_0x4dfdda,_0x4dfdda[_0xfbaf54(0x19b)],_0x3ca9e6,null,_0x5c1836['id']):await(0x0,VerifyHandlers_1[_0xfbaf54(0x1b0)])(_0x384421,_0x4dfdda,_0x4dfdda['contact'],_0x5c1836['id']);return _0x3d9565;}catch(_0x558bfc){logger_1[_0xfbaf54(0x1b8)][_0xfbaf54(0x1a7)](_0x558bfc);throw new AppError_1[(_0xfbaf54(0x1ad))]('ERR_SENDING_WAPP_MSG',0x1f4);}return null;};function a475_0x3029(){const _0x472522=['sendMessage','getWbot','toString','contact','6750774CbujXr','ERR_NO_DEF_WAPP_FOUND','164037znNJWN','4538907LpEZCD','ERR_OTHER_OPEN_TICKET','260850LskOBv','264sqRWvF','__esModule','verifyMediaMessage','1190791iAsYJg','(((.+)+)+)+$','error','@s.whatsapp.net','@g.us','100807RRoiPj','646455HiLwvF','20zlOuqe','default','apply','whatsapp','verifyMessage','search','dataJson','companyId','userId','number','ERR_INVALID_CHANNEL','../../helpers/CheckContactOpenTickets','logger','isGroup','../TicketServices/CreateTicketService','mediaUrl','../../libs/wbot','__importDefault'];a475_0x3029=function(){return _0x472522;};return a475_0x3029();}exports['default']=ForwardMessageService;