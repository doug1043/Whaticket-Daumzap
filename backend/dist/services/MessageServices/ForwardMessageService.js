function a471_0x1fba(){const _0x500475=['ERR_OTHER_OPEN_TICKET','15254wZSibW','whatsapp','error','__esModule','channel','ticket','../../libs/wbot','contact','dataJson','5882371kFZXFg','../TicketServices/CreateTicketService','default','number','1067160KNNkpm','../../helpers/CheckContactOpenTickets','search','sendMessage','3EwQMtZ','mediaUrl','ERR_INVALID_CHANNEL','7yIbxzH','verifyMediaMessage','451890MvzNIj','ERR_NO_DEF_WAPP_FOUND','61ipPxyW','../../errors/AppError','18phbNIC','logger','parse','apply','toString','defineProperty','(((.+)+)+)+$','2957520PTtvCB','ERR_CREATING_TICKET','1018648PCChsh','__importDefault','4939990fArPDD','userId','@g.us'];a471_0x1fba=function(){return _0x500475;};return a471_0x1fba();}const a471_0x16f35a=a471_0x4c95;(function(_0x58aa2a,_0x366392){const _0x75a17d=a471_0x4c95,_0x5b5e01=_0x58aa2a();while(!![]){try{const _0x1893d0=-parseInt(_0x75a17d(0x14a))/0x1*(parseInt(_0x75a17d(0x132))/0x2)+-parseInt(_0x75a17d(0x143))/0x3*(-parseInt(_0x75a17d(0x12a))/0x4)+parseInt(_0x75a17d(0x148))/0x5+parseInt(_0x75a17d(0x13f))/0x6*(-parseInt(_0x75a17d(0x146))/0x7)+parseInt(_0x75a17d(0x12c))/0x8*(parseInt(_0x75a17d(0x14c))/0x9)+parseInt(_0x75a17d(0x12e))/0xa+-parseInt(_0x75a17d(0x13b))/0xb;if(_0x1893d0===_0x366392)break;else _0x5b5e01['push'](_0x5b5e01['shift']());}catch(_0x1bc59d){_0x5b5e01['push'](_0x5b5e01['shift']());}}}(a471_0x1fba,0x61ca7));function a471_0x4c95(_0xa00105,_0x16bf4b){const _0x1ef68e=a471_0x1fba();return a471_0x4c95=function(_0x13ac48,_0x23bbfb){_0x13ac48=_0x13ac48-0x12a;let _0x1fbae2=_0x1ef68e[_0x13ac48];return _0x1fbae2;},a471_0x4c95(_0xa00105,_0x16bf4b);}const a471_0x23bbfb=(function(){let _0x118067=!![];return function(_0x302918,_0x48427a){const _0x3af676=_0x118067?function(){const _0x5bb9b6=a471_0x4c95;if(_0x48427a){const _0x27c39f=_0x48427a[_0x5bb9b6(0x14f)](_0x302918,arguments);return _0x48427a=null,_0x27c39f;}}:function(){};return _0x118067=![],_0x3af676;};}()),a471_0x13ac48=a471_0x23bbfb(this,function(){const _0x17c7b0=a471_0x4c95;return a471_0x13ac48[_0x17c7b0(0x150)]()[_0x17c7b0(0x141)](_0x17c7b0(0x152))['toString']()['constructor'](a471_0x13ac48)[_0x17c7b0(0x141)]('(((.+)+)+)+$');});a471_0x13ac48();'use strict';var __importDefault=this&&this[a471_0x16f35a(0x12d)]||function(_0xb2aed6){return _0xb2aed6&&_0xb2aed6['__esModule']?_0xb2aed6:{'default':_0xb2aed6};};Object[a471_0x16f35a(0x151)](exports,a471_0x16f35a(0x135),{'value':!![]});const logger_1=require('../../utils/logger'),GetDefaultWhatsApp_1=__importDefault(require('../../helpers/GetDefaultWhatsApp')),AppError_1=__importDefault(require(a471_0x16f35a(0x14b))),wbot_1=require(a471_0x16f35a(0x138)),VerifyHandlers_1=require('../WbotServices/VerifyHandlers'),CheckContactOpenTickets_1=__importDefault(require(a471_0x16f35a(0x140))),CreateTicketService_1=__importDefault(require(a471_0x16f35a(0x13c))),ForwardMessageService=async(_0x27fea3,_0x53d316,_0xb82b40,_0x11041d)=>{const _0x1acb66=a471_0x16f35a,_0x5795b6=_0x53d316[_0x1acb66(0x137)][_0x1acb66(0x133)]||await(0x0,GetDefaultWhatsApp_1[_0x1acb66(0x13d)])(_0xb82b40['companyId']);if(!_0x5795b6)throw new AppError_1['default'](_0x1acb66(0x149),0x194);if(_0x5795b6[_0x1acb66(0x136)]!==_0x1acb66(0x133))throw new AppError_1[(_0x1acb66(0x13d))](_0x1acb66(0x145),0x190);let _0xc8a553=await(0x0,CheckContactOpenTickets_1[_0x1acb66(0x13d)])(_0xb82b40['id'],_0x5795b6['id'],!![]);if(_0xc8a553&&_0xc8a553[_0x1acb66(0x12f)]!==_0x27fea3['id'])throw new AppError_1[(_0x1acb66(0x13d))](_0x1acb66(0x131),0x190);!_0xc8a553&&(_0xc8a553=await(0x0,CreateTicketService_1[_0x1acb66(0x13d)])({'contactId':_0xb82b40['id'],'userId':_0x27fea3['id'],'companyId':_0xb82b40['companyId'],'queueId':_0x11041d?.['id']}));if(!_0xc8a553)throw new AppError_1[(_0x1acb66(0x13d))](_0x1acb66(0x12b),0x1f4);if(_0x5795b6[_0x1acb66(0x136)]===_0x1acb66(0x133))try{const _0x4fb952=(0x0,wbot_1['getWbot'])(_0x5795b6['id']),_0x1d53cc=JSON[_0x1acb66(0x14e)](_0x53d316[_0x1acb66(0x13a)]),_0x22ab83=_0xb82b40['isGroup']?_0xb82b40['number']+_0x1acb66(0x130):_0xb82b40[_0x1acb66(0x13e)]+'@s.whatsapp.net',_0x33a21e=await _0x4fb952[_0x1acb66(0x142)](_0x22ab83,{'forward':_0x1d53cc}),_0x32bdd3=_0x53d316[_0x1acb66(0x144)]?await(0x0,VerifyHandlers_1[_0x1acb66(0x147)])(_0x33a21e,_0xc8a553,_0xc8a553[_0x1acb66(0x139)],_0x4fb952,null,_0x27fea3['id']):await(0x0,VerifyHandlers_1['verifyMessage'])(_0x33a21e,_0xc8a553,_0xc8a553[_0x1acb66(0x139)],_0x27fea3['id']);return _0x32bdd3;}catch(_0x5eac83){logger_1[_0x1acb66(0x14d)][_0x1acb66(0x134)](_0x5eac83);throw new AppError_1[(_0x1acb66(0x13d))]('ERR_SENDING_WAPP_MSG',0x1f4);}return null;};exports[a471_0x16f35a(0x13d)]=ForwardMessageService;