const a444_0xe01cbb=a444_0x4b9d;function a444_0x4b9d(_0x39219b,_0x4cc5a3){const _0x4b355c=a444_0x2cde();return a444_0x4b9d=function(_0x4efd95,_0xed4847){_0x4efd95=_0x4efd95-0x12b;let _0x2cde21=_0x4b355c[_0x4efd95];return _0x2cde21;},a444_0x4b9d(_0x39219b,_0x4cc5a3);}(function(_0x9ff39,_0x5b6d21){const _0x25da52=a444_0x4b9d,_0x4cb776=_0x9ff39();while(!![]){try{const _0x59831f=-parseInt(_0x25da52(0x13a))/0x1+parseInt(_0x25da52(0x12b))/0x2+parseInt(_0x25da52(0x155))/0x3*(parseInt(_0x25da52(0x136))/0x4)+-parseInt(_0x25da52(0x137))/0x5+-parseInt(_0x25da52(0x153))/0x6+-parseInt(_0x25da52(0x13f))/0x7*(parseInt(_0x25da52(0x130))/0x8)+parseInt(_0x25da52(0x14f))/0x9;if(_0x59831f===_0x5b6d21)break;else _0x4cb776['push'](_0x4cb776['shift']());}catch(_0x26a9e0){_0x4cb776['push'](_0x4cb776['shift']());}}}(a444_0x2cde,0x32343));const a444_0xed4847=(function(){let _0x4a2dcf=!![];return function(_0x5908d1,_0x51e008){const _0x39d1fd=_0x4a2dcf?function(){const _0xea8a1f=a444_0x4b9d;if(_0x51e008){const _0x5a3e09=_0x51e008[_0xea8a1f(0x135)](_0x5908d1,arguments);return _0x51e008=null,_0x5a3e09;}}:function(){};return _0x4a2dcf=![],_0x39d1fd;};}()),a444_0x4efd95=a444_0xed4847(this,function(){const _0x278767=a444_0x4b9d;return a444_0x4efd95['toString']()[_0x278767(0x138)](_0x278767(0x12c))[_0x278767(0x145)]()['constructor'](a444_0x4efd95)['search'](_0x278767(0x12c));});a444_0x4efd95();'use strict';var __importDefault=this&&this[a444_0xe01cbb(0x12d)]||function(_0x147639){const _0x12fcab=a444_0xe01cbb;return _0x147639&&_0x147639[_0x12fcab(0x148)]?_0x147639:{'default':_0x147639};};Object[a444_0xe01cbb(0x151)](exports,'__esModule',{'value':!![]});function a444_0x2cde(){const _0x4dacc1=['1973365PvXuoB','search','ERR_CREATING_MESSAGE','31988wrZFVk','../../libs/socket','whatsapp','queueId','update','20041UzsVtW','-notification','../../models/Message','emit','-mainchannel','findByPk','toString','quotedMsg','queue','__esModule','available','company-','reload','-appMessage','status','default','4289139jnhvfN','upsert','defineProperty','queue-','633966hWQrlF','contact','13437sIMBpX','780188kndYnh','(((.+)+)+)+$','__importDefault','../../models/Ticket','oldMessages','1048ScfNIy','ticketId','getIO','ticket','create','apply','220oSZXqW'];a444_0x2cde=function(){return _0x4dacc1;};return a444_0x2cde();}const socket_1=require(a444_0xe01cbb(0x13b)),Message_1=__importDefault(require(a444_0xe01cbb(0x141))),Ticket_1=__importDefault(require(a444_0xe01cbb(0x12e))),OldMessage_1=__importDefault(require('../../models/OldMessage')),CreateMessageService=async({messageData:_0x3cf697,ticket:_0x1622f2,companyId:_0x8df3b1})=>{const _0x4fcc16=a444_0xe01cbb;await Message_1[_0x4fcc16(0x14e)][_0x4fcc16(0x150)]({..._0x3cf697,'companyId':_0x8df3b1});const _0x5c4479=await Message_1[_0x4fcc16(0x14e)][_0x4fcc16(0x144)](_0x3cf697['id'],{'include':[_0x4fcc16(0x154),{'model':Ticket_1['default'],'as':_0x4fcc16(0x133),'include':['contact',_0x4fcc16(0x147),_0x4fcc16(0x13c)]},{'model':Message_1[_0x4fcc16(0x14e)],'as':_0x4fcc16(0x146),'include':[_0x4fcc16(0x154)]},{'model':OldMessage_1[_0x4fcc16(0x14e)],'as':_0x4fcc16(0x12f)}]});if(_0x1622f2[_0x4fcc16(0x154)])await _0x1622f2['contact'][_0x4fcc16(0x13e)]({'presence':_0x4fcc16(0x149)}),await _0x1622f2['contact'][_0x4fcc16(0x14b)](),_0x1622f2[_0x4fcc16(0x13d)]!==null&&_0x5c4479[_0x4fcc16(0x13d)]===null&&await _0x5c4479['update']({'queueId':_0x1622f2[_0x4fcc16(0x13d)]});else throw new Error(_0x4fcc16(0x139));if(!_0x5c4479)throw new Error(_0x4fcc16(0x139));const _0x3df7ad=(0x0,socket_1[_0x4fcc16(0x132)])();return _0x3df7ad['to'](_0x5c4479[_0x4fcc16(0x131)][_0x4fcc16(0x145)]())['to']('company-'+_0x8df3b1+'-'+_0x1622f2[_0x4fcc16(0x14d)])['to']('company-'+_0x8df3b1+_0x4fcc16(0x140))['to']('queue-'+_0x5c4479[_0x4fcc16(0x13d)]+_0x4fcc16(0x140))['to'](_0x4fcc16(0x152)+_0x5c4479[_0x4fcc16(0x13d)]+'-'+_0x1622f2[_0x4fcc16(0x14d)])[_0x4fcc16(0x142)](_0x4fcc16(0x14a)+_0x8df3b1+_0x4fcc16(0x14c),{'action':_0x4fcc16(0x134),'message':_0x5c4479,'ticket':_0x1622f2,'contact':_0x1622f2['contact']}),_0x3df7ad['to'](_0x4fcc16(0x14a)+_0x8df3b1+_0x4fcc16(0x143))[_0x4fcc16(0x142)](_0x4fcc16(0x14a)+_0x8df3b1+'-contact',{'action':_0x4fcc16(0x13e),'contact':_0x1622f2[_0x4fcc16(0x154)]}),_0x5c4479;};exports[a444_0xe01cbb(0x14e)]=CreateMessageService;