const a444_0x5a0543=a444_0x4b90;(function(_0x39cfcf,_0xeec6f0){const _0x45b9b4=a444_0x4b90,_0x15fc27=_0x39cfcf();while(!![]){try{const _0x2f6a74=-parseInt(_0x45b9b4(0x109))/0x1*(-parseInt(_0x45b9b4(0x119))/0x2)+-parseInt(_0x45b9b4(0xf9))/0x3*(-parseInt(_0x45b9b4(0x11d))/0x4)+parseInt(_0x45b9b4(0x106))/0x5+parseInt(_0x45b9b4(0x11b))/0x6*(-parseInt(_0x45b9b4(0x111))/0x7)+-parseInt(_0x45b9b4(0x10d))/0x8*(-parseInt(_0x45b9b4(0xf3))/0x9)+parseInt(_0x45b9b4(0x10b))/0xa*(-parseInt(_0x45b9b4(0x11e))/0xb)+-parseInt(_0x45b9b4(0x118))/0xc;if(_0x2f6a74===_0xeec6f0)break;else _0x15fc27['push'](_0x15fc27['shift']());}catch(_0x25d945){_0x15fc27['push'](_0x15fc27['shift']());}}}(a444_0x4dc0,0x6931b));const a444_0x15eafb=(function(){let _0x3cbd49=!![];return function(_0x233f1a,_0x55255b){const _0x3aa160=_0x3cbd49?function(){const _0x36b295=a444_0x4b90;if(_0x55255b){const _0x1d0550=_0x55255b[_0x36b295(0x105)](_0x233f1a,arguments);return _0x55255b=null,_0x1d0550;}}:function(){};return _0x3cbd49=![],_0x3aa160;};}()),a444_0xdaad42=a444_0x15eafb(this,function(){const _0x5b8282=a444_0x4b90;return a444_0xdaad42[_0x5b8282(0xf6)]()[_0x5b8282(0xf5)]('(((.+)+)+)+$')[_0x5b8282(0xf6)]()[_0x5b8282(0x10c)](a444_0xdaad42)[_0x5b8282(0xf5)](_0x5b8282(0x103));});a444_0xdaad42();'use strict';var __importDefault=this&&this[a444_0x5a0543(0x104)]||function(_0x5c2057){const _0x30fb6f=a444_0x5a0543;return _0x5c2057&&_0x5c2057[_0x30fb6f(0xfd)]?_0x5c2057:{'default':_0x5c2057};};Object[a444_0x5a0543(0xfa)](exports,a444_0x5a0543(0xfd),{'value':!![]});const socket_1=require(a444_0x5a0543(0x114)),Message_1=__importDefault(require('../../models/Message')),Ticket_1=__importDefault(require(a444_0x5a0543(0xfb))),OldMessage_1=__importDefault(require(a444_0x5a0543(0xfc))),CreateMessageService=async({messageData:_0x5778c2,ticket:_0x2d66f9,companyId:_0x20b491})=>{const _0x3707c0=a444_0x5a0543;await Message_1[_0x3707c0(0x100)][_0x3707c0(0x10e)]({..._0x5778c2,'companyId':_0x20b491});const _0x4ea09d=await Message_1['default'][_0x3707c0(0x110)](_0x5778c2['id'],{'include':['contact',{'model':Ticket_1[_0x3707c0(0x100)],'as':_0x3707c0(0xf4),'include':[_0x3707c0(0x117),_0x3707c0(0x11a),_0x3707c0(0x107)]},{'model':Message_1[_0x3707c0(0x100)],'as':_0x3707c0(0x112),'include':[_0x3707c0(0x117)]},{'model':OldMessage_1[_0x3707c0(0x100)],'as':_0x3707c0(0x11f)}]});if(_0x2d66f9[_0x3707c0(0x117)])await _0x2d66f9[_0x3707c0(0x117)]['update']({'presence':_0x3707c0(0x101)}),await _0x2d66f9[_0x3707c0(0x117)]['reload'](),_0x2d66f9[_0x3707c0(0xff)]!==null&&_0x4ea09d[_0x3707c0(0xff)]===null&&await _0x4ea09d[_0x3707c0(0x113)]({'queueId':_0x2d66f9[_0x3707c0(0xff)]});else throw new Error('ERR_CREATING_MESSAGE');if(!_0x4ea09d)throw new Error(_0x3707c0(0xf8));const _0x215188=(0x0,socket_1[_0x3707c0(0x102)])();return _0x215188['to'](_0x4ea09d[_0x3707c0(0x108)]['toString']())['to'](_0x3707c0(0x10f)+_0x20b491+'-'+_0x2d66f9[_0x3707c0(0x10a)])['to'](_0x3707c0(0x10f)+_0x20b491+'-notification')['to'](_0x3707c0(0x115)+_0x4ea09d[_0x3707c0(0xff)]+'-notification')['to'](_0x3707c0(0x115)+_0x4ea09d[_0x3707c0(0xff)]+'-'+_0x2d66f9[_0x3707c0(0x10a)])['emit'](_0x3707c0(0x10f)+_0x20b491+_0x3707c0(0x116),{'action':_0x3707c0(0xfe),'message':_0x4ea09d,'ticket':_0x2d66f9,'contact':_0x2d66f9['contact']}),_0x215188['to'](_0x3707c0(0x10f)+_0x20b491+'-mainchannel')[_0x3707c0(0x11c)](_0x3707c0(0x10f)+_0x20b491+_0x3707c0(0xf7),{'action':_0x3707c0(0x113),'contact':_0x2d66f9[_0x3707c0(0x117)]}),_0x4ea09d;};function a444_0x4dc0(){const _0x433fe0=['search','toString','-contact','ERR_CREATING_MESSAGE','2320044bRRkQX','defineProperty','../../models/Ticket','../../models/OldMessage','__esModule','create','queueId','default','available','getIO','(((.+)+)+)+$','__importDefault','apply','645165tEDZve','whatsapp','ticketId','1okBFos','status','60Ksibhb','constructor','8qblEhR','upsert','company-','findByPk','2506BygEYr','quotedMsg','update','../../libs/socket','queue-','-appMessage','contact','12913656WrRtsA','923388awRxOd','queue','372QbAEct','emit','4krFaSV','1203983cpPpIM','oldMessages','7396668fMfZbd','ticket'];a444_0x4dc0=function(){return _0x433fe0;};return a444_0x4dc0();}function a444_0x4b90(_0x56ca0b,_0x371c64){const _0x405bc0=a444_0x4dc0();return a444_0x4b90=function(_0xdaad42,_0x15eafb){_0xdaad42=_0xdaad42-0xf3;let _0x4dc0c0=_0x405bc0[_0xdaad42];return _0x4dc0c0;},a444_0x4b90(_0x56ca0b,_0x371c64);}exports[a444_0x5a0543(0x100)]=CreateMessageService;