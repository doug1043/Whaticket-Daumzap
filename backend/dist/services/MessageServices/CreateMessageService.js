const a442_0x27454c=a442_0x240b;(function(_0x11faf2,_0x288b0f){const _0xcfcca5=a442_0x240b,_0x56c6b7=_0x11faf2();while(!![]){try{const _0x171a3d=-parseInt(_0xcfcca5(0x1bc))/0x1+-parseInt(_0xcfcca5(0x1d2))/0x2+-parseInt(_0xcfcca5(0x1d3))/0x3*(-parseInt(_0xcfcca5(0x1be))/0x4)+parseInt(_0xcfcca5(0x1c8))/0x5*(-parseInt(_0xcfcca5(0x1ca))/0x6)+-parseInt(_0xcfcca5(0x1d9))/0x7+-parseInt(_0xcfcca5(0x1c5))/0x8+parseInt(_0xcfcca5(0x1dc))/0x9;if(_0x171a3d===_0x288b0f)break;else _0x56c6b7['push'](_0x56c6b7['shift']());}catch(_0x337045){_0x56c6b7['push'](_0x56c6b7['shift']());}}}(a442_0x2ab7,0x2f99b));const a442_0x3d8483=(function(){let _0x44c928=!![];return function(_0x2ce27d,_0x1d02ed){const _0x5e7894=_0x44c928?function(){const _0x52a635=a442_0x240b;if(_0x1d02ed){const _0x377fcc=_0x1d02ed[_0x52a635(0x1e1)](_0x2ce27d,arguments);return _0x1d02ed=null,_0x377fcc;}}:function(){};return _0x44c928=![],_0x5e7894;};}()),a442_0xa36b06=a442_0x3d8483(this,function(){const _0x1d2e6a=a442_0x240b;return a442_0xa36b06[_0x1d2e6a(0x1d6)]()[_0x1d2e6a(0x1c3)](_0x1d2e6a(0x1da))['toString']()['constructor'](a442_0xa36b06)[_0x1d2e6a(0x1c3)](_0x1d2e6a(0x1da));});a442_0xa36b06();'use strict';function a442_0x240b(_0x3ee463,_0x40c4e5){const _0x37e3fa=a442_0x2ab7();return a442_0x240b=function(_0xa36b06,_0x3d8483){_0xa36b06=_0xa36b06-0x1bb;let _0x2ab726=_0x37e3fa[_0xa36b06];return _0x2ab726;},a442_0x240b(_0x3ee463,_0x40c4e5);}function a442_0x2ab7(){const _0x32b548=['queue-','toString','upsert','-appMessage','1190217nlEsQX','(((.+)+)+)+$','update','10159281JgTjOg','__importDefault','reload','status','oldMessages','apply','getIO','-mainchannel','121373GWfSDW','company-','92nwyTzu','findByPk','available','quotedMsg','-contact','search','queue','2794112soanSB','../../models/Ticket','whatsapp','150tjFKhw','default','27042zBKDoy','../../libs/socket','ERR_CREATING_MESSAGE','contact','../../models/OldMessage','emit','__esModule','queueId','386898FlMDzt','4629RCpabC','ticket'];a442_0x2ab7=function(){return _0x32b548;};return a442_0x2ab7();}var __importDefault=this&&this[a442_0x27454c(0x1dd)]||function(_0x46f644){const _0x297b24=a442_0x27454c;return _0x46f644&&_0x46f644[_0x297b24(0x1d0)]?_0x46f644:{'default':_0x46f644};};Object['defineProperty'](exports,a442_0x27454c(0x1d0),{'value':!![]});const socket_1=require(a442_0x27454c(0x1cb)),Message_1=__importDefault(require('../../models/Message')),Ticket_1=__importDefault(require(a442_0x27454c(0x1c6))),OldMessage_1=__importDefault(require(a442_0x27454c(0x1ce))),CreateMessageService=async({messageData:_0x4b874a,ticket:_0x1aa076,companyId:_0x43bec6})=>{const _0x2ea8e3=a442_0x27454c;await Message_1[_0x2ea8e3(0x1c9)][_0x2ea8e3(0x1d7)]({..._0x4b874a,'companyId':_0x43bec6});const _0x2abadd=await Message_1['default'][_0x2ea8e3(0x1bf)](_0x4b874a['id'],{'include':[_0x2ea8e3(0x1cd),{'model':Ticket_1[_0x2ea8e3(0x1c9)],'as':_0x2ea8e3(0x1d4),'include':[_0x2ea8e3(0x1cd),_0x2ea8e3(0x1c4),_0x2ea8e3(0x1c7)]},{'model':Message_1[_0x2ea8e3(0x1c9)],'as':_0x2ea8e3(0x1c1),'include':['contact']},{'model':OldMessage_1[_0x2ea8e3(0x1c9)],'as':_0x2ea8e3(0x1e0)}]});if(_0x1aa076[_0x2ea8e3(0x1cd)])await _0x1aa076[_0x2ea8e3(0x1cd)][_0x2ea8e3(0x1db)]({'presence':_0x2ea8e3(0x1c0)}),await _0x1aa076['contact'][_0x2ea8e3(0x1de)](),_0x1aa076[_0x2ea8e3(0x1d1)]!==null&&_0x2abadd[_0x2ea8e3(0x1d1)]===null&&await _0x2abadd[_0x2ea8e3(0x1db)]({'queueId':_0x1aa076[_0x2ea8e3(0x1d1)]});else throw new Error(_0x2ea8e3(0x1cc));if(!_0x2abadd)throw new Error(_0x2ea8e3(0x1cc));const _0xe9e3b3=(0x0,socket_1[_0x2ea8e3(0x1e2)])();return _0xe9e3b3['to'](_0x2abadd['ticketId'][_0x2ea8e3(0x1d6)]())['to']('company-'+_0x43bec6+'-'+_0x1aa076[_0x2ea8e3(0x1df)])['to']('company-'+_0x43bec6+'-notification')['to'](_0x2ea8e3(0x1d5)+_0x2abadd[_0x2ea8e3(0x1d1)]+'-notification')['to'](_0x2ea8e3(0x1d5)+_0x2abadd[_0x2ea8e3(0x1d1)]+'-'+_0x1aa076['status'])[_0x2ea8e3(0x1cf)](_0x2ea8e3(0x1bd)+_0x43bec6+_0x2ea8e3(0x1d8),{'action':'create','message':_0x2abadd,'ticket':_0x1aa076,'contact':_0x1aa076[_0x2ea8e3(0x1cd)]}),_0xe9e3b3['to'](_0x2ea8e3(0x1bd)+_0x43bec6+_0x2ea8e3(0x1bb))[_0x2ea8e3(0x1cf)](_0x2ea8e3(0x1bd)+_0x43bec6+_0x2ea8e3(0x1c2),{'action':_0x2ea8e3(0x1db),'contact':_0x1aa076[_0x2ea8e3(0x1cd)]}),_0x2abadd;};exports['default']=CreateMessageService;