const a484_0x4237e4=a484_0x4adf;(function(_0x11fc6e,_0x16f536){const _0x4d5c6c=a484_0x4adf,_0x3a756c=_0x11fc6e();while(!![]){try{const _0x58749d=-parseInt(_0x4d5c6c(0x1d5))/0x1+-parseInt(_0x4d5c6c(0x1db))/0x2*(parseInt(_0x4d5c6c(0x1bb))/0x3)+-parseInt(_0x4d5c6c(0x1cb))/0x4+parseInt(_0x4d5c6c(0x1d4))/0x5*(-parseInt(_0x4d5c6c(0x1d0))/0x6)+-parseInt(_0x4d5c6c(0x1c9))/0x7+parseInt(_0x4d5c6c(0x1d1))/0x8+parseInt(_0x4d5c6c(0x1c5))/0x9;if(_0x58749d===_0x16f536)break;else _0x3a756c['push'](_0x3a756c['shift']());}catch(_0x11a501){_0x3a756c['push'](_0x3a756c['shift']());}}}(a484_0x43d3,0x2bdbe));const a484_0xcab50f=(function(){let _0x49e662=!![];return function(_0x4b81fc,_0xabd8ff){const _0x54208f=_0x49e662?function(){const _0xf99459=a484_0x4adf;if(_0xabd8ff){const _0x274f01=_0xabd8ff[_0xf99459(0x1ca)](_0x4b81fc,arguments);return _0xabd8ff=null,_0x274f01;}}:function(){};return _0x49e662=![],_0x54208f;};}()),a484_0x28859a=a484_0xcab50f(this,function(){const _0x11a8cb=a484_0x4adf;return a484_0x28859a[_0x11a8cb(0x1df)]()['search'](_0x11a8cb(0x1c4))[_0x11a8cb(0x1df)]()[_0x11a8cb(0x1d6)](a484_0x28859a)[_0x11a8cb(0x1cc)]('(((.+)+)+)+$');});a484_0x28859a();'use strict';var __importDefault=this&&this[a484_0x4237e4(0x1c2)]||function(_0x1fa652){const _0x196765=a484_0x4237e4;return _0x1fa652&&_0x1fa652[_0x196765(0x1c1)]?_0x1fa652:{'default':_0x1fa652};};function a484_0x43d3(){const _0x152197=['../TicketServices/ShowTicketService','382HerpOE','quotedMsg','messageVisibility','companyId','toString','../../errors/AppError','reverse','4839wiTsLB','ERR_NO_TICKET_FOUND','reactionMessage','queueId','length','../../models/Queue','__esModule','__importDefault','GetCompanySetting','(((.+)+)+)+$','5827212jwXUVn','../../models/Message','defineProperty','createdAt','1066415BAsHGU','apply','25220ddtqOI','search','message','oldMessages','default','36630jNApxG','1060976YqMdLC','queue','contact','25DzLHnw','103186UDUdRh','constructor','findAndCountAll','../../models/OldMessage','sequelize'];a484_0x43d3=function(){return _0x152197;};return a484_0x43d3();}Object[a484_0x4237e4(0x1c7)](exports,'__esModule',{'value':!![]});function a484_0x4adf(_0x1ee18d,_0x239a24){const _0x59ee01=a484_0x43d3();return a484_0x4adf=function(_0x28859a,_0xcab50f){_0x28859a=_0x28859a-0x1b9;let _0x43d3e4=_0x59ee01[_0x28859a];return _0x43d3e4;},a484_0x4adf(_0x1ee18d,_0x239a24);}const sequelize_1=require(a484_0x4237e4(0x1d9)),AppError_1=__importDefault(require(a484_0x4237e4(0x1b9))),Message_1=__importDefault(require(a484_0x4237e4(0x1c6))),OldMessage_1=__importDefault(require(a484_0x4237e4(0x1d8))),ShowTicketService_1=__importDefault(require(a484_0x4237e4(0x1da))),Queue_1=__importDefault(require(a484_0x4237e4(0x1c0))),CheckSettings_1=require('../../helpers/CheckSettings'),ListMessagesService=async({pageNumber:pageNumber='1',ticketId:_0x51706c,companyId:_0x16b408,queues:queues=[]})=>{const _0x45b670=a484_0x4237e4,_0x281d5b=await(0x0,ShowTicketService_1['default'])(_0x51706c,_0x16b408);if(!_0x281d5b)throw new AppError_1[(_0x45b670(0x1cf))](_0x45b670(0x1bc),0x194);const _0x2efb4f=0x64,_0x6c521d=_0x2efb4f*(+pageNumber-0x1),_0x409fea={'where':{'ticketId':_0x51706c,'companyId':_0x16b408,'mediaType':{[sequelize_1['Op']['or']]:{[sequelize_1['Op']['ne']]:_0x45b670(0x1bd),[sequelize_1['Op']['is']]:null}}}};queues[_0x45b670(0x1bf)]>0x0&&await(0x0,CheckSettings_1[_0x45b670(0x1c3)])(_0x16b408,_0x45b670(0x1dd),'message')===_0x45b670(0x1cd)&&(_0x409fea['where'][_0x45b670(0x1be)]={[sequelize_1['Op']['or']]:{[sequelize_1['Op']['in']]:queues,[sequelize_1['Op']['eq']]:null}});const {count:_0x1666e9,rows:_0x2d645b}=await Message_1[_0x45b670(0x1cf)][_0x45b670(0x1d7)]({..._0x409fea,'limit':_0x2efb4f,'include':[_0x45b670(0x1d3),{'model':Message_1[_0x45b670(0x1cf)],'as':_0x45b670(0x1dc),'include':[_0x45b670(0x1d3)],'where':{'companyId':_0x281d5b[_0x45b670(0x1de)]},'required':![]},{'model':OldMessage_1[_0x45b670(0x1cf)],'as':_0x45b670(0x1ce),'where':{'ticketId':_0x281d5b['id']},'required':![]},{'model':Message_1[_0x45b670(0x1cf)],'as':'replies','where':{'ticketId':_0x281d5b['id']},'include':[_0x45b670(0x1d3)],'required':![]},{'model':Queue_1['default'],'as':_0x45b670(0x1d2)}],'offset':_0x6c521d,'order':[[_0x45b670(0x1c8),'DESC']]}),_0x30b1d4=_0x1666e9>_0x6c521d+_0x2d645b['length'];return{'messages':_0x2d645b[_0x45b670(0x1ba)](),'ticket':_0x281d5b,'count':_0x1666e9,'hasMore':_0x30b1d4};};exports[a484_0x4237e4(0x1cf)]=ListMessagesService;