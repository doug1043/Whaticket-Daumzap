const a585_0x1408a6=a585_0x3266;(function(_0x2e49f8,_0x58cc61){const _0x2c5a1b=a585_0x3266,_0x28d9d1=_0x2e49f8();while(!![]){try{const _0xcd9661=parseInt(_0x2c5a1b(0xdd))/0x1+parseInt(_0x2c5a1b(0xbf))/0x2*(parseInt(_0x2c5a1b(0xc9))/0x3)+-parseInt(_0x2c5a1b(0xdc))/0x4+-parseInt(_0x2c5a1b(0xd6))/0x5+-parseInt(_0x2c5a1b(0xc8))/0x6+-parseInt(_0x2c5a1b(0xc6))/0x7*(-parseInt(_0x2c5a1b(0xd4))/0x8)+parseInt(_0x2c5a1b(0xca))/0x9;if(_0xcd9661===_0x58cc61)break;else _0x28d9d1['push'](_0x28d9d1['shift']());}catch(_0xb08be7){_0x28d9d1['push'](_0x28d9d1['shift']());}}}(a585_0x4933,0x6fde4));const a585_0x1c4197=(function(){let _0x1f3cef=!![];return function(_0x1a8b2a,_0x5e40e7){const _0x34284c=_0x1f3cef?function(){const _0x1a41cd=a585_0x3266;if(_0x5e40e7){const _0x4ffede=_0x5e40e7[_0x1a41cd(0xd2)](_0x1a8b2a,arguments);return _0x5e40e7=null,_0x4ffede;}}:function(){};return _0x1f3cef=![],_0x34284c;};}()),a585_0x28cf85=a585_0x1c4197(this,function(){const _0x11688e=a585_0x3266;return a585_0x28cf85['toString']()[_0x11688e(0xc2)]('(((.+)+)+)+$')[_0x11688e(0xcd)]()[_0x11688e(0xd0)](a585_0x28cf85)['search']('(((.+)+)+)+$');});function a585_0x3266(_0x2358c0,_0x44f49e){const _0x590dfb=a585_0x4933();return a585_0x3266=function(_0x28cf85,_0x1c4197){_0x28cf85=_0x28cf85-0xbe;let _0x4933bc=_0x590dfb[_0x28cf85];return _0x4933bc;},a585_0x3266(_0x2358c0,_0x44f49e);}a585_0x28cf85();'use strict';var __importDefault=this&&this[a585_0x1408a6(0xcb)]||function(_0x37120f){return _0x37120f&&_0x37120f['__esModule']?_0x37120f:{'default':_0x37120f};};function a585_0x4933(){const _0x2439e4=['1687854kMTGEt','6bVEzRp','2610117qlebjn','__importDefault','messageVisibility','toString','reverse','createdAt','constructor','sequelize','apply','oldMessages','144bFNHZM','default','2120460nagpcR','../../models/Message','length','../../errors/AppError','defineProperty','../TicketServices/ShowTicketService','2034924Swdivh','558793KdPuQw','ERR_NO_TICKET_FOUND','101414nHGTle','companyId','contact','search','message','quotedMsg','GetCompanySetting','280826biwzik','queue'];a585_0x4933=function(){return _0x2439e4;};return a585_0x4933();}Object[a585_0x1408a6(0xda)](exports,'__esModule',{'value':!![]});const sequelize_1=require(a585_0x1408a6(0xd1)),AppError_1=__importDefault(require(a585_0x1408a6(0xd9))),Message_1=__importDefault(require(a585_0x1408a6(0xd7))),OldMessage_1=__importDefault(require('../../models/OldMessage')),ShowTicketService_1=__importDefault(require(a585_0x1408a6(0xdb))),Queue_1=__importDefault(require('../../models/Queue')),CheckSettings_1=require('../../helpers/CheckSettings'),ListMessagesService=async({pageNumber:pageNumber='1',ticketId:_0x2c49aa,companyId:_0xe87663,queues:queues=[]})=>{const _0xca906f=a585_0x1408a6,_0x40e244=await(0x0,ShowTicketService_1[_0xca906f(0xd5)])(_0x2c49aa,_0xe87663);if(!_0x40e244)throw new AppError_1[(_0xca906f(0xd5))](_0xca906f(0xbe),0x194);const _0x3d1fb8=0x64,_0x1b719a=_0x3d1fb8*(+pageNumber-0x1),_0xe153bf={'where':{'ticketId':_0x2c49aa,'companyId':_0xe87663,'mediaType':{[sequelize_1['Op']['or']]:{[sequelize_1['Op']['ne']]:'reactionMessage',[sequelize_1['Op']['is']]:null}}}};queues['length']>0x0&&await(0x0,CheckSettings_1[_0xca906f(0xc5)])(_0xe87663,_0xca906f(0xcc),_0xca906f(0xc3))===_0xca906f(0xc3)&&(_0xe153bf['where']['queueId']={[sequelize_1['Op']['or']]:{[sequelize_1['Op']['in']]:queues,[sequelize_1['Op']['eq']]:null}});const {count:_0x17ac26,rows:_0xfbab07}=await Message_1[_0xca906f(0xd5)]['findAndCountAll']({..._0xe153bf,'limit':_0x3d1fb8,'include':[_0xca906f(0xc1),{'model':Message_1['default'],'as':_0xca906f(0xc4),'include':[_0xca906f(0xc1)],'where':{'companyId':_0x40e244[_0xca906f(0xc0)]},'required':![]},{'model':OldMessage_1[_0xca906f(0xd5)],'as':_0xca906f(0xd3),'where':{'ticketId':_0x40e244['id']},'required':![]},{'model':Message_1['default'],'as':'replies','where':{'ticketId':_0x40e244['id']},'include':['contact'],'required':![]},{'model':Queue_1['default'],'as':_0xca906f(0xc7)}],'offset':_0x1b719a,'order':[[_0xca906f(0xcf),'DESC']]}),_0x1afc6e=_0x17ac26>_0x1b719a+_0xfbab07[_0xca906f(0xd8)];return{'messages':_0xfbab07[_0xca906f(0xce)](),'ticket':_0x40e244,'count':_0x17ac26,'hasMore':_0x1afc6e};};exports[a585_0x1408a6(0xd5)]=ListMessagesService;