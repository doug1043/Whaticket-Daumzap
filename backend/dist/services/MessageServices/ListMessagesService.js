const a483_0x4da49f=a483_0x3a84;(function(_0x4afb8a,_0x566127){const _0x22854c=a483_0x3a84,_0x197b29=_0x4afb8a();while(!![]){try{const _0x5c1873=parseInt(_0x22854c(0xe5))/0x1+-parseInt(_0x22854c(0xe6))/0x2*(parseInt(_0x22854c(0xf0))/0x3)+parseInt(_0x22854c(0xf3))/0x4*(parseInt(_0x22854c(0xd0))/0x5)+parseInt(_0x22854c(0xe0))/0x6*(parseInt(_0x22854c(0xd7))/0x7)+parseInt(_0x22854c(0xd2))/0x8+-parseInt(_0x22854c(0xdb))/0x9*(parseInt(_0x22854c(0xeb))/0xa)+-parseInt(_0x22854c(0xed))/0xb*(-parseInt(_0x22854c(0xef))/0xc);if(_0x5c1873===_0x566127)break;else _0x197b29['push'](_0x197b29['shift']());}catch(_0x2dea4a){_0x197b29['push'](_0x197b29['shift']());}}}(a483_0xd85f,0x8b9af));function a483_0x3a84(_0x1d1b0d,_0x34e216){const _0x2736e4=a483_0xd85f();return a483_0x3a84=function(_0x7d4e43,_0x9e83a1){_0x7d4e43=_0x7d4e43-0xd0;let _0xd85f54=_0x2736e4[_0x7d4e43];return _0xd85f54;},a483_0x3a84(_0x1d1b0d,_0x34e216);}const a483_0x9e83a1=(function(){let _0x370768=!![];return function(_0x3e224f,_0x5dbc4a){const _0x14b204=_0x370768?function(){if(_0x5dbc4a){const _0x1eff20=_0x5dbc4a['apply'](_0x3e224f,arguments);return _0x5dbc4a=null,_0x1eff20;}}:function(){};return _0x370768=![],_0x14b204;};}()),a483_0x7d4e43=a483_0x9e83a1(this,function(){const _0x51fc57=a483_0x3a84;return a483_0x7d4e43['toString']()[_0x51fc57(0xe3)](_0x51fc57(0xdc))['toString']()[_0x51fc57(0xd6)](a483_0x7d4e43)[_0x51fc57(0xe3)](_0x51fc57(0xdc));});a483_0x7d4e43();'use strict';var __importDefault=this&&this[a483_0x4da49f(0xea)]||function(_0x1dd8c9){return _0x1dd8c9&&_0x1dd8c9['__esModule']?_0x1dd8c9:{'default':_0x1dd8c9};};Object[a483_0x4da49f(0xdf)](exports,a483_0x4da49f(0xd5),{'value':!![]});const sequelize_1=require(a483_0x4da49f(0xd3)),AppError_1=__importDefault(require(a483_0x4da49f(0xec))),Message_1=__importDefault(require(a483_0x4da49f(0xee))),OldMessage_1=__importDefault(require('../../models/OldMessage')),ShowTicketService_1=__importDefault(require(a483_0x4da49f(0xe9))),Queue_1=__importDefault(require(a483_0x4da49f(0xe2))),CheckSettings_1=require(a483_0x4da49f(0xe1)),ListMessagesService=async({pageNumber:pageNumber='1',ticketId:_0x280ed4,companyId:_0x4026a9,queues:queues=[]})=>{const _0x53a308=a483_0x4da49f,_0x134a28=await(0x0,ShowTicketService_1[_0x53a308(0xf1)])(_0x280ed4,_0x4026a9);if(!_0x134a28)throw new AppError_1[(_0x53a308(0xf1))]('ERR_NO_TICKET_FOUND',0x194);const _0x503e1d=0x64,_0x96ff59=_0x503e1d*(+pageNumber-0x1),_0x5d0e2b={'where':{'ticketId':_0x280ed4,'companyId':_0x4026a9,'mediaType':{[sequelize_1['Op']['or']]:{[sequelize_1['Op']['ne']]:'reactionMessage',[sequelize_1['Op']['is']]:null}}}};queues[_0x53a308(0xd9)]>0x0&&await(0x0,CheckSettings_1['GetCompanySetting'])(_0x4026a9,_0x53a308(0xe7),_0x53a308(0xd1))==='message'&&(_0x5d0e2b['where'][_0x53a308(0xde)]={[sequelize_1['Op']['or']]:{[sequelize_1['Op']['in']]:queues,[sequelize_1['Op']['eq']]:null}});const {count:_0x56cf13,rows:_0x25835f}=await Message_1[_0x53a308(0xf1)]['findAndCountAll']({..._0x5d0e2b,'limit':_0x503e1d,'include':['contact',{'model':Message_1[_0x53a308(0xf1)],'as':_0x53a308(0xf2),'include':[_0x53a308(0xd8)],'where':{'companyId':_0x134a28['companyId']},'required':![]},{'model':OldMessage_1[_0x53a308(0xf1)],'as':_0x53a308(0xe8),'where':{'ticketId':_0x134a28['id']},'required':![]},{'model':Message_1[_0x53a308(0xf1)],'as':_0x53a308(0xd4),'where':{'ticketId':_0x134a28['id']},'include':[_0x53a308(0xd8)],'required':![]},{'model':Queue_1[_0x53a308(0xf1)],'as':_0x53a308(0xda)}],'offset':_0x96ff59,'order':[[_0x53a308(0xdd),_0x53a308(0xe4)]]}),_0x1024d6=_0x56cf13>_0x96ff59+_0x25835f[_0x53a308(0xd9)];return{'messages':_0x25835f['reverse'](),'ticket':_0x134a28,'count':_0x56cf13,'hasMore':_0x1024d6};};exports[a483_0x4da49f(0xf1)]=ListMessagesService;function a483_0xd85f(){const _0x333661=['message','1952776GRtOsI','sequelize','replies','__esModule','constructor','5677irLSdX','contact','length','queue','3129813htuPFk','(((.+)+)+)+$','createdAt','queueId','defineProperty','1128CXlXLc','../../helpers/CheckSettings','../../models/Queue','search','DESC','518171mommUT','6UgtDDG','messageVisibility','oldMessages','../TicketServices/ShowTicketService','__importDefault','30UPTeUu','../../errors/AppError','770aJHveQ','../../models/Message','103908KAonyP','521568GMBBUz','default','quotedMsg','615796sGbOpD','20lNqFOx'];a483_0xd85f=function(){return _0x333661;};return a483_0xd85f();}