const a483_0x468c64=a483_0x476c;(function(_0x941c7e,_0x40d9c2){const _0x33a9d8=a483_0x476c,_0x10600e=_0x941c7e();while(!![]){try{const _0x501f3b=-parseInt(_0x33a9d8(0x15e))/0x1+-parseInt(_0x33a9d8(0x162))/0x2+parseInt(_0x33a9d8(0x159))/0x3*(-parseInt(_0x33a9d8(0x16a))/0x4)+-parseInt(_0x33a9d8(0x16c))/0x5*(-parseInt(_0x33a9d8(0x15b))/0x6)+-parseInt(_0x33a9d8(0x158))/0x7+-parseInt(_0x33a9d8(0x168))/0x8*(parseInt(_0x33a9d8(0x14e))/0x9)+-parseInt(_0x33a9d8(0x16e))/0xa*(-parseInt(_0x33a9d8(0x164))/0xb);if(_0x501f3b===_0x40d9c2)break;else _0x10600e['push'](_0x10600e['shift']());}catch(_0x2432da){_0x10600e['push'](_0x10600e['shift']());}}}(a483_0x3190,0x57d7f));const a483_0x2eebc9=(function(){let _0x58e631=!![];return function(_0x3e8bba,_0xaa2789){const _0x52b221=_0x58e631?function(){const _0x2d3dfe=a483_0x476c;if(_0xaa2789){const _0x401e5d=_0xaa2789[_0x2d3dfe(0x149)](_0x3e8bba,arguments);return _0xaa2789=null,_0x401e5d;}}:function(){};return _0x58e631=![],_0x52b221;};}()),a483_0x3ee6eb=a483_0x2eebc9(this,function(){const _0x5bf84d=a483_0x476c;return a483_0x3ee6eb[_0x5bf84d(0x156)]()[_0x5bf84d(0x154)]('(((.+)+)+)+$')[_0x5bf84d(0x156)]()[_0x5bf84d(0x151)](a483_0x3ee6eb)['search'](_0x5bf84d(0x14c));});a483_0x3ee6eb();function a483_0x476c(_0x11dc33,_0xed244c){const _0x213df7=a483_0x3190();return a483_0x476c=function(_0x3ee6eb,_0x2eebc9){_0x3ee6eb=_0x3ee6eb-0x148;let _0x31906b=_0x213df7[_0x3ee6eb];return _0x31906b;},a483_0x476c(_0x11dc33,_0xed244c);}function a483_0x3190(){const _0x5747ca=['148254SlqUkT','reactionMessage','60YBvteR','../../models/Queue','queueId','696479RpRElZ','createdAt','../../models/OldMessage','replies','436980CjrLxp','__importDefault','24717AsgpHF','ERR_NO_TICKET_FOUND','reverse','length','8hpWQGB','../../helpers/CheckSettings','16HJoJgD','oldMessages','42305MZbRVS','where','9330uuUddu','DESC','apply','defineProperty','messageVisibility','(((.+)+)+)+$','default','111474OSXMKY','contact','GetCompanySetting','constructor','__esModule','../../models/Message','search','message','toString','findAndCountAll','4873589PsaLyN'];a483_0x3190=function(){return _0x5747ca;};return a483_0x3190();}'use strict';var __importDefault=this&&this[a483_0x468c64(0x163)]||function(_0x142e6c){const _0x56e2ae=a483_0x468c64;return _0x142e6c&&_0x142e6c[_0x56e2ae(0x152)]?_0x142e6c:{'default':_0x142e6c};};Object[a483_0x468c64(0x14a)](exports,a483_0x468c64(0x152),{'value':!![]});const sequelize_1=require('sequelize'),AppError_1=__importDefault(require('../../errors/AppError')),Message_1=__importDefault(require(a483_0x468c64(0x153))),OldMessage_1=__importDefault(require(a483_0x468c64(0x160))),ShowTicketService_1=__importDefault(require('../TicketServices/ShowTicketService')),Queue_1=__importDefault(require(a483_0x468c64(0x15c))),CheckSettings_1=require(a483_0x468c64(0x169)),ListMessagesService=async({pageNumber:pageNumber='1',ticketId:_0x5d12b1,companyId:_0x4034a4,queues:queues=[]})=>{const _0x27e12c=a483_0x468c64,_0x213e4c=await(0x0,ShowTicketService_1['default'])(_0x5d12b1,_0x4034a4);if(!_0x213e4c)throw new AppError_1[(_0x27e12c(0x14d))](_0x27e12c(0x165),0x194);const _0x15eadc=0x64,_0x2d6b11=_0x15eadc*(+pageNumber-0x1),_0x53e31f={'where':{'ticketId':_0x5d12b1,'companyId':_0x4034a4,'mediaType':{[sequelize_1['Op']['or']]:{[sequelize_1['Op']['ne']]:_0x27e12c(0x15a),[sequelize_1['Op']['is']]:null}}}};queues[_0x27e12c(0x167)]>0x0&&await(0x0,CheckSettings_1[_0x27e12c(0x150)])(_0x4034a4,_0x27e12c(0x14b),_0x27e12c(0x155))===_0x27e12c(0x155)&&(_0x53e31f[_0x27e12c(0x16d)][_0x27e12c(0x15d)]={[sequelize_1['Op']['or']]:{[sequelize_1['Op']['in']]:queues,[sequelize_1['Op']['eq']]:null}});const {count:_0xa3d561,rows:_0x5e6f17}=await Message_1[_0x27e12c(0x14d)][_0x27e12c(0x157)]({..._0x53e31f,'limit':_0x15eadc,'include':['contact',{'model':Message_1[_0x27e12c(0x14d)],'as':'quotedMsg','include':[_0x27e12c(0x14f)],'where':{'companyId':_0x213e4c['companyId']},'required':![]},{'model':OldMessage_1[_0x27e12c(0x14d)],'as':_0x27e12c(0x16b),'where':{'ticketId':_0x213e4c['id']},'required':![]},{'model':Message_1['default'],'as':_0x27e12c(0x161),'where':{'ticketId':_0x213e4c['id']},'include':[_0x27e12c(0x14f)],'required':![]},{'model':Queue_1[_0x27e12c(0x14d)],'as':'queue'}],'offset':_0x2d6b11,'order':[[_0x27e12c(0x15f),_0x27e12c(0x148)]]}),_0x5f2465=_0xa3d561>_0x2d6b11+_0x5e6f17[_0x27e12c(0x167)];return{'messages':_0x5e6f17[_0x27e12c(0x166)](),'ticket':_0x213e4c,'count':_0xa3d561,'hasMore':_0x5f2465};};exports[a483_0x468c64(0x14d)]=ListMessagesService;