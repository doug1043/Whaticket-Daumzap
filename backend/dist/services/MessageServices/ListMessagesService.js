const a480_0x4f3173=a480_0x391e;(function(_0x415db0,_0xa8c72a){const _0x5b2404=a480_0x391e,_0x1ad82b=_0x415db0();while(!![]){try{const _0x418e87=parseInt(_0x5b2404(0x10d))/0x1*(parseInt(_0x5b2404(0x103))/0x2)+parseInt(_0x5b2404(0xfb))/0x3*(-parseInt(_0x5b2404(0xf7))/0x4)+parseInt(_0x5b2404(0x101))/0x5*(-parseInt(_0x5b2404(0xfe))/0x6)+-parseInt(_0x5b2404(0xff))/0x7+-parseInt(_0x5b2404(0xf9))/0x8*(parseInt(_0x5b2404(0xf8))/0x9)+parseInt(_0x5b2404(0x108))/0xa*(parseInt(_0x5b2404(0xfd))/0xb)+parseInt(_0x5b2404(0x10f))/0xc*(parseInt(_0x5b2404(0x104))/0xd);if(_0x418e87===_0xa8c72a)break;else _0x1ad82b['push'](_0x1ad82b['shift']());}catch(_0x48dd26){_0x1ad82b['push'](_0x1ad82b['shift']());}}}(a480_0x17e8,0x96523));const a480_0x1f435a=(function(){let _0x2996a3=!![];return function(_0x4717e6,_0x239ffd){const _0x4d8503=_0x2996a3?function(){if(_0x239ffd){const _0x90d8c4=_0x239ffd['apply'](_0x4717e6,arguments);return _0x239ffd=null,_0x90d8c4;}}:function(){};return _0x2996a3=![],_0x4d8503;};}()),a480_0x1c0c93=a480_0x1f435a(this,function(){const _0x3a201f=a480_0x391e;return a480_0x1c0c93['toString']()[_0x3a201f(0x111)](_0x3a201f(0x117))[_0x3a201f(0x100)]()[_0x3a201f(0x105)](a480_0x1c0c93)['search']('(((.+)+)+)+$');});a480_0x1c0c93();function a480_0x391e(_0x2743a4,_0xb5ade0){const _0x1876cc=a480_0x17e8();return a480_0x391e=function(_0x1c0c93,_0x1f435a){_0x1c0c93=_0x1c0c93-0xf6;let _0x17e880=_0x1876cc[_0x1c0c93];return _0x17e880;},a480_0x391e(_0x2743a4,_0xb5ade0);}'use strict';var __importDefault=this&&this['__importDefault']||function(_0x5335d4){const _0x5edd55=a480_0x391e;return _0x5335d4&&_0x5335d4[_0x5edd55(0x113)]?_0x5335d4:{'default':_0x5335d4};};Object['defineProperty'](exports,a480_0x4f3173(0x113),{'value':!![]});const sequelize_1=require(a480_0x4f3173(0x10e)),AppError_1=__importDefault(require(a480_0x4f3173(0x10b))),Message_1=__importDefault(require('../../models/Message')),OldMessage_1=__importDefault(require(a480_0x4f3173(0x107))),ShowTicketService_1=__importDefault(require(a480_0x4f3173(0x112))),Queue_1=__importDefault(require(a480_0x4f3173(0xf6))),CheckSettings_1=require(a480_0x4f3173(0xfa)),ListMessagesService=async({pageNumber:pageNumber='1',ticketId:_0x350b99,companyId:_0x268031,queues:queues=[]})=>{const _0x38b09c=a480_0x4f3173,_0x3282dd=await(0x0,ShowTicketService_1['default'])(_0x350b99,_0x268031);if(!_0x3282dd)throw new AppError_1[(_0x38b09c(0x118))]('ERR_NO_TICKET_FOUND',0x194);const _0x4ca566=0x64,_0x59a41f=_0x4ca566*(+pageNumber-0x1),_0x5b9c01={'where':{'ticketId':_0x350b99,'companyId':_0x268031,'mediaType':{[sequelize_1['Op']['or']]:{[sequelize_1['Op']['ne']]:_0x38b09c(0x116),[sequelize_1['Op']['is']]:null}}}};queues[_0x38b09c(0x10a)]>0x0&&await(0x0,CheckSettings_1[_0x38b09c(0x115)])(_0x268031,'messageVisibility',_0x38b09c(0x106))===_0x38b09c(0x106)&&(_0x5b9c01[_0x38b09c(0x114)][_0x38b09c(0x10c)]={[sequelize_1['Op']['or']]:{[sequelize_1['Op']['in']]:queues,[sequelize_1['Op']['eq']]:null}});const {count:_0xc75e13,rows:_0x337102}=await Message_1['default']['findAndCountAll']({..._0x5b9c01,'limit':_0x4ca566,'include':[_0x38b09c(0x110),{'model':Message_1[_0x38b09c(0x118)],'as':'quotedMsg','include':[_0x38b09c(0x110)],'where':{'companyId':_0x3282dd[_0x38b09c(0x102)]},'required':![]},{'model':OldMessage_1[_0x38b09c(0x118)],'as':'oldMessages','where':{'ticketId':_0x3282dd['id']},'required':![]},{'model':Message_1[_0x38b09c(0x118)],'as':'replies','where':{'ticketId':_0x3282dd['id']},'include':[_0x38b09c(0x110)],'required':![]},{'model':Queue_1[_0x38b09c(0x118)],'as':_0x38b09c(0xfc)}],'offset':_0x59a41f,'order':[['createdAt',_0x38b09c(0x109)]]}),_0x20483d=_0xc75e13>_0x59a41f+_0x337102[_0x38b09c(0x10a)];return{'messages':_0x337102['reverse'](),'ticket':_0x3282dd,'count':_0xc75e13,'hasMore':_0x20483d};};function a480_0x17e8(){const _0x4251c4=['3965812CqNlRr','181323WudymI','152EBwwdA','../../helpers/CheckSettings','3ygAtRi','queue','110QeztXR','44742wGkLfZ','4191201llIuRL','toString','595AuSHVZ','companyId','946UBORfA','13rvsdXR','constructor','message','../../models/OldMessage','1025870bLTGEx','DESC','length','../../errors/AppError','queueId','656NKpqQG','sequelize','25679148rHXJeI','contact','search','../TicketServices/ShowTicketService','__esModule','where','GetCompanySetting','reactionMessage','(((.+)+)+)+$','default','../../models/Queue'];a480_0x17e8=function(){return _0x4251c4;};return a480_0x17e8();}exports[a480_0x4f3173(0x118)]=ListMessagesService;