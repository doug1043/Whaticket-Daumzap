function a584_0x442f(_0x211f9d,_0x562647){const _0x2d3c32=a584_0x28e0();return a584_0x442f=function(_0x5a74de,_0x7b350b){_0x5a74de=_0x5a74de-0x132;let _0x28e028=_0x2d3c32[_0x5a74de];return _0x28e028;},a584_0x442f(_0x211f9d,_0x562647);}const a584_0x1d1078=a584_0x442f;(function(_0x26f85d,_0xac33b6){const _0x2b0099=a584_0x442f,_0x5e300e=_0x26f85d();while(!![]){try{const _0xc90357=parseInt(_0x2b0099(0x13f))/0x1+parseInt(_0x2b0099(0x147))/0x2+parseInt(_0x2b0099(0x132))/0x3*(parseInt(_0x2b0099(0x153))/0x4)+-parseInt(_0x2b0099(0x138))/0x5*(-parseInt(_0x2b0099(0x143))/0x6)+parseInt(_0x2b0099(0x13a))/0x7*(-parseInt(_0x2b0099(0x139))/0x8)+parseInt(_0x2b0099(0x144))/0x9*(-parseInt(_0x2b0099(0x13b))/0xa)+-parseInt(_0x2b0099(0x146))/0xb;if(_0xc90357===_0xac33b6)break;else _0x5e300e['push'](_0x5e300e['shift']());}catch(_0x2e9060){_0x5e300e['push'](_0x5e300e['shift']());}}}(a584_0x28e0,0x70fd1));const a584_0x7b350b=(function(){let _0x290980=!![];return function(_0x4bf5df,_0x1a8537){const _0x4e30bd=_0x290980?function(){const _0x4765e7=a584_0x442f;if(_0x1a8537){const _0x57cb8a=_0x1a8537[_0x4765e7(0x13e)](_0x4bf5df,arguments);return _0x1a8537=null,_0x57cb8a;}}:function(){};return _0x290980=![],_0x4e30bd;};}()),a584_0x5a74de=a584_0x7b350b(this,function(){const _0x193c62=a584_0x442f;return a584_0x5a74de[_0x193c62(0x134)]()[_0x193c62(0x152)](_0x193c62(0x151))['toString']()[_0x193c62(0x133)](a584_0x5a74de)[_0x193c62(0x152)](_0x193c62(0x151));});a584_0x5a74de();'use strict';var __importDefault=this&&this[a584_0x1d1078(0x150)]||function(_0x35275d){const _0x1797dc=a584_0x1d1078;return _0x35275d&&_0x35275d[_0x1797dc(0x157)]?_0x35275d:{'default':_0x35275d};};function a584_0x28e0(){const _0x39315c=['../../models/OldMessage','replies','../../helpers/CheckSettings','length','../../errors/AppError','queue','__importDefault','(((.+)+)+)+$','search','12exEDLi','quotedMsg','companyId','contact','__esModule','message','default','sequelize','reverse','843564sFWEca','constructor','toString','../../models/Queue','defineProperty','queueId','7495cQpdNU','35944KxdfVX','1211dAGnxR','230EnzdxT','createdAt','oldMessages','apply','405406EzhvFG','../TicketServices/ShowTicketService','reactionMessage','where','1314nCIfwH','191853fvTVmn','DESC','6614003wZRcbB','1508806DCveND','findAndCountAll','GetCompanySetting'];a584_0x28e0=function(){return _0x39315c;};return a584_0x28e0();}Object[a584_0x1d1078(0x136)](exports,a584_0x1d1078(0x157),{'value':!![]});const sequelize_1=require(a584_0x1d1078(0x15a)),AppError_1=__importDefault(require(a584_0x1d1078(0x14e))),Message_1=__importDefault(require('../../models/Message')),OldMessage_1=__importDefault(require(a584_0x1d1078(0x14a))),ShowTicketService_1=__importDefault(require(a584_0x1d1078(0x140))),Queue_1=__importDefault(require(a584_0x1d1078(0x135))),CheckSettings_1=require(a584_0x1d1078(0x14c)),ListMessagesService=async({pageNumber:pageNumber='1',ticketId:_0x33fdef,companyId:_0x4c2f47,queues:queues=[]})=>{const _0xe47abd=a584_0x1d1078,_0x4026e9=await(0x0,ShowTicketService_1[_0xe47abd(0x159)])(_0x33fdef,_0x4c2f47);if(!_0x4026e9)throw new AppError_1[(_0xe47abd(0x159))]('ERR_NO_TICKET_FOUND',0x194);const _0xdc226b=0x64,_0x1614a4=_0xdc226b*(+pageNumber-0x1),_0x1dc874={'where':{'ticketId':_0x33fdef,'companyId':_0x4c2f47,'mediaType':{[sequelize_1['Op']['or']]:{[sequelize_1['Op']['ne']]:_0xe47abd(0x141),[sequelize_1['Op']['is']]:null}}}};queues[_0xe47abd(0x14d)]>0x0&&await(0x0,CheckSettings_1[_0xe47abd(0x149)])(_0x4c2f47,'messageVisibility',_0xe47abd(0x158))===_0xe47abd(0x158)&&(_0x1dc874[_0xe47abd(0x142)][_0xe47abd(0x137)]={[sequelize_1['Op']['or']]:{[sequelize_1['Op']['in']]:queues,[sequelize_1['Op']['eq']]:null}});const {count:_0x5a2a9d,rows:_0x1690cb}=await Message_1[_0xe47abd(0x159)][_0xe47abd(0x148)]({..._0x1dc874,'limit':_0xdc226b,'include':[_0xe47abd(0x156),{'model':Message_1[_0xe47abd(0x159)],'as':_0xe47abd(0x154),'include':[_0xe47abd(0x156)],'where':{'companyId':_0x4026e9[_0xe47abd(0x155)]},'required':![]},{'model':OldMessage_1[_0xe47abd(0x159)],'as':_0xe47abd(0x13d),'where':{'ticketId':_0x4026e9['id']},'required':![]},{'model':Message_1['default'],'as':_0xe47abd(0x14b),'where':{'ticketId':_0x4026e9['id']},'include':[_0xe47abd(0x156)],'required':![]},{'model':Queue_1[_0xe47abd(0x159)],'as':_0xe47abd(0x14f)}],'offset':_0x1614a4,'order':[[_0xe47abd(0x13c),_0xe47abd(0x145)]]}),_0x3f6fe0=_0x5a2a9d>_0x1614a4+_0x1690cb['length'];return{'messages':_0x1690cb[_0xe47abd(0x15b)](),'ticket':_0x4026e9,'count':_0x5a2a9d,'hasMore':_0x3f6fe0};};exports[a584_0x1d1078(0x159)]=ListMessagesService;