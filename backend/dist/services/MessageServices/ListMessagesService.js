const a479_0x262a71=a479_0x5e04;(function(_0x1c3cd6,_0x4e9f07){const _0x5d8997=a479_0x5e04,_0x594374=_0x1c3cd6();while(!![]){try{const _0x199384=-parseInt(_0x5d8997(0x18b))/0x1+-parseInt(_0x5d8997(0x188))/0x2*(-parseInt(_0x5d8997(0x189))/0x3)+parseInt(_0x5d8997(0x19e))/0x4+parseInt(_0x5d8997(0x190))/0x5*(parseInt(_0x5d8997(0x1a0))/0x6)+-parseInt(_0x5d8997(0x185))/0x7*(-parseInt(_0x5d8997(0x18f))/0x8)+parseInt(_0x5d8997(0x18d))/0x9+parseInt(_0x5d8997(0x1a2))/0xa*(-parseInt(_0x5d8997(0x195))/0xb);if(_0x199384===_0x4e9f07)break;else _0x594374['push'](_0x594374['shift']());}catch(_0x417820){_0x594374['push'](_0x594374['shift']());}}}(a479_0x2256,0xb3127));const a479_0x2403e7=(function(){let _0x454fed=!![];return function(_0x53e232,_0x588977){const _0xf21e39=_0x454fed?function(){const _0x3e6e4c=a479_0x5e04;if(_0x588977){const _0x1bc30d=_0x588977[_0x3e6e4c(0x199)](_0x53e232,arguments);return _0x588977=null,_0x1bc30d;}}:function(){};return _0x454fed=![],_0xf21e39;};}()),a479_0x5e96c8=a479_0x2403e7(this,function(){const _0xc52418=a479_0x5e04;return a479_0x5e96c8[_0xc52418(0x1a3)]()[_0xc52418(0x19b)]('(((.+)+)+)+$')[_0xc52418(0x1a3)]()[_0xc52418(0x19d)](a479_0x5e96c8)[_0xc52418(0x19b)](_0xc52418(0x18c));});a479_0x5e96c8();'use strict';function a479_0x5e04(_0x19ac7d,_0x117446){const _0x4cceef=a479_0x2256();return a479_0x5e04=function(_0x5e96c8,_0x2403e7){_0x5e96c8=_0x5e96c8-0x180;let _0x225649=_0x4cceef[_0x5e96c8];return _0x225649;},a479_0x5e04(_0x19ac7d,_0x117446);}var __importDefault=this&&this[a479_0x262a71(0x194)]||function(_0x146946){const _0x43699a=a479_0x262a71;return _0x146946&&_0x146946[_0x43699a(0x181)]?_0x146946:{'default':_0x146946};};function a479_0x2256(){const _0x59e73c=['where','564156FzWUvW','default','250FnPIAW','toString','companyId','__esModule','../../models/OldMessage','reverse','message','182krhJgV','../../models/Queue','../../models/Message','2491948ERPtnU','3mXDqEO','queue','985260wcFrgO','(((.+)+)+)+$','2431125Bllech','replies','89928HmVWSI','5rtiXJn','defineProperty','contact','findAndCountAll','__importDefault','330396WTagxX','oldMessages','quotedMsg','ERR_NO_TICKET_FOUND','apply','../../errors/AppError','search','length','constructor','2268992qAxTlO'];a479_0x2256=function(){return _0x59e73c;};return a479_0x2256();}Object[a479_0x262a71(0x191)](exports,'__esModule',{'value':!![]});const sequelize_1=require('sequelize'),AppError_1=__importDefault(require(a479_0x262a71(0x19a))),Message_1=__importDefault(require(a479_0x262a71(0x187))),OldMessage_1=__importDefault(require(a479_0x262a71(0x182))),ShowTicketService_1=__importDefault(require('../TicketServices/ShowTicketService')),Queue_1=__importDefault(require(a479_0x262a71(0x186))),CheckSettings_1=require('../../helpers/CheckSettings'),ListMessagesService=async({pageNumber:pageNumber='1',ticketId:_0x4951da,companyId:_0x3ccaa9,queues:queues=[]})=>{const _0x55e161=a479_0x262a71,_0x845d1e=await(0x0,ShowTicketService_1[_0x55e161(0x1a1)])(_0x4951da,_0x3ccaa9);if(!_0x845d1e)throw new AppError_1['default'](_0x55e161(0x198),0x194);const _0xbce1f4=0x64,_0x5e7bef=_0xbce1f4*(+pageNumber-0x1),_0x3d2bed={'where':{'ticketId':_0x4951da,'companyId':_0x3ccaa9,'mediaType':{[sequelize_1['Op']['or']]:{[sequelize_1['Op']['ne']]:'reactionMessage',[sequelize_1['Op']['is']]:null}}}};queues[_0x55e161(0x19c)]>0x0&&await(0x0,CheckSettings_1['GetCompanySetting'])(_0x3ccaa9,'messageVisibility',_0x55e161(0x184))===_0x55e161(0x184)&&(_0x3d2bed[_0x55e161(0x19f)]['queueId']={[sequelize_1['Op']['or']]:{[sequelize_1['Op']['in']]:queues,[sequelize_1['Op']['eq']]:null}});const {count:_0x2a8034,rows:_0x1a3baa}=await Message_1['default'][_0x55e161(0x193)]({..._0x3d2bed,'limit':_0xbce1f4,'include':[_0x55e161(0x192),{'model':Message_1[_0x55e161(0x1a1)],'as':_0x55e161(0x197),'include':[_0x55e161(0x192)],'where':{'companyId':_0x845d1e[_0x55e161(0x180)]},'required':![]},{'model':OldMessage_1[_0x55e161(0x1a1)],'as':_0x55e161(0x196),'where':{'ticketId':_0x845d1e['id']},'required':![]},{'model':Message_1[_0x55e161(0x1a1)],'as':_0x55e161(0x18e),'where':{'ticketId':_0x845d1e['id']},'include':[_0x55e161(0x192)],'required':![]},{'model':Queue_1[_0x55e161(0x1a1)],'as':_0x55e161(0x18a)}],'offset':_0x5e7bef,'order':[['createdAt','DESC']]}),_0x275447=_0x2a8034>_0x5e7bef+_0x1a3baa['length'];return{'messages':_0x1a3baa[_0x55e161(0x183)](),'ticket':_0x845d1e,'count':_0x2a8034,'hasMore':_0x275447};};exports[a479_0x262a71(0x1a1)]=ListMessagesService;