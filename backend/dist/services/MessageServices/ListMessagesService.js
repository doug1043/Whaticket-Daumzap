const a474_0xeae5a6=a474_0x1a13;(function(_0x50c993,_0x203b32){const _0x3931a4=a474_0x1a13,_0x49c2a5=_0x50c993();while(!![]){try{const _0x3024ae=parseInt(_0x3931a4(0xfa))/0x1*(parseInt(_0x3931a4(0x106))/0x2)+-parseInt(_0x3931a4(0xf4))/0x3+-parseInt(_0x3931a4(0x110))/0x4+-parseInt(_0x3931a4(0xee))/0x5*(parseInt(_0x3931a4(0xf3))/0x6)+-parseInt(_0x3931a4(0x10f))/0x7*(-parseInt(_0x3931a4(0x101))/0x8)+parseInt(_0x3931a4(0x104))/0x9*(-parseInt(_0x3931a4(0xfd))/0xa)+parseInt(_0x3931a4(0xef))/0xb*(parseInt(_0x3931a4(0xf7))/0xc);if(_0x3024ae===_0x203b32)break;else _0x49c2a5['push'](_0x49c2a5['shift']());}catch(_0xb8db57){_0x49c2a5['push'](_0x49c2a5['shift']());}}}(a474_0x1d90,0xd318d));const a474_0x5698c1=(function(){let _0x688ba2=!![];return function(_0x1f6a73,_0x2b9a4b){const _0x43e6c8=_0x688ba2?function(){const _0x38f53c=a474_0x1a13;if(_0x2b9a4b){const _0x3027a2=_0x2b9a4b[_0x38f53c(0xfb)](_0x1f6a73,arguments);return _0x2b9a4b=null,_0x3027a2;}}:function(){};return _0x688ba2=![],_0x43e6c8;};}()),a474_0x5d610e=a474_0x5698c1(this,function(){const _0x66067e=a474_0x1a13;return a474_0x5d610e[_0x66067e(0x109)]()[_0x66067e(0xf6)](_0x66067e(0xfc))[_0x66067e(0x109)]()['constructor'](a474_0x5d610e)[_0x66067e(0xf6)](_0x66067e(0xfc));});a474_0x5d610e();'use strict';var __importDefault=this&&this['__importDefault']||function(_0x4c086d){const _0x4cb5fa=a474_0x1a13;return _0x4c086d&&_0x4c086d[_0x4cb5fa(0xf9)]?_0x4c086d:{'default':_0x4c086d};};Object[a474_0xeae5a6(0x10e)](exports,a474_0xeae5a6(0xf9),{'value':!![]});const sequelize_1=require('sequelize'),AppError_1=__importDefault(require('../../errors/AppError')),Message_1=__importDefault(require(a474_0xeae5a6(0x10b))),OldMessage_1=__importDefault(require(a474_0xeae5a6(0xf8))),ShowTicketService_1=__importDefault(require(a474_0xeae5a6(0x100))),Queue_1=__importDefault(require('../../models/Queue')),CheckSettings_1=require(a474_0xeae5a6(0xed)),ListMessagesService=async({pageNumber:pageNumber='1',ticketId:_0x2062c0,companyId:_0x27d20b,queues:queues=[]})=>{const _0x3649e=a474_0xeae5a6,_0x38587e=await(0x0,ShowTicketService_1[_0x3649e(0x10a)])(_0x2062c0,_0x27d20b);if(!_0x38587e)throw new AppError_1[(_0x3649e(0x10a))]('ERR_NO_TICKET_FOUND',0x194);const _0x6e4e48=0x64,_0x157b42=_0x6e4e48*(+pageNumber-0x1),_0xc0947d={'where':{'ticketId':_0x2062c0,'companyId':_0x27d20b,'mediaType':{[sequelize_1['Op']['or']]:{[sequelize_1['Op']['ne']]:_0x3649e(0xf0),[sequelize_1['Op']['is']]:null}}}};queues['length']>0x0&&await(0x0,CheckSettings_1[_0x3649e(0xff)])(_0x27d20b,_0x3649e(0xf2),'message')==='message'&&(_0xc0947d['where'][_0x3649e(0xf1)]={[sequelize_1['Op']['or']]:{[sequelize_1['Op']['in']]:queues,[sequelize_1['Op']['eq']]:null}});const {count:_0x2bc25b,rows:_0x172b65}=await Message_1['default'][_0x3649e(0x102)]({..._0xc0947d,'limit':_0x6e4e48,'include':[_0x3649e(0x105),{'model':Message_1['default'],'as':_0x3649e(0x10d),'include':[_0x3649e(0x105)],'where':{'companyId':_0x38587e[_0x3649e(0x103)]},'required':![]},{'model':OldMessage_1[_0x3649e(0x10a)],'as':_0x3649e(0xf5),'where':{'ticketId':_0x38587e['id']},'required':![]},{'model':Message_1[_0x3649e(0x10a)],'as':'replies','where':{'ticketId':_0x38587e['id']},'include':[_0x3649e(0x105)],'required':![]},{'model':Queue_1['default'],'as':_0x3649e(0xfe)}],'offset':_0x157b42,'order':[[_0x3649e(0x108),_0x3649e(0x107)]]}),_0x139bba=_0x2bc25b>_0x157b42+_0x172b65['length'];return{'messages':_0x172b65[_0x3649e(0x10c)](),'ticket':_0x38587e,'count':_0x2bc25b,'hasMore':_0x139bba};};function a474_0x1d90(){const _0x3f93bf=['1540kXoykH','queue','GetCompanySetting','../TicketServices/ShowTicketService','7880872mmuzlh','findAndCountAll','companyId','60741abQdtR','contact','1719290QLwqZI','DESC','createdAt','toString','default','../../models/Message','reverse','quotedMsg','defineProperty','7OQmMYG','967440PMETsw','../../helpers/CheckSettings','85uvXgPQ','11ZufGZj','reactionMessage','queueId','messageVisibility','276546IxUQpx','4184709QilpZE','oldMessages','search','19438920dVxzIQ','../../models/OldMessage','__esModule','2EQIqKQ','apply','(((.+)+)+)+$'];a474_0x1d90=function(){return _0x3f93bf;};return a474_0x1d90();}function a474_0x1a13(_0x4c8c5a,_0x5e471e){const _0x375a0a=a474_0x1d90();return a474_0x1a13=function(_0x5d610e,_0x5698c1){_0x5d610e=_0x5d610e-0xed;let _0x1d90c7=_0x375a0a[_0x5d610e];return _0x1d90c7;},a474_0x1a13(_0x4c8c5a,_0x5e471e);}exports[a474_0xeae5a6(0x10a)]=ListMessagesService;