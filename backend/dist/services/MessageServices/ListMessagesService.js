const a583_0x595934=a583_0x967d;(function(_0x227507,_0x250cf8){const _0x4990e1=a583_0x967d,_0x2868da=_0x227507();while(!![]){try{const _0xfa1a29=parseInt(_0x4990e1(0x17c))/0x1*(-parseInt(_0x4990e1(0x176))/0x2)+-parseInt(_0x4990e1(0x180))/0x3+-parseInt(_0x4990e1(0x16a))/0x4*(-parseInt(_0x4990e1(0x182))/0x5)+parseInt(_0x4990e1(0x16c))/0x6*(-parseInt(_0x4990e1(0x169))/0x7)+parseInt(_0x4990e1(0x174))/0x8*(parseInt(_0x4990e1(0x177))/0x9)+-parseInt(_0x4990e1(0x164))/0xa+parseInt(_0x4990e1(0x162))/0xb;if(_0xfa1a29===_0x250cf8)break;else _0x2868da['push'](_0x2868da['shift']());}catch(_0x78884e){_0x2868da['push'](_0x2868da['shift']());}}}(a583_0x3edd,0x832ad));const a583_0x3a3cbc=(function(){let _0x580afb=!![];return function(_0x244a83,_0x5e0a93){const _0x212015=_0x580afb?function(){const _0x20e79a=a583_0x967d;if(_0x5e0a93){const _0xa500e0=_0x5e0a93[_0x20e79a(0x17d)](_0x244a83,arguments);return _0x5e0a93=null,_0xa500e0;}}:function(){};return _0x580afb=![],_0x212015;};}()),a583_0x15c6ae=a583_0x3a3cbc(this,function(){const _0x149bbf=a583_0x967d;return a583_0x15c6ae[_0x149bbf(0x161)]()['search'](_0x149bbf(0x166))['toString']()['constructor'](a583_0x15c6ae)['search'](_0x149bbf(0x166));});function a583_0x3edd(){const _0x9ec82b=['72HeYIcN','../../errors/AppError','quotedMsg','../TicketServices/ShowTicketService','messageVisibility','172267DfOPHg','apply','../../models/Message','reverse','102102QoaEeG','ERR_NO_TICKET_FOUND','915ALMsPy','queue','default','length','contact','../../models/OldMessage','companyId','toString','6183628IaYZgs','DESC','6050910KBRQCn','replies','(((.+)+)+)+$','../../helpers/CheckSettings','queueId','56FFmcnw','20796wJFZSw','defineProperty','125274fPYpro','../../models/Queue','message','createdAt','GetCompanySetting','__esModule','findAndCountAll','reactionMessage','2120xzYlqc','sequelize','2IPFchd'];a583_0x3edd=function(){return _0x9ec82b;};return a583_0x3edd();}function a583_0x967d(_0x1cd31b,_0x22d091){const _0x249d72=a583_0x3edd();return a583_0x967d=function(_0x15c6ae,_0x3a3cbc){_0x15c6ae=_0x15c6ae-0x15d;let _0x3edd3f=_0x249d72[_0x15c6ae];return _0x3edd3f;},a583_0x967d(_0x1cd31b,_0x22d091);}a583_0x15c6ae();'use strict';var __importDefault=this&&this['__importDefault']||function(_0x388e91){const _0x2426c5=a583_0x967d;return _0x388e91&&_0x388e91[_0x2426c5(0x171)]?_0x388e91:{'default':_0x388e91};};Object[a583_0x595934(0x16b)](exports,a583_0x595934(0x171),{'value':!![]});const sequelize_1=require(a583_0x595934(0x175)),AppError_1=__importDefault(require(a583_0x595934(0x178))),Message_1=__importDefault(require(a583_0x595934(0x17e))),OldMessage_1=__importDefault(require(a583_0x595934(0x15f))),ShowTicketService_1=__importDefault(require(a583_0x595934(0x17a))),Queue_1=__importDefault(require(a583_0x595934(0x16d))),CheckSettings_1=require(a583_0x595934(0x167)),ListMessagesService=async({pageNumber:pageNumber='1',ticketId:_0x3622da,companyId:_0x5ed1d8,queues:queues=[]})=>{const _0x37dc92=a583_0x595934,_0x8de6e8=await(0x0,ShowTicketService_1[_0x37dc92(0x184)])(_0x3622da,_0x5ed1d8);if(!_0x8de6e8)throw new AppError_1[(_0x37dc92(0x184))](_0x37dc92(0x181),0x194);const _0x3b9a52=0x64,_0x17bbd6=_0x3b9a52*(+pageNumber-0x1),_0x5ee4f9={'where':{'ticketId':_0x3622da,'companyId':_0x5ed1d8,'mediaType':{[sequelize_1['Op']['or']]:{[sequelize_1['Op']['ne']]:_0x37dc92(0x173),[sequelize_1['Op']['is']]:null}}}};queues['length']>0x0&&await(0x0,CheckSettings_1[_0x37dc92(0x170)])(_0x5ed1d8,_0x37dc92(0x17b),_0x37dc92(0x16e))==='message'&&(_0x5ee4f9['where'][_0x37dc92(0x168)]={[sequelize_1['Op']['or']]:{[sequelize_1['Op']['in']]:queues,[sequelize_1['Op']['eq']]:null}});const {count:_0x5e36cb,rows:_0x2e2cc3}=await Message_1[_0x37dc92(0x184)][_0x37dc92(0x172)]({..._0x5ee4f9,'limit':_0x3b9a52,'include':['contact',{'model':Message_1[_0x37dc92(0x184)],'as':_0x37dc92(0x179),'include':['contact'],'where':{'companyId':_0x8de6e8[_0x37dc92(0x160)]},'required':![]},{'model':OldMessage_1[_0x37dc92(0x184)],'as':'oldMessages','where':{'ticketId':_0x8de6e8['id']},'required':![]},{'model':Message_1[_0x37dc92(0x184)],'as':_0x37dc92(0x165),'where':{'ticketId':_0x8de6e8['id']},'include':[_0x37dc92(0x15e)],'required':![]},{'model':Queue_1[_0x37dc92(0x184)],'as':_0x37dc92(0x183)}],'offset':_0x17bbd6,'order':[[_0x37dc92(0x16f),_0x37dc92(0x163)]]}),_0x2cf29c=_0x5e36cb>_0x17bbd6+_0x2e2cc3[_0x37dc92(0x15d)];return{'messages':_0x2e2cc3[_0x37dc92(0x17f)](),'ticket':_0x8de6e8,'count':_0x5e36cb,'hasMore':_0x2cf29c};};exports[a583_0x595934(0x184)]=ListMessagesService;