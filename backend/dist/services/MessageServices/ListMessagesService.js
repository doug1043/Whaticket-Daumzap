const a480_0xb66dd6=a480_0x3c6d;(function(_0x95d9a1,_0x542144){const _0x3bc36a=a480_0x3c6d,_0x31b7b9=_0x95d9a1();while(!![]){try{const _0x4bcf90=parseInt(_0x3bc36a(0x1e5))/0x1*(-parseInt(_0x3bc36a(0x1d4))/0x2)+-parseInt(_0x3bc36a(0x1e1))/0x3+-parseInt(_0x3bc36a(0x1dd))/0x4*(parseInt(_0x3bc36a(0x1d5))/0x5)+parseInt(_0x3bc36a(0x1d8))/0x6+-parseInt(_0x3bc36a(0x1db))/0x7+-parseInt(_0x3bc36a(0x1d9))/0x8+parseInt(_0x3bc36a(0x1d3))/0x9*(parseInt(_0x3bc36a(0x1cb))/0xa);if(_0x4bcf90===_0x542144)break;else _0x31b7b9['push'](_0x31b7b9['shift']());}catch(_0x542814){_0x31b7b9['push'](_0x31b7b9['shift']());}}}(a480_0x4d54,0xb2a7e));const a480_0x4a45c9=(function(){let _0x421fef=!![];return function(_0x654af6,_0x399f0f){const _0x1108c4=_0x421fef?function(){const _0x1e501f=a480_0x3c6d;if(_0x399f0f){const _0x50a3b8=_0x399f0f[_0x1e501f(0x1c9)](_0x654af6,arguments);return _0x399f0f=null,_0x50a3b8;}}:function(){};return _0x421fef=![],_0x1108c4;};}()),a480_0x51f339=a480_0x4a45c9(this,function(){const _0x8dfad2=a480_0x3c6d;return a480_0x51f339[_0x8dfad2(0x1de)]()[_0x8dfad2(0x1c6)](_0x8dfad2(0x1e4))[_0x8dfad2(0x1de)]()['constructor'](a480_0x51f339)['search'](_0x8dfad2(0x1e4));});a480_0x51f339();'use strict';function a480_0x3c6d(_0x3c0c51,_0x49bc50){const _0x543d6c=a480_0x4d54();return a480_0x3c6d=function(_0x51f339,_0x4a45c9){_0x51f339=_0x51f339-0x1c5;let _0x4d54b1=_0x543d6c[_0x51f339];return _0x4d54b1;},a480_0x3c6d(_0x3c0c51,_0x49bc50);}var __importDefault=this&&this['__importDefault']||function(_0x449a60){const _0x4b69c7=a480_0x3c6d;return _0x449a60&&_0x449a60[_0x4b69c7(0x1d6)]?_0x449a60:{'default':_0x449a60};};Object[a480_0xb66dd6(0x1e3)](exports,'__esModule',{'value':!![]});const sequelize_1=require('sequelize'),AppError_1=__importDefault(require('../../errors/AppError')),Message_1=__importDefault(require(a480_0xb66dd6(0x1e0))),OldMessage_1=__importDefault(require(a480_0xb66dd6(0x1cf))),ShowTicketService_1=__importDefault(require(a480_0xb66dd6(0x1df))),Queue_1=__importDefault(require(a480_0xb66dd6(0x1d7))),CheckSettings_1=require(a480_0xb66dd6(0x1d1)),ListMessagesService=async({pageNumber:pageNumber='1',ticketId:_0x16214d,companyId:_0x1d891d,queues:queues=[]})=>{const _0x43bcbb=a480_0xb66dd6,_0x248d3b=await(0x0,ShowTicketService_1[_0x43bcbb(0x1cd)])(_0x16214d,_0x1d891d);if(!_0x248d3b)throw new AppError_1['default']('ERR_NO_TICKET_FOUND',0x194);const _0x333c8c=0x64,_0x4aae2f=_0x333c8c*(+pageNumber-0x1),_0x421663={'where':{'ticketId':_0x16214d,'companyId':_0x1d891d,'mediaType':{[sequelize_1['Op']['or']]:{[sequelize_1['Op']['ne']]:'reactionMessage',[sequelize_1['Op']['is']]:null}}}};queues[_0x43bcbb(0x1dc)]>0x0&&await(0x0,CheckSettings_1['GetCompanySetting'])(_0x1d891d,_0x43bcbb(0x1e2),_0x43bcbb(0x1da))===_0x43bcbb(0x1da)&&(_0x421663[_0x43bcbb(0x1ca)][_0x43bcbb(0x1cc)]={[sequelize_1['Op']['or']]:{[sequelize_1['Op']['in']]:queues,[sequelize_1['Op']['eq']]:null}});const {count:_0x4c99f3,rows:_0x11eed4}=await Message_1[_0x43bcbb(0x1cd)][_0x43bcbb(0x1d0)]({..._0x421663,'limit':_0x333c8c,'include':[_0x43bcbb(0x1c8),{'model':Message_1[_0x43bcbb(0x1cd)],'as':'quotedMsg','include':[_0x43bcbb(0x1c8)],'where':{'companyId':_0x248d3b['companyId']},'required':![]},{'model':OldMessage_1[_0x43bcbb(0x1cd)],'as':'oldMessages','where':{'ticketId':_0x248d3b['id']},'required':![]},{'model':Message_1[_0x43bcbb(0x1cd)],'as':_0x43bcbb(0x1c5),'where':{'ticketId':_0x248d3b['id']},'include':[_0x43bcbb(0x1c8)],'required':![]},{'model':Queue_1[_0x43bcbb(0x1cd)],'as':_0x43bcbb(0x1d2)}],'offset':_0x4aae2f,'order':[['createdAt',_0x43bcbb(0x1ce)]]}),_0x33be38=_0x4c99f3>_0x4aae2f+_0x11eed4[_0x43bcbb(0x1dc)];return{'messages':_0x11eed4[_0x43bcbb(0x1c7)](),'ticket':_0x248d3b,'count':_0x4c99f3,'hasMore':_0x33be38};};function a480_0x4d54(){const _0x1d611c=['messageVisibility','defineProperty','(((.+)+)+)+$','431iBDczA','replies','search','reverse','contact','apply','where','180OSRxbJ','queueId','default','DESC','../../models/OldMessage','findAndCountAll','../../helpers/CheckSettings','queue','2235006BiwECG','6434WIGgfe','15MutJGE','__esModule','../../models/Queue','5297976OWJDRm','11578168QeFAzD','message','4712022bZeqcy','length','1191196xgonUi','toString','../TicketServices/ShowTicketService','../../models/Message','662679xMcEYM'];a480_0x4d54=function(){return _0x1d611c;};return a480_0x4d54();}exports[a480_0xb66dd6(0x1cd)]=ListMessagesService;