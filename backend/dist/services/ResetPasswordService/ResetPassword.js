const a494_0x4def62=a494_0x1373;(function(_0x3c6566,_0xe133d1){const _0x4c928f=a494_0x1373,_0x306a44=_0x3c6566();while(!![]){try{const _0x431149=-parseInt(_0x4c928f(0x1e7))/0x1+-parseInt(_0x4c928f(0x1df))/0x2+parseInt(_0x4c928f(0x1dc))/0x3*(-parseInt(_0x4c928f(0x1db))/0x4)+parseInt(_0x4c928f(0x1da))/0x5+parseInt(_0x4c928f(0x1e2))/0x6+parseInt(_0x4c928f(0x1cd))/0x7*(parseInt(_0x4c928f(0x1d4))/0x8)+parseInt(_0x4c928f(0x1e1))/0x9;if(_0x431149===_0xe133d1)break;else _0x306a44['push'](_0x306a44['shift']());}catch(_0x443ece){_0x306a44['push'](_0x306a44['shift']());}}}(a494_0x274e,0xc9e25));const a494_0x225a48=(function(){let _0x2a4c3c=!![];return function(_0x513422,_0xcdb618){const _0xd7a49f=_0x2a4c3c?function(){const _0x27c8f1=a494_0x1373;if(_0xcdb618){const _0x3a80f6=_0xcdb618[_0x27c8f1(0x1c4)](_0x513422,arguments);return _0xcdb618=null,_0x3a80f6;}}:function(){};return _0x2a4c3c=![],_0xd7a49f;};}()),a494_0x126da4=a494_0x225a48(this,function(){const _0x39f23c=a494_0x1373;return a494_0x126da4[_0x39f23c(0x1c6)]()[_0x39f23c(0x1e0)]('(((.+)+)+)+$')[_0x39f23c(0x1c6)]()[_0x39f23c(0x1d3)](a494_0x126da4)['search'](_0x39f23c(0x1d0));});a494_0x126da4();'use strict';function a494_0x274e(){const _0xf87e75=['Email\x20ou\x20token\x20não\x20encontrado','constructor','14584fnCQvC','Senha\x20Alterada\x20com\x20Sucesso','sequelize','UPDATE\x20\x22Users\x22\x20SET\x20\x22passwordHash\x22=\x20\x27','all','SELECT','2116300pjJEOC','12732YMFjJj','99UDNJcR','Erro\x20interno\x20do\x20servidor','\x27,\x20\x22resetPassword\x22\x20=\x20\x27\x27\x20WHERE\x20email=\x20\x27','1217440nIqftg','search','195516JtFiwx','1961682lVVBlq','clientsecretsmtpauth','Token\x20não\x20encontrado\x20ou\x20inválido','default','__importDefault','222967cUcsTa','bcryptjs','smtpauth','query','length','nodemailer','SELECT\x20*\x20FROM\x20\x22Users\x22\x20WHERE\x20email\x20=\x20\x27','findOne','usersmtpauth','apply','\x27\x20AND\x20\x22resetPassword\x22\x20=\x20\x27','toString','\x27\x20AND\x20\x22resetPassword\x22\x20!=\x20\x27\x27','QueryTypes','../../models/Setting','value','__esModule','Olá,\x0a\x0aSua\x20senha\x20foi\x20alterada\x20com\x20sucesso.\x0a\x0aSe\x20você\x20não\x20realizou\x20essa\x20alteração,\x20entre\x20em\x20contato\x20conosco\x20imediatamente.\x0a\x0aAtenciosamente','3808ptvUtW','smtpport','UPDATE','(((.+)+)+)+$','createTransport'];a494_0x274e=function(){return _0xf87e75;};return a494_0x274e();}function a494_0x1373(_0x5ab416,_0x34e483){const _0x2ef5df=a494_0x274e();return a494_0x1373=function(_0x126da4,_0x225a48){_0x126da4=_0x126da4-0x1bd;let _0x274e96=_0x2ef5df[_0x126da4];return _0x274e96;},a494_0x1373(_0x5ab416,_0x34e483);}var __importDefault=this&&this[a494_0x4def62(0x1e6)]||function(_0x5786ab){const _0x11c218=a494_0x4def62;return _0x5786ab&&_0x5786ab[_0x11c218(0x1cb)]?_0x5786ab:{'default':_0x5786ab};};Object['defineProperty'](exports,a494_0x4def62(0x1cb),{'value':!![]});const sequelize_1=__importDefault(require(a494_0x4def62(0x1d6))),database_1=__importDefault(require('../../database')),nodemailer_1=__importDefault(require(a494_0x4def62(0x1c0))),Setting_1=__importDefault(require(a494_0x4def62(0x1c9))),bcryptjs_1=require(a494_0x4def62(0x1e8)),ResetPassword=async(_0x39fe6f,_0x289a93,_0x474cdf)=>{const _0x2091a4=a494_0x4def62;try{const {hasResult:_0x48afd1,data:_0x3e7ab3}=await filterUser(_0x39fe6f,_0x289a93);if(!_0x48afd1)return{'status':0x194,'message':_0x2091a4(0x1d2)};const _0x5e9e6f=await(0x0,bcryptjs_1['hash'])(_0x474cdf,0x8),{hasResults:_0x29d15c,datas:_0x4c5a38}=await insertHasPassword(_0x39fe6f,_0x289a93,_0x5e9e6f);if(!_0x29d15c)return{'status':0x194,'message':_0x2091a4(0x1e4)};const [_0x2e8221,_0x1496fb,_0x1ebddc,_0x3e64b3]=await Promise[_0x2091a4(0x1d8)]([Setting_1[_0x2091a4(0x1e5)][_0x2091a4(0x1c2)]({'where':{'key':_0x2091a4(0x1bd)}}),Setting_1[_0x2091a4(0x1e5)]['findOne']({'where':{'key':_0x2091a4(0x1c3)}}),Setting_1[_0x2091a4(0x1e5)]['findOne']({'where':{'key':_0x2091a4(0x1e3)}}),Setting_1[_0x2091a4(0x1e5)]['findOne']({'where':{'key':_0x2091a4(0x1ce)}})]),_0x506f6b=_0x2e8221?.[_0x2091a4(0x1ca)],_0x405237=_0x1496fb?.[_0x2091a4(0x1ca)],_0x33a30e=_0x1ebddc?.['value'],_0x24fdd8=_0x405237,_0x311827=_0x3e64b3?.['value'];if(!_0x506f6b||!_0x405237||!_0x33a30e||!_0x311827)throw new Error('Configurações\x20SMTP\x20estão\x20incompletas');const _0x46a299=nodemailer_1[_0x2091a4(0x1e5)][_0x2091a4(0x1d1)]({'host':_0x506f6b,'port':Number(_0x311827),'secure':![],'auth':{'user':_0x405237,'pass':_0x33a30e}}),_0x4b2987={'from':_0x24fdd8,'to':_0x39fe6f,'subject':_0x2091a4(0x1d5),'text':_0x2091a4(0x1cc)},_0x48f187=await _0x46a299['sendMail'](_0x4b2987);return _0x48f187;}catch(_0x57151e){return console['error']('Erro\x20ao\x20redefinir\x20senha:',_0x57151e),{'status':0x1f4,'message':_0x2091a4(0x1dd)};}},filterUser=async(_0x15108b,_0x572722)=>{const _0x386cba=a494_0x4def62,_0x5da6b3=_0x386cba(0x1c1)+_0x15108b+_0x386cba(0x1c7),_0x558c55=await database_1[_0x386cba(0x1e5)][_0x386cba(0x1be)](_0x5da6b3,{'type':sequelize_1[_0x386cba(0x1e5)]['QueryTypes']['SELECT']});return{'hasResult':_0x558c55[_0x386cba(0x1bf)]>0x0,'data':_0x558c55};},insertHasPassword=async(_0x4c8738,_0x1cf914,_0x2b70da)=>{const _0x2b212a=a494_0x4def62,_0xfe616b=_0x2b212a(0x1c1)+_0x4c8738+_0x2b212a(0x1c5)+_0x1cf914+'\x27',_0x386904=await database_1[_0x2b212a(0x1e5)]['query'](_0xfe616b,{'type':sequelize_1[_0x2b212a(0x1e5)]['QueryTypes'][_0x2b212a(0x1d9)]}),_0x15b77c=_0x2b212a(0x1d7)+_0x2b70da+_0x2b212a(0x1de)+_0x4c8738+_0x2b212a(0x1c5)+_0x1cf914+'\x27',_0x446dc1=await database_1[_0x2b212a(0x1e5)][_0x2b212a(0x1be)](_0x15b77c,{'type':sequelize_1[_0x2b212a(0x1e5)][_0x2b212a(0x1c8)][_0x2b212a(0x1cf)]});return{'hasResults':_0x446dc1[0x1]>0x0,'datas':_0x386904};};exports[a494_0x4def62(0x1e5)]=ResetPassword;