const a491_0x59b40c=a491_0x518a;(function(_0x1c6377,_0x1dbb76){const _0x747aef=a491_0x518a,_0xc343c9=_0x1c6377();while(!![]){try{const _0x2b75d8=-parseInt(_0x747aef(0xc8))/0x1+-parseInt(_0x747aef(0xd8))/0x2+parseInt(_0x747aef(0xd5))/0x3*(parseInt(_0x747aef(0xf3))/0x4)+-parseInt(_0x747aef(0xee))/0x5*(-parseInt(_0x747aef(0xeb))/0x6)+-parseInt(_0x747aef(0xcb))/0x7*(-parseInt(_0x747aef(0xe4))/0x8)+parseInt(_0x747aef(0xdb))/0x9+parseInt(_0x747aef(0xf4))/0xa*(-parseInt(_0x747aef(0xc9))/0xb);if(_0x2b75d8===_0x1dbb76)break;else _0xc343c9['push'](_0xc343c9['shift']());}catch(_0x48069a){_0xc343c9['push'](_0xc343c9['shift']());}}}(a491_0x1f28,0xd2e3d));function a491_0x1f28(){const _0x3f848f=['\x27\x20AND\x20\x22resetPassword\x22\x20=\x20\x27','1808340ftiVIr','error','Olá,\x0a\x0aSua\x20senha\x20foi\x20alterada\x20com\x20sucesso.\x0a\x0aSe\x20você\x20não\x20realizou\x20essa\x20alteração,\x20entre\x20em\x20contato\x20conosco\x20imediatamente.\x0a\x0aAtenciosamente','25ajdIOv','constructor','sequelize','__esModule','clientsecretsmtpauth','1725940eiNnLR','14270RVGVNW','1092332rIQAMK','7799pnUrVi','(((.+)+)+)+$','252iixTad','apply','query','Token\x20não\x20encontrado\x20ou\x20inválido','value','smtpport','SELECT','UPDATE\x20\x22Users\x22\x20SET\x20\x22passwordHash\x22=\x20\x27','defineProperty','SELECT\x20*\x20FROM\x20\x22Users\x22\x20WHERE\x20email\x20=\x20\x27','6HrOseK','\x27,\x20\x22resetPassword\x22\x20=\x20\x27\x27\x20WHERE\x20email=\x20\x27','nodemailer','168138vyLkRU','findOne','smtpauth','4031937oSnYCv','QueryTypes','Email\x20ou\x20token\x20não\x20encontrado','usersmtpauth','../../models/Setting','search','\x27\x20AND\x20\x22resetPassword\x22\x20!=\x20\x27\x27','toString','Configurações\x20SMTP\x20estão\x20incompletas','52008lmtWks','bcryptjs','sendMail','Senha\x20Alterada\x20com\x20Sucesso','default','all'];a491_0x1f28=function(){return _0x3f848f;};return a491_0x1f28();}const a491_0x4d3325=(function(){let _0x153b2b=!![];return function(_0x246ace,_0x2631ba){const _0x28efc0=_0x153b2b?function(){const _0x5db339=a491_0x518a;if(_0x2631ba){const _0x539fb2=_0x2631ba[_0x5db339(0xcc)](_0x246ace,arguments);return _0x2631ba=null,_0x539fb2;}}:function(){};return _0x153b2b=![],_0x28efc0;};}()),a491_0x21dc16=a491_0x4d3325(this,function(){const _0x5b21cb=a491_0x518a;return a491_0x21dc16[_0x5b21cb(0xe2)]()[_0x5b21cb(0xe0)]('(((.+)+)+)+$')['toString']()[_0x5b21cb(0xef)](a491_0x21dc16)['search'](_0x5b21cb(0xca));});a491_0x21dc16();'use strict';var __importDefault=this&&this['__importDefault']||function(_0x5ce05e){const _0x6476e=a491_0x518a;return _0x5ce05e&&_0x5ce05e[_0x6476e(0xf1)]?_0x5ce05e:{'default':_0x5ce05e};};Object[a491_0x59b40c(0xd3)](exports,'__esModule',{'value':!![]});const sequelize_1=__importDefault(require(a491_0x59b40c(0xf0))),database_1=__importDefault(require('../../database')),nodemailer_1=__importDefault(require(a491_0x59b40c(0xd7))),Setting_1=__importDefault(require(a491_0x59b40c(0xdf))),bcryptjs_1=require(a491_0x59b40c(0xe5)),ResetPassword=async(_0x420a89,_0x3699dc,_0x47df70)=>{const _0x513605=a491_0x59b40c;try{const {hasResult:_0x1f231a,data:_0x4d29ab}=await filterUser(_0x420a89,_0x3699dc);if(!_0x1f231a)return{'status':0x194,'message':_0x513605(0xdd)};const _0x205e42=await(0x0,bcryptjs_1['hash'])(_0x47df70,0x8),{hasResults:_0x11b803,datas:_0x6c256}=await insertHasPassword(_0x420a89,_0x3699dc,_0x205e42);if(!_0x11b803)return{'status':0x194,'message':_0x513605(0xce)};const [_0x14b8b2,_0x53c04f,_0x1fe0e4,_0x1fafd8]=await Promise[_0x513605(0xe9)]([Setting_1[_0x513605(0xe8)][_0x513605(0xd9)]({'where':{'key':_0x513605(0xda)}}),Setting_1[_0x513605(0xe8)][_0x513605(0xd9)]({'where':{'key':_0x513605(0xde)}}),Setting_1[_0x513605(0xe8)][_0x513605(0xd9)]({'where':{'key':_0x513605(0xf2)}}),Setting_1[_0x513605(0xe8)][_0x513605(0xd9)]({'where':{'key':_0x513605(0xd0)}})]),_0x4b7dc6=_0x14b8b2?.[_0x513605(0xcf)],_0x251f66=_0x53c04f?.['value'],_0x1c06c0=_0x1fe0e4?.[_0x513605(0xcf)],_0x1566af=_0x251f66,_0x1f6dcd=_0x1fafd8?.[_0x513605(0xcf)];if(!_0x4b7dc6||!_0x251f66||!_0x1c06c0||!_0x1f6dcd)throw new Error(_0x513605(0xe3));const _0x19aac8=nodemailer_1['default']['createTransport']({'host':_0x4b7dc6,'port':Number(_0x1f6dcd),'secure':![],'auth':{'user':_0x251f66,'pass':_0x1c06c0}}),_0x253d96={'from':_0x1566af,'to':_0x420a89,'subject':_0x513605(0xe7),'text':_0x513605(0xed)},_0x3cd056=await _0x19aac8[_0x513605(0xe6)](_0x253d96);return _0x3cd056;}catch(_0x1f7bb7){return console[_0x513605(0xec)]('Erro\x20ao\x20redefinir\x20senha:',_0x1f7bb7),{'status':0x1f4,'message':'Erro\x20interno\x20do\x20servidor'};}},filterUser=async(_0x547e6a,_0x3f36c8)=>{const _0x5a5af9=a491_0x59b40c,_0x68cd2f=_0x5a5af9(0xd4)+_0x547e6a+_0x5a5af9(0xe1),_0x4dd742=await database_1[_0x5a5af9(0xe8)][_0x5a5af9(0xcd)](_0x68cd2f,{'type':sequelize_1[_0x5a5af9(0xe8)]['QueryTypes'][_0x5a5af9(0xd1)]});return{'hasResult':_0x4dd742['length']>0x0,'data':_0x4dd742};},insertHasPassword=async(_0x2dd988,_0x5a8eea,_0x4c1c59)=>{const _0xc6108c=a491_0x59b40c,_0x14eb5f=_0xc6108c(0xd4)+_0x2dd988+_0xc6108c(0xea)+_0x5a8eea+'\x27',_0xb6c383=await database_1[_0xc6108c(0xe8)][_0xc6108c(0xcd)](_0x14eb5f,{'type':sequelize_1[_0xc6108c(0xe8)][_0xc6108c(0xdc)]['SELECT']}),_0x35417b=_0xc6108c(0xd2)+_0x4c1c59+_0xc6108c(0xd6)+_0x2dd988+_0xc6108c(0xea)+_0x5a8eea+'\x27',_0xbd52a7=await database_1[_0xc6108c(0xe8)][_0xc6108c(0xcd)](_0x35417b,{'type':sequelize_1[_0xc6108c(0xe8)][_0xc6108c(0xdc)]['UPDATE']});return{'hasResults':_0xbd52a7[0x1]>0x0,'datas':_0xb6c383};};function a491_0x518a(_0x2778c7,_0x395c36){const _0x545159=a491_0x1f28();return a491_0x518a=function(_0x21dc16,_0x4d3325){_0x21dc16=_0x21dc16-0xc8;let _0x1f286a=_0x545159[_0x21dc16];return _0x1f286a;},a491_0x518a(_0x2778c7,_0x395c36);}exports[a491_0x59b40c(0xe8)]=ResetPassword;