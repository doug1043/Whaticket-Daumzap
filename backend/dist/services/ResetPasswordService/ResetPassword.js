const a493_0x1d8d51=a493_0x5c70;(function(_0x58c538,_0x225417){const _0x3396ee=a493_0x5c70,_0x200d6f=_0x58c538();while(!![]){try{const _0x1a3a03=-parseInt(_0x3396ee(0x160))/0x1*(-parseInt(_0x3396ee(0x176))/0x2)+-parseInt(_0x3396ee(0x169))/0x3+-parseInt(_0x3396ee(0x16a))/0x4+-parseInt(_0x3396ee(0x15d))/0x5*(-parseInt(_0x3396ee(0x179))/0x6)+-parseInt(_0x3396ee(0x151))/0x7*(parseInt(_0x3396ee(0x178))/0x8)+-parseInt(_0x3396ee(0x164))/0x9*(-parseInt(_0x3396ee(0x156))/0xa)+parseInt(_0x3396ee(0x16e))/0xb;if(_0x1a3a03===_0x225417)break;else _0x200d6f['push'](_0x200d6f['shift']());}catch(_0x17ccce){_0x200d6f['push'](_0x200d6f['shift']());}}}(a493_0x59d6,0xc4d27));const a493_0x55973d=(function(){let _0x3dcdd5=!![];return function(_0xcebf7d,_0x1b72b3){const _0x72a887=_0x3dcdd5?function(){const _0x22ce86=a493_0x5c70;if(_0x1b72b3){const _0x4323da=_0x1b72b3[_0x22ce86(0x154)](_0xcebf7d,arguments);return _0x1b72b3=null,_0x4323da;}}:function(){};return _0x3dcdd5=![],_0x72a887;};}()),a493_0x5cfe6e=a493_0x55973d(this,function(){const _0x2f1c90=a493_0x5c70;return a493_0x5cfe6e['toString']()[_0x2f1c90(0x16f)]('(((.+)+)+)+$')[_0x2f1c90(0x153)]()[_0x2f1c90(0x15b)](a493_0x5cfe6e)[_0x2f1c90(0x16f)]('(((.+)+)+)+$');});a493_0x5cfe6e();'use strict';var __importDefault=this&&this[a493_0x1d8d51(0x157)]||function(_0x4fa501){const _0x2bbfc5=a493_0x1d8d51;return _0x4fa501&&_0x4fa501[_0x2bbfc5(0x15a)]?_0x4fa501:{'default':_0x4fa501};};Object[a493_0x1d8d51(0x168)](exports,a493_0x1d8d51(0x15a),{'value':!![]});const sequelize_1=__importDefault(require('sequelize')),database_1=__importDefault(require('../../database')),nodemailer_1=__importDefault(require('nodemailer')),Setting_1=__importDefault(require(a493_0x1d8d51(0x155))),bcryptjs_1=require(a493_0x1d8d51(0x165)),ResetPassword=async(_0x4de058,_0x437e0a,_0x3c0b96)=>{const _0x1ac20f=a493_0x1d8d51;try{const {hasResult:_0x183758,data:_0xe332da}=await filterUser(_0x4de058,_0x437e0a);if(!_0x183758)return{'status':0x194,'message':_0x1ac20f(0x150)};const _0x382d6b=await(0x0,bcryptjs_1[_0x1ac20f(0x14e)])(_0x3c0b96,0x8),{hasResults:_0x55c821,datas:_0x165ac8}=await insertHasPassword(_0x4de058,_0x437e0a,_0x382d6b);if(!_0x55c821)return{'status':0x194,'message':_0x1ac20f(0x170)};const [_0x3cd2a7,_0x3a2800,_0x31d941,_0x50184f]=await Promise[_0x1ac20f(0x162)]([Setting_1['default'][_0x1ac20f(0x159)]({'where':{'key':_0x1ac20f(0x173)}}),Setting_1[_0x1ac20f(0x15c)][_0x1ac20f(0x159)]({'where':{'key':_0x1ac20f(0x14f)}}),Setting_1[_0x1ac20f(0x15c)][_0x1ac20f(0x159)]({'where':{'key':_0x1ac20f(0x166)}}),Setting_1[_0x1ac20f(0x15c)][_0x1ac20f(0x159)]({'where':{'key':_0x1ac20f(0x16c)}})]),_0x53c567=_0x3cd2a7?.['value'],_0x53bdb3=_0x3a2800?.['value'],_0x38a645=_0x31d941?.[_0x1ac20f(0x158)],_0x451e1b=_0x53bdb3,_0x452727=_0x50184f?.['value'];if(!_0x53c567||!_0x53bdb3||!_0x38a645||!_0x452727)throw new Error(_0x1ac20f(0x152));const _0xf7eef9=nodemailer_1[_0x1ac20f(0x15c)][_0x1ac20f(0x16b)]({'host':_0x53c567,'port':Number(_0x452727),'secure':![],'auth':{'user':_0x53bdb3,'pass':_0x38a645}}),_0x5f1d37={'from':_0x451e1b,'to':_0x4de058,'subject':'Senha\x20Alterada\x20com\x20Sucesso','text':_0x1ac20f(0x15e)},_0x3d981c=await _0xf7eef9['sendMail'](_0x5f1d37);return _0x3d981c;}catch(_0x2a5f00){return console[_0x1ac20f(0x15f)](_0x1ac20f(0x16d),_0x2a5f00),{'status':0x1f4,'message':_0x1ac20f(0x161)};}},filterUser=async(_0x53327b,_0x17308a)=>{const _0x3d7b0f=a493_0x1d8d51,_0x311b1c=_0x3d7b0f(0x177)+_0x53327b+'\x27\x20AND\x20\x22resetPassword\x22\x20!=\x20\x27\x27',_0xba3965=await database_1[_0x3d7b0f(0x15c)][_0x3d7b0f(0x174)](_0x311b1c,{'type':sequelize_1[_0x3d7b0f(0x15c)][_0x3d7b0f(0x175)][_0x3d7b0f(0x163)]});return{'hasResult':_0xba3965['length']>0x0,'data':_0xba3965};},insertHasPassword=async(_0x2c2ff0,_0x4bae59,_0x18e075)=>{const _0x376663=a493_0x1d8d51,_0x3ec99b=_0x376663(0x177)+_0x2c2ff0+_0x376663(0x172)+_0x4bae59+'\x27',_0x25cb6b=await database_1[_0x376663(0x15c)][_0x376663(0x174)](_0x3ec99b,{'type':sequelize_1['default'][_0x376663(0x175)]['SELECT']}),_0x4abd31=_0x376663(0x167)+_0x18e075+_0x376663(0x171)+_0x2c2ff0+_0x376663(0x172)+_0x4bae59+'\x27',_0x4c39e1=await database_1[_0x376663(0x15c)][_0x376663(0x174)](_0x4abd31,{'type':sequelize_1['default'][_0x376663(0x175)]['UPDATE']});return{'hasResults':_0x4c39e1[0x1]>0x0,'datas':_0x25cb6b};};function a493_0x59d6(){const _0x26aef3=['QueryTypes','2mqAdRl','SELECT\x20*\x20FROM\x20\x22Users\x22\x20WHERE\x20email\x20=\x20\x27','8dJcQKJ','10116UGrvBI','hash','usersmtpauth','Email\x20ou\x20token\x20não\x20encontrado','2503473oKWYvp','Configurações\x20SMTP\x20estão\x20incompletas','toString','apply','../../models/Setting','1500gqDaMe','__importDefault','value','findOne','__esModule','constructor','default','490LayDFM','Olá,\x0a\x0aSua\x20senha\x20foi\x20alterada\x20com\x20sucesso.\x0a\x0aSe\x20você\x20não\x20realizou\x20essa\x20alteração,\x20entre\x20em\x20contato\x20conosco\x20imediatamente.\x0a\x0aAtenciosamente','error','1362947zrRSqk','Erro\x20interno\x20do\x20servidor','all','SELECT','86841BPmjbe','bcryptjs','clientsecretsmtpauth','UPDATE\x20\x22Users\x22\x20SET\x20\x22passwordHash\x22=\x20\x27','defineProperty','4539294rvGhwM','1877292BBNVOM','createTransport','smtpport','Erro\x20ao\x20redefinir\x20senha:','1877898ICrtDv','search','Token\x20não\x20encontrado\x20ou\x20inválido','\x27,\x20\x22resetPassword\x22\x20=\x20\x27\x27\x20WHERE\x20email=\x20\x27','\x27\x20AND\x20\x22resetPassword\x22\x20=\x20\x27','smtpauth','query'];a493_0x59d6=function(){return _0x26aef3;};return a493_0x59d6();}function a493_0x5c70(_0x1ba399,_0x389a31){const _0x2c63ec=a493_0x59d6();return a493_0x5c70=function(_0x5cfe6e,_0x55973d){_0x5cfe6e=_0x5cfe6e-0x14e;let _0x59d649=_0x2c63ec[_0x5cfe6e];return _0x59d649;},a493_0x5c70(_0x1ba399,_0x389a31);}exports['default']=ResetPassword;