const a521_0x20a8d4=a521_0x3092;(function(_0x589906,_0x139c86){const _0x3cf2c1=a521_0x3092,_0x2ae9f7=_0x589906();while(!![]){try{const _0x4aa996=-parseInt(_0x3cf2c1(0x9c))/0x1+parseInt(_0x3cf2c1(0xc0))/0x2+parseInt(_0x3cf2c1(0xb7))/0x3*(-parseInt(_0x3cf2c1(0x99))/0x4)+-parseInt(_0x3cf2c1(0xb4))/0x5*(-parseInt(_0x3cf2c1(0xb5))/0x6)+parseInt(_0x3cf2c1(0xa6))/0x7+parseInt(_0x3cf2c1(0xa5))/0x8*(parseInt(_0x3cf2c1(0x9e))/0x9)+parseInt(_0x3cf2c1(0xb8))/0xa*(-parseInt(_0x3cf2c1(0xa4))/0xb);if(_0x4aa996===_0x139c86)break;else _0x2ae9f7['push'](_0x2ae9f7['shift']());}catch(_0x5d71f3){_0x2ae9f7['push'](_0x2ae9f7['shift']());}}}(a521_0x2b1d,0x68a52));const a521_0xd166c7=(function(){let _0x3b9e9f=!![];return function(_0x4dfefc,_0xd136d3){const _0x1ef891=_0x3b9e9f?function(){const _0x3b05ae=a521_0x3092;if(_0xd136d3){const _0x1f498d=_0xd136d3[_0x3b05ae(0xbd)](_0x4dfefc,arguments);return _0xd136d3=null,_0x1f498d;}}:function(){};return _0x3b9e9f=![],_0x1ef891;};}()),a521_0x31687e=a521_0xd166c7(this,function(){const _0x405a6b=a521_0x3092;return a521_0x31687e['toString']()[_0x405a6b(0xa2)](_0x405a6b(0xbe))[_0x405a6b(0xbc)]()[_0x405a6b(0xae)](a521_0x31687e)['search'](_0x405a6b(0xbe));});a521_0x31687e();function a521_0x2b1d(){const _0x2329f2=['79602uWXxMa','2495980pjZskF','usersmtpauth','QueryTypes','findOne','toString','apply','(((.+)+)+)+$','\x27,\x20\x22resetPassword\x22\x20=\x20\x27\x27\x20WHERE\x20email=\x20\x27','1598830pDyptD','Senha\x20Alterada\x20com\x20Sucesso','SELECT','../../database','value','92JmHfCz','nodemailer','query','101122UPatAL','sequelize','49014FFETXX','Olá,\x0a\x0aSua\x20senha\x20foi\x20alterada\x20com\x20sucesso.\x0a\x0aSe\x20você\x20não\x20realizou\x20essa\x20alteração,\x20entre\x20em\x20contato\x20conosco\x20imediatamente.\x0a\x0aAtenciosamente','error','__importDefault','search','length','44CbItwh','904sOviVe','5054273TNMJkt','hash','Email\x20ou\x20token\x20não\x20encontrado','../../models/Setting','\x27\x20AND\x20\x22resetPassword\x22\x20=\x20\x27','\x27\x20AND\x20\x22resetPassword\x22\x20!=\x20\x27\x27','UPDATE\x20\x22Users\x22\x20SET\x20\x22passwordHash\x22=\x20\x27','default','constructor','SELECT\x20*\x20FROM\x20\x22Users\x22\x20WHERE\x20email\x20=\x20\x27','Erro\x20interno\x20do\x20servidor','Configurações\x20SMTP\x20estão\x20incompletas','bcryptjs','Erro\x20ao\x20redefinir\x20senha:','1570IoFyYk','30FtuqXD','defineProperty'];a521_0x2b1d=function(){return _0x2329f2;};return a521_0x2b1d();}'use strict';var __importDefault=this&&this[a521_0x20a8d4(0xa1)]||function(_0xcc3e22){return _0xcc3e22&&_0xcc3e22['__esModule']?_0xcc3e22:{'default':_0xcc3e22};};function a521_0x3092(_0x1d276e,_0x352b79){const _0x48f0e2=a521_0x2b1d();return a521_0x3092=function(_0x31687e,_0xd166c7){_0x31687e=_0x31687e-0x97;let _0x2b1dd1=_0x48f0e2[_0x31687e];return _0x2b1dd1;},a521_0x3092(_0x1d276e,_0x352b79);}Object[a521_0x20a8d4(0xb6)](exports,'__esModule',{'value':!![]});const sequelize_1=__importDefault(require(a521_0x20a8d4(0x9d))),database_1=__importDefault(require(a521_0x20a8d4(0x97))),nodemailer_1=__importDefault(require(a521_0x20a8d4(0x9a))),Setting_1=__importDefault(require(a521_0x20a8d4(0xa9))),bcryptjs_1=require(a521_0x20a8d4(0xb2)),ResetPassword=async(_0x48da39,_0xe0e9ff,_0x580273)=>{const _0x3db72e=a521_0x20a8d4;try{const {hasResult:_0x31130c,data:_0x222a29}=await filterUser(_0x48da39,_0xe0e9ff);if(!_0x31130c)return{'status':0x194,'message':_0x3db72e(0xa8)};const _0x337567=await(0x0,bcryptjs_1[_0x3db72e(0xa7)])(_0x580273,0x8),{hasResults:_0x4285f8,datas:_0x587973}=await insertHasPassword(_0x48da39,_0xe0e9ff,_0x337567);if(!_0x4285f8)return{'status':0x194,'message':'Token\x20não\x20encontrado\x20ou\x20inválido'};const [_0xd06743,_0x4a96ef,_0x21a0b3,_0x3caf5b]=await Promise['all']([Setting_1['default'][_0x3db72e(0xbb)]({'where':{'key':'smtpauth'}}),Setting_1[_0x3db72e(0xad)][_0x3db72e(0xbb)]({'where':{'key':_0x3db72e(0xb9)}}),Setting_1[_0x3db72e(0xad)][_0x3db72e(0xbb)]({'where':{'key':'clientsecretsmtpauth'}}),Setting_1[_0x3db72e(0xad)][_0x3db72e(0xbb)]({'where':{'key':'smtpport'}})]),_0x5a395c=_0xd06743?.[_0x3db72e(0x98)],_0x481a7d=_0x4a96ef?.[_0x3db72e(0x98)],_0x599b15=_0x21a0b3?.[_0x3db72e(0x98)],_0x34e89f=_0x481a7d,_0x38a316=_0x3caf5b?.[_0x3db72e(0x98)];if(!_0x5a395c||!_0x481a7d||!_0x599b15||!_0x38a316)throw new Error(_0x3db72e(0xb1));const _0x12c853=nodemailer_1['default']['createTransport']({'host':_0x5a395c,'port':Number(_0x38a316),'secure':![],'auth':{'user':_0x481a7d,'pass':_0x599b15}}),_0x13a1dc={'from':_0x34e89f,'to':_0x48da39,'subject':_0x3db72e(0xc1),'text':_0x3db72e(0x9f)},_0x3fb589=await _0x12c853['sendMail'](_0x13a1dc);return _0x3fb589;}catch(_0x9ebfe9){return console[_0x3db72e(0xa0)](_0x3db72e(0xb3),_0x9ebfe9),{'status':0x1f4,'message':_0x3db72e(0xb0)};}},filterUser=async(_0xf0c125,_0x23ad83)=>{const _0x32f246=a521_0x20a8d4,_0x11b50b=_0x32f246(0xaf)+_0xf0c125+_0x32f246(0xab),_0x1428a9=await database_1[_0x32f246(0xad)]['query'](_0x11b50b,{'type':sequelize_1[_0x32f246(0xad)][_0x32f246(0xba)][_0x32f246(0xc2)]});return{'hasResult':_0x1428a9[_0x32f246(0xa3)]>0x0,'data':_0x1428a9};},insertHasPassword=async(_0x250ebe,_0x175f7d,_0x2033f8)=>{const _0x308620=a521_0x20a8d4,_0x42c9c7='SELECT\x20*\x20FROM\x20\x22Users\x22\x20WHERE\x20email\x20=\x20\x27'+_0x250ebe+_0x308620(0xaa)+_0x175f7d+'\x27',_0x2707db=await database_1[_0x308620(0xad)][_0x308620(0x9b)](_0x42c9c7,{'type':sequelize_1[_0x308620(0xad)]['QueryTypes'][_0x308620(0xc2)]}),_0x84285=_0x308620(0xac)+_0x2033f8+_0x308620(0xbf)+_0x250ebe+_0x308620(0xaa)+_0x175f7d+'\x27',_0x18b4fb=await database_1[_0x308620(0xad)][_0x308620(0x9b)](_0x84285,{'type':sequelize_1[_0x308620(0xad)]['QueryTypes']['UPDATE']});return{'hasResults':_0x18b4fb[0x1]>0x0,'datas':_0x2707db};};exports[a521_0x20a8d4(0xad)]=ResetPassword;