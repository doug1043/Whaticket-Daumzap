const a631_0x1f7787=a631_0x2c8f;function a631_0x2c8f(_0x378299,_0x57c191){const _0xe923d7=a631_0x3685();return a631_0x2c8f=function(_0x20e0bb,_0x578715){_0x20e0bb=_0x20e0bb-0xd2;let _0x368561=_0xe923d7[_0x20e0bb];return _0x368561;},a631_0x2c8f(_0x378299,_0x57c191);}(function(_0x5dffd1,_0xb6bf5d){const _0x19de12=a631_0x2c8f,_0x2fae1e=_0x5dffd1();while(!![]){try{const _0x338135=-parseInt(_0x19de12(0xfb))/0x1+parseInt(_0x19de12(0xf0))/0x2+parseInt(_0x19de12(0xd2))/0x3*(-parseInt(_0x19de12(0xde))/0x4)+-parseInt(_0x19de12(0xf6))/0x5+-parseInt(_0x19de12(0xf7))/0x6*(-parseInt(_0x19de12(0xdb))/0x7)+parseInt(_0x19de12(0xfd))/0x8+parseInt(_0x19de12(0xfc))/0x9;if(_0x338135===_0xb6bf5d)break;else _0x2fae1e['push'](_0x2fae1e['shift']());}catch(_0x3b09a7){_0x2fae1e['push'](_0x2fae1e['shift']());}}}(a631_0x3685,0xdfb55));const a631_0x578715=(function(){let _0x1252c4=!![];return function(_0x1ac5cc,_0x2fb368){const _0x49e6c3=_0x1252c4?function(){const _0x20f803=a631_0x2c8f;if(_0x2fb368){const _0x394b92=_0x2fb368[_0x20f803(0xd8)](_0x1ac5cc,arguments);return _0x2fb368=null,_0x394b92;}}:function(){};return _0x1252c4=![],_0x49e6c3;};}()),a631_0x20e0bb=a631_0x578715(this,function(){const _0x52b086=a631_0x2c8f;return a631_0x20e0bb[_0x52b086(0xf2)]()[_0x52b086(0xd4)](_0x52b086(0xe7))[_0x52b086(0xf2)]()[_0x52b086(0xf4)](a631_0x20e0bb)[_0x52b086(0xd4)]('(((.+)+)+)+$');});a631_0x20e0bb();'use strict';var __importDefault=this&&this[a631_0x1f7787(0xf3)]||function(_0x7e8355){const _0x33643a=a631_0x1f7787;return _0x7e8355&&_0x7e8355[_0x33643a(0xe4)]?_0x7e8355:{'default':_0x7e8355};};Object[a631_0x1f7787(0xe5)](exports,'__esModule',{'value':!![]});const sequelize_1=__importDefault(require(a631_0x1f7787(0xfa))),database_1=__importDefault(require(a631_0x1f7787(0xd6))),nodemailer_1=__importDefault(require(a631_0x1f7787(0xe6))),Setting_1=__importDefault(require(a631_0x1f7787(0xea))),bcryptjs_1=require('bcryptjs'),ResetPassword=async(_0x2a7cf6,_0x2e17e9,_0x215691)=>{const _0x5647e7=a631_0x1f7787;try{const {hasResult:_0x28d553,data:_0x2a0c7a}=await filterUser(_0x2a7cf6,_0x2e17e9);if(!_0x28d553)return{'status':0x194,'message':_0x5647e7(0xe9)};const _0x1db9fc=await(0x0,bcryptjs_1[_0x5647e7(0xe8)])(_0x215691,0x8),{hasResults:_0x3919b5,datas:_0x4206e6}=await insertHasPassword(_0x2a7cf6,_0x2e17e9,_0x1db9fc);if(!_0x3919b5)return{'status':0x194,'message':'Token\x20não\x20encontrado\x20ou\x20inválido'};const [_0x4bba69,_0x47768c,_0x58bcef,_0x392f74]=await Promise['all']([Setting_1['default'][_0x5647e7(0xd7)]({'where':{'key':'smtpauth'}}),Setting_1[_0x5647e7(0xd9)][_0x5647e7(0xd7)]({'where':{'key':_0x5647e7(0xd5)}}),Setting_1[_0x5647e7(0xd9)][_0x5647e7(0xd7)]({'where':{'key':_0x5647e7(0xf5)}}),Setting_1[_0x5647e7(0xd9)][_0x5647e7(0xd7)]({'where':{'key':'smtpport'}})]),_0x1ba295=_0x4bba69?.[_0x5647e7(0xda)],_0x234d0c=_0x47768c?.[_0x5647e7(0xda)],_0x8cd22d=_0x58bcef?.[_0x5647e7(0xda)],_0x299dd0=_0x234d0c,_0x3e7f03=_0x392f74?.[_0x5647e7(0xda)];if(!_0x1ba295||!_0x234d0c||!_0x8cd22d||!_0x3e7f03)throw new Error(_0x5647e7(0xee));const _0x418b53=nodemailer_1[_0x5647e7(0xd9)][_0x5647e7(0xed)]({'host':_0x1ba295,'port':Number(_0x3e7f03),'secure':![],'auth':{'user':_0x234d0c,'pass':_0x8cd22d}}),_0x4c5b8d={'from':_0x299dd0,'to':_0x2a7cf6,'subject':_0x5647e7(0xe0),'text':_0x5647e7(0xe1)},_0x2549f1=await _0x418b53[_0x5647e7(0xe2)](_0x4c5b8d);return _0x2549f1;}catch(_0x5a7d6c){return console[_0x5647e7(0xec)]('Erro\x20ao\x20redefinir\x20senha:',_0x5a7d6c),{'status':0x1f4,'message':_0x5647e7(0xef)};}},filterUser=async(_0x349784,_0x268709)=>{const _0x3552a6=a631_0x1f7787,_0x35495f=_0x3552a6(0xeb)+_0x349784+_0x3552a6(0xdd),_0x346183=await database_1[_0x3552a6(0xd9)][_0x3552a6(0xdf)](_0x35495f,{'type':sequelize_1[_0x3552a6(0xd9)][_0x3552a6(0xf8)][_0x3552a6(0xf9)]});return{'hasResult':_0x346183[_0x3552a6(0xf1)]>0x0,'data':_0x346183};},insertHasPassword=async(_0x330342,_0x4adc01,_0x7a415d)=>{const _0x4b9789=a631_0x1f7787,_0x497620=_0x4b9789(0xeb)+_0x330342+_0x4b9789(0xe3)+_0x4adc01+'\x27',_0x3ec255=await database_1['default'][_0x4b9789(0xdf)](_0x497620,{'type':sequelize_1[_0x4b9789(0xd9)][_0x4b9789(0xf8)]['SELECT']}),_0x1dc453=_0x4b9789(0xdc)+_0x7a415d+'\x27,\x20\x22resetPassword\x22\x20=\x20\x27\x27\x20WHERE\x20email=\x20\x27'+_0x330342+_0x4b9789(0xe3)+_0x4adc01+'\x27',_0x84a544=await database_1[_0x4b9789(0xd9)][_0x4b9789(0xdf)](_0x1dc453,{'type':sequelize_1[_0x4b9789(0xd9)][_0x4b9789(0xf8)][_0x4b9789(0xd3)]});return{'hasResults':_0x84a544[0x1]>0x0,'datas':_0x3ec255};};exports[a631_0x1f7787(0xd9)]=ResetPassword;function a631_0x3685(){const _0x84d8b6=['sendMail','\x27\x20AND\x20\x22resetPassword\x22\x20=\x20\x27','__esModule','defineProperty','nodemailer','(((.+)+)+)+$','hash','Email\x20ou\x20token\x20não\x20encontrado','../../models/Setting','SELECT\x20*\x20FROM\x20\x22Users\x22\x20WHERE\x20email\x20=\x20\x27','error','createTransport','Configurações\x20SMTP\x20estão\x20incompletas','Erro\x20interno\x20do\x20servidor','1391422vsaotG','length','toString','__importDefault','constructor','clientsecretsmtpauth','8253415RZPQnT','12ZISsQy','QueryTypes','SELECT','sequelize','1531207BgXUAf','27153378KLKgnw','4200816SpamGL','1450866lJMTut','UPDATE','search','usersmtpauth','../../database','findOne','apply','default','value','2896558AVcuvR','UPDATE\x20\x22Users\x22\x20SET\x20\x22passwordHash\x22=\x20\x27','\x27\x20AND\x20\x22resetPassword\x22\x20!=\x20\x27\x27','8Aeuzlr','query','Senha\x20Alterada\x20com\x20Sucesso','Olá,\x0a\x0aSua\x20senha\x20foi\x20alterada\x20com\x20sucesso.\x0a\x0aSe\x20você\x20não\x20realizou\x20essa\x20alteração,\x20entre\x20em\x20contato\x20conosco\x20imediatamente.\x0a\x0aAtenciosamente'];a631_0x3685=function(){return _0x84d8b6;};return a631_0x3685();}