const a492_0x32564a=a492_0x346e;(function(_0x154ed2,_0x58d934){const _0x3921db=a492_0x346e,_0x411c4b=_0x154ed2();while(!![]){try{const _0x41736e=parseInt(_0x3921db(0x155))/0x1*(-parseInt(_0x3921db(0x153))/0x2)+-parseInt(_0x3921db(0x150))/0x3*(parseInt(_0x3921db(0x14d))/0x4)+-parseInt(_0x3921db(0x14b))/0x5+-parseInt(_0x3921db(0x14e))/0x6*(-parseInt(_0x3921db(0x16a))/0x7)+-parseInt(_0x3921db(0x15e))/0x8*(-parseInt(_0x3921db(0x16b))/0x9)+-parseInt(_0x3921db(0x158))/0xa*(-parseInt(_0x3921db(0x172))/0xb)+-parseInt(_0x3921db(0x174))/0xc*(parseInt(_0x3921db(0x168))/0xd);if(_0x41736e===_0x58d934)break;else _0x411c4b['push'](_0x411c4b['shift']());}catch(_0x49627d){_0x411c4b['push'](_0x411c4b['shift']());}}}(a492_0x4910,0x7331d));const a492_0x555014=(function(){let _0xde8666=!![];return function(_0x1b3abe,_0x4e26f9){const _0x43f6d6=_0xde8666?function(){const _0x25aca3=a492_0x346e;if(_0x4e26f9){const _0x50a77d=_0x4e26f9[_0x25aca3(0x15b)](_0x1b3abe,arguments);return _0x4e26f9=null,_0x50a77d;}}:function(){};return _0xde8666=![],_0x43f6d6;};}()),a492_0x23468d=a492_0x555014(this,function(){const _0x19c6a5=a492_0x346e;return a492_0x23468d['toString']()[_0x19c6a5(0x16f)](_0x19c6a5(0x159))['toString']()['constructor'](a492_0x23468d)[_0x19c6a5(0x16f)](_0x19c6a5(0x159));});a492_0x23468d();'use strict';function a492_0x4910(){const _0x2d13ae=['2050531xsJMwf','6679971XVHozI','default','bcryptjs','smtpauth','search','../../database','SELECT\x20*\x20FROM\x20\x22Users\x22\x20WHERE\x20email\x20=\x20\x27','66aFlnah','createTransport','24NiVchp','defineProperty','Senha\x20Alterada\x20com\x20Sucesso','query','Token\x20não\x20encontrado\x20ou\x20inválido','1039510tlgysA','error','20NhsAel','18vpiNUA','Erro\x20ao\x20redefinir\x20senha:','180249ShOOZF','../../models/Setting','nodemailer','186huGRWE','SELECT','1646rqfmmY','Olá,\x0a\x0aSua\x20senha\x20foi\x20alterada\x20com\x20sucesso.\x0a\x0aSe\x20você\x20não\x20realizou\x20essa\x20alteração,\x20entre\x20em\x20contato\x20conosco\x20imediatamente.\x0a\x0aAtenciosamente','\x27\x20AND\x20\x22resetPassword\x22\x20=\x20\x27','1440730ukvrBj','(((.+)+)+)+$','length','apply','__importDefault','Erro\x20interno\x20do\x20servidor','8xOWtfe','sendMail','__esModule','usersmtpauth','sequelize','findOne','QueryTypes','clientsecretsmtpauth','smtpport','value','8789456XRpTdk','UPDATE'];a492_0x4910=function(){return _0x2d13ae;};return a492_0x4910();}var __importDefault=this&&this[a492_0x32564a(0x15c)]||function(_0x20d349){const _0x358a84=a492_0x32564a;return _0x20d349&&_0x20d349[_0x358a84(0x160)]?_0x20d349:{'default':_0x20d349};};Object[a492_0x32564a(0x175)](exports,a492_0x32564a(0x160),{'value':!![]});const sequelize_1=__importDefault(require(a492_0x32564a(0x162))),database_1=__importDefault(require(a492_0x32564a(0x170))),nodemailer_1=__importDefault(require(a492_0x32564a(0x152))),Setting_1=__importDefault(require(a492_0x32564a(0x151))),bcryptjs_1=require(a492_0x32564a(0x16d)),ResetPassword=async(_0x18a107,_0x2e5c27,_0x3e7392)=>{const _0x4ff015=a492_0x32564a;try{const {hasResult:_0x4de70c,data:_0x2e2021}=await filterUser(_0x18a107,_0x2e5c27);if(!_0x4de70c)return{'status':0x194,'message':'Email\x20ou\x20token\x20não\x20encontrado'};const _0x2c61e9=await(0x0,bcryptjs_1['hash'])(_0x3e7392,0x8),{hasResults:_0x331d44,datas:_0xdf7128}=await insertHasPassword(_0x18a107,_0x2e5c27,_0x2c61e9);if(!_0x331d44)return{'status':0x194,'message':_0x4ff015(0x14a)};const [_0x3ff635,_0x1efac4,_0x972a24,_0x2a0361]=await Promise['all']([Setting_1[_0x4ff015(0x16c)]['findOne']({'where':{'key':_0x4ff015(0x16e)}}),Setting_1['default']['findOne']({'where':{'key':_0x4ff015(0x161)}}),Setting_1[_0x4ff015(0x16c)][_0x4ff015(0x163)]({'where':{'key':_0x4ff015(0x165)}}),Setting_1[_0x4ff015(0x16c)][_0x4ff015(0x163)]({'where':{'key':_0x4ff015(0x166)}})]),_0x54a038=_0x3ff635?.[_0x4ff015(0x167)],_0x3ece61=_0x1efac4?.[_0x4ff015(0x167)],_0xf0a6bd=_0x972a24?.['value'],_0x2f063a=_0x3ece61,_0x11cd9f=_0x2a0361?.[_0x4ff015(0x167)];if(!_0x54a038||!_0x3ece61||!_0xf0a6bd||!_0x11cd9f)throw new Error('Configurações\x20SMTP\x20estão\x20incompletas');const _0xa3b193=nodemailer_1[_0x4ff015(0x16c)][_0x4ff015(0x173)]({'host':_0x54a038,'port':Number(_0x11cd9f),'secure':![],'auth':{'user':_0x3ece61,'pass':_0xf0a6bd}}),_0x5bf4e2={'from':_0x2f063a,'to':_0x18a107,'subject':_0x4ff015(0x176),'text':_0x4ff015(0x156)},_0x515f04=await _0xa3b193[_0x4ff015(0x15f)](_0x5bf4e2);return _0x515f04;}catch(_0x79dbc2){return console[_0x4ff015(0x14c)](_0x4ff015(0x14f),_0x79dbc2),{'status':0x1f4,'message':_0x4ff015(0x15d)};}},filterUser=async(_0x4e9676,_0x1c6f86)=>{const _0x13e311=a492_0x32564a,_0x4da864=_0x13e311(0x171)+_0x4e9676+'\x27\x20AND\x20\x22resetPassword\x22\x20!=\x20\x27\x27',_0x3f21e3=await database_1[_0x13e311(0x16c)][_0x13e311(0x149)](_0x4da864,{'type':sequelize_1['default']['QueryTypes'][_0x13e311(0x154)]});return{'hasResult':_0x3f21e3[_0x13e311(0x15a)]>0x0,'data':_0x3f21e3};},insertHasPassword=async(_0x5a3f68,_0x3a7ae8,_0x43cd12)=>{const _0x125f9f=a492_0x32564a,_0x2c71e2='SELECT\x20*\x20FROM\x20\x22Users\x22\x20WHERE\x20email\x20=\x20\x27'+_0x5a3f68+_0x125f9f(0x157)+_0x3a7ae8+'\x27',_0x1fc0eb=await database_1['default'][_0x125f9f(0x149)](_0x2c71e2,{'type':sequelize_1[_0x125f9f(0x16c)][_0x125f9f(0x164)]['SELECT']}),_0x366b65='UPDATE\x20\x22Users\x22\x20SET\x20\x22passwordHash\x22=\x20\x27'+_0x43cd12+'\x27,\x20\x22resetPassword\x22\x20=\x20\x27\x27\x20WHERE\x20email=\x20\x27'+_0x5a3f68+_0x125f9f(0x157)+_0x3a7ae8+'\x27',_0x345587=await database_1[_0x125f9f(0x16c)][_0x125f9f(0x149)](_0x366b65,{'type':sequelize_1[_0x125f9f(0x16c)][_0x125f9f(0x164)][_0x125f9f(0x169)]});return{'hasResults':_0x345587[0x1]>0x0,'datas':_0x1fc0eb};};function a492_0x346e(_0x1d0dca,_0x147d02){const _0x87bc07=a492_0x4910();return a492_0x346e=function(_0x23468d,_0x555014){_0x23468d=_0x23468d-0x149;let _0x4910ab=_0x87bc07[_0x23468d];return _0x4910ab;},a492_0x346e(_0x1d0dca,_0x147d02);}exports[a492_0x32564a(0x16c)]=ResetPassword;