const a493_0x31968e=a493_0x569e;(function(_0x275cbb,_0x46587d){const _0x273c69=a493_0x569e,_0x9fdd27=_0x275cbb();while(!![]){try{const _0x1531d8=-parseInt(_0x273c69(0xdf))/0x1*(parseInt(_0x273c69(0xe9))/0x2)+parseInt(_0x273c69(0xc9))/0x3*(parseInt(_0x273c69(0xf1))/0x4)+parseInt(_0x273c69(0xd3))/0x5*(-parseInt(_0x273c69(0xf6))/0x6)+-parseInt(_0x273c69(0xdd))/0x7+parseInt(_0x273c69(0xd9))/0x8*(parseInt(_0x273c69(0xe7))/0x9)+parseInt(_0x273c69(0xea))/0xa+parseInt(_0x273c69(0xf3))/0xb*(parseInt(_0x273c69(0xe1))/0xc);if(_0x1531d8===_0x46587d)break;else _0x9fdd27['push'](_0x9fdd27['shift']());}catch(_0x2b765a){_0x9fdd27['push'](_0x9fdd27['shift']());}}}(a493_0x1ce7,0xcb903));const a493_0x21c2c7=(function(){let _0x2108f5=!![];return function(_0x529f8a,_0x2fc245){const _0x2b0c11=_0x2108f5?function(){const _0x4aeb9f=a493_0x569e;if(_0x2fc245){const _0x259919=_0x2fc245[_0x4aeb9f(0xca)](_0x529f8a,arguments);return _0x2fc245=null,_0x259919;}}:function(){};return _0x2108f5=![],_0x2b0c11;};}()),a493_0x4ac410=a493_0x21c2c7(this,function(){const _0x1e5e04=a493_0x569e;return a493_0x4ac410[_0x1e5e04(0xd4)]()['search'](_0x1e5e04(0xcf))[_0x1e5e04(0xd4)]()[_0x1e5e04(0xf2)](a493_0x4ac410)[_0x1e5e04(0xcd)](_0x1e5e04(0xcf));});a493_0x4ac410();'use strict';var __importDefault=this&&this[a493_0x31968e(0xe0)]||function(_0x395b5d){const _0x46502a=a493_0x31968e;return _0x395b5d&&_0x395b5d[_0x46502a(0xe5)]?_0x395b5d:{'default':_0x395b5d};};Object['defineProperty'](exports,a493_0x31968e(0xe5),{'value':!![]});function a493_0x1ce7(){const _0x405db9=['Olá,\x0a\x0aSua\x20senha\x20foi\x20alterada\x20com\x20sucesso.\x0a\x0aSe\x20você\x20não\x20realizou\x20essa\x20alteração,\x20entre\x20em\x20contato\x20conosco\x20imediatamente.\x0a\x0aAtenciosamente','\x27,\x20\x22resetPassword\x22\x20=\x20\x27\x27\x20WHERE\x20email=\x20\x27','82785HBOhgB','toString','query','SELECT','findOne','value','481424gOYBjQ','\x27\x20AND\x20\x22resetPassword\x22\x20=\x20\x27','Configurações\x20SMTP\x20estão\x20incompletas','QueryTypes','9611672nctpJy','Senha\x20Alterada\x20com\x20Sucesso','185055quuyjw','__importDefault','108396WRfaMW','UPDATE\x20\x22Users\x22\x20SET\x20\x22passwordHash\x22=\x20\x27','usersmtpauth','sendMail','__esModule','Erro\x20ao\x20redefinir\x20senha:','207YJLLQZ','UPDATE','6ipTOTH','4502870hgeqAS','smtpport','default','error','Erro\x20interno\x20do\x20servidor','smtpauth','bcryptjs','27228NSvkeF','constructor','2013UHtNkG','../../database','sequelize','438vVymdn','\x27\x20AND\x20\x22resetPassword\x22\x20!=\x20\x27\x27','Email\x20ou\x20token\x20não\x20encontrado','213DELlvo','apply','Token\x20não\x20encontrado\x20ou\x20inválido','all','search','clientsecretsmtpauth','(((.+)+)+)+$','length'];a493_0x1ce7=function(){return _0x405db9;};return a493_0x1ce7();}const sequelize_1=__importDefault(require(a493_0x31968e(0xf5))),database_1=__importDefault(require(a493_0x31968e(0xf4))),nodemailer_1=__importDefault(require('nodemailer')),Setting_1=__importDefault(require('../../models/Setting')),bcryptjs_1=require(a493_0x31968e(0xf0)),ResetPassword=async(_0x46bb0a,_0x22b869,_0x52d63e)=>{const _0x532128=a493_0x31968e;try{const {hasResult:_0x207511,data:_0x62f4c4}=await filterUser(_0x46bb0a,_0x22b869);if(!_0x207511)return{'status':0x194,'message':_0x532128(0xf8)};const _0x1cf523=await(0x0,bcryptjs_1['hash'])(_0x52d63e,0x8),{hasResults:_0x1110bb,datas:_0x318f91}=await insertHasPassword(_0x46bb0a,_0x22b869,_0x1cf523);if(!_0x1110bb)return{'status':0x194,'message':_0x532128(0xcb)};const [_0x5834d3,_0x493920,_0x446261,_0x35adde]=await Promise[_0x532128(0xcc)]([Setting_1[_0x532128(0xec)][_0x532128(0xd7)]({'where':{'key':_0x532128(0xef)}}),Setting_1['default'][_0x532128(0xd7)]({'where':{'key':_0x532128(0xe3)}}),Setting_1[_0x532128(0xec)][_0x532128(0xd7)]({'where':{'key':_0x532128(0xce)}}),Setting_1[_0x532128(0xec)][_0x532128(0xd7)]({'where':{'key':_0x532128(0xeb)}})]),_0x418fb1=_0x5834d3?.[_0x532128(0xd8)],_0x3c0e23=_0x493920?.[_0x532128(0xd8)],_0x533ad1=_0x446261?.[_0x532128(0xd8)],_0x2b2446=_0x3c0e23,_0x55299f=_0x35adde?.[_0x532128(0xd8)];if(!_0x418fb1||!_0x3c0e23||!_0x533ad1||!_0x55299f)throw new Error(_0x532128(0xdb));const _0x43b330=nodemailer_1[_0x532128(0xec)]['createTransport']({'host':_0x418fb1,'port':Number(_0x55299f),'secure':![],'auth':{'user':_0x3c0e23,'pass':_0x533ad1}}),_0x3767d9={'from':_0x2b2446,'to':_0x46bb0a,'subject':_0x532128(0xde),'text':_0x532128(0xd1)},_0x49ce6f=await _0x43b330[_0x532128(0xe4)](_0x3767d9);return _0x49ce6f;}catch(_0x240e32){return console[_0x532128(0xed)](_0x532128(0xe6),_0x240e32),{'status':0x1f4,'message':_0x532128(0xee)};}},filterUser=async(_0x1c47f2,_0x4cd0e1)=>{const _0xdaf9c=a493_0x31968e,_0x31e262='SELECT\x20*\x20FROM\x20\x22Users\x22\x20WHERE\x20email\x20=\x20\x27'+_0x1c47f2+_0xdaf9c(0xf7),_0x241967=await database_1['default'][_0xdaf9c(0xd5)](_0x31e262,{'type':sequelize_1[_0xdaf9c(0xec)][_0xdaf9c(0xdc)][_0xdaf9c(0xd6)]});return{'hasResult':_0x241967[_0xdaf9c(0xd0)]>0x0,'data':_0x241967};},insertHasPassword=async(_0x67aa5a,_0x3f70c,_0x283c76)=>{const _0x304d5e=a493_0x31968e,_0x1800ab='SELECT\x20*\x20FROM\x20\x22Users\x22\x20WHERE\x20email\x20=\x20\x27'+_0x67aa5a+_0x304d5e(0xda)+_0x3f70c+'\x27',_0x3a6e38=await database_1['default'][_0x304d5e(0xd5)](_0x1800ab,{'type':sequelize_1[_0x304d5e(0xec)][_0x304d5e(0xdc)][_0x304d5e(0xd6)]}),_0xb20f87=_0x304d5e(0xe2)+_0x283c76+_0x304d5e(0xd2)+_0x67aa5a+_0x304d5e(0xda)+_0x3f70c+'\x27',_0x59a46e=await database_1[_0x304d5e(0xec)][_0x304d5e(0xd5)](_0xb20f87,{'type':sequelize_1['default'][_0x304d5e(0xdc)][_0x304d5e(0xe8)]});return{'hasResults':_0x59a46e[0x1]>0x0,'datas':_0x3a6e38};};function a493_0x569e(_0xc3ce36,_0x250fce){const _0x41fdca=a493_0x1ce7();return a493_0x569e=function(_0x4ac410,_0x21c2c7){_0x4ac410=_0x4ac410-0xc9;let _0x1ce7bc=_0x41fdca[_0x4ac410];return _0x1ce7bc;},a493_0x569e(_0xc3ce36,_0x250fce);}exports[a493_0x31968e(0xec)]=ResetPassword;