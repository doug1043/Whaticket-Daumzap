const a521_0x24ed1c=a521_0x40da;(function(_0x4f26d7,_0x44cf75){const _0x32dd6c=a521_0x40da,_0x24af8e=_0x4f26d7();while(!![]){try{const _0x28d5ec=parseInt(_0x32dd6c(0x15b))/0x1+-parseInt(_0x32dd6c(0x174))/0x2*(parseInt(_0x32dd6c(0x180))/0x3)+-parseInt(_0x32dd6c(0x179))/0x4+parseInt(_0x32dd6c(0x175))/0x5+parseInt(_0x32dd6c(0x161))/0x6+-parseInt(_0x32dd6c(0x181))/0x7+parseInt(_0x32dd6c(0x16b))/0x8;if(_0x28d5ec===_0x44cf75)break;else _0x24af8e['push'](_0x24af8e['shift']());}catch(_0x47c12b){_0x24af8e['push'](_0x24af8e['shift']());}}}(a521_0xa372,0x60f51));const a521_0x40ae02=(function(){let _0x2265c8=!![];return function(_0x24378e,_0x1694c0){const _0x2e0972=_0x2265c8?function(){const _0x4911bb=a521_0x40da;if(_0x1694c0){const _0x23f955=_0x1694c0[_0x4911bb(0x169)](_0x24378e,arguments);return _0x1694c0=null,_0x23f955;}}:function(){};return _0x2265c8=![],_0x2e0972;};}()),a521_0x2bed19=a521_0x40ae02(this,function(){const _0x232bbb=a521_0x40da;return a521_0x2bed19['toString']()[_0x232bbb(0x17f)]('(((.+)+)+)+$')['toString']()[_0x232bbb(0x15f)](a521_0x2bed19)[_0x232bbb(0x17f)](_0x232bbb(0x17b));});function a521_0xa372(){const _0x35e584=['../../models/Setting','2777588rUoJmz','Erro\x20ao\x20redefinir\x20senha:','(((.+)+)+)+$','QueryTypes','SELECT\x20*\x20FROM\x20\x22Users\x22\x20WHERE\x20email\x20=\x20\x27','UPDATE\x20\x22Users\x22\x20SET\x20\x22passwordHash\x22=\x20\x27','search','12339JwMkHK','3770536FVrKCZ','smtpauth','length','564788qOFCml','clientsecretsmtpauth','Senha\x20Alterada\x20com\x20Sucesso','hash','constructor','\x27,\x20\x22resetPassword\x22\x20=\x20\x27\x27\x20WHERE\x20email=\x20\x27','407664XFlOzR','createTransport','Token\x20não\x20encontrado\x20ou\x20inválido','query','Email\x20ou\x20token\x20não\x20encontrado','error','\x27\x20AND\x20\x22resetPassword\x22\x20!=\x20\x27\x27','default','apply','sequelize','5139864uNiUKh','__esModule','Erro\x20interno\x20do\x20servidor','SELECT','findOne','Olá,\x0a\x0aSua\x20senha\x20foi\x20alterada\x20com\x20sucesso.\x0a\x0aSe\x20você\x20não\x20realizou\x20essa\x20alteração,\x20entre\x20em\x20contato\x20conosco\x20imediatamente.\x0a\x0aAtenciosamente','sendMail','../../database','usersmtpauth','164jfqbAv','3461165tXFgne','Configurações\x20SMTP\x20estão\x20incompletas','\x27\x20AND\x20\x22resetPassword\x22\x20=\x20\x27'];a521_0xa372=function(){return _0x35e584;};return a521_0xa372();}a521_0x2bed19();'use strict';function a521_0x40da(_0x45e34b,_0x116774){const _0xf925af=a521_0xa372();return a521_0x40da=function(_0x2bed19,_0x40ae02){_0x2bed19=_0x2bed19-0x159;let _0xa3724d=_0xf925af[_0x2bed19];return _0xa3724d;},a521_0x40da(_0x45e34b,_0x116774);}var __importDefault=this&&this['__importDefault']||function(_0x625ca6){const _0x2bd5cb=a521_0x40da;return _0x625ca6&&_0x625ca6[_0x2bd5cb(0x16c)]?_0x625ca6:{'default':_0x625ca6};};Object['defineProperty'](exports,'__esModule',{'value':!![]});const sequelize_1=__importDefault(require(a521_0x24ed1c(0x16a))),database_1=__importDefault(require(a521_0x24ed1c(0x172))),nodemailer_1=__importDefault(require('nodemailer')),Setting_1=__importDefault(require(a521_0x24ed1c(0x178))),bcryptjs_1=require('bcryptjs'),ResetPassword=async(_0x44bce1,_0xbffdc5,_0x1001ce)=>{const _0x48714d=a521_0x24ed1c;try{const {hasResult:_0x19dcf0,data:_0x26e04e}=await filterUser(_0x44bce1,_0xbffdc5);if(!_0x19dcf0)return{'status':0x194,'message':_0x48714d(0x165)};const _0xcedeab=await(0x0,bcryptjs_1[_0x48714d(0x15e)])(_0x1001ce,0x8),{hasResults:_0x32bb36,datas:_0x2673d1}=await insertHasPassword(_0x44bce1,_0xbffdc5,_0xcedeab);if(!_0x32bb36)return{'status':0x194,'message':_0x48714d(0x163)};const [_0x523f6b,_0x2633c5,_0x230178,_0x1abe8f]=await Promise['all']([Setting_1[_0x48714d(0x168)][_0x48714d(0x16f)]({'where':{'key':_0x48714d(0x159)}}),Setting_1[_0x48714d(0x168)][_0x48714d(0x16f)]({'where':{'key':_0x48714d(0x173)}}),Setting_1[_0x48714d(0x168)][_0x48714d(0x16f)]({'where':{'key':_0x48714d(0x15c)}}),Setting_1[_0x48714d(0x168)]['findOne']({'where':{'key':'smtpport'}})]),_0x1e0cc3=_0x523f6b?.['value'],_0x397cf3=_0x2633c5?.['value'],_0x303484=_0x230178?.['value'],_0x2a5cf5=_0x397cf3,_0x57d445=_0x1abe8f?.['value'];if(!_0x1e0cc3||!_0x397cf3||!_0x303484||!_0x57d445)throw new Error(_0x48714d(0x176));const _0x3fb47a=nodemailer_1[_0x48714d(0x168)][_0x48714d(0x162)]({'host':_0x1e0cc3,'port':Number(_0x57d445),'secure':![],'auth':{'user':_0x397cf3,'pass':_0x303484}}),_0x3b9c80={'from':_0x2a5cf5,'to':_0x44bce1,'subject':_0x48714d(0x15d),'text':_0x48714d(0x170)},_0x46ddf7=await _0x3fb47a[_0x48714d(0x171)](_0x3b9c80);return _0x46ddf7;}catch(_0x19e80d){return console[_0x48714d(0x166)](_0x48714d(0x17a),_0x19e80d),{'status':0x1f4,'message':_0x48714d(0x16d)};}},filterUser=async(_0x5f44f3,_0x59869e)=>{const _0x141338=a521_0x24ed1c,_0x2769ce=_0x141338(0x17d)+_0x5f44f3+_0x141338(0x167),_0x30e30a=await database_1['default'][_0x141338(0x164)](_0x2769ce,{'type':sequelize_1[_0x141338(0x168)]['QueryTypes'][_0x141338(0x16e)]});return{'hasResult':_0x30e30a[_0x141338(0x15a)]>0x0,'data':_0x30e30a};},insertHasPassword=async(_0x35e495,_0x5525ea,_0x45642c)=>{const _0x4f9b09=a521_0x24ed1c,_0x123ec8=_0x4f9b09(0x17d)+_0x35e495+_0x4f9b09(0x177)+_0x5525ea+'\x27',_0x241860=await database_1[_0x4f9b09(0x168)][_0x4f9b09(0x164)](_0x123ec8,{'type':sequelize_1[_0x4f9b09(0x168)]['QueryTypes'][_0x4f9b09(0x16e)]}),_0x4bcede=_0x4f9b09(0x17e)+_0x45642c+_0x4f9b09(0x160)+_0x35e495+_0x4f9b09(0x177)+_0x5525ea+'\x27',_0x598bc6=await database_1[_0x4f9b09(0x168)][_0x4f9b09(0x164)](_0x4bcede,{'type':sequelize_1[_0x4f9b09(0x168)][_0x4f9b09(0x17c)]['UPDATE']});return{'hasResults':_0x598bc6[0x1]>0x0,'datas':_0x241860};};exports[a521_0x24ed1c(0x168)]=ResetPassword;