const a630_0x350e2d=a630_0x5ee2;(function(_0x3f212b,_0x2cd186){const _0x561475=a630_0x5ee2,_0x1f3a60=_0x3f212b();while(!![]){try{const _0x436ecc=parseInt(_0x561475(0x13f))/0x1+parseInt(_0x561475(0x144))/0x2+-parseInt(_0x561475(0x127))/0x3*(-parseInt(_0x561475(0x11e))/0x4)+-parseInt(_0x561475(0x133))/0x5*(parseInt(_0x561475(0x13e))/0x6)+parseInt(_0x561475(0x13a))/0x7+parseInt(_0x561475(0x11b))/0x8+-parseInt(_0x561475(0x12b))/0x9*(parseInt(_0x561475(0x11d))/0xa);if(_0x436ecc===_0x2cd186)break;else _0x1f3a60['push'](_0x1f3a60['shift']());}catch(_0x3204f1){_0x1f3a60['push'](_0x1f3a60['shift']());}}}(a630_0x4f4d,0x87b4c));const a630_0xd082c3=(function(){let _0xa91f16=!![];return function(_0x39a935,_0x69e1d3){const _0x149ff1=_0xa91f16?function(){if(_0x69e1d3){const _0x179bf5=_0x69e1d3['apply'](_0x39a935,arguments);return _0x69e1d3=null,_0x179bf5;}}:function(){};return _0xa91f16=![],_0x149ff1;};}()),a630_0x256e7a=a630_0xd082c3(this,function(){const _0x1aec47=a630_0x5ee2;return a630_0x256e7a[_0x1aec47(0x128)]()['search']('(((.+)+)+)+$')['toString']()[_0x1aec47(0x12f)](a630_0x256e7a)[_0x1aec47(0x13c)](_0x1aec47(0x131));});a630_0x256e7a();'use strict';var __importDefault=this&&this[a630_0x350e2d(0x129)]||function(_0x1e2f98){const _0x3fc601=a630_0x350e2d;return _0x1e2f98&&_0x1e2f98[_0x3fc601(0x132)]?_0x1e2f98:{'default':_0x1e2f98};};Object[a630_0x350e2d(0x13b)](exports,a630_0x350e2d(0x132),{'value':!![]});const sequelize_1=__importDefault(require(a630_0x350e2d(0x126))),database_1=__importDefault(require(a630_0x350e2d(0x12d))),nodemailer_1=__importDefault(require(a630_0x350e2d(0x125))),Setting_1=__importDefault(require(a630_0x350e2d(0x143))),bcryptjs_1=require(a630_0x350e2d(0x120)),ResetPassword=async(_0x511f8f,_0xc17760,_0x37a7ef)=>{const _0x23a011=a630_0x350e2d;try{const {hasResult:_0x5e2f25,data:_0x1e2913}=await filterUser(_0x511f8f,_0xc17760);if(!_0x5e2f25)return{'status':0x194,'message':'Email\x20ou\x20token\x20não\x20encontrado'};const _0x566dc7=await(0x0,bcryptjs_1[_0x23a011(0x140)])(_0x37a7ef,0x8),{hasResults:_0x37528c,datas:_0x5b20a4}=await insertHasPassword(_0x511f8f,_0xc17760,_0x566dc7);if(!_0x37528c)return{'status':0x194,'message':'Token\x20não\x20encontrado\x20ou\x20inválido'};const [_0x39ee0b,_0x25c729,_0x17ae21,_0x407014]=await Promise[_0x23a011(0x11c)]([Setting_1[_0x23a011(0x12c)]['findOne']({'where':{'key':_0x23a011(0x11f)}}),Setting_1[_0x23a011(0x12c)]['findOne']({'where':{'key':_0x23a011(0x139)}}),Setting_1[_0x23a011(0x12c)]['findOne']({'where':{'key':_0x23a011(0x135)}}),Setting_1[_0x23a011(0x12c)][_0x23a011(0x138)]({'where':{'key':'smtpport'}})]),_0x175085=_0x39ee0b?.[_0x23a011(0x137)],_0x45a723=_0x25c729?.[_0x23a011(0x137)],_0x53829e=_0x17ae21?.[_0x23a011(0x137)],_0x469d5a=_0x45a723,_0x3f74f8=_0x407014?.[_0x23a011(0x137)];if(!_0x175085||!_0x45a723||!_0x53829e||!_0x3f74f8)throw new Error('Configurações\x20SMTP\x20estão\x20incompletas');const _0x220ab4=nodemailer_1[_0x23a011(0x12c)][_0x23a011(0x130)]({'host':_0x175085,'port':Number(_0x3f74f8),'secure':![],'auth':{'user':_0x45a723,'pass':_0x53829e}}),_0x1e9634={'from':_0x469d5a,'to':_0x511f8f,'subject':_0x23a011(0x13d),'text':_0x23a011(0x121)},_0x168e92=await _0x220ab4['sendMail'](_0x1e9634);return _0x168e92;}catch(_0x455589){return console[_0x23a011(0x136)](_0x23a011(0x142),_0x455589),{'status':0x1f4,'message':'Erro\x20interno\x20do\x20servidor'};}},filterUser=async(_0x5c7672,_0x591fbd)=>{const _0x2361fa=a630_0x350e2d,_0x29890d=_0x2361fa(0x134)+_0x5c7672+_0x2361fa(0x12a),_0xf59102=await database_1[_0x2361fa(0x12c)][_0x2361fa(0x122)](_0x29890d,{'type':sequelize_1['default'][_0x2361fa(0x12e)][_0x2361fa(0x124)]});return{'hasResult':_0xf59102[_0x2361fa(0x123)]>0x0,'data':_0xf59102};},insertHasPassword=async(_0x51d260,_0x31088b,_0x364607)=>{const _0x5afbd4=a630_0x350e2d,_0x5ab517='SELECT\x20*\x20FROM\x20\x22Users\x22\x20WHERE\x20email\x20=\x20\x27'+_0x51d260+_0x5afbd4(0x141)+_0x31088b+'\x27',_0x41a06a=await database_1['default'][_0x5afbd4(0x122)](_0x5ab517,{'type':sequelize_1[_0x5afbd4(0x12c)][_0x5afbd4(0x12e)][_0x5afbd4(0x124)]}),_0x3e47f9='UPDATE\x20\x22Users\x22\x20SET\x20\x22passwordHash\x22=\x20\x27'+_0x364607+'\x27,\x20\x22resetPassword\x22\x20=\x20\x27\x27\x20WHERE\x20email=\x20\x27'+_0x51d260+_0x5afbd4(0x141)+_0x31088b+'\x27',_0x3931cb=await database_1['default']['query'](_0x3e47f9,{'type':sequelize_1[_0x5afbd4(0x12c)]['QueryTypes']['UPDATE']});return{'hasResults':_0x3931cb[0x1]>0x0,'datas':_0x41a06a};};function a630_0x4f4d(){const _0x148d09=['1102803XrEeuc','toString','__importDefault','\x27\x20AND\x20\x22resetPassword\x22\x20!=\x20\x27\x27','16438959GcDIUE','default','../../database','QueryTypes','constructor','createTransport','(((.+)+)+)+$','__esModule','261645NSQBug','SELECT\x20*\x20FROM\x20\x22Users\x22\x20WHERE\x20email\x20=\x20\x27','clientsecretsmtpauth','error','value','findOne','usersmtpauth','4582893DCGQrU','defineProperty','search','Senha\x20Alterada\x20com\x20Sucesso','96QrTxum','191829IjSalg','hash','\x27\x20AND\x20\x22resetPassword\x22\x20=\x20\x27','Erro\x20ao\x20redefinir\x20senha:','../../models/Setting','2053808ruRprx','4888264xWfnbN','all','10lfQkpi','8gDhKCh','smtpauth','bcryptjs','Olá,\x0a\x0aSua\x20senha\x20foi\x20alterada\x20com\x20sucesso.\x0a\x0aSe\x20você\x20não\x20realizou\x20essa\x20alteração,\x20entre\x20em\x20contato\x20conosco\x20imediatamente.\x0a\x0aAtenciosamente','query','length','SELECT','nodemailer','sequelize'];a630_0x4f4d=function(){return _0x148d09;};return a630_0x4f4d();}function a630_0x5ee2(_0x4bb4e2,_0x201678){const _0x576f4d=a630_0x4f4d();return a630_0x5ee2=function(_0x256e7a,_0xd082c3){_0x256e7a=_0x256e7a-0x11b;let _0x4f4d00=_0x576f4d[_0x256e7a];return _0x4f4d00;},a630_0x5ee2(_0x4bb4e2,_0x201678);}exports[a630_0x350e2d(0x12c)]=ResetPassword;