const a515_0x3a8678=a515_0x1570;(function(_0x4fcffd,_0x7b991a){const _0x4dc969=a515_0x1570,_0x236e79=_0x4fcffd();while(!![]){try{const _0x43d24d=parseInt(_0x4dc969(0x8d))/0x1+-parseInt(_0x4dc969(0x85))/0x2+parseInt(_0x4dc969(0xa6))/0x3*(-parseInt(_0x4dc969(0x83))/0x4)+-parseInt(_0x4dc969(0x91))/0x5+-parseInt(_0x4dc969(0x9d))/0x6*(parseInt(_0x4dc969(0x8b))/0x7)+parseInt(_0x4dc969(0x97))/0x8+-parseInt(_0x4dc969(0x99))/0x9*(-parseInt(_0x4dc969(0xa4))/0xa);if(_0x43d24d===_0x7b991a)break;else _0x236e79['push'](_0x236e79['shift']());}catch(_0x5a2551){_0x236e79['push'](_0x236e79['shift']());}}}(a515_0x4b93,0xf1c9e));const a515_0xec150b=(function(){let _0x4c9472=!![];return function(_0x4ea396,_0xa201c7){const _0x2a04ab=_0x4c9472?function(){const _0x585c0b=a515_0x1570;if(_0xa201c7){const _0x305199=_0xa201c7[_0x585c0b(0x92)](_0x4ea396,arguments);return _0xa201c7=null,_0x305199;}}:function(){};return _0x4c9472=![],_0x2a04ab;};}()),a515_0x1e6e4d=a515_0xec150b(this,function(){const _0x30f51e=a515_0x1570;return a515_0x1e6e4d['toString']()[_0x30f51e(0x8f)](_0x30f51e(0x9b))[_0x30f51e(0x89)]()[_0x30f51e(0x96)](a515_0x1e6e4d)[_0x30f51e(0x8f)]('(((.+)+)+)+$');});a515_0x1e6e4d();'use strict';function a515_0x1570(_0x17bc16,_0x3febef){const _0x5b48b7=a515_0x4b93();return a515_0x1570=function(_0x1e6e4d,_0xec150b){_0x1e6e4d=_0x1e6e4d-0x7e;let _0x4b931b=_0x5b48b7[_0x1e6e4d];return _0x4b931b;},a515_0x1570(_0x17bc16,_0x3febef);}var __importDefault=this&&this[a515_0x3a8678(0xa2)]||function(_0x4b8ff4){const _0x1ce949=a515_0x3a8678;return _0x4b8ff4&&_0x4b8ff4[_0x1ce949(0x87)]?_0x4b8ff4:{'default':_0x4b8ff4};};function a515_0x4b93(){const _0xcc9524=['value','719128kmAWWr','bcryptjs','__esModule','smtpauth','toString','usersmtpauth','1324351EXcxQZ','query','1062637ydZIPp','Token\x20não\x20encontrado\x20ou\x20inválido','search','length','9374090XWFilO','apply','../../models/Setting','UPDATE','Senha\x20Alterada\x20com\x20Sucesso','constructor','10281840htOzhQ','\x27,\x20\x22resetPassword\x22\x20=\x20\x27\x27\x20WHERE\x20email=\x20\x27','740007zSWTTr','Erro\x20interno\x20do\x20servidor','(((.+)+)+)+$','clientsecretsmtpauth','6XVeEsj','Configurações\x20SMTP\x20estão\x20incompletas','nodemailer','Olá,\x0a\x0aSua\x20senha\x20foi\x20alterada\x20com\x20sucesso.\x0a\x0aSe\x20você\x20não\x20realizou\x20essa\x20alteração,\x20entre\x20em\x20contato\x20conosco\x20imediatamente.\x0a\x0aAtenciosamente','hash','__importDefault','default','190egIZWm','QueryTypes','1488489LHFVTY','\x27\x20AND\x20\x22resetPassword\x22\x20!=\x20\x27\x27','findOne','../../database','SELECT','UPDATE\x20\x22Users\x22\x20SET\x20\x22passwordHash\x22=\x20\x27','SELECT\x20*\x20FROM\x20\x22Users\x22\x20WHERE\x20email\x20=\x20\x27','all','error','Erro\x20ao\x20redefinir\x20senha:','Email\x20ou\x20token\x20não\x20encontrado','4eZVcmS'];a515_0x4b93=function(){return _0xcc9524;};return a515_0x4b93();}Object['defineProperty'](exports,a515_0x3a8678(0x87),{'value':!![]});const sequelize_1=__importDefault(require('sequelize')),database_1=__importDefault(require(a515_0x3a8678(0xa9))),nodemailer_1=__importDefault(require(a515_0x3a8678(0x9f))),Setting_1=__importDefault(require(a515_0x3a8678(0x93))),bcryptjs_1=require(a515_0x3a8678(0x86)),ResetPassword=async(_0x5c2507,_0xf71fd7,_0x4c3350)=>{const _0x1c2ddc=a515_0x3a8678;try{const {hasResult:_0x42d1af,data:_0xde3699}=await filterUser(_0x5c2507,_0xf71fd7);if(!_0x42d1af)return{'status':0x194,'message':_0x1c2ddc(0x82)};const _0x363324=await(0x0,bcryptjs_1[_0x1c2ddc(0xa1)])(_0x4c3350,0x8),{hasResults:_0x2311bf,datas:_0x4186d2}=await insertHasPassword(_0x5c2507,_0xf71fd7,_0x363324);if(!_0x2311bf)return{'status':0x194,'message':_0x1c2ddc(0x8e)};const [_0x5aab8c,_0xb32cf,_0x1b146b,_0x2e1121]=await Promise[_0x1c2ddc(0x7f)]([Setting_1[_0x1c2ddc(0xa3)][_0x1c2ddc(0xa8)]({'where':{'key':_0x1c2ddc(0x88)}}),Setting_1[_0x1c2ddc(0xa3)][_0x1c2ddc(0xa8)]({'where':{'key':_0x1c2ddc(0x8a)}}),Setting_1[_0x1c2ddc(0xa3)][_0x1c2ddc(0xa8)]({'where':{'key':_0x1c2ddc(0x9c)}}),Setting_1[_0x1c2ddc(0xa3)][_0x1c2ddc(0xa8)]({'where':{'key':'smtpport'}})]),_0x3b04e9=_0x5aab8c?.[_0x1c2ddc(0x84)],_0x5aa362=_0xb32cf?.[_0x1c2ddc(0x84)],_0x1ed0bd=_0x1b146b?.['value'],_0x5aacf6=_0x5aa362,_0x3b798a=_0x2e1121?.['value'];if(!_0x3b04e9||!_0x5aa362||!_0x1ed0bd||!_0x3b798a)throw new Error(_0x1c2ddc(0x9e));const _0x3c329c=nodemailer_1[_0x1c2ddc(0xa3)]['createTransport']({'host':_0x3b04e9,'port':Number(_0x3b798a),'secure':![],'auth':{'user':_0x5aa362,'pass':_0x1ed0bd}}),_0x231006={'from':_0x5aacf6,'to':_0x5c2507,'subject':_0x1c2ddc(0x95),'text':_0x1c2ddc(0xa0)},_0x24b41b=await _0x3c329c['sendMail'](_0x231006);return _0x24b41b;}catch(_0x314172){return console[_0x1c2ddc(0x80)](_0x1c2ddc(0x81),_0x314172),{'status':0x1f4,'message':_0x1c2ddc(0x9a)};}},filterUser=async(_0x4d8158,_0x597f14)=>{const _0x40c467=a515_0x3a8678,_0x2a7599='SELECT\x20*\x20FROM\x20\x22Users\x22\x20WHERE\x20email\x20=\x20\x27'+_0x4d8158+_0x40c467(0xa7),_0x38fecf=await database_1[_0x40c467(0xa3)][_0x40c467(0x8c)](_0x2a7599,{'type':sequelize_1[_0x40c467(0xa3)][_0x40c467(0xa5)]['SELECT']});return{'hasResult':_0x38fecf[_0x40c467(0x90)]>0x0,'data':_0x38fecf};},insertHasPassword=async(_0x4e9ee3,_0x173efa,_0x3cc109)=>{const _0x493269=a515_0x3a8678,_0xedc2d7=_0x493269(0x7e)+_0x4e9ee3+'\x27\x20AND\x20\x22resetPassword\x22\x20=\x20\x27'+_0x173efa+'\x27',_0x7ca134=await database_1['default'][_0x493269(0x8c)](_0xedc2d7,{'type':sequelize_1['default'][_0x493269(0xa5)][_0x493269(0xaa)]}),_0x43e8af=_0x493269(0xab)+_0x3cc109+_0x493269(0x98)+_0x4e9ee3+'\x27\x20AND\x20\x22resetPassword\x22\x20=\x20\x27'+_0x173efa+'\x27',_0x248e54=await database_1['default'][_0x493269(0x8c)](_0x43e8af,{'type':sequelize_1[_0x493269(0xa3)][_0x493269(0xa5)][_0x493269(0x94)]});return{'hasResults':_0x248e54[0x1]>0x0,'datas':_0x7ca134};};exports[a515_0x3a8678(0xa3)]=ResetPassword;