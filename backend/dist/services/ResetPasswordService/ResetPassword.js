function a484_0x2d97(_0x1ca411,_0x1199c7){const _0x521736=a484_0x3158();return a484_0x2d97=function(_0x959ff4,_0x51e559){_0x959ff4=_0x959ff4-0x121;let _0x3158d1=_0x521736[_0x959ff4];return _0x3158d1;},a484_0x2d97(_0x1ca411,_0x1199c7);}const a484_0x38635f=a484_0x2d97;(function(_0x278168,_0x2503bd){const _0x543cce=a484_0x2d97,_0x3656b1=_0x278168();while(!![]){try{const _0x3c83bd=-parseInt(_0x543cce(0x140))/0x1*(-parseInt(_0x543cce(0x145))/0x2)+-parseInt(_0x543cce(0x12b))/0x3+-parseInt(_0x543cce(0x14b))/0x4+parseInt(_0x543cce(0x143))/0x5*(parseInt(_0x543cce(0x135))/0x6)+parseInt(_0x543cce(0x126))/0x7*(-parseInt(_0x543cce(0x134))/0x8)+-parseInt(_0x543cce(0x123))/0x9*(parseInt(_0x543cce(0x147))/0xa)+parseInt(_0x543cce(0x144))/0xb*(parseInt(_0x543cce(0x13c))/0xc);if(_0x3c83bd===_0x2503bd)break;else _0x3656b1['push'](_0x3656b1['shift']());}catch(_0x1f59c2){_0x3656b1['push'](_0x3656b1['shift']());}}}(a484_0x3158,0x7afb2));function a484_0x3158(){const _0x23184a=['smtpauth','1862644chOJNu','SELECT\x20*\x20FROM\x20\x22Users\x22\x20WHERE\x20email\x20=\x20\x27','findOne','(((.+)+)+)+$','apply','2368944pDGxBQ','Token\x20não\x20encontrado\x20ou\x20inválido','\x27\x20AND\x20\x22resetPassword\x22\x20=\x20\x27','../../database','clientsecretsmtpauth','createTransport','__esModule','sendMail','../../models/Setting','16XkMYBg','3714xoFBrI','search','Olá,\x0a\x0aSua\x20senha\x20foi\x20alterada\x20com\x20sucesso.\x0a\x0aSe\x20você\x20não\x20realizou\x20essa\x20alteração,\x20entre\x20em\x20contato\x20conosco\x20imediatamente.\x0a\x0aAtenciosamente','usersmtpauth','length','defineProperty','error','3276624MQvJhG','query','value','\x27,\x20\x22resetPassword\x22\x20=\x20\x27\x27\x20WHERE\x20email=\x20\x27','1jHBzeE','bcryptjs','constructor','4345ExzEwA','33gyqSgu','1674116dtNvDU','default','130RsIkMC','SELECT','all','Senha\x20Alterada\x20com\x20Sucesso','1041976XfpYWZ','toString','QueryTypes','74817JTTiwe','smtpport'];a484_0x3158=function(){return _0x23184a;};return a484_0x3158();}const a484_0x51e559=(function(){let _0x4e47b4=!![];return function(_0x962fbe,_0x2683c7){const _0x47564f=_0x4e47b4?function(){const _0x1d4991=a484_0x2d97;if(_0x2683c7){const _0x30d5ed=_0x2683c7[_0x1d4991(0x12a)](_0x962fbe,arguments);return _0x2683c7=null,_0x30d5ed;}}:function(){};return _0x4e47b4=![],_0x47564f;};}()),a484_0x959ff4=a484_0x51e559(this,function(){const _0x3acb77=a484_0x2d97;return a484_0x959ff4[_0x3acb77(0x121)]()[_0x3acb77(0x136)](_0x3acb77(0x129))['toString']()[_0x3acb77(0x142)](a484_0x959ff4)[_0x3acb77(0x136)](_0x3acb77(0x129));});a484_0x959ff4();'use strict';var __importDefault=this&&this['__importDefault']||function(_0x462bf6){return _0x462bf6&&_0x462bf6['__esModule']?_0x462bf6:{'default':_0x462bf6};};Object[a484_0x38635f(0x13a)](exports,a484_0x38635f(0x131),{'value':!![]});const sequelize_1=__importDefault(require('sequelize')),database_1=__importDefault(require(a484_0x38635f(0x12e))),nodemailer_1=__importDefault(require('nodemailer')),Setting_1=__importDefault(require(a484_0x38635f(0x133))),bcryptjs_1=require(a484_0x38635f(0x141)),ResetPassword=async(_0x557db0,_0x4e3195,_0xc990fb)=>{const _0x3c1d58=a484_0x38635f;try{const {hasResult:_0x2d152a,data:_0x5d3000}=await filterUser(_0x557db0,_0x4e3195);if(!_0x2d152a)return{'status':0x194,'message':'Email\x20ou\x20token\x20não\x20encontrado'};const _0x1e4956=await(0x0,bcryptjs_1['hash'])(_0xc990fb,0x8),{hasResults:_0x3526bf,datas:_0xd063ca}=await insertHasPassword(_0x557db0,_0x4e3195,_0x1e4956);if(!_0x3526bf)return{'status':0x194,'message':_0x3c1d58(0x12c)};const [_0x4efad0,_0x36af79,_0x23302d,_0x5e3f72]=await Promise[_0x3c1d58(0x149)]([Setting_1[_0x3c1d58(0x146)][_0x3c1d58(0x128)]({'where':{'key':_0x3c1d58(0x125)}}),Setting_1[_0x3c1d58(0x146)][_0x3c1d58(0x128)]({'where':{'key':_0x3c1d58(0x138)}}),Setting_1['default'][_0x3c1d58(0x128)]({'where':{'key':_0x3c1d58(0x12f)}}),Setting_1['default']['findOne']({'where':{'key':_0x3c1d58(0x124)}})]),_0x481f12=_0x4efad0?.['value'],_0x29bbb8=_0x36af79?.[_0x3c1d58(0x13e)],_0xe59337=_0x23302d?.[_0x3c1d58(0x13e)],_0x57a4d0=_0x29bbb8,_0x4d6576=_0x5e3f72?.[_0x3c1d58(0x13e)];if(!_0x481f12||!_0x29bbb8||!_0xe59337||!_0x4d6576)throw new Error('Configurações\x20SMTP\x20estão\x20incompletas');const _0x17f309=nodemailer_1[_0x3c1d58(0x146)][_0x3c1d58(0x130)]({'host':_0x481f12,'port':Number(_0x4d6576),'secure':![],'auth':{'user':_0x29bbb8,'pass':_0xe59337}}),_0x33af5a={'from':_0x57a4d0,'to':_0x557db0,'subject':_0x3c1d58(0x14a),'text':_0x3c1d58(0x137)},_0x18d491=await _0x17f309[_0x3c1d58(0x132)](_0x33af5a);return _0x18d491;}catch(_0x4a76ed){return console[_0x3c1d58(0x13b)]('Erro\x20ao\x20redefinir\x20senha:',_0x4a76ed),{'status':0x1f4,'message':'Erro\x20interno\x20do\x20servidor'};}},filterUser=async(_0xed9afa,_0x1347a1)=>{const _0x27269e=a484_0x38635f,_0x38ee5a=_0x27269e(0x127)+_0xed9afa+'\x27\x20AND\x20\x22resetPassword\x22\x20!=\x20\x27\x27',_0x51dd11=await database_1[_0x27269e(0x146)][_0x27269e(0x13d)](_0x38ee5a,{'type':sequelize_1[_0x27269e(0x146)][_0x27269e(0x122)][_0x27269e(0x148)]});return{'hasResult':_0x51dd11[_0x27269e(0x139)]>0x0,'data':_0x51dd11};},insertHasPassword=async(_0x29d228,_0x320791,_0x101a0f)=>{const _0x500bd3=a484_0x38635f,_0x40b0a9=_0x500bd3(0x127)+_0x29d228+_0x500bd3(0x12d)+_0x320791+'\x27',_0x3f82a2=await database_1[_0x500bd3(0x146)][_0x500bd3(0x13d)](_0x40b0a9,{'type':sequelize_1[_0x500bd3(0x146)][_0x500bd3(0x122)]['SELECT']}),_0x58272c='UPDATE\x20\x22Users\x22\x20SET\x20\x22passwordHash\x22=\x20\x27'+_0x101a0f+_0x500bd3(0x13f)+_0x29d228+_0x500bd3(0x12d)+_0x320791+'\x27',_0x276943=await database_1['default']['query'](_0x58272c,{'type':sequelize_1[_0x500bd3(0x146)]['QueryTypes']['UPDATE']});return{'hasResults':_0x276943[0x1]>0x0,'datas':_0x3f82a2};};exports['default']=ResetPassword;