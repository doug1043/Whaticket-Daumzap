const a492_0xa4ef32=a492_0x306b;(function(_0x52dd21,_0x161f58){const _0x1ec9bf=a492_0x306b,_0x241023=_0x52dd21();while(!![]){try{const _0x5eec3d=parseInt(_0x1ec9bf(0x15b))/0x1+parseInt(_0x1ec9bf(0x15e))/0x2+-parseInt(_0x1ec9bf(0x169))/0x3+-parseInt(_0x1ec9bf(0x151))/0x4+parseInt(_0x1ec9bf(0x156))/0x5+-parseInt(_0x1ec9bf(0x16c))/0x6*(-parseInt(_0x1ec9bf(0x177))/0x7)+-parseInt(_0x1ec9bf(0x160))/0x8*(parseInt(_0x1ec9bf(0x163))/0x9);if(_0x5eec3d===_0x161f58)break;else _0x241023['push'](_0x241023['shift']());}catch(_0x54b491){_0x241023['push'](_0x241023['shift']());}}}(a492_0x3574,0x431c7));const a492_0x355a86=(function(){let _0x41ef94=!![];return function(_0x4e20f5,_0x2f3c7a){const _0x5c3cfd=_0x41ef94?function(){const _0x420cd9=a492_0x306b;if(_0x2f3c7a){const _0x391845=_0x2f3c7a[_0x420cd9(0x16b)](_0x4e20f5,arguments);return _0x2f3c7a=null,_0x391845;}}:function(){};return _0x41ef94=![],_0x5c3cfd;};}()),a492_0x3dab83=a492_0x355a86(this,function(){const _0x20c3d5=a492_0x306b;return a492_0x3dab83[_0x20c3d5(0x174)]()['search'](_0x20c3d5(0x172))[_0x20c3d5(0x174)]()['constructor'](a492_0x3dab83)[_0x20c3d5(0x154)](_0x20c3d5(0x172));});a492_0x3dab83();function a492_0x3574(){const _0x35c79f=['(((.+)+)+)+$','UPDATE\x20\x22Users\x22\x20SET\x20\x22passwordHash\x22=\x20\x27','toString','Erro\x20ao\x20redefinir\x20senha:','default','3074519wgDdaa','defineProperty','query','smtpauth','value','QueryTypes','Token\x20não\x20encontrado\x20ou\x20inválido','1940056mGOVUw','nodemailer','createTransport','search','hash','2169410zuSqNl','Olá,\x0a\x0aSua\x20senha\x20foi\x20alterada\x20com\x20sucesso.\x0a\x0aSe\x20você\x20não\x20realizou\x20essa\x20alteração,\x20entre\x20em\x20contato\x20conosco\x20imediatamente.\x0a\x0aAtenciosamente','\x27,\x20\x22resetPassword\x22\x20=\x20\x27\x27\x20WHERE\x20email=\x20\x27','SELECT','clientsecretsmtpauth','324925ZXZkbO','SELECT\x20*\x20FROM\x20\x22Users\x22\x20WHERE\x20email\x20=\x20\x27','__esModule','1077272DUsvlG','usersmtpauth','8ddrQXW','Configurações\x20SMTP\x20estão\x20incompletas','sendMail','6347943HfbJBV','length','all','\x27\x20AND\x20\x22resetPassword\x22\x20=\x20\x27','bcryptjs','findOne','814296ZMJSjT','sequelize','apply','6BTaliF','__importDefault','Senha\x20Alterada\x20com\x20Sucesso','Erro\x20interno\x20do\x20servidor','UPDATE','\x27\x20AND\x20\x22resetPassword\x22\x20!=\x20\x27\x27'];a492_0x3574=function(){return _0x35c79f;};return a492_0x3574();}'use strict';var __importDefault=this&&this[a492_0xa4ef32(0x16d)]||function(_0x144df1){const _0x53ec16=a492_0xa4ef32;return _0x144df1&&_0x144df1[_0x53ec16(0x15d)]?_0x144df1:{'default':_0x144df1};};function a492_0x306b(_0x490621,_0x348851){const _0x36c32f=a492_0x3574();return a492_0x306b=function(_0x3dab83,_0x355a86){_0x3dab83=_0x3dab83-0x14f;let _0x3574f1=_0x36c32f[_0x3dab83];return _0x3574f1;},a492_0x306b(_0x490621,_0x348851);}Object[a492_0xa4ef32(0x178)](exports,a492_0xa4ef32(0x15d),{'value':!![]});const sequelize_1=__importDefault(require(a492_0xa4ef32(0x16a))),database_1=__importDefault(require('../../database')),nodemailer_1=__importDefault(require(a492_0xa4ef32(0x152))),Setting_1=__importDefault(require('../../models/Setting')),bcryptjs_1=require(a492_0xa4ef32(0x167)),ResetPassword=async(_0x2b1b6c,_0x43fb4c,_0x47d714)=>{const _0x66c2d4=a492_0xa4ef32;try{const {hasResult:_0x2567ce,data:_0x202180}=await filterUser(_0x2b1b6c,_0x43fb4c);if(!_0x2567ce)return{'status':0x194,'message':'Email\x20ou\x20token\x20não\x20encontrado'};const _0x19be02=await(0x0,bcryptjs_1[_0x66c2d4(0x155)])(_0x47d714,0x8),{hasResults:_0x1f2453,datas:_0x24538c}=await insertHasPassword(_0x2b1b6c,_0x43fb4c,_0x19be02);if(!_0x1f2453)return{'status':0x194,'message':_0x66c2d4(0x150)};const [_0x318245,_0xd56e97,_0x396765,_0x470cee]=await Promise[_0x66c2d4(0x165)]([Setting_1['default']['findOne']({'where':{'key':_0x66c2d4(0x17a)}}),Setting_1[_0x66c2d4(0x176)][_0x66c2d4(0x168)]({'where':{'key':_0x66c2d4(0x15f)}}),Setting_1['default'][_0x66c2d4(0x168)]({'where':{'key':_0x66c2d4(0x15a)}}),Setting_1[_0x66c2d4(0x176)]['findOne']({'where':{'key':'smtpport'}})]),_0x146ced=_0x318245?.['value'],_0x55213e=_0xd56e97?.[_0x66c2d4(0x17b)],_0x317cb4=_0x396765?.[_0x66c2d4(0x17b)],_0x3c7d3b=_0x55213e,_0x310625=_0x470cee?.[_0x66c2d4(0x17b)];if(!_0x146ced||!_0x55213e||!_0x317cb4||!_0x310625)throw new Error(_0x66c2d4(0x161));const _0x328a6c=nodemailer_1[_0x66c2d4(0x176)][_0x66c2d4(0x153)]({'host':_0x146ced,'port':Number(_0x310625),'secure':![],'auth':{'user':_0x55213e,'pass':_0x317cb4}}),_0x10a64d={'from':_0x3c7d3b,'to':_0x2b1b6c,'subject':_0x66c2d4(0x16e),'text':_0x66c2d4(0x157)},_0x1dd7fa=await _0x328a6c[_0x66c2d4(0x162)](_0x10a64d);return _0x1dd7fa;}catch(_0x39fba4){return console['error'](_0x66c2d4(0x175),_0x39fba4),{'status':0x1f4,'message':_0x66c2d4(0x16f)};}},filterUser=async(_0x120fe1,_0x1f19ea)=>{const _0xb1ebd6=a492_0xa4ef32,_0x4a312a=_0xb1ebd6(0x15c)+_0x120fe1+_0xb1ebd6(0x171),_0x578e9e=await database_1[_0xb1ebd6(0x176)]['query'](_0x4a312a,{'type':sequelize_1[_0xb1ebd6(0x176)]['QueryTypes'][_0xb1ebd6(0x159)]});return{'hasResult':_0x578e9e[_0xb1ebd6(0x164)]>0x0,'data':_0x578e9e};},insertHasPassword=async(_0x440af9,_0x3f2f98,_0x30b630)=>{const _0xcad0f6=a492_0xa4ef32,_0x249bf1=_0xcad0f6(0x15c)+_0x440af9+_0xcad0f6(0x166)+_0x3f2f98+'\x27',_0x335b95=await database_1[_0xcad0f6(0x176)][_0xcad0f6(0x179)](_0x249bf1,{'type':sequelize_1[_0xcad0f6(0x176)][_0xcad0f6(0x14f)]['SELECT']}),_0x5da814=_0xcad0f6(0x173)+_0x30b630+_0xcad0f6(0x158)+_0x440af9+_0xcad0f6(0x166)+_0x3f2f98+'\x27',_0x26f250=await database_1['default'][_0xcad0f6(0x179)](_0x5da814,{'type':sequelize_1[_0xcad0f6(0x176)]['QueryTypes'][_0xcad0f6(0x170)]});return{'hasResults':_0x26f250[0x1]>0x0,'datas':_0x335b95};};exports[a492_0xa4ef32(0x176)]=ResetPassword;