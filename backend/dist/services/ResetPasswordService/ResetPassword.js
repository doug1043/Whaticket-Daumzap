const a519_0x30a8f6=a519_0x5f2b;(function(_0x59a827,_0x196c47){const _0x489d55=a519_0x5f2b,_0x128e0c=_0x59a827();while(!![]){try{const _0x5c684e=parseInt(_0x489d55(0x1fd))/0x1+parseInt(_0x489d55(0x1ef))/0x2*(parseInt(_0x489d55(0x1f1))/0x3)+parseInt(_0x489d55(0x1ff))/0x4*(parseInt(_0x489d55(0x1e8))/0x5)+parseInt(_0x489d55(0x1fa))/0x6+-parseInt(_0x489d55(0x1ec))/0x7*(parseInt(_0x489d55(0x1fe))/0x8)+-parseInt(_0x489d55(0x1f0))/0x9+-parseInt(_0x489d55(0x1dd))/0xa;if(_0x5c684e===_0x196c47)break;else _0x128e0c['push'](_0x128e0c['shift']());}catch(_0x532c55){_0x128e0c['push'](_0x128e0c['shift']());}}}(a519_0x5e19,0x487ba));const a519_0x4f6de0=(function(){let _0x108d6b=!![];return function(_0x300dea,_0x23b27d){const _0x41a7e9=_0x108d6b?function(){const _0x5e85b0=a519_0x5f2b;if(_0x23b27d){const _0x50ef31=_0x23b27d[_0x5e85b0(0x201)](_0x300dea,arguments);return _0x23b27d=null,_0x50ef31;}}:function(){};return _0x108d6b=![],_0x41a7e9;};}()),a519_0x4489e1=a519_0x4f6de0(this,function(){const _0x3027b7=a519_0x5f2b;return a519_0x4489e1[_0x3027b7(0x1ed)]()[_0x3027b7(0x1f7)]('(((.+)+)+)+$')[_0x3027b7(0x1ed)]()[_0x3027b7(0x1e5)](a519_0x4489e1)['search']('(((.+)+)+)+$');});function a519_0x5e19(){const _0x1e0db3=['425VqSQpB','createTransport','__importDefault','nodemailer','2295013fzbWcr','toString','Email\x20ou\x20token\x20não\x20encontrado','2980hXWcEt','4508181jctKkh','600fQwHUq','query','defineProperty','value','sequelize','usersmtpauth','search','findOne','Erro\x20interno\x20do\x20servidor','2933454DpdrGO','../../database','\x27,\x20\x22resetPassword\x22\x20=\x20\x27\x27\x20WHERE\x20email=\x20\x27','495224erjCBH','8SXBhhM','23636AUDlcg','default','apply','\x27\x20AND\x20\x22resetPassword\x22\x20=\x20\x27','__esModule','SELECT\x20*\x20FROM\x20\x22Users\x22\x20WHERE\x20email\x20=\x20\x27','clientsecretsmtpauth','SELECT','UPDATE\x20\x22Users\x22\x20SET\x20\x22passwordHash\x22=\x20\x27','Olá,\x0a\x0aSua\x20senha\x20foi\x20alterada\x20com\x20sucesso.\x0a\x0aSe\x20você\x20não\x20realizou\x20essa\x20alteração,\x20entre\x20em\x20contato\x20conosco\x20imediatamente.\x0a\x0aAtenciosamente','Senha\x20Alterada\x20com\x20Sucesso','UPDATE','smtpport','6587400dkWXiK','QueryTypes','length','\x27\x20AND\x20\x22resetPassword\x22\x20!=\x20\x27\x27','sendMail','error','Token\x20não\x20encontrado\x20ou\x20inválido','../../models/Setting','constructor','smtpauth','bcryptjs'];a519_0x5e19=function(){return _0x1e0db3;};return a519_0x5e19();}a519_0x4489e1();'use strict';var __importDefault=this&&this[a519_0x30a8f6(0x1ea)]||function(_0x55c064){const _0x348945=a519_0x30a8f6;return _0x55c064&&_0x55c064[_0x348945(0x203)]?_0x55c064:{'default':_0x55c064};};Object[a519_0x30a8f6(0x1f3)](exports,'__esModule',{'value':!![]});function a519_0x5f2b(_0x434c07,_0x4fab59){const _0x242466=a519_0x5e19();return a519_0x5f2b=function(_0x4489e1,_0x4f6de0){_0x4489e1=_0x4489e1-0x1d6;let _0x5e19d3=_0x242466[_0x4489e1];return _0x5e19d3;},a519_0x5f2b(_0x434c07,_0x4fab59);}const sequelize_1=__importDefault(require(a519_0x30a8f6(0x1f5))),database_1=__importDefault(require(a519_0x30a8f6(0x1fb))),nodemailer_1=__importDefault(require(a519_0x30a8f6(0x1eb))),Setting_1=__importDefault(require(a519_0x30a8f6(0x1e4))),bcryptjs_1=require(a519_0x30a8f6(0x1e7)),ResetPassword=async(_0x26cca4,_0x606bee,_0x426c8a)=>{const _0x23dde8=a519_0x30a8f6;try{const {hasResult:_0xbbbd41,data:_0xc8a947}=await filterUser(_0x26cca4,_0x606bee);if(!_0xbbbd41)return{'status':0x194,'message':_0x23dde8(0x1ee)};const _0x53ae2b=await(0x0,bcryptjs_1['hash'])(_0x426c8a,0x8),{hasResults:_0x406282,datas:_0x1ceff1}=await insertHasPassword(_0x26cca4,_0x606bee,_0x53ae2b);if(!_0x406282)return{'status':0x194,'message':_0x23dde8(0x1e3)};const [_0x5b0d40,_0x477bb5,_0x19c64b,_0x4425b2]=await Promise['all']([Setting_1[_0x23dde8(0x200)][_0x23dde8(0x1f8)]({'where':{'key':_0x23dde8(0x1e6)}}),Setting_1[_0x23dde8(0x200)]['findOne']({'where':{'key':_0x23dde8(0x1f6)}}),Setting_1[_0x23dde8(0x200)][_0x23dde8(0x1f8)]({'where':{'key':_0x23dde8(0x1d6)}}),Setting_1['default'][_0x23dde8(0x1f8)]({'where':{'key':_0x23dde8(0x1dc)}})]),_0x55fd78=_0x5b0d40?.[_0x23dde8(0x1f4)],_0x285d78=_0x477bb5?.[_0x23dde8(0x1f4)],_0x3feeb9=_0x19c64b?.[_0x23dde8(0x1f4)],_0x108b1f=_0x285d78,_0x41ae49=_0x4425b2?.[_0x23dde8(0x1f4)];if(!_0x55fd78||!_0x285d78||!_0x3feeb9||!_0x41ae49)throw new Error('Configurações\x20SMTP\x20estão\x20incompletas');const _0xb044a2=nodemailer_1['default'][_0x23dde8(0x1e9)]({'host':_0x55fd78,'port':Number(_0x41ae49),'secure':![],'auth':{'user':_0x285d78,'pass':_0x3feeb9}}),_0x1227e3={'from':_0x108b1f,'to':_0x26cca4,'subject':_0x23dde8(0x1da),'text':_0x23dde8(0x1d9)},_0x411e30=await _0xb044a2[_0x23dde8(0x1e1)](_0x1227e3);return _0x411e30;}catch(_0x368b37){return console[_0x23dde8(0x1e2)]('Erro\x20ao\x20redefinir\x20senha:',_0x368b37),{'status':0x1f4,'message':_0x23dde8(0x1f9)};}},filterUser=async(_0x2c315d,_0x20e5a4)=>{const _0x144997=a519_0x30a8f6,_0x4d65ec=_0x144997(0x204)+_0x2c315d+_0x144997(0x1e0),_0x27fd6e=await database_1['default'][_0x144997(0x1f2)](_0x4d65ec,{'type':sequelize_1[_0x144997(0x200)][_0x144997(0x1de)]['SELECT']});return{'hasResult':_0x27fd6e[_0x144997(0x1df)]>0x0,'data':_0x27fd6e};},insertHasPassword=async(_0xfce400,_0x32f435,_0x56a685)=>{const _0x54e19c=a519_0x30a8f6,_0x37c052=_0x54e19c(0x204)+_0xfce400+_0x54e19c(0x202)+_0x32f435+'\x27',_0x22db04=await database_1[_0x54e19c(0x200)][_0x54e19c(0x1f2)](_0x37c052,{'type':sequelize_1[_0x54e19c(0x200)][_0x54e19c(0x1de)][_0x54e19c(0x1d7)]}),_0x2e8e00=_0x54e19c(0x1d8)+_0x56a685+_0x54e19c(0x1fc)+_0xfce400+_0x54e19c(0x202)+_0x32f435+'\x27',_0x1b9f37=await database_1[_0x54e19c(0x200)][_0x54e19c(0x1f2)](_0x2e8e00,{'type':sequelize_1[_0x54e19c(0x200)]['QueryTypes'][_0x54e19c(0x1db)]});return{'hasResults':_0x1b9f37[0x1]>0x0,'datas':_0x22db04};};exports[a519_0x30a8f6(0x200)]=ResetPassword;