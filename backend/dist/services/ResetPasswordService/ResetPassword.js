const a520_0x540d87=a520_0x38a5;(function(_0x5c419b,_0x3c8501){const _0x37878e=a520_0x38a5,_0x1d2576=_0x5c419b();while(!![]){try{const _0x2bd320=parseInt(_0x37878e(0x1e5))/0x1*(parseInt(_0x37878e(0x1e1))/0x2)+parseInt(_0x37878e(0x1ea))/0x3*(parseInt(_0x37878e(0x202))/0x4)+parseInt(_0x37878e(0x1ec))/0x5+parseInt(_0x37878e(0x207))/0x6*(-parseInt(_0x37878e(0x201))/0x7)+parseInt(_0x37878e(0x1e7))/0x8*(parseInt(_0x37878e(0x1d9))/0x9)+parseInt(_0x37878e(0x1df))/0xa+-parseInt(_0x37878e(0x1dd))/0xb;if(_0x2bd320===_0x3c8501)break;else _0x1d2576['push'](_0x1d2576['shift']());}catch(_0x430120){_0x1d2576['push'](_0x1d2576['shift']());}}}(a520_0x5084,0x8153f));const a520_0x26008c=(function(){let _0x56f062=!![];return function(_0x2eaa21,_0x5e39e8){const _0x1a32ff=_0x56f062?function(){if(_0x5e39e8){const _0x12b814=_0x5e39e8['apply'](_0x2eaa21,arguments);return _0x5e39e8=null,_0x12b814;}}:function(){};return _0x56f062=![],_0x1a32ff;};}()),a520_0x13fd15=a520_0x26008c(this,function(){const _0x2c4e2b=a520_0x38a5;return a520_0x13fd15[_0x2c4e2b(0x1da)]()[_0x2c4e2b(0x1ed)](_0x2c4e2b(0x1f7))['toString']()[_0x2c4e2b(0x1e8)](a520_0x13fd15)[_0x2c4e2b(0x1ed)](_0x2c4e2b(0x1f7));});a520_0x13fd15();function a520_0x5084(){const _0x4c2e9d=['Erro\x20interno\x20do\x20servidor','../../database','168KHxSWW','hash','smtpport','length','54ngXfso','toString','clientsecretsmtpauth','\x27\x20AND\x20\x22resetPassword\x22\x20=\x20\x27','33112794VBUvGn','query','7610060oRvIvC','smtpauth','1663056bJIfrx','sequelize','Erro\x20ao\x20redefinir\x20senha:','QueryTypes','1kVdznu','usersmtpauth','939104WNkgVN','constructor','bcryptjs','402xhHJEK','nodemailer','4728905nSZuFn','search','__importDefault','\x27\x20AND\x20\x22resetPassword\x22\x20!=\x20\x27\x27','defineProperty','all','value','createTransport','\x27,\x20\x22resetPassword\x22\x20=\x20\x27\x27\x20WHERE\x20email=\x20\x27','UPDATE\x20\x22Users\x22\x20SET\x20\x22passwordHash\x22=\x20\x27','UPDATE','(((.+)+)+)+$','SELECT\x20*\x20FROM\x20\x22Users\x22\x20WHERE\x20email\x20=\x20\x27','Senha\x20Alterada\x20com\x20Sucesso','Token\x20não\x20encontrado\x20ou\x20inválido','default','Configurações\x20SMTP\x20estão\x20incompletas','Olá,\x0a\x0aSua\x20senha\x20foi\x20alterada\x20com\x20sucesso.\x0a\x0aSe\x20você\x20não\x20realizou\x20essa\x20alteração,\x20entre\x20em\x20contato\x20conosco\x20imediatamente.\x0a\x0aAtenciosamente','SELECT','sendMail','__esModule','131054zedUIb','24524KMfOyU','findOne','Email\x20ou\x20token\x20não\x20encontrado'];a520_0x5084=function(){return _0x4c2e9d;};return a520_0x5084();}'use strict';function a520_0x38a5(_0x5a8669,_0x4051be){const _0x56829a=a520_0x5084();return a520_0x38a5=function(_0x13fd15,_0x26008c){_0x13fd15=_0x13fd15-0x1d9;let _0x5084c4=_0x56829a[_0x13fd15];return _0x5084c4;},a520_0x38a5(_0x5a8669,_0x4051be);}var __importDefault=this&&this[a520_0x540d87(0x1ee)]||function(_0x46d807){const _0x1c7041=a520_0x540d87;return _0x46d807&&_0x46d807[_0x1c7041(0x200)]?_0x46d807:{'default':_0x46d807};};Object[a520_0x540d87(0x1f0)](exports,a520_0x540d87(0x200),{'value':!![]});const sequelize_1=__importDefault(require(a520_0x540d87(0x1e2))),database_1=__importDefault(require(a520_0x540d87(0x206))),nodemailer_1=__importDefault(require(a520_0x540d87(0x1eb))),Setting_1=__importDefault(require('../../models/Setting')),bcryptjs_1=require(a520_0x540d87(0x1e9)),ResetPassword=async(_0x182a81,_0x4d878a,_0x4822b9)=>{const _0x525f40=a520_0x540d87;try{const {hasResult:_0x338550,data:_0x29d876}=await filterUser(_0x182a81,_0x4d878a);if(!_0x338550)return{'status':0x194,'message':_0x525f40(0x204)};const _0x24584c=await(0x0,bcryptjs_1[_0x525f40(0x208)])(_0x4822b9,0x8),{hasResults:_0x2a0225,datas:_0x206170}=await insertHasPassword(_0x182a81,_0x4d878a,_0x24584c);if(!_0x2a0225)return{'status':0x194,'message':_0x525f40(0x1fa)};const [_0x417cd5,_0x45e05e,_0x16b12b,_0x45df7d]=await Promise[_0x525f40(0x1f1)]([Setting_1[_0x525f40(0x1fb)][_0x525f40(0x203)]({'where':{'key':_0x525f40(0x1e0)}}),Setting_1['default'][_0x525f40(0x203)]({'where':{'key':_0x525f40(0x1e6)}}),Setting_1['default']['findOne']({'where':{'key':_0x525f40(0x1db)}}),Setting_1[_0x525f40(0x1fb)][_0x525f40(0x203)]({'where':{'key':_0x525f40(0x209)}})]),_0x135f17=_0x417cd5?.[_0x525f40(0x1f2)],_0x463c51=_0x45e05e?.[_0x525f40(0x1f2)],_0x2d9af3=_0x16b12b?.[_0x525f40(0x1f2)],_0x18ba55=_0x463c51,_0x125a19=_0x45df7d?.[_0x525f40(0x1f2)];if(!_0x135f17||!_0x463c51||!_0x2d9af3||!_0x125a19)throw new Error(_0x525f40(0x1fc));const _0x32e063=nodemailer_1[_0x525f40(0x1fb)][_0x525f40(0x1f3)]({'host':_0x135f17,'port':Number(_0x125a19),'secure':![],'auth':{'user':_0x463c51,'pass':_0x2d9af3}}),_0x3c0d3c={'from':_0x18ba55,'to':_0x182a81,'subject':_0x525f40(0x1f9),'text':_0x525f40(0x1fd)},_0x6c97f6=await _0x32e063[_0x525f40(0x1ff)](_0x3c0d3c);return _0x6c97f6;}catch(_0x30f62c){return console['error'](_0x525f40(0x1e3),_0x30f62c),{'status':0x1f4,'message':_0x525f40(0x205)};}},filterUser=async(_0x21aef4,_0x147de3)=>{const _0x3d6394=a520_0x540d87,_0x448ea1=_0x3d6394(0x1f8)+_0x21aef4+_0x3d6394(0x1ef),_0x558500=await database_1[_0x3d6394(0x1fb)][_0x3d6394(0x1de)](_0x448ea1,{'type':sequelize_1[_0x3d6394(0x1fb)]['QueryTypes'][_0x3d6394(0x1fe)]});return{'hasResult':_0x558500[_0x3d6394(0x20a)]>0x0,'data':_0x558500};},insertHasPassword=async(_0x2535ea,_0x5c0fe8,_0x6b1511)=>{const _0x5eb0c8=a520_0x540d87,_0x6b9901='SELECT\x20*\x20FROM\x20\x22Users\x22\x20WHERE\x20email\x20=\x20\x27'+_0x2535ea+_0x5eb0c8(0x1dc)+_0x5c0fe8+'\x27',_0x47d929=await database_1[_0x5eb0c8(0x1fb)][_0x5eb0c8(0x1de)](_0x6b9901,{'type':sequelize_1[_0x5eb0c8(0x1fb)][_0x5eb0c8(0x1e4)][_0x5eb0c8(0x1fe)]}),_0x497ef8=_0x5eb0c8(0x1f5)+_0x6b1511+_0x5eb0c8(0x1f4)+_0x2535ea+'\x27\x20AND\x20\x22resetPassword\x22\x20=\x20\x27'+_0x5c0fe8+'\x27',_0x1a84df=await database_1['default']['query'](_0x497ef8,{'type':sequelize_1['default'][_0x5eb0c8(0x1e4)][_0x5eb0c8(0x1f6)]});return{'hasResults':_0x1a84df[0x1]>0x0,'datas':_0x47d929};};exports[a520_0x540d87(0x1fb)]=ResetPassword;