'use strict';const a562_0x58f3b5=a562_0x2df4;(function(_0x359efc,_0xe1ab33){const _0x26d076=a562_0x2df4,_0xc717ae=_0x359efc();while(!![]){try{const _0x175775=parseInt(_0x26d076(0xfc))/0x1+parseInt(_0x26d076(0xf4))/0x2+parseInt(_0x26d076(0xe5))/0x3*(-parseInt(_0x26d076(0x111))/0x4)+parseInt(_0x26d076(0xf1))/0x5*(-parseInt(_0x26d076(0x10a))/0x6)+-parseInt(_0x26d076(0xed))/0x7+parseInt(_0x26d076(0x10e))/0x8*(-parseInt(_0x26d076(0x110))/0x9)+parseInt(_0x26d076(0xfd))/0xa;if(_0x175775===_0xe1ab33)break;else _0xc717ae['push'](_0xc717ae['shift']());}catch(_0x226b87){_0xc717ae['push'](_0xc717ae['shift']());}}}(a562_0x25b9,0x40506));var __createBinding=this&&this[a562_0x58f3b5(0xf2)]||(Object[a562_0x58f3b5(0xe6)]?function(_0x10c371,_0xcd670,_0x2426f8,_0x3777a8){const _0x505613=a562_0x58f3b5;if(_0x3777a8===undefined)_0x3777a8=_0x2426f8;var _0x2343f1=Object[_0x505613(0xe9)](_0xcd670,_0x2426f8);(!_0x2343f1||(_0x505613(0xf0)in _0x2343f1?!_0xcd670[_0x505613(0xfe)]:_0x2343f1['writable']||_0x2343f1[_0x505613(0x107)]))&&(_0x2343f1={'enumerable':!![],'get':function(){return _0xcd670[_0x2426f8];}}),Object[_0x505613(0x103)](_0x10c371,_0x3777a8,_0x2343f1);}:function(_0x324d14,_0x3e67a5,_0xd35a54,_0x1e2cca){if(_0x1e2cca===undefined)_0x1e2cca=_0xd35a54;_0x324d14[_0x1e2cca]=_0x3e67a5[_0xd35a54];}),__setModuleDefault=this&&this[a562_0x58f3b5(0x10f)]||(Object[a562_0x58f3b5(0xe6)]?function(_0x4f44e9,_0x56a17b){const _0x5e3606=a562_0x58f3b5;Object[_0x5e3606(0x103)](_0x4f44e9,_0x5e3606(0x100),{'enumerable':!![],'value':_0x56a17b});}:function(_0x2de534,_0x2a5326){const _0x43e4d3=a562_0x58f3b5;_0x2de534[_0x43e4d3(0x100)]=_0x2a5326;}),__importStar=this&&this[a562_0x58f3b5(0xf8)]||(function(){const _0xf2fbf4=(function(){let _0x225fc7=!![];return function(_0x57f384,_0x586b66){const _0x43a9da=_0x225fc7?function(){if(_0x586b66){const _0x2b47a8=_0x586b66['apply'](_0x57f384,arguments);return _0x586b66=null,_0x2b47a8;}}:function(){};return _0x225fc7=![],_0x43a9da;};}()),_0x237746=_0xf2fbf4(this,function(){const _0x503546=a562_0x2df4;return _0x237746['toString']()[_0x503546(0xf5)](_0x503546(0x10c))[_0x503546(0x106)]()[_0x503546(0x109)](_0x237746)['search']('(((.+)+)+)+$');});_0x237746();var _0x429820=function(_0x2d62a9){const _0x450bc9=a562_0x2df4;return _0x429820=Object[_0x450bc9(0xe8)]||function(_0x3eda3c){const _0xe8c7ca=_0x450bc9;var _0x315ddc=[];for(var _0x313fdb in _0x3eda3c)if(Object['prototype'][_0xe8c7ca(0x104)][_0xe8c7ca(0xeb)](_0x3eda3c,_0x313fdb))_0x315ddc[_0x315ddc[_0xe8c7ca(0x102)]]=_0x313fdb;return _0x315ddc;},_0x429820(_0x2d62a9);};return function(_0x3919a6){const _0x5bae7d=a562_0x2df4;if(_0x3919a6&&_0x3919a6['__esModule'])return _0x3919a6;var _0x21488b={};if(_0x3919a6!=null){for(var _0x5e147f=_0x429820(_0x3919a6),_0x1964f5=0x0;_0x1964f5<_0x5e147f[_0x5bae7d(0x102)];_0x1964f5++)if(_0x5e147f[_0x1964f5]!==_0x5bae7d(0x100))__createBinding(_0x21488b,_0x3919a6,_0x5e147f[_0x1964f5]);}return __setModuleDefault(_0x21488b,_0x3919a6),_0x21488b;};}()),__importDefault=this&&this[a562_0x58f3b5(0xef)]||function(_0x4c08d5){const _0xb67d5c=a562_0x58f3b5;return _0x4c08d5&&_0x4c08d5[_0xb67d5c(0xfe)]?_0x4c08d5:{'default':_0x4c08d5};};Object[a562_0x58f3b5(0x103)](exports,a562_0x58f3b5(0xfe),{'value':!![]});function a562_0x2df4(_0x42d31,_0x580ee3){const _0x2fcfc8=a562_0x25b9();return a562_0x2df4=function(_0x63a169,_0x3b66b9){_0x63a169=_0x63a169-0xe4;let _0x25b9f2=_0x2fcfc8[_0x63a169];return _0x25b9f2;},a562_0x2df4(_0x42d31,_0x580ee3);}function a562_0x25b9(){const _0x34b2a9=['hasOwnProperty','profile','toString','configurable','$set','constructor','6uVNHma','admin','(((.+)+)+)+$','companyId','649720xYqrHv','__setModuleDefault','36kgRrsy','392VAKise','message','string','validate','10905ExxNee','create','queues','getOwnPropertyNames','getOwnPropertyDescriptor','object','call','../../models/Company','249242iAWODv','../../models/User','__importDefault','get','1114255WAiqGY','__createBinding','shape','887360MOkwSZ','search','findByPk','email','__importStar','ERR_FORBIDDEN','reload','super','189806xEOEGI','5694910MDOooA','__esModule','update','default','../../errors/AppError','length','defineProperty'];a562_0x25b9=function(){return _0x34b2a9;};return a562_0x25b9();}const Yup=__importStar(require('yup')),AppError_1=__importDefault(require(a562_0x58f3b5(0x101))),ShowUserService_1=__importDefault(require('./ShowUserService')),Company_1=__importDefault(require(a562_0x58f3b5(0xec))),User_1=__importDefault(require(a562_0x58f3b5(0xee))),UpdateUserService=async({userData:_0x3fc174,userId:_0x5c59ae,requestUserId:_0x2e7228})=>{const _0x3f1405=a562_0x58f3b5,_0x22e12e=await(0x0,ShowUserService_1['default'])(_0x5c59ae,_0x2e7228),_0x258f66=await User_1['default'][_0x3f1405(0xf6)](_0x2e7228);if(!_0x258f66[_0x3f1405(0xfb)]&&+_0x5c59ae!==_0x258f66['id']&&(_0x22e12e[_0x3f1405(0x10d)]!==_0x258f66['companyId']||_0x258f66['profile']!=='admin'))throw new AppError_1[(_0x3f1405(0x100))](_0x3f1405(0xf9),0x193);const _0xc3fa17=Yup[_0x3f1405(0xea)]()[_0x3f1405(0xf3)]({'name':Yup[_0x3f1405(0x113)]()['min'](0x2),'email':Yup[_0x3f1405(0x113)]()[_0x3f1405(0xf7)](),'profile':Yup[_0x3f1405(0x113)](),'password':Yup[_0x3f1405(0x113)]()}),{email:_0x43f71c,password:_0x477f65,profile:_0x1026b7,name:_0x27b52c,queueIds:queueIds=[]}=_0x3fc174;try{await _0xc3fa17[_0x3f1405(0xe4)]({'email':_0x43f71c,'password':_0x477f65,'profile':_0x1026b7,'name':_0x27b52c});}catch(_0x2d37e8){throw new AppError_1[(_0x3f1405(0x100))](_0x2d37e8[_0x3f1405(0x112)]);}_0x258f66[_0x3f1405(0x105)]===_0x3f1405(0x10b)?(await _0x22e12e['update']({'email':_0x43f71c,'password':_0x477f65,'profile':_0x1026b7,'name':_0x27b52c}),await _0x22e12e[_0x3f1405(0x108)]('queues',queueIds)):await _0x22e12e[_0x3f1405(0xff)]({'email':_0x43f71c,'password':_0x477f65,'name':_0x27b52c});await _0x22e12e[_0x3f1405(0xfa)]();const _0x153fa0=await Company_1['default'][_0x3f1405(0xf6)](_0x22e12e[_0x3f1405(0x10d)]),_0x289dc6={'id':_0x22e12e['id'],'name':_0x22e12e['name'],'email':_0x22e12e[_0x3f1405(0xf7)],'profile':_0x22e12e['profile'],'companyId':_0x22e12e[_0x3f1405(0x10d)],'company':_0x153fa0,'queues':_0x22e12e[_0x3f1405(0xe7)]};return _0x289dc6;};exports['default']=UpdateUserService;