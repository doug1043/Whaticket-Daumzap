'use strict';const a557_0x2250f5=a557_0x1cdf;(function(_0x2347d2,_0x71b3cf){const _0x477875=a557_0x1cdf,_0x24c424=_0x2347d2();while(!![]){try{const _0x1d220f=parseInt(_0x477875(0x88))/0x1+parseInt(_0x477875(0x9a))/0x2*(parseInt(_0x477875(0x94))/0x3)+-parseInt(_0x477875(0x99))/0x4*(-parseInt(_0x477875(0x97))/0x5)+parseInt(_0x477875(0xa7))/0x6*(-parseInt(_0x477875(0x85))/0x7)+parseInt(_0x477875(0xac))/0x8+-parseInt(_0x477875(0xaa))/0x9+-parseInt(_0x477875(0x87))/0xa*(parseInt(_0x477875(0xa6))/0xb);if(_0x1d220f===_0x71b3cf)break;else _0x24c424['push'](_0x24c424['shift']());}catch(_0x32e01f){_0x24c424['push'](_0x24c424['shift']());}}}(a557_0x288b,0x92033));function a557_0x1cdf(_0x1a2c40,_0x3f527a){const _0x536318=a557_0x288b();return a557_0x1cdf=function(_0xc5ee0f,_0x141c3b){_0xc5ee0f=_0xc5ee0f-0x85;let _0x288b29=_0x536318[_0xc5ee0f];return _0x288b29;},a557_0x1cdf(_0x1a2c40,_0x3f527a);}var __createBinding=this&&this[a557_0x2250f5(0xa5)]||(Object[a557_0x2250f5(0xad)]?function(_0x15c332,_0x265b12,_0x55a72c,_0x1b5b60){const _0xbf902f=a557_0x2250f5;if(_0x1b5b60===undefined)_0x1b5b60=_0x55a72c;var _0x396d2d=Object[_0xbf902f(0x86)](_0x265b12,_0x55a72c);(!_0x396d2d||(_0xbf902f(0x96)in _0x396d2d?!_0x265b12[_0xbf902f(0xaf)]:_0x396d2d['writable']||_0x396d2d[_0xbf902f(0x9e)]))&&(_0x396d2d={'enumerable':!![],'get':function(){return _0x265b12[_0x55a72c];}}),Object[_0xbf902f(0x93)](_0x15c332,_0x1b5b60,_0x396d2d);}:function(_0x3f02e7,_0x3549f8,_0x3d05b4,_0x1d931f){if(_0x1d931f===undefined)_0x1d931f=_0x3d05b4;_0x3f02e7[_0x1d931f]=_0x3549f8[_0x3d05b4];}),__setModuleDefault=this&&this[a557_0x2250f5(0xa8)]||(Object[a557_0x2250f5(0xad)]?function(_0x9e8949,_0x1a4b49){const _0x388f32=a557_0x2250f5;Object[_0x388f32(0x93)](_0x9e8949,_0x388f32(0x8c),{'enumerable':!![],'value':_0x1a4b49});}:function(_0x3a82e2,_0x4e0657){const _0x3c4d60=a557_0x2250f5;_0x3a82e2[_0x3c4d60(0x8c)]=_0x4e0657;}),__importStar=this&&this[a557_0x2250f5(0x8b)]||(function(){const _0x14851f=(function(){let _0x59715a=!![];return function(_0x317186,_0x5378a0){const _0x45369c=_0x59715a?function(){const _0x37c031=a557_0x1cdf;if(_0x5378a0){const _0x223736=_0x5378a0[_0x37c031(0x98)](_0x317186,arguments);return _0x5378a0=null,_0x223736;}}:function(){};return _0x59715a=![],_0x45369c;};}()),_0x37a688=_0x14851f(this,function(){const _0x51e1d=a557_0x1cdf;return _0x37a688[_0x51e1d(0x89)]()[_0x51e1d(0x90)](_0x51e1d(0xa1))[_0x51e1d(0x89)]()[_0x51e1d(0x92)](_0x37a688)[_0x51e1d(0x90)](_0x51e1d(0xa1));});_0x37a688();var _0x22bd38=function(_0x3a35f7){return _0x22bd38=Object['getOwnPropertyNames']||function(_0x44a844){const _0x2d47a2=a557_0x1cdf;var _0x258103=[];for(var _0x4c5769 in _0x44a844)if(Object[_0x2d47a2(0x8e)][_0x2d47a2(0x9d)]['call'](_0x44a844,_0x4c5769))_0x258103[_0x258103[_0x2d47a2(0xae)]]=_0x4c5769;return _0x258103;},_0x22bd38(_0x3a35f7);};return function(_0x1d25bc){const _0xebf0cb=a557_0x1cdf;if(_0x1d25bc&&_0x1d25bc[_0xebf0cb(0xaf)])return _0x1d25bc;var _0x2b0647={};if(_0x1d25bc!=null){for(var _0x1d9b82=_0x22bd38(_0x1d25bc),_0x2991f3=0x0;_0x2991f3<_0x1d9b82[_0xebf0cb(0xae)];_0x2991f3++)if(_0x1d9b82[_0x2991f3]!==_0xebf0cb(0x8c))__createBinding(_0x2b0647,_0x1d25bc,_0x1d9b82[_0x2991f3]);}return __setModuleDefault(_0x2b0647,_0x1d25bc),_0x2b0647;};}()),__importDefault=this&&this[a557_0x2250f5(0xa4)]||function(_0x49c922){const _0x283316=a557_0x2250f5;return _0x49c922&&_0x49c922[_0x283316(0xaf)]?_0x49c922:{'default':_0x49c922};};Object[a557_0x2250f5(0x93)](exports,a557_0x2250f5(0xaf),{'value':!![]});const Yup=__importStar(require(a557_0x2250f5(0xa2))),AppError_1=__importDefault(require('../../errors/AppError')),SerializeUser_1=require(a557_0x2250f5(0xb1)),User_1=__importDefault(require(a557_0x2250f5(0x9c))),Plan_1=__importDefault(require(a557_0x2250f5(0xb4))),Company_1=__importDefault(require('../../models/Company')),CreateUserService=async({email:_0x402e5e,password:_0x197b21,name:_0x4012db,queueIds:queueIds=[],companyId:_0x42c02f,profile:profile='admin'})=>{const _0x22702e=a557_0x2250f5;if(_0x42c02f!==undefined){const _0x307979=await Company_1['default']['findOne']({'where':{'id':_0x42c02f},'include':[{'model':Plan_1[_0x22702e(0x8c)],'as':_0x22702e(0xb3)}]});if(_0x307979!==null){const _0x17453d=await User_1[_0x22702e(0x8c)][_0x22702e(0xa3)]({'where':{'companyId':_0x42c02f}});if(_0x17453d>=_0x307979[_0x22702e(0xb3)][_0x22702e(0xa0)])throw new AppError_1[(_0x22702e(0x8c))](_0x22702e(0x8d)+_0x17453d);}}const _0x563bd3=Yup[_0x22702e(0x8f)]()[_0x22702e(0xb2)]({'name':Yup[_0x22702e(0x95)]()[_0x22702e(0x9b)]()[_0x22702e(0xab)](0x2),'email':Yup[_0x22702e(0x95)]()[_0x22702e(0xb0)]()[_0x22702e(0x9b)]()['test'](_0x22702e(0x8a),'An\x20user\x20with\x20this\x20email\x20already\x20exists.',async _0x3e5b40=>{const _0x16c78c=_0x22702e;if(!_0x3e5b40)return![];const _0x55de1a=await User_1[_0x16c78c(0x8c)][_0x16c78c(0xa9)]({'where':{'email':_0x3e5b40}});return!_0x55de1a;}),'password':Yup['string']()['required']()[_0x22702e(0xab)](0x5)});try{await _0x563bd3['validate']({'email':_0x402e5e,'password':_0x197b21,'name':_0x4012db});}catch(_0x539297){throw new AppError_1[(_0x22702e(0x8c))](_0x539297['message']);}const _0x374860=await User_1[_0x22702e(0x8c)]['create']({'email':_0x402e5e,'password':_0x197b21,'name':_0x4012db,'companyId':_0x42c02f,'profile':profile},{'include':[_0x22702e(0x9f),_0x22702e(0x91)]});await _0x374860['$set']('queues',queueIds),await _0x374860['reload']();const _0x2ecc09=(0x0,SerializeUser_1['SerializeUser'])(_0x374860);return _0x2ecc09;};exports['default']=CreateUserService;function a557_0x288b(){const _0x444b8a=['configurable','queues','users','(((.+)+)+)+$','yup','count','__importDefault','__createBinding','75383CJyEHy','6iFLxHj','__setModuleDefault','findOne','6199812tujhVr','min','6981120bNOosD','create','length','__esModule','email','../../helpers/SerializeUser','shape','plan','../../models/Plan','1109094vJUIss','getOwnPropertyDescriptor','1720EAxuzp','628110vtMmiD','toString','Check-email','__importStar','default','Número\x20máximo\x20de\x20usuários\x20já\x20alcançado:\x20','prototype','object','search','company','constructor','defineProperty','108282DmpbDg','string','get','111325ThHLSO','apply','124TqAuuu','24jerQmi','required','../../models/User','hasOwnProperty'];a557_0x288b=function(){return _0x444b8a;};return a557_0x288b();}