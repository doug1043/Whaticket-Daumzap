'use strict';const a675_0x212e7e=a675_0x4dfc;function a675_0x4dfc(_0x374843,_0x3a5bef){const _0x41feda=a675_0x734a();return a675_0x4dfc=function(_0x5c6692,_0x37de8b){_0x5c6692=_0x5c6692-0x64;let _0x734acd=_0x41feda[_0x5c6692];return _0x734acd;},a675_0x4dfc(_0x374843,_0x3a5bef);}(function(_0x46e9b2,_0x15b693){const _0x57dcf7=a675_0x4dfc,_0xeec6e=_0x46e9b2();while(!![]){try{const _0x1f2a1a=-parseInt(_0x57dcf7(0x85))/0x1+-parseInt(_0x57dcf7(0x66))/0x2*(-parseInt(_0x57dcf7(0x6e))/0x3)+-parseInt(_0x57dcf7(0x65))/0x4*(parseInt(_0x57dcf7(0x86))/0x5)+parseInt(_0x57dcf7(0x81))/0x6+-parseInt(_0x57dcf7(0x96))/0x7+parseInt(_0x57dcf7(0x6c))/0x8*(-parseInt(_0x57dcf7(0x76))/0x9)+parseInt(_0x57dcf7(0x82))/0xa;if(_0x1f2a1a===_0x15b693)break;else _0xeec6e['push'](_0xeec6e['shift']());}catch(_0x4f6a14){_0xeec6e['push'](_0xeec6e['shift']());}}}(a675_0x734a,0x64596));function a675_0x734a(){const _0x253e2a=['reload','open','../../models/Company','string','create','9vtgjQE','disabled','validate','../../models/Plan','yup','prototype','../../errors/AppError','$set','toString','admin','count','3862956DDfhbD','14681070IOuoTk','message','constructor','207488vOEQom','25gOJjtX','length','An\x20user\x20with\x20this\x20email\x20already\x20exists.','queues','company','Check-email','getOwnPropertyNames','__setModuleDefault','plan','enabled','min','default','get','email','getOwnPropertyDescriptor','object','3055213MIbuLo','__importStar','required','configurable','(((.+)+)+)+$','385068oEIBNc','362BpOtkW','search','__importDefault','__createBinding','defineProperty','hasOwnProperty','5919752PBYPQw','__esModule','2724fOZLNi','apply','users'];a675_0x734a=function(){return _0x253e2a;};return a675_0x734a();}var __createBinding=this&&this[a675_0x212e7e(0x69)]||(Object[a675_0x212e7e(0x75)]?function(_0x5b78f8,_0x607bbd,_0x58c407,_0x11af4d){const _0x55a4a8=a675_0x212e7e;if(_0x11af4d===undefined)_0x11af4d=_0x58c407;var _0x28e1ad=Object[_0x55a4a8(0x94)](_0x607bbd,_0x58c407);(!_0x28e1ad||(_0x55a4a8(0x92)in _0x28e1ad?!_0x607bbd[_0x55a4a8(0x6d)]:_0x28e1ad['writable']||_0x28e1ad[_0x55a4a8(0x99)]))&&(_0x28e1ad={'enumerable':!![],'get':function(){return _0x607bbd[_0x58c407];}}),Object['defineProperty'](_0x5b78f8,_0x11af4d,_0x28e1ad);}:function(_0x2d9cea,_0xf885ad,_0x261747,_0x1c0d59){if(_0x1c0d59===undefined)_0x1c0d59=_0x261747;_0x2d9cea[_0x1c0d59]=_0xf885ad[_0x261747];}),__setModuleDefault=this&&this[a675_0x212e7e(0x8d)]||(Object[a675_0x212e7e(0x75)]?function(_0x43b068,_0x3e9d02){const _0x47ddd7=a675_0x212e7e;Object[_0x47ddd7(0x6a)](_0x43b068,'default',{'enumerable':!![],'value':_0x3e9d02});}:function(_0x5fde14,_0x398171){const _0x9d3300=a675_0x212e7e;_0x5fde14[_0x9d3300(0x91)]=_0x398171;}),__importStar=this&&this[a675_0x212e7e(0x97)]||(function(){const _0x3ab195=(function(){let _0x499e7d=!![];return function(_0x22fbaf,_0x4e0dc3){const _0x970d26=_0x499e7d?function(){const _0x37a244=a675_0x4dfc;if(_0x4e0dc3){const _0x2289f0=_0x4e0dc3[_0x37a244(0x6f)](_0x22fbaf,arguments);return _0x4e0dc3=null,_0x2289f0;}}:function(){};return _0x499e7d=![],_0x970d26;};}()),_0xdbdccc=_0x3ab195(this,function(){const _0xddf4ea=a675_0x4dfc;return _0xdbdccc[_0xddf4ea(0x7e)]()[_0xddf4ea(0x67)]('(((.+)+)+)+$')[_0xddf4ea(0x7e)]()[_0xddf4ea(0x84)](_0xdbdccc)[_0xddf4ea(0x67)](_0xddf4ea(0x64));});_0xdbdccc();var _0xb7a94d=function(_0x44f5c9){const _0x4fe9a4=a675_0x4dfc;return _0xb7a94d=Object[_0x4fe9a4(0x8c)]||function(_0x5be704){const _0x166d26=_0x4fe9a4;var _0x3f8443=[];for(var _0x5496dc in _0x5be704)if(Object[_0x166d26(0x7b)][_0x166d26(0x6b)]['call'](_0x5be704,_0x5496dc))_0x3f8443[_0x3f8443[_0x166d26(0x87)]]=_0x5496dc;return _0x3f8443;},_0xb7a94d(_0x44f5c9);};return function(_0x5d8dc0){if(_0x5d8dc0&&_0x5d8dc0['__esModule'])return _0x5d8dc0;var _0x419644={};if(_0x5d8dc0!=null){for(var _0xfbbf92=_0xb7a94d(_0x5d8dc0),_0x520bf3=0x0;_0x520bf3<_0xfbbf92['length'];_0x520bf3++)if(_0xfbbf92[_0x520bf3]!=='default')__createBinding(_0x419644,_0x5d8dc0,_0xfbbf92[_0x520bf3]);}return __setModuleDefault(_0x419644,_0x5d8dc0),_0x419644;};}()),__importDefault=this&&this[a675_0x212e7e(0x68)]||function(_0x377b28){return _0x377b28&&_0x377b28['__esModule']?_0x377b28:{'default':_0x377b28};};Object[a675_0x212e7e(0x6a)](exports,'__esModule',{'value':!![]});const Yup=__importStar(require(a675_0x212e7e(0x7a))),AppError_1=__importDefault(require(a675_0x212e7e(0x7c))),SerializeUser_1=require('../../helpers/SerializeUser'),User_1=__importDefault(require('../../models/User')),Plan_1=__importDefault(require(a675_0x212e7e(0x79))),Company_1=__importDefault(require(a675_0x212e7e(0x73))),CreateUserService=async({email:_0x16cd69,password:_0x2348c4,name:_0x1d40c2,queueIds:queueIds=[],companyId:_0x147077,profile:profile=a675_0x212e7e(0x7f),isTricked:isTricked=a675_0x212e7e(0x8f),spy:spy=a675_0x212e7e(0x77),allTicket:allTicket=a675_0x212e7e(0x77),whatsappId:_0x52d19f,startWork:_0x3723e5,endWork:_0x5ebc8b,allowedWeekDays:_0x391acd,defaultMenu:defaultMenu=a675_0x212e7e(0x72)})=>{const _0x2d9acc=a675_0x212e7e;if(_0x147077!==undefined){const _0x5c4b01=await Company_1[_0x2d9acc(0x91)]['findOne']({'where':{'id':_0x147077},'include':[{'model':Plan_1[_0x2d9acc(0x91)],'as':_0x2d9acc(0x8e)}]});if(_0x5c4b01!==null){const _0x38dfff=await User_1[_0x2d9acc(0x91)][_0x2d9acc(0x80)]({'where':{'companyId':_0x147077}});if(_0x38dfff>=_0x5c4b01['plan'][_0x2d9acc(0x70)])throw new AppError_1['default']('Número\x20máximo\x20de\x20usuários\x20já\x20alcançado:\x20'+_0x38dfff);}}const _0xd18bd1=Yup[_0x2d9acc(0x95)]()['shape']({'name':Yup[_0x2d9acc(0x74)]()['required']()[_0x2d9acc(0x90)](0x2),'email':Yup[_0x2d9acc(0x74)]()[_0x2d9acc(0x93)]()[_0x2d9acc(0x98)]()['test'](_0x2d9acc(0x8b),_0x2d9acc(0x88),async _0x1615e0=>{const _0x1ebea6=_0x2d9acc;if(!_0x1615e0)return![];const _0x170057=await User_1[_0x1ebea6(0x91)]['findOne']({'where':{'email':_0x1615e0}});return!_0x170057;}),'password':Yup['string']()['required']()[_0x2d9acc(0x90)](0x5)});try{await _0xd18bd1[_0x2d9acc(0x78)]({'email':_0x16cd69,'password':_0x2348c4,'name':_0x1d40c2});}catch(_0x5c4666){throw new AppError_1[(_0x2d9acc(0x91))](_0x5c4666[_0x2d9acc(0x83)]);}const _0x393492=await User_1['default'][_0x2d9acc(0x75)]({'email':_0x16cd69,'password':_0x2348c4,'name':_0x1d40c2,'companyId':_0x147077,'profile':profile,'isTricked':isTricked,'spy':spy,'allTicket':allTicket,'whatsappId':_0x52d19f,'startWork':_0x3723e5,'endWork':_0x5ebc8b,'allowedWeekDays':_0x391acd,'defaultMenu':defaultMenu},{'include':[_0x2d9acc(0x89),_0x2d9acc(0x8a)]});await _0x393492[_0x2d9acc(0x7d)](_0x2d9acc(0x89),queueIds),await _0x393492[_0x2d9acc(0x71)]();const _0x1429cf=(0x0,SerializeUser_1['SerializeUser'])(_0x393492);return _0x1429cf;};exports[a675_0x212e7e(0x91)]=CreateUserService;