'use strict';function a562_0x1e6f(_0x2bcf67,_0x12eb03){const _0x5ef463=a562_0x3bb6();return a562_0x1e6f=function(_0x526437,_0x299707){_0x526437=_0x526437-0x19c;let _0x3bb662=_0x5ef463[_0x526437];return _0x3bb662;},a562_0x1e6f(_0x2bcf67,_0x12eb03);}const a562_0x4934bd=a562_0x1e6f;(function(_0x13cf31,_0x4d1b52){const _0x1b3acb=a562_0x1e6f,_0x493f45=_0x13cf31();while(!![]){try{const _0x177e00=-parseInt(_0x1b3acb(0x1ad))/0x1*(-parseInt(_0x1b3acb(0x1c6))/0x2)+parseInt(_0x1b3acb(0x1b6))/0x3+-parseInt(_0x1b3acb(0x1ba))/0x4+-parseInt(_0x1b3acb(0x1a0))/0x5+-parseInt(_0x1b3acb(0x1bf))/0x6+-parseInt(_0x1b3acb(0x1c8))/0x7+parseInt(_0x1b3acb(0x1b4))/0x8;if(_0x177e00===_0x4d1b52)break;else _0x493f45['push'](_0x493f45['shift']());}catch(_0x584f5b){_0x493f45['push'](_0x493f45['shift']());}}}(a562_0x3bb6,0x45cf7));var __createBinding=this&&this[a562_0x4934bd(0x1bd)]||(Object[a562_0x4934bd(0x1c7)]?function(_0x4cc3a9,_0x50c624,_0x277a87,_0x1e8716){const _0x4425d3=a562_0x4934bd;if(_0x1e8716===undefined)_0x1e8716=_0x277a87;var _0x5d6684=Object[_0x4425d3(0x1b9)](_0x50c624,_0x277a87);(!_0x5d6684||(_0x4425d3(0x1be)in _0x5d6684?!_0x50c624[_0x4425d3(0x19f)]:_0x5d6684['writable']||_0x5d6684['configurable']))&&(_0x5d6684={'enumerable':!![],'get':function(){return _0x50c624[_0x277a87];}}),Object[_0x4425d3(0x19e)](_0x4cc3a9,_0x1e8716,_0x5d6684);}:function(_0x1ca75c,_0x275789,_0x483125,_0x3a2edb){if(_0x3a2edb===undefined)_0x3a2edb=_0x483125;_0x1ca75c[_0x3a2edb]=_0x275789[_0x483125];}),__setModuleDefault=this&&this['__setModuleDefault']||(Object[a562_0x4934bd(0x1c7)]?function(_0x23e957,_0x5e4e38){Object['defineProperty'](_0x23e957,'default',{'enumerable':!![],'value':_0x5e4e38});}:function(_0x4b22c3,_0x25675c){_0x4b22c3['default']=_0x25675c;}),__importStar=this&&this[a562_0x4934bd(0x1c4)]||(function(){const _0x5ba325=(function(){let _0x4a353d=!![];return function(_0xdd5807,_0x503b47){const _0x134f63=_0x4a353d?function(){if(_0x503b47){const _0x23e4a9=_0x503b47['apply'](_0xdd5807,arguments);return _0x503b47=null,_0x23e4a9;}}:function(){};return _0x4a353d=![],_0x134f63;};}()),_0x34c220=_0x5ba325(this,function(){const _0x225cc6=a562_0x1e6f;return _0x34c220[_0x225cc6(0x1c0)]()[_0x225cc6(0x1b0)](_0x225cc6(0x1bc))[_0x225cc6(0x1c0)]()[_0x225cc6(0x1a5)](_0x34c220)[_0x225cc6(0x1b0)](_0x225cc6(0x1bc));});_0x34c220();var _0x526d46=function(_0x59c227){const _0x509274=a562_0x1e6f;return _0x526d46=Object[_0x509274(0x1b7)]||function(_0x12f6a3){const _0x10de01=_0x509274;var _0x27c387=[];for(var _0x450c5e in _0x12f6a3)if(Object[_0x10de01(0x1c5)][_0x10de01(0x1b2)][_0x10de01(0x1a8)](_0x12f6a3,_0x450c5e))_0x27c387[_0x27c387[_0x10de01(0x1ae)]]=_0x450c5e;return _0x27c387;},_0x526d46(_0x59c227);};return function(_0x16d293){const _0x1b9c7a=a562_0x1e6f;if(_0x16d293&&_0x16d293[_0x1b9c7a(0x19f)])return _0x16d293;var _0x304508={};if(_0x16d293!=null){for(var _0x2360ec=_0x526d46(_0x16d293),_0x3c85d0=0x0;_0x3c85d0<_0x2360ec['length'];_0x3c85d0++)if(_0x2360ec[_0x3c85d0]!==_0x1b9c7a(0x1cb))__createBinding(_0x304508,_0x16d293,_0x2360ec[_0x3c85d0]);}return __setModuleDefault(_0x304508,_0x16d293),_0x304508;};}()),__importDefault=this&&this[a562_0x4934bd(0x1a2)]||function(_0xc1560a){const _0x19d080=a562_0x4934bd;return _0xc1560a&&_0xc1560a[_0x19d080(0x19f)]?_0xc1560a:{'default':_0xc1560a};};function a562_0x3bb6(){const _0x107c2a=['plan','__importStar','prototype','6ofzOFS','create','2013403ELrPcb','email','string','default','admin','An\x20user\x20with\x20this\x20email\x20already\x20exists.','../../models/User','defineProperty','__esModule','373650wwCgrD','Número\x20máximo\x20de\x20usuários\x20já\x20alcançado:\x20','__importDefault','required','min','constructor','../../errors/AppError','../../models/Plan','call','$set','reload','Check-email','message','181003XddqYL','length','../../models/Company','search','count','hasOwnProperty','SerializeUser','2504256ZSURQe','findOne','1093131TIclkn','getOwnPropertyNames','yup','getOwnPropertyDescriptor','1717744NjTpva','../../helpers/SerializeUser','(((.+)+)+)+$','__createBinding','get','856080JztFMk','toString','company','object'];a562_0x3bb6=function(){return _0x107c2a;};return a562_0x3bb6();}Object[a562_0x4934bd(0x19e)](exports,a562_0x4934bd(0x19f),{'value':!![]});const Yup=__importStar(require(a562_0x4934bd(0x1b8))),AppError_1=__importDefault(require(a562_0x4934bd(0x1a6))),SerializeUser_1=require(a562_0x4934bd(0x1bb)),User_1=__importDefault(require(a562_0x4934bd(0x19d))),Plan_1=__importDefault(require(a562_0x4934bd(0x1a7))),Company_1=__importDefault(require(a562_0x4934bd(0x1af))),CreateUserService=async({email:_0xbc12bf,password:_0x50c6fa,name:_0x2b03f2,queueIds:queueIds=[],companyId:_0x32bedb,profile:profile=a562_0x4934bd(0x1cc)})=>{const _0x311176=a562_0x4934bd;if(_0x32bedb!==undefined){const _0x58659c=await Company_1[_0x311176(0x1cb)][_0x311176(0x1b5)]({'where':{'id':_0x32bedb},'include':[{'model':Plan_1['default'],'as':_0x311176(0x1c3)}]});if(_0x58659c!==null){const _0xa3e62c=await User_1[_0x311176(0x1cb)][_0x311176(0x1b1)]({'where':{'companyId':_0x32bedb}});if(_0xa3e62c>=_0x58659c[_0x311176(0x1c3)]['users'])throw new AppError_1[(_0x311176(0x1cb))](_0x311176(0x1a1)+_0xa3e62c);}}const _0x39e64c=Yup[_0x311176(0x1c2)]()['shape']({'name':Yup[_0x311176(0x1ca)]()[_0x311176(0x1a3)]()[_0x311176(0x1a4)](0x2),'email':Yup[_0x311176(0x1ca)]()[_0x311176(0x1c9)]()[_0x311176(0x1a3)]()['test'](_0x311176(0x1ab),_0x311176(0x19c),async _0x22b859=>{const _0x7d28bb=_0x311176;if(!_0x22b859)return![];const _0x41eefb=await User_1['default'][_0x7d28bb(0x1b5)]({'where':{'email':_0x22b859}});return!_0x41eefb;}),'password':Yup[_0x311176(0x1ca)]()['required']()[_0x311176(0x1a4)](0x5)});try{await _0x39e64c['validate']({'email':_0xbc12bf,'password':_0x50c6fa,'name':_0x2b03f2});}catch(_0xde07f){throw new AppError_1[(_0x311176(0x1cb))](_0xde07f[_0x311176(0x1ac)]);}const _0x6a57e=await User_1['default'][_0x311176(0x1c7)]({'email':_0xbc12bf,'password':_0x50c6fa,'name':_0x2b03f2,'companyId':_0x32bedb,'profile':profile},{'include':['queues',_0x311176(0x1c1)]});await _0x6a57e[_0x311176(0x1a9)]('queues',queueIds),await _0x6a57e[_0x311176(0x1aa)]();const _0x4d80ac=(0x0,SerializeUser_1[_0x311176(0x1b3)])(_0x6a57e);return _0x4d80ac;};exports[a562_0x4934bd(0x1cb)]=CreateUserService;