function a533_0x2ffb(_0x5a29de,_0x1d9e21){const _0x5bdf12=a533_0x5cb3();return a533_0x2ffb=function(_0x53c4d8,_0x9a7f6a){_0x53c4d8=_0x53c4d8-0x65;let _0x5cb302=_0x5bdf12[_0x53c4d8];return _0x5cb302;},a533_0x2ffb(_0x5a29de,_0x1d9e21);}const a533_0x4ada89=a533_0x2ffb;(function(_0x38f9e4,_0x3dd15b){const _0x163c09=a533_0x2ffb,_0x1971c6=_0x38f9e4();while(!![]){try{const _0x3d772d=-parseInt(_0x163c09(0x76))/0x1+-parseInt(_0x163c09(0x81))/0x2+-parseInt(_0x163c09(0x83))/0x3*(-parseInt(_0x163c09(0x71))/0x4)+-parseInt(_0x163c09(0x6c))/0x5+parseInt(_0x163c09(0x68))/0x6+-parseInt(_0x163c09(0x7f))/0x7+parseInt(_0x163c09(0x8e))/0x8;if(_0x3d772d===_0x3dd15b)break;else _0x1971c6['push'](_0x1971c6['shift']());}catch(_0x3f16ef){_0x1971c6['push'](_0x1971c6['shift']());}}}(a533_0x5cb3,0x55baa));const a533_0x9a7f6a=(function(){let _0x384b1a=!![];return function(_0x5fad50,_0x57c493){const _0x3bce9f=_0x384b1a?function(){if(_0x57c493){const _0x5d193b=_0x57c493['apply'](_0x5fad50,arguments);return _0x57c493=null,_0x5d193b;}}:function(){};return _0x384b1a=![],_0x3bce9f;};}()),a533_0x53c4d8=a533_0x9a7f6a(this,function(){const _0x4412a4=a533_0x2ffb;return a533_0x53c4d8['toString']()[_0x4412a4(0x7e)](_0x4412a4(0x88))['toString']()[_0x4412a4(0x6f)](a533_0x53c4d8)['search'](_0x4412a4(0x88));});a533_0x53c4d8();'use strict';var __createBinding=this&&this[a533_0x4ada89(0x7a)]||(Object[a533_0x4ada89(0x67)]?function(_0xd6010b,_0x2cf437,_0x3d351e,_0x227822){const _0x49d612=a533_0x4ada89;if(_0x227822===undefined)_0x227822=_0x3d351e;var _0x95d5d5=Object[_0x49d612(0x7c)](_0x2cf437,_0x3d351e);(!_0x95d5d5||('get'in _0x95d5d5?!_0x2cf437[_0x49d612(0x66)]:_0x95d5d5[_0x49d612(0x77)]||_0x95d5d5['configurable']))&&(_0x95d5d5={'enumerable':!![],'get':function(){return _0x2cf437[_0x3d351e];}}),Object[_0x49d612(0x6b)](_0xd6010b,_0x227822,_0x95d5d5);}:function(_0x3e5e5f,_0x349ef8,_0x4e32c8,_0x5c19bb){if(_0x5c19bb===undefined)_0x5c19bb=_0x4e32c8;_0x3e5e5f[_0x5c19bb]=_0x349ef8[_0x4e32c8];}),__setModuleDefault=this&&this['__setModuleDefault']||(Object[a533_0x4ada89(0x67)]?function(_0x4bf091,_0x37c6ab){const _0x507b75=a533_0x4ada89;Object[_0x507b75(0x6b)](_0x4bf091,_0x507b75(0x73),{'enumerable':!![],'value':_0x37c6ab});}:function(_0x25a703,_0x34a751){const _0x74fd1e=a533_0x4ada89;_0x25a703[_0x74fd1e(0x73)]=_0x34a751;}),__importStar=this&&this[a533_0x4ada89(0x8d)]||function(_0x2ca358){const _0x29ae85=a533_0x4ada89;if(_0x2ca358&&_0x2ca358[_0x29ae85(0x66)])return _0x2ca358;var _0x5a2f89={};if(_0x2ca358!=null){for(var _0x2efe2b in _0x2ca358)if(_0x2efe2b!=='default'&&Object['prototype'][_0x29ae85(0x87)][_0x29ae85(0x78)](_0x2ca358,_0x2efe2b))__createBinding(_0x5a2f89,_0x2ca358,_0x2efe2b);}return __setModuleDefault(_0x5a2f89,_0x2ca358),_0x5a2f89;},__importDefault=this&&this[a533_0x4ada89(0x6d)]||function(_0x4134f4){const _0x47eda6=a533_0x4ada89;return _0x4134f4&&_0x4134f4[_0x47eda6(0x66)]?_0x4134f4:{'default':_0x4134f4};};Object[a533_0x4ada89(0x6b)](exports,'__esModule',{'value':!![]});function a533_0x5cb3(){const _0xaba873=['defineProperty','2067820KLJBiQ','__importDefault','string','constructor','Número\x20máximo\x20de\x20usuários\x20já\x20alcançado:\x20','4izSpDN','queues','default','shape','findOne','651985hMNayr','writable','call','count','__createBinding','users','getOwnPropertyDescriptor','Company\x20not\x20found','search','2634226uliwsO','length','321400LyxSOQ','object','1070268hRCOVd','min','Check-email','reload','hasOwnProperty','(((.+)+)+)+$','required','email','$set','plan','__importStar','10532480YkLeEc','boolean','yup','__esModule','create','1682382BgKgRq','test','../../models/Company'];a533_0x5cb3=function(){return _0xaba873;};return a533_0x5cb3();}const Yup=__importStar(require(a533_0x4ada89(0x65))),AppError_1=__importDefault(require('../../errors/AppError')),SerializeUser_1=require('../../helpers/SerializeUser'),User_1=__importDefault(require('../../models/User')),Plan_1=__importDefault(require('../../models/Plan')),Company_1=__importDefault(require(a533_0x4ada89(0x6a))),CreateUserService=async({email:_0x4e66e5,password:_0x4890ea,name:_0x983eda,queueIds:queueIds=[],companyId:_0x173895,profile:profile='admin',allTicket:_0x229d32,spy:_0x46ed06,whatsappId:_0x2c7111,startWork:_0x46c45a,endWork:_0x2dc5cf,isTricked:_0x3f0320,super:_0x5391ff,defaultMenu:_0x62d498})=>{const _0x1c28fa=a533_0x4ada89;if(_0x173895!==undefined){const _0x2daa33=await Company_1[_0x1c28fa(0x73)][_0x1c28fa(0x75)]({'where':{'id':_0x173895},'include':[{'model':Plan_1[_0x1c28fa(0x73)],'as':'plan'}]});if(_0x2daa33){const _0x102c88=await User_1[_0x1c28fa(0x73)][_0x1c28fa(0x79)]({'where':{'companyId':_0x173895}});if(_0x102c88>=_0x2daa33[_0x1c28fa(0x8c)][_0x1c28fa(0x7b)])throw new AppError_1[(_0x1c28fa(0x73))](_0x1c28fa(0x70)+_0x102c88,0x190);}else throw new AppError_1[(_0x1c28fa(0x73))](_0x1c28fa(0x7d),0x194);}const _0x5883ed=Yup[_0x1c28fa(0x82)]()[_0x1c28fa(0x74)]({'name':Yup[_0x1c28fa(0x6e)]()[_0x1c28fa(0x89)]()[_0x1c28fa(0x84)](0x2),'email':Yup[_0x1c28fa(0x6e)]()[_0x1c28fa(0x8a)]()['required']()[_0x1c28fa(0x69)](_0x1c28fa(0x85),'An\x20user\x20with\x20this\x20email\x20already\x20exists.',async _0x4f4878=>{const _0x1c8ce9=_0x1c28fa;if(!_0x4f4878)return![];const _0x200d03=await User_1[_0x1c8ce9(0x73)][_0x1c8ce9(0x75)]({'where':{'email':_0x4f4878}});return!_0x200d03;}),'password':Yup[_0x1c28fa(0x6e)]()[_0x1c28fa(0x89)]()[_0x1c28fa(0x84)](0x5),'super':Yup[_0x1c28fa(0x8f)]()['required']()});try{await _0x5883ed['validate']({'email':_0x4e66e5,'password':_0x4890ea,'name':_0x983eda,'super':_0x5391ff});}catch(_0x706f0b){throw new AppError_1['default'](_0x706f0b['message'],0x190);}const _0x39f35d=await User_1[_0x1c28fa(0x73)][_0x1c28fa(0x67)]({'email':_0x4e66e5,'password':_0x4890ea,'name':_0x983eda,'companyId':_0x173895,'profile':profile,'allTicket':_0x229d32,'whatsappId':_0x2c7111||null,'startWork':_0x46c45a,'endWork':_0x2dc5cf,'spy':_0x46ed06,'isTricked':_0x3f0320,'super':_0x5391ff,'defaultMenu':_0x62d498});queueIds[_0x1c28fa(0x80)]>0x0&&await _0x39f35d[_0x1c28fa(0x8b)](_0x1c28fa(0x72),queueIds);await _0x39f35d[_0x1c28fa(0x86)]();const _0x32c3ef=await(0x0,SerializeUser_1['SerializeUser'])(_0x39f35d);return _0x32c3ef;};exports['default']=CreateUserService;