'use strict';const a563_0x287e8e=a563_0x576f;(function(_0x58640d,_0x416765){const _0x771c95=a563_0x576f,_0x2e2ccc=_0x58640d();while(!![]){try{const _0x45e6c2=parseInt(_0x771c95(0x14e))/0x1*(-parseInt(_0x771c95(0x147))/0x2)+-parseInt(_0x771c95(0x12e))/0x3+parseInt(_0x771c95(0x146))/0x4*(parseInt(_0x771c95(0x12b))/0x5)+parseInt(_0x771c95(0x157))/0x6*(-parseInt(_0x771c95(0x134))/0x7)+parseInt(_0x771c95(0x14f))/0x8+parseInt(_0x771c95(0x158))/0x9+parseInt(_0x771c95(0x141))/0xa;if(_0x45e6c2===_0x416765)break;else _0x2e2ccc['push'](_0x2e2ccc['shift']());}catch(_0x320e0c){_0x2e2ccc['push'](_0x2e2ccc['shift']());}}}(a563_0x4959,0xe893b));function a563_0x4959(){const _0x2928e9=['default','Check-email','create','shape','__importStar','getOwnPropertyNames','toString','prototype','admin','../../helpers/SerializeUser','__esModule','string','3979990WOVEtJ','defineProperty','configurable','length','__importDefault','1396MdXnnP','10BmGzVG','constructor','Número\x20máximo\x20de\x20usuários\x20já\x20alcançado:\x20','apply','object','../../models/Plan','search','360897jWBBMY','7952384sESivD','validate','plan','$set','queues','company','count','(((.+)+)+)+$','1022610FBJNXi','12010392MzTRFu','call','../../models/Company','users','get','../../models/User','reload','test','18335vkrHbH','min','findOne','2724984bKcCql','required','email','../../errors/AppError','__setModuleDefault','writable','14WvvUqZ'];a563_0x4959=function(){return _0x2928e9;};return a563_0x4959();}function a563_0x576f(_0x30c683,_0x4ebc21){const _0xf1ab35=a563_0x4959();return a563_0x576f=function(_0xd35f04,_0x555f19){_0xd35f04=_0xd35f04-0x12b;let _0x49597a=_0xf1ab35[_0xd35f04];return _0x49597a;},a563_0x576f(_0x30c683,_0x4ebc21);}var __createBinding=this&&this['__createBinding']||(Object[a563_0x287e8e(0x137)]?function(_0x545088,_0x1b94f0,_0x4c079a,_0x24f487){const _0x4b3d62=a563_0x287e8e;if(_0x24f487===undefined)_0x24f487=_0x4c079a;var _0x19a6e0=Object['getOwnPropertyDescriptor'](_0x1b94f0,_0x4c079a);(!_0x19a6e0||(_0x4b3d62(0x15c)in _0x19a6e0?!_0x1b94f0['__esModule']:_0x19a6e0[_0x4b3d62(0x133)]||_0x19a6e0[_0x4b3d62(0x143)]))&&(_0x19a6e0={'enumerable':!![],'get':function(){return _0x1b94f0[_0x4c079a];}}),Object[_0x4b3d62(0x142)](_0x545088,_0x24f487,_0x19a6e0);}:function(_0x1eca4c,_0x50c6f3,_0x59933e,_0x1078b1){if(_0x1078b1===undefined)_0x1078b1=_0x59933e;_0x1eca4c[_0x1078b1]=_0x50c6f3[_0x59933e];}),__setModuleDefault=this&&this[a563_0x287e8e(0x132)]||(Object[a563_0x287e8e(0x137)]?function(_0x3b25e0,_0x254949){const _0x593410=a563_0x287e8e;Object['defineProperty'](_0x3b25e0,_0x593410(0x135),{'enumerable':!![],'value':_0x254949});}:function(_0x340fc3,_0x11d385){const _0x41e92b=a563_0x287e8e;_0x340fc3[_0x41e92b(0x135)]=_0x11d385;}),__importStar=this&&this[a563_0x287e8e(0x139)]||(function(){const _0x231886=(function(){let _0x84d683=!![];return function(_0x31b3ad,_0x4e9635){const _0x40d546=_0x84d683?function(){const _0x4ca265=a563_0x576f;if(_0x4e9635){const _0xbb4d64=_0x4e9635[_0x4ca265(0x14a)](_0x31b3ad,arguments);return _0x4e9635=null,_0xbb4d64;}}:function(){};return _0x84d683=![],_0x40d546;};}()),_0x16d32f=_0x231886(this,function(){const _0x5d61ec=a563_0x576f;return _0x16d32f[_0x5d61ec(0x13b)]()['search'](_0x5d61ec(0x156))[_0x5d61ec(0x13b)]()[_0x5d61ec(0x148)](_0x16d32f)[_0x5d61ec(0x14d)](_0x5d61ec(0x156));});_0x16d32f();var _0x5000b4=function(_0x9bbb9){const _0x1e29d1=a563_0x576f;return _0x5000b4=Object[_0x1e29d1(0x13a)]||function(_0x421bdd){const _0x173020=_0x1e29d1;var _0x5b3c5f=[];for(var _0x1f8872 in _0x421bdd)if(Object[_0x173020(0x13c)]['hasOwnProperty'][_0x173020(0x159)](_0x421bdd,_0x1f8872))_0x5b3c5f[_0x5b3c5f[_0x173020(0x144)]]=_0x1f8872;return _0x5b3c5f;},_0x5000b4(_0x9bbb9);};return function(_0x34a570){const _0x5c77fc=a563_0x576f;if(_0x34a570&&_0x34a570[_0x5c77fc(0x13f)])return _0x34a570;var _0x361e45={};if(_0x34a570!=null){for(var _0x4ea7cf=_0x5000b4(_0x34a570),_0x4fa5b9=0x0;_0x4fa5b9<_0x4ea7cf[_0x5c77fc(0x144)];_0x4fa5b9++)if(_0x4ea7cf[_0x4fa5b9]!==_0x5c77fc(0x135))__createBinding(_0x361e45,_0x34a570,_0x4ea7cf[_0x4fa5b9]);}return __setModuleDefault(_0x361e45,_0x34a570),_0x361e45;};}()),__importDefault=this&&this[a563_0x287e8e(0x145)]||function(_0x1a3504){const _0x35dec0=a563_0x287e8e;return _0x1a3504&&_0x1a3504[_0x35dec0(0x13f)]?_0x1a3504:{'default':_0x1a3504};};Object[a563_0x287e8e(0x142)](exports,a563_0x287e8e(0x13f),{'value':!![]});const Yup=__importStar(require('yup')),AppError_1=__importDefault(require(a563_0x287e8e(0x131))),SerializeUser_1=require(a563_0x287e8e(0x13e)),User_1=__importDefault(require(a563_0x287e8e(0x15d))),Plan_1=__importDefault(require(a563_0x287e8e(0x14c))),Company_1=__importDefault(require(a563_0x287e8e(0x15a))),CreateUserService=async({email:_0x345286,password:_0x35e593,name:_0x2f1b30,queueIds:queueIds=[],companyId:_0x3ff165,profile:profile=a563_0x287e8e(0x13d)})=>{const _0x1e04bc=a563_0x287e8e;if(_0x3ff165!==undefined){const _0x5a1aac=await Company_1[_0x1e04bc(0x135)][_0x1e04bc(0x12d)]({'where':{'id':_0x3ff165},'include':[{'model':Plan_1[_0x1e04bc(0x135)],'as':_0x1e04bc(0x151)}]});if(_0x5a1aac!==null){const _0xa9fd58=await User_1[_0x1e04bc(0x135)][_0x1e04bc(0x155)]({'where':{'companyId':_0x3ff165}});if(_0xa9fd58>=_0x5a1aac['plan'][_0x1e04bc(0x15b)])throw new AppError_1['default'](_0x1e04bc(0x149)+_0xa9fd58);}}const _0x27539f=Yup[_0x1e04bc(0x14b)]()[_0x1e04bc(0x138)]({'name':Yup[_0x1e04bc(0x140)]()[_0x1e04bc(0x12f)]()[_0x1e04bc(0x12c)](0x2),'email':Yup[_0x1e04bc(0x140)]()[_0x1e04bc(0x130)]()[_0x1e04bc(0x12f)]()[_0x1e04bc(0x15f)](_0x1e04bc(0x136),'An\x20user\x20with\x20this\x20email\x20already\x20exists.',async _0x22e08b=>{const _0x79ee49=_0x1e04bc;if(!_0x22e08b)return![];const _0x5e133a=await User_1[_0x79ee49(0x135)][_0x79ee49(0x12d)]({'where':{'email':_0x22e08b}});return!_0x5e133a;}),'password':Yup[_0x1e04bc(0x140)]()[_0x1e04bc(0x12f)]()[_0x1e04bc(0x12c)](0x5)});try{await _0x27539f[_0x1e04bc(0x150)]({'email':_0x345286,'password':_0x35e593,'name':_0x2f1b30});}catch(_0x4ce3c1){throw new AppError_1['default'](_0x4ce3c1['message']);}const _0x6ed582=await User_1[_0x1e04bc(0x135)][_0x1e04bc(0x137)]({'email':_0x345286,'password':_0x35e593,'name':_0x2f1b30,'companyId':_0x3ff165,'profile':profile},{'include':['queues',_0x1e04bc(0x154)]});await _0x6ed582[_0x1e04bc(0x152)](_0x1e04bc(0x153),queueIds),await _0x6ed582[_0x1e04bc(0x15e)]();const _0x6e951a=(0x0,SerializeUser_1['SerializeUser'])(_0x6ed582);return _0x6e951a;};exports[a563_0x287e8e(0x135)]=CreateUserService;