'use strict';function a561_0x3eeb(){const _0x30c962=['564855MqiRvY','../../helpers/SerializeUser','278673DvOhFO','10LxqZld','toString','create','prototype','(((.+)+)+)+$','default','getOwnPropertyNames','getOwnPropertyDescriptor','string','__setModuleDefault','SerializeUser','validate','test','search','queues','message','hasOwnProperty','6jULYRZ','537724zdsPrk','defineProperty','An\x20user\x20with\x20this\x20email\x20already\x20exists.','42446QeUoBZ','$set','__esModule','admin','plan','shape','findOne','../../models/Plan','567wMKIOg','object','min','required','5VzhtUH','length','constructor','apply','1122674ymNQtI','../../models/Company','writable','26960elyDqA','get','../../models/User','../../errors/AppError','reload','yup','4691181aiIzzy'];a561_0x3eeb=function(){return _0x30c962;};return a561_0x3eeb();}const a561_0x4bd639=a561_0x3164;(function(_0x3b19a6,_0x518b6d){const _0x180323=a561_0x3164,_0x2602ab=_0x3b19a6();while(!![]){try{const _0x49a934=-parseInt(_0x180323(0xae))/0x1+parseInt(_0x180323(0xc4))/0x2+parseInt(_0x180323(0xac))/0x3+-parseInt(_0x180323(0xc1))/0x4*(parseInt(_0x180323(0x9e))/0x5)+-parseInt(_0x180323(0xc0))/0x6*(-parseInt(_0x180323(0xa2))/0x7)+-parseInt(_0x180323(0xa5))/0x8*(parseInt(_0x180323(0x9a))/0x9)+-parseInt(_0x180323(0xaf))/0xa*(-parseInt(_0x180323(0xab))/0xb);if(_0x49a934===_0x518b6d)break;else _0x2602ab['push'](_0x2602ab['shift']());}catch(_0x29274e){_0x2602ab['push'](_0x2602ab['shift']());}}}(a561_0x3eeb,0x29bc3));function a561_0x3164(_0x45562e,_0x4202e9){const _0x56700c=a561_0x3eeb();return a561_0x3164=function(_0x35c8a2,_0x515abd){_0x35c8a2=_0x35c8a2-0x94;let _0x3eeb99=_0x56700c[_0x35c8a2];return _0x3eeb99;},a561_0x3164(_0x45562e,_0x4202e9);}var __createBinding=this&&this['__createBinding']||(Object[a561_0x4bd639(0xb1)]?function(_0x5b33ac,_0x15a41b,_0x42d93e,_0x5cc393){const _0x53c197=a561_0x4bd639;if(_0x5cc393===undefined)_0x5cc393=_0x42d93e;var _0x40ee01=Object[_0x53c197(0xb6)](_0x15a41b,_0x42d93e);(!_0x40ee01||(_0x53c197(0xa6)in _0x40ee01?!_0x15a41b[_0x53c197(0x94)]:_0x40ee01[_0x53c197(0xa4)]||_0x40ee01['configurable']))&&(_0x40ee01={'enumerable':!![],'get':function(){return _0x15a41b[_0x42d93e];}}),Object[_0x53c197(0xc2)](_0x5b33ac,_0x5cc393,_0x40ee01);}:function(_0x24c64a,_0x348267,_0x499c9b,_0x436c78){if(_0x436c78===undefined)_0x436c78=_0x499c9b;_0x24c64a[_0x436c78]=_0x348267[_0x499c9b];}),__setModuleDefault=this&&this[a561_0x4bd639(0xb8)]||(Object['create']?function(_0x26a44e,_0x3eb698){const _0x532680=a561_0x4bd639;Object[_0x532680(0xc2)](_0x26a44e,_0x532680(0xb4),{'enumerable':!![],'value':_0x3eb698});}:function(_0x55a024,_0x1b92f2){const _0x49530a=a561_0x4bd639;_0x55a024[_0x49530a(0xb4)]=_0x1b92f2;}),__importStar=this&&this['__importStar']||(function(){const _0x95dd13=(function(){let _0x3abb2d=!![];return function(_0x45690b,_0x14a2ce){const _0x4e0c83=_0x3abb2d?function(){const _0x3c35fb=a561_0x3164;if(_0x14a2ce){const _0x41c81b=_0x14a2ce[_0x3c35fb(0xa1)](_0x45690b,arguments);return _0x14a2ce=null,_0x41c81b;}}:function(){};return _0x3abb2d=![],_0x4e0c83;};}()),_0x28e4de=_0x95dd13(this,function(){const _0xca6351=a561_0x3164;return _0x28e4de['toString']()[_0xca6351(0xbc)](_0xca6351(0xb3))[_0xca6351(0xb0)]()[_0xca6351(0xa0)](_0x28e4de)[_0xca6351(0xbc)](_0xca6351(0xb3));});_0x28e4de();var _0x3b73be=function(_0x2c018e){const _0x5a14fe=a561_0x3164;return _0x3b73be=Object[_0x5a14fe(0xb5)]||function(_0x427f40){const _0x11ebe0=_0x5a14fe;var _0x33ee10=[];for(var _0x376f7c in _0x427f40)if(Object[_0x11ebe0(0xb2)][_0x11ebe0(0xbf)]['call'](_0x427f40,_0x376f7c))_0x33ee10[_0x33ee10[_0x11ebe0(0x9f)]]=_0x376f7c;return _0x33ee10;},_0x3b73be(_0x2c018e);};return function(_0x4935b4){const _0x446951=a561_0x3164;if(_0x4935b4&&_0x4935b4[_0x446951(0x94)])return _0x4935b4;var _0x215d3a={};if(_0x4935b4!=null){for(var _0x188ea7=_0x3b73be(_0x4935b4),_0x402ad1=0x0;_0x402ad1<_0x188ea7['length'];_0x402ad1++)if(_0x188ea7[_0x402ad1]!==_0x446951(0xb4))__createBinding(_0x215d3a,_0x4935b4,_0x188ea7[_0x402ad1]);}return __setModuleDefault(_0x215d3a,_0x4935b4),_0x215d3a;};}()),__importDefault=this&&this['__importDefault']||function(_0x130810){const _0x3607cc=a561_0x4bd639;return _0x130810&&_0x130810[_0x3607cc(0x94)]?_0x130810:{'default':_0x130810};};Object[a561_0x4bd639(0xc2)](exports,a561_0x4bd639(0x94),{'value':!![]});const Yup=__importStar(require(a561_0x4bd639(0xaa))),AppError_1=__importDefault(require(a561_0x4bd639(0xa8))),SerializeUser_1=require(a561_0x4bd639(0xad)),User_1=__importDefault(require(a561_0x4bd639(0xa7))),Plan_1=__importDefault(require(a561_0x4bd639(0x99))),Company_1=__importDefault(require(a561_0x4bd639(0xa3))),CreateUserService=async({email:_0x2576a0,password:_0x4ea703,name:_0x2188a4,queueIds:queueIds=[],companyId:_0xac5559,profile:profile=a561_0x4bd639(0x95)})=>{const _0x5bff17=a561_0x4bd639;if(_0xac5559!==undefined){const _0x96e017=await Company_1[_0x5bff17(0xb4)][_0x5bff17(0x98)]({'where':{'id':_0xac5559},'include':[{'model':Plan_1[_0x5bff17(0xb4)],'as':_0x5bff17(0x96)}]});if(_0x96e017!==null){const _0x3afa70=await User_1[_0x5bff17(0xb4)]['count']({'where':{'companyId':_0xac5559}});if(_0x3afa70>=_0x96e017[_0x5bff17(0x96)]['users'])throw new AppError_1[(_0x5bff17(0xb4))]('Número\x20máximo\x20de\x20usuários\x20já\x20alcançado:\x20'+_0x3afa70);}}const _0x47ae8d=Yup[_0x5bff17(0x9b)]()[_0x5bff17(0x97)]({'name':Yup['string']()[_0x5bff17(0x9d)]()[_0x5bff17(0x9c)](0x2),'email':Yup[_0x5bff17(0xb7)]()['email']()[_0x5bff17(0x9d)]()[_0x5bff17(0xbb)]('Check-email',_0x5bff17(0xc3),async _0x32ada8=>{const _0x28be00=_0x5bff17;if(!_0x32ada8)return![];const _0x4c4b1e=await User_1[_0x28be00(0xb4)][_0x28be00(0x98)]({'where':{'email':_0x32ada8}});return!_0x4c4b1e;}),'password':Yup[_0x5bff17(0xb7)]()[_0x5bff17(0x9d)]()[_0x5bff17(0x9c)](0x5)});try{await _0x47ae8d[_0x5bff17(0xba)]({'email':_0x2576a0,'password':_0x4ea703,'name':_0x2188a4});}catch(_0x251790){throw new AppError_1[(_0x5bff17(0xb4))](_0x251790[_0x5bff17(0xbe)]);}const _0x306e6b=await User_1['default']['create']({'email':_0x2576a0,'password':_0x4ea703,'name':_0x2188a4,'companyId':_0xac5559,'profile':profile},{'include':['queues','company']});await _0x306e6b[_0x5bff17(0xc5)](_0x5bff17(0xbd),queueIds),await _0x306e6b[_0x5bff17(0xa9)]();const _0x3267c4=(0x0,SerializeUser_1[_0x5bff17(0xb9)])(_0x306e6b);return _0x3267c4;};exports['default']=CreateUserService;