'use strict';const a566_0x14f37a=a566_0x546b;(function(_0x14d8a2,_0x5ba2f2){const _0x149849=a566_0x546b,_0x4fd503=_0x14d8a2();while(!![]){try{const _0x4a0175=-parseInt(_0x149849(0x203))/0x1+-parseInt(_0x149849(0x1e9))/0x2*(-parseInt(_0x149849(0x1e2))/0x3)+parseInt(_0x149849(0x1fd))/0x4*(-parseInt(_0x149849(0x1e3))/0x5)+-parseInt(_0x149849(0x1e6))/0x6+-parseInt(_0x149849(0x205))/0x7*(parseInt(_0x149849(0x20b))/0x8)+parseInt(_0x149849(0x20e))/0x9+parseInt(_0x149849(0x1fa))/0xa;if(_0x4a0175===_0x5ba2f2)break;else _0x4fd503['push'](_0x4fd503['shift']());}catch(_0x374452){_0x4fd503['push'](_0x4fd503['shift']());}}}(a566_0x4028,0x8bff8));function a566_0x546b(_0x630439,_0x644c06){const _0x2eee0e=a566_0x4028();return a566_0x546b=function(_0x68b138,_0x280d33){_0x68b138=_0x68b138-0x1e0;let _0x402878=_0x2eee0e[_0x68b138];return _0x402878;},a566_0x546b(_0x630439,_0x644c06);}var __createBinding=this&&this['__createBinding']||(Object[a566_0x14f37a(0x201)]?function(_0x3593ea,_0x304910,_0x4fba5c,_0x358f92){const _0x4c306e=a566_0x14f37a;if(_0x358f92===undefined)_0x358f92=_0x4fba5c;var _0x357409=Object[_0x4c306e(0x1e7)](_0x304910,_0x4fba5c);(!_0x357409||(_0x4c306e(0x20f)in _0x357409?!_0x304910['__esModule']:_0x357409[_0x4c306e(0x1ee)]||_0x357409['configurable']))&&(_0x357409={'enumerable':!![],'get':function(){return _0x304910[_0x4fba5c];}}),Object[_0x4c306e(0x1ec)](_0x3593ea,_0x358f92,_0x357409);}:function(_0x1b2523,_0x1721a5,_0x57c950,_0x11c9b2){if(_0x11c9b2===undefined)_0x11c9b2=_0x57c950;_0x1b2523[_0x11c9b2]=_0x1721a5[_0x57c950];}),__setModuleDefault=this&&this[a566_0x14f37a(0x20a)]||(Object['create']?function(_0x53115b,_0x4ec7ae){const _0x59809b=a566_0x14f37a;Object[_0x59809b(0x1ec)](_0x53115b,_0x59809b(0x208),{'enumerable':!![],'value':_0x4ec7ae});}:function(_0x41980b,_0x48e59f){_0x41980b['default']=_0x48e59f;}),__importStar=this&&this[a566_0x14f37a(0x210)]||(function(){const _0x3396d0=(function(){let _0x7481bc=!![];return function(_0x268b95,_0x3e0937){const _0x22e14d=_0x7481bc?function(){if(_0x3e0937){const _0x477abd=_0x3e0937['apply'](_0x268b95,arguments);return _0x3e0937=null,_0x477abd;}}:function(){};return _0x7481bc=![],_0x22e14d;};}()),_0x18e46f=_0x3396d0(this,function(){const _0x4bafaf=a566_0x546b;return _0x18e46f[_0x4bafaf(0x207)]()[_0x4bafaf(0x20d)](_0x4bafaf(0x1f3))[_0x4bafaf(0x207)]()[_0x4bafaf(0x1f5)](_0x18e46f)[_0x4bafaf(0x20d)](_0x4bafaf(0x1f3));});_0x18e46f();var _0x6414f3=function(_0x5c3dab){return _0x6414f3=Object['getOwnPropertyNames']||function(_0x202f86){const _0x5f1d1e=a566_0x546b;var _0x2196bf=[];for(var _0x1bb766 in _0x202f86)if(Object[_0x5f1d1e(0x209)][_0x5f1d1e(0x1e5)]['call'](_0x202f86,_0x1bb766))_0x2196bf[_0x2196bf[_0x5f1d1e(0x1ff)]]=_0x1bb766;return _0x2196bf;},_0x6414f3(_0x5c3dab);};return function(_0x5e94fd){const _0x514048=a566_0x546b;if(_0x5e94fd&&_0x5e94fd['__esModule'])return _0x5e94fd;var _0x441697={};if(_0x5e94fd!=null){for(var _0x507d71=_0x6414f3(_0x5e94fd),_0x513dff=0x0;_0x513dff<_0x507d71[_0x514048(0x1ff)];_0x513dff++)if(_0x507d71[_0x513dff]!=='default')__createBinding(_0x441697,_0x5e94fd,_0x507d71[_0x513dff]);}return __setModuleDefault(_0x441697,_0x5e94fd),_0x441697;};}()),__importDefault=this&&this[a566_0x14f37a(0x1f9)]||function(_0x1849b2){return _0x1849b2&&_0x1849b2['__esModule']?_0x1849b2:{'default':_0x1849b2};};Object[a566_0x14f37a(0x1ec)](exports,a566_0x14f37a(0x1e0),{'value':!![]});const Yup=__importStar(require('yup')),AppError_1=__importDefault(require(a566_0x14f37a(0x1f1))),SerializeUser_1=require(a566_0x14f37a(0x1f0)),User_1=__importDefault(require(a566_0x14f37a(0x1f8))),Plan_1=__importDefault(require('../../models/Plan')),Company_1=__importDefault(require(a566_0x14f37a(0x1fe))),CreateUserService=async({email:_0x5860e0,password:_0x3da8d9,name:_0x26569c,queueIds:queueIds=[],companyId:_0x4364e0,profile:profile=a566_0x14f37a(0x1ef)})=>{const _0x739def=a566_0x14f37a;if(_0x4364e0!==undefined){const _0x22e7e5=await Company_1[_0x739def(0x208)][_0x739def(0x1f7)]({'where':{'id':_0x4364e0},'include':[{'model':Plan_1[_0x739def(0x208)],'as':_0x739def(0x206)}]});if(_0x22e7e5!==null){const _0x508c52=await User_1['default'][_0x739def(0x1ea)]({'where':{'companyId':_0x4364e0}});if(_0x508c52>=_0x22e7e5[_0x739def(0x206)][_0x739def(0x1e4)])throw new AppError_1['default']('Número\x20máximo\x20de\x20usuários\x20já\x20alcançado:\x20'+_0x508c52);}}const _0x427b1b=Yup[_0x739def(0x1ed)]()[_0x739def(0x204)]({'name':Yup[_0x739def(0x20c)]()[_0x739def(0x202)]()['min'](0x2),'email':Yup[_0x739def(0x20c)]()[_0x739def(0x1eb)]()[_0x739def(0x202)]()[_0x739def(0x1e8)](_0x739def(0x200),_0x739def(0x1fc),async _0x1ff235=>{const _0x5849d8=_0x739def;if(!_0x1ff235)return![];const _0x37b730=await User_1[_0x5849d8(0x208)][_0x5849d8(0x1f7)]({'where':{'email':_0x1ff235}});return!_0x37b730;}),'password':Yup[_0x739def(0x20c)]()[_0x739def(0x202)]()['min'](0x5)});try{await _0x427b1b['validate']({'email':_0x5860e0,'password':_0x3da8d9,'name':_0x26569c});}catch(_0x4f7a3a){throw new AppError_1[(_0x739def(0x208))](_0x4f7a3a[_0x739def(0x1fb)]);}const _0x125c42=await User_1[_0x739def(0x208)][_0x739def(0x201)]({'email':_0x5860e0,'password':_0x3da8d9,'name':_0x26569c,'companyId':_0x4364e0,'profile':profile},{'include':[_0x739def(0x1f6),_0x739def(0x1f2)]});await _0x125c42[_0x739def(0x1e1)](_0x739def(0x1f6),queueIds),await _0x125c42[_0x739def(0x1f4)]();const _0x59afe=(0x0,SerializeUser_1['SerializeUser'])(_0x125c42);return _0x59afe;};function a566_0x4028(){const _0x5701b1=['create','required','825523Eybkay','shape','7268933zIsJfi','plan','toString','default','prototype','__setModuleDefault','8jqFBus','string','search','3817557hTMhED','get','__importStar','__esModule','$set','169503sXVzUg','30pBwQAU','users','hasOwnProperty','6735090ZJBInj','getOwnPropertyDescriptor','test','2Qrpoot','count','email','defineProperty','object','writable','admin','../../helpers/SerializeUser','../../errors/AppError','company','(((.+)+)+)+$','reload','constructor','queues','findOne','../../models/User','__importDefault','36584490WEgrlR','message','An\x20user\x20with\x20this\x20email\x20already\x20exists.','386156rnnXRu','../../models/Company','length','Check-email'];a566_0x4028=function(){return _0x5701b1;};return a566_0x4028();}exports['default']=CreateUserService;