'use strict';const a566_0x3d8610=a566_0x260f;(function(_0x293dd4,_0x1f6ec6){const _0x2bbedb=a566_0x260f,_0x283c28=_0x293dd4();while(!![]){try{const _0x2a19c3=parseInt(_0x2bbedb(0x122))/0x1*(-parseInt(_0x2bbedb(0x12a))/0x2)+parseInt(_0x2bbedb(0x140))/0x3+parseInt(_0x2bbedb(0x143))/0x4*(parseInt(_0x2bbedb(0x153))/0x5)+parseInt(_0x2bbedb(0x154))/0x6*(parseInt(_0x2bbedb(0x138))/0x7)+-parseInt(_0x2bbedb(0x13a))/0x8*(-parseInt(_0x2bbedb(0x134))/0x9)+parseInt(_0x2bbedb(0x150))/0xa+-parseInt(_0x2bbedb(0x11f))/0xb*(parseInt(_0x2bbedb(0x14a))/0xc);if(_0x2a19c3===_0x1f6ec6)break;else _0x283c28['push'](_0x283c28['shift']());}catch(_0x1d78a8){_0x283c28['push'](_0x283c28['shift']());}}}(a566_0x2bbc,0x5fbaf));var __createBinding=this&&this[a566_0x3d8610(0x142)]||(Object[a566_0x3d8610(0x14c)]?function(_0x586d71,_0x5212d2,_0x42610e,_0x45a2db){const _0x4ff7ec=a566_0x3d8610;if(_0x45a2db===undefined)_0x45a2db=_0x42610e;var _0xdf6c88=Object[_0x4ff7ec(0x141)](_0x5212d2,_0x42610e);(!_0xdf6c88||(_0x4ff7ec(0x152)in _0xdf6c88?!_0x5212d2[_0x4ff7ec(0x133)]:_0xdf6c88[_0x4ff7ec(0x127)]||_0xdf6c88[_0x4ff7ec(0x14b)]))&&(_0xdf6c88={'enumerable':!![],'get':function(){return _0x5212d2[_0x42610e];}}),Object[_0x4ff7ec(0x14f)](_0x586d71,_0x45a2db,_0xdf6c88);}:function(_0x261dc0,_0x535feb,_0x2a6f7b,_0x3ab9e9){if(_0x3ab9e9===undefined)_0x3ab9e9=_0x2a6f7b;_0x261dc0[_0x3ab9e9]=_0x535feb[_0x2a6f7b];}),__setModuleDefault=this&&this[a566_0x3d8610(0x12b)]||(Object[a566_0x3d8610(0x14c)]?function(_0x185747,_0x263589){const _0x1e1c34=a566_0x3d8610;Object['defineProperty'](_0x185747,_0x1e1c34(0x125),{'enumerable':!![],'value':_0x263589});}:function(_0x173247,_0x1fcbbd){_0x173247['default']=_0x1fcbbd;}),__importStar=this&&this[a566_0x3d8610(0x147)]||(function(){const _0x3050ba=(function(){let _0x2fba60=!![];return function(_0x2f0112,_0x47514d){const _0x25ea9c=_0x2fba60?function(){const _0x484b46=a566_0x260f;if(_0x47514d){const _0x41ae67=_0x47514d[_0x484b46(0x12e)](_0x2f0112,arguments);return _0x47514d=null,_0x41ae67;}}:function(){};return _0x2fba60=![],_0x25ea9c;};}()),_0x1bff8b=_0x3050ba(this,function(){const _0x4548b5=a566_0x260f;return _0x1bff8b[_0x4548b5(0x149)]()[_0x4548b5(0x146)](_0x4548b5(0x135))[_0x4548b5(0x149)]()[_0x4548b5(0x129)](_0x1bff8b)[_0x4548b5(0x146)]('(((.+)+)+)+$');});_0x1bff8b();var _0x3cc629=function(_0x517584){return _0x3cc629=Object['getOwnPropertyNames']||function(_0x4e3b25){const _0x32f290=a566_0x260f;var _0x9fd432=[];for(var _0x18043f in _0x4e3b25)if(Object['prototype'][_0x32f290(0x130)][_0x32f290(0x12d)](_0x4e3b25,_0x18043f))_0x9fd432[_0x9fd432[_0x32f290(0x13f)]]=_0x18043f;return _0x9fd432;},_0x3cc629(_0x517584);};return function(_0x182efa){const _0x296b5a=a566_0x260f;if(_0x182efa&&_0x182efa[_0x296b5a(0x133)])return _0x182efa;var _0x5d2885={};if(_0x182efa!=null){for(var _0x3c22ab=_0x3cc629(_0x182efa),_0x2ae66d=0x0;_0x2ae66d<_0x3c22ab[_0x296b5a(0x13f)];_0x2ae66d++)if(_0x3c22ab[_0x2ae66d]!==_0x296b5a(0x125))__createBinding(_0x5d2885,_0x182efa,_0x3c22ab[_0x2ae66d]);}return __setModuleDefault(_0x5d2885,_0x182efa),_0x5d2885;};}()),__importDefault=this&&this['__importDefault']||function(_0xde8135){const _0x3e3f7e=a566_0x3d8610;return _0xde8135&&_0xde8135[_0x3e3f7e(0x133)]?_0xde8135:{'default':_0xde8135};};function a566_0x2bbc(){const _0x1ce80a=['824uQEAWs','findOne','required','company','Check-email','length','175827MrpctX','getOwnPropertyDescriptor','__createBinding','2008IugHcE','users','$set','search','__importStar','shape','toString','18502008mnmNhF','configurable','create','message','Número\x20máximo\x20de\x20usuários\x20já\x20alcançado:\x20','defineProperty','7006650Avwxwk','min','get','4230oDEdXY','2175984wGfFXv','11VOGBzH','queues','../../models/Plan','5OzYQFj','object','string','default','yup','writable','../../helpers/SerializeUser','constructor','61786UGiXDC','__setModuleDefault','count','call','apply','reload','hasOwnProperty','SerializeUser','plan','__esModule','47340iosNrq','(((.+)+)+)+$','../../models/Company','test','7jkvXWZ','../../errors/AppError'];a566_0x2bbc=function(){return _0x1ce80a;};return a566_0x2bbc();}Object[a566_0x3d8610(0x14f)](exports,a566_0x3d8610(0x133),{'value':!![]});function a566_0x260f(_0x4d7db5,_0xb77271){const _0x4bc410=a566_0x2bbc();return a566_0x260f=function(_0x3a9ff5,_0x2f9bd6){_0x3a9ff5=_0x3a9ff5-0x11f;let _0x2bbc8d=_0x4bc410[_0x3a9ff5];return _0x2bbc8d;},a566_0x260f(_0x4d7db5,_0xb77271);}const Yup=__importStar(require(a566_0x3d8610(0x126))),AppError_1=__importDefault(require(a566_0x3d8610(0x139))),SerializeUser_1=require(a566_0x3d8610(0x128)),User_1=__importDefault(require('../../models/User')),Plan_1=__importDefault(require(a566_0x3d8610(0x121))),Company_1=__importDefault(require(a566_0x3d8610(0x136))),CreateUserService=async({email:_0x4830be,password:_0x43c351,name:_0x524eaf,queueIds:queueIds=[],companyId:_0x474f2f,profile:profile='admin'})=>{const _0x5712b6=a566_0x3d8610;if(_0x474f2f!==undefined){const _0x49efcf=await Company_1['default'][_0x5712b6(0x13b)]({'where':{'id':_0x474f2f},'include':[{'model':Plan_1[_0x5712b6(0x125)],'as':_0x5712b6(0x132)}]});if(_0x49efcf!==null){const _0x25eefd=await User_1[_0x5712b6(0x125)][_0x5712b6(0x12c)]({'where':{'companyId':_0x474f2f}});if(_0x25eefd>=_0x49efcf[_0x5712b6(0x132)][_0x5712b6(0x144)])throw new AppError_1[(_0x5712b6(0x125))](_0x5712b6(0x14e)+_0x25eefd);}}const _0x5a36e2=Yup[_0x5712b6(0x123)]()[_0x5712b6(0x148)]({'name':Yup[_0x5712b6(0x124)]()[_0x5712b6(0x13c)]()[_0x5712b6(0x151)](0x2),'email':Yup['string']()['email']()[_0x5712b6(0x13c)]()[_0x5712b6(0x137)](_0x5712b6(0x13e),'An\x20user\x20with\x20this\x20email\x20already\x20exists.',async _0x21a450=>{const _0x5792c2=_0x5712b6;if(!_0x21a450)return![];const _0x5afb39=await User_1[_0x5792c2(0x125)][_0x5792c2(0x13b)]({'where':{'email':_0x21a450}});return!_0x5afb39;}),'password':Yup[_0x5712b6(0x124)]()[_0x5712b6(0x13c)]()[_0x5712b6(0x151)](0x5)});try{await _0x5a36e2['validate']({'email':_0x4830be,'password':_0x43c351,'name':_0x524eaf});}catch(_0x2b80f1){throw new AppError_1[(_0x5712b6(0x125))](_0x2b80f1[_0x5712b6(0x14d)]);}const _0x5dd006=await User_1[_0x5712b6(0x125)]['create']({'email':_0x4830be,'password':_0x43c351,'name':_0x524eaf,'companyId':_0x474f2f,'profile':profile},{'include':[_0x5712b6(0x120),_0x5712b6(0x13d)]});await _0x5dd006[_0x5712b6(0x145)](_0x5712b6(0x120),queueIds),await _0x5dd006[_0x5712b6(0x12f)]();const _0x38ce84=(0x0,SerializeUser_1[_0x5712b6(0x131)])(_0x5dd006);return _0x38ce84;};exports['default']=CreateUserService;