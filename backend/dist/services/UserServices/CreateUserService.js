const a535_0x4b6096=a535_0x1e87;(function(_0x13e7b1,_0xd861a7){const _0x3782e5=a535_0x1e87,_0x3cecb0=_0x13e7b1();while(!![]){try{const _0x40a5f9=parseInt(_0x3782e5(0x1b6))/0x1*(-parseInt(_0x3782e5(0x1be))/0x2)+parseInt(_0x3782e5(0x1a4))/0x3*(parseInt(_0x3782e5(0x197))/0x4)+-parseInt(_0x3782e5(0x1a6))/0x5+parseInt(_0x3782e5(0x19b))/0x6*(parseInt(_0x3782e5(0x1c5))/0x7)+parseInt(_0x3782e5(0x1af))/0x8+-parseInt(_0x3782e5(0x196))/0x9+parseInt(_0x3782e5(0x1a3))/0xa*(parseInt(_0x3782e5(0x1ad))/0xb);if(_0x40a5f9===_0xd861a7)break;else _0x3cecb0['push'](_0x3cecb0['shift']());}catch(_0x1456d6){_0x3cecb0['push'](_0x3cecb0['shift']());}}}(a535_0x37f4,0x4dbf2));const a535_0x141e83=(function(){let _0x13963a=!![];return function(_0x25d9ad,_0x2f0ff2){const _0x418e58=_0x13963a?function(){const _0x5601bb=a535_0x1e87;if(_0x2f0ff2){const _0x2e11dc=_0x2f0ff2[_0x5601bb(0x1c0)](_0x25d9ad,arguments);return _0x2f0ff2=null,_0x2e11dc;}}:function(){};return _0x13963a=![],_0x418e58;};}()),a535_0x4863dd=a535_0x141e83(this,function(){const _0x4acdd7=a535_0x1e87;return a535_0x4863dd[_0x4acdd7(0x19e)]()['search']('(((.+)+)+)+$')['toString']()[_0x4acdd7(0x1b3)](a535_0x4863dd)[_0x4acdd7(0x1ba)](_0x4acdd7(0x1b0));});function a535_0x1e87(_0x103768,_0x16f87c){const _0x348690=a535_0x37f4();return a535_0x1e87=function(_0x4863dd,_0x141e83){_0x4863dd=_0x4863dd-0x195;let _0x37f473=_0x348690[_0x4863dd];return _0x37f473;},a535_0x1e87(_0x103768,_0x16f87c);}a535_0x4863dd();'use strict';function a535_0x37f4(){const _0x57bb2b=['test','221538ARrLmV','configurable','reload','toString','__importDefault','get','length','__createBinding','14280QwPsWI','1170465YjYZgx','string','3000800gOgewF','message','defineProperty','getOwnPropertyDescriptor','admin','SerializeUser','findOne','473vZdPXB','$set','4167560atyUrV','(((.+)+)+)+$','plan','required','constructor','An\x20user\x20with\x20this\x20email\x20already\x20exists.','__esModule','19979IDARzH','boolean','../../errors/AppError','Check-email','search','Company\x20not\x20found','call','../../models/Company','26rGroZQ','min','apply','email','count','default','queues','91KpdHCy','create','../../helpers/SerializeUser','hasOwnProperty','writable','2467494yrCQVH','4SVMXVR','users','object'];a535_0x37f4=function(){return _0x57bb2b;};return a535_0x37f4();}var __createBinding=this&&this[a535_0x4b6096(0x1a2)]||(Object['create']?function(_0x30d12d,_0x375baf,_0x2cbb14,_0x80e846){const _0x1d076b=a535_0x4b6096;if(_0x80e846===undefined)_0x80e846=_0x2cbb14;var _0x345a37=Object[_0x1d076b(0x1a9)](_0x375baf,_0x2cbb14);(!_0x345a37||(_0x1d076b(0x1a0)in _0x345a37?!_0x375baf[_0x1d076b(0x1b5)]:_0x345a37[_0x1d076b(0x195)]||_0x345a37[_0x1d076b(0x19c)]))&&(_0x345a37={'enumerable':!![],'get':function(){return _0x375baf[_0x2cbb14];}}),Object[_0x1d076b(0x1a8)](_0x30d12d,_0x80e846,_0x345a37);}:function(_0x33062b,_0x16d817,_0x1cb95a,_0x309cfa){if(_0x309cfa===undefined)_0x309cfa=_0x1cb95a;_0x33062b[_0x309cfa]=_0x16d817[_0x1cb95a];}),__setModuleDefault=this&&this['__setModuleDefault']||(Object[a535_0x4b6096(0x1c6)]?function(_0x26d416,_0x38238b){const _0xe43b1c=a535_0x4b6096;Object[_0xe43b1c(0x1a8)](_0x26d416,_0xe43b1c(0x1c3),{'enumerable':!![],'value':_0x38238b});}:function(_0xd5a042,_0x20beac){const _0x19e47b=a535_0x4b6096;_0xd5a042[_0x19e47b(0x1c3)]=_0x20beac;}),__importStar=this&&this['__importStar']||function(_0x3281c7){const _0x31e709=a535_0x4b6096;if(_0x3281c7&&_0x3281c7[_0x31e709(0x1b5)])return _0x3281c7;var _0x1821fd={};if(_0x3281c7!=null){for(var _0x3427a1 in _0x3281c7)if(_0x3427a1!==_0x31e709(0x1c3)&&Object['prototype'][_0x31e709(0x1c8)][_0x31e709(0x1bc)](_0x3281c7,_0x3427a1))__createBinding(_0x1821fd,_0x3281c7,_0x3427a1);}return __setModuleDefault(_0x1821fd,_0x3281c7),_0x1821fd;},__importDefault=this&&this[a535_0x4b6096(0x19f)]||function(_0x1baf0b){const _0x57e55b=a535_0x4b6096;return _0x1baf0b&&_0x1baf0b[_0x57e55b(0x1b5)]?_0x1baf0b:{'default':_0x1baf0b};};Object[a535_0x4b6096(0x1a8)](exports,a535_0x4b6096(0x1b5),{'value':!![]});const Yup=__importStar(require('yup')),AppError_1=__importDefault(require(a535_0x4b6096(0x1b8))),SerializeUser_1=require(a535_0x4b6096(0x1c7)),User_1=__importDefault(require('../../models/User')),Plan_1=__importDefault(require('../../models/Plan')),Company_1=__importDefault(require(a535_0x4b6096(0x1bd))),CreateUserService=async({email:_0x58e1d0,password:_0xc25e4f,name:_0x1b52ab,queueIds:queueIds=[],companyId:_0x5f171c,profile:profile=a535_0x4b6096(0x1aa),allTicket:_0x421217,spy:_0xc2271f,whatsappId:_0x1191d7,startWork:_0x4d709d,endWork:_0x46e611,isTricked:_0x142dcf,super:_0x375f42,defaultMenu:_0x1d2bd6})=>{const _0xaca9c1=a535_0x4b6096;if(_0x5f171c!==undefined){const _0x2aa55c=await Company_1[_0xaca9c1(0x1c3)]['findOne']({'where':{'id':_0x5f171c},'include':[{'model':Plan_1[_0xaca9c1(0x1c3)],'as':_0xaca9c1(0x1b1)}]});if(_0x2aa55c){const _0x5e97d3=await User_1[_0xaca9c1(0x1c3)][_0xaca9c1(0x1c2)]({'where':{'companyId':_0x5f171c}});if(_0x5e97d3>=_0x2aa55c[_0xaca9c1(0x1b1)][_0xaca9c1(0x198)])throw new AppError_1['default']('Número\x20máximo\x20de\x20usuários\x20já\x20alcançado:\x20'+_0x5e97d3,0x190);}else throw new AppError_1[(_0xaca9c1(0x1c3))](_0xaca9c1(0x1bb),0x194);}const _0x316433=Yup[_0xaca9c1(0x199)]()['shape']({'name':Yup[_0xaca9c1(0x1a5)]()[_0xaca9c1(0x1b2)]()[_0xaca9c1(0x1bf)](0x2),'email':Yup[_0xaca9c1(0x1a5)]()[_0xaca9c1(0x1c1)]()[_0xaca9c1(0x1b2)]()[_0xaca9c1(0x19a)](_0xaca9c1(0x1b9),_0xaca9c1(0x1b4),async _0xd3d66c=>{const _0x566a61=_0xaca9c1;if(!_0xd3d66c)return![];const _0x1f3234=await User_1[_0x566a61(0x1c3)][_0x566a61(0x1ac)]({'where':{'email':_0xd3d66c}});return!_0x1f3234;}),'password':Yup['string']()[_0xaca9c1(0x1b2)]()[_0xaca9c1(0x1bf)](0x5),'super':Yup[_0xaca9c1(0x1b7)]()[_0xaca9c1(0x1b2)]()});try{await _0x316433['validate']({'email':_0x58e1d0,'password':_0xc25e4f,'name':_0x1b52ab,'super':_0x375f42});}catch(_0x39948a){throw new AppError_1[(_0xaca9c1(0x1c3))](_0x39948a[_0xaca9c1(0x1a7)],0x190);}const _0x1e460a=await User_1['default'][_0xaca9c1(0x1c6)]({'email':_0x58e1d0,'password':_0xc25e4f,'name':_0x1b52ab,'companyId':_0x5f171c,'profile':profile,'allTicket':_0x421217,'whatsappId':_0x1191d7||null,'startWork':_0x4d709d,'endWork':_0x46e611,'spy':_0xc2271f,'isTricked':_0x142dcf,'super':_0x375f42,'defaultMenu':_0x1d2bd6});queueIds[_0xaca9c1(0x1a1)]>0x0&&await _0x1e460a[_0xaca9c1(0x1ae)](_0xaca9c1(0x1c4),queueIds);await _0x1e460a[_0xaca9c1(0x19d)]();const _0x339854=await(0x0,SerializeUser_1[_0xaca9c1(0x1ab)])(_0x1e460a);return _0x339854;};exports['default']=CreateUserService;