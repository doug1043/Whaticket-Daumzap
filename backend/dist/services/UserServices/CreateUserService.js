const a534_0x265a21=a534_0x1d77;(function(_0x16dbd2,_0x49cf9e){const _0x1f14f4=a534_0x1d77,_0x34b71a=_0x16dbd2();while(!![]){try{const _0x33d1bd=parseInt(_0x1f14f4(0x9f))/0x1+parseInt(_0x1f14f4(0x92))/0x2+-parseInt(_0x1f14f4(0xb4))/0x3*(-parseInt(_0x1f14f4(0xa4))/0x4)+parseInt(_0x1f14f4(0xb0))/0x5+parseInt(_0x1f14f4(0xa1))/0x6+-parseInt(_0x1f14f4(0xb7))/0x7*(parseInt(_0x1f14f4(0xad))/0x8)+parseInt(_0x1f14f4(0xb1))/0x9*(-parseInt(_0x1f14f4(0x97))/0xa);if(_0x33d1bd===_0x49cf9e)break;else _0x34b71a['push'](_0x34b71a['shift']());}catch(_0x5e4e29){_0x34b71a['push'](_0x34b71a['shift']());}}}(a534_0x1b66,0xa0806));function a534_0x1b66(){const _0x34c2eb=['__createBinding','857957MXtgZt','constructor','1635348qjeTXD','get','__esModule','1125048zgfvJy','boolean','__importDefault','SerializeUser','validate','min','string','length','findOne','4968008lnarJh','admin','users','3278975bRjkPe','9HMOqsS','configurable','default','3XRvhXC','toString','(((.+)+)+)+$','7JmLcmE','writable','search','required','plan','create','../../errors/AppError','shape','Company\x20not\x20found','2018108HyaTLL','Check-email','defineProperty','__importStar','yup','17982110zSVsDw','call','../../models/Plan','apply','getOwnPropertyDescriptor','email','reload'];a534_0x1b66=function(){return _0x34c2eb;};return a534_0x1b66();}const a534_0x7e5a9=(function(){let _0x48c7fb=!![];return function(_0x1a28aa,_0x9fd3f3){const _0xf86ab7=_0x48c7fb?function(){const _0xca89a9=a534_0x1d77;if(_0x9fd3f3){const _0x413925=_0x9fd3f3[_0xca89a9(0x9a)](_0x1a28aa,arguments);return _0x9fd3f3=null,_0x413925;}}:function(){};return _0x48c7fb=![],_0xf86ab7;};}()),a534_0x182b2a=a534_0x7e5a9(this,function(){const _0x36a830=a534_0x1d77;return a534_0x182b2a[_0x36a830(0xb5)]()['search'](_0x36a830(0xb6))[_0x36a830(0xb5)]()[_0x36a830(0xa0)](a534_0x182b2a)[_0x36a830(0xb9)](_0x36a830(0xb6));});a534_0x182b2a();'use strict';var __createBinding=this&&this[a534_0x265a21(0x9e)]||(Object['create']?function(_0x5bf0b7,_0xf7e519,_0x177562,_0x20eb9c){const _0x15f697=a534_0x265a21;if(_0x20eb9c===undefined)_0x20eb9c=_0x177562;var _0x3bd5d9=Object[_0x15f697(0x9b)](_0xf7e519,_0x177562);(!_0x3bd5d9||(_0x15f697(0xa2)in _0x3bd5d9?!_0xf7e519[_0x15f697(0xa3)]:_0x3bd5d9[_0x15f697(0xb8)]||_0x3bd5d9[_0x15f697(0xb2)]))&&(_0x3bd5d9={'enumerable':!![],'get':function(){return _0xf7e519[_0x177562];}}),Object[_0x15f697(0x94)](_0x5bf0b7,_0x20eb9c,_0x3bd5d9);}:function(_0x1af945,_0x163bff,_0x39ff23,_0x1d01aa){if(_0x1d01aa===undefined)_0x1d01aa=_0x39ff23;_0x1af945[_0x1d01aa]=_0x163bff[_0x39ff23];}),__setModuleDefault=this&&this['__setModuleDefault']||(Object[a534_0x265a21(0x8e)]?function(_0x37d249,_0x15df7e){const _0xcbcb9e=a534_0x265a21;Object[_0xcbcb9e(0x94)](_0x37d249,_0xcbcb9e(0xb3),{'enumerable':!![],'value':_0x15df7e});}:function(_0x265302,_0x46e4ec){_0x265302['default']=_0x46e4ec;}),__importStar=this&&this[a534_0x265a21(0x95)]||function(_0x2033a0){const _0x1ecaed=a534_0x265a21;if(_0x2033a0&&_0x2033a0[_0x1ecaed(0xa3)])return _0x2033a0;var _0x18f7d2={};if(_0x2033a0!=null){for(var _0x39d2c9 in _0x2033a0)if(_0x39d2c9!==_0x1ecaed(0xb3)&&Object['prototype']['hasOwnProperty'][_0x1ecaed(0x98)](_0x2033a0,_0x39d2c9))__createBinding(_0x18f7d2,_0x2033a0,_0x39d2c9);}return __setModuleDefault(_0x18f7d2,_0x2033a0),_0x18f7d2;},__importDefault=this&&this[a534_0x265a21(0xa6)]||function(_0xaf7b2a){const _0x28ce29=a534_0x265a21;return _0xaf7b2a&&_0xaf7b2a[_0x28ce29(0xa3)]?_0xaf7b2a:{'default':_0xaf7b2a};};Object['defineProperty'](exports,a534_0x265a21(0xa3),{'value':!![]});function a534_0x1d77(_0x4c086f,_0xf4b2cc){const _0x4a0d72=a534_0x1b66();return a534_0x1d77=function(_0x182b2a,_0x7e5a9){_0x182b2a=_0x182b2a-0x8c;let _0x1b6672=_0x4a0d72[_0x182b2a];return _0x1b6672;},a534_0x1d77(_0x4c086f,_0xf4b2cc);}const Yup=__importStar(require(a534_0x265a21(0x96))),AppError_1=__importDefault(require(a534_0x265a21(0x8f))),SerializeUser_1=require('../../helpers/SerializeUser'),User_1=__importDefault(require('../../models/User')),Plan_1=__importDefault(require(a534_0x265a21(0x99))),Company_1=__importDefault(require('../../models/Company')),CreateUserService=async({email:_0x1bb446,password:_0x3ad46c,name:_0x4be809,queueIds:queueIds=[],companyId:_0x300df6,profile:profile=a534_0x265a21(0xae),allTicket:_0x330f34,spy:_0x328074,whatsappId:_0xf8c3a8,startWork:_0x429fe0,endWork:_0x22da73,isTricked:_0x2243c4,super:_0x9b7ec,defaultMenu:_0x4e02b7})=>{const _0x2db260=a534_0x265a21;if(_0x300df6!==undefined){const _0x4c0fe2=await Company_1[_0x2db260(0xb3)][_0x2db260(0xac)]({'where':{'id':_0x300df6},'include':[{'model':Plan_1[_0x2db260(0xb3)],'as':_0x2db260(0x8d)}]});if(_0x4c0fe2){const _0x530986=await User_1[_0x2db260(0xb3)]['count']({'where':{'companyId':_0x300df6}});if(_0x530986>=_0x4c0fe2[_0x2db260(0x8d)][_0x2db260(0xaf)])throw new AppError_1[(_0x2db260(0xb3))]('Número\x20máximo\x20de\x20usuários\x20já\x20alcançado:\x20'+_0x530986,0x190);}else throw new AppError_1[(_0x2db260(0xb3))](_0x2db260(0x91),0x194);}const _0x2d22eb=Yup['object']()[_0x2db260(0x90)]({'name':Yup[_0x2db260(0xaa)]()[_0x2db260(0x8c)]()[_0x2db260(0xa9)](0x2),'email':Yup[_0x2db260(0xaa)]()[_0x2db260(0x9c)]()[_0x2db260(0x8c)]()['test'](_0x2db260(0x93),'An\x20user\x20with\x20this\x20email\x20already\x20exists.',async _0x20cd1a=>{const _0x496362=_0x2db260;if(!_0x20cd1a)return![];const _0x43f601=await User_1[_0x496362(0xb3)][_0x496362(0xac)]({'where':{'email':_0x20cd1a}});return!_0x43f601;}),'password':Yup[_0x2db260(0xaa)]()[_0x2db260(0x8c)]()[_0x2db260(0xa9)](0x5),'super':Yup[_0x2db260(0xa5)]()[_0x2db260(0x8c)]()});try{await _0x2d22eb[_0x2db260(0xa8)]({'email':_0x1bb446,'password':_0x3ad46c,'name':_0x4be809,'super':_0x9b7ec});}catch(_0x11f3d5){throw new AppError_1[(_0x2db260(0xb3))](_0x11f3d5['message'],0x190);}const _0x395ac7=await User_1[_0x2db260(0xb3)][_0x2db260(0x8e)]({'email':_0x1bb446,'password':_0x3ad46c,'name':_0x4be809,'companyId':_0x300df6,'profile':profile,'allTicket':_0x330f34,'whatsappId':_0xf8c3a8||null,'startWork':_0x429fe0,'endWork':_0x22da73,'spy':_0x328074,'isTricked':_0x2243c4,'super':_0x9b7ec,'defaultMenu':_0x4e02b7});queueIds[_0x2db260(0xab)]>0x0&&await _0x395ac7['$set']('queues',queueIds);await _0x395ac7[_0x2db260(0x9d)]();const _0x12f22f=await(0x0,SerializeUser_1[_0x2db260(0xa7)])(_0x395ac7);return _0x12f22f;};exports['default']=CreateUserService;