const a550_0x13496e=a550_0x4d37;(function(_0x1de44c,_0x4880d7){const _0x314413=a550_0x4d37,_0x396612=_0x1de44c();while(!![]){try{const _0x45cc4f=-parseInt(_0x314413(0x1a1))/0x1*(-parseInt(_0x314413(0x1b5))/0x2)+parseInt(_0x314413(0x1b8))/0x3+parseInt(_0x314413(0x19e))/0x4*(parseInt(_0x314413(0x19d))/0x5)+parseInt(_0x314413(0x1b1))/0x6+-parseInt(_0x314413(0x1ab))/0x7*(parseInt(_0x314413(0x1a5))/0x8)+-parseInt(_0x314413(0x197))/0x9*(parseInt(_0x314413(0x1bb))/0xa)+-parseInt(_0x314413(0x198))/0xb*(parseInt(_0x314413(0x1b3))/0xc);if(_0x45cc4f===_0x4880d7)break;else _0x396612['push'](_0x396612['shift']());}catch(_0x51db40){_0x396612['push'](_0x396612['shift']());}}}(a550_0x4988,0x84a69));const a550_0x189cbf=(function(){let _0x34a277=!![];return function(_0x1fbaa2,_0x5dbdbc){const _0x25099b=_0x34a277?function(){const _0x5c2e75=a550_0x4d37;if(_0x5dbdbc){const _0x517c3b=_0x5dbdbc[_0x5c2e75(0x1b9)](_0x1fbaa2,arguments);return _0x5dbdbc=null,_0x517c3b;}}:function(){};return _0x34a277=![],_0x25099b;};}()),a550_0xd55a8e=a550_0x189cbf(this,function(){const _0x2857c5=a550_0x4d37;return a550_0xd55a8e[_0x2857c5(0x19a)]()[_0x2857c5(0x1ac)](_0x2857c5(0x1b4))['toString']()[_0x2857c5(0x1a2)](a550_0xd55a8e)[_0x2857c5(0x1ac)](_0x2857c5(0x1b4));});function a550_0x4d37(_0x1ee5b0,_0x479f51){const _0x599cf8=a550_0x4988();return a550_0x4d37=function(_0xd55a8e,_0x189cbf){_0xd55a8e=_0xd55a8e-0x197;let _0x498853=_0x599cf8[_0xd55a8e];return _0x498853;},a550_0x4d37(_0x1ee5b0,_0x479f51);}a550_0xd55a8e();'use strict';var __importDefault=this&&this[a550_0x13496e(0x1a3)]||function(_0x38cb10){const _0x296c12=a550_0x13496e;return _0x38cb10&&_0x38cb10[_0x296c12(0x1b0)]?_0x38cb10:{'default':_0x38cb10};};function a550_0x4988(){const _0xa9ef59=['1160466JVhWyr','user','72IvUkYB','(((.+)+)+)+$','6090YcUZuv','create','ticket','2444277fqmCDG','apply','../../libs/socket','10EsPJtp','defineProperty','./FindOrCreateATicketTrakingService','2104794GNmfvy','3038750iKdUzP','whatsappId','toString','default','companyId','300005IeaKzP','68UASdpU','findByPk','../../errors/AppError','177YsTEYj','constructor','__importDefault','ERR_CREATING_TICKET','8bqlCLr','contact','queue','open','../../helpers/CheckContactOpenTickets','../../models/Ticket','927143wRaCZp','search','userId','../ContactServices/ShowContactService','update','__esModule'];a550_0x4988=function(){return _0xa9ef59;};return a550_0x4988();}Object[a550_0x13496e(0x1bc)](exports,a550_0x13496e(0x1b0),{'value':!![]});const AppError_1=__importDefault(require(a550_0x13496e(0x1a0))),CheckContactOpenTickets_1=__importDefault(require(a550_0x13496e(0x1a9))),GetDefaultWhatsApp_1=__importDefault(require('../../helpers/GetDefaultWhatsApp')),Ticket_1=__importDefault(require(a550_0x13496e(0x1aa))),ShowContactService_1=__importDefault(require(a550_0x13496e(0x1ae))),socket_1=require(a550_0x13496e(0x1ba)),FindOrCreateATicketTrakingService_1=__importDefault(require(a550_0x13496e(0x1bd))),CreateTicketService=async({contactId:_0x17c710,userId:_0x1d7411,queueId:_0x473009,companyId:_0x1d6643})=>{const _0xf860a1=a550_0x13496e,_0x28550c=await(0x0,GetDefaultWhatsApp_1[_0xf860a1(0x19b)])(_0x1d6643);await(0x0,CheckContactOpenTickets_1[_0xf860a1(0x19b)])(_0x17c710,_0x28550c['id']);const {isGroup:_0x470ead}=await(0x0,ShowContactService_1[_0xf860a1(0x19b)])(_0x17c710,_0x1d6643),{id:_0x2e9d18}=await Ticket_1[_0xf860a1(0x19b)][_0xf860a1(0x1b6)]({'contactId':_0x17c710,'companyId':_0x1d6643,'queueId':_0x473009,'whatsappId':_0x28550c['id'],'status':_0xf860a1(0x1a8),'isGroup':_0x470ead,'userId':_0x1d7411,'lastProcessedMessageId':null}),_0x3c2125=await Ticket_1[_0xf860a1(0x19b)][_0xf860a1(0x19f)](_0x2e9d18,{'include':[_0xf860a1(0x1a6),_0xf860a1(0x1a7),'whatsapp',_0xf860a1(0x1b2)]});if(!_0x3c2125)throw new AppError_1[(_0xf860a1(0x19b))](_0xf860a1(0x1a4));await(0x0,FindOrCreateATicketTrakingService_1[_0xf860a1(0x19b)])({'ticketId':_0x3c2125['id'],'companyId':_0x3c2125[_0xf860a1(0x19c)],'whatsappId':_0x3c2125[_0xf860a1(0x199)],'userId':_0x3c2125[_0xf860a1(0x1ad)]});const _0x174063=(0x0,socket_1['getIO'])();return _0x174063['to'](_0x3c2125['id']['toString']())['emit'](_0xf860a1(0x1b7),{'action':_0xf860a1(0x1af),'ticket':_0x3c2125}),_0x3c2125;};exports[a550_0x13496e(0x19b)]=CreateTicketService;