const a551_0x3fbe84=a551_0x592b;(function(_0x3690bd,_0x46f257){const _0x5a74d0=a551_0x592b,_0x1bd00c=_0x3690bd();while(!![]){try{const _0x2c5c1a=parseInt(_0x5a74d0(0x8d))/0x1*(-parseInt(_0x5a74d0(0x97))/0x2)+parseInt(_0x5a74d0(0xa0))/0x3*(-parseInt(_0x5a74d0(0x88))/0x4)+-parseInt(_0x5a74d0(0x8a))/0x5*(parseInt(_0x5a74d0(0x9e))/0x6)+-parseInt(_0x5a74d0(0x8e))/0x7+-parseInt(_0x5a74d0(0x95))/0x8*(parseInt(_0x5a74d0(0xa4))/0x9)+-parseInt(_0x5a74d0(0x8c))/0xa*(-parseInt(_0x5a74d0(0x90))/0xb)+parseInt(_0x5a74d0(0x83))/0xc;if(_0x2c5c1a===_0x46f257)break;else _0x1bd00c['push'](_0x1bd00c['shift']());}catch(_0x3cbc8f){_0x1bd00c['push'](_0x1bd00c['shift']());}}}(a551_0x5149,0xddd39));function a551_0x5149(){const _0x1899f1=['384wxxYTU','__esModule','1083RsuYEP','../../models/Ticket','./FindOrCreateATicketTrakingService','default','1249434PQYQbD','update','__importDefault','companyId','36229296IwWcpk','whatsappId','search','open','../../errors/AppError','5816mczcmG','create','109030xsrDmF','toString','2154250erwVBA','210358MkpdVH','10949715WBZplq','ticket','88fiXUia','ERR_CREATING_TICKET','../../helpers/CheckContactOpenTickets','queue','findByPk','8rZwJYP','../../libs/socket','2PcmOSk','user','emit','constructor','userId','getIO','(((.+)+)+)+$'];a551_0x5149=function(){return _0x1899f1;};return a551_0x5149();}const a551_0x5986f4=(function(){let _0x517e71=!![];return function(_0x47025e,_0x49693d){const _0x569919=_0x517e71?function(){if(_0x49693d){const _0x60300f=_0x49693d['apply'](_0x47025e,arguments);return _0x49693d=null,_0x60300f;}}:function(){};return _0x517e71=![],_0x569919;};}()),a551_0x534c6c=a551_0x5986f4(this,function(){const _0x2925b7=a551_0x592b;return a551_0x534c6c[_0x2925b7(0x8b)]()[_0x2925b7(0x85)](_0x2925b7(0x9d))[_0x2925b7(0x8b)]()[_0x2925b7(0x9a)](a551_0x534c6c)[_0x2925b7(0x85)](_0x2925b7(0x9d));});a551_0x534c6c();'use strict';function a551_0x592b(_0x328c52,_0x1ba7d2){const _0x5df6d1=a551_0x5149();return a551_0x592b=function(_0x534c6c,_0x5986f4){_0x534c6c=_0x534c6c-0x83;let _0x514986=_0x5df6d1[_0x534c6c];return _0x514986;},a551_0x592b(_0x328c52,_0x1ba7d2);}var __importDefault=this&&this[a551_0x3fbe84(0xa6)]||function(_0x2e9582){const _0x5e07d3=a551_0x3fbe84;return _0x2e9582&&_0x2e9582[_0x5e07d3(0x9f)]?_0x2e9582:{'default':_0x2e9582};};Object['defineProperty'](exports,a551_0x3fbe84(0x9f),{'value':!![]});const AppError_1=__importDefault(require(a551_0x3fbe84(0x87))),CheckContactOpenTickets_1=__importDefault(require(a551_0x3fbe84(0x92))),GetDefaultWhatsApp_1=__importDefault(require('../../helpers/GetDefaultWhatsApp')),Ticket_1=__importDefault(require(a551_0x3fbe84(0xa1))),ShowContactService_1=__importDefault(require('../ContactServices/ShowContactService')),socket_1=require(a551_0x3fbe84(0x96)),FindOrCreateATicketTrakingService_1=__importDefault(require(a551_0x3fbe84(0xa2))),CreateTicketService=async({contactId:_0x265c98,userId:_0x3f6538,queueId:_0x4ea827,companyId:_0xc908f9})=>{const _0x19342a=a551_0x3fbe84,_0x3ee02f=await(0x0,GetDefaultWhatsApp_1['default'])(_0xc908f9);await(0x0,CheckContactOpenTickets_1['default'])(_0x265c98,_0x3ee02f['id']);const {isGroup:_0x29c8f7}=await(0x0,ShowContactService_1['default'])(_0x265c98,_0xc908f9),{id:_0x399dca}=await Ticket_1[_0x19342a(0xa3)][_0x19342a(0x89)]({'contactId':_0x265c98,'companyId':_0xc908f9,'queueId':_0x4ea827,'whatsappId':_0x3ee02f['id'],'status':_0x19342a(0x86),'isGroup':_0x29c8f7,'userId':_0x3f6538,'lastProcessedMessageId':null}),_0x4a0845=await Ticket_1[_0x19342a(0xa3)][_0x19342a(0x94)](_0x399dca,{'include':['contact',_0x19342a(0x93),'whatsapp',_0x19342a(0x98)]});if(!_0x4a0845)throw new AppError_1['default'](_0x19342a(0x91));await(0x0,FindOrCreateATicketTrakingService_1[_0x19342a(0xa3)])({'ticketId':_0x4a0845['id'],'companyId':_0x4a0845[_0x19342a(0xa7)],'whatsappId':_0x4a0845[_0x19342a(0x84)],'userId':_0x4a0845[_0x19342a(0x9b)]});const _0x4bc934=(0x0,socket_1[_0x19342a(0x9c)])();return _0x4bc934['to'](_0x4a0845['id'][_0x19342a(0x8b)]())[_0x19342a(0x99)](_0x19342a(0x8f),{'action':_0x19342a(0xa5),'ticket':_0x4a0845}),_0x4a0845;};exports[a551_0x3fbe84(0xa3)]=CreateTicketService;