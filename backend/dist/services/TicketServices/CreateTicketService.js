const a513_0x49d3f5=a513_0x3c0e;(function(_0x8c011b,_0x33ba9a){const _0x40c8e5=a513_0x3c0e,_0x430304=_0x8c011b();while(!![]){try{const _0x18a2a4=-parseInt(_0x40c8e5(0x1c9))/0x1+parseInt(_0x40c8e5(0x1b8))/0x2*(-parseInt(_0x40c8e5(0x1b6))/0x3)+parseInt(_0x40c8e5(0x1b4))/0x4+parseInt(_0x40c8e5(0x1aa))/0x5*(-parseInt(_0x40c8e5(0x1b3))/0x6)+parseInt(_0x40c8e5(0x1a9))/0x7*(parseInt(_0x40c8e5(0x1b9))/0x8)+parseInt(_0x40c8e5(0x1c4))/0x9+parseInt(_0x40c8e5(0x1ab))/0xa;if(_0x18a2a4===_0x33ba9a)break;else _0x430304['push'](_0x430304['shift']());}catch(_0x812ee6){_0x430304['push'](_0x430304['shift']());}}}(a513_0x5341,0x2057a));function a513_0x3c0e(_0x177044,_0x5be142){const _0x58971f=a513_0x5341();return a513_0x3c0e=function(_0x58fb40,_0x3211c0){_0x58fb40=_0x58fb40-0x1a7;let _0x534196=_0x58971f[_0x58fb40];return _0x534196;},a513_0x3c0e(_0x177044,_0x5be142);}const a513_0x3211c0=(function(){let _0x39ed04=!![];return function(_0xd27a64,_0x2bb149){const _0x3caccd=_0x39ed04?function(){const _0x208083=a513_0x3c0e;if(_0x2bb149){const _0x8afa76=_0x2bb149[_0x208083(0x1a7)](_0xd27a64,arguments);return _0x2bb149=null,_0x8afa76;}}:function(){};return _0x39ed04=![],_0x3caccd;};}()),a513_0x58fb40=a513_0x3211c0(this,function(){const _0x9d013f=a513_0x3c0e;return a513_0x58fb40['toString']()[_0x9d013f(0x1b7)](_0x9d013f(0x1ae))[_0x9d013f(0x1c0)]()[_0x9d013f(0x1b2)](a513_0x58fb40)[_0x9d013f(0x1b7)](_0x9d013f(0x1ae));});a513_0x58fb40();'use strict';var __importDefault=this&&this[a513_0x49d3f5(0x1a8)]||function(_0x450054){const _0x420c61=a513_0x49d3f5;return _0x450054&&_0x450054[_0x420c61(0x1be)]?_0x450054:{'default':_0x450054};};function a513_0x5341(){const _0x3468bf=['findByPk','defineProperty','96860wwUXpZ','apply','__importDefault','3262bEXIjR','5KTtsHZ','822170WsyJVU','../WhatsappService/ShowWhatsAppService','open','(((.+)+)+)+$','default','queue','findOrCreate','constructor','10482EJNKRd','670696bAfyoT','ticket','158811PgBeaJ','search','10TqzUYO','3248IbzqLV','update','getIO','ERR_CREATING_TICKET','../../helpers/GetDefaultWhatsAppByUser','__esModule','../../helpers/GetDefaultWhatsApp','toString','../ContactServices/ShowContactService','../../helpers/CheckContactOpenTickets','../../libs/socket','510111WaZqEb','emit','../../models/Ticket'];a513_0x5341=function(){return _0x3468bf;};return a513_0x5341();}Object[a513_0x49d3f5(0x1c8)](exports,a513_0x49d3f5(0x1be),{'value':!![]});const AppError_1=__importDefault(require('../../errors/AppError')),CheckContactOpenTickets_1=__importDefault(require(a513_0x49d3f5(0x1c2))),GetDefaultWhatsApp_1=__importDefault(require(a513_0x49d3f5(0x1bf))),Ticket_1=__importDefault(require(a513_0x49d3f5(0x1c6))),ShowContactService_1=__importDefault(require(a513_0x49d3f5(0x1c1))),socket_1=require(a513_0x49d3f5(0x1c3)),GetDefaultWhatsAppByUser_1=__importDefault(require(a513_0x49d3f5(0x1bd))),ShowWhatsAppService_1=__importDefault(require(a513_0x49d3f5(0x1ac))),CreateTicketService=async({contactId:_0x1d39ce,status:_0xa1c983,userId:_0xbd6af2,queueId:_0x136785,companyId:_0x504187,whatsappId:_0x22911})=>{const _0x57f48c=a513_0x49d3f5;let _0x279b24;_0x22911!==undefined&&_0x22911!==null&&_0x22911!==''&&(_0x279b24=await(0x0,ShowWhatsAppService_1['default'])(_0x22911,_0x504187));let _0x44b1e8=await(0x0,GetDefaultWhatsAppByUser_1['default'])(_0xbd6af2);_0x279b24&&(_0x44b1e8=_0x279b24);if(!_0x44b1e8)_0x44b1e8=await(0x0,GetDefaultWhatsApp_1[_0x57f48c(0x1af)])(_0x504187);await(0x0,CheckContactOpenTickets_1['default'])(_0x1d39ce,_0x22911);const {isGroup:_0x1dabad}=await(0x0,ShowContactService_1[_0x57f48c(0x1af)])(_0x1d39ce,_0x504187),[{id:_0x36d758}]=await Ticket_1[_0x57f48c(0x1af)][_0x57f48c(0x1b1)]({'where':{'contactId':_0x1d39ce,'companyId':_0x504187,'whatsappId':_0x22911},'defaults':{'contactId':_0x1d39ce,'companyId':_0x504187,'whatsappId':_0x44b1e8['id'],'status':_0xa1c983,'isGroup':_0x1dabad,'userId':_0xbd6af2}});await Ticket_1[_0x57f48c(0x1af)][_0x57f48c(0x1ba)]({'companyId':_0x504187,'queueId':_0x136785,'userId':_0xbd6af2,'whatsappId':_0x44b1e8['id'],'status':_0x57f48c(0x1ad)},{'where':{'id':_0x36d758}});const _0xd5389=await Ticket_1['default'][_0x57f48c(0x1c7)](_0x36d758,{'include':['contact',_0x57f48c(0x1b0)]});if(!_0xd5389)throw new AppError_1[(_0x57f48c(0x1af))](_0x57f48c(0x1bc));const _0x44f6d2=(0x0,socket_1[_0x57f48c(0x1bb)])();return _0x44f6d2['to'](_0xd5389['id'][_0x57f48c(0x1c0)]())[_0x57f48c(0x1c5)](_0x57f48c(0x1b5),{'action':_0x57f48c(0x1ba),'ticket':_0xd5389}),_0xd5389;};exports[a513_0x49d3f5(0x1af)]=CreateTicketService;