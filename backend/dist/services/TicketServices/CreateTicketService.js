const a663_0x4a0db3=a663_0x32ff;function a663_0x32ff(_0x5c5045,_0xe52ee0){const _0x30e916=a663_0x29a1();return a663_0x32ff=function(_0x3a4ae0,_0x147195){_0x3a4ae0=_0x3a4ae0-0x140;let _0x29a18a=_0x30e916[_0x3a4ae0];return _0x29a18a;},a663_0x32ff(_0x5c5045,_0xe52ee0);}(function(_0x2f3f69,_0x4f085c){const _0x134017=a663_0x32ff,_0x5de714=_0x2f3f69();while(!![]){try{const _0x30cacb=parseInt(_0x134017(0x161))/0x1+-parseInt(_0x134017(0x155))/0x2*(-parseInt(_0x134017(0x15e))/0x3)+-parseInt(_0x134017(0x159))/0x4+parseInt(_0x134017(0x148))/0x5*(parseInt(_0x134017(0x15f))/0x6)+-parseInt(_0x134017(0x14d))/0x7*(-parseInt(_0x134017(0x140))/0x8)+parseInt(_0x134017(0x160))/0x9+-parseInt(_0x134017(0x15a))/0xa;if(_0x30cacb===_0x4f085c)break;else _0x5de714['push'](_0x5de714['shift']());}catch(_0x7d985c){_0x5de714['push'](_0x5de714['shift']());}}}(a663_0x29a1,0x1c3c6));const a663_0x147195=(function(){let _0x3cb175=!![];return function(_0xa8c184,_0x4af703){const _0x22fc86=_0x3cb175?function(){const _0x5453fb=a663_0x32ff;if(_0x4af703){const _0x19f2f4=_0x4af703[_0x5453fb(0x150)](_0xa8c184,arguments);return _0x4af703=null,_0x19f2f4;}}:function(){};return _0x3cb175=![],_0x22fc86;};}()),a663_0x3a4ae0=a663_0x147195(this,function(){const _0x417325=a663_0x32ff;return a663_0x3a4ae0['toString']()['search']('(((.+)+)+)+$')['toString']()['constructor'](a663_0x3a4ae0)[_0x417325(0x15c)](_0x417325(0x154));});a663_0x3a4ae0();'use strict';var __importDefault=this&&this[a663_0x4a0db3(0x14c)]||function(_0x30e197){return _0x30e197&&_0x30e197['__esModule']?_0x30e197:{'default':_0x30e197};};Object['defineProperty'](exports,a663_0x4a0db3(0x14e),{'value':!![]});const AppError_1=__importDefault(require(a663_0x4a0db3(0x15d))),CheckContactOpenTickets_1=__importDefault(require(a663_0x4a0db3(0x143))),GetDefaultWhatsApp_1=__importDefault(require(a663_0x4a0db3(0x15b))),Ticket_1=__importDefault(require('../../models/Ticket')),ShowContactService_1=__importDefault(require(a663_0x4a0db3(0x144))),socket_1=require(a663_0x4a0db3(0x146)),FindOrCreateATicketTrakingService_1=__importDefault(require(a663_0x4a0db3(0x147))),CreateTicketService=async({contactId:_0x272697,userId:_0x44fefb,queueId:_0x20ff92,companyId:_0x428b00})=>{const _0x46a913=a663_0x4a0db3,_0x229fe8=await(0x0,GetDefaultWhatsApp_1[_0x46a913(0x152)])(_0x428b00);await(0x0,CheckContactOpenTickets_1[_0x46a913(0x152)])(_0x272697,_0x229fe8['id']);const {isGroup:_0x5eb189}=await(0x0,ShowContactService_1[_0x46a913(0x152)])(_0x272697,_0x428b00),{id:_0x2b2179}=await Ticket_1[_0x46a913(0x152)][_0x46a913(0x141)]({'contactId':_0x272697,'companyId':_0x428b00,'queueId':_0x20ff92,'whatsappId':_0x229fe8['id'],'status':_0x46a913(0x158),'isGroup':_0x5eb189,'userId':_0x44fefb,'lastProcessedMessageId':null}),_0x348521=await Ticket_1[_0x46a913(0x152)][_0x46a913(0x14b)](_0x2b2179,{'include':[_0x46a913(0x157),'queue',_0x46a913(0x153),_0x46a913(0x14f)]});if(!_0x348521)throw new AppError_1[(_0x46a913(0x152))](_0x46a913(0x149));await(0x0,FindOrCreateATicketTrakingService_1['default'])({'ticketId':_0x348521['id'],'companyId':_0x348521[_0x46a913(0x142)],'whatsappId':_0x348521[_0x46a913(0x145)],'userId':_0x348521['userId']});const _0x194ebc=(0x0,socket_1['getIO'])();return _0x194ebc['to'](_0x348521['id'][_0x46a913(0x156)]())['emit'](_0x46a913(0x151),{'action':_0x46a913(0x14a),'ticket':_0x348521}),_0x348521;};exports[a663_0x4a0db3(0x152)]=CreateTicketService;function a663_0x29a1(){const _0x1d4fa0=['whatsapp','(((.+)+)+)+$','556QATxSH','toString','contact','open','213740WAaOdN','3404670KPFGup','../../helpers/GetDefaultWhatsApp','search','../../errors/AppError','1179GYcWTe','6CAepMX','1530063CZruxY','43274rBhvxj','80KjVFWU','create','companyId','../../helpers/CheckContactOpenTickets','../ContactServices/ShowContactService','whatsappId','../../libs/socket','./FindOrCreateATicketTrakingService','818455MtNjSr','ERR_CREATING_TICKET','update','findByPk','__importDefault','16331IngMpt','__esModule','user','apply','ticket','default'];a663_0x29a1=function(){return _0x1d4fa0;};return a663_0x29a1();}