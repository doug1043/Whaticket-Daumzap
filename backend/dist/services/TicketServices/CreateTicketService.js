const a555_0x1174b8=a555_0x874b;function a555_0x874b(_0x592a6e,_0x39309d){const _0x5b3cb8=a555_0x47dd();return a555_0x874b=function(_0x4f3b3f,_0x4989c4){_0x4f3b3f=_0x4f3b3f-0x1db;let _0x47dd4e=_0x5b3cb8[_0x4f3b3f];return _0x47dd4e;},a555_0x874b(_0x592a6e,_0x39309d);}(function(_0x24e355,_0x1ca689){const _0x1b8ea9=a555_0x874b,_0x209c6a=_0x24e355();while(!![]){try{const _0x36f112=parseInt(_0x1b8ea9(0x1e3))/0x1*(-parseInt(_0x1b8ea9(0x1f2))/0x2)+parseInt(_0x1b8ea9(0x1ef))/0x3*(-parseInt(_0x1b8ea9(0x1fb))/0x4)+parseInt(_0x1b8ea9(0x1f6))/0x5+-parseInt(_0x1b8ea9(0x1f1))/0x6+-parseInt(_0x1b8ea9(0x1ec))/0x7*(parseInt(_0x1b8ea9(0x1e2))/0x8)+-parseInt(_0x1b8ea9(0x1fe))/0x9*(parseInt(_0x1b8ea9(0x1e4))/0xa)+-parseInt(_0x1b8ea9(0x1fd))/0xb*(-parseInt(_0x1b8ea9(0x1f8))/0xc);if(_0x36f112===_0x1ca689)break;else _0x209c6a['push'](_0x209c6a['shift']());}catch(_0x115fd6){_0x209c6a['push'](_0x209c6a['shift']());}}}(a555_0x47dd,0x5b8a6));const a555_0x4989c4=(function(){let _0x2c08d6=!![];return function(_0x4e2417,_0x33944c){const _0x1b5601=_0x2c08d6?function(){const _0x4c86b0=a555_0x874b;if(_0x33944c){const _0x45d004=_0x33944c[_0x4c86b0(0x1df)](_0x4e2417,arguments);return _0x33944c=null,_0x45d004;}}:function(){};return _0x2c08d6=![],_0x1b5601;};}()),a555_0x4f3b3f=a555_0x4989c4(this,function(){const _0x30cc49=a555_0x874b;return a555_0x4f3b3f['toString']()[_0x30cc49(0x1fa)](_0x30cc49(0x1ff))['toString']()[_0x30cc49(0x1e0)](a555_0x4f3b3f)['search'](_0x30cc49(0x1ff));});function a555_0x47dd(){const _0x506041=['19115556LItKJR','../../libs/socket','search','160pPSuFs','queue','11pFkzal','576sBUKRu','(((.+)+)+)+$','userId','create','default','emit','open','apply','constructor','./FindOrCreateATicketTrakingService','888024pKmraM','3yjvcoJ','78950aoMzto','__importDefault','../ContactServices/ShowContactService','contact','findByPk','../../models/Ticket','../../helpers/GetDefaultWhatsApp','user','7OiFYiQ','ticket','whatsappId','39093fwgsQT','toString','1808622cIRLPk','100026ULvewC','whatsapp','../../helpers/CheckContactOpenTickets','companyId','1854930qybcoa','__esModule'];a555_0x47dd=function(){return _0x506041;};return a555_0x47dd();}a555_0x4f3b3f();'use strict';var __importDefault=this&&this[a555_0x1174b8(0x1e5)]||function(_0x3b9d7e){return _0x3b9d7e&&_0x3b9d7e['__esModule']?_0x3b9d7e:{'default':_0x3b9d7e};};Object['defineProperty'](exports,a555_0x1174b8(0x1f7),{'value':!![]});const AppError_1=__importDefault(require('../../errors/AppError')),CheckContactOpenTickets_1=__importDefault(require(a555_0x1174b8(0x1f4))),GetDefaultWhatsApp_1=__importDefault(require(a555_0x1174b8(0x1ea))),Ticket_1=__importDefault(require(a555_0x1174b8(0x1e9))),ShowContactService_1=__importDefault(require(a555_0x1174b8(0x1e6))),socket_1=require(a555_0x1174b8(0x1f9)),FindOrCreateATicketTrakingService_1=__importDefault(require(a555_0x1174b8(0x1e1))),CreateTicketService=async({contactId:_0x3269f7,userId:_0x3cff45,queueId:_0x27e4fd,companyId:_0x54affc})=>{const _0x8dfbca=a555_0x1174b8,_0x1e9445=await(0x0,GetDefaultWhatsApp_1[_0x8dfbca(0x1dc)])(_0x54affc);await(0x0,CheckContactOpenTickets_1[_0x8dfbca(0x1dc)])(_0x3269f7,_0x1e9445['id']);const {isGroup:_0x627a0c}=await(0x0,ShowContactService_1[_0x8dfbca(0x1dc)])(_0x3269f7,_0x54affc),{id:_0x2f76dc}=await Ticket_1[_0x8dfbca(0x1dc)][_0x8dfbca(0x1db)]({'contactId':_0x3269f7,'companyId':_0x54affc,'queueId':_0x27e4fd,'whatsappId':_0x1e9445['id'],'status':_0x8dfbca(0x1de),'isGroup':_0x627a0c,'userId':_0x3cff45,'lastProcessedMessageId':null}),_0x17d28c=await Ticket_1[_0x8dfbca(0x1dc)][_0x8dfbca(0x1e8)](_0x2f76dc,{'include':[_0x8dfbca(0x1e7),_0x8dfbca(0x1fc),_0x8dfbca(0x1f3),_0x8dfbca(0x1eb)]});if(!_0x17d28c)throw new AppError_1[(_0x8dfbca(0x1dc))]('ERR_CREATING_TICKET');await(0x0,FindOrCreateATicketTrakingService_1[_0x8dfbca(0x1dc)])({'ticketId':_0x17d28c['id'],'companyId':_0x17d28c[_0x8dfbca(0x1f5)],'whatsappId':_0x17d28c[_0x8dfbca(0x1ee)],'userId':_0x17d28c[_0x8dfbca(0x200)]});const _0xf9ab73=(0x0,socket_1['getIO'])();return _0xf9ab73['to'](_0x17d28c['id'][_0x8dfbca(0x1f0)]())[_0x8dfbca(0x1dd)](_0x8dfbca(0x1ed),{'action':'update','ticket':_0x17d28c}),_0x17d28c;};exports[a555_0x1174b8(0x1dc)]=CreateTicketService;