const a551_0x5c22ff=a551_0x17c8;(function(_0x3b90f8,_0x2cff23){const _0x33784c=a551_0x17c8,_0x1c5d8c=_0x3b90f8();while(!![]){try{const _0x262955=parseInt(_0x33784c(0xaf))/0x1+parseInt(_0x33784c(0x96))/0x2*(-parseInt(_0x33784c(0x9c))/0x3)+-parseInt(_0x33784c(0x9a))/0x4+parseInt(_0x33784c(0xb5))/0x5*(parseInt(_0x33784c(0xad))/0x6)+-parseInt(_0x33784c(0xab))/0x7*(-parseInt(_0x33784c(0xa8))/0x8)+parseInt(_0x33784c(0x98))/0x9+parseInt(_0x33784c(0xb3))/0xa*(-parseInt(_0x33784c(0x9d))/0xb);if(_0x262955===_0x2cff23)break;else _0x1c5d8c['push'](_0x1c5d8c['shift']());}catch(_0x2293da){_0x1c5d8c['push'](_0x1c5d8c['shift']());}}}(a551_0x10f5,0x9d9fb));const a551_0x41caba=(function(){let _0x176ef8=!![];return function(_0x4eca81,_0x573b92){const _0x41ea3d=_0x176ef8?function(){const _0x125e9f=a551_0x17c8;if(_0x573b92){const _0x275b61=_0x573b92[_0x125e9f(0x9f)](_0x4eca81,arguments);return _0x573b92=null,_0x275b61;}}:function(){};return _0x176ef8=![],_0x41ea3d;};}()),a551_0x5db0aa=a551_0x41caba(this,function(){const _0x448c07=a551_0x17c8;return a551_0x5db0aa[_0x448c07(0xb4)]()[_0x448c07(0xa6)]('(((.+)+)+)+$')['toString']()[_0x448c07(0xa5)](a551_0x5db0aa)[_0x448c07(0xa6)](_0x448c07(0xa9));});a551_0x5db0aa();function a551_0x10f5(){const _0x5ea79e=['ERR_CREATING_TICKET','675184bzOcYa','default','935679RMPXlp','11ZBSZEX','update','apply','ticket','../../models/Ticket','../../helpers/CheckContactOpenTickets','__esModule','queue','constructor','search','whatsappId','8dUDyeT','(((.+)+)+)+$','defineProperty','2362038wAGVnJ','user','42dlFeAn','companyId','559816CtRgxP','../../helpers/GetDefaultWhatsApp','./FindOrCreateATicketTrakingService','open','1185020kLgdXj','toString','211595vGcrUS','getIO','../../errors/AppError','create','userId','2NYUqDD','__importDefault','462015CNYxqS'];a551_0x10f5=function(){return _0x5ea79e;};return a551_0x10f5();}function a551_0x17c8(_0x3d1779,_0x47ce2f){const _0x8841a1=a551_0x10f5();return a551_0x17c8=function(_0x5db0aa,_0x41caba){_0x5db0aa=_0x5db0aa-0x96;let _0x10f5c5=_0x8841a1[_0x5db0aa];return _0x10f5c5;},a551_0x17c8(_0x3d1779,_0x47ce2f);}'use strict';var __importDefault=this&&this[a551_0x5c22ff(0x97)]||function(_0x4acf3a){return _0x4acf3a&&_0x4acf3a['__esModule']?_0x4acf3a:{'default':_0x4acf3a};};Object[a551_0x5c22ff(0xaa)](exports,a551_0x5c22ff(0xa3),{'value':!![]});const AppError_1=__importDefault(require(a551_0x5c22ff(0xb7))),CheckContactOpenTickets_1=__importDefault(require(a551_0x5c22ff(0xa2))),GetDefaultWhatsApp_1=__importDefault(require(a551_0x5c22ff(0xb0))),Ticket_1=__importDefault(require(a551_0x5c22ff(0xa1))),ShowContactService_1=__importDefault(require('../ContactServices/ShowContactService')),socket_1=require('../../libs/socket'),FindOrCreateATicketTrakingService_1=__importDefault(require(a551_0x5c22ff(0xb1))),CreateTicketService=async({contactId:_0x1f319b,userId:_0x248a88,queueId:_0x36cd02,companyId:_0x1c91a8})=>{const _0x4d9bdd=a551_0x5c22ff,_0x314f4c=await(0x0,GetDefaultWhatsApp_1[_0x4d9bdd(0x9b)])(_0x1c91a8);await(0x0,CheckContactOpenTickets_1[_0x4d9bdd(0x9b)])(_0x1f319b,_0x314f4c['id']);const {isGroup:_0x50eac3}=await(0x0,ShowContactService_1[_0x4d9bdd(0x9b)])(_0x1f319b,_0x1c91a8),{id:_0x1dbe91}=await Ticket_1[_0x4d9bdd(0x9b)][_0x4d9bdd(0xb8)]({'contactId':_0x1f319b,'companyId':_0x1c91a8,'queueId':_0x36cd02,'whatsappId':_0x314f4c['id'],'status':_0x4d9bdd(0xb2),'isGroup':_0x50eac3,'userId':_0x248a88,'lastProcessedMessageId':null}),_0x4b113e=await Ticket_1['default']['findByPk'](_0x1dbe91,{'include':['contact',_0x4d9bdd(0xa4),'whatsapp',_0x4d9bdd(0xac)]});if(!_0x4b113e)throw new AppError_1[(_0x4d9bdd(0x9b))](_0x4d9bdd(0x99));await(0x0,FindOrCreateATicketTrakingService_1[_0x4d9bdd(0x9b)])({'ticketId':_0x4b113e['id'],'companyId':_0x4b113e[_0x4d9bdd(0xae)],'whatsappId':_0x4b113e[_0x4d9bdd(0xa7)],'userId':_0x4b113e[_0x4d9bdd(0xb9)]});const _0x18af26=(0x0,socket_1[_0x4d9bdd(0xb6)])();return _0x18af26['to'](_0x4b113e['id'][_0x4d9bdd(0xb4)]())['emit'](_0x4d9bdd(0xa0),{'action':_0x4d9bdd(0x9e),'ticket':_0x4b113e}),_0x4b113e;};exports[a551_0x5c22ff(0x9b)]=CreateTicketService;