const a664_0x5a02cd=a664_0x36a6;function a664_0x36a6(_0x5526e7,_0x23bb32){const _0x50279b=a664_0x2385();return a664_0x36a6=function(_0x370590,_0x22f8c4){_0x370590=_0x370590-0x1db;let _0x23856a=_0x50279b[_0x370590];return _0x23856a;},a664_0x36a6(_0x5526e7,_0x23bb32);}(function(_0x5587a4,_0x59a392){const _0x154ce5=a664_0x36a6,_0x4f373b=_0x5587a4();while(!![]){try{const _0x5accd8=parseInt(_0x154ce5(0x1e3))/0x1*(parseInt(_0x154ce5(0x1e1))/0x2)+-parseInt(_0x154ce5(0x1e5))/0x3*(-parseInt(_0x154ce5(0x1f0))/0x4)+-parseInt(_0x154ce5(0x1ee))/0x5+parseInt(_0x154ce5(0x1e0))/0x6*(-parseInt(_0x154ce5(0x1f2))/0x7)+parseInt(_0x154ce5(0x1df))/0x8*(parseInt(_0x154ce5(0x1dc))/0x9)+-parseInt(_0x154ce5(0x1e6))/0xa*(parseInt(_0x154ce5(0x1ef))/0xb)+parseInt(_0x154ce5(0x1f3))/0xc;if(_0x5accd8===_0x59a392)break;else _0x4f373b['push'](_0x4f373b['shift']());}catch(_0x1e91e2){_0x4f373b['push'](_0x4f373b['shift']());}}}(a664_0x2385,0x3f59e));const a664_0x22f8c4=(function(){let _0x179a3f=!![];return function(_0x4034c8,_0xc4fbe8){const _0x39ad53=_0x179a3f?function(){const _0x494a27=a664_0x36a6;if(_0xc4fbe8){const _0x53b10c=_0xc4fbe8[_0x494a27(0x1dd)](_0x4034c8,arguments);return _0xc4fbe8=null,_0x53b10c;}}:function(){};return _0x179a3f=![],_0x39ad53;};}()),a664_0x370590=a664_0x22f8c4(this,function(){const _0x2bf862=a664_0x36a6;return a664_0x370590[_0x2bf862(0x1de)]()[_0x2bf862(0x1ed)](_0x2bf862(0x1f1))[_0x2bf862(0x1de)]()[_0x2bf862(0x1f4)](a664_0x370590)[_0x2bf862(0x1ed)](_0x2bf862(0x1f1));});a664_0x370590();'use strict';var __importDefault=this&&this['__importDefault']||function(_0x495a37){const _0x38f3dc=a664_0x36a6;return _0x495a37&&_0x495a37[_0x38f3dc(0x1ec)]?_0x495a37:{'default':_0x495a37};};function a664_0x2385(){const _0x4f84e8=['contact','emit','__esModule','search','1817405DTPXFp','2585gbVqIp','16cLMsrm','(((.+)+)+)+$','1364965HQRLmA','1829556aDJUbF','constructor','../../errors/AppError','update','../../models/Ticket','getIO','144378WpQMVl','apply','toString','176plskuA','6MiSgfx','125404KaMGBK','ERR_CREATING_TICKET','2eSfIOJ','ticket','236082Eqajlo','5430ogAuls','default','../../helpers/CheckContactOpenTickets','../../helpers/GetDefaultWhatsApp'];a664_0x2385=function(){return _0x4f84e8;};return a664_0x2385();}Object['defineProperty'](exports,'__esModule',{'value':!![]});const AppError_1=__importDefault(require(a664_0x5a02cd(0x1f5))),CheckContactOpenTickets_1=__importDefault(require(a664_0x5a02cd(0x1e8))),GetDefaultWhatsApp_1=__importDefault(require(a664_0x5a02cd(0x1e9))),Ticket_1=__importDefault(require(a664_0x5a02cd(0x1f7))),socket_1=require('../../libs/socket'),CreateTicketServiceWebhook=async({contactId:_0x17ec35,status:_0x4014d8,userId:_0xf9d3d1,whatsappId:_0x55e24a,queueId:_0x11ab24,companyId:_0x162922,lastFlowId:_0xea5339,dataWebhook:_0x579129,hashFlowId:_0x42bfe7,flowStopped:_0x5e8472})=>{const _0x35ce70=a664_0x5a02cd,_0x37900d=await(0x0,GetDefaultWhatsApp_1[_0x35ce70(0x1e7)])(_0x162922),_0x24c36f=await(0x0,CheckContactOpenTickets_1[_0x35ce70(0x1e7)])(_0x17ec35,_0x55e24a||_0x37900d['id'],!![]),_0x4356fe=![],[{id:_0x36cd4f}]=await Ticket_1['default']['findOrCreate']({'where':{'contactId':_0x17ec35,'companyId':_0x162922},'defaults':{'contactId':_0x17ec35,'companyId':_0x162922,'whatsappId':_0x37900d['id'],'status':_0x4014d8,'isGroup':_0x4356fe,'userId':_0xf9d3d1,'flowWebhook':!![],'dataWebhook':_0x579129,'hashFlowId':_0x42bfe7,'flowStopped':_0x5e8472}});await Ticket_1[_0x35ce70(0x1e7)][_0x35ce70(0x1f6)]({'companyId':_0x162922,'queueId':_0x11ab24,'userId':_0xf9d3d1,'whatsappId':_0x37900d['id'],'status':'open','flowWebhook':!![],'lastFlowId':_0xea5339,'flowStopped':_0x5e8472},{'where':{'id':_0x36cd4f}});const _0x2e8ca3=await Ticket_1['default']['findByPk'](_0x36cd4f,{'include':[_0x35ce70(0x1ea),'queue']});if(!_0x2e8ca3)throw new AppError_1[(_0x35ce70(0x1e7))](_0x35ce70(0x1e2));const _0x7ff758=(0x0,socket_1[_0x35ce70(0x1db)])();return _0x7ff758['to'](_0x2e8ca3['id'][_0x35ce70(0x1de)]())[_0x35ce70(0x1eb)](_0x35ce70(0x1e4),{'action':_0x35ce70(0x1f6),'ticket':_0x2e8ca3}),_0x2e8ca3;};exports[a664_0x5a02cd(0x1e7)]=CreateTicketServiceWebhook;