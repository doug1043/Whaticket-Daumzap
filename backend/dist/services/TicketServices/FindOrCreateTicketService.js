const a523_0x220d75=a523_0x4594;(function(_0x4d16ee,_0x5e1e46){const _0x374a0a=a523_0x4594,_0x22fa3a=_0x4d16ee();while(!![]){try{const _0x543978=parseInt(_0x374a0a(0x19e))/0x1*(-parseInt(_0x374a0a(0x17b))/0x2)+parseInt(_0x374a0a(0x17e))/0x3*(-parseInt(_0x374a0a(0x195))/0x4)+parseInt(_0x374a0a(0x17f))/0x5+parseInt(_0x374a0a(0x186))/0x6*(-parseInt(_0x374a0a(0x19b))/0x7)+parseInt(_0x374a0a(0x1a0))/0x8*(-parseInt(_0x374a0a(0x193))/0x9)+parseInt(_0x374a0a(0x191))/0xa+-parseInt(_0x374a0a(0x182))/0xb*(-parseInt(_0x374a0a(0x18a))/0xc);if(_0x543978===_0x5e1e46)break;else _0x22fa3a['push'](_0x22fa3a['shift']());}catch(_0x89e3e){_0x22fa3a['push'](_0x22fa3a['shift']());}}}(a523_0x3c1e,0x5d7ca));const a523_0x5c535f=(function(){let _0x543183=!![];return function(_0x431f7d,_0x2311e9){const _0x18e788=_0x543183?function(){const _0x1c09ab=a523_0x4594;if(_0x2311e9){const _0xcf70e7=_0x2311e9[_0x1c09ab(0x198)](_0x431f7d,arguments);return _0x2311e9=null,_0xcf70e7;}}:function(){};return _0x543183=![],_0x18e788;};}()),a523_0x1897bd=a523_0x5c535f(this,function(){const _0x234968=a523_0x4594;return a523_0x1897bd['toString']()[_0x234968(0x180)](_0x234968(0x194))[_0x234968(0x192)]()['constructor'](a523_0x1897bd)[_0x234968(0x180)](_0x234968(0x194));});function a523_0x4594(_0x41513f,_0x3b896a){const _0xdac825=a523_0x3c1e();return a523_0x4594=function(_0x1897bd,_0x5c535f){_0x1897bd=_0x1897bd-0x179;let _0x3c1efc=_0xdac825[_0x1897bd];return _0x3c1efc;},a523_0x4594(_0x41513f,_0x3b896a);}a523_0x1897bd();'use strict';var __importDefault=this&&this['__importDefault']||function(_0x19e74e){const _0x2b8bbd=a523_0x4594;return _0x19e74e&&_0x19e74e[_0x2b8bbd(0x1a1)]?_0x19e74e:{'default':_0x19e74e};};Object[a523_0x220d75(0x188)](exports,'__esModule',{'value':!![]});const date_fns_1=require(a523_0x220d75(0x17a)),sequelize_1=require(a523_0x220d75(0x196)),Ticket_1=__importDefault(require(a523_0x220d75(0x18e))),ShowTicketService_1=__importDefault(require('./ShowTicketService')),FindOrCreateATicketTrakingService_1=__importDefault(require(a523_0x220d75(0x18b))),Setting_1=__importDefault(require(a523_0x220d75(0x18d))),Whatsapp_1=__importDefault(require(a523_0x220d75(0x189))),FindOrCreateTicketService=async(_0x948869,_0x3a602c,_0x52724c,_0x2540d4,_0x10cde6,_0x19ebf2)=>{const _0xf07593=a523_0x220d75;let _0x1bf404=await Ticket_1[_0xf07593(0x199)]['findOne']({'where':{'status':{[sequelize_1['Op']['or']]:[_0xf07593(0x18f),_0xf07593(0x187),_0xf07593(0x19d)]},'contactId':_0x10cde6?_0x10cde6['id']:_0x948869['id'],'companyId':_0x2540d4,'whatsappId':_0x3a602c},'order':[['id',_0xf07593(0x19f)]]});_0x1bf404&&(_0x1bf404[_0xf07593(0x181)]===_0xf07593(0x19d)?await _0x1bf404['update']({'unreadMessages':_0x52724c,'whatsappId':_0x3a602c,'queueId':null,'userId':null,'status':_0xf07593(0x187),'imported':_0x19ebf2?new Date():null}):await _0x1bf404[_0xf07593(0x179)]({'unreadMessages':_0x52724c,'whatsappId':_0x3a602c,'imported':_0x19ebf2?new Date():null}));if(!_0x1bf404&&_0x10cde6){_0x1bf404=await Ticket_1[_0xf07593(0x199)][_0xf07593(0x184)]({'where':{'contactId':_0x10cde6['id'],'whatsappId':_0x3a602c},'order':[[_0xf07593(0x197),_0xf07593(0x19f)]]});_0x1bf404&&(await _0x1bf404['update']({'status':_0xf07593(0x187),'imported':_0x19ebf2?new Date():null,'userId':null,'unreadMessages':_0x52724c,'isGroup':_0x948869['isGroup'],'whatsappId':_0x3a602c,'queueId':null,'companyId':_0x2540d4}),await(0x0,FindOrCreateATicketTrakingService_1[_0xf07593(0x199)])({'ticketId':_0x1bf404['id'],'companyId':_0x2540d4,'whatsappId':_0x1bf404[_0xf07593(0x18c)],'userId':_0x1bf404[_0xf07593(0x19a)]}));const _0x2e4136=await Setting_1[_0xf07593(0x199)]['findOne']({'where':{'key':_0xf07593(0x17c)}}),_0x541740=_0x2e4136?parseInt(_0x2e4136[_0xf07593(0x190)],0xa):0x1c20;}!_0x1bf404&&!_0x10cde6&&(_0x1bf404=await Ticket_1[_0xf07593(0x199)][_0xf07593(0x184)]({'where':{'updatedAt':{[sequelize_1['Op'][_0xf07593(0x185)]]:[+(0x0,date_fns_1[_0xf07593(0x17d)])(new Date(),0x2),+new Date()]},'contactId':_0x948869['id'],'whatsappId':_0x3a602c},'order':[['updatedAt',_0xf07593(0x19f)]]}),_0x1bf404&&(await _0x1bf404['update']({'status':_0xf07593(0x187),'imported':_0x19ebf2?new Date():null,'userId':null,'isGroup':_0x948869[_0xf07593(0x183)],'unreadMessages':_0x52724c,'whatsappId':_0x3a602c,'queueId':null,'companyId':_0x2540d4}),await(0x0,FindOrCreateATicketTrakingService_1[_0xf07593(0x199)])({'ticketId':_0x1bf404['id'],'companyId':_0x2540d4,'whatsappId':_0x1bf404[_0xf07593(0x18c)],'userId':_0x1bf404[_0xf07593(0x19a)]})));if(!_0x1bf404){const _0x4ec093=await Whatsapp_1[_0xf07593(0x199)]['findOne']({'where':{'id':_0x3a602c}});_0x1bf404=await Ticket_1[_0xf07593(0x199)][_0xf07593(0x19c)]({'imported':_0x19ebf2?new Date():null,'contactId':_0x10cde6?_0x10cde6['id']:_0x948869['id'],'status':_0xf07593(0x187),'isGroup':!!_0x10cde6||_0x948869[_0xf07593(0x183)],'unreadMessages':_0x52724c,'whatsappId':_0x3a602c,'whatsapp':_0x4ec093,'companyId':_0x2540d4}),await(0x0,FindOrCreateATicketTrakingService_1[_0xf07593(0x199)])({'ticketId':_0x1bf404['id'],'companyId':_0x2540d4,'whatsappId':_0x3a602c,'userId':_0x1bf404[_0xf07593(0x19a)]});}return _0x1bf404=await(0x0,ShowTicketService_1[_0xf07593(0x199)])(_0x1bf404['id'],_0x2540d4),_0x1bf404;};function a523_0x3c1e(){const _0x500c1e=['update','date-fns','72060zVrNWG','timeCreateNewTicket','subHours','159gDinjT','824545VoKiDv','search','status','131494ncELMM','isGroup','findOne','between','426DPQYNv','pending','defineProperty','../../models/Whatsapp','1392PDIeHr','./FindOrCreateATicketTrakingService','whatsappId','../../models/Setting','../../models/Ticket','open','value','3140320uCwkAz','toString','9iqkKHN','(((.+)+)+)+$','56148xUYmib','sequelize','updatedAt','apply','default','userId','67333SlAskG','create','closed','1cWGIyS','DESC','157944rnXEbF','__esModule'];a523_0x3c1e=function(){return _0x500c1e;};return a523_0x3c1e();}exports['default']=FindOrCreateTicketService;