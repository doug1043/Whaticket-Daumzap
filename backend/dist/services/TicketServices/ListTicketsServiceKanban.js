function a518_0x2209(_0x462584,_0x51d553){const _0x41745f=a518_0x2d94();return a518_0x2209=function(_0x17f7ec,_0x573dcf){_0x17f7ec=_0x17f7ec-0xdd;let _0x2d94a8=_0x41745f[_0x17f7ec];return _0x2d94a8;},a518_0x2209(_0x462584,_0x51d553);}const a518_0x354cb9=a518_0x2209;(function(_0x15ea27,_0x1d7a93){const _0x387ee1=a518_0x2209,_0xbd6923=_0x15ea27();while(!![]){try{const _0x44ae8b=-parseInt(_0x387ee1(0x118))/0x1*(-parseInt(_0x387ee1(0x107))/0x2)+parseInt(_0x387ee1(0xf4))/0x3+parseInt(_0x387ee1(0xfb))/0x4*(-parseInt(_0x387ee1(0x104))/0x5)+-parseInt(_0x387ee1(0xed))/0x6*(-parseInt(_0x387ee1(0xee))/0x7)+-parseInt(_0x387ee1(0xf3))/0x8*(-parseInt(_0x387ee1(0xef))/0x9)+parseInt(_0x387ee1(0x119))/0xa+parseInt(_0x387ee1(0x10b))/0xb*(-parseInt(_0x387ee1(0x11b))/0xc);if(_0x44ae8b===_0x1d7a93)break;else _0xbd6923['push'](_0xbd6923['shift']());}catch(_0x38cb05){_0xbd6923['push'](_0xbd6923['shift']());}}}(a518_0x2d94,0xf09c4));const a518_0x573dcf=(function(){let _0x378336=!![];return function(_0x46bc1c,_0xf23057){const _0xab5008=_0x378336?function(){const _0x3dabdc=a518_0x2209;if(_0xf23057){const _0x5ce05b=_0xf23057[_0x3dabdc(0xe7)](_0x46bc1c,arguments);return _0xf23057=null,_0x5ce05b;}}:function(){};return _0x378336=![],_0xab5008;};}()),a518_0x17f7ec=a518_0x573dcf(this,function(){const _0x5eaa36=a518_0x2209;return a518_0x17f7ec[_0x5eaa36(0xf5)]()[_0x5eaa36(0xf0)](_0x5eaa36(0x10f))['toString']()[_0x5eaa36(0xfc)](a518_0x17f7ec)['search']('(((.+)+)+)+$');});a518_0x17f7ec();'use strict';var __importDefault=this&&this[a518_0x354cb9(0xdd)]||function(_0xb72ed6){const _0x160da2=a518_0x354cb9;return _0xb72ed6&&_0xb72ed6[_0x160da2(0x106)]?_0xb72ed6:{'default':_0xb72ed6};};Object[a518_0x354cb9(0xe2)](exports,a518_0x354cb9(0x106),{'value':!![]});const sequelize_1=require(a518_0x354cb9(0xdf)),date_fns_1=require(a518_0x354cb9(0x108)),Ticket_1=__importDefault(require(a518_0x354cb9(0xf1))),Contact_1=__importDefault(require(a518_0x354cb9(0xe0))),Message_1=__importDefault(require(a518_0x354cb9(0xf9))),Queue_1=__importDefault(require('../../models/Queue')),User_1=__importDefault(require('../../models/User')),ShowUserService_1=__importDefault(require(a518_0x354cb9(0x10e))),Tag_1=__importDefault(require(a518_0x354cb9(0x112))),TicketTag_1=__importDefault(require('../../models/TicketTag')),lodash_1=require(a518_0x354cb9(0xe9)),Whatsapp_1=__importDefault(require(a518_0x354cb9(0x100))),ListTicketsServiceKanban=async({searchParam:searchParam='',pageNumber:pageNumber='1',queueIds:_0x3ae6c7,tags:_0x1428f7,users:_0x46300b,status:_0xb8ec47,date:_0x3bbc13,updatedAt:_0x5e293f,showAll:_0x25ec93,userId:_0x4786e2,withUnreadMessages:_0x51c190,companyId:_0x7d1200})=>{const _0x3eff68=a518_0x354cb9;let _0x251b72={[sequelize_1['Op']['or']]:[{'userId':_0x4786e2},{'status':'pending'}],'queueId':{[sequelize_1['Op']['or']]:[_0x3ae6c7,null]}},_0x6f61bb;_0x6f61bb=[{'model':Contact_1[_0x3eff68(0xec)],'as':_0x3eff68(0x109),'attributes':['id',_0x3eff68(0x102),_0x3eff68(0xff),'email',_0x3eff68(0xfa)]},{'model':Queue_1[_0x3eff68(0xec)],'as':_0x3eff68(0x116),'attributes':['id',_0x3eff68(0x102),_0x3eff68(0xf6)]},{'model':User_1[_0x3eff68(0xec)],'as':_0x3eff68(0x10a),'attributes':['id',_0x3eff68(0x102)]},{'model':Tag_1[_0x3eff68(0xec)],'as':_0x3eff68(0xeb),'attributes':['id',_0x3eff68(0x102),_0x3eff68(0xf6)]},{'model':Whatsapp_1[_0x3eff68(0xec)],'as':_0x3eff68(0xe1),'attributes':[_0x3eff68(0x102)]}];_0x25ec93===_0x3eff68(0xf8)&&(_0x251b72={'queueId':{[sequelize_1['Op']['or']]:[_0x3ae6c7,null]},'userId':_0x4786e2});_0x251b72={..._0x251b72,'status':{[sequelize_1['Op']['or']]:[_0x3eff68(0x115),_0x3eff68(0xea)]}};if(searchParam){const _0x213557=searchParam[_0x3eff68(0xfd)]()['trim']();_0x6f61bb=[..._0x6f61bb,{'model':Message_1[_0x3eff68(0xec)],'as':'messages','attributes':['id',_0x3eff68(0xe5)],'where':{'body':(0x0,sequelize_1[_0x3eff68(0x105)])((0x0,sequelize_1['fn'])(_0x3eff68(0x113),(0x0,sequelize_1[_0x3eff68(0xfe)])(_0x3eff68(0xe5))),_0x3eff68(0xf2),'%'+_0x213557+'%')},'required':![],'duplicating':![]}],_0x251b72={..._0x251b72,[sequelize_1['Op']['or']]:[{'$contact.name$':(0x0,sequelize_1[_0x3eff68(0x105)])((0x0,sequelize_1['fn'])('LOWER',(0x0,sequelize_1[_0x3eff68(0xfe)])(_0x3eff68(0x117))),'LIKE','%'+_0x213557+'%')},{'$contact.number$':{[sequelize_1['Op'][_0x3eff68(0xf7)]]:'%'+_0x213557+'%'}},{'$message.body$':(0x0,sequelize_1[_0x3eff68(0x105)])((0x0,sequelize_1['fn'])(_0x3eff68(0x113),(0x0,sequelize_1[_0x3eff68(0xfe)])(_0x3eff68(0xe5))),_0x3eff68(0xf2),'%'+_0x213557+'%')}]};}_0x3bbc13&&(_0x251b72={'createdAt':{[sequelize_1['Op']['between']]:[+(0x0,date_fns_1[_0x3eff68(0x111)])((0x0,date_fns_1[_0x3eff68(0xe8)])(_0x3bbc13)),+(0x0,date_fns_1[_0x3eff68(0x11c)])((0x0,date_fns_1['parseISO'])(_0x3bbc13))]}});_0x5e293f&&(_0x251b72={'updatedAt':{[sequelize_1['Op'][_0x3eff68(0x11a)]]:[+(0x0,date_fns_1['startOfDay'])((0x0,date_fns_1[_0x3eff68(0xe8)])(_0x5e293f)),+(0x0,date_fns_1[_0x3eff68(0x11c)])((0x0,date_fns_1['parseISO'])(_0x5e293f))]}});if(_0x51c190==='true'){const _0x2fcb50=await(0x0,ShowUserService_1['default'])(_0x4786e2),_0x17dcb=_0x2fcb50[_0x3eff68(0x101)][_0x3eff68(0x103)](_0x1efcf0=>_0x1efcf0['id']);_0x251b72={[sequelize_1['Op']['or']]:[{'userId':_0x4786e2},{'status':_0x3eff68(0x115)}],'queueId':{[sequelize_1['Op']['or']]:[_0x17dcb,null]},'unreadMessages':{[sequelize_1['Op']['gt']]:0x0}};}if(Array[_0x3eff68(0xde)](_0x1428f7)&&_0x1428f7[_0x3eff68(0x10c)]>0x0){const _0x124cf7=[];for(let _0x2a2a57 of _0x1428f7){const _0x40669f=await TicketTag_1[_0x3eff68(0xec)]['findAll']({'where':{'tagId':_0x2a2a57}});_0x40669f&&_0x124cf7[_0x3eff68(0xe3)](_0x40669f[_0x3eff68(0x103)](_0x57258b=>_0x57258b['ticketId']));}const _0x25ebff=(0x0,lodash_1[_0x3eff68(0x10d)])(..._0x124cf7);_0x251b72={..._0x251b72,'id':{[sequelize_1['Op']['in']]:_0x25ebff}};}if(Array[_0x3eff68(0xde)](_0x46300b)&&_0x46300b[_0x3eff68(0x10c)]>0x0){const _0x18ba38=[];for(let _0x43daab of _0x46300b){const _0x563a0a=await Ticket_1[_0x3eff68(0xec)][_0x3eff68(0xe6)]({'where':{'userId':_0x43daab}});_0x563a0a&&_0x18ba38['push'](_0x563a0a[_0x3eff68(0x103)](_0x31b59c=>_0x31b59c['id']));}const _0xb64332=(0x0,lodash_1[_0x3eff68(0x10d)])(..._0x18ba38);_0x251b72={..._0x251b72,'id':{[sequelize_1['Op']['in']]:_0xb64332}};}const _0x5929cf=0x28,_0x428f92=_0x5929cf*(+pageNumber-0x1);_0x251b72={..._0x251b72,'companyId':_0x7d1200};const {count:_0x4d4604,rows:_0x7954bd}=await Ticket_1[_0x3eff68(0xec)][_0x3eff68(0xe4)]({'where':_0x251b72,'include':_0x6f61bb,'distinct':!![],'limit':_0x5929cf,'offset':_0x428f92,'order':[[_0x3eff68(0x114),_0x3eff68(0x110)]],'subQuery':![]}),_0x32965a=_0x4d4604>_0x428f92+_0x7954bd['length'];return{'tickets':_0x7954bd,'count':_0x4d4604,'hasMore':_0x32965a};};function a518_0x2d94(){const _0x1bdc04=['queue','contact.name','22363CmaRaa','17531540IDsexw','between','46318212CsTuCK','endOfDay','__importDefault','isArray','sequelize','../../models/Contact','whatsapp','defineProperty','push','findAndCountAll','body','findAll','apply','parseISO','lodash','open','tags','default','53064wsqIDi','1008vyAAxe','2700FXsyCX','search','../../models/Ticket','LIKE','52232PpmFkQ','281142yXSKct','toString','color','like','true','../../models/Message','presence','56436svFrFd','constructor','toLocaleLowerCase','col','number','../../models/Whatsapp','queues','name','map','170ajGStG','where','__esModule','22WGrhRX','date-fns','contact','user','11EOgJda','length','intersection','../UserServices/ShowUserService','(((.+)+)+)+$','DESC','startOfDay','../../models/Tag','LOWER','updatedAt','pending'];a518_0x2d94=function(){return _0x1bdc04;};return a518_0x2d94();}exports[a518_0x354cb9(0xec)]=ListTicketsServiceKanban;