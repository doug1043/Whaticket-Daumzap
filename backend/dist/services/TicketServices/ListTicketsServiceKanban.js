const a555_0x85c788=a555_0xc7c8;(function(_0x465abb,_0x66f228){const _0x51a239=a555_0xc7c8,_0x261339=_0x465abb();while(!![]){try{const _0x371482=-parseInt(_0x51a239(0x16d))/0x1+parseInt(_0x51a239(0x17f))/0x2+-parseInt(_0x51a239(0x169))/0x3+parseInt(_0x51a239(0x181))/0x4*(-parseInt(_0x51a239(0x167))/0x5)+-parseInt(_0x51a239(0x185))/0x6+parseInt(_0x51a239(0x186))/0x7+parseInt(_0x51a239(0x184))/0x8;if(_0x371482===_0x66f228)break;else _0x261339['push'](_0x261339['shift']());}catch(_0x362537){_0x261339['push'](_0x261339['shift']());}}}(a555_0x3598,0xe824b));const a555_0x2007a7=(function(){let _0xc7cf2=!![];return function(_0x2619df,_0x5b877b){const _0x1abc42=_0xc7cf2?function(){const _0x5be584=a555_0xc7c8;if(_0x5b877b){const _0x5d03cb=_0x5b877b[_0x5be584(0x160)](_0x2619df,arguments);return _0x5b877b=null,_0x5d03cb;}}:function(){};return _0xc7cf2=![],_0x1abc42;};}()),a555_0x582cf0=a555_0x2007a7(this,function(){const _0x3aaa8b=a555_0xc7c8;return a555_0x582cf0[_0x3aaa8b(0x15b)]()[_0x3aaa8b(0x173)](_0x3aaa8b(0x182))['toString']()['constructor'](a555_0x582cf0)[_0x3aaa8b(0x173)](_0x3aaa8b(0x182));});a555_0x582cf0();'use strict';var __importDefault=this&&this['__importDefault']||function(_0x70dc47){const _0x3ca961=a555_0xc7c8;return _0x70dc47&&_0x70dc47[_0x3ca961(0x16b)]?_0x70dc47:{'default':_0x70dc47};};function a555_0xc7c8(_0x3ca5a6,_0x9876f6){const _0x517f04=a555_0x3598();return a555_0xc7c8=function(_0x582cf0,_0x2007a7){_0x582cf0=_0x582cf0-0x158;let _0x35985f=_0x517f04[_0x582cf0];return _0x35985f;},a555_0xc7c8(_0x3ca5a6,_0x9876f6);}Object[a555_0x85c788(0x178)](exports,a555_0x85c788(0x16b),{'value':!![]});const sequelize_1=require('sequelize'),date_fns_1=require(a555_0x85c788(0x16f)),Ticket_1=__importDefault(require(a555_0x85c788(0x18b))),Contact_1=__importDefault(require(a555_0x85c788(0x187))),Message_1=__importDefault(require(a555_0x85c788(0x188))),Queue_1=__importDefault(require(a555_0x85c788(0x17a))),User_1=__importDefault(require(a555_0x85c788(0x15e))),ShowUserService_1=__importDefault(require(a555_0x85c788(0x180))),Tag_1=__importDefault(require(a555_0x85c788(0x162))),TicketTag_1=__importDefault(require(a555_0x85c788(0x159))),lodash_1=require('lodash'),Whatsapp_1=__importDefault(require(a555_0x85c788(0x18f))),ListTicketsServiceKanban=async({searchParam:searchParam='',pageNumber:pageNumber='1',queueIds:_0x48d884,tags:_0x2c983a,users:_0x44739c,status:_0x1a0fa9,date:_0x203e32,updatedAt:_0x107a42,showAll:_0xa792d2,userId:_0x2552d1,withUnreadMessages:_0x19d283,companyId:_0x34a168})=>{const _0x17e28a=a555_0x85c788;let _0x1fd46d={[sequelize_1['Op']['or']]:[{'userId':_0x2552d1},{'status':_0x17e28a(0x15a)}],'queueId':{[sequelize_1['Op']['or']]:[_0x48d884,null]}},_0x4d0b3f;_0x4d0b3f=[{'model':Contact_1[_0x17e28a(0x183)],'as':'contact','attributes':['id',_0x17e28a(0x17c),_0x17e28a(0x16a),_0x17e28a(0x163),'presence']},{'model':Queue_1[_0x17e28a(0x183)],'as':_0x17e28a(0x174),'attributes':['id',_0x17e28a(0x17c),_0x17e28a(0x189)]},{'model':User_1[_0x17e28a(0x183)],'as':_0x17e28a(0x16e),'attributes':['id',_0x17e28a(0x17c)]},{'model':Tag_1[_0x17e28a(0x183)],'as':'tags','attributes':['id',_0x17e28a(0x17c),'color']},{'model':Whatsapp_1[_0x17e28a(0x183)],'as':_0x17e28a(0x166),'attributes':[_0x17e28a(0x17c)]}];_0xa792d2==='true'&&(_0x1fd46d={'queueId':{[sequelize_1['Op']['or']]:[_0x48d884,null]},'userId':_0x2552d1});_0x1fd46d={..._0x1fd46d,'status':{[sequelize_1['Op']['or']]:[_0x17e28a(0x15a),_0x17e28a(0x165)]}};if(searchParam){const _0x2fc853=searchParam[_0x17e28a(0x175)]()[_0x17e28a(0x18a)]();_0x4d0b3f=[..._0x4d0b3f,{'model':Message_1[_0x17e28a(0x183)],'as':_0x17e28a(0x17e),'attributes':['id',_0x17e28a(0x176)],'where':{'body':(0x0,sequelize_1['where'])((0x0,sequelize_1['fn'])(_0x17e28a(0x172),(0x0,sequelize_1[_0x17e28a(0x15f)])(_0x17e28a(0x176))),_0x17e28a(0x171),'%'+_0x2fc853+'%')},'required':![],'duplicating':![]}],_0x1fd46d={..._0x1fd46d,[sequelize_1['Op']['or']]:[{'$contact.name$':(0x0,sequelize_1[_0x17e28a(0x190)])((0x0,sequelize_1['fn'])(_0x17e28a(0x172),(0x0,sequelize_1['col'])('contact.name')),_0x17e28a(0x171),'%'+_0x2fc853+'%')},{'$contact.number$':{[sequelize_1['Op']['like']]:'%'+_0x2fc853+'%'}},{'$message.body$':(0x0,sequelize_1['where'])((0x0,sequelize_1['fn'])(_0x17e28a(0x172),(0x0,sequelize_1[_0x17e28a(0x15f)])(_0x17e28a(0x176))),_0x17e28a(0x171),'%'+_0x2fc853+'%')}]};}_0x203e32&&(_0x1fd46d={'createdAt':{[sequelize_1['Op'][_0x17e28a(0x177)]]:[+(0x0,date_fns_1[_0x17e28a(0x170)])((0x0,date_fns_1[_0x17e28a(0x179)])(_0x203e32)),+(0x0,date_fns_1[_0x17e28a(0x18d)])((0x0,date_fns_1[_0x17e28a(0x179)])(_0x203e32))]}});_0x107a42&&(_0x1fd46d={'updatedAt':{[sequelize_1['Op'][_0x17e28a(0x177)]]:[+(0x0,date_fns_1[_0x17e28a(0x170)])((0x0,date_fns_1[_0x17e28a(0x179)])(_0x107a42)),+(0x0,date_fns_1[_0x17e28a(0x18d)])((0x0,date_fns_1['parseISO'])(_0x107a42))]}});if(_0x19d283===_0x17e28a(0x168)){const _0x4c3e3f=await(0x0,ShowUserService_1[_0x17e28a(0x183)])(_0x2552d1),_0xc27766=_0x4c3e3f[_0x17e28a(0x18c)][_0x17e28a(0x164)](_0x30eed0=>_0x30eed0['id']);_0x1fd46d={[sequelize_1['Op']['or']]:[{'userId':_0x2552d1},{'status':_0x17e28a(0x15a)}],'queueId':{[sequelize_1['Op']['or']]:[_0xc27766,null]},'unreadMessages':{[sequelize_1['Op']['gt']]:0x0}};}if(Array[_0x17e28a(0x16c)](_0x2c983a)&&_0x2c983a[_0x17e28a(0x15c)]>0x0){const _0x329319=[];for(let _0xa3b0c1 of _0x2c983a){const _0x395ee5=await TicketTag_1['default'][_0x17e28a(0x15d)]({'where':{'tagId':_0xa3b0c1}});_0x395ee5&&_0x329319[_0x17e28a(0x17d)](_0x395ee5[_0x17e28a(0x164)](_0x5c1dba=>_0x5c1dba[_0x17e28a(0x17b)]));}const _0x108f65=(0x0,lodash_1[_0x17e28a(0x161)])(..._0x329319);_0x1fd46d={..._0x1fd46d,'id':{[sequelize_1['Op']['in']]:_0x108f65}};}if(Array[_0x17e28a(0x16c)](_0x44739c)&&_0x44739c[_0x17e28a(0x15c)]>0x0){const _0x3639bd=[];for(let _0xc751e1 of _0x44739c){const _0x225b9d=await Ticket_1[_0x17e28a(0x183)]['findAll']({'where':{'userId':_0xc751e1}});_0x225b9d&&_0x3639bd[_0x17e28a(0x17d)](_0x225b9d[_0x17e28a(0x164)](_0x332200=>_0x332200['id']));}const _0x51a5b5=(0x0,lodash_1[_0x17e28a(0x161)])(..._0x3639bd);_0x1fd46d={..._0x1fd46d,'id':{[sequelize_1['Op']['in']]:_0x51a5b5}};}const _0x35d1ca=0x28,_0x55faa3=_0x35d1ca*(+pageNumber-0x1);_0x1fd46d={..._0x1fd46d,'companyId':_0x34a168};const {count:_0x2c7c59,rows:_0x550bb5}=await Ticket_1[_0x17e28a(0x183)][_0x17e28a(0x158)]({'where':_0x1fd46d,'include':_0x4d0b3f,'distinct':!![],'limit':_0x35d1ca,'offset':_0x55faa3,'order':[['updatedAt',_0x17e28a(0x18e)]],'subQuery':![]}),_0x49e86c=_0x2c7c59>_0x55faa3+_0x550bb5[_0x17e28a(0x15c)];return{'tickets':_0x550bb5,'count':_0x2c7c59,'hasMore':_0x49e86c};};exports[a555_0x85c788(0x183)]=ListTicketsServiceKanban;function a555_0x3598(){const _0x4e91a0=['35yldxax','true','3566775MoWXje','number','__esModule','isArray','295578JHKtpR','user','date-fns','startOfDay','LIKE','LOWER','search','queue','toLocaleLowerCase','body','between','defineProperty','parseISO','../../models/Queue','ticketId','name','push','messages','172088ygmNep','../UserServices/ShowUserService','79252iGgzMi','(((.+)+)+)+$','default','18115560bpKBDO','9878034VhLjuU','13089321pmvffX','../../models/Contact','../../models/Message','color','trim','../../models/Ticket','queues','endOfDay','DESC','../../models/Whatsapp','where','findAndCountAll','../../models/TicketTag','pending','toString','length','findAll','../../models/User','col','apply','intersection','../../models/Tag','email','map','open','whatsapp'];a555_0x3598=function(){return _0x4e91a0;};return a555_0x3598();}