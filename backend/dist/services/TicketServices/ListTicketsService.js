function a554_0x5917(_0x240ad0,_0x1650e9){const _0x86b7eb=a554_0x33bb();return a554_0x5917=function(_0x597ed8,_0x35f956){_0x597ed8=_0x597ed8-0x1ad;let _0x33bb27=_0x86b7eb[_0x597ed8];return _0x33bb27;},a554_0x5917(_0x240ad0,_0x1650e9);}function a554_0x33bb(){const _0x5c966e=['findAndCountAll','findAll','length','parseISO','groupsTab','color','ticketId','__esModule','sequelize','45945hCMEAv','GetCompanySetting','number','messages','trim','push','search','endOfDay','../../models/Queue','true','3298230rHLQzB','contact.name','isArray','5996570ZCFuOS','../../models/Message','1935840aOWuhB','../../models/Whatsapp','toString','admin','15434KkhbRn','default','../UserServices/ShowUserService','3057033pauwWF','797565AcVniF','col','453ZDQlgX','updatedAt','../../models/Ticket','like','DESC','queue','enabled','../../models/Contact','LOWER','user','constructor','name','LIKE','between','isGroup','profile','closed','../../models/Tag','pending','(((.+)+)+)+$','tags','lodash','__importDefault','presence','defineProperty','where','intersection','../../models/TicketTag','body','map','date-fns','736sBKcoA','../../helpers/CheckSettings','contact','queues'];a554_0x33bb=function(){return _0x5c966e;};return a554_0x33bb();}const a554_0x4e7793=a554_0x5917;(function(_0x1ae5f1,_0x44fa87){const _0x200b7d=a554_0x5917,_0x249f5c=_0x1ae5f1();while(!![]){try{const _0x3c8910=parseInt(_0x200b7d(0x1bb))/0x1+parseInt(_0x200b7d(0x1b7))/0x2*(parseInt(_0x200b7d(0x1bd))/0x3)+parseInt(_0x200b7d(0x1b3))/0x4+-parseInt(_0x200b7d(0x1b1))/0x5+-parseInt(_0x200b7d(0x1ae))/0x6+parseInt(_0x200b7d(0x1ba))/0x7+parseInt(_0x200b7d(0x1dc))/0x8*(-parseInt(_0x200b7d(0x1e9))/0x9);if(_0x3c8910===_0x44fa87)break;else _0x249f5c['push'](_0x249f5c['shift']());}catch(_0x4ce6a1){_0x249f5c['push'](_0x249f5c['shift']());}}}(a554_0x33bb,0xa2500));const a554_0x35f956=(function(){let _0x5b6b50=!![];return function(_0x56cd30,_0x434f42){const _0xdca354=_0x5b6b50?function(){if(_0x434f42){const _0x555dca=_0x434f42['apply'](_0x56cd30,arguments);return _0x434f42=null,_0x555dca;}}:function(){};return _0x5b6b50=![],_0xdca354;};}()),a554_0x597ed8=a554_0x35f956(this,function(){const _0x169fa2=a554_0x5917;return a554_0x597ed8['toString']()['search'](_0x169fa2(0x1d0))[_0x169fa2(0x1b5)]()[_0x169fa2(0x1c7)](a554_0x597ed8)[_0x169fa2(0x1ef)](_0x169fa2(0x1d0));});a554_0x597ed8();'use strict';var __importDefault=this&&this[a554_0x4e7793(0x1d3)]||function(_0x4e974a){const _0x5d0a48=a554_0x4e7793;return _0x4e974a&&_0x4e974a[_0x5d0a48(0x1e7)]?_0x4e974a:{'default':_0x4e974a};};Object[a554_0x4e7793(0x1d5)](exports,a554_0x4e7793(0x1e7),{'value':!![]});const sequelize_1=require(a554_0x4e7793(0x1e8)),date_fns_1=require(a554_0x4e7793(0x1db)),lodash_1=require(a554_0x4e7793(0x1d2)),Ticket_1=__importDefault(require(a554_0x4e7793(0x1bf))),Contact_1=__importDefault(require(a554_0x4e7793(0x1c4))),Message_1=__importDefault(require(a554_0x4e7793(0x1b2))),Queue_1=__importDefault(require(a554_0x4e7793(0x1f1))),User_1=__importDefault(require('../../models/User')),ShowUserService_1=__importDefault(require(a554_0x4e7793(0x1b9))),Tag_1=__importDefault(require(a554_0x4e7793(0x1ce))),TicketTag_1=__importDefault(require(a554_0x4e7793(0x1d8))),Whatsapp_1=__importDefault(require(a554_0x4e7793(0x1b4))),CheckSettings_1=require(a554_0x4e7793(0x1dd)),ListTicketsService=async({isSearch:isSearch=![],searchParam:searchParam='',pageNumber:pageNumber='1',queueIds:_0x3fc375,tags:_0x37ea7f,users:_0x3f7aff,status:_0x5dec99,groups:_0x328af4,date:_0x1eedf3,updatedAt:_0x4c6d93,showAll:_0x329b3b,userId:_0x4fa01a,withUnreadMessages:_0x2d5878,notClosed:_0xb718b5,all:_0x4879e1,companyId:_0x5ab295})=>{const _0x1ebf83=a554_0x4e7793,_0x52a80d=!isSearch&&await(0x0,CheckSettings_1[_0x1ebf83(0x1ea)])(_0x5ab295,_0x1ebf83(0x1e4),'disabled')===_0x1ebf83(0x1c3),_0x14e9e8=await(0x0,ShowUserService_1[_0x1ebf83(0x1b8)])(_0x4fa01a);let _0x114d4c={[sequelize_1['Op']['or']]:[{'userId':_0x4fa01a},{'status':'pending'}],'queueId':{[sequelize_1['Op']['or']]:_0x14e9e8[_0x1ebf83(0x1cc)]==='admin'?[_0x3fc375,null]:[_0x3fc375]}};_0x52a80d&&(_0x114d4c['isGroup']=_0x328af4===_0x1ebf83(0x1ad));let _0x44bb2e;_0x44bb2e=[{'model':Contact_1[_0x1ebf83(0x1b8)],'as':_0x1ebf83(0x1de),'attributes':['id','name',_0x1ebf83(0x1eb),'email','profilePicUrl',_0x1ebf83(0x1d4)]},{'model':Queue_1[_0x1ebf83(0x1b8)],'as':_0x1ebf83(0x1c2),'attributes':['id','name',_0x1ebf83(0x1e5)]},{'model':User_1[_0x1ebf83(0x1b8)],'as':_0x1ebf83(0x1c6),'attributes':['id','name']},{'model':Tag_1[_0x1ebf83(0x1b8)],'as':_0x1ebf83(0x1d1),'attributes':['id',_0x1ebf83(0x1c8),_0x1ebf83(0x1e5)]},{'model':Whatsapp_1[_0x1ebf83(0x1b8)],'as':'whatsapp','attributes':['id',_0x1ebf83(0x1c8)]}];_0x329b3b===_0x1ebf83(0x1ad)&&_0x14e9e8[_0x1ebf83(0x1cc)]===_0x1ebf83(0x1b6)&&(_0x114d4c={'queueId':{[sequelize_1['Op']['or']]:[_0x3fc375,null]}},_0x52a80d&&(_0x114d4c[_0x1ebf83(0x1cb)]=_0x328af4===_0x1ebf83(0x1ad)));_0x5dec99&&(_0x114d4c={..._0x114d4c,'status':_0x5dec99});if(searchParam){const _0x3511f4=searchParam['toLocaleLowerCase']()[_0x1ebf83(0x1ed)]();_0x44bb2e=[..._0x44bb2e,{'model':Message_1[_0x1ebf83(0x1b8)],'as':_0x1ebf83(0x1ec),'attributes':['id',_0x1ebf83(0x1d9)],'where':{'body':(0x0,sequelize_1[_0x1ebf83(0x1d6)])((0x0,sequelize_1['fn'])(_0x1ebf83(0x1c5),(0x0,sequelize_1[_0x1ebf83(0x1bc)])(_0x1ebf83(0x1d9))),'LIKE','%'+_0x3511f4+'%')},'required':![],'duplicating':![]}],_0x114d4c={..._0x114d4c,[sequelize_1['Op']['or']]:[{'$contact.name$':(0x0,sequelize_1[_0x1ebf83(0x1d6)])((0x0,sequelize_1['fn'])(_0x1ebf83(0x1c5),(0x0,sequelize_1['col'])(_0x1ebf83(0x1af))),_0x1ebf83(0x1c9),'%'+_0x3511f4+'%')},{'$contact.number$':{[sequelize_1['Op'][_0x1ebf83(0x1c0)]]:'%'+_0x3511f4+'%'}},{'$message.body$':(0x0,sequelize_1[_0x1ebf83(0x1d6)])((0x0,sequelize_1['fn'])('LOWER',(0x0,sequelize_1[_0x1ebf83(0x1bc)])('body')),_0x1ebf83(0x1c9),'%'+_0x3511f4+'%')}]};}_0x1eedf3&&(_0x114d4c={'createdAt':{[sequelize_1['Op'][_0x1ebf83(0x1ca)]]:[+(0x0,date_fns_1['startOfDay'])((0x0,date_fns_1[_0x1ebf83(0x1e3)])(_0x1eedf3)),+(0x0,date_fns_1[_0x1ebf83(0x1f0)])((0x0,date_fns_1[_0x1ebf83(0x1e3)])(_0x1eedf3))]}});_0x4c6d93&&(_0x114d4c={'updatedAt':{[sequelize_1['Op'][_0x1ebf83(0x1ca)]]:[+(0x0,date_fns_1['startOfDay'])((0x0,date_fns_1[_0x1ebf83(0x1e3)])(_0x4c6d93)),+(0x0,date_fns_1[_0x1ebf83(0x1f0)])((0x0,date_fns_1[_0x1ebf83(0x1e3)])(_0x4c6d93))]}});if(_0x2d5878===_0x1ebf83(0x1ad)){const _0x41d029=_0x14e9e8[_0x1ebf83(0x1df)][_0x1ebf83(0x1da)](_0x543b90=>_0x543b90['id']);_0x114d4c={[sequelize_1['Op']['or']]:[{'userId':_0x4fa01a},{'status':_0x1ebf83(0x1cf)}],'queueId':{[sequelize_1['Op']['or']]:_0x14e9e8[_0x1ebf83(0x1cc)]===_0x1ebf83(0x1b6)?[_0x41d029,null]:[_0x41d029]},'unreadMessages':{[sequelize_1['Op']['gt']]:0x0}},_0x52a80d&&(_0x114d4c[_0x1ebf83(0x1cb)]=_0x328af4===_0x1ebf83(0x1ad));}if(Array[_0x1ebf83(0x1b0)](_0x37ea7f)&&_0x37ea7f[_0x1ebf83(0x1e2)]>0x0){const _0x96c959=[];for await(const _0x5719f8 of _0x37ea7f){const _0x47a0d3=await TicketTag_1[_0x1ebf83(0x1b8)][_0x1ebf83(0x1e1)]({'where':{'tagId':_0x5719f8}});_0x47a0d3&&_0x96c959[_0x1ebf83(0x1ee)](_0x47a0d3[_0x1ebf83(0x1da)](_0x411533=>_0x411533[_0x1ebf83(0x1e6)]));}const _0x3e09d1=(0x0,lodash_1[_0x1ebf83(0x1d7)])(..._0x96c959);_0x114d4c={..._0x114d4c,'id':{[sequelize_1['Op']['in']]:_0x3e09d1}};}if(Array[_0x1ebf83(0x1b0)](_0x3f7aff)&&_0x3f7aff[_0x1ebf83(0x1e2)]>0x0){const _0x5b004b=[];for await(const _0xf1e603 of _0x3f7aff){const _0x412014=await Ticket_1['default'][_0x1ebf83(0x1e1)]({'where':{'userId':_0xf1e603}});_0x412014&&_0x5b004b[_0x1ebf83(0x1ee)](_0x412014[_0x1ebf83(0x1da)](_0x132e97=>_0x132e97['id']));}const _0x88a8ca=(0x0,lodash_1[_0x1ebf83(0x1d7)])(..._0x5b004b);_0x114d4c={..._0x114d4c,'id':{[sequelize_1['Op']['in']]:_0x88a8ca}};}const _0x2d5f88=_0x4879e1?undefined:0x28,_0x1cd134=_0x4879e1?undefined:_0x2d5f88*(+pageNumber-0x1);_0xb718b5&&(_0x114d4c={..._0x114d4c,'status':{[sequelize_1['Op']['ne']]:_0x1ebf83(0x1cd)}});_0x114d4c={..._0x114d4c,'companyId':_0x5ab295};const {count:_0x383f66,rows:_0x15a843}=await Ticket_1[_0x1ebf83(0x1b8)][_0x1ebf83(0x1e0)]({'where':_0x114d4c,'include':_0x44bb2e,'distinct':!![],'limit':_0x2d5f88,'offset':_0x1cd134,'order':[[_0x1ebf83(0x1be),_0x1ebf83(0x1c1)]],'subQuery':![]}),_0x2aef58=_0x383f66>_0x1cd134+_0x15a843['length'];return{'tickets':_0x15a843,'count':_0x383f66,'hasMore':_0x2aef58};};exports[a554_0x4e7793(0x1b8)]=ListTicketsService;