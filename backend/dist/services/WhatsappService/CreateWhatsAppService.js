function a562_0x3ab5(){const _0x2624d0=['(((.+)+)+)+$','default','__createBinding','4kLsADv','17361770UHRdun','count','7840536bikpqc','yup','connections','./AssociateWhatsappQueue','../../errors/AppError','apply','create','__importDefault','Check-token','boolean','../../models/Plan','beta','Check-name','3241jQFrCW','hasOwnProperty','validate','required','Esse\x20nome\x20já\x20está\x20sendo\x20utilizado\x20por\x20outra\x20conexão','test','392478DlgZog','__importStar','length','toString','call','__esModule','getOwnPropertyDescriptor','search','findOne','min','Número\x20máximo\x20de\x20conexões\x20já\x20alcançado:\x20','__setModuleDefault','OPENING','queues','../../models/Whatsapp','shape','plan','1563483sKknic','get','configurable','26792OSPkxX','570YYANKs','14695362LKNbBS','This\x20whatsapp\x20token\x20is\x20already\x20used.','message','65NCUTxG','ERR_WAPP_GREETING_REQUIRED','defineProperty','prototype','string','5532jJMAfr'];a562_0x3ab5=function(){return _0x2624d0;};return a562_0x3ab5();}const a562_0x5e00ae=a562_0x3afd;(function(_0x1a31ac,_0xcc0862){const _0x213758=a562_0x3afd,_0x1e0b09=_0x1a31ac();while(!![]){try{const _0x3f4595=-parseInt(_0x213758(0xc0))/0x1*(parseInt(_0x213758(0xc9))/0x2)+-parseInt(_0x213758(0xbc))/0x3*(parseInt(_0x213758(0x95))/0x4)+-parseInt(_0x213758(0xc4))/0x5*(-parseInt(_0x213758(0xab))/0x6)+-parseInt(_0x213758(0xa5))/0x7*(-parseInt(_0x213758(0xbf))/0x8)+parseInt(_0x213758(0xc1))/0x9+-parseInt(_0x213758(0x96))/0xa+parseInt(_0x213758(0x98))/0xb;if(_0x3f4595===_0xcc0862)break;else _0x1e0b09['push'](_0x1e0b09['shift']());}catch(_0x3a4643){_0x1e0b09['push'](_0x1e0b09['shift']());}}}(a562_0x3ab5,0xdecd0));function a562_0x3afd(_0x51540a,_0x72c8c){const _0x4de8e1=a562_0x3ab5();return a562_0x3afd=function(_0x27fcf7,_0x475a07){_0x27fcf7=_0x27fcf7-0x95;let _0x3ab5fb=_0x4de8e1[_0x27fcf7];return _0x3ab5fb;},a562_0x3afd(_0x51540a,_0x72c8c);}const a562_0x475a07=(function(){let _0x4e96a4=!![];return function(_0x1de9c7,_0x365be8){const _0x1f124f=_0x4e96a4?function(){const _0x2c26d9=a562_0x3afd;if(_0x365be8){const _0x3b1d63=_0x365be8[_0x2c26d9(0x9d)](_0x1de9c7,arguments);return _0x365be8=null,_0x3b1d63;}}:function(){};return _0x4e96a4=![],_0x1f124f;};}()),a562_0x27fcf7=a562_0x475a07(this,function(){const _0x4c8d9d=a562_0x3afd;return a562_0x27fcf7['toString']()[_0x4c8d9d(0xb2)](_0x4c8d9d(0xca))[_0x4c8d9d(0xae)]()['constructor'](a562_0x27fcf7)[_0x4c8d9d(0xb2)](_0x4c8d9d(0xca));});a562_0x27fcf7();'use strict';var __createBinding=this&&this[a562_0x5e00ae(0xcc)]||(Object[a562_0x5e00ae(0x9e)]?function(_0x1d1856,_0x71c65b,_0x51ead8,_0x578976){const _0x1ab9d6=a562_0x5e00ae;if(_0x578976===undefined)_0x578976=_0x51ead8;var _0x4584cf=Object[_0x1ab9d6(0xb1)](_0x71c65b,_0x51ead8);(!_0x4584cf||(_0x1ab9d6(0xbd)in _0x4584cf?!_0x71c65b[_0x1ab9d6(0xb0)]:_0x4584cf['writable']||_0x4584cf[_0x1ab9d6(0xbe)]))&&(_0x4584cf={'enumerable':!![],'get':function(){return _0x71c65b[_0x51ead8];}}),Object['defineProperty'](_0x1d1856,_0x578976,_0x4584cf);}:function(_0x593d6d,_0x370d1f,_0x324d9b,_0x4381f0){if(_0x4381f0===undefined)_0x4381f0=_0x324d9b;_0x593d6d[_0x4381f0]=_0x370d1f[_0x324d9b];}),__setModuleDefault=this&&this[a562_0x5e00ae(0xb6)]||(Object[a562_0x5e00ae(0x9e)]?function(_0x1ea9f0,_0x154253){const _0x459845=a562_0x5e00ae;Object[_0x459845(0xc6)](_0x1ea9f0,'default',{'enumerable':!![],'value':_0x154253});}:function(_0x44aa46,_0x1c6ab1){const _0x56a90c=a562_0x5e00ae;_0x44aa46[_0x56a90c(0xcb)]=_0x1c6ab1;}),__importStar=this&&this[a562_0x5e00ae(0xac)]||function(_0x18b18b){const _0x508a8a=a562_0x5e00ae;if(_0x18b18b&&_0x18b18b['__esModule'])return _0x18b18b;var _0x5e2a22={};if(_0x18b18b!=null){for(var _0x562e22 in _0x18b18b)if(_0x562e22!==_0x508a8a(0xcb)&&Object[_0x508a8a(0xc7)][_0x508a8a(0xa6)][_0x508a8a(0xaf)](_0x18b18b,_0x562e22))__createBinding(_0x5e2a22,_0x18b18b,_0x562e22);}return __setModuleDefault(_0x5e2a22,_0x18b18b),_0x5e2a22;},__importDefault=this&&this[a562_0x5e00ae(0x9f)]||function(_0x19f706){const _0x1a3f36=a562_0x5e00ae;return _0x19f706&&_0x19f706[_0x1a3f36(0xb0)]?_0x19f706:{'default':_0x19f706};};Object['defineProperty'](exports,a562_0x5e00ae(0xb0),{'value':!![]});const Yup=__importStar(require(a562_0x5e00ae(0x99))),AppError_1=__importDefault(require(a562_0x5e00ae(0x9c))),Whatsapp_1=__importDefault(require(a562_0x5e00ae(0xb9))),Company_1=__importDefault(require('../../models/Company')),Plan_1=__importDefault(require(a562_0x5e00ae(0xa2))),AssociateWhatsappQueue_1=__importDefault(require(a562_0x5e00ae(0x9b))),CreateWhatsAppService=async({name:_0x42c80b,status:status=a562_0x5e00ae(0xb7),queueIds:queueIds=[],greetingMessage:_0x5b5e28,complationMessage:_0x1b3b34,outOfHoursMessage:_0x4c13ef,ratingMessage:_0x526a15,isDefault:isDefault=![],companyId:_0xc7bfea,token:token='',provider:provider=a562_0x5e00ae(0xa3),timeSendQueue:_0x50605d,sendIdQueue:_0x41a487,promptId:_0x105517,integrationId:_0x2ff30a,maxUseBotQueues:maxUseBotQueues=0x3,timeUseBotQueues:timeUseBotQueues=0x0,expiresTicket:expiresTicket=0x0,expiresInactiveMessage:expiresInactiveMessage='',allowGroup:_0x5db72d,importOldMessages:_0x4b1160,importRecentMessages:_0x3a7f02,closedTicketsPostImported:_0xcbce38,importOldMessagesGroups:_0x5dee66})=>{const _0x4f510a=a562_0x5e00ae,_0x2244a2=await Company_1[_0x4f510a(0xcb)]['findOne']({'where':{'id':_0xc7bfea},'include':[{'model':Plan_1[_0x4f510a(0xcb)],'as':'plan'}]});if(_0x2244a2!==null){const _0x4fce33=await Whatsapp_1[_0x4f510a(0xcb)][_0x4f510a(0x97)]({'where':{'companyId':_0xc7bfea}});if(_0x4fce33>=_0x2244a2[_0x4f510a(0xbb)][_0x4f510a(0x9a)])throw new AppError_1[(_0x4f510a(0xcb))](_0x4f510a(0xb5)+_0x4fce33);}const _0x382f07=Yup['object']()[_0x4f510a(0xba)]({'name':Yup['string']()[_0x4f510a(0xa8)]()[_0x4f510a(0xb4)](0x2)['test'](_0x4f510a(0xa4),_0x4f510a(0xa9),async _0x43c13e=>{const _0xf90968=_0x4f510a;if(!_0x43c13e)return![];const _0x1b007f=await Whatsapp_1[_0xf90968(0xcb)][_0xf90968(0xb3)]({'where':{'name':_0x43c13e}});return!_0x1b007f;}),'isDefault':Yup[_0x4f510a(0xa1)]()['required']()});try{await _0x382f07[_0x4f510a(0xa7)]({'name':_0x42c80b,'status':status,'isDefault':isDefault});}catch(_0x47ba11){throw new AppError_1[(_0x4f510a(0xcb))](_0x47ba11[_0x4f510a(0xc3)]);}const _0x462518=await Whatsapp_1[_0x4f510a(0xcb)]['findOne']({'where':{'companyId':_0xc7bfea}});isDefault=!_0x462518;let _0x2a9856=null;isDefault&&(_0x2a9856=await Whatsapp_1[_0x4f510a(0xcb)][_0x4f510a(0xb3)]({'where':{'isDefault':!![],'companyId':_0xc7bfea}}),_0x2a9856&&await _0x2a9856['update']({'isDefault':![],'companyId':_0xc7bfea}));if(queueIds[_0x4f510a(0xad)]>0x1&&!_0x5b5e28)throw new AppError_1[(_0x4f510a(0xcb))](_0x4f510a(0xc5));if(token!==null&&token!==''){const _0x324f05=Yup['object']()[_0x4f510a(0xba)]({'token':Yup[_0x4f510a(0xc8)]()[_0x4f510a(0xa8)]()[_0x4f510a(0xb4)](0x2)[_0x4f510a(0xaa)](_0x4f510a(0xa0),_0x4f510a(0xc2),async _0xe946c4=>{const _0x56215c=_0x4f510a;if(!_0xe946c4)return![];const _0x9f5909=await Whatsapp_1[_0x56215c(0xcb)][_0x56215c(0xb3)]({'where':{'token':_0xe946c4}});return!_0x9f5909;})});try{await _0x324f05[_0x4f510a(0xa7)]({'token':token});}catch(_0x4a0cd0){throw new AppError_1[(_0x4f510a(0xcb))](_0x4a0cd0[_0x4f510a(0xc3)]);}}const _0x3698f4=await Whatsapp_1[_0x4f510a(0xcb)][_0x4f510a(0x9e)]({'name':_0x42c80b,'status':status,'greetingMessage':_0x5b5e28,'complationMessage':_0x1b3b34,'outOfHoursMessage':_0x4c13ef,'ratingMessage':_0x526a15,'isDefault':isDefault,'companyId':_0xc7bfea,'token':token,'provider':provider,'timeSendQueue':_0x50605d,'sendIdQueue':_0x41a487,'promptId':_0x105517&&_0x105517>0x0?_0x105517:null,'integrationId':_0x2ff30a&&_0x2ff30a>0x0?_0x2ff30a:null,'maxUseBotQueues':maxUseBotQueues,'timeUseBotQueues':timeUseBotQueues,'expiresTicket':expiresTicket,'expiresInactiveMessage':expiresInactiveMessage,'allowGroup':_0x5db72d,'importOldMessages':_0x4b1160,'importRecentMessages':_0x3a7f02,'closedTicketsPostImported':_0xcbce38,'importOldMessagesGroups':_0x5dee66},{'include':[_0x4f510a(0xb8)]});return await(0x0,AssociateWhatsappQueue_1[_0x4f510a(0xcb)])(_0x3698f4,queueIds),{'whatsapp':_0x3698f4,'oldDefaultWhatsapp':_0x2a9856};};exports[a562_0x5e00ae(0xcb)]=CreateWhatsAppService;