'use strict';const a717_0x49433f=a717_0x14b1;function a717_0x14b1(_0x237300,_0x580f8d){const _0x1d876b=a717_0xf1c9();return a717_0x14b1=function(_0x8129cd,_0x10e1cb){_0x8129cd=_0x8129cd-0x158;let _0xf1c9ee=_0x1d876b[_0x8129cd];return _0xf1c9ee;},a717_0x14b1(_0x237300,_0x580f8d);}(function(_0x2f2710,_0x4e12a1){const _0x4e0c1d=a717_0x14b1,_0x1bdf0d=_0x2f2710();while(!![]){try{const _0x5b44a1=parseInt(_0x4e0c1d(0x183))/0x1+parseInt(_0x4e0c1d(0x15b))/0x2*(-parseInt(_0x4e0c1d(0x171))/0x3)+parseInt(_0x4e0c1d(0x163))/0x4+parseInt(_0x4e0c1d(0x16d))/0x5+parseInt(_0x4e0c1d(0x177))/0x6+-parseInt(_0x4e0c1d(0x178))/0x7*(parseInt(_0x4e0c1d(0x15d))/0x8)+parseInt(_0x4e0c1d(0x17d))/0x9;if(_0x5b44a1===_0x4e12a1)break;else _0x1bdf0d['push'](_0x1bdf0d['shift']());}catch(_0x5ebfd0){_0x1bdf0d['push'](_0x1bdf0d['shift']());}}}(a717_0xf1c9,0xa2376));var __createBinding=this&&this[a717_0x49433f(0x15e)]||(Object['create']?function(_0x2d4d86,_0x192c7b,_0x11ff16,_0x4c4c48){const _0x3e880f=a717_0x49433f;if(_0x4c4c48===undefined)_0x4c4c48=_0x11ff16;var _0x21cd41=Object[_0x3e880f(0x15f)](_0x192c7b,_0x11ff16);(!_0x21cd41||(_0x3e880f(0x181)in _0x21cd41?!_0x192c7b['__esModule']:_0x21cd41[_0x3e880f(0x167)]||_0x21cd41[_0x3e880f(0x17c)]))&&(_0x21cd41={'enumerable':!![],'get':function(){return _0x192c7b[_0x11ff16];}}),Object[_0x3e880f(0x184)](_0x2d4d86,_0x4c4c48,_0x21cd41);}:function(_0x44c2b3,_0xcba581,_0x2aecfe,_0x34a877){if(_0x34a877===undefined)_0x34a877=_0x2aecfe;_0x44c2b3[_0x34a877]=_0xcba581[_0x2aecfe];}),__setModuleDefault=this&&this['__setModuleDefault']||(Object[a717_0x49433f(0x161)]?function(_0x1f0f94,_0x48e139){const _0x33fd21=a717_0x49433f;Object['defineProperty'](_0x1f0f94,_0x33fd21(0x170),{'enumerable':!![],'value':_0x48e139});}:function(_0x53f380,_0x3b1aa3){const _0x2a1707=a717_0x49433f;_0x53f380[_0x2a1707(0x170)]=_0x3b1aa3;}),__importStar=this&&this['__importStar']||(function(){const _0x177a88=(function(){let _0x135191=!![];return function(_0x1a5502,_0x259a0c){const _0x1a1b03=_0x135191?function(){const _0x558475=a717_0x14b1;if(_0x259a0c){const _0x47244b=_0x259a0c[_0x558475(0x16f)](_0x1a5502,arguments);return _0x259a0c=null,_0x47244b;}}:function(){};return _0x135191=![],_0x1a1b03;};}()),_0x53c1e0=_0x177a88(this,function(){const _0x4f101c=a717_0x14b1;return _0x53c1e0[_0x4f101c(0x16e)]()['search'](_0x4f101c(0x17f))[_0x4f101c(0x16e)]()['constructor'](_0x53c1e0)[_0x4f101c(0x165)](_0x4f101c(0x17f));});_0x53c1e0();var _0x59169e=function(_0x4dded2){const _0x29bb4e=a717_0x14b1;return _0x59169e=Object[_0x29bb4e(0x17a)]||function(_0x2b9ea6){const _0x334b70=_0x29bb4e;var _0x474c2b=[];for(var _0x1db17a in _0x2b9ea6)if(Object[_0x334b70(0x166)]['hasOwnProperty'][_0x334b70(0x172)](_0x2b9ea6,_0x1db17a))_0x474c2b[_0x474c2b[_0x334b70(0x162)]]=_0x1db17a;return _0x474c2b;},_0x59169e(_0x4dded2);};return function(_0x460944){const _0x1521c3=a717_0x14b1;if(_0x460944&&_0x460944['__esModule'])return _0x460944;var _0x3d87b3={};if(_0x460944!=null){for(var _0x48228d=_0x59169e(_0x460944),_0x1581b6=0x0;_0x1581b6<_0x48228d[_0x1521c3(0x162)];_0x1581b6++)if(_0x48228d[_0x1581b6]!=='default')__createBinding(_0x3d87b3,_0x460944,_0x48228d[_0x1581b6]);}return __setModuleDefault(_0x3d87b3,_0x460944),_0x3d87b3;};}()),__importDefault=this&&this[a717_0x49433f(0x15c)]||function(_0x54ba5a){const _0x28fffc=a717_0x49433f;return _0x54ba5a&&_0x54ba5a[_0x28fffc(0x159)]?_0x54ba5a:{'default':_0x54ba5a};};function a717_0xf1c9(){const _0x34e850=['./AssociateWhatsappQueue','get','Defina\x20uma\x20mensagem\x20de\x20encerramento\x20por\x20inatividade\x20ou\x20configure\x20o\x20tempo\x20para\x200','129107EuGGVv','defineProperty','update','__esModule','../../errors/AppError','4uVmuWG','__importDefault','8avzfXA','__createBinding','getOwnPropertyDescriptor','sequelize','create','length','223768godBvl','shape','search','prototype','writable','string','yup','findOne','../../models/Whatsapp','object','366490YRvStj','toString','apply','default','101130jsRRmd','call','trim','message','min','Defina\x20um\x20tempo\x20de\x20encerramento\x20maior\x20que\x200\x20ou\x20remova\x20a\x20mensagem','1931562TeSLGg','2551759vjBQrI','not','getOwnPropertyNames','boolean','configurable','4645089gWnvkc','./ShowWhatsAppService','(((.+)+)+)+$'];a717_0xf1c9=function(){return _0x34e850;};return a717_0xf1c9();}Object[a717_0x49433f(0x184)](exports,'__esModule',{'value':!![]});const Yup=__importStar(require(a717_0x49433f(0x169))),sequelize_1=require(a717_0x49433f(0x160)),AppError_1=__importDefault(require(a717_0x49433f(0x15a))),Whatsapp_1=__importDefault(require(a717_0x49433f(0x16b))),ShowWhatsAppService_1=__importDefault(require(a717_0x49433f(0x17e))),AssociateWhatsappQueue_1=__importDefault(require(a717_0x49433f(0x180))),AssociateWhatsappFlow_1=__importDefault(require('./AssociateWhatsappFlow')),UpdateWhatsAppService=async({whatsappData:_0x470a10,whatsappId:_0x44635b,companyId:_0xb6ecbc})=>{const _0x143603=a717_0x49433f,{name:_0x2ea7d9,status:_0x48393b,isDefault:_0x2bae80,session:_0x4632f6,greetingMessage:_0x22b286,greetingAcceptedMessage:_0x5c261a,complationMessage:_0x1bf4b2,outOfHoursMessage:_0x6272b4,useRating:_0x580ba7,ratingMessage:_0x564072,transferMessage:_0x56fa07,sendTransferMessage:_0x54ab46,sendGreetingAccepted:_0x206abb,sendRejectCall:_0x4996a1,rejectCallMessage:_0xe12b1,queueIds:queueIds=[],flowIds:flowIds=[],token:_0x513305,timeSendQueue:_0x19ef19,integrationId:_0x3aef69,sendIdQueue:sendIdQueue=null,maxUseBotQueues:_0x511e58,expiresTicket:_0x26ca9f,expiresInactiveMessage:_0x19e315,allowGroup:_0x5d9f71,importOldMessages:_0x18edcb,whenExpireTicket:_0x30acde,inactiveMessageTime:_0x353c61,inactiveMessage:_0x25f5fe,automaticRestart:_0x5cd6ea,period:_0x3ed2ba,lastRestartAt:_0x1dc6ec,collectiveVacationMessage:_0x331459,collectiveVacationStart:_0x275d1a,collectiveVacationEnd:_0xc97c2e}=_0x470a10,_0x39f269=Yup[_0x143603(0x16c)]()[_0x143603(0x164)]({'name':Yup[_0x143603(0x168)]()[_0x143603(0x175)](0x2),'status':Yup[_0x143603(0x168)](),'isDefault':Yup[_0x143603(0x17b)]()});try{await _0x39f269['validate']({'name':_0x2ea7d9,'status':_0x48393b,'isDefault':_0x2bae80});}catch(_0x3d5a64){throw new AppError_1['default'](_0x3d5a64[_0x143603(0x174)]);}if(queueIds[_0x143603(0x162)]>0x1&&!_0x22b286)throw new AppError_1['default']('ERR_WAPP_GREETING_REQUIRED');const _0x257fa7=parseInt(_0x26ca9f?.[_0x143603(0x16e)]()||'0',0xa),_0x4433f3=parseInt(_0x353c61?.[_0x143603(0x16e)]()||'0',0xa),_0x42babc=_0x19e315?.[_0x143603(0x173)]()||'',_0x10dde0=_0x25f5fe?.['trim']()||'';if(_0x257fa7>0x0&&!_0x42babc)throw new AppError_1['default'](_0x143603(0x182));if(_0x42babc&&_0x257fa7===0x0)throw new AppError_1['default'](_0x143603(0x176));if(_0x4433f3>0x0&&!_0x10dde0)throw new AppError_1[(_0x143603(0x170))]('Defina\x20uma\x20mensagem\x20de\x20aviso\x20de\x20inatividade\x20ou\x20configure\x20o\x20tempo\x20para\x200');if(_0x10dde0&&_0x4433f3===0x0)throw new AppError_1['default']('Defina\x20um\x20tempo\x20para\x20aviso\x20maior\x20que\x200\x20ou\x20remova\x20a\x20mensagem');let _0x4f404b=null;_0x2bae80&&(_0x4f404b=await Whatsapp_1[_0x143603(0x170)][_0x143603(0x16a)]({'where':{'isDefault':!![],'id':{[sequelize_1['Op'][_0x143603(0x179)]]:_0x44635b},'companyId':_0xb6ecbc}}),_0x4f404b&&await _0x4f404b[_0x143603(0x158)]({'isDefault':![]}));const _0x1fdea0=await(0x0,ShowWhatsAppService_1[_0x143603(0x170)])(_0x44635b,_0xb6ecbc);return await _0x1fdea0['update']({'name':_0x2ea7d9,'status':_0x48393b,'session':_0x4632f6,'greetingMessage':_0x22b286,'greetingAcceptedMessage':_0x5c261a,'complationMessage':_0x1bf4b2,'outOfHoursMessage':_0x6272b4,'useRating':_0x580ba7,'ratingMessage':_0x564072,'isDefault':_0x2bae80,'companyId':_0xb6ecbc,'token':_0x513305,'transferMessage':_0x56fa07,'sendTransferMessage':_0x54ab46,'sendGreetingAccepted':_0x206abb,'sendRejectCall':_0x4996a1,'rejectCallMessage':_0xe12b1,'integrationId':_0x3aef69?_0x3aef69:null,'maxUseBotQueues':_0x511e58,'timeSendQueue':_0x19ef19,'sendIdQueue':sendIdQueue,'expiresTicket':_0x26ca9f,'expiresInactiveMessage':_0x19e315,'allowGroup':_0x5d9f71,'importOldMessages':_0x18edcb,'whenExpireTicket':_0x30acde,'inactiveMessageTime':_0x353c61,'inactiveMessage':_0x25f5fe,'automaticRestart':_0x5cd6ea,'period':_0x3ed2ba,'lastRestartAt':_0x1dc6ec,'collectiveVacationMessage':_0x331459,'collectiveVacationStart':_0x275d1a||null,'collectiveVacationEnd':_0xc97c2e||null}),await(0x0,AssociateWhatsappQueue_1[_0x143603(0x170)])(_0x1fdea0,queueIds),await(0x0,AssociateWhatsappFlow_1[_0x143603(0x170)])(_0x1fdea0,flowIds),{'whatsapp':_0x1fdea0,'oldDefaultWhatsapp':_0x4f404b};};exports['default']=UpdateWhatsAppService;