'use strict';const a716_0x2b985f=a716_0x51c0;(function(_0x37b799,_0x5d2f8b){const _0x510c25=a716_0x51c0,_0x32de7a=_0x37b799();while(!![]){try{const _0x55a1eb=-parseInt(_0x510c25(0x1f1))/0x1*(-parseInt(_0x510c25(0x1e9))/0x2)+parseInt(_0x510c25(0x1ea))/0x3+-parseInt(_0x510c25(0x200))/0x4+-parseInt(_0x510c25(0x1ff))/0x5*(-parseInt(_0x510c25(0x1e6))/0x6)+-parseInt(_0x510c25(0x1d5))/0x7+parseInt(_0x510c25(0x1d2))/0x8*(parseInt(_0x510c25(0x1f7))/0x9)+-parseInt(_0x510c25(0x1fd))/0xa*(parseInt(_0x510c25(0x1f4))/0xb);if(_0x55a1eb===_0x5d2f8b)break;else _0x32de7a['push'](_0x32de7a['shift']());}catch(_0x24cdc3){_0x32de7a['push'](_0x32de7a['shift']());}}}(a716_0x1e35,0x7aa45));function a716_0x1e35(){const _0x1c6a5c=['shape','configurable','54rhoNyA','not','string','264744AlroPT','2526225iKwyTN','min','get','__importDefault','call','create','../../errors/AppError','3eFQLXo','__createBinding','__importStar','44yIYgZc','toString','(((.+)+)+)+$','135zPgiHF','__esModule','getOwnPropertyDescriptor','default','prototype','message','1354550UTioUE','apply','404955rlcVsR','3325416pMZaHc','validate','update','trim','239016lMAZxX','Defina\x20um\x20tempo\x20de\x20encerramento\x20maior\x20que\x200\x20ou\x20remova\x20a\x20mensagem','./AssociateWhatsappQueue','3785250eceeSn','../../models/Whatsapp','sequelize','__setModuleDefault','search','getOwnPropertyNames','constructor','defineProperty','Defina\x20um\x20tempo\x20para\x20aviso\x20maior\x20que\x200\x20ou\x20remova\x20a\x20mensagem','writable','boolean','object','ERR_WAPP_GREETING_REQUIRED','length','yup'];a716_0x1e35=function(){return _0x1c6a5c;};return a716_0x1e35();}var __createBinding=this&&this[a716_0x2b985f(0x1f2)]||(Object[a716_0x2b985f(0x1ef)]?function(_0xae7729,_0x4ec9d8,_0x385128,_0x2ded86){const _0x5083fd=a716_0x2b985f;if(_0x2ded86===undefined)_0x2ded86=_0x385128;var _0x1fa19c=Object[_0x5083fd(0x1f9)](_0x4ec9d8,_0x385128);(!_0x1fa19c||(_0x5083fd(0x1ec)in _0x1fa19c?!_0x4ec9d8[_0x5083fd(0x1f8)]:_0x1fa19c[_0x5083fd(0x1de)]||_0x1fa19c[_0x5083fd(0x1e5)]))&&(_0x1fa19c={'enumerable':!![],'get':function(){return _0x4ec9d8[_0x385128];}}),Object['defineProperty'](_0xae7729,_0x2ded86,_0x1fa19c);}:function(_0x26077e,_0x5a9136,_0x2df42f,_0x491ab9){if(_0x491ab9===undefined)_0x491ab9=_0x2df42f;_0x26077e[_0x491ab9]=_0x5a9136[_0x2df42f];}),__setModuleDefault=this&&this[a716_0x2b985f(0x1d8)]||(Object[a716_0x2b985f(0x1ef)]?function(_0x1b8367,_0x50d38){const _0x37c946=a716_0x2b985f;Object[_0x37c946(0x1dc)](_0x1b8367,_0x37c946(0x1fa),{'enumerable':!![],'value':_0x50d38});}:function(_0x6360f7,_0x387fc4){_0x6360f7['default']=_0x387fc4;}),__importStar=this&&this[a716_0x2b985f(0x1f3)]||(function(){const _0x22b6d9=(function(){let _0x2b0a31=!![];return function(_0x3b4bfa,_0xe2c536){const _0x49d148=_0x2b0a31?function(){const _0x26465c=a716_0x51c0;if(_0xe2c536){const _0x3e7a3c=_0xe2c536[_0x26465c(0x1fe)](_0x3b4bfa,arguments);return _0xe2c536=null,_0x3e7a3c;}}:function(){};return _0x2b0a31=![],_0x49d148;};}()),_0x4932f4=_0x22b6d9(this,function(){const _0x4c229f=a716_0x51c0;return _0x4932f4['toString']()[_0x4c229f(0x1d9)](_0x4c229f(0x1f6))[_0x4c229f(0x1f5)]()[_0x4c229f(0x1db)](_0x4932f4)[_0x4c229f(0x1d9)](_0x4c229f(0x1f6));});_0x4932f4();var _0xb6c59f=function(_0x44d1db){const _0x3f8e36=a716_0x51c0;return _0xb6c59f=Object[_0x3f8e36(0x1da)]||function(_0x37a77c){const _0x2a205d=_0x3f8e36;var _0xe1f9eb=[];for(var _0x481f33 in _0x37a77c)if(Object[_0x2a205d(0x1fb)]['hasOwnProperty'][_0x2a205d(0x1ee)](_0x37a77c,_0x481f33))_0xe1f9eb[_0xe1f9eb[_0x2a205d(0x1e2)]]=_0x481f33;return _0xe1f9eb;},_0xb6c59f(_0x44d1db);};return function(_0x164cee){const _0x43cbf0=a716_0x51c0;if(_0x164cee&&_0x164cee['__esModule'])return _0x164cee;var _0x43c5a8={};if(_0x164cee!=null){for(var _0x54f3af=_0xb6c59f(_0x164cee),_0xa7b92=0x0;_0xa7b92<_0x54f3af[_0x43cbf0(0x1e2)];_0xa7b92++)if(_0x54f3af[_0xa7b92]!==_0x43cbf0(0x1fa))__createBinding(_0x43c5a8,_0x164cee,_0x54f3af[_0xa7b92]);}return __setModuleDefault(_0x43c5a8,_0x164cee),_0x43c5a8;};}()),__importDefault=this&&this[a716_0x2b985f(0x1ed)]||function(_0xa0d666){const _0x414926=a716_0x2b985f;return _0xa0d666&&_0xa0d666[_0x414926(0x1f8)]?_0xa0d666:{'default':_0xa0d666};};function a716_0x51c0(_0x35c52e,_0xc49132){const _0x29d331=a716_0x1e35();return a716_0x51c0=function(_0x496172,_0x54b1ca){_0x496172=_0x496172-0x1cf;let _0x1e357f=_0x29d331[_0x496172];return _0x1e357f;},a716_0x51c0(_0x35c52e,_0xc49132);}Object[a716_0x2b985f(0x1dc)](exports,a716_0x2b985f(0x1f8),{'value':!![]});const Yup=__importStar(require(a716_0x2b985f(0x1e3))),sequelize_1=require(a716_0x2b985f(0x1d7)),AppError_1=__importDefault(require(a716_0x2b985f(0x1f0))),Whatsapp_1=__importDefault(require(a716_0x2b985f(0x1d6))),ShowWhatsAppService_1=__importDefault(require('./ShowWhatsAppService')),AssociateWhatsappQueue_1=__importDefault(require(a716_0x2b985f(0x1d4))),AssociateWhatsappFlow_1=__importDefault(require('./AssociateWhatsappFlow')),UpdateWhatsAppService=async({whatsappData:_0x2fb1b1,whatsappId:_0x59f26f,companyId:_0x141185})=>{const _0x1ccd8d=a716_0x2b985f,{name:_0x1abd60,status:_0x2728fd,isDefault:_0x31dc53,session:_0x23afc1,greetingMessage:_0x2ce8b3,greetingAcceptedMessage:_0x47b248,complationMessage:_0x2cf55a,outOfHoursMessage:_0x232f02,useRating:_0x139319,ratingMessage:_0x333aa3,transferMessage:_0xda8f1e,sendTransferMessage:_0x2bfb52,sendGreetingAccepted:_0x1de1d4,sendRejectCall:_0x1a2f7f,rejectCallMessage:_0xf6081,queueIds:queueIds=[],flowIds:flowIds=[],token:_0x1099de,timeSendQueue:_0x575c15,integrationId:_0x448f0f,sendIdQueue:sendIdQueue=null,maxUseBotQueues:_0x3d00ec,expiresTicket:_0x2ca8ce,expiresInactiveMessage:_0x45c369,allowGroup:_0x9315b2,importOldMessages:_0x1cf55b,whenExpireTicket:_0x52c5ae,inactiveMessageTime:_0x3fc3e3,inactiveMessage:_0xef2045,automaticRestart:_0xb80519,period:_0x528c06,lastRestartAt:_0x4759e8,collectiveVacationMessage:_0x5e6904,collectiveVacationStart:_0x1170d6,collectiveVacationEnd:_0x5a9deb}=_0x2fb1b1,_0x33e9f9=Yup[_0x1ccd8d(0x1e0)]()[_0x1ccd8d(0x1e4)]({'name':Yup[_0x1ccd8d(0x1e8)]()[_0x1ccd8d(0x1eb)](0x2),'status':Yup[_0x1ccd8d(0x1e8)](),'isDefault':Yup[_0x1ccd8d(0x1df)]()});try{await _0x33e9f9[_0x1ccd8d(0x1cf)]({'name':_0x1abd60,'status':_0x2728fd,'isDefault':_0x31dc53});}catch(_0x5dee36){throw new AppError_1[(_0x1ccd8d(0x1fa))](_0x5dee36[_0x1ccd8d(0x1fc)]);}if(queueIds[_0x1ccd8d(0x1e2)]>0x1&&!_0x2ce8b3)throw new AppError_1[(_0x1ccd8d(0x1fa))](_0x1ccd8d(0x1e1));const _0x5d79cf=parseInt(_0x2ca8ce?.[_0x1ccd8d(0x1f5)]()||'0',0xa),_0x2f1919=parseInt(_0x3fc3e3?.[_0x1ccd8d(0x1f5)]()||'0',0xa),_0x389676=_0x45c369?.[_0x1ccd8d(0x1d1)]()||'',_0x1d62bc=_0xef2045?.['trim']()||'';if(_0x5d79cf>0x0&&!_0x389676)throw new AppError_1[(_0x1ccd8d(0x1fa))]('Defina\x20uma\x20mensagem\x20de\x20encerramento\x20por\x20inatividade\x20ou\x20configure\x20o\x20tempo\x20para\x200');if(_0x389676&&_0x5d79cf===0x0)throw new AppError_1[(_0x1ccd8d(0x1fa))](_0x1ccd8d(0x1d3));if(_0x2f1919>0x0&&!_0x1d62bc)throw new AppError_1[(_0x1ccd8d(0x1fa))]('Defina\x20uma\x20mensagem\x20de\x20aviso\x20de\x20inatividade\x20ou\x20configure\x20o\x20tempo\x20para\x200');if(_0x1d62bc&&_0x2f1919===0x0)throw new AppError_1[(_0x1ccd8d(0x1fa))](_0x1ccd8d(0x1dd));let _0xad192c=null;_0x31dc53&&(_0xad192c=await Whatsapp_1[_0x1ccd8d(0x1fa)]['findOne']({'where':{'isDefault':!![],'id':{[sequelize_1['Op'][_0x1ccd8d(0x1e7)]]:_0x59f26f},'companyId':_0x141185}}),_0xad192c&&await _0xad192c[_0x1ccd8d(0x1d0)]({'isDefault':![]}));const _0x15987e=await(0x0,ShowWhatsAppService_1[_0x1ccd8d(0x1fa)])(_0x59f26f,_0x141185);return await _0x15987e[_0x1ccd8d(0x1d0)]({'name':_0x1abd60,'status':_0x2728fd,'session':_0x23afc1,'greetingMessage':_0x2ce8b3,'greetingAcceptedMessage':_0x47b248,'complationMessage':_0x2cf55a,'outOfHoursMessage':_0x232f02,'useRating':_0x139319,'ratingMessage':_0x333aa3,'isDefault':_0x31dc53,'companyId':_0x141185,'token':_0x1099de,'transferMessage':_0xda8f1e,'sendTransferMessage':_0x2bfb52,'sendGreetingAccepted':_0x1de1d4,'sendRejectCall':_0x1a2f7f,'rejectCallMessage':_0xf6081,'integrationId':_0x448f0f?_0x448f0f:null,'maxUseBotQueues':_0x3d00ec,'timeSendQueue':_0x575c15,'sendIdQueue':sendIdQueue,'expiresTicket':_0x2ca8ce,'expiresInactiveMessage':_0x45c369,'allowGroup':_0x9315b2,'importOldMessages':_0x1cf55b,'whenExpireTicket':_0x52c5ae,'inactiveMessageTime':_0x3fc3e3,'inactiveMessage':_0xef2045,'automaticRestart':_0xb80519,'period':_0x528c06,'lastRestartAt':_0x4759e8,'collectiveVacationMessage':_0x5e6904,'collectiveVacationStart':_0x1170d6||null,'collectiveVacationEnd':_0x5a9deb||null}),await(0x0,AssociateWhatsappQueue_1[_0x1ccd8d(0x1fa)])(_0x15987e,queueIds),await(0x0,AssociateWhatsappFlow_1['default'])(_0x15987e,flowIds),{'whatsapp':_0x15987e,'oldDefaultWhatsapp':_0xad192c};};exports[a716_0x2b985f(0x1fa)]=UpdateWhatsAppService;