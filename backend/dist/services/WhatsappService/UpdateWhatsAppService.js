'use strict';const a715_0x18ee61=a715_0x3cce;(function(_0xe61624,_0x4919f2){const _0x5f2eeb=a715_0x3cce,_0x5c5797=_0xe61624();while(!![]){try{const _0x522f14=-parseInt(_0x5f2eeb(0x136))/0x1+-parseInt(_0x5f2eeb(0x127))/0x2+parseInt(_0x5f2eeb(0x133))/0x3*(-parseInt(_0x5f2eeb(0x13d))/0x4)+-parseInt(_0x5f2eeb(0x121))/0x5*(parseInt(_0x5f2eeb(0x120))/0x6)+parseInt(_0x5f2eeb(0x125))/0x7*(parseInt(_0x5f2eeb(0x138))/0x8)+-parseInt(_0x5f2eeb(0x131))/0x9*(parseInt(_0x5f2eeb(0x13a))/0xa)+parseInt(_0x5f2eeb(0x128))/0xb*(parseInt(_0x5f2eeb(0x116))/0xc);if(_0x522f14===_0x4919f2)break;else _0x5c5797['push'](_0x5c5797['shift']());}catch(_0x5dabe5){_0x5c5797['push'](_0x5c5797['shift']());}}}(a715_0x2a00,0xadd25));function a715_0x3cce(_0x46f02f,_0xf6f38d){const _0x14f519=a715_0x2a00();return a715_0x3cce=function(_0x9535b0,_0x547f0c){_0x9535b0=_0x9535b0-0x112;let _0x2a00cc=_0x14f519[_0x9535b0];return _0x2a00cc;},a715_0x3cce(_0x46f02f,_0xf6f38d);}function a715_0x2a00(){const _0x136a71=['./ShowWhatsAppService','67708tZoseQ','shape','update','__esModule','ERR_WAPP_GREETING_REQUIRED','yup','276BqFzZO','trim','./AssociateWhatsappFlow','../../models/Whatsapp','configurable','__importDefault','getOwnPropertyDescriptor','Defina\x20uma\x20mensagem\x20de\x20aviso\x20de\x20inatividade\x20ou\x20configure\x20o\x20tempo\x20para\x200','default','writable','241386YNeikC','135FNlpIr','create','message','(((.+)+)+)+$','7aeXXvS','boolean','760114DFcJio','1367289xzxxQL','toString','validate','__setModuleDefault','sequelize','length','__createBinding','call','Defina\x20um\x20tempo\x20para\x20aviso\x20maior\x20que\x200\x20ou\x20remova\x20a\x20mensagem','5463WaitAt','string','168qogZsG','defineProperty','Defina\x20uma\x20mensagem\x20de\x20encerramento\x20por\x20inatividade\x20ou\x20configure\x20o\x20tempo\x20para\x200','580993iiUXJY','object','7582744XVvjCp','apply','1640fPeTmr','Defina\x20um\x20tempo\x20de\x20encerramento\x20maior\x20que\x200\x20ou\x20remova\x20a\x20mensagem'];a715_0x2a00=function(){return _0x136a71;};return a715_0x2a00();}var __createBinding=this&&this[a715_0x18ee61(0x12e)]||(Object[a715_0x18ee61(0x122)]?function(_0x112809,_0x1c44d5,_0x16a67d,_0x4b9b63){const _0x2bcfe7=a715_0x18ee61;if(_0x4b9b63===undefined)_0x4b9b63=_0x16a67d;var _0x5e5f4f=Object[_0x2bcfe7(0x11c)](_0x1c44d5,_0x16a67d);(!_0x5e5f4f||('get'in _0x5e5f4f?!_0x1c44d5[_0x2bcfe7(0x113)]:_0x5e5f4f[_0x2bcfe7(0x11f)]||_0x5e5f4f[_0x2bcfe7(0x11a)]))&&(_0x5e5f4f={'enumerable':!![],'get':function(){return _0x1c44d5[_0x16a67d];}}),Object[_0x2bcfe7(0x134)](_0x112809,_0x4b9b63,_0x5e5f4f);}:function(_0x413092,_0x4a9431,_0x32bf24,_0x342162){if(_0x342162===undefined)_0x342162=_0x32bf24;_0x413092[_0x342162]=_0x4a9431[_0x32bf24];}),__setModuleDefault=this&&this[a715_0x18ee61(0x12b)]||(Object[a715_0x18ee61(0x122)]?function(_0x4df318,_0x4391c5){const _0x536f4b=a715_0x18ee61;Object[_0x536f4b(0x134)](_0x4df318,_0x536f4b(0x11e),{'enumerable':!![],'value':_0x4391c5});}:function(_0x68d33a,_0x5490a3){const _0x15813f=a715_0x18ee61;_0x68d33a[_0x15813f(0x11e)]=_0x5490a3;}),__importStar=this&&this['__importStar']||(function(){const _0x26c9f3=(function(){let _0x30a460=!![];return function(_0x1e296f,_0x5d7e89){const _0x488730=_0x30a460?function(){const _0x2da4b6=a715_0x3cce;if(_0x5d7e89){const _0x5a6754=_0x5d7e89[_0x2da4b6(0x139)](_0x1e296f,arguments);return _0x5d7e89=null,_0x5a6754;}}:function(){};return _0x30a460=![],_0x488730;};}()),_0x1d6195=_0x26c9f3(this,function(){const _0x57bbef=a715_0x3cce;return _0x1d6195['toString']()['search'](_0x57bbef(0x124))['toString']()['constructor'](_0x1d6195)['search'](_0x57bbef(0x124));});_0x1d6195();var _0x318ae9=function(_0x14d8a3){return _0x318ae9=Object['getOwnPropertyNames']||function(_0x476b0f){const _0x493800=a715_0x3cce;var _0x5accfc=[];for(var _0xf3415a in _0x476b0f)if(Object['prototype']['hasOwnProperty'][_0x493800(0x12f)](_0x476b0f,_0xf3415a))_0x5accfc[_0x5accfc[_0x493800(0x12d)]]=_0xf3415a;return _0x5accfc;},_0x318ae9(_0x14d8a3);};return function(_0x2c02eb){const _0x209fd4=a715_0x3cce;if(_0x2c02eb&&_0x2c02eb['__esModule'])return _0x2c02eb;var _0x18c281={};if(_0x2c02eb!=null){for(var _0x5272ad=_0x318ae9(_0x2c02eb),_0x1e6737=0x0;_0x1e6737<_0x5272ad['length'];_0x1e6737++)if(_0x5272ad[_0x1e6737]!==_0x209fd4(0x11e))__createBinding(_0x18c281,_0x2c02eb,_0x5272ad[_0x1e6737]);}return __setModuleDefault(_0x18c281,_0x2c02eb),_0x18c281;};}()),__importDefault=this&&this[a715_0x18ee61(0x11b)]||function(_0x1af91e){const _0x215ebf=a715_0x18ee61;return _0x1af91e&&_0x1af91e[_0x215ebf(0x113)]?_0x1af91e:{'default':_0x1af91e};};Object[a715_0x18ee61(0x134)](exports,a715_0x18ee61(0x113),{'value':!![]});const Yup=__importStar(require(a715_0x18ee61(0x115))),sequelize_1=require(a715_0x18ee61(0x12c)),AppError_1=__importDefault(require('../../errors/AppError')),Whatsapp_1=__importDefault(require(a715_0x18ee61(0x119))),ShowWhatsAppService_1=__importDefault(require(a715_0x18ee61(0x13c))),AssociateWhatsappQueue_1=__importDefault(require('./AssociateWhatsappQueue')),AssociateWhatsappFlow_1=__importDefault(require(a715_0x18ee61(0x118))),UpdateWhatsAppService=async({whatsappData:_0xe4d0da,whatsappId:_0x1c0d94,companyId:_0x41281d})=>{const _0x2097c5=a715_0x18ee61,{name:_0x4c0583,status:_0x1ffa02,isDefault:_0x5d32b4,session:_0x27f94a,greetingMessage:_0x1dcc2d,greetingAcceptedMessage:_0x12ae8b,complationMessage:_0x15624f,outOfHoursMessage:_0x42c233,useRating:_0x4e9a94,ratingMessage:_0x204cfe,transferMessage:_0x2e98d1,sendTransferMessage:_0x3f9189,sendGreetingAccepted:_0x120034,sendRejectCall:_0x214fba,rejectCallMessage:_0x2e507f,queueIds:queueIds=[],flowIds:flowIds=[],token:_0x59bb1,timeSendQueue:_0x4ac4c3,integrationId:_0x2d897f,sendIdQueue:sendIdQueue=null,maxUseBotQueues:_0x1d8172,expiresTicket:_0x3d2966,expiresInactiveMessage:_0x4d289f,allowGroup:_0x4b6aee,importOldMessages:_0x4c7867,whenExpireTicket:_0x5ae1a0,inactiveMessageTime:_0x4b8008,inactiveMessage:_0x49fcfb,automaticRestart:_0x351f6a,period:_0x26e8a3,lastRestartAt:_0x14e87a}=_0xe4d0da,_0x58160d=Yup[_0x2097c5(0x137)]()[_0x2097c5(0x13e)]({'name':Yup[_0x2097c5(0x132)]()['min'](0x2),'status':Yup['string'](),'isDefault':Yup[_0x2097c5(0x126)]()});try{await _0x58160d[_0x2097c5(0x12a)]({'name':_0x4c0583,'status':_0x1ffa02,'isDefault':_0x5d32b4});}catch(_0x3a9b65){throw new AppError_1[(_0x2097c5(0x11e))](_0x3a9b65[_0x2097c5(0x123)]);}if(queueIds[_0x2097c5(0x12d)]>0x1&&!_0x1dcc2d)throw new AppError_1[(_0x2097c5(0x11e))](_0x2097c5(0x114));const _0x23a754=parseInt(_0x3d2966?.[_0x2097c5(0x129)]()||'0',0xa),_0x3d28be=parseInt(_0x4b8008?.['toString']()||'0',0xa),_0x4d3a2a=_0x4d289f?.[_0x2097c5(0x117)]()||'',_0xb4811d=_0x49fcfb?.[_0x2097c5(0x117)]()||'';if(_0x23a754>0x0&&!_0x4d3a2a)throw new AppError_1['default'](_0x2097c5(0x135));if(_0x4d3a2a&&_0x23a754===0x0)throw new AppError_1['default'](_0x2097c5(0x13b));if(_0x3d28be>0x0&&!_0xb4811d)throw new AppError_1[(_0x2097c5(0x11e))](_0x2097c5(0x11d));if(_0xb4811d&&_0x3d28be===0x0)throw new AppError_1[(_0x2097c5(0x11e))](_0x2097c5(0x130));let _0x3eb740=null;_0x5d32b4&&(_0x3eb740=await Whatsapp_1['default']['findOne']({'where':{'isDefault':!![],'id':{[sequelize_1['Op']['not']]:_0x1c0d94},'companyId':_0x41281d}}),_0x3eb740&&await _0x3eb740[_0x2097c5(0x112)]({'isDefault':![]}));const _0x146099=await(0x0,ShowWhatsAppService_1[_0x2097c5(0x11e)])(_0x1c0d94,_0x41281d);return await _0x146099['update']({'name':_0x4c0583,'status':_0x1ffa02,'session':_0x27f94a,'greetingMessage':_0x1dcc2d,'greetingAcceptedMessage':_0x12ae8b,'complationMessage':_0x15624f,'outOfHoursMessage':_0x42c233,'useRating':_0x4e9a94,'ratingMessage':_0x204cfe,'isDefault':_0x5d32b4,'companyId':_0x41281d,'token':_0x59bb1,'transferMessage':_0x2e98d1,'sendTransferMessage':_0x3f9189,'sendGreetingAccepted':_0x120034,'sendRejectCall':_0x214fba,'rejectCallMessage':_0x2e507f,'integrationId':_0x2d897f?_0x2d897f:null,'maxUseBotQueues':_0x1d8172,'timeSendQueue':_0x4ac4c3,'sendIdQueue':sendIdQueue,'expiresTicket':_0x3d2966,'expiresInactiveMessage':_0x4d289f,'allowGroup':_0x4b6aee,'importOldMessages':_0x4c7867,'whenExpireTicket':_0x5ae1a0,'inactiveMessageTime':_0x4b8008,'inactiveMessage':_0x49fcfb,'automaticRestart':_0x351f6a,'period':_0x26e8a3,'lastRestartAt':_0x14e87a}),await(0x0,AssociateWhatsappQueue_1[_0x2097c5(0x11e)])(_0x146099,queueIds),await(0x0,AssociateWhatsappFlow_1[_0x2097c5(0x11e)])(_0x146099,flowIds),{'whatsapp':_0x146099,'oldDefaultWhatsapp':_0x3eb740};};exports[a715_0x18ee61(0x11e)]=UpdateWhatsAppService;