function a559_0x3e58(){const _0x68e0df=['toString','get','__importDefault','string','1000768JbArjs','shape','./AssociateWhatsappQueue','message','create','constructor','10466082dwPsel','search','length','(((.+)+)+)+$','apply','6FAtxPu','11401648SGwfBy','8353219FIkzqf','default','1987725zwAAAy','defineProperty','findOne','getOwnPropertyDescriptor','6244SWhVoH','object','min','ERR_WAPP_GREETING_REQUIRED','validate','__esModule','call','../../errors/AppError','prototype','../../models/Whatsapp','writable','1573616vxpWfR','hasOwnProperty','boolean','configurable'];a559_0x3e58=function(){return _0x68e0df;};return a559_0x3e58();}const a559_0x4ad028=a559_0x44ad;(function(_0x3c9bc0,_0x250a09){const _0x46c585=a559_0x44ad,_0x101ab6=_0x3c9bc0();while(!![]){try{const _0x3f3be9=-parseInt(_0x46c585(0x161))/0x1+-parseInt(_0x46c585(0x14e))/0x2+parseInt(_0x46c585(0x146))/0x3*(parseInt(_0x46c585(0x159))/0x4)+-parseInt(_0x46c585(0x14a))/0x5+parseInt(_0x46c585(0x141))/0x6+parseInt(_0x46c585(0x148))/0x7+-parseInt(_0x46c585(0x147))/0x8;if(_0x3f3be9===_0x250a09)break;else _0x101ab6['push'](_0x101ab6['shift']());}catch(_0x4793dc){_0x101ab6['push'](_0x101ab6['shift']());}}}(a559_0x3e58,0xdb327));const a559_0x26e7fc=(function(){let _0x1e43c8=!![];return function(_0x352be6,_0x84528){const _0x65eef1=_0x1e43c8?function(){const _0x5c196e=a559_0x44ad;if(_0x84528){const _0x14156a=_0x84528[_0x5c196e(0x145)](_0x352be6,arguments);return _0x84528=null,_0x14156a;}}:function(){};return _0x1e43c8=![],_0x65eef1;};}()),a559_0x357b67=a559_0x26e7fc(this,function(){const _0x1b9200=a559_0x44ad;return a559_0x357b67[_0x1b9200(0x15d)]()[_0x1b9200(0x142)](_0x1b9200(0x144))[_0x1b9200(0x15d)]()[_0x1b9200(0x140)](a559_0x357b67)['search'](_0x1b9200(0x144));});function a559_0x44ad(_0x23c75b,_0x381755){const _0x4838d2=a559_0x3e58();return a559_0x44ad=function(_0x357b67,_0x26e7fc){_0x357b67=_0x357b67-0x13d;let _0x3e58b3=_0x4838d2[_0x357b67];return _0x3e58b3;},a559_0x44ad(_0x23c75b,_0x381755);}a559_0x357b67();'use strict';var __createBinding=this&&this['__createBinding']||(Object[a559_0x4ad028(0x13f)]?function(_0x15632e,_0xeb19c9,_0x48d96a,_0x5f2e2c){const _0x1a841e=a559_0x4ad028;if(_0x5f2e2c===undefined)_0x5f2e2c=_0x48d96a;var _0x34b041=Object[_0x1a841e(0x14d)](_0xeb19c9,_0x48d96a);(!_0x34b041||(_0x1a841e(0x15e)in _0x34b041?!_0xeb19c9['__esModule']:_0x34b041[_0x1a841e(0x158)]||_0x34b041[_0x1a841e(0x15c)]))&&(_0x34b041={'enumerable':!![],'get':function(){return _0xeb19c9[_0x48d96a];}}),Object[_0x1a841e(0x14b)](_0x15632e,_0x5f2e2c,_0x34b041);}:function(_0x1d4d1d,_0x438ce5,_0x3d12e1,_0x276395){if(_0x276395===undefined)_0x276395=_0x3d12e1;_0x1d4d1d[_0x276395]=_0x438ce5[_0x3d12e1];}),__setModuleDefault=this&&this['__setModuleDefault']||(Object[a559_0x4ad028(0x13f)]?function(_0x4ec6f2,_0x37e9aa){Object['defineProperty'](_0x4ec6f2,'default',{'enumerable':!![],'value':_0x37e9aa});}:function(_0x61137b,_0x36a8cf){const _0x17f346=a559_0x4ad028;_0x61137b[_0x17f346(0x149)]=_0x36a8cf;}),__importStar=this&&this['__importStar']||function(_0x2c4351){const _0xc8ed69=a559_0x4ad028;if(_0x2c4351&&_0x2c4351[_0xc8ed69(0x153)])return _0x2c4351;var _0x4848a2={};if(_0x2c4351!=null){for(var _0x20e367 in _0x2c4351)if(_0x20e367!==_0xc8ed69(0x149)&&Object[_0xc8ed69(0x156)][_0xc8ed69(0x15a)][_0xc8ed69(0x154)](_0x2c4351,_0x20e367))__createBinding(_0x4848a2,_0x2c4351,_0x20e367);}return __setModuleDefault(_0x4848a2,_0x2c4351),_0x4848a2;},__importDefault=this&&this[a559_0x4ad028(0x15f)]||function(_0x10eff9){const _0xf04ebe=a559_0x4ad028;return _0x10eff9&&_0x10eff9[_0xf04ebe(0x153)]?_0x10eff9:{'default':_0x10eff9};};Object[a559_0x4ad028(0x14b)](exports,a559_0x4ad028(0x153),{'value':!![]});const Yup=__importStar(require('yup')),sequelize_1=require('sequelize'),AppError_1=__importDefault(require(a559_0x4ad028(0x155))),Whatsapp_1=__importDefault(require(a559_0x4ad028(0x157))),ShowWhatsAppService_1=__importDefault(require('./ShowWhatsAppService')),AssociateWhatsappQueue_1=__importDefault(require(a559_0x4ad028(0x13d))),UpdateWhatsAppService=async({whatsappData:_0x189b00,whatsappId:_0x4dd9bd,companyId:_0x53387f})=>{const _0x45d575=a559_0x4ad028,_0x52a415=Yup[_0x45d575(0x14f)]()[_0x45d575(0x162)]({'name':Yup[_0x45d575(0x160)]()[_0x45d575(0x150)](0x2),'status':Yup['string'](),'isDefault':Yup[_0x45d575(0x15b)]()}),{name:_0x2ecbe2,status:_0x5a23bd,isDefault:_0x34cad7,session:_0x5a4e70,greetingMessage:_0x5c3cf0,complationMessage:_0x4f0907,outOfHoursMessage:_0x4b3992,ratingMessage:_0x65f363,queueIds:queueIds=[],token:_0x1635d4,timeSendQueue:_0x3ea0d0,sendIdQueue:sendIdQueue=null,integrationId:_0x333d45,maxUseBotQueues:_0x7395ab,timeUseBotQueues:_0x25233d,expiresTicket:_0x181b68,expiresInactiveMessage:_0x5761a3,allowGroup:_0x18576f,importOldMessages:_0x4b350b,importRecentMessages:_0xf5d02c,closedTicketsPostImported:_0x5704f3,importOldMessagesGroups:_0xb8be0c}=_0x189b00;try{await _0x52a415[_0x45d575(0x152)]({'name':_0x2ecbe2,'status':_0x5a23bd,'isDefault':_0x34cad7});}catch(_0x1247b6){throw new AppError_1['default'](_0x1247b6[_0x45d575(0x13e)]);}if(queueIds[_0x45d575(0x143)]>0x1&&!_0x5c3cf0)throw new AppError_1['default'](_0x45d575(0x151));let _0x25d80f=null;_0x34cad7&&(_0x25d80f=await Whatsapp_1[_0x45d575(0x149)][_0x45d575(0x14c)]({'where':{'isDefault':!![],'id':{[sequelize_1['Op']['not']]:_0x4dd9bd},'companyId':_0x53387f}}),_0x25d80f&&await _0x25d80f['update']({'isDefault':![]}));const _0x80c81b=await(0x0,ShowWhatsAppService_1['default'])(_0x4dd9bd,_0x53387f);return await _0x80c81b['update']({'name':_0x2ecbe2,'status':_0x5a23bd,'session':_0x5a4e70,'greetingMessage':_0x5c3cf0,'complationMessage':_0x4f0907,'outOfHoursMessage':_0x4b3992,'ratingMessage':_0x65f363,'isDefault':_0x34cad7,'companyId':_0x53387f,'token':_0x1635d4,'timeSendQueue':_0x3ea0d0,'sendIdQueue':sendIdQueue,'integrationId':_0x333d45?_0x333d45:null,'maxUseBotQueues':_0x7395ab,'timeUseBotQueues':_0x25233d,'expiresTicket':_0x181b68,'expiresInactiveMessage':_0x5761a3,'allowGroup':_0x18576f,'importOldMessages':_0x4b350b,'importRecentMessages':_0xf5d02c,'closedTicketsPostImported':_0x5704f3,'importOldMessagesGroups':_0xb8be0c}),await(0x0,AssociateWhatsappQueue_1[_0x45d575(0x149)])(_0x80c81b,queueIds),{'whatsapp':_0x80c81b,'oldDefaultWhatsapp':_0x25d80f};};exports[a559_0x4ad028(0x149)]=UpdateWhatsAppService;