'use strict';function a590_0x2344(_0x4d1142,_0x455e9e){var _0x5ce7c2=a590_0x2cea();return a590_0x2344=function(_0x4275da,_0x46c9ce){_0x4275da=_0x4275da-0x1cf;var _0x2ceac8=_0x5ce7c2[_0x4275da];return _0x2ceac8;},a590_0x2344(_0x4d1142,_0x455e9e);}var a590_0x3d5cc5=a590_0x2344;(function(_0x19f5f4,_0x200548){var _0x53c7a6=a590_0x2344,_0x3e8bfe=_0x19f5f4();while(!![]){try{var _0x53fd6b=-parseInt(_0x53c7a6(0x1d9))/0x1+parseInt(_0x53c7a6(0x1ef))/0x2+parseInt(_0x53c7a6(0x1e4))/0x3+parseInt(_0x53c7a6(0x1dc))/0x4+-parseInt(_0x53c7a6(0x1dd))/0x5+parseInt(_0x53c7a6(0x1d1))/0x6+parseInt(_0x53c7a6(0x1e6))/0x7*(-parseInt(_0x53c7a6(0x1de))/0x8);if(_0x53fd6b===_0x200548)break;else _0x3e8bfe['push'](_0x3e8bfe['shift']());}catch(_0x103ef5){_0x3e8bfe['push'](_0x3e8bfe['shift']());}}}(a590_0x2cea,0x5ea92));var __createBinding=this&&this[a590_0x3d5cc5(0x1e3)]||(Object[a590_0x3d5cc5(0x1e2)]?function(_0x183a35,_0x1f1080,_0x1b937e,_0x6f32c5){var _0x56f4dd=a590_0x3d5cc5;if(_0x6f32c5===undefined)_0x6f32c5=_0x1b937e;var _0x23bd5b=Object['getOwnPropertyDescriptor'](_0x1f1080,_0x1b937e);(!_0x23bd5b||(_0x56f4dd(0x1d7)in _0x23bd5b?!_0x1f1080[_0x56f4dd(0x1d3)]:_0x23bd5b[_0x56f4dd(0x1e8)]||_0x23bd5b[_0x56f4dd(0x1ea)]))&&(_0x23bd5b={'enumerable':!![],'get':function(){return _0x1f1080[_0x1b937e];}}),Object['defineProperty'](_0x183a35,_0x6f32c5,_0x23bd5b);}:function(_0x46027e,_0x5bd5e6,_0x5f00a7,_0x44a529){if(_0x44a529===undefined)_0x44a529=_0x5f00a7;_0x46027e[_0x44a529]=_0x5bd5e6[_0x5f00a7];}),__setModuleDefault=this&&this[a590_0x3d5cc5(0x1ec)]||(Object['create']?function(_0x4bfadc,_0x44e6f6){var _0x4a5545=a590_0x3d5cc5;Object['defineProperty'](_0x4bfadc,_0x4a5545(0x1e7),{'enumerable':!![],'value':_0x44e6f6});}:function(_0x5f8dd1,_0x476383){var _0x2aa526=a590_0x3d5cc5;_0x5f8dd1[_0x2aa526(0x1e7)]=_0x476383;}),__importStar=this&&this['__importStar']||(function(){var _0x766115=(function(){var _0x2915e9=!![];return function(_0x37e0b4,_0x389aef){var _0x1f0d14=_0x2915e9?function(){var _0x55cc91=a590_0x2344;if(_0x389aef){var _0x29e23f=_0x389aef[_0x55cc91(0x1d0)](_0x37e0b4,arguments);return _0x389aef=null,_0x29e23f;}}:function(){};return _0x2915e9=![],_0x1f0d14;};}()),_0xf0bb5b=_0x766115(this,function(){var _0x452e1d=a590_0x2344;return _0xf0bb5b[_0x452e1d(0x1cf)]()[_0x452e1d(0x1d5)](_0x452e1d(0x1df))[_0x452e1d(0x1cf)]()[_0x452e1d(0x1da)](_0xf0bb5b)[_0x452e1d(0x1d5)](_0x452e1d(0x1df));});_0xf0bb5b();var _0x56c570=function(_0x54f95b){var _0x4c379d=a590_0x2344;return _0x56c570=Object[_0x4c379d(0x1e9)]||function(_0x32b08a){var _0x285629=_0x4c379d,_0x2a55a3=[];for(var _0x147024 in _0x32b08a)if(Object['prototype'][_0x285629(0x1e5)]['call'](_0x32b08a,_0x147024))_0x2a55a3[_0x2a55a3['length']]=_0x147024;return _0x2a55a3;},_0x56c570(_0x54f95b);};return function(_0x37a880){var _0x41ebf5=a590_0x2344;if(_0x37a880&&_0x37a880[_0x41ebf5(0x1d3)])return _0x37a880;var _0x1d8119={};if(_0x37a880!=null){for(var _0x150167=_0x56c570(_0x37a880),_0x417670=0x0;_0x417670<_0x150167[_0x41ebf5(0x1ee)];_0x417670++)if(_0x150167[_0x417670]!==_0x41ebf5(0x1e7))__createBinding(_0x1d8119,_0x37a880,_0x150167[_0x417670]);}return __setModuleDefault(_0x1d8119,_0x37a880),_0x1d8119;};}()),__importDefault=this&&this[a590_0x3d5cc5(0x1e0)]||function(_0x59b5f9){var _0x2f9eed=a590_0x3d5cc5;return _0x59b5f9&&_0x59b5f9[_0x2f9eed(0x1d3)]?_0x59b5f9:{'default':_0x59b5f9};};Object[a590_0x3d5cc5(0x1d4)](exports,a590_0x3d5cc5(0x1d3),{'value':!![]});const Yup=__importStar(require(a590_0x3d5cc5(0x1f1))),sequelize_1=require(a590_0x3d5cc5(0x1e1)),AppError_1=__importDefault(require('../../errors/AppError')),Whatsapp_1=__importDefault(require(a590_0x3d5cc5(0x1f2))),ShowWhatsAppService_1=__importDefault(require(a590_0x3d5cc5(0x1db))),AssociateWhatsappQueue_1=__importDefault(require(a590_0x3d5cc5(0x1f0))),UpdateWhatsAppService=async({whatsappData:_0x58a56f,whatsappId:_0x451d2c,companyId:_0x192fad})=>{var _0x3cce98=a590_0x3d5cc5;const {name:_0x46753c,status:_0x50b6cd,isDefault:_0x4af1ab,session:_0x38eceb,greetingMessage:_0x2cb977,complationMessage:_0x58955f,outOfHoursMessage:_0xf33031,useRating:_0x342ada,ratingMessage:_0x40d5ae,transferMessage:_0x51d2b3,queueIds:queueIds=[],token:_0x5a3a9b,timeSendQueue:_0x5ac5cc,integrationId:_0x564998,sendIdQueue:sendIdQueue=null,maxUseBotQueues:_0x57b0a0,expiresTicket:_0x4cd2d7,expiresInactiveMessage:_0x34615f,allowGroup:_0x4892aa,importOldMessages:_0x42a7f8,schedules:_0x100756,whenExpireTicket:_0x3af3cf,inactiveMessageTime:_0x48cb38,inactiveMessage:_0x429ea3,automaticRestart:_0x3976fb,period:_0x4ff932,lastRestartAt:_0x186217}=_0x58a56f,_0x4a734e=Yup['object']()['shape']({'name':Yup[_0x3cce98(0x1d2)]()[_0x3cce98(0x1eb)](0x2),'status':Yup[_0x3cce98(0x1d2)](),'isDefault':Yup['boolean']()});try{await _0x4a734e['validate']({'name':_0x46753c,'status':_0x50b6cd,'isDefault':_0x4af1ab});}catch(_0x4b2157){throw new AppError_1[(_0x3cce98(0x1e7))](_0x4b2157['message']);}if(queueIds[_0x3cce98(0x1ee)]>0x1&&!_0x2cb977)throw new AppError_1['default']('ERR_WAPP_GREETING_REQUIRED');let _0x4eff18=null;_0x4af1ab&&(_0x4eff18=await Whatsapp_1[_0x3cce98(0x1e7)][_0x3cce98(0x1ed)]({'where':{'isDefault':!![],'id':{[sequelize_1['Op'][_0x3cce98(0x1d6)]]:_0x451d2c},'companyId':_0x192fad}}),_0x4eff18&&await _0x4eff18[_0x3cce98(0x1d8)]({'isDefault':![]}));const _0x225969=await(0x0,ShowWhatsAppService_1[_0x3cce98(0x1e7)])(_0x451d2c,_0x192fad);return await _0x225969['update']({'name':_0x46753c,'status':_0x50b6cd,'session':_0x38eceb,'greetingMessage':_0x2cb977,'complationMessage':_0x58955f,'outOfHoursMessage':_0xf33031,'useRating':_0x342ada,'ratingMessage':_0x40d5ae,'isDefault':_0x4af1ab,'companyId':_0x192fad,'token':_0x5a3a9b,'transferMessage':_0x51d2b3,'integrationId':_0x564998?_0x564998:null,'maxUseBotQueues':_0x57b0a0,'timeSendQueue':_0x5ac5cc,'sendIdQueue':sendIdQueue,'expiresTicket':_0x4cd2d7,'expiresInactiveMessage':_0x34615f,'allowGroup':_0x4892aa,'importOldMessages':_0x42a7f8,'schedules':_0x100756,'whenExpireTicket':_0x3af3cf,'inactiveMessageTime':_0x48cb38,'inactiveMessage':_0x429ea3,'automaticRestart':_0x3976fb,'period':_0x4ff932,'lastRestartAt':_0x186217}),await(0x0,AssociateWhatsappQueue_1[_0x3cce98(0x1e7)])(_0x225969,queueIds),{'whatsapp':_0x225969,'oldDefaultWhatsapp':_0x4eff18};};exports[a590_0x3d5cc5(0x1e7)]=UpdateWhatsAppService;function a590_0x2cea(){var _0x4c9df7=['findOne','length','527016lcqhey','./AssociateWhatsappQueue','yup','../../models/Whatsapp','toString','apply','3993540YZoGhm','string','__esModule','defineProperty','search','not','get','update','308179JxoQjR','constructor','./ShowWhatsAppService','2614596BuAgds','3253445CDSHTm','39528kTHVra','(((.+)+)+)+$','__importDefault','sequelize','create','__createBinding','1322304tTjUeo','hasOwnProperty','959OEDrEb','default','writable','getOwnPropertyNames','configurable','min','__setModuleDefault'];a590_0x2cea=function(){return _0x4c9df7;};return a590_0x2cea();}