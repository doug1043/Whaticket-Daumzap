'use strict';var a595_0x142169=a595_0x3cf0;function a595_0x10e2(){var _0x9936c7=['77zComkk','54kxteGE','787sTEOhd','4515376HNcRAv','prototype','__esModule','1708xbhhpn','./AssociateWhatsappQueue','call','(((.+)+)+)+$','847040iboLMV','not','create','132951DnchXo','length','667575aQpeyp','search','string','hasOwnProperty','getOwnPropertyDescriptor','610716tKiqjg','findOne','min','object','__setModuleDefault','3543036ZaUaWe','__importStar','get','default','../../models/Whatsapp','__createBinding','../../errors/AppError','configurable','defineProperty','./ShowWhatsAppService','4oCSCLm','toString','102hrqdDm','writable','ERR_WAPP_GREETING_REQUIRED','__importDefault','update','shape'];a595_0x10e2=function(){return _0x9936c7;};return a595_0x10e2();}(function(_0x4231fe,_0xf3d7e4){var _0x280d20=a595_0x3cf0,_0x3975b1=_0x4231fe();while(!![]){try{var _0x1c65cd=parseInt(_0x280d20(0x182))/0x1*(-parseInt(_0x280d20(0x186))/0x2)+-parseInt(_0x280d20(0x169))/0x3*(-parseInt(_0x280d20(0x178))/0x4)+parseInt(_0x280d20(0x164))/0x5+-parseInt(_0x280d20(0x17a))/0x6*(parseInt(_0x280d20(0x162))/0x7)+-parseInt(_0x280d20(0x183))/0x8+-parseInt(_0x280d20(0x181))/0x9*(parseInt(_0x280d20(0x18a))/0xa)+parseInt(_0x280d20(0x180))/0xb*(parseInt(_0x280d20(0x16e))/0xc);if(_0x1c65cd===_0xf3d7e4)break;else _0x3975b1['push'](_0x3975b1['shift']());}catch(_0x5c0264){_0x3975b1['push'](_0x3975b1['shift']());}}}(a595_0x10e2,0x52169));var __createBinding=this&&this[a595_0x142169(0x173)]||(Object[a595_0x142169(0x161)]?function(_0x12a0eb,_0x219dfb,_0x772e27,_0xc9b0c6){var _0x27e389=a595_0x142169;if(_0xc9b0c6===undefined)_0xc9b0c6=_0x772e27;var _0x8cd0d7=Object[_0x27e389(0x168)](_0x219dfb,_0x772e27);(!_0x8cd0d7||(_0x27e389(0x170)in _0x8cd0d7?!_0x219dfb[_0x27e389(0x185)]:_0x8cd0d7[_0x27e389(0x17b)]||_0x8cd0d7[_0x27e389(0x175)]))&&(_0x8cd0d7={'enumerable':!![],'get':function(){return _0x219dfb[_0x772e27];}}),Object[_0x27e389(0x176)](_0x12a0eb,_0xc9b0c6,_0x8cd0d7);}:function(_0x5f532a,_0x4be95c,_0x426a39,_0x208497){if(_0x208497===undefined)_0x208497=_0x426a39;_0x5f532a[_0x208497]=_0x4be95c[_0x426a39];}),__setModuleDefault=this&&this[a595_0x142169(0x16d)]||(Object['create']?function(_0x20a4ae,_0x4d19cc){var _0x29fe9a=a595_0x142169;Object[_0x29fe9a(0x176)](_0x20a4ae,'default',{'enumerable':!![],'value':_0x4d19cc});}:function(_0x5ae2e8,_0x1b88bd){_0x5ae2e8['default']=_0x1b88bd;}),__importStar=this&&this[a595_0x142169(0x16f)]||(function(){var _0x1e738f=(function(){var _0xbf4376=!![];return function(_0x45d8ae,_0x4f73e5){var _0x249076=_0xbf4376?function(){if(_0x4f73e5){var _0x17a9fd=_0x4f73e5['apply'](_0x45d8ae,arguments);return _0x4f73e5=null,_0x17a9fd;}}:function(){};return _0xbf4376=![],_0x249076;};}()),_0x4d1062=_0x1e738f(this,function(){var _0x4b8c9a=a595_0x3cf0;return _0x4d1062[_0x4b8c9a(0x179)]()[_0x4b8c9a(0x165)]('(((.+)+)+)+$')[_0x4b8c9a(0x179)]()['constructor'](_0x4d1062)[_0x4b8c9a(0x165)](_0x4b8c9a(0x189));});_0x4d1062();var _0x407d8e=function(_0xf35231){return _0x407d8e=Object['getOwnPropertyNames']||function(_0x522d90){var _0x3d9d07=a595_0x3cf0,_0x13652e=[];for(var _0x34044 in _0x522d90)if(Object[_0x3d9d07(0x184)][_0x3d9d07(0x167)][_0x3d9d07(0x188)](_0x522d90,_0x34044))_0x13652e[_0x13652e['length']]=_0x34044;return _0x13652e;},_0x407d8e(_0xf35231);};return function(_0x4214b6){var _0x5b98b0=a595_0x3cf0;if(_0x4214b6&&_0x4214b6[_0x5b98b0(0x185)])return _0x4214b6;var _0x3ce533={};if(_0x4214b6!=null){for(var _0x22836d=_0x407d8e(_0x4214b6),_0x4356bc=0x0;_0x4356bc<_0x22836d[_0x5b98b0(0x163)];_0x4356bc++)if(_0x22836d[_0x4356bc]!==_0x5b98b0(0x171))__createBinding(_0x3ce533,_0x4214b6,_0x22836d[_0x4356bc]);}return __setModuleDefault(_0x3ce533,_0x4214b6),_0x3ce533;};}()),__importDefault=this&&this[a595_0x142169(0x17d)]||function(_0x2ec7a0){var _0x36f5b3=a595_0x142169;return _0x2ec7a0&&_0x2ec7a0[_0x36f5b3(0x185)]?_0x2ec7a0:{'default':_0x2ec7a0};};Object[a595_0x142169(0x176)](exports,'__esModule',{'value':!![]});const Yup=__importStar(require('yup')),sequelize_1=require('sequelize'),AppError_1=__importDefault(require(a595_0x142169(0x174))),Whatsapp_1=__importDefault(require(a595_0x142169(0x172))),ShowWhatsAppService_1=__importDefault(require(a595_0x142169(0x177))),AssociateWhatsappQueue_1=__importDefault(require(a595_0x142169(0x187))),UpdateWhatsAppService=async({whatsappData:_0x3879d1,whatsappId:_0x50b7d5,companyId:_0x4492cb})=>{var _0x26032d=a595_0x142169;const {name:_0x2cbafb,status:_0x461e37,isDefault:_0x208d4f,session:_0x506c5f,greetingMessage:_0x22cd62,complationMessage:_0x51d776,outOfHoursMessage:_0x5167bd,useRating:_0x1591b9,ratingMessage:_0x3ee999,transferMessage:_0x2976b4,queueIds:queueIds=[],token:_0x5bffa1,timeSendQueue:_0x2d8c82,integrationId:_0x4d3724,sendIdQueue:sendIdQueue=null,maxUseBotQueues:_0x4d93ef,expiresTicket:_0x5b9b9a,expiresInactiveMessage:_0x36ec91,allowGroup:_0x2d8f31,importOldMessages:_0x2ee756,schedules:_0x205dc6,whenExpireTicket:_0x4116dd,inactiveMessageTime:_0x577f63,inactiveMessage:_0x33a6d2,automaticRestart:_0x2f0c46,period:_0x1470a3,lastRestartAt:_0x4a73e1}=_0x3879d1,_0xcca804=Yup[_0x26032d(0x16c)]()[_0x26032d(0x17f)]({'name':Yup[_0x26032d(0x166)]()[_0x26032d(0x16b)](0x2),'status':Yup[_0x26032d(0x166)](),'isDefault':Yup['boolean']()});try{await _0xcca804['validate']({'name':_0x2cbafb,'status':_0x461e37,'isDefault':_0x208d4f});}catch(_0x1db63e){throw new AppError_1[(_0x26032d(0x171))](_0x1db63e['message']);}if(queueIds[_0x26032d(0x163)]>0x1&&!_0x22cd62)throw new AppError_1['default'](_0x26032d(0x17c));let _0x3c3d73=null;_0x208d4f&&(_0x3c3d73=await Whatsapp_1['default'][_0x26032d(0x16a)]({'where':{'isDefault':!![],'id':{[sequelize_1['Op'][_0x26032d(0x18b)]]:_0x50b7d5},'companyId':_0x4492cb}}),_0x3c3d73&&await _0x3c3d73[_0x26032d(0x17e)]({'isDefault':![]}));const _0x465242=await(0x0,ShowWhatsAppService_1[_0x26032d(0x171)])(_0x50b7d5,_0x4492cb);return await _0x465242[_0x26032d(0x17e)]({'name':_0x2cbafb,'status':_0x461e37,'session':_0x506c5f,'greetingMessage':_0x22cd62,'complationMessage':_0x51d776,'outOfHoursMessage':_0x5167bd,'useRating':_0x1591b9,'ratingMessage':_0x3ee999,'isDefault':_0x208d4f,'companyId':_0x4492cb,'token':_0x5bffa1,'transferMessage':_0x2976b4,'integrationId':_0x4d3724?_0x4d3724:null,'maxUseBotQueues':_0x4d93ef,'timeSendQueue':_0x2d8c82,'sendIdQueue':sendIdQueue,'expiresTicket':_0x5b9b9a,'expiresInactiveMessage':_0x36ec91,'allowGroup':_0x2d8f31,'importOldMessages':_0x2ee756,'schedules':_0x205dc6,'whenExpireTicket':_0x4116dd,'inactiveMessageTime':_0x577f63,'inactiveMessage':_0x33a6d2,'automaticRestart':_0x2f0c46,'period':_0x1470a3,'lastRestartAt':_0x4a73e1}),await(0x0,AssociateWhatsappQueue_1[_0x26032d(0x171)])(_0x465242,queueIds),{'whatsapp':_0x465242,'oldDefaultWhatsapp':_0x3c3d73};};function a595_0x3cf0(_0x989b35,_0x5970fc){var _0x38f0e3=a595_0x10e2();return a595_0x3cf0=function(_0x16ae2a,_0x58abd5){_0x16ae2a=_0x16ae2a-0x161;var _0x10e24d=_0x38f0e3[_0x16ae2a];return _0x10e24d;},a595_0x3cf0(_0x989b35,_0x5970fc);}exports['default']=UpdateWhatsAppService;