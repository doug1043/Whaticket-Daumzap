'use strict';function a596_0x5e33(){var _0xb4954c=['shape','call','search','configurable','1658066IiKPzF','2798375qERioJ','message','6YpVBCL','writable','sequelize','validate','../../models/Whatsapp','toString','../../errors/AppError','__setModuleDefault','146980VuwDwi','defineProperty','(((.+)+)+)+$','default','__createBinding','1975664hBdJgf','__esModule','object','2336169wiMzWY','__importStar','findOne','getOwnPropertyDescriptor','8BAkljX','hasOwnProperty','yup','not','string','622318ufArmN','prototype','__importDefault','length','5962845zpQgak','create','423blshRR','update','min'];a596_0x5e33=function(){return _0xb4954c;};return a596_0x5e33();}function a596_0x5e2e(_0x1b0874,_0x121ae2){var _0x56bd34=a596_0x5e33();return a596_0x5e2e=function(_0x3d619a,_0xa416a8){_0x3d619a=_0x3d619a-0x87;var _0x5e3388=_0x56bd34[_0x3d619a];return _0x5e3388;},a596_0x5e2e(_0x1b0874,_0x121ae2);}var a596_0x35237e=a596_0x5e2e;(function(_0x23c3f4,_0x44f16f){var _0x32121c=a596_0x5e2e,_0x1f716f=_0x23c3f4();while(!![]){try{var _0x417867=parseInt(_0x32121c(0xac))/0x1+-parseInt(_0x32121c(0x90))/0x2+parseInt(_0x32121c(0xa3))/0x3+-parseInt(_0x32121c(0xa0))/0x4+-parseInt(_0x32121c(0x91))/0x5*(-parseInt(_0x32121c(0x93))/0x6)+parseInt(_0x32121c(0x87))/0x7*(-parseInt(_0x32121c(0xa7))/0x8)+parseInt(_0x32121c(0x89))/0x9*(parseInt(_0x32121c(0x9b))/0xa);if(_0x417867===_0x44f16f)break;else _0x1f716f['push'](_0x1f716f['shift']());}catch(_0x3010ef){_0x1f716f['push'](_0x1f716f['shift']());}}}(a596_0x5e33,0x74642));var __createBinding=this&&this[a596_0x35237e(0x9f)]||(Object[a596_0x35237e(0x88)]?function(_0x5cbf22,_0x502e6f,_0x1c72e8,_0x5c98d2){var _0x4e894a=a596_0x35237e;if(_0x5c98d2===undefined)_0x5c98d2=_0x1c72e8;var _0xe5851f=Object[_0x4e894a(0xa6)](_0x502e6f,_0x1c72e8);(!_0xe5851f||('get'in _0xe5851f?!_0x502e6f[_0x4e894a(0xa1)]:_0xe5851f[_0x4e894a(0x94)]||_0xe5851f[_0x4e894a(0x8f)]))&&(_0xe5851f={'enumerable':!![],'get':function(){return _0x502e6f[_0x1c72e8];}}),Object[_0x4e894a(0x9c)](_0x5cbf22,_0x5c98d2,_0xe5851f);}:function(_0x50ed78,_0x19b0f4,_0x4c762c,_0x26f8f9){if(_0x26f8f9===undefined)_0x26f8f9=_0x4c762c;_0x50ed78[_0x26f8f9]=_0x19b0f4[_0x4c762c];}),__setModuleDefault=this&&this[a596_0x35237e(0x9a)]||(Object[a596_0x35237e(0x88)]?function(_0x47b3ff,_0x4e1b0c){var _0x7e445d=a596_0x35237e;Object[_0x7e445d(0x9c)](_0x47b3ff,'default',{'enumerable':!![],'value':_0x4e1b0c});}:function(_0x55f9a7,_0x37411c){_0x55f9a7['default']=_0x37411c;}),__importStar=this&&this[a596_0x35237e(0xa4)]||(function(){var _0x30d4fc=(function(){var _0x4bd582=!![];return function(_0x27af6f,_0x14138c){var _0x5759a3=_0x4bd582?function(){if(_0x14138c){var _0x54f373=_0x14138c['apply'](_0x27af6f,arguments);return _0x14138c=null,_0x54f373;}}:function(){};return _0x4bd582=![],_0x5759a3;};}()),_0x234bd7=_0x30d4fc(this,function(){var _0x493de3=a596_0x5e2e;return _0x234bd7[_0x493de3(0x98)]()['search'](_0x493de3(0x9d))[_0x493de3(0x98)]()['constructor'](_0x234bd7)[_0x493de3(0x8e)](_0x493de3(0x9d));});_0x234bd7();var _0x4f5974=function(_0x5d7876){return _0x4f5974=Object['getOwnPropertyNames']||function(_0x5ba865){var _0x4035f4=a596_0x5e2e,_0x44af6e=[];for(var _0x319da3 in _0x5ba865)if(Object[_0x4035f4(0xad)][_0x4035f4(0xa8)][_0x4035f4(0x8d)](_0x5ba865,_0x319da3))_0x44af6e[_0x44af6e[_0x4035f4(0xaf)]]=_0x319da3;return _0x44af6e;},_0x4f5974(_0x5d7876);};return function(_0x5c664b){var _0x2f26ba=a596_0x5e2e;if(_0x5c664b&&_0x5c664b[_0x2f26ba(0xa1)])return _0x5c664b;var _0xf5a881={};if(_0x5c664b!=null){for(var _0x525a61=_0x4f5974(_0x5c664b),_0x32dcf8=0x0;_0x32dcf8<_0x525a61[_0x2f26ba(0xaf)];_0x32dcf8++)if(_0x525a61[_0x32dcf8]!==_0x2f26ba(0x9e))__createBinding(_0xf5a881,_0x5c664b,_0x525a61[_0x32dcf8]);}return __setModuleDefault(_0xf5a881,_0x5c664b),_0xf5a881;};}()),__importDefault=this&&this[a596_0x35237e(0xae)]||function(_0x2a3b0b){var _0x35e793=a596_0x35237e;return _0x2a3b0b&&_0x2a3b0b[_0x35e793(0xa1)]?_0x2a3b0b:{'default':_0x2a3b0b};};Object[a596_0x35237e(0x9c)](exports,'__esModule',{'value':!![]});const Yup=__importStar(require(a596_0x35237e(0xa9))),sequelize_1=require(a596_0x35237e(0x95)),AppError_1=__importDefault(require(a596_0x35237e(0x99))),Whatsapp_1=__importDefault(require(a596_0x35237e(0x97))),ShowWhatsAppService_1=__importDefault(require('./ShowWhatsAppService')),AssociateWhatsappQueue_1=__importDefault(require('./AssociateWhatsappQueue')),UpdateWhatsAppService=async({whatsappData:_0x512c73,whatsappId:_0x429d6e,companyId:_0x1de95a})=>{var _0x570319=a596_0x35237e;const {name:_0x1bbfaf,status:_0x169f86,isDefault:_0x2e261d,session:_0x4d77c8,greetingMessage:_0x244ed3,complationMessage:_0x2c4307,outOfHoursMessage:_0x5ac740,useRating:_0x56a4d5,ratingMessage:_0x18814e,transferMessage:_0x3c51c0,queueIds:queueIds=[],token:_0x31234c,timeSendQueue:_0x5a2466,integrationId:_0x4f680f,sendIdQueue:sendIdQueue=null,maxUseBotQueues:_0xdd243b,expiresTicket:_0x2cbc8c,expiresInactiveMessage:_0x280850,allowGroup:_0x698b34,importOldMessages:_0x33dd04,schedules:_0x38f824,whenExpireTicket:_0x3a714b,inactiveMessageTime:_0x133bf8,inactiveMessage:_0x56be41,automaticRestart:_0x580656,period:_0x25900d,lastRestartAt:_0xbe17bd}=_0x512c73,_0x20f993=Yup[_0x570319(0xa2)]()[_0x570319(0x8c)]({'name':Yup[_0x570319(0xab)]()[_0x570319(0x8b)](0x2),'status':Yup[_0x570319(0xab)](),'isDefault':Yup['boolean']()});try{await _0x20f993[_0x570319(0x96)]({'name':_0x1bbfaf,'status':_0x169f86,'isDefault':_0x2e261d});}catch(_0x314670){throw new AppError_1[(_0x570319(0x9e))](_0x314670[_0x570319(0x92)]);}if(queueIds[_0x570319(0xaf)]>0x1&&!_0x244ed3)throw new AppError_1[(_0x570319(0x9e))]('ERR_WAPP_GREETING_REQUIRED');let _0x43ce9f=null;_0x2e261d&&(_0x43ce9f=await Whatsapp_1['default'][_0x570319(0xa5)]({'where':{'isDefault':!![],'id':{[sequelize_1['Op'][_0x570319(0xaa)]]:_0x429d6e},'companyId':_0x1de95a}}),_0x43ce9f&&await _0x43ce9f[_0x570319(0x8a)]({'isDefault':![]}));const _0x1b19f8=await(0x0,ShowWhatsAppService_1[_0x570319(0x9e)])(_0x429d6e,_0x1de95a);return await _0x1b19f8[_0x570319(0x8a)]({'name':_0x1bbfaf,'status':_0x169f86,'session':_0x4d77c8,'greetingMessage':_0x244ed3,'complationMessage':_0x2c4307,'outOfHoursMessage':_0x5ac740,'useRating':_0x56a4d5,'ratingMessage':_0x18814e,'isDefault':_0x2e261d,'companyId':_0x1de95a,'token':_0x31234c,'transferMessage':_0x3c51c0,'integrationId':_0x4f680f?_0x4f680f:null,'maxUseBotQueues':_0xdd243b,'timeSendQueue':_0x5a2466,'sendIdQueue':sendIdQueue,'expiresTicket':_0x2cbc8c,'expiresInactiveMessage':_0x280850,'allowGroup':_0x698b34,'importOldMessages':_0x33dd04,'schedules':_0x38f824,'whenExpireTicket':_0x3a714b,'inactiveMessageTime':_0x133bf8,'inactiveMessage':_0x56be41,'automaticRestart':_0x580656,'period':_0x25900d,'lastRestartAt':_0xbe17bd}),await(0x0,AssociateWhatsappQueue_1[_0x570319(0x9e)])(_0x1b19f8,queueIds),{'whatsapp':_0x1b19f8,'oldDefaultWhatsapp':_0x43ce9f};};exports[a596_0x35237e(0x9e)]=UpdateWhatsAppService;