'use strict';const a593_0x5ab9af=a593_0x4215;(function(_0x4a1f12,_0x3b6994){const _0x3135c9=a593_0x4215,_0x5638b9=_0x4a1f12();while(!![]){try{const _0x375ceb=parseInt(_0x3135c9(0x96))/0x1+parseInt(_0x3135c9(0xac))/0x2+-parseInt(_0x3135c9(0x90))/0x3+parseInt(_0x3135c9(0xa7))/0x4+parseInt(_0x3135c9(0xb3))/0x5*(parseInt(_0x3135c9(0xa1))/0x6)+-parseInt(_0x3135c9(0xb9))/0x7*(-parseInt(_0x3135c9(0xb5))/0x8)+parseInt(_0x3135c9(0x93))/0x9*(-parseInt(_0x3135c9(0xbb))/0xa);if(_0x375ceb===_0x3b6994)break;else _0x5638b9['push'](_0x5638b9['shift']());}catch(_0x2194b0){_0x5638b9['push'](_0x5638b9['shift']());}}}(a593_0x348f,0x32b67));var __createBinding=this&&this['__createBinding']||(Object[a593_0x5ab9af(0xa8)]?function(_0x176555,_0x27c69f,_0x470209,_0x5bffdb){const _0x4ed75c=a593_0x5ab9af;if(_0x5bffdb===undefined)_0x5bffdb=_0x470209;var _0x46dfe3=Object['getOwnPropertyDescriptor'](_0x27c69f,_0x470209);(!_0x46dfe3||(_0x4ed75c(0xb4)in _0x46dfe3?!_0x27c69f['__esModule']:_0x46dfe3[_0x4ed75c(0x9d)]||_0x46dfe3[_0x4ed75c(0xb8)]))&&(_0x46dfe3={'enumerable':!![],'get':function(){return _0x27c69f[_0x470209];}}),Object[_0x4ed75c(0xa9)](_0x176555,_0x5bffdb,_0x46dfe3);}:function(_0x98b7d,_0x5ef13b,_0x444046,_0x4a810b){if(_0x4a810b===undefined)_0x4a810b=_0x444046;_0x98b7d[_0x4a810b]=_0x5ef13b[_0x444046];}),__setModuleDefault=this&&this[a593_0x5ab9af(0xba)]||(Object[a593_0x5ab9af(0xa8)]?function(_0x1ba5f1,_0x2dfbab){const _0x2e9659=a593_0x5ab9af;Object[_0x2e9659(0xa9)](_0x1ba5f1,_0x2e9659(0x94),{'enumerable':!![],'value':_0x2dfbab});}:function(_0xa35614,_0x18f143){_0xa35614['default']=_0x18f143;}),__importStar=this&&this[a593_0x5ab9af(0xaf)]||(function(){const _0x1d4379=(function(){let _0x1d7296=!![];return function(_0x1239b3,_0x302cf3){const _0x5368f1=_0x1d7296?function(){const _0x421101=a593_0x4215;if(_0x302cf3){const _0x84894f=_0x302cf3[_0x421101(0xb0)](_0x1239b3,arguments);return _0x302cf3=null,_0x84894f;}}:function(){};return _0x1d7296=![],_0x5368f1;};}()),_0x5c5526=_0x1d4379(this,function(){const _0x53d83a=a593_0x4215;return _0x5c5526['toString']()[_0x53d83a(0xbc)](_0x53d83a(0xbe))[_0x53d83a(0x9a)]()['constructor'](_0x5c5526)[_0x53d83a(0xbc)](_0x53d83a(0xbe));});_0x5c5526();var _0x3d125a=function(_0x26ad9f){const _0x36c924=a593_0x4215;return _0x3d125a=Object[_0x36c924(0x9f)]||function(_0x491360){const _0xdbd312=_0x36c924;var _0x4c8b19=[];for(var _0x5a9f80 in _0x491360)if(Object[_0xdbd312(0xb1)][_0xdbd312(0x8e)]['call'](_0x491360,_0x5a9f80))_0x4c8b19[_0x4c8b19['length']]=_0x5a9f80;return _0x4c8b19;},_0x3d125a(_0x26ad9f);};return function(_0x42a4ea){const _0x54b1c8=a593_0x4215;if(_0x42a4ea&&_0x42a4ea[_0x54b1c8(0xbf)])return _0x42a4ea;var _0x37fb5f={};if(_0x42a4ea!=null){for(var _0x20b800=_0x3d125a(_0x42a4ea),_0x43edf5=0x0;_0x43edf5<_0x20b800['length'];_0x43edf5++)if(_0x20b800[_0x43edf5]!=='default')__createBinding(_0x37fb5f,_0x42a4ea,_0x20b800[_0x43edf5]);}return __setModuleDefault(_0x37fb5f,_0x42a4ea),_0x37fb5f;};}()),__importDefault=this&&this[a593_0x5ab9af(0xad)]||function(_0x4f6963){const _0x70943e=a593_0x5ab9af;return _0x4f6963&&_0x4f6963[_0x70943e(0xbf)]?_0x4f6963:{'default':_0x4f6963};};Object['defineProperty'](exports,a593_0x5ab9af(0xbf),{'value':!![]}),exports[a593_0x5ab9af(0x8d)]=void 0x0,exports[a593_0x5ab9af(0xa6)]=initUserMonitorQueues;const bull_1=__importDefault(require(a593_0x5ab9af(0x95))),Sentry=__importStar(require(a593_0x5ab9af(0xab))),sequelize_1=require(a593_0x5ab9af(0xa5)),lodash_1=require('lodash'),logger_1=require(a593_0x5ab9af(0xb6)),database_1=__importDefault(require('./database')),User_1=__importDefault(require(a593_0x5ab9af(0x92))),connection=process[a593_0x5ab9af(0xc0)][a593_0x5ab9af(0xbd)]||'';exports[a593_0x5ab9af(0x8d)]=new bull_1[(a593_0x5ab9af(0x94))](a593_0x5ab9af(0xb7),connection);function a593_0x348f(){const _0x4f7aab=['sequelize','initUserMonitorQueues','537164sgBOII','create','defineProperty','null','@sentry/node','671066EnyytB','__importDefault','logger','__importStar','apply','prototype','online','370bSrLjQ','get','8nSpNKL','./utils/logger','UserMonitor','configurable','1449049hpCCcz','__setModuleDefault','3687370ozMRMw','search','REDIS_URI','(((.+)+)+)+$','__esModule','env','query','VerifyLoginStatus','userMonitor','hasOwnProperty','QueryTypes','913881uHNVYi','UserConnection','./models/User','9ifYZcq','default','bull','172654vSRyyB','SELECT','data','process','toString','captureException','findByPk','writable','key','getOwnPropertyNames','add','2562pMvMEG','Usuário\x20passado\x20para\x20offline:\x20','update','isNil'];a593_0x348f=function(){return _0x4f7aab;};return a593_0x348f();}async function handleLoginStatus(_0x231f27){const _0x4a86a6=a593_0x5ab9af,_0x5336e5=await database_1[_0x4a86a6(0x94)][_0x4a86a6(0x8b)]('select\x20id\x20from\x20\x22Users\x22\x20where\x20\x22updatedAt\x22\x20<\x20now()\x20-\x20\x275\x20minutes\x27::interval\x20and\x20online\x20=\x20true',{'type':sequelize_1[_0x4a86a6(0x8f)][_0x4a86a6(0x97)]});for(let _0x51edb4 of _0x5336e5){try{const _0x21051d=await User_1[_0x4a86a6(0x94)][_0x4a86a6(0x9c)](_0x51edb4['id']);await _0x21051d[_0x4a86a6(0xa3)]({'online':![]}),logger_1[_0x4a86a6(0xae)]['info'](_0x4a86a6(0xa2)+_0x51edb4['id']);}catch(_0x33378a){Sentry[_0x4a86a6(0x9b)](_0x33378a);}}}async function handleUserConnection(_0x360e41){const _0x291243=a593_0x5ab9af;try{const {id:_0x4ccf36}=_0x360e41[_0x291243(0x98)];if(!(0x0,lodash_1[_0x291243(0xa4)])(_0x4ccf36)&&_0x4ccf36!==_0x291243(0xaa)){const _0x46b233=await User_1[_0x291243(0x94)]['findByPk'](_0x4ccf36);_0x46b233&&(_0x46b233[_0x291243(0xb2)]=!![],await _0x46b233['save']());}}catch(_0x4b5bde){Sentry['captureException'](_0x4b5bde);}}exports[a593_0x5ab9af(0x8d)]['process'](a593_0x5ab9af(0x91),handleUserConnection),exports[a593_0x5ab9af(0x8d)][a593_0x5ab9af(0x99)](a593_0x5ab9af(0x8c),handleLoginStatus);function a593_0x4215(_0x21e1bd,_0x510377){const _0xc515bb=a593_0x348f();return a593_0x4215=function(_0x5efcce,_0x5776f4){_0x5efcce=_0x5efcce-0x8b;let _0x348fe8=_0xc515bb[_0x5efcce];return _0x348fe8;},a593_0x4215(_0x21e1bd,_0x510377);}async function initUserMonitorQueues(){const _0x176793=a593_0x5ab9af,_0x458ddb=await exports[_0x176793(0x8d)]['getRepeatableJobs']();for(let _0x492f06 of _0x458ddb){await exports[_0x176793(0x8d)]['removeRepeatableByKey'](_0x492f06[_0x176793(0x9e)]);}exports[_0x176793(0x8d)][_0x176793(0xa0)](_0x176793(0x8c),{},{'repeat':{'cron':'*\x20*\x20*\x20*\x20*'},'removeOnComplete':{'age':0x3c*0x3c,'count':0xa},'removeOnFail':{'age':0x3c*0x3c,'count':0xa}}),logger_1[_0x176793(0xae)]['info']('Queue:\x20monitoramento\x20de\x20status\x20de\x20usuário\x20inicializado');}