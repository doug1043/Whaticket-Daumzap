'use strict';const a596_0x5a7ef4=a596_0x5538;(function(_0x263d52,_0x20ec0f){const _0x2554eb=a596_0x5538,_0x47644e=_0x263d52();while(!![]){try{const _0x58ba58=parseInt(_0x2554eb(0x1d0))/0x1*(parseInt(_0x2554eb(0x1ea))/0x2)+-parseInt(_0x2554eb(0x1d2))/0x3*(parseInt(_0x2554eb(0x1de))/0x4)+-parseInt(_0x2554eb(0x1cb))/0x5+-parseInt(_0x2554eb(0x1c9))/0x6+-parseInt(_0x2554eb(0x1e7))/0x7*(parseInt(_0x2554eb(0x1d3))/0x8)+parseInt(_0x2554eb(0x1e4))/0x9+-parseInt(_0x2554eb(0x1c8))/0xa*(parseInt(_0x2554eb(0x1d8))/0xb);if(_0x58ba58===_0x20ec0f)break;else _0x47644e['push'](_0x47644e['shift']());}catch(_0x310294){_0x47644e['push'](_0x47644e['shift']());}}}(a596_0x1a2b,0x9ffd9));var __createBinding=this&&this[a596_0x5a7ef4(0x1c7)]||(Object['create']?function(_0x396b4a,_0x408a48,_0x2e5810,_0x53721b){const _0xc1499=a596_0x5a7ef4;if(_0x53721b===undefined)_0x53721b=_0x2e5810;var _0x5949a1=Object[_0xc1499(0x1e1)](_0x408a48,_0x2e5810);(!_0x5949a1||(_0xc1499(0x1bc)in _0x5949a1?!_0x408a48['__esModule']:_0x5949a1[_0xc1499(0x1da)]||_0x5949a1['configurable']))&&(_0x5949a1={'enumerable':!![],'get':function(){return _0x408a48[_0x2e5810];}}),Object['defineProperty'](_0x396b4a,_0x53721b,_0x5949a1);}:function(_0x339986,_0x11f9c8,_0x5286db,_0x3857db){if(_0x3857db===undefined)_0x3857db=_0x5286db;_0x339986[_0x3857db]=_0x11f9c8[_0x5286db];}),__setModuleDefault=this&&this[a596_0x5a7ef4(0x1e8)]||(Object[a596_0x5a7ef4(0x1e6)]?function(_0x14f7cb,_0x1b994e){const _0x7a037=a596_0x5a7ef4;Object[_0x7a037(0x1bd)](_0x14f7cb,'default',{'enumerable':!![],'value':_0x1b994e});}:function(_0x1d4fd1,_0x504e81){const _0x12ec2a=a596_0x5a7ef4;_0x1d4fd1[_0x12ec2a(0x1d6)]=_0x504e81;}),__importStar=this&&this['__importStar']||(function(){const _0x41f759=(function(){let _0x19ebe0=!![];return function(_0x5464c2,_0x9db510){const _0x30a436=_0x19ebe0?function(){if(_0x9db510){const _0x109592=_0x9db510['apply'](_0x5464c2,arguments);return _0x9db510=null,_0x109592;}}:function(){};return _0x19ebe0=![],_0x30a436;};}()),_0x3998b5=_0x41f759(this,function(){const _0x3f1f4c=a596_0x5538;return _0x3998b5['toString']()[_0x3f1f4c(0x1d9)](_0x3f1f4c(0x1c1))['toString']()[_0x3f1f4c(0x1e9)](_0x3998b5)['search'](_0x3f1f4c(0x1c1));});_0x3998b5();var _0xfc0f51=function(_0x29862b){const _0x978cd2=a596_0x5538;return _0xfc0f51=Object[_0x978cd2(0x1c2)]||function(_0xb721c6){const _0x25b830=_0x978cd2;var _0x55f08f=[];for(var _0x28a1a4 in _0xb721c6)if(Object[_0x25b830(0x1ee)]['hasOwnProperty'][_0x25b830(0x1d4)](_0xb721c6,_0x28a1a4))_0x55f08f[_0x55f08f[_0x25b830(0x1d7)]]=_0x28a1a4;return _0x55f08f;},_0xfc0f51(_0x29862b);};return function(_0x7e0578){const _0x3763ae=a596_0x5538;if(_0x7e0578&&_0x7e0578[_0x3763ae(0x1ca)])return _0x7e0578;var _0x55fca8={};if(_0x7e0578!=null){for(var _0x55764d=_0xfc0f51(_0x7e0578),_0x1c5dc6=0x0;_0x1c5dc6<_0x55764d[_0x3763ae(0x1d7)];_0x1c5dc6++)if(_0x55764d[_0x1c5dc6]!==_0x3763ae(0x1d6))__createBinding(_0x55fca8,_0x7e0578,_0x55764d[_0x1c5dc6]);}return __setModuleDefault(_0x55fca8,_0x7e0578),_0x55fca8;};}()),__importDefault=this&&this[a596_0x5a7ef4(0x1c6)]||function(_0xf70b91){const _0x70fd5a=a596_0x5a7ef4;return _0xf70b91&&_0xf70b91[_0x70fd5a(0x1ca)]?_0xf70b91:{'default':_0xf70b91};};Object[a596_0x5a7ef4(0x1bd)](exports,'__esModule',{'value':!![]}),exports['userMonitor']=void 0x0,exports['initUserMonitorQueues']=initUserMonitorQueues;function a596_0x5538(_0x2c9dc6,_0x219d8f){const _0x56f6e7=a596_0x1a2b();return a596_0x5538=function(_0x4a27c6,_0x11ad57){_0x4a27c6=_0x4a27c6-0x1bc;let _0x1a2bc7=_0x56f6e7[_0x4a27c6];return _0x1a2bc7;},a596_0x5538(_0x2c9dc6,_0x219d8f);}const bull_1=__importDefault(require(a596_0x5a7ef4(0x1e0))),Sentry=__importStar(require(a596_0x5a7ef4(0x1e3))),sequelize_1=require('sequelize'),lodash_1=require(a596_0x5a7ef4(0x1cd)),logger_1=require(a596_0x5a7ef4(0x1dc)),database_1=__importDefault(require(a596_0x5a7ef4(0x1ce))),User_1=__importDefault(require(a596_0x5a7ef4(0x1d1))),connection=process[a596_0x5a7ef4(0x1bf)][a596_0x5a7ef4(0x1e2)]||'';exports[a596_0x5a7ef4(0x1be)]=new bull_1[(a596_0x5a7ef4(0x1d6))](a596_0x5a7ef4(0x1df),connection);function a596_0x1a2b(){const _0x5eda26=['writable','VerifyLoginStatus','./utils/logger','query','4vFwgjy','UserMonitor','bull','getOwnPropertyDescriptor','REDIS_URI','@sentry/node','6460569LqgYfv','save','create','42WdUWpP','__setModuleDefault','constructor','1738Gagnvu','key','process','Queue:\x20monitoramento\x20de\x20status\x20de\x20usuário\x20inicializado','prototype','findByPk','SELECT','add','info','data','captureException','get','defineProperty','userMonitor','env','QueryTypes','(((.+)+)+)+$','getOwnPropertyNames','select\x20id\x20from\x20\x22Users\x22\x20where\x20\x22updatedAt\x22\x20<\x20now()\x20-\x20\x275\x20minutes\x27::interval\x20and\x20online\x20=\x20true','UserConnection','isNil','__importDefault','__createBinding','820CGtWeC','937302YcoQZm','__esModule','2128545OFRdVO','null','lodash','./database','online','1475vpGwTp','./models/User','698583kdmiiJ','410920lmUpaj','call','*\x20*\x20*\x20*\x20*','default','length','29689XjwsyJ','search'];a596_0x1a2b=function(){return _0x5eda26;};return a596_0x1a2b();}async function handleLoginStatus(_0x3d5c38){const _0x3c9f11=a596_0x5a7ef4,_0x2678e8=await database_1[_0x3c9f11(0x1d6)][_0x3c9f11(0x1dd)](_0x3c9f11(0x1c3),{'type':sequelize_1[_0x3c9f11(0x1c0)][_0x3c9f11(0x1f0)]});for(let _0x1dbba4 of _0x2678e8){try{const _0x4db81c=await User_1['default'][_0x3c9f11(0x1ef)](_0x1dbba4['id']);await _0x4db81c['update']({'online':![]}),logger_1['logger'][_0x3c9f11(0x1f2)]('Usuário\x20passado\x20para\x20offline:\x20'+_0x1dbba4['id']);}catch(_0x34cbb5){Sentry[_0x3c9f11(0x1f4)](_0x34cbb5);}}}async function handleUserConnection(_0x303a6c){const _0x5e1cf0=a596_0x5a7ef4;try{const {id:_0x58a9c2}=_0x303a6c[_0x5e1cf0(0x1f3)];if(!(0x0,lodash_1[_0x5e1cf0(0x1c5)])(_0x58a9c2)&&_0x58a9c2!==_0x5e1cf0(0x1cc)){const _0x38dd13=await User_1['default'][_0x5e1cf0(0x1ef)](_0x58a9c2);_0x38dd13&&(_0x38dd13[_0x5e1cf0(0x1cf)]=!![],await _0x38dd13[_0x5e1cf0(0x1e5)]());}}catch(_0x3ab33d){Sentry[_0x5e1cf0(0x1f4)](_0x3ab33d);}}exports[a596_0x5a7ef4(0x1be)][a596_0x5a7ef4(0x1ec)](a596_0x5a7ef4(0x1c4),handleUserConnection),exports[a596_0x5a7ef4(0x1be)][a596_0x5a7ef4(0x1ec)](a596_0x5a7ef4(0x1db),handleLoginStatus);async function initUserMonitorQueues(){const _0x462a57=a596_0x5a7ef4,_0x15eb2f=await exports['userMonitor']['getRepeatableJobs']();for(let _0x1736b1 of _0x15eb2f){await exports[_0x462a57(0x1be)]['removeRepeatableByKey'](_0x1736b1[_0x462a57(0x1eb)]);}exports[_0x462a57(0x1be)][_0x462a57(0x1f1)](_0x462a57(0x1db),{},{'repeat':{'cron':_0x462a57(0x1d5)},'removeOnComplete':{'age':0x3c*0x3c,'count':0xa},'removeOnFail':{'age':0x3c*0x3c,'count':0xa}}),logger_1['logger'][_0x462a57(0x1f2)](_0x462a57(0x1ed));}