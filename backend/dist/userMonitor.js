'use strict';const a593_0x28ac48=a593_0x269c;(function(_0x7788fc,_0x5a9ea5){const _0x415aca=a593_0x269c,_0x4138bb=_0x7788fc();while(!![]){try{const _0xfea9a1=parseInt(_0x415aca(0x16f))/0x1+parseInt(_0x415aca(0x16e))/0x2*(-parseInt(_0x415aca(0x190))/0x3)+parseInt(_0x415aca(0x170))/0x4*(-parseInt(_0x415aca(0x193))/0x5)+parseInt(_0x415aca(0x185))/0x6*(parseInt(_0x415aca(0x1a2))/0x7)+parseInt(_0x415aca(0x17b))/0x8*(-parseInt(_0x415aca(0x191))/0x9)+-parseInt(_0x415aca(0x195))/0xa*(parseInt(_0x415aca(0x1a3))/0xb)+parseInt(_0x415aca(0x183))/0xc;if(_0xfea9a1===_0x5a9ea5)break;else _0x4138bb['push'](_0x4138bb['shift']());}catch(_0x20ec4d){_0x4138bb['push'](_0x4138bb['shift']());}}}(a593_0x25d5,0x7a727));var __createBinding=this&&this[a593_0x28ac48(0x18a)]||(Object[a593_0x28ac48(0x19e)]?function(_0xfd0e76,_0x10701b,_0x3131c6,_0x54a855){const _0x519540=a593_0x28ac48;if(_0x54a855===undefined)_0x54a855=_0x3131c6;var _0x5a313f=Object['getOwnPropertyDescriptor'](_0x10701b,_0x3131c6);(!_0x5a313f||(_0x519540(0x182)in _0x5a313f?!_0x10701b[_0x519540(0x192)]:_0x5a313f[_0x519540(0x180)]||_0x5a313f[_0x519540(0x17f)]))&&(_0x5a313f={'enumerable':!![],'get':function(){return _0x10701b[_0x3131c6];}}),Object[_0x519540(0x19f)](_0xfd0e76,_0x54a855,_0x5a313f);}:function(_0x14745a,_0x7281b2,_0x4c4880,_0x4d3630){if(_0x4d3630===undefined)_0x4d3630=_0x4c4880;_0x14745a[_0x4d3630]=_0x7281b2[_0x4c4880];}),__setModuleDefault=this&&this['__setModuleDefault']||(Object[a593_0x28ac48(0x19e)]?function(_0x1e8dab,_0x28e671){const _0x1a1199=a593_0x28ac48;Object[_0x1a1199(0x19f)](_0x1e8dab,_0x1a1199(0x1a6),{'enumerable':!![],'value':_0x28e671});}:function(_0x435629,_0x52b5a0){const _0x1434d7=a593_0x28ac48;_0x435629[_0x1434d7(0x1a6)]=_0x52b5a0;}),__importStar=this&&this[a593_0x28ac48(0x196)]||(function(){const _0x51d1ea=(function(){let _0x46c4fa=!![];return function(_0x5e59ca,_0xba854f){const _0x654c56=_0x46c4fa?function(){if(_0xba854f){const _0x5c304e=_0xba854f['apply'](_0x5e59ca,arguments);return _0xba854f=null,_0x5c304e;}}:function(){};return _0x46c4fa=![],_0x654c56;};}()),_0x4832fd=_0x51d1ea(this,function(){const _0x3a8336=a593_0x269c;return _0x4832fd[_0x3a8336(0x17c)]()[_0x3a8336(0x172)](_0x3a8336(0x18e))[_0x3a8336(0x17c)]()[_0x3a8336(0x175)](_0x4832fd)[_0x3a8336(0x172)](_0x3a8336(0x18e));});_0x4832fd();var _0x103853=function(_0x591d17){const _0x30dda8=a593_0x269c;return _0x103853=Object[_0x30dda8(0x194)]||function(_0x323825){const _0xe95731=_0x30dda8;var _0x41ad39=[];for(var _0x1baefa in _0x323825)if(Object[_0xe95731(0x19b)][_0xe95731(0x1a0)]['call'](_0x323825,_0x1baefa))_0x41ad39[_0x41ad39[_0xe95731(0x1a5)]]=_0x1baefa;return _0x41ad39;},_0x103853(_0x591d17);};return function(_0x50386f){const _0x1f2218=a593_0x269c;if(_0x50386f&&_0x50386f[_0x1f2218(0x192)])return _0x50386f;var _0x15000b={};if(_0x50386f!=null){for(var _0x2213f1=_0x103853(_0x50386f),_0x1a9f58=0x0;_0x1a9f58<_0x2213f1[_0x1f2218(0x1a5)];_0x1a9f58++)if(_0x2213f1[_0x1a9f58]!=='default')__createBinding(_0x15000b,_0x50386f,_0x2213f1[_0x1a9f58]);}return __setModuleDefault(_0x15000b,_0x50386f),_0x15000b;};}()),__importDefault=this&&this['__importDefault']||function(_0x1b2dd1){const _0x26659a=a593_0x28ac48;return _0x1b2dd1&&_0x1b2dd1[_0x26659a(0x192)]?_0x1b2dd1:{'default':_0x1b2dd1};};Object[a593_0x28ac48(0x19f)](exports,a593_0x28ac48(0x192),{'value':!![]}),exports[a593_0x28ac48(0x187)]=void 0x0,exports['initUserMonitorQueues']=initUserMonitorQueues;function a593_0x25d5(){const _0x59f042=['5620vGYyuS','./utils/logger','search','VerifyLoginStatus','online','constructor','isNil','env','sequelize','bull','save','744OUudfL','toString','removeRepeatableByKey','key','configurable','writable','logger','get','15753096cVdZwO','@sentry/node','13692jePGxU','*\x20*\x20*\x20*\x20*','userMonitor','Queue:\x20monitoramento\x20de\x20status\x20de\x20usuário\x20inicializado','select\x20id\x20from\x20\x22Users\x22\x20where\x20\x22updatedAt\x22\x20<\x20now()\x20-\x20\x275\x20minutes\x27::interval\x20and\x20online\x20=\x20true','__createBinding','findByPk','QueryTypes','./database','(((.+)+)+)+$','UserMonitor','1592211SwqFih','46674KquZJT','__esModule','835uxjbDe','getOwnPropertyNames','15430zSVpYs','__importStar','info','lodash','update','UserConnection','prototype','query','getRepeatableJobs','create','defineProperty','hasOwnProperty','SELECT','350FLtsYe','1155QDHOTe','data','length','default','process','2JgMGLu','484370GeePZB'];a593_0x25d5=function(){return _0x59f042;};return a593_0x25d5();}const bull_1=__importDefault(require(a593_0x28ac48(0x179))),Sentry=__importStar(require(a593_0x28ac48(0x184))),sequelize_1=require(a593_0x28ac48(0x178)),lodash_1=require(a593_0x28ac48(0x198)),logger_1=require(a593_0x28ac48(0x171)),database_1=__importDefault(require(a593_0x28ac48(0x18d))),User_1=__importDefault(require('./models/User')),connection=process[a593_0x28ac48(0x177)]['REDIS_URI']||'';exports[a593_0x28ac48(0x187)]=new bull_1['default'](a593_0x28ac48(0x18f),connection);async function handleLoginStatus(_0x3be354){const _0x2ac468=a593_0x28ac48,_0x165721=await database_1[_0x2ac468(0x1a6)][_0x2ac468(0x19c)](_0x2ac468(0x189),{'type':sequelize_1[_0x2ac468(0x18c)][_0x2ac468(0x1a1)]});for(let _0x5727c8 of _0x165721){try{const _0x4189cf=await User_1[_0x2ac468(0x1a6)][_0x2ac468(0x18b)](_0x5727c8['id']);await _0x4189cf[_0x2ac468(0x199)]({'online':![]}),logger_1[_0x2ac468(0x181)][_0x2ac468(0x197)]('Usuário\x20passado\x20para\x20offline:\x20'+_0x5727c8['id']);}catch(_0x35fc51){Sentry['captureException'](_0x35fc51);}}}function a593_0x269c(_0x2998a6,_0x24f7e6){const _0x1e679e=a593_0x25d5();return a593_0x269c=function(_0x48dc5e,_0x115e4b){_0x48dc5e=_0x48dc5e-0x16e;let _0x25d50a=_0x1e679e[_0x48dc5e];return _0x25d50a;},a593_0x269c(_0x2998a6,_0x24f7e6);}async function handleUserConnection(_0x246c82){const _0x1cd729=a593_0x28ac48;try{const {id:_0x38a6df}=_0x246c82[_0x1cd729(0x1a4)];if(!(0x0,lodash_1[_0x1cd729(0x176)])(_0x38a6df)&&_0x38a6df!=='null'){const _0x243a63=await User_1[_0x1cd729(0x1a6)][_0x1cd729(0x18b)](_0x38a6df);_0x243a63&&(_0x243a63[_0x1cd729(0x174)]=!![],await _0x243a63[_0x1cd729(0x17a)]());}}catch(_0x1e1d65){Sentry['captureException'](_0x1e1d65);}}exports['userMonitor'][a593_0x28ac48(0x1a7)](a593_0x28ac48(0x19a),handleUserConnection),exports[a593_0x28ac48(0x187)][a593_0x28ac48(0x1a7)](a593_0x28ac48(0x173),handleLoginStatus);async function initUserMonitorQueues(){const _0x57e79b=a593_0x28ac48,_0x16ad69=await exports[_0x57e79b(0x187)][_0x57e79b(0x19d)]();for(let _0x393020 of _0x16ad69){await exports['userMonitor'][_0x57e79b(0x17d)](_0x393020[_0x57e79b(0x17e)]);}exports[_0x57e79b(0x187)]['add']('VerifyLoginStatus',{},{'repeat':{'cron':_0x57e79b(0x186)},'removeOnComplete':{'age':0x3c*0x3c,'count':0xa},'removeOnFail':{'age':0x3c*0x3c,'count':0xa}}),logger_1[_0x57e79b(0x181)][_0x57e79b(0x197)](_0x57e79b(0x188));}