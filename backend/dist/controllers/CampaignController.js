const a10_0x23d58f=a10_0x315d;(function(_0x446d4b,_0x44e71d){const _0x47380f=a10_0x315d,_0x545d22=_0x446d4b();while(!![]){try{const _0x40da45=-parseInt(_0x47380f(0x1ed))/0x1*(parseInt(_0x47380f(0x1bf))/0x2)+-parseInt(_0x47380f(0x1dc))/0x3*(-parseInt(_0x47380f(0x1c2))/0x4)+-parseInt(_0x47380f(0x19b))/0x5*(parseInt(_0x47380f(0x1c1))/0x6)+parseInt(_0x47380f(0x19a))/0x7+parseInt(_0x47380f(0x1f3))/0x8*(-parseInt(_0x47380f(0x1a3))/0x9)+parseInt(_0x47380f(0x1ca))/0xa*(-parseInt(_0x47380f(0x1c7))/0xb)+parseInt(_0x47380f(0x1cd))/0xc;if(_0x40da45===_0x44e71d)break;else _0x545d22['push'](_0x545d22['shift']());}catch(_0x352499){_0x545d22['push'](_0x545d22['shift']());}}}(a10_0x50d3,0x483b1));const a10_0x4a282b=(function(){let _0x10799e=!![];return function(_0x7807f0,_0x440539){const _0x445679=_0x10799e?function(){const _0x1fddc0=a10_0x315d;if(_0x440539){const _0x222e8d=_0x440539[_0x1fddc0(0x1eb)](_0x7807f0,arguments);return _0x440539=null,_0x222e8d;}}:function(){};return _0x10799e=![],_0x445679;};}()),a10_0x5d30c7=a10_0x4a282b(this,function(){const _0x21d54c=a10_0x315d;return a10_0x5d30c7['toString']()['search'](_0x21d54c(0x1e0))[_0x21d54c(0x1f1)]()['constructor'](a10_0x5d30c7)['search'](_0x21d54c(0x1e0));});a10_0x5d30c7();'use strict';var __createBinding=this&&this[a10_0x23d58f(0x1df)]||(Object[a10_0x23d58f(0x1a7)]?function(_0x14a6cf,_0x343f06,_0x5daa4a,_0x1b994c){const _0xc7844b=a10_0x23d58f;if(_0x1b994c===undefined)_0x1b994c=_0x5daa4a;var _0x6457e=Object[_0xc7844b(0x1f6)](_0x343f06,_0x5daa4a);(!_0x6457e||(_0xc7844b(0x1c4)in _0x6457e?!_0x343f06[_0xc7844b(0x196)]:_0x6457e[_0xc7844b(0x1dd)]||_0x6457e['configurable']))&&(_0x6457e={'enumerable':!![],'get':function(){return _0x343f06[_0x5daa4a];}}),Object[_0xc7844b(0x19c)](_0x14a6cf,_0x1b994c,_0x6457e);}:function(_0x1e687e,_0x11739d,_0x1a4b87,_0x1d1fcf){if(_0x1d1fcf===undefined)_0x1d1fcf=_0x1a4b87;_0x1e687e[_0x1d1fcf]=_0x11739d[_0x1a4b87];}),__setModuleDefault=this&&this['__setModuleDefault']||(Object[a10_0x23d58f(0x1a7)]?function(_0x4befa4,_0x5c1e29){const _0x20e4a6=a10_0x23d58f;Object[_0x20e4a6(0x19c)](_0x4befa4,'default',{'enumerable':!![],'value':_0x5c1e29});}:function(_0x145725,_0x22e855){const _0x45b538=a10_0x23d58f;_0x145725[_0x45b538(0x1bd)]=_0x22e855;}),__importStar=this&&this['__importStar']||function(_0x3f1bda){const _0x1f981d=a10_0x23d58f;if(_0x3f1bda&&_0x3f1bda[_0x1f981d(0x196)])return _0x3f1bda;var _0x5e05cc={};if(_0x3f1bda!=null){for(var _0x17a033 in _0x3f1bda)if(_0x17a033!==_0x1f981d(0x1bd)&&Object[_0x1f981d(0x1a2)]['hasOwnProperty'][_0x1f981d(0x1d6)](_0x3f1bda,_0x17a033))__createBinding(_0x5e05cc,_0x3f1bda,_0x17a033);}return __setModuleDefault(_0x5e05cc,_0x3f1bda),_0x5e05cc;},__importDefault=this&&this[a10_0x23d58f(0x1d4)]||function(_0x41a74c){const _0x51f9bf=a10_0x23d58f;return _0x41a74c&&_0x41a74c[_0x51f9bf(0x196)]?_0x41a74c:{'default':_0x41a74c};};Object['defineProperty'](exports,'__esModule',{'value':!![]}),exports[a10_0x23d58f(0x19d)]=exports[a10_0x23d58f(0x199)]=exports[a10_0x23d58f(0x1f5)]=exports[a10_0x23d58f(0x1bb)]=exports['restart']=exports['cancel']=exports[a10_0x23d58f(0x1ec)]=exports[a10_0x23d58f(0x1e1)]=exports[a10_0x23d58f(0x1c3)]=exports[a10_0x23d58f(0x1e6)]=void 0x0;const Yup=__importStar(require(a10_0x23d58f(0x1b4))),socket_1=require(a10_0x23d58f(0x1b5)),lodash_1=require(a10_0x23d58f(0x1de)),fs_1=__importDefault(require('fs')),path_1=__importDefault(require(a10_0x23d58f(0x1b1))),ListService_1=__importDefault(require('../services/CampaignService/ListService')),CreateService_1=__importDefault(require(a10_0x23d58f(0x1a4))),ShowService_1=__importDefault(require(a10_0x23d58f(0x1c0))),UpdateService_1=__importDefault(require(a10_0x23d58f(0x1ac))),DeleteService_1=__importDefault(require('../services/CampaignService/DeleteService')),FindService_1=__importDefault(require(a10_0x23d58f(0x198))),Campaign_1=__importDefault(require(a10_0x23d58f(0x1b9))),AppError_1=__importDefault(require('../errors/AppError')),CancelService_1=require(a10_0x23d58f(0x1aa)),RestartService_1=require(a10_0x23d58f(0x1db)),TicketTag_1=__importDefault(require(a10_0x23d58f(0x19f))),Ticket_1=__importDefault(require(a10_0x23d58f(0x1b0))),Contact_1=__importDefault(require(a10_0x23d58f(0x1c8))),ContactList_1=__importDefault(require(a10_0x23d58f(0x1f7))),ContactListItem_1=__importDefault(require(a10_0x23d58f(0x1e4))),index=async(_0x51fa19,_0x1eebd1)=>{const _0x56fc80=a10_0x23d58f,{searchParam:_0xce7ce6,pageNumber:_0x4d17a4}=_0x51fa19[_0x56fc80(0x1e2)],{companyId:_0x3e7d36}=_0x51fa19[_0x56fc80(0x1e9)],{records:_0x535890,count:_0x472747,hasMore:_0x21b4a7}=await(0x0,ListService_1[_0x56fc80(0x1bd)])({'searchParam':_0xce7ce6,'pageNumber':_0x4d17a4,'companyId':_0x3e7d36});return _0x1eebd1[_0x56fc80(0x1c9)]({'records':_0x535890,'count':_0x472747,'hasMore':_0x21b4a7});};exports[a10_0x23d58f(0x1e6)]=index;const store=async(_0x17f3e5,_0x36ce9e)=>{const _0x44d275=a10_0x23d58f,{companyId:_0x164276}=_0x17f3e5[_0x44d275(0x1e9)],_0x1df6d7=_0x17f3e5['body'],_0x185c94=Yup[_0x44d275(0x1c5)]()[_0x44d275(0x1d9)]({'name':Yup[_0x44d275(0x1cf)]()[_0x44d275(0x1ef)]()});try{await _0x185c94['validate'](_0x1df6d7);}catch(_0x334a18){throw new AppError_1['default'](_0x334a18[_0x44d275(0x1a0)]);}if(typeof _0x1df6d7[_0x44d275(0x1a1)]===_0x44d275(0x1a9)){const _0x18aedb=_0x1df6d7[_0x44d275(0x1a1)],_0x4b5c20=_0x1df6d7[_0x44d275(0x1c6)];async function _0x50d459(_0x581c18){const _0x1c77ee=_0x44d275,_0x4df907=new Date(),_0x9c6030=_0x4df907[_0x1c77ee(0x1d0)]();try{const _0x15b2fc=await TicketTag_1[_0x1c77ee(0x1bd)]['findAll']({'where':{'tagId':_0x581c18}}),_0x444303=_0x15b2fc[_0x1c77ee(0x1af)](_0x40ad6b=>_0x40ad6b[_0x1c77ee(0x1cb)]),_0xab9bbe=await Ticket_1[_0x1c77ee(0x1bd)][_0x1c77ee(0x1ae)]({'where':{'id':_0x444303}}),_0x2385bc=_0xab9bbe[_0x1c77ee(0x1af)](_0x3fb6cb=>_0x3fb6cb['contactId']),_0x38a71a=await Contact_1['default']['findAll']({'where':{'id':_0x2385bc}}),_0x579d66=_0x4b5c20+_0x1c77ee(0x1d2)+_0x581c18+'\x20-\x20'+_0x9c6030,_0x3dd557=await ContactList_1['default'][_0x1c77ee(0x1a7)]({'name':_0x579d66,'companyId':_0x164276}),{id:_0x3e72b4}=_0x3dd557,_0x362996=_0x38a71a['map'](_0x462d61=>({'name':_0x462d61[_0x1c77ee(0x1c6)],'number':_0x462d61[_0x1c77ee(0x1a9)],'email':_0x462d61[_0x1c77ee(0x1ce)],'contactListId':_0x3e72b4,'companyId':_0x164276,'isWhatsappValid':!![]}));return await ContactListItem_1['default']['bulkCreate'](_0x362996),_0x3e72b4;}catch(_0xf617d9){console[_0x1c77ee(0x1f0)]('Error\x20creating\x20contact\x20list:',_0xf617d9);throw _0xf617d9;}}_0x50d459(_0x18aedb)['then'](async _0x2d7bac=>{const _0x197bbe=_0x44d275,_0x59f15c=await(0x0,CreateService_1[_0x197bbe(0x1bd)])({..._0x1df6d7,'companyId':_0x164276,'contactListId':_0x2d7bac}),_0x31cd73=(0x0,socket_1[_0x197bbe(0x1da)])();return _0x31cd73['to']('company-'+_0x164276+_0x197bbe(0x1be))[_0x197bbe(0x1ba)](_0x197bbe(0x1e5)+_0x164276+'-campaign',{'action':'create','record':_0x59f15c}),_0x36ce9e[_0x197bbe(0x197)](0xc8)[_0x197bbe(0x1c9)](_0x59f15c);})[_0x44d275(0x1b7)](_0x1243c3=>{const _0x515cc6=_0x44d275;return console[_0x515cc6(0x1f0)]('Error:',_0x1243c3),_0x36ce9e[_0x515cc6(0x197)](0x1f4)[_0x515cc6(0x1c9)]({'error':_0x515cc6(0x1d5)});});}else{const _0xb243bd=await(0x0,CreateService_1[_0x44d275(0x1bd)])({..._0x1df6d7,'companyId':_0x164276}),_0x1578ed=(0x0,socket_1[_0x44d275(0x1da)])();return _0x1578ed['to'](_0x44d275(0x1e5)+_0x164276+_0x44d275(0x1be))[_0x44d275(0x1ba)](_0x44d275(0x1e5)+_0x164276+'-campaign',{'action':_0x44d275(0x1a7),'record':_0xb243bd}),_0x36ce9e[_0x44d275(0x197)](0xc8)[_0x44d275(0x1c9)](_0xb243bd);}};exports[a10_0x23d58f(0x1c3)]=store;const show=async(_0x14ab6b,_0x312d38)=>{const _0x72d1f8=a10_0x23d58f,{id:_0x38d8ff}=_0x14ab6b[_0x72d1f8(0x1ab)],_0x272a44=await(0x0,ShowService_1[_0x72d1f8(0x1bd)])(_0x38d8ff);return _0x312d38[_0x72d1f8(0x197)](0xc8)[_0x72d1f8(0x1c9)](_0x272a44);};exports['show']=show;const update=async(_0x3ae828,_0x248726)=>{const _0x437692=a10_0x23d58f,_0x2d06c6=_0x3ae828[_0x437692(0x1ee)],{companyId:_0x2b12b1}=_0x3ae828[_0x437692(0x1e9)],_0x51cd2f=Yup[_0x437692(0x1c5)]()[_0x437692(0x1d9)]({'name':Yup[_0x437692(0x1cf)]()[_0x437692(0x1ef)]()});try{await _0x51cd2f[_0x437692(0x1ad)](_0x2d06c6);}catch(_0x2f232c){throw new AppError_1[(_0x437692(0x1bd))](_0x2f232c[_0x437692(0x1a0)]);}const {id:_0x52c66d}=_0x3ae828[_0x437692(0x1ab)],_0x585c5d=await(0x0,UpdateService_1['default'])({..._0x2d06c6,'id':_0x52c66d}),_0x5ed37e=(0x0,socket_1[_0x437692(0x1da)])();return _0x5ed37e['to'](_0x437692(0x1e5)+_0x2b12b1+_0x437692(0x1be))[_0x437692(0x1ba)](_0x437692(0x1e5)+_0x2b12b1+'-campaign',{'action':_0x437692(0x1ec),'record':_0x585c5d}),_0x248726[_0x437692(0x197)](0xc8)['json'](_0x585c5d);};exports[a10_0x23d58f(0x1ec)]=update;function a10_0x315d(_0x47b8d6,_0x248c19){const _0x1f63cb=a10_0x50d3();return a10_0x315d=function(_0x5d30c7,_0x4a282b){_0x5d30c7=_0x5d30c7-0x195;let _0x50d357=_0x1f63cb[_0x5d30c7];return _0x50d357;},a10_0x315d(_0x47b8d6,_0x248c19);}const cancel=async(_0x4d3d5a,_0xe370f2)=>{const _0x1ef57f=a10_0x23d58f,{id:_0xa6e35f}=_0x4d3d5a[_0x1ef57f(0x1ab)];return await(0x0,CancelService_1['CancelService'])(+_0xa6e35f),_0xe370f2[_0x1ef57f(0x197)](0xcc)[_0x1ef57f(0x1c9)]({'message':_0x1ef57f(0x1e3)});};exports[a10_0x23d58f(0x1d8)]=cancel;const restart=async(_0xec0d3c,_0x205dcb)=>{const _0x582206=a10_0x23d58f,{id:_0x3465ef}=_0xec0d3c[_0x582206(0x1ab)];return await(0x0,RestartService_1[_0x582206(0x1b2)])(+_0x3465ef),_0x205dcb[_0x582206(0x197)](0xcc)[_0x582206(0x1c9)]({'message':_0x582206(0x1d3)});};exports[a10_0x23d58f(0x195)]=restart;const remove=async(_0x453c47,_0x209706)=>{const _0x4082f0=a10_0x23d58f,{id:_0x69eae2}=_0x453c47[_0x4082f0(0x1ab)],{companyId:_0x3ee41d}=_0x453c47[_0x4082f0(0x1e9)];await(0x0,DeleteService_1[_0x4082f0(0x1bd)])(_0x69eae2);const _0x19a287=(0x0,socket_1[_0x4082f0(0x1da)])();return _0x19a287['to']('company-'+_0x3ee41d+'-mainchannel')['emit'](_0x4082f0(0x1e5)+_0x3ee41d+_0x4082f0(0x1d1),{'action':_0x4082f0(0x1b3),'id':_0x69eae2}),_0x209706['status'](0xc8)[_0x4082f0(0x1c9)]({'message':_0x4082f0(0x1bc)});};function a10_0x50d3(){const _0xafaa2d=['../models/ContactListItem','company-','index','unlinkSync','save','user','originalname','apply','update','2SlcBLR','body','required','error','toString','Arquivo\x20excluído','16QZWNlE','companyId','findList','getOwnPropertyDescriptor','../models/ContactList','restart','__esModule','status','../services/CampaignService/FindService','mediaUpload','1362900shgFfl','2245gSDbEN','defineProperty','deleteMedia','existsSync','../models/TicketTag','message','tagListId','prototype','2097081SoHPdS','../services/CampaignService/CreateService','company','files','create','head','number','../services/CampaignService/CancelService','params','../services/CampaignService/UpdateService','validate','findAll','map','../models/Ticket','path','RestartService','delete','yup','../libs/socket','send','catch','mediaName','../models/Campaign','emit','remove','Campaign\x20deleted','default','-mainchannel','35780VGkULR','../services/CampaignService/ShowService','5892hdBYFF','762276dBuBIh','store','get','object','name','16621dPYNrz','../models/Contact','json','3250wpHJnr','ticketId','findByPk','16132548AOuDjf','email','string','toISOString','-campaign','\x20|\x20TAG:\x20','Reinício\x20dos\x20disparos','__importDefault','Error\x20creating\x20contact\x20list','call','mediaPath','cancel','shape','getIO','../services/CampaignService/RestartService','3LWMMit','writable','lodash','__createBinding','(((.+)+)+)+$','show','query','Cancelamento\x20realizado'];a10_0x50d3=function(){return _0xafaa2d;};return a10_0x50d3();}exports['remove']=remove;const findList=async(_0x454a54,_0xddfc0e)=>{const _0x2059b6=a10_0x23d58f,_0x4f1cc8=_0x454a54[_0x2059b6(0x1e2)],_0x4add91=await(0x0,FindService_1[_0x2059b6(0x1bd)])(_0x4f1cc8);return _0xddfc0e[_0x2059b6(0x197)](0xc8)['json'](_0x4add91);};exports[a10_0x23d58f(0x1f5)]=findList;const mediaUpload=async(_0x460bf2,_0x408b40)=>{const _0x281417=a10_0x23d58f,{id:_0x54ed13}=_0x460bf2[_0x281417(0x1ab)],_0x1ed0e5=_0x460bf2[_0x281417(0x1a6)],_0x13947f=(0x0,lodash_1[_0x281417(0x1a8)])(_0x1ed0e5);try{const _0xed6ed6=await Campaign_1[_0x281417(0x1bd)][_0x281417(0x1cc)](_0x54ed13);return _0xed6ed6[_0x281417(0x1d7)]=_0x13947f['filename'],_0xed6ed6[_0x281417(0x1b8)]=_0x13947f[_0x281417(0x1ea)],await _0xed6ed6[_0x281417(0x1e8)](),_0x408b40[_0x281417(0x1b6)]({'mensagem':'Mensagem\x20enviada'});}catch(_0x4bf6d4){throw new AppError_1[(_0x281417(0x1bd))](_0x4bf6d4[_0x281417(0x1a0)]);}};exports[a10_0x23d58f(0x199)]=mediaUpload;const deleteMedia=async(_0x4874e4,_0x126ca9)=>{const _0xd8afd6=a10_0x23d58f,{id:_0xd0f606}=_0x4874e4[_0xd8afd6(0x1ab)];try{const _0x5dbdbf=await Campaign_1[_0xd8afd6(0x1bd)]['findByPk'](_0xd0f606),_0x4478cb=path_1[_0xd8afd6(0x1bd)]['resolve']('public',_0xd8afd6(0x1a5)+_0x5dbdbf[_0xd8afd6(0x1f4)],_0x5dbdbf[_0xd8afd6(0x1d7)]),_0x69e713=fs_1[_0xd8afd6(0x1bd)][_0xd8afd6(0x19e)](_0x4478cb);return _0x69e713&&fs_1[_0xd8afd6(0x1bd)][_0xd8afd6(0x1e7)](_0x4478cb),_0x5dbdbf[_0xd8afd6(0x1d7)]=null,_0x5dbdbf[_0xd8afd6(0x1b8)]=null,await _0x5dbdbf[_0xd8afd6(0x1e8)](),_0x126ca9['send']({'mensagem':_0xd8afd6(0x1f2)});}catch(_0x4da2b6){throw new AppError_1[(_0xd8afd6(0x1bd))](_0x4da2b6[_0xd8afd6(0x1a0)]);}};exports[a10_0x23d58f(0x19d)]=deleteMedia;