const a29_0x16becf=a29_0x199c;(function(_0x19978b,_0x2ccba8){const _0x4b4550=a29_0x199c,_0x3c87de=_0x19978b();while(!![]){try{const _0x2ff594=parseInt(_0x4b4550(0xf4))/0x1+parseInt(_0x4b4550(0xea))/0x2+parseInt(_0x4b4550(0x108))/0x3+-parseInt(_0x4b4550(0x10a))/0x4+parseInt(_0x4b4550(0x113))/0x5+parseInt(_0x4b4550(0xee))/0x6*(parseInt(_0x4b4550(0x104))/0x7)+parseInt(_0x4b4550(0x10b))/0x8*(-parseInt(_0x4b4550(0xed))/0x9);if(_0x2ff594===_0x2ccba8)break;else _0x3c87de['push'](_0x3c87de['shift']());}catch(_0x168c42){_0x3c87de['push'](_0x3c87de['shift']());}}}(a29_0x37ed,0x4c636));const a29_0x293479=(function(){let _0x5f1a8c=!![];return function(_0x23dcfa,_0x396d24){const _0x42fbcf=_0x5f1a8c?function(){if(_0x396d24){const _0x4e1d60=_0x396d24['apply'](_0x23dcfa,arguments);return _0x396d24=null,_0x4e1d60;}}:function(){};return _0x5f1a8c=![],_0x42fbcf;};}()),a29_0x3c316c=a29_0x293479(this,function(){const _0x468beb=a29_0x199c;return a29_0x3c316c[_0x468beb(0x102)]()[_0x468beb(0xe1)](_0x468beb(0x115))[_0x468beb(0x102)]()[_0x468beb(0xf6)](a29_0x3c316c)[_0x468beb(0xe1)](_0x468beb(0x115));});a29_0x3c316c();'use strict';function a29_0x199c(_0x2baab1,_0x5926a4){const _0x38fdf7=a29_0x37ed();return a29_0x199c=function(_0x3c316c,_0x293479){_0x3c316c=_0x3c316c-0xe0;let _0x37ede6=_0x38fdf7[_0x3c316c];return _0x37ede6;},a29_0x199c(_0x2baab1,_0x5926a4);}var __importDefault=this&&this['__importDefault']||function(_0x345594){const _0x33bf2b=a29_0x199c;return _0x345594&&_0x345594[_0x33bf2b(0x105)]?_0x345594:{'default':_0x345594};};Object['defineProperty'](exports,a29_0x16becf(0x105),{'value':!![]}),exports[a29_0x16becf(0x110)]=exports[a29_0x16becf(0xe7)]=exports['remove']=exports[a29_0x16becf(0xf9)]=exports[a29_0x16becf(0xe5)]=exports[a29_0x16becf(0xfb)]=exports['index']=void 0x0;const socket_1=require(a29_0x16becf(0xfa)),CreateQueueService_1=__importDefault(require(a29_0x16becf(0xf7))),DeleteQueueService_1=__importDefault(require(a29_0x16becf(0xfe))),ListQueuesService_1=__importDefault(require(a29_0x16becf(0x103))),ShowQueueService_1=__importDefault(require(a29_0x16becf(0xff))),UpdateQueueService_1=__importDefault(require(a29_0x16becf(0xe0))),lodash_1=require(a29_0x16becf(0xec)),Queue_1=__importDefault(require('../models/Queue')),lodash_2=require('lodash'),fs_1=__importDefault(require('fs')),path_1=__importDefault(require(a29_0x16becf(0xf1))),AppError_1=__importDefault(require('../errors/AppError')),index=async(_0x58560f,_0x2900c5)=>{const _0x1b718b=a29_0x16becf,{companyId:_0x5bec36}=_0x58560f['user'],{companyId:_0x746a82}=_0x58560f[_0x1b718b(0x107)];let _0x775b42=_0x5bec36;!(0x0,lodash_1[_0x1b718b(0x101)])(_0x746a82)&&(_0x775b42=+_0x746a82);const _0x3e0eec=await(0x0,ListQueuesService_1['default'])({'companyId':_0x775b42});return _0x2900c5[_0x1b718b(0x10f)](0xc8)[_0x1b718b(0xfd)](_0x3e0eec);};function a29_0x37ed(){const _0x501517=['constructor','../services/QueueService/CreateQueueService','-queue','update','../libs/socket','store','message','json','../services/QueueService/DeleteQueueService','../services/QueueService/ShowQueueService','filename','isNil','toString','../services/QueueService/ListQueuesService','28wmtWbR','__esModule','mediaName','query','1414170FFUsqY','delete','843116owjdhZ','1984YuMuJs','Arquivo\x20excluÃ­do','findByPk','company-','status','deleteMedia','mediaPath','send','700715FkJdQA','companyId','(((.+)+)+)+$','remove','../services/QueueService/UpdateQueueService','search','body','default','existsSync','show','getIO','mediaUpload','emit','-mainchannel','1235112vFopGd','index','lodash','43515jkbaul','690630aGbVqo','params','originalname','path','unlinkSync','user','33236uXOhgF','files'];a29_0x37ed=function(){return _0x501517;};return a29_0x37ed();}exports[a29_0x16becf(0xeb)]=index;const store=async(_0x4ca7f3,_0x312863)=>{const _0x54fd79=a29_0x16becf,{name:_0x3adc81,color:_0x51e7c1,greetingMessage:_0x142893,outOfHoursMessage:_0x4bef35,keywords:_0x519b2f,schedules:_0x2e6545,orderQueue:_0xfc8ba4,integrationId:_0x1fccad,promptId:_0x2ec1e9}=_0x4ca7f3['body'],{companyId:_0x522ebf}=_0x4ca7f3[_0x54fd79(0xf3)],_0x38d66d=await(0x0,CreateQueueService_1[_0x54fd79(0xe3)])({'name':_0x3adc81,'color':_0x51e7c1,'greetingMessage':_0x142893,'companyId':_0x522ebf,'outOfHoursMessage':_0x4bef35,'keywords':_0x519b2f,'schedules':_0x2e6545,'orderQueue':_0xfc8ba4===''?null:_0xfc8ba4,'integrationId':_0x1fccad===''?null:_0x1fccad,'promptId':_0x2ec1e9===''?null:_0x2ec1e9}),_0x38cff5=(0x0,socket_1[_0x54fd79(0xe6)])();return _0x38cff5['to'](_0x54fd79(0x10e)+_0x522ebf+_0x54fd79(0xe9))[_0x54fd79(0xe8)]('company-'+_0x522ebf+_0x54fd79(0xf8),{'action':_0x54fd79(0xf9),'queue':_0x38d66d}),_0x312863[_0x54fd79(0x10f)](0xc8)['json'](_0x38d66d);};exports['store']=store;const show=async(_0x2f9b01,_0x32183c)=>{const _0x5a043d=a29_0x16becf,{queueId:_0x51798e}=_0x2f9b01[_0x5a043d(0xef)],{companyId:_0x18799b}=_0x2f9b01[_0x5a043d(0xf3)],_0x1b0f2d=await(0x0,ShowQueueService_1[_0x5a043d(0xe3)])(_0x51798e,_0x18799b);return _0x32183c[_0x5a043d(0x10f)](0xc8)[_0x5a043d(0xfd)](_0x1b0f2d);};exports['show']=show;const update=async(_0x403daa,_0x568ddb)=>{const _0x1aac67=a29_0x16becf,{queueId:_0x2f3428}=_0x403daa[_0x1aac67(0xef)],{companyId:_0xb4ca89}=_0x403daa[_0x1aac67(0xf3)],{name:_0x5a87ce,color:_0x40bc16,greetingMessage:_0x3f9121,outOfHoursMessage:_0x5a219c,keywords:_0x4e6ac2,newTicketOnTransfer:_0x4554be,schedules:_0xd1c35f,orderQueue:_0x61684c,integrationId:_0x3eac9a,promptId:_0x3ce214}=_0x403daa[_0x1aac67(0xe2)],_0x4673de=await(0x0,UpdateQueueService_1[_0x1aac67(0xe3)])(_0x2f3428,{'name':_0x5a87ce,'color':_0x40bc16,'greetingMessage':_0x3f9121,'outOfHoursMessage':_0x5a219c,'keywords':_0x4e6ac2,'newTicketOnTransfer':_0x4554be,'schedules':_0xd1c35f,'orderQueue':_0x61684c===''?null:_0x61684c,'integrationId':_0x3eac9a===''?null:_0x3eac9a,'promptId':_0x3ce214===''?null:_0x3ce214},_0xb4ca89),_0x3afc21=(0x0,socket_1[_0x1aac67(0xe6)])();return _0x3afc21['to']('company-'+_0xb4ca89+_0x1aac67(0xe9))['emit'](_0x1aac67(0x10e)+_0xb4ca89+_0x1aac67(0xf8),{'action':_0x1aac67(0xf9),'queue':_0x4673de}),_0x568ddb['status'](0xc9)['json'](_0x4673de);};exports['update']=update;const remove=async(_0x19c449,_0x31797b)=>{const _0x45f46f=a29_0x16becf,{queueId:_0x5d865c}=_0x19c449[_0x45f46f(0xef)],{companyId:_0x16cecc}=_0x19c449[_0x45f46f(0xf3)];await(0x0,DeleteQueueService_1[_0x45f46f(0xe3)])(_0x5d865c,_0x16cecc);const _0x5bfa28=(0x0,socket_1[_0x45f46f(0xe6)])();return _0x5bfa28['to']('company-'+_0x16cecc+_0x45f46f(0xe9))[_0x45f46f(0xe8)](_0x45f46f(0x10e)+_0x16cecc+_0x45f46f(0xf8),{'action':_0x45f46f(0x109),'queueId':+_0x5d865c}),_0x31797b['status'](0xc8)[_0x45f46f(0x112)]();};exports[a29_0x16becf(0x116)]=remove;const mediaUpload=async(_0x27f118,_0x24ea73)=>{const _0x5e71ad=a29_0x16becf,{queueId:_0x1fbe1}=_0x27f118['params'],_0x4698e0=_0x27f118[_0x5e71ad(0xf5)],_0xea338f=(0x0,lodash_2['head'])(_0x4698e0);try{const _0x3388a6=await Queue_1['default'][_0x5e71ad(0x10d)](_0x1fbe1);return _0x3388a6[_0x5e71ad(0xf9)]({'mediaPath':_0xea338f[_0x5e71ad(0x100)],'mediaName':_0xea338f[_0x5e71ad(0xf0)]}),_0x24ea73[_0x5e71ad(0x112)]({'mensagem':'Arquivo\x20Salvo'});}catch(_0x104ec3){throw new AppError_1[(_0x5e71ad(0xe3))](_0x104ec3[_0x5e71ad(0xfc)]);}};exports[a29_0x16becf(0xe7)]=mediaUpload;const deleteMedia=async(_0x203570,_0x361c0e)=>{const _0x1aec0a=a29_0x16becf,{queueId:_0x357c3f}=_0x203570[_0x1aec0a(0xef)];try{const _0x2d5aa1=await Queue_1[_0x1aec0a(0xe3)][_0x1aec0a(0x10d)](_0x357c3f),_0x2893f0=path_1[_0x1aec0a(0xe3)]['resolve']('public','company'+_0x2d5aa1[_0x1aec0a(0x114)],_0x2d5aa1[_0x1aec0a(0x111)]),_0xadd5b3=fs_1[_0x1aec0a(0xe3)][_0x1aec0a(0xe4)](_0x2893f0);return _0xadd5b3&&fs_1['default'][_0x1aec0a(0xf2)](_0x2893f0),_0x2d5aa1[_0x1aec0a(0x111)]=null,_0x2d5aa1[_0x1aec0a(0x106)]=null,await _0x2d5aa1['save'](),_0x361c0e[_0x1aec0a(0x112)]({'mensagem':_0x1aec0a(0x10c)});}catch(_0x30d938){throw new AppError_1['default'](_0x30d938[_0x1aec0a(0xfc)]);}};exports[a29_0x16becf(0x110)]=deleteMedia;