const a29_0x482f15=a29_0x3d34;(function(_0x7bad0d,_0xf6a33f){const _0x3eed8f=a29_0x3d34,_0x24397a=_0x7bad0d();while(!![]){try{const _0x1ce7c6=-parseInt(_0x3eed8f(0x1c2))/0x1*(parseInt(_0x3eed8f(0x1ec))/0x2)+-parseInt(_0x3eed8f(0x1d8))/0x3+parseInt(_0x3eed8f(0x1f1))/0x4+-parseInt(_0x3eed8f(0x1d1))/0x5*(-parseInt(_0x3eed8f(0x1ef))/0x6)+-parseInt(_0x3eed8f(0x1e0))/0x7+parseInt(_0x3eed8f(0x1e8))/0x8+-parseInt(_0x3eed8f(0x1e1))/0x9;if(_0x1ce7c6===_0xf6a33f)break;else _0x24397a['push'](_0x24397a['shift']());}catch(_0x90d981){_0x24397a['push'](_0x24397a['shift']());}}}(a29_0x26b4,0x3964b));const a29_0x4d297c=(function(){let _0x14d10b=!![];return function(_0x551962,_0x37b078){const _0x10c34d=_0x14d10b?function(){const _0x172912=a29_0x3d34;if(_0x37b078){const _0x139a86=_0x37b078[_0x172912(0x1e5)](_0x551962,arguments);return _0x37b078=null,_0x139a86;}}:function(){};return _0x14d10b=![],_0x10c34d;};}()),a29_0x1fdab3=a29_0x4d297c(this,function(){const _0x1f1d15=a29_0x3d34;return a29_0x1fdab3['toString']()['search'](_0x1f1d15(0x1e9))[_0x1f1d15(0x1d9)]()[_0x1f1d15(0x1c1)](a29_0x1fdab3)[_0x1f1d15(0x1ce)](_0x1f1d15(0x1e9));});a29_0x1fdab3();'use strict';var __importDefault=this&&this[a29_0x482f15(0x1d5)]||function(_0x1157fe){const _0x181869=a29_0x482f15;return _0x1157fe&&_0x1157fe[_0x181869(0x1da)]?_0x1157fe:{'default':_0x1157fe};};Object[a29_0x482f15(0x1e2)](exports,'__esModule',{'value':!![]}),exports[a29_0x482f15(0x1f3)]=exports['mediaUpload']=exports[a29_0x482f15(0x1c9)]=exports[a29_0x482f15(0x1de)]=exports['show']=exports[a29_0x482f15(0x1e4)]=exports['index']=void 0x0;const socket_1=require(a29_0x482f15(0x1ca)),CreateQueueService_1=__importDefault(require(a29_0x482f15(0x1cc))),DeleteQueueService_1=__importDefault(require(a29_0x482f15(0x1c3))),ListQueuesService_1=__importDefault(require(a29_0x482f15(0x1d6))),ShowQueueService_1=__importDefault(require(a29_0x482f15(0x1bd))),UpdateQueueService_1=__importDefault(require(a29_0x482f15(0x1d4))),lodash_1=require(a29_0x482f15(0x1b9)),Queue_1=__importDefault(require('../models/Queue')),lodash_2=require(a29_0x482f15(0x1b9)),fs_1=__importDefault(require('fs')),path_1=__importDefault(require('path')),AppError_1=__importDefault(require('../errors/AppError')),index=async(_0x35fd2c,_0x5f042a)=>{const _0x1afe5a=a29_0x482f15,{companyId:_0x5c45d6}=_0x35fd2c[_0x1afe5a(0x1bc)],{companyId:_0x4fd910}=_0x35fd2c[_0x1afe5a(0x1bb)];let _0x1c48d6=_0x5c45d6;!(0x0,lodash_1[_0x1afe5a(0x1d0)])(_0x4fd910)&&(_0x1c48d6=+_0x4fd910);const _0xcb68ce=await(0x0,ListQueuesService_1[_0x1afe5a(0x1dd)])({'companyId':_0x1c48d6});return _0x5f042a[_0x1afe5a(0x1e7)](0xc8)[_0x1afe5a(0x1c0)](_0xcb68ce);};function a29_0x3d34(_0x4f5a0b,_0x2522d3){const _0x937207=a29_0x26b4();return a29_0x3d34=function(_0x1fdab3,_0x4d297c){_0x1fdab3=_0x1fdab3-0x1b9;let _0x26b4cc=_0x937207[_0x1fdab3];return _0x26b4cc;},a29_0x3d34(_0x4f5a0b,_0x2522d3);}exports[a29_0x482f15(0x1c4)]=index;const store=async(_0x469c90,_0x5d9af1)=>{const _0xf3b319=a29_0x482f15,{name:_0x5806a0,color:_0x14c6f7,greetingMessage:_0x48f093,outOfHoursMessage:_0x2a730a,keywords:_0x191a64,schedules:_0x421db3,orderQueue:_0x5eea13,integrationId:_0x533f7e,promptId:_0x571983}=_0x469c90[_0xf3b319(0x1cd)],{companyId:_0x244d5b}=_0x469c90[_0xf3b319(0x1bc)],_0x2bb3b0=await(0x0,CreateQueueService_1[_0xf3b319(0x1dd)])({'name':_0x5806a0,'color':_0x14c6f7,'greetingMessage':_0x48f093,'companyId':_0x244d5b,'outOfHoursMessage':_0x2a730a,'keywords':_0x191a64,'schedules':_0x421db3,'orderQueue':_0x5eea13===''?null:_0x5eea13,'integrationId':_0x533f7e===''?null:_0x533f7e,'promptId':_0x571983===''?null:_0x571983}),_0x5cd541=(0x0,socket_1[_0xf3b319(0x1be)])();return _0x5cd541['to'](_0xf3b319(0x1ee)+_0x244d5b+_0xf3b319(0x1f2))['emit'](_0xf3b319(0x1ee)+_0x244d5b+_0xf3b319(0x1e6),{'action':_0xf3b319(0x1de),'queue':_0x2bb3b0}),_0x5d9af1[_0xf3b319(0x1e7)](0xc8)['json'](_0x2bb3b0);};exports[a29_0x482f15(0x1e4)]=store;const show=async(_0x2686f4,_0x54ffa4)=>{const _0x25cdbd=a29_0x482f15,{queueId:_0x426084}=_0x2686f4[_0x25cdbd(0x1c8)],{companyId:_0x2463eb}=_0x2686f4['user'],_0x2d283a=await(0x0,ShowQueueService_1[_0x25cdbd(0x1dd)])(_0x426084,_0x2463eb);return _0x54ffa4[_0x25cdbd(0x1e7)](0xc8)[_0x25cdbd(0x1c0)](_0x2d283a);};exports[a29_0x482f15(0x1c5)]=show;const update=async(_0x266668,_0x498d52)=>{const _0x2c0da4=a29_0x482f15,{queueId:_0x3ea25d}=_0x266668[_0x2c0da4(0x1c8)],{companyId:_0x2e998e}=_0x266668[_0x2c0da4(0x1bc)],{name:_0x4a31b8,color:_0x3ab5da,greetingMessage:_0x524de0,outOfHoursMessage:_0x557e41,keywords:_0x56807e,newTicketOnTransfer:_0x2c7a6f,schedules:_0x517bb9,orderQueue:_0x3662aa,integrationId:_0x952a34,promptId:_0x456948}=_0x266668[_0x2c0da4(0x1cd)],_0x1a7fd1=await(0x0,UpdateQueueService_1[_0x2c0da4(0x1dd)])(_0x3ea25d,{'name':_0x4a31b8,'color':_0x3ab5da,'greetingMessage':_0x524de0,'outOfHoursMessage':_0x557e41,'keywords':_0x56807e,'newTicketOnTransfer':_0x2c7a6f,'schedules':_0x517bb9,'orderQueue':_0x3662aa===''?null:_0x3662aa,'integrationId':_0x952a34===''?null:_0x952a34,'promptId':_0x456948===''?null:_0x456948},_0x2e998e),_0x18b170=(0x0,socket_1[_0x2c0da4(0x1be)])();return _0x18b170['to'](_0x2c0da4(0x1ee)+_0x2e998e+'-mainchannel')['emit'](_0x2c0da4(0x1ee)+_0x2e998e+_0x2c0da4(0x1e6),{'action':'update','queue':_0x1a7fd1}),_0x498d52[_0x2c0da4(0x1e7)](0xc9)[_0x2c0da4(0x1c0)](_0x1a7fd1);};exports[a29_0x482f15(0x1de)]=update;const remove=async(_0x4f16f8,_0x413e22)=>{const _0x2971af=a29_0x482f15,{queueId:_0x1f4ba1}=_0x4f16f8[_0x2971af(0x1c8)],{companyId:_0x3a872f}=_0x4f16f8['user'];await(0x0,DeleteQueueService_1[_0x2971af(0x1dd)])(_0x1f4ba1,_0x3a872f);const _0x442469=(0x0,socket_1[_0x2971af(0x1be)])();return _0x442469['to'](_0x2971af(0x1ee)+_0x3a872f+_0x2971af(0x1f2))[_0x2971af(0x1ed)]('company-'+_0x3a872f+_0x2971af(0x1e6),{'action':'delete','queueId':+_0x1f4ba1}),_0x413e22[_0x2971af(0x1e7)](0xc8)[_0x2971af(0x1ba)]();};exports[a29_0x482f15(0x1c9)]=remove;const mediaUpload=async(_0x203f9a,_0x4d73af)=>{const _0x43228e=a29_0x482f15,{queueId:_0x5cf339}=_0x203f9a['params'],_0x259f8a=_0x203f9a[_0x43228e(0x1f0)],_0x579add=(0x0,lodash_2[_0x43228e(0x1eb)])(_0x259f8a);try{const _0x164b0a=await Queue_1[_0x43228e(0x1dd)]['findByPk'](_0x5cf339);return _0x164b0a[_0x43228e(0x1de)]({'mediaPath':_0x579add[_0x43228e(0x1e3)],'mediaName':_0x579add['originalname']}),_0x4d73af[_0x43228e(0x1ba)]({'mensagem':_0x43228e(0x1bf)});}catch(_0x2767b5){throw new AppError_1[(_0x43228e(0x1dd))](_0x2767b5[_0x43228e(0x1db)]);}};exports[a29_0x482f15(0x1df)]=mediaUpload;function a29_0x26b4(){const _0x192fe1=['727391VFabeI','1063026XQpTYs','defineProperty','filename','store','apply','-queue','status','968360nNoFVK','(((.+)+)+)+$','public','head','2EjhZuZ','emit','company-','12EORONr','files','1781904NvJnWv','-mainchannel','deleteMedia','lodash','send','query','user','../services/QueueService/ShowQueueService','getIO','Arquivo\x20Salvo','json','constructor','124421kCsyPC','../services/QueueService/DeleteQueueService','index','show','mediaName','Arquivo\x20excluÃ­do','params','remove','../libs/socket','save','../services/QueueService/CreateQueueService','body','search','resolve','isNil','633415zKODdG','existsSync','companyId','../services/QueueService/UpdateQueueService','__importDefault','../services/QueueService/ListQueuesService','unlinkSync','715068lNeOEX','toString','__esModule','message','company','default','update','mediaUpload'];a29_0x26b4=function(){return _0x192fe1;};return a29_0x26b4();}const deleteMedia=async(_0x46884a,_0x45c33f)=>{const _0x44cd6b=a29_0x482f15,{queueId:_0x32a68b}=_0x46884a[_0x44cd6b(0x1c8)];try{const _0x17b161=await Queue_1[_0x44cd6b(0x1dd)]['findByPk'](_0x32a68b),_0x285327=path_1[_0x44cd6b(0x1dd)][_0x44cd6b(0x1cf)](_0x44cd6b(0x1ea),_0x44cd6b(0x1dc)+_0x17b161[_0x44cd6b(0x1d3)],_0x17b161['mediaPath']),_0x4e47de=fs_1[_0x44cd6b(0x1dd)][_0x44cd6b(0x1d2)](_0x285327);return _0x4e47de&&fs_1[_0x44cd6b(0x1dd)][_0x44cd6b(0x1d7)](_0x285327),_0x17b161['mediaPath']=null,_0x17b161[_0x44cd6b(0x1c6)]=null,await _0x17b161[_0x44cd6b(0x1cb)](),_0x45c33f[_0x44cd6b(0x1ba)]({'mensagem':_0x44cd6b(0x1c7)});}catch(_0x271701){throw new AppError_1[(_0x44cd6b(0x1dd))](_0x271701[_0x44cd6b(0x1db)]);}};exports[a29_0x482f15(0x1f3)]=deleteMedia;