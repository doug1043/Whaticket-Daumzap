const a29_0x367fc8=a29_0x28a8;(function(_0x17c655,_0x27f725){const _0x284b24=a29_0x28a8,_0x173ccd=_0x17c655();while(!![]){try{const _0x29374a=-parseInt(_0x284b24(0x1bc))/0x1+parseInt(_0x284b24(0x1e1))/0x2*(parseInt(_0x284b24(0x1d7))/0x3)+-parseInt(_0x284b24(0x1b8))/0x4*(-parseInt(_0x284b24(0x1b6))/0x5)+parseInt(_0x284b24(0x1cc))/0x6+parseInt(_0x284b24(0x1cf))/0x7+-parseInt(_0x284b24(0x1da))/0x8*(parseInt(_0x284b24(0x1d6))/0x9)+parseInt(_0x284b24(0x1dc))/0xa;if(_0x29374a===_0x27f725)break;else _0x173ccd['push'](_0x173ccd['shift']());}catch(_0x3670c1){_0x173ccd['push'](_0x173ccd['shift']());}}}(a29_0x3535,0x80c5f));const a29_0x246866=(function(){let _0x2151f7=!![];return function(_0x3475d7,_0x2c3507){const _0x43e826=_0x2151f7?function(){const _0x558a22=a29_0x28a8;if(_0x2c3507){const _0x9cb60f=_0x2c3507[_0x558a22(0x1e3)](_0x3475d7,arguments);return _0x2c3507=null,_0x9cb60f;}}:function(){};return _0x2151f7=![],_0x43e826;};}()),a29_0x58dd31=a29_0x246866(this,function(){const _0xa538cd=a29_0x28a8;return a29_0x58dd31[_0xa538cd(0x1d8)]()[_0xa538cd(0x1ae)]('(((.+)+)+)+$')[_0xa538cd(0x1d8)]()[_0xa538cd(0x1be)](a29_0x58dd31)[_0xa538cd(0x1ae)](_0xa538cd(0x1d9));});a29_0x58dd31();'use strict';var __importDefault=this&&this['__importDefault']||function(_0x5428a8){const _0x11bc8b=a29_0x28a8;return _0x5428a8&&_0x5428a8[_0x11bc8b(0x1cd)]?_0x5428a8:{'default':_0x5428a8};};Object['defineProperty'](exports,a29_0x367fc8(0x1cd),{'value':!![]}),exports['deleteMedia']=exports[a29_0x367fc8(0x1c0)]=exports[a29_0x367fc8(0x1b7)]=exports[a29_0x367fc8(0x1c3)]=exports[a29_0x367fc8(0x1d5)]=exports[a29_0x367fc8(0x1d2)]=exports['index']=void 0x0;const socket_1=require('../libs/socket'),CreateQueueService_1=__importDefault(require(a29_0x367fc8(0x1c2))),DeleteQueueService_1=__importDefault(require(a29_0x367fc8(0x1e2))),ListQueuesService_1=__importDefault(require(a29_0x367fc8(0x1c1))),ShowQueueService_1=__importDefault(require('../services/QueueService/ShowQueueService')),UpdateQueueService_1=__importDefault(require('../services/QueueService/UpdateQueueService')),lodash_1=require(a29_0x367fc8(0x1d3)),Queue_1=__importDefault(require(a29_0x367fc8(0x1c6))),lodash_2=require(a29_0x367fc8(0x1d3)),fs_1=__importDefault(require('fs')),path_1=__importDefault(require(a29_0x367fc8(0x1bf))),AppError_1=__importDefault(require(a29_0x367fc8(0x1c8))),index=async(_0x2ad2c3,_0xc501ed)=>{const _0x59326a=a29_0x367fc8,{companyId:_0x5110db}=_0x2ad2c3[_0x59326a(0x1c5)],{companyId:_0x1481fc}=_0x2ad2c3['query'];let _0x2317b9=_0x5110db;!(0x0,lodash_1[_0x59326a(0x1b0)])(_0x1481fc)&&(_0x2317b9=+_0x1481fc);const _0xad9897=await(0x0,ListQueuesService_1[_0x59326a(0x1b3)])({'companyId':_0x2317b9});return _0xc501ed[_0x59326a(0x1b1)](0xc8)[_0x59326a(0x1db)](_0xad9897);};exports[a29_0x367fc8(0x1e4)]=index;function a29_0x28a8(_0x52e354,_0x4186c3){const _0xb4efe8=a29_0x3535();return a29_0x28a8=function(_0x58dd31,_0x246866){_0x58dd31=_0x58dd31-0x1ac;let _0x353556=_0xb4efe8[_0x58dd31];return _0x353556;},a29_0x28a8(_0x52e354,_0x4186c3);}const store=async(_0x49d022,_0x267fb9)=>{const _0x16b6d9=a29_0x367fc8,{name:_0xee702a,color:_0x1a571b,greetingMessage:_0x1d3274,outOfHoursMessage:_0x13899a,keywords:_0x2f0cfe,schedules:_0x48a60f,orderQueue:_0x260041,integrationId:_0x33a683,promptId:_0x96fdb1}=_0x49d022[_0x16b6d9(0x1ad)],{companyId:_0x5e0a8e}=_0x49d022['user'],_0xbca396=await(0x0,CreateQueueService_1[_0x16b6d9(0x1b3)])({'name':_0xee702a,'color':_0x1a571b,'greetingMessage':_0x1d3274,'companyId':_0x5e0a8e,'outOfHoursMessage':_0x13899a,'keywords':_0x2f0cfe,'schedules':_0x48a60f,'orderQueue':_0x260041===''?null:_0x260041,'integrationId':_0x33a683===''?null:_0x33a683,'promptId':_0x96fdb1===''?null:_0x96fdb1}),_0x481df9=(0x0,socket_1[_0x16b6d9(0x1af)])();return _0x481df9['to'](_0x16b6d9(0x1ca)+_0x5e0a8e+'-mainchannel')['emit'](_0x16b6d9(0x1ca)+_0x5e0a8e+_0x16b6d9(0x1d1),{'action':'update','queue':_0xbca396}),_0x267fb9[_0x16b6d9(0x1b1)](0xc8)[_0x16b6d9(0x1db)](_0xbca396);};exports[a29_0x367fc8(0x1d2)]=store;const show=async(_0xc15201,_0x46cb04)=>{const _0x47c650=a29_0x367fc8,{queueId:_0x32f32e}=_0xc15201[_0x47c650(0x1e5)],{companyId:_0x40569e}=_0xc15201[_0x47c650(0x1c5)],_0x2e9ce6=await(0x0,ShowQueueService_1[_0x47c650(0x1b3)])(_0x32f32e,_0x40569e);return _0x46cb04[_0x47c650(0x1b1)](0xc8)['json'](_0x2e9ce6);};exports[a29_0x367fc8(0x1d5)]=show;const update=async(_0x56ae6d,_0x28edbe)=>{const _0x333230=a29_0x367fc8,{queueId:_0x15684d}=_0x56ae6d[_0x333230(0x1e5)],{companyId:_0x2ee8f4}=_0x56ae6d[_0x333230(0x1c5)],{name:_0x52a4f4,color:_0x24d13f,greetingMessage:_0x5d95f0,outOfHoursMessage:_0x51d821,keywords:_0xaf8027,newTicketOnTransfer:_0x150c21,schedules:_0x1a7a44,orderQueue:_0x39a1bf,integrationId:_0x273939,promptId:_0x3c6cee}=_0x56ae6d[_0x333230(0x1ad)],_0x4cc560=await(0x0,UpdateQueueService_1[_0x333230(0x1b3)])(_0x15684d,{'name':_0x52a4f4,'color':_0x24d13f,'greetingMessage':_0x5d95f0,'outOfHoursMessage':_0x51d821,'keywords':_0xaf8027,'newTicketOnTransfer':_0x150c21,'schedules':_0x1a7a44,'orderQueue':_0x39a1bf===''?null:_0x39a1bf,'integrationId':_0x273939===''?null:_0x273939,'promptId':_0x3c6cee===''?null:_0x3c6cee},_0x2ee8f4),_0x23af57=(0x0,socket_1[_0x333230(0x1af)])();return _0x23af57['to'](_0x333230(0x1ca)+_0x2ee8f4+_0x333230(0x1c4))[_0x333230(0x1dd)](_0x333230(0x1ca)+_0x2ee8f4+'-queue',{'action':'update','queue':_0x4cc560}),_0x28edbe[_0x333230(0x1b1)](0xc9)[_0x333230(0x1db)](_0x4cc560);};exports[a29_0x367fc8(0x1c3)]=update;const remove=async(_0x2401a1,_0x4dbcb0)=>{const _0x55c9c9=a29_0x367fc8,{queueId:_0x2aa757}=_0x2401a1[_0x55c9c9(0x1e5)],{companyId:_0x4190cc}=_0x2401a1['user'];await(0x0,DeleteQueueService_1[_0x55c9c9(0x1b3)])(_0x2aa757,_0x4190cc);const _0x2c8300=(0x0,socket_1['getIO'])();return _0x2c8300['to'](_0x55c9c9(0x1ca)+_0x4190cc+_0x55c9c9(0x1c4))['emit']('company-'+_0x4190cc+_0x55c9c9(0x1d1),{'action':_0x55c9c9(0x1ac),'queueId':+_0x2aa757}),_0x4dbcb0[_0x55c9c9(0x1b1)](0xc8)[_0x55c9c9(0x1d4)]();};exports[a29_0x367fc8(0x1b7)]=remove;const mediaUpload=async(_0x55f1f6,_0x1f007b)=>{const _0x47a927=a29_0x367fc8,{queueId:_0x1042f7}=_0x55f1f6['params'],_0x15787e=_0x55f1f6['files'],_0x260b51=(0x0,lodash_2[_0x47a927(0x1b4)])(_0x15787e);try{const _0xaf46e9=await Queue_1['default']['findByPk'](_0x1042f7);return _0xaf46e9['update']({'mediaPath':_0x260b51[_0x47a927(0x1c7)],'mediaName':_0x260b51[_0x47a927(0x1bd)]}),_0x1f007b[_0x47a927(0x1d4)]({'mensagem':_0x47a927(0x1e0)});}catch(_0x5983fb){throw new AppError_1['default'](_0x5983fb['message']);}};exports[a29_0x367fc8(0x1c0)]=mediaUpload;const deleteMedia=async(_0x58399e,_0x2a3bbb)=>{const _0x1c1571=a29_0x367fc8,{queueId:_0x10a97e}=_0x58399e['params'];try{const _0xb6b7cc=await Queue_1[_0x1c1571(0x1b3)][_0x1c1571(0x1ba)](_0x10a97e),_0x228808=path_1[_0x1c1571(0x1b3)][_0x1c1571(0x1df)](_0x1c1571(0x1ce),_0x1c1571(0x1cb)+_0xb6b7cc[_0x1c1571(0x1b5)],_0xb6b7cc[_0x1c1571(0x1de)]),_0x222662=fs_1[_0x1c1571(0x1b3)][_0x1c1571(0x1b9)](_0x228808);return _0x222662&&fs_1['default']['unlinkSync'](_0x228808),_0xb6b7cc[_0x1c1571(0x1de)]=null,_0xb6b7cc[_0x1c1571(0x1d0)]=null,await _0xb6b7cc[_0x1c1571(0x1bb)](),_0x2a3bbb[_0x1c1571(0x1d4)]({'mensagem':'Arquivo\x20exclu√≠do'});}catch(_0x8c26b7){throw new AppError_1['default'](_0x8c26b7[_0x1c1571(0x1b2)]);}};exports[a29_0x367fc8(0x1c9)]=deleteMedia;function a29_0x3535(){const _0x41562d=['remove','20SpIBRR','existsSync','findByPk','save','382256bjGpet','originalname','constructor','path','mediaUpload','../services/QueueService/ListQueuesService','../services/QueueService/CreateQueueService','update','-mainchannel','user','../models/Queue','filename','../errors/AppError','deleteMedia','company-','company','3556488VQzqjw','__esModule','public','3125934EUgIQg','mediaName','-queue','store','lodash','send','show','1776051tkhvpg','15YkUeze','toString','(((.+)+)+)+$','40wnnTVa','json','1375860kNeQMY','emit','mediaPath','resolve','Arquivo\x20Salvo','176998bvaTXl','../services/QueueService/DeleteQueueService','apply','index','params','delete','body','search','getIO','isNil','status','message','default','head','companyId','277015dSEcOA'];a29_0x3535=function(){return _0x41562d;};return a29_0x3535();}