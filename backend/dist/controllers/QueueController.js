const a27_0x1bd276=a27_0x3160;(function(_0x30e86a,_0x54e3a7){const _0x1e5c0d=a27_0x3160,_0x1d4f6f=_0x30e86a();while(!![]){try{const _0x2c33e9=parseInt(_0x1e5c0d(0x12d))/0x1*(parseInt(_0x1e5c0d(0x123))/0x2)+-parseInt(_0x1e5c0d(0x140))/0x3+-parseInt(_0x1e5c0d(0x13a))/0x4+parseInt(_0x1e5c0d(0x128))/0x5*(parseInt(_0x1e5c0d(0x14a))/0x6)+parseInt(_0x1e5c0d(0x13d))/0x7+-parseInt(_0x1e5c0d(0x137))/0x8*(parseInt(_0x1e5c0d(0x132))/0x9)+parseInt(_0x1e5c0d(0x136))/0xa;if(_0x2c33e9===_0x54e3a7)break;else _0x1d4f6f['push'](_0x1d4f6f['shift']());}catch(_0x2efae5){_0x1d4f6f['push'](_0x1d4f6f['shift']());}}}(a27_0x344a,0x493eb));const a27_0x342746=(function(){let _0x32b4e7=!![];return function(_0x599938,_0x576f8d){const _0x2a770b=_0x32b4e7?function(){const _0x37ee11=a27_0x3160;if(_0x576f8d){const _0x50d534=_0x576f8d[_0x37ee11(0x11c)](_0x599938,arguments);return _0x576f8d=null,_0x50d534;}}:function(){};return _0x32b4e7=![],_0x2a770b;};}()),a27_0x470b9e=a27_0x342746(this,function(){const _0x22bf75=a27_0x3160;return a27_0x470b9e[_0x22bf75(0x14b)]()[_0x22bf75(0x11f)](_0x22bf75(0x125))[_0x22bf75(0x14b)]()['constructor'](a27_0x470b9e)[_0x22bf75(0x11f)](_0x22bf75(0x125));});a27_0x470b9e();'use strict';var __importDefault=this&&this[a27_0x1bd276(0x149)]||function(_0x1241af){const _0x112262=a27_0x1bd276;return _0x1241af&&_0x1241af[_0x112262(0x12a)]?_0x1241af:{'default':_0x1241af};};Object['defineProperty'](exports,a27_0x1bd276(0x12a),{'value':!![]}),exports[a27_0x1bd276(0x14c)]=exports[a27_0x1bd276(0x150)]=exports['remove']=exports[a27_0x1bd276(0x142)]=exports[a27_0x1bd276(0x143)]=exports[a27_0x1bd276(0x130)]=exports[a27_0x1bd276(0x12e)]=void 0x0;const socket_1=require(a27_0x1bd276(0x14f)),CreateQueueService_1=__importDefault(require(a27_0x1bd276(0x144))),DeleteQueueService_1=__importDefault(require(a27_0x1bd276(0x118))),ListQueuesService_1=__importDefault(require(a27_0x1bd276(0x151))),ShowQueueService_1=__importDefault(require(a27_0x1bd276(0x14d))),UpdateQueueService_1=__importDefault(require(a27_0x1bd276(0x134))),lodash_1=require('lodash'),Queue_1=__importDefault(require(a27_0x1bd276(0x138))),lodash_2=require(a27_0x1bd276(0x12b)),fs_1=__importDefault(require('fs')),path_1=__importDefault(require(a27_0x1bd276(0x11e))),AppError_1=__importDefault(require(a27_0x1bd276(0x11b))),index=async(_0x57f313,_0x55c157)=>{const _0x422851=a27_0x1bd276,{companyId:_0x28443e}=_0x57f313[_0x422851(0x141)],{companyId:_0x1ad661}=_0x57f313[_0x422851(0x120)];let _0x194564=_0x28443e;!(0x0,lodash_1[_0x422851(0x119)])(_0x1ad661)&&(_0x194564=+_0x1ad661);const _0xf99a89=await(0x0,ListQueuesService_1[_0x422851(0x133)])({'companyId':_0x194564});return _0x55c157[_0x422851(0x12f)](0xc8)[_0x422851(0x13f)](_0xf99a89);};exports[a27_0x1bd276(0x12e)]=index;const store=async(_0x5282dc,_0x2ae512)=>{const _0x321fd8=a27_0x1bd276,{name:_0x594830,color:_0x56b402,greetingMessage:_0x3c751e,outOfHoursMessage:_0x3a9408}=_0x5282dc['body'],{companyId:_0x157728}=_0x5282dc[_0x321fd8(0x141)],_0xc5a4ea=await(0x0,CreateQueueService_1[_0x321fd8(0x133)])({'name':_0x594830,'color':_0x56b402,'greetingMessage':_0x3c751e,'companyId':_0x157728,'outOfHoursMessage':_0x3a9408}),_0x32f3f1=(0x0,socket_1[_0x321fd8(0x117)])();return _0x32f3f1[_0x321fd8(0x124)](_0x321fd8(0x139)+_0x157728+_0x321fd8(0x126),{'action':_0x321fd8(0x142),'queue':_0xc5a4ea}),_0x2ae512['status'](0xc8)['json'](_0xc5a4ea);};exports[a27_0x1bd276(0x130)]=store;const show=async(_0xda2fae,_0x5756bf)=>{const _0x24850e=a27_0x1bd276,{queueId:_0x293b98}=_0xda2fae[_0x24850e(0x145)],{companyId:_0x4682a3}=_0xda2fae[_0x24850e(0x141)],_0x596d0e=await(0x0,ShowQueueService_1['default'])(_0x293b98,_0x4682a3);return _0x5756bf[_0x24850e(0x12f)](0xc8)[_0x24850e(0x13f)](_0x596d0e);};exports['show']=show;const update=async(_0x165e54,_0x38642b)=>{const _0x2947f1=a27_0x1bd276,{queueId:_0x24145b}=_0x165e54['params'],{companyId:_0x46ea0e}=_0x165e54['user'],_0x5e79b4=await(0x0,UpdateQueueService_1[_0x2947f1(0x133)])(_0x24145b,_0x165e54[_0x2947f1(0x13e)],_0x46ea0e),_0x487428=(0x0,socket_1[_0x2947f1(0x117)])();return _0x487428['emit'](_0x2947f1(0x139)+_0x46ea0e+_0x2947f1(0x126),{'action':_0x2947f1(0x142),'queue':_0x5e79b4}),_0x38642b[_0x2947f1(0x12f)](0xc9)['json'](_0x5e79b4);};exports[a27_0x1bd276(0x142)]=update;const remove=async(_0x4ee401,_0x2d04da)=>{const _0x110111=a27_0x1bd276,{queueId:_0x15c874}=_0x4ee401[_0x110111(0x145)],{companyId:_0x18644c}=_0x4ee401[_0x110111(0x141)];await(0x0,DeleteQueueService_1[_0x110111(0x133)])(_0x15c874,_0x18644c);const _0x5bd93a=(0x0,socket_1[_0x110111(0x117)])();return _0x5bd93a['emit']('company-'+_0x18644c+_0x110111(0x126),{'action':_0x110111(0x13b),'queueId':+_0x15c874}),_0x2d04da[_0x110111(0x12f)](0xc8)[_0x110111(0x13c)]();};exports[a27_0x1bd276(0x127)]=remove;function a27_0x3160(_0x2bde11,_0x8830a2){const _0x297bdc=a27_0x344a();return a27_0x3160=function(_0x470b9e,_0x342746){_0x470b9e=_0x470b9e-0x117;let _0x344a05=_0x297bdc[_0x470b9e];return _0x344a05;},a27_0x3160(_0x2bde11,_0x8830a2);}const mediaUpload=async(_0x41f03d,_0x259f28)=>{const _0x51aeda=a27_0x1bd276,{queueId:_0x100778}=_0x41f03d[_0x51aeda(0x145)],_0x43cea6=_0x41f03d[_0x51aeda(0x147)],_0x535176=(0x0,lodash_2[_0x51aeda(0x121)])(_0x43cea6);try{const _0x31286e=await Queue_1['default'][_0x51aeda(0x135)](_0x100778);return _0x31286e[_0x51aeda(0x142)]({'mediaPath':_0x535176[_0x51aeda(0x146)],'mediaName':_0x535176[_0x51aeda(0x148)]}),_0x259f28[_0x51aeda(0x13c)]({'mensagem':_0x51aeda(0x11a)});}catch(_0xbeef8c){throw new AppError_1[(_0x51aeda(0x133))](_0xbeef8c[_0x51aeda(0x14e)]);}};function a27_0x344a(){const _0x32ce99=['../services/QueueService/ListQueuesService','getIO','../services/QueueService/DeleteQueueService','isNil','Arquivo\x20Salvo','../errors/AppError','apply','mediaName','path','search','query','head','existsSync','14AlghVL','emit','(((.+)+)+)+$','-queue','remove','33430VAGjLr','public','__esModule','lodash','mediaPath','68687BVBPgt','index','status','store','save','4644SWgtMU','default','../services/QueueService/UpdateQueueService','findByPk','5352110TwmIqj','4256XDTPUF','../models/Queue','company-','2257636pnycGy','delete','send','3830106rxhMHJ','body','json','1352970JDfvnE','user','update','show','../services/QueueService/CreateQueueService','params','filename','files','originalname','__importDefault','24AWcXMK','toString','deleteMedia','../services/QueueService/ShowQueueService','message','../libs/socket','mediaUpload'];a27_0x344a=function(){return _0x32ce99;};return a27_0x344a();}exports[a27_0x1bd276(0x150)]=mediaUpload;const deleteMedia=async(_0x40a0a0,_0x4b0a07)=>{const _0x4d7949=a27_0x1bd276,{queueId:_0x3a7728}=_0x40a0a0['params'];try{const _0x1757f6=await Queue_1['default']['findByPk'](_0x3a7728),_0x547887=path_1[_0x4d7949(0x133)]['resolve'](_0x4d7949(0x129),_0x1757f6['mediaPath']),_0x143d47=fs_1[_0x4d7949(0x133)][_0x4d7949(0x122)](_0x547887);return _0x143d47&&fs_1[_0x4d7949(0x133)]['unlinkSync'](_0x547887),_0x1757f6[_0x4d7949(0x12c)]=null,_0x1757f6[_0x4d7949(0x11d)]=null,await _0x1757f6[_0x4d7949(0x131)](),_0x4b0a07[_0x4d7949(0x13c)]({'mensagem':'Arquivo\x20exclu√≠do'});}catch(_0x4406a2){throw new AppError_1['default'](_0x4406a2[_0x4d7949(0x14e)]);}};exports[a27_0x1bd276(0x14c)]=deleteMedia;