const a29_0x3de2a4=a29_0xef65;(function(_0x4cd906,_0x2a10ba){const _0x27e9fe=a29_0xef65,_0x43b73b=_0x4cd906();while(!![]){try{const _0x267842=-parseInt(_0x27e9fe(0xe7))/0x1+parseInt(_0x27e9fe(0xeb))/0x2+parseInt(_0x27e9fe(0x108))/0x3*(-parseInt(_0x27e9fe(0x10b))/0x4)+-parseInt(_0x27e9fe(0xe9))/0x5+parseInt(_0x27e9fe(0xdb))/0x6*(-parseInt(_0x27e9fe(0x10d))/0x7)+parseInt(_0x27e9fe(0xf5))/0x8*(parseInt(_0x27e9fe(0xf9))/0x9)+-parseInt(_0x27e9fe(0xe1))/0xa*(-parseInt(_0x27e9fe(0xe3))/0xb);if(_0x267842===_0x2a10ba)break;else _0x43b73b['push'](_0x43b73b['shift']());}catch(_0xdb55d8){_0x43b73b['push'](_0x43b73b['shift']());}}}(a29_0x2ed8,0xc776b));const a29_0x1b592f=(function(){let _0x2e71ff=!![];return function(_0x5b685c,_0x5d75ae){const _0x17e706=_0x2e71ff?function(){const _0x37e417=a29_0xef65;if(_0x5d75ae){const _0x33a3c4=_0x5d75ae[_0x37e417(0xfb)](_0x5b685c,arguments);return _0x5d75ae=null,_0x33a3c4;}}:function(){};return _0x2e71ff=![],_0x17e706;};}()),a29_0x1a1765=a29_0x1b592f(this,function(){const _0x200403=a29_0xef65;return a29_0x1a1765[_0x200403(0x110)]()['search'](_0x200403(0xe4))[_0x200403(0x110)]()['constructor'](a29_0x1a1765)[_0x200403(0xe8)]('(((.+)+)+)+$');});a29_0x1a1765();'use strict';var __importDefault=this&&this[a29_0x3de2a4(0xee)]||function(_0x2fa14d){const _0xfc2c49=a29_0x3de2a4;return _0x2fa14d&&_0x2fa14d[_0xfc2c49(0xdd)]?_0x2fa14d:{'default':_0x2fa14d};};Object[a29_0x3de2a4(0x104)](exports,a29_0x3de2a4(0xdd),{'value':!![]}),exports[a29_0x3de2a4(0xdc)]=exports[a29_0x3de2a4(0xfd)]=exports[a29_0x3de2a4(0x101)]=exports[a29_0x3de2a4(0xf2)]=exports[a29_0x3de2a4(0x103)]=exports[a29_0x3de2a4(0xf4)]=exports['index']=void 0x0;const socket_1=require('../libs/socket'),CreateQueueService_1=__importDefault(require(a29_0x3de2a4(0xf3))),DeleteQueueService_1=__importDefault(require(a29_0x3de2a4(0x111))),ListQueuesService_1=__importDefault(require(a29_0x3de2a4(0xda))),ShowQueueService_1=__importDefault(require('../services/QueueService/ShowQueueService')),UpdateQueueService_1=__importDefault(require(a29_0x3de2a4(0x106))),lodash_1=require(a29_0x3de2a4(0xfe)),Queue_1=__importDefault(require('../models/Queue')),lodash_2=require(a29_0x3de2a4(0xfe)),fs_1=__importDefault(require('fs')),path_1=__importDefault(require(a29_0x3de2a4(0xff))),AppError_1=__importDefault(require(a29_0x3de2a4(0x10a))),index=async(_0x3ca446,_0x145cef)=>{const _0x15ed94=a29_0x3de2a4,{companyId:_0x4ba789}=_0x3ca446['user'],{companyId:_0x31f9f2}=_0x3ca446['query'];let _0x27f6f9=_0x4ba789;!(0x0,lodash_1[_0x15ed94(0x100)])(_0x31f9f2)&&(_0x27f6f9=+_0x31f9f2);const _0x2d57ca=await(0x0,ListQueuesService_1[_0x15ed94(0xf8)])({'companyId':_0x27f6f9});return _0x145cef[_0x15ed94(0xf0)](0xc8)[_0x15ed94(0x112)](_0x2d57ca);};exports['index']=index;function a29_0x2ed8(){const _0x55c74e=['../services/QueueService/ListQueuesService','28398JglGCr','deleteMedia','__esModule','unlinkSync','files','company','110yOHKnL','resolve','2761165mJPxqO','(((.+)+)+)+$','body','save','1394338zdvRQq','search','921815WnunAY','user','688546PTUFtG','findByPk','message','__importDefault','emit','status','public','update','../services/QueueService/CreateQueueService','store','8TYDegF','filename','getIO','default','7452711NQGOFP','company-','apply','Arquivo\x20excluÃ­do','mediaUpload','lodash','path','isNil','remove','mediaName','show','defineProperty','params','../services/QueueService/UpdateQueueService','-queue','15CxrDmO','companyId','../errors/AppError','639572qOCGZk','-mainchannel','1092Sbsajw','send','mediaPath','toString','../services/QueueService/DeleteQueueService','json','Arquivo\x20Salvo'];a29_0x2ed8=function(){return _0x55c74e;};return a29_0x2ed8();}const store=async(_0x114550,_0x5627e7)=>{const _0x4f0e13=a29_0x3de2a4,{name:_0x4f9120,color:_0x33e2d0,greetingMessage:_0x4f048b,outOfHoursMessage:_0x6681ee,keywords:_0x1a4821,schedules:_0x4c88a6,orderQueue:_0x42502e,integrationId:_0x3f6fe0,promptId:_0x1c9799}=_0x114550[_0x4f0e13(0xe5)],{companyId:_0x496079}=_0x114550[_0x4f0e13(0xea)],_0x1857d3=await(0x0,CreateQueueService_1['default'])({'name':_0x4f9120,'color':_0x33e2d0,'greetingMessage':_0x4f048b,'companyId':_0x496079,'outOfHoursMessage':_0x6681ee,'keywords':_0x1a4821,'schedules':_0x4c88a6,'orderQueue':_0x42502e===''?null:_0x42502e,'integrationId':_0x3f6fe0===''?null:_0x3f6fe0,'promptId':_0x1c9799===''?null:_0x1c9799}),_0x3e8804=(0x0,socket_1[_0x4f0e13(0xf7)])();return _0x3e8804['to'](_0x4f0e13(0xfa)+_0x496079+_0x4f0e13(0x10c))[_0x4f0e13(0xef)]('company-'+_0x496079+'-queue',{'action':_0x4f0e13(0xf2),'queue':_0x1857d3}),_0x5627e7[_0x4f0e13(0xf0)](0xc8)[_0x4f0e13(0x112)](_0x1857d3);};exports[a29_0x3de2a4(0xf4)]=store;const show=async(_0x273dfc,_0xb051b2)=>{const _0x584d5c=a29_0x3de2a4,{queueId:_0x581a98}=_0x273dfc['params'],{companyId:_0x5412bc}=_0x273dfc[_0x584d5c(0xea)],_0x1e29f3=await(0x0,ShowQueueService_1['default'])(_0x581a98,_0x5412bc);return _0xb051b2['status'](0xc8)[_0x584d5c(0x112)](_0x1e29f3);};exports[a29_0x3de2a4(0x103)]=show;const update=async(_0x389f70,_0x45bbbf)=>{const _0x2d1b94=a29_0x3de2a4,{queueId:_0x4e5502}=_0x389f70[_0x2d1b94(0x105)],{companyId:_0xd2c2ed}=_0x389f70[_0x2d1b94(0xea)],{name:_0x42ea31,color:_0x24f0fc,greetingMessage:_0x3f8583,outOfHoursMessage:_0x188a00,keywords:_0x2b1163,newTicketOnTransfer:_0x276e89,schedules:_0x10c02f,orderQueue:_0x3d9d60,integrationId:_0x4b9c4c,promptId:_0x3627a6}=_0x389f70['body'],_0x31a6ad=await(0x0,UpdateQueueService_1[_0x2d1b94(0xf8)])(_0x4e5502,{'name':_0x42ea31,'color':_0x24f0fc,'greetingMessage':_0x3f8583,'outOfHoursMessage':_0x188a00,'keywords':_0x2b1163,'newTicketOnTransfer':_0x276e89,'schedules':_0x10c02f,'orderQueue':_0x3d9d60===''?null:_0x3d9d60,'integrationId':_0x4b9c4c===''?null:_0x4b9c4c,'promptId':_0x3627a6===''?null:_0x3627a6},_0xd2c2ed),_0x467d1c=(0x0,socket_1['getIO'])();return _0x467d1c['to']('company-'+_0xd2c2ed+_0x2d1b94(0x10c))[_0x2d1b94(0xef)]('company-'+_0xd2c2ed+_0x2d1b94(0x107),{'action':'update','queue':_0x31a6ad}),_0x45bbbf[_0x2d1b94(0xf0)](0xc9)[_0x2d1b94(0x112)](_0x31a6ad);};exports[a29_0x3de2a4(0xf2)]=update;const remove=async(_0x506376,_0x14a885)=>{const _0x38daff=a29_0x3de2a4,{queueId:_0x42d11c}=_0x506376[_0x38daff(0x105)],{companyId:_0x31ea0b}=_0x506376[_0x38daff(0xea)];await(0x0,DeleteQueueService_1[_0x38daff(0xf8)])(_0x42d11c,_0x31ea0b);const _0x4a56c5=(0x0,socket_1[_0x38daff(0xf7)])();return _0x4a56c5['to'](_0x38daff(0xfa)+_0x31ea0b+'-mainchannel')[_0x38daff(0xef)](_0x38daff(0xfa)+_0x31ea0b+_0x38daff(0x107),{'action':'delete','queueId':+_0x42d11c}),_0x14a885['status'](0xc8)[_0x38daff(0x10e)]();};function a29_0xef65(_0x4ceb9f,_0x2a3ecb){const _0x445f42=a29_0x2ed8();return a29_0xef65=function(_0x1a1765,_0x1b592f){_0x1a1765=_0x1a1765-0xda;let _0x2ed88b=_0x445f42[_0x1a1765];return _0x2ed88b;},a29_0xef65(_0x4ceb9f,_0x2a3ecb);}exports[a29_0x3de2a4(0x101)]=remove;const mediaUpload=async(_0x48d2fd,_0x56e502)=>{const _0x19171b=a29_0x3de2a4,{queueId:_0x564719}=_0x48d2fd[_0x19171b(0x105)],_0xf9f597=_0x48d2fd[_0x19171b(0xdf)],_0x5c662e=(0x0,lodash_2['head'])(_0xf9f597);try{const _0x2f1fe7=await Queue_1[_0x19171b(0xf8)][_0x19171b(0xec)](_0x564719);return _0x2f1fe7['update']({'mediaPath':_0x5c662e[_0x19171b(0xf6)],'mediaName':_0x5c662e['originalname']}),_0x56e502[_0x19171b(0x10e)]({'mensagem':_0x19171b(0x113)});}catch(_0x5d37be){throw new AppError_1[(_0x19171b(0xf8))](_0x5d37be['message']);}};exports[a29_0x3de2a4(0xfd)]=mediaUpload;const deleteMedia=async(_0x348bed,_0x1102a8)=>{const _0xe001dc=a29_0x3de2a4,{queueId:_0x2efe2d}=_0x348bed[_0xe001dc(0x105)];try{const _0x1613c3=await Queue_1['default'][_0xe001dc(0xec)](_0x2efe2d),_0x59b33b=path_1[_0xe001dc(0xf8)][_0xe001dc(0xe2)](_0xe001dc(0xf1),_0xe001dc(0xe0)+_0x1613c3[_0xe001dc(0x109)],_0x1613c3[_0xe001dc(0x10f)]),_0x58d16a=fs_1[_0xe001dc(0xf8)]['existsSync'](_0x59b33b);return _0x58d16a&&fs_1[_0xe001dc(0xf8)][_0xe001dc(0xde)](_0x59b33b),_0x1613c3[_0xe001dc(0x10f)]=null,_0x1613c3[_0xe001dc(0x102)]=null,await _0x1613c3[_0xe001dc(0xe6)](),_0x1102a8['send']({'mensagem':_0xe001dc(0xfc)});}catch(_0x36ffa5){throw new AppError_1[(_0xe001dc(0xf8))](_0x36ffa5[_0xe001dc(0xed)]);}};exports['deleteMedia']=deleteMedia;