const a34_0x200ad9=a34_0x5d35;(function(_0x33a858,_0x507d5c){const _0x10955b=a34_0x5d35,_0x1a4813=_0x33a858();while(!![]){try{const _0x43d442=-parseInt(_0x10955b(0x161))/0x1*(parseInt(_0x10955b(0x146))/0x2)+parseInt(_0x10955b(0x143))/0x3+-parseInt(_0x10955b(0x13b))/0x4*(-parseInt(_0x10955b(0x158))/0x5)+parseInt(_0x10955b(0x151))/0x6+parseInt(_0x10955b(0x13f))/0x7+-parseInt(_0x10955b(0x155))/0x8*(-parseInt(_0x10955b(0x164))/0x9)+-parseInt(_0x10955b(0x15f))/0xa;if(_0x43d442===_0x507d5c)break;else _0x1a4813['push'](_0x1a4813['shift']());}catch(_0x321a43){_0x1a4813['push'](_0x1a4813['shift']());}}}(a34_0x51a4,0x4e364));const a34_0xa90a91=(function(){let _0x26b348=!![];return function(_0x91ca70,_0x3c82be){const _0x2929e7=_0x26b348?function(){const _0x3d6896=a34_0x5d35;if(_0x3c82be){const _0xcbf309=_0x3c82be[_0x3d6896(0x142)](_0x91ca70,arguments);return _0x3c82be=null,_0xcbf309;}}:function(){};return _0x26b348=![],_0x2929e7;};}()),a34_0xfd08eb=a34_0xa90a91(this,function(){const _0x4a2b1f=a34_0x5d35;return a34_0xfd08eb['toString']()['search'](_0x4a2b1f(0x14d))[_0x4a2b1f(0x145)]()['constructor'](a34_0xfd08eb)[_0x4a2b1f(0x152)]('(((.+)+)+)+$');});a34_0xfd08eb();'use strict';var __importDefault=this&&this[a34_0x200ad9(0x15c)]||function(_0x5a225b){return _0x5a225b&&_0x5a225b['__esModule']?_0x5a225b:{'default':_0x5a225b};};Object['defineProperty'](exports,'__esModule',{'value':!![]}),exports['deleteMedia']=exports[a34_0x200ad9(0x14e)]=exports[a34_0x200ad9(0x137)]=exports[a34_0x200ad9(0x160)]=exports[a34_0x200ad9(0x13c)]=exports[a34_0x200ad9(0x14f)]=exports[a34_0x200ad9(0x12b)]=void 0x0;const socket_1=require('../libs/socket'),CreateQueueService_1=__importDefault(require(a34_0x200ad9(0x156))),DeleteQueueService_1=__importDefault(require(a34_0x200ad9(0x134))),ListQueuesService_1=__importDefault(require(a34_0x200ad9(0x149))),ShowQueueService_1=__importDefault(require(a34_0x200ad9(0x150))),UpdateQueueService_1=__importDefault(require(a34_0x200ad9(0x138))),lodash_1=require(a34_0x200ad9(0x157)),Queue_1=__importDefault(require('../models/Queue')),lodash_2=require(a34_0x200ad9(0x157)),AppError_1=__importDefault(require(a34_0x200ad9(0x15b))),StorageService_1=__importDefault(require(a34_0x200ad9(0x135))),index=async(_0x8036b,_0x57fb4e)=>{const _0x491343=a34_0x200ad9,{companyId:_0x2f6060}=_0x8036b[_0x491343(0x130)],{companyId:_0x58151e}=_0x8036b['query'];let _0x32fd86=_0x2f6060;!(0x0,lodash_1[_0x491343(0x139)])(_0x58151e)&&(_0x32fd86=+_0x58151e);const _0x44abd5=await(0x0,ListQueuesService_1[_0x491343(0x162)])({'companyId':_0x32fd86});return _0x57fb4e[_0x491343(0x153)](0xc8)['json'](_0x44abd5);};exports[a34_0x200ad9(0x12b)]=index;const store=async(_0x308cb8,_0x184195)=>{const _0x2540f8=a34_0x200ad9,{name:_0x3e6baa,color:_0x4f0b82,greetingMessage:_0x50c29e,outOfHoursMessage:_0x2c6131,orderQueue:_0x44b838,integrationId:_0x2c6a8c,flowBuilderId:_0x323f9e}=_0x308cb8['body'],{companyId:_0x29425d}=_0x308cb8[_0x2540f8(0x130)],_0x4083ff=await(0x0,CreateQueueService_1[_0x2540f8(0x162)])({'name':_0x3e6baa,'color':_0x4f0b82,'greetingMessage':_0x50c29e,'companyId':_0x29425d,'outOfHoursMessage':_0x2c6131,'orderQueue':_0x44b838,'integrationId':_0x2c6a8c&&_0x2c6a8c!==''?_0x2c6a8c:null,'flowBuilderId':_0x323f9e&&_0x323f9e!==''?_0x323f9e:null}),_0x7ad828=(0x0,socket_1['getIO'])();return _0x7ad828[_0x2540f8(0x140)](_0x2540f8(0x141)+_0x29425d+_0x2540f8(0x12d),{'action':_0x2540f8(0x160),'queue':_0x4083ff}),_0x184195[_0x2540f8(0x153)](0xc8)['json'](_0x4083ff);};exports[a34_0x200ad9(0x14f)]=store;const show=async(_0x51000c,_0x89d94)=>{const _0x636a8c=a34_0x200ad9,{queueId:_0x27df3e}=_0x51000c[_0x636a8c(0x136)],{companyId:_0x7c4fcc}=_0x51000c[_0x636a8c(0x130)],_0x56cff8=await(0x0,ShowQueueService_1[_0x636a8c(0x162)])(_0x27df3e,_0x7c4fcc);return _0x89d94['status'](0xc8)['json'](_0x56cff8);};exports['show']=show;const update=async(_0x4e4448,_0xc211cd)=>{const _0x1ae99e=a34_0x200ad9,{queueId:_0x50543b}=_0x4e4448['params'],{companyId:_0x562462}=_0x4e4448['user'],_0x285bb0={..._0x4e4448[_0x1ae99e(0x14a)],'integrationId':_0x4e4448[_0x1ae99e(0x14a)][_0x1ae99e(0x148)]&&_0x4e4448[_0x1ae99e(0x14a)][_0x1ae99e(0x148)]!==''?_0x4e4448[_0x1ae99e(0x14a)][_0x1ae99e(0x148)]:null,'flowBuilderId':_0x4e4448[_0x1ae99e(0x14a)][_0x1ae99e(0x154)]&&_0x4e4448[_0x1ae99e(0x14a)][_0x1ae99e(0x154)]!==''?_0x4e4448['body']['flowBuilderId']:null},_0x62d6c4=await(0x0,UpdateQueueService_1[_0x1ae99e(0x162)])(_0x50543b,_0x285bb0,_0x562462),_0x4ec4bc=(0x0,socket_1[_0x1ae99e(0x159)])();return _0x4ec4bc['emit']('company-'+_0x562462+_0x1ae99e(0x12d),{'action':_0x1ae99e(0x160),'queue':_0x62d6c4}),_0xc211cd[_0x1ae99e(0x153)](0xc9)[_0x1ae99e(0x15e)](_0x62d6c4);};function a34_0x5d35(_0x40ca70,_0x330b4d){const _0x30887d=a34_0x51a4();return a34_0x5d35=function(_0xfd08eb,_0xa90a91){_0xfd08eb=_0xfd08eb-0x128;let _0x51a459=_0x30887d[_0xfd08eb];return _0x51a459;},a34_0x5d35(_0x40ca70,_0x330b4d);}exports[a34_0x200ad9(0x160)]=update;const remove=async(_0x37889d,_0x648813)=>{const _0x38071a=a34_0x200ad9,{queueId:_0x3ed46e}=_0x37889d[_0x38071a(0x136)],{companyId:_0x522ec4}=_0x37889d[_0x38071a(0x130)];await(0x0,DeleteQueueService_1[_0x38071a(0x162)])(_0x3ed46e,_0x522ec4);const _0x133641=(0x0,socket_1[_0x38071a(0x159)])();return _0x133641[_0x38071a(0x140)](_0x38071a(0x141)+_0x522ec4+_0x38071a(0x12d),{'action':_0x38071a(0x147),'queueId':+_0x3ed46e}),_0x648813[_0x38071a(0x153)](0xc8)[_0x38071a(0x129)]();};exports['remove']=remove;function a34_0x51a4(){const _0x134fcd=['-queue','save','mediaPath','user','deleteMedia','path','filename','../services/QueueService/DeleteQueueService','../services/StorageService/StorageService','params','remove','../services/QueueService/UpdateQueueService','isNil','filas','4WETjJC','show','originalname','Arquivo\x20excluÃ­do','1013628VmzPiD','emit','company-','apply','796872AENpzv','findByPk','toString','604xCSXGo','delete','integrationId','../services/QueueService/ListQueuesService','body','head','message','(((.+)+)+)+$','mediaUpload','store','../services/QueueService/ShowQueueService','55200TpyXvz','search','status','flowBuilderId','139512zGQpnV','../services/QueueService/CreateQueueService','lodash','2927065spGBeJ','getIO','uploadFile','../errors/AppError','__importDefault','mimetype','json','10270460qbrbrB','update','79anIwwU','default','Arquivo\x20Salvo','189BlDOJy','files','send','mediaName','index','deleteFile'];a34_0x51a4=function(){return _0x134fcd;};return a34_0x51a4();}const mediaUpload=async(_0x5902ae,_0x18d2e2)=>{const _0x3082b2=a34_0x200ad9,{queueId:_0x2a4597}=_0x5902ae['params'],_0x2d4777=_0x5902ae[_0x3082b2(0x128)],_0x483f5a=(0x0,lodash_2[_0x3082b2(0x14b)])(_0x2d4777);try{const _0x457183=await Queue_1[_0x3082b2(0x162)][_0x3082b2(0x144)](_0x2a4597),{companyId:_0x9e9a6a}=_0x5902ae['user'],{url:_0x5cd89f}=await StorageService_1['default'][_0x3082b2(0x15a)](_0x9e9a6a,_0x3082b2(0x13a),_0x483f5a[_0x3082b2(0x133)],_0x483f5a[_0x3082b2(0x132)],_0x483f5a[_0x3082b2(0x15d)]);return _0x457183['update']({'mediaPath':_0x5cd89f,'mediaName':_0x483f5a[_0x3082b2(0x13d)]}),_0x18d2e2[_0x3082b2(0x129)]({'mensagem':_0x3082b2(0x163)});}catch(_0x31d57c){throw new AppError_1[(_0x3082b2(0x162))](_0x31d57c[_0x3082b2(0x14c)]);}};exports[a34_0x200ad9(0x14e)]=mediaUpload;const deleteMedia=async(_0x57d0f7,_0x21a306)=>{const _0x5272db=a34_0x200ad9,{queueId:_0x8996c7}=_0x57d0f7[_0x5272db(0x136)],{companyId:_0x1a6632}=_0x57d0f7[_0x5272db(0x130)];try{const _0xaf92b3=await Queue_1[_0x5272db(0x162)][_0x5272db(0x144)](_0x8996c7);return _0xaf92b3[_0x5272db(0x12f)]&&await StorageService_1[_0x5272db(0x162)][_0x5272db(0x12c)](_0x1a6632,_0xaf92b3[_0x5272db(0x12f)]),_0xaf92b3['mediaPath']=null,_0xaf92b3[_0x5272db(0x12a)]=null,await _0xaf92b3[_0x5272db(0x12e)](),_0x21a306['send']({'mensagem':_0x5272db(0x13e)});}catch(_0x132563){throw new AppError_1['default'](_0x132563[_0x5272db(0x14c)]);}};exports[a34_0x200ad9(0x131)]=deleteMedia;