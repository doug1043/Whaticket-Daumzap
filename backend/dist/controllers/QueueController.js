const a34_0x1c3088=a34_0x4dab;(function(_0x5e93ae,_0x175c77){const _0x525b57=a34_0x4dab,_0x485be9=_0x5e93ae();while(!![]){try{const _0x4130f8=parseInt(_0x525b57(0x160))/0x1*(parseInt(_0x525b57(0x14d))/0x2)+-parseInt(_0x525b57(0x15a))/0x3+-parseInt(_0x525b57(0x150))/0x4+-parseInt(_0x525b57(0x159))/0x5*(-parseInt(_0x525b57(0x16a))/0x6)+-parseInt(_0x525b57(0x149))/0x7+parseInt(_0x525b57(0x163))/0x8*(-parseInt(_0x525b57(0x14c))/0x9)+parseInt(_0x525b57(0x155))/0xa;if(_0x4130f8===_0x175c77)break;else _0x485be9['push'](_0x485be9['shift']());}catch(_0x16dc59){_0x485be9['push'](_0x485be9['shift']());}}}(a34_0x35ca,0x75171));const a34_0x190572=(function(){let _0xb662d3=!![];return function(_0x4b50ac,_0x553e2f){const _0x17505c=_0xb662d3?function(){const _0x808806=a34_0x4dab;if(_0x553e2f){const _0x9e223d=_0x553e2f[_0x808806(0x168)](_0x4b50ac,arguments);return _0x553e2f=null,_0x9e223d;}}:function(){};return _0xb662d3=![],_0x17505c;};}()),a34_0x58ea50=a34_0x190572(this,function(){const _0x506f1a=a34_0x4dab;return a34_0x58ea50['toString']()[_0x506f1a(0x137)]('(((.+)+)+)+$')['toString']()[_0x506f1a(0x141)](a34_0x58ea50)[_0x506f1a(0x137)](_0x506f1a(0x14b));});function a34_0x35ca(){const _0x5ea14d=['status','store','../services/StorageService/StorageService','18991020DDmPnH','params','mediaName','Arquivo\x20excluÃ­do','2490245ufZhFh','2210454eatlRr','body','flowBuilderId','../errors/AppError','../libs/socket','Arquivo\x20Salvo','1CJOHYs','query','__importDefault','789784zAWSFE','isNil','../services/QueueService/DeleteQueueService','integrationId','uploadFile','apply','default','6TrQPov','save','deleteMedia','message','../models/Queue','findByPk','json','search','../services/QueueService/UpdateQueueService','send','index','-queue','mimetype','show','emit','defineProperty','head','constructor','update','mediaUpload','__esModule','deleteFile','lodash','getIO','filas','436275IkRPjh','path','(((.+)+)+)+$','63OvSXlh','174372mYPbLK','company-','mediaPath','2058128GANJxf','user'];a34_0x35ca=function(){return _0x5ea14d;};return a34_0x35ca();}a34_0x58ea50();'use strict';var __importDefault=this&&this[a34_0x1c3088(0x162)]||function(_0x5bbf36){const _0x3a2fbc=a34_0x1c3088;return _0x5bbf36&&_0x5bbf36[_0x3a2fbc(0x144)]?_0x5bbf36:{'default':_0x5bbf36};};function a34_0x4dab(_0x7dfa2a,_0xb6372e){const _0x34b150=a34_0x35ca();return a34_0x4dab=function(_0x58ea50,_0x190572){_0x58ea50=_0x58ea50-0x132;let _0x35ca27=_0x34b150[_0x58ea50];return _0x35ca27;},a34_0x4dab(_0x7dfa2a,_0xb6372e);}Object[a34_0x1c3088(0x13f)](exports,a34_0x1c3088(0x144),{'value':!![]}),exports[a34_0x1c3088(0x132)]=exports[a34_0x1c3088(0x143)]=exports['remove']=exports[a34_0x1c3088(0x142)]=exports[a34_0x1c3088(0x13d)]=exports[a34_0x1c3088(0x153)]=exports[a34_0x1c3088(0x13a)]=void 0x0;const socket_1=require(a34_0x1c3088(0x15e)),CreateQueueService_1=__importDefault(require('../services/QueueService/CreateQueueService')),DeleteQueueService_1=__importDefault(require(a34_0x1c3088(0x165))),ListQueuesService_1=__importDefault(require('../services/QueueService/ListQueuesService')),ShowQueueService_1=__importDefault(require('../services/QueueService/ShowQueueService')),UpdateQueueService_1=__importDefault(require(a34_0x1c3088(0x138))),lodash_1=require(a34_0x1c3088(0x146)),Queue_1=__importDefault(require(a34_0x1c3088(0x134))),lodash_2=require(a34_0x1c3088(0x146)),AppError_1=__importDefault(require(a34_0x1c3088(0x15d))),StorageService_1=__importDefault(require(a34_0x1c3088(0x154))),index=async(_0x365746,_0x146059)=>{const _0x20940d=a34_0x1c3088,{companyId:_0x3fb857}=_0x365746[_0x20940d(0x151)],{companyId:_0x5a39ac}=_0x365746[_0x20940d(0x161)];let _0x5115c9=_0x3fb857;!(0x0,lodash_1[_0x20940d(0x164)])(_0x5a39ac)&&(_0x5115c9=+_0x5a39ac);const _0x346c78=await(0x0,ListQueuesService_1[_0x20940d(0x169)])({'companyId':_0x5115c9});return _0x146059[_0x20940d(0x152)](0xc8)[_0x20940d(0x136)](_0x346c78);};exports[a34_0x1c3088(0x13a)]=index;const store=async(_0x25f554,_0x518fcb)=>{const _0x16eebd=a34_0x1c3088,{name:_0x17ca75,color:_0x553687,greetingMessage:_0x46318e,outOfHoursMessage:_0x41909e,orderQueue:_0x3bc210,integrationId:_0x51cf25,flowBuilderId:_0x3bbe01}=_0x25f554[_0x16eebd(0x15b)],{companyId:_0x2491f3}=_0x25f554[_0x16eebd(0x151)],_0x5cf6d2=await(0x0,CreateQueueService_1[_0x16eebd(0x169)])({'name':_0x17ca75,'color':_0x553687,'greetingMessage':_0x46318e,'companyId':_0x2491f3,'outOfHoursMessage':_0x41909e,'orderQueue':_0x3bc210,'integrationId':_0x51cf25&&_0x51cf25!==''?_0x51cf25:null,'flowBuilderId':_0x3bbe01&&_0x3bbe01!==''?_0x3bbe01:null}),_0x116314=(0x0,socket_1[_0x16eebd(0x147)])();return _0x116314[_0x16eebd(0x13e)](_0x16eebd(0x14e)+_0x2491f3+_0x16eebd(0x13b),{'action':_0x16eebd(0x142),'queue':_0x5cf6d2}),_0x518fcb['status'](0xc8)[_0x16eebd(0x136)](_0x5cf6d2);};exports['store']=store;const show=async(_0x964595,_0x922981)=>{const _0x3733d9=a34_0x1c3088,{queueId:_0x30542b}=_0x964595['params'],{companyId:_0x6b8d6}=_0x964595[_0x3733d9(0x151)],_0x1fba4d=await(0x0,ShowQueueService_1[_0x3733d9(0x169)])(_0x30542b,_0x6b8d6);return _0x922981['status'](0xc8)[_0x3733d9(0x136)](_0x1fba4d);};exports[a34_0x1c3088(0x13d)]=show;const update=async(_0xf6820c,_0x50737e)=>{const _0x2d9e1b=a34_0x1c3088,{queueId:_0x469036}=_0xf6820c['params'],{companyId:_0x13cae9}=_0xf6820c['user'],_0x39161b={..._0xf6820c['body'],'integrationId':_0xf6820c['body'][_0x2d9e1b(0x166)]&&_0xf6820c[_0x2d9e1b(0x15b)][_0x2d9e1b(0x166)]!==''?_0xf6820c[_0x2d9e1b(0x15b)]['integrationId']:null,'flowBuilderId':_0xf6820c['body'][_0x2d9e1b(0x15c)]&&_0xf6820c['body'][_0x2d9e1b(0x15c)]!==''?_0xf6820c[_0x2d9e1b(0x15b)]['flowBuilderId']:null},_0x41094c=await(0x0,UpdateQueueService_1[_0x2d9e1b(0x169)])(_0x469036,_0x39161b,_0x13cae9),_0x3f4767=(0x0,socket_1[_0x2d9e1b(0x147)])();return _0x3f4767[_0x2d9e1b(0x13e)](_0x2d9e1b(0x14e)+_0x13cae9+_0x2d9e1b(0x13b),{'action':_0x2d9e1b(0x142),'queue':_0x41094c}),_0x50737e['status'](0xc9)[_0x2d9e1b(0x136)](_0x41094c);};exports['update']=update;const remove=async(_0xeb4827,_0x35bf84)=>{const _0x302d5f=a34_0x1c3088,{queueId:_0x19ee36}=_0xeb4827[_0x302d5f(0x156)],{companyId:_0x356eb1}=_0xeb4827[_0x302d5f(0x151)];await(0x0,DeleteQueueService_1[_0x302d5f(0x169)])(_0x19ee36,_0x356eb1);const _0x418986=(0x0,socket_1[_0x302d5f(0x147)])();return _0x418986[_0x302d5f(0x13e)](_0x302d5f(0x14e)+_0x356eb1+_0x302d5f(0x13b),{'action':'delete','queueId':+_0x19ee36}),_0x35bf84[_0x302d5f(0x152)](0xc8)[_0x302d5f(0x139)]();};exports['remove']=remove;const mediaUpload=async(_0x2f80b2,_0xd499f3)=>{const _0x544d8a=a34_0x1c3088,{queueId:_0x5e3347}=_0x2f80b2[_0x544d8a(0x156)],_0x581e86=_0x2f80b2['files'],_0x18a023=(0x0,lodash_2[_0x544d8a(0x140)])(_0x581e86);try{const _0x4c53ce=await Queue_1[_0x544d8a(0x169)]['findByPk'](_0x5e3347),{companyId:_0x561a2c}=_0x2f80b2['user'],{url:_0x4c84d3}=await StorageService_1['default'][_0x544d8a(0x167)](_0x561a2c,_0x544d8a(0x148),_0x18a023['filename'],_0x18a023[_0x544d8a(0x14a)],_0x18a023[_0x544d8a(0x13c)]);return _0x4c53ce[_0x544d8a(0x142)]({'mediaPath':_0x4c84d3,'mediaName':_0x18a023['originalname']}),_0xd499f3[_0x544d8a(0x139)]({'mensagem':_0x544d8a(0x15f)});}catch(_0x1b7047){throw new AppError_1[(_0x544d8a(0x169))](_0x1b7047[_0x544d8a(0x133)]);}};exports[a34_0x1c3088(0x143)]=mediaUpload;const deleteMedia=async(_0x565b73,_0x3e37fa)=>{const _0x169e55=a34_0x1c3088,{queueId:_0x1cdf52}=_0x565b73[_0x169e55(0x156)],{companyId:_0x2ca3ee}=_0x565b73[_0x169e55(0x151)];try{const _0x334e35=await Queue_1[_0x169e55(0x169)][_0x169e55(0x135)](_0x1cdf52);return _0x334e35[_0x169e55(0x14f)]&&await StorageService_1[_0x169e55(0x169)][_0x169e55(0x145)](_0x2ca3ee,_0x334e35[_0x169e55(0x14f)]),_0x334e35['mediaPath']=null,_0x334e35[_0x169e55(0x157)]=null,await _0x334e35[_0x169e55(0x16b)](),_0x3e37fa[_0x169e55(0x139)]({'mensagem':_0x169e55(0x158)});}catch(_0x4868fd){throw new AppError_1[(_0x169e55(0x169))](_0x4868fd[_0x169e55(0x133)]);}};exports[a34_0x1c3088(0x132)]=deleteMedia;