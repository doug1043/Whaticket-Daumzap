const a28_0x2297bc=a28_0x320c;function a28_0x5a5c(){const _0x326f2d=['getIO','../services/QueueService/CreateQueueService','path','../models/Queue','defineProperty','apply','update','json','status','mediaPath','toString','../libs/socket','files','remove','body','send','lodash','findByPk','show','unlinkSync','-queue','13533650RKxMVG','543774wOmbIm','store','33232HgIWYA','Arquivo\x20excluÃ­do','resolve','-mainchannel','489805IEztsd','__importDefault','617oebbol','emit','query','1774TmHLgw','message','6eOjTkn','index','1467lLSToL','1836700aERowE','Arquivo\x20Salvo','deleteMedia','605640TuHTQo','__esModule','head','search','mediaUpload','default','company','user','11OkpKhD','public','company-','../services/QueueService/UpdateQueueService','(((.+)+)+)+$','companyId','constructor','params'];a28_0x5a5c=function(){return _0x326f2d;};return a28_0x5a5c();}(function(_0x13a8ae,_0x186582){const _0x374cc1=a28_0x320c,_0x396533=_0x13a8ae();while(!![]){try{const _0x159108=-parseInt(_0x374cc1(0x17f))/0x1*(parseInt(_0x374cc1(0x182))/0x2)+parseInt(_0x374cc1(0x18a))/0x3+parseInt(_0x374cc1(0x187))/0x4+parseInt(_0x374cc1(0x17d))/0x5*(-parseInt(_0x374cc1(0x184))/0x6)+-parseInt(_0x374cc1(0x177))/0x7+parseInt(_0x374cc1(0x179))/0x8*(-parseInt(_0x374cc1(0x186))/0x9)+parseInt(_0x374cc1(0x176))/0xa*(parseInt(_0x374cc1(0x192))/0xb);if(_0x159108===_0x186582)break;else _0x396533['push'](_0x396533['shift']());}catch(_0x4fabb0){_0x396533['push'](_0x396533['shift']());}}}(a28_0x5a5c,0x95ffc));const a28_0x5a1b1a=(function(){let _0x512f21=!![];return function(_0xe5dea0,_0x2273e2){const _0x4ef658=_0x512f21?function(){const _0x2e8b5e=a28_0x320c;if(_0x2273e2){const _0x1f22ff=_0x2273e2[_0x2e8b5e(0x166)](_0xe5dea0,arguments);return _0x2273e2=null,_0x1f22ff;}}:function(){};return _0x512f21=![],_0x4ef658;};}()),a28_0x49384c=a28_0x5a1b1a(this,function(){const _0x1d154e=a28_0x320c;return a28_0x49384c[_0x1d154e(0x16b)]()['search'](_0x1d154e(0x196))['toString']()[_0x1d154e(0x198)](a28_0x49384c)[_0x1d154e(0x18d)](_0x1d154e(0x196));});a28_0x49384c();'use strict';var __importDefault=this&&this[a28_0x2297bc(0x17e)]||function(_0x233ab8){const _0x20172f=a28_0x2297bc;return _0x233ab8&&_0x233ab8[_0x20172f(0x18b)]?_0x233ab8:{'default':_0x233ab8};};Object[a28_0x2297bc(0x165)](exports,a28_0x2297bc(0x18b),{'value':!![]}),exports[a28_0x2297bc(0x189)]=exports[a28_0x2297bc(0x18e)]=exports[a28_0x2297bc(0x16e)]=exports[a28_0x2297bc(0x167)]=exports[a28_0x2297bc(0x173)]=exports[a28_0x2297bc(0x178)]=exports['index']=void 0x0;const socket_1=require(a28_0x2297bc(0x16c)),CreateQueueService_1=__importDefault(require(a28_0x2297bc(0x19b))),DeleteQueueService_1=__importDefault(require('../services/QueueService/DeleteQueueService')),ListQueuesService_1=__importDefault(require('../services/QueueService/ListQueuesService')),ShowQueueService_1=__importDefault(require('../services/QueueService/ShowQueueService')),UpdateQueueService_1=__importDefault(require(a28_0x2297bc(0x195))),lodash_1=require('lodash'),Queue_1=__importDefault(require(a28_0x2297bc(0x19d))),lodash_2=require(a28_0x2297bc(0x171)),fs_1=__importDefault(require('fs')),path_1=__importDefault(require(a28_0x2297bc(0x19c))),AppError_1=__importDefault(require('../errors/AppError')),index=async(_0x4d10f3,_0x25920d)=>{const _0x3d934e=a28_0x2297bc,{companyId:_0x7966ae}=_0x4d10f3['user'],{companyId:_0x42061f}=_0x4d10f3[_0x3d934e(0x181)];let _0x4689a0=_0x7966ae;!(0x0,lodash_1['isNil'])(_0x42061f)&&(_0x4689a0=+_0x42061f);const _0x17b26=await(0x0,ListQueuesService_1[_0x3d934e(0x18f)])({'companyId':_0x4689a0});return _0x25920d[_0x3d934e(0x169)](0xc8)[_0x3d934e(0x168)](_0x17b26);};exports[a28_0x2297bc(0x185)]=index;const store=async(_0x19d5fd,_0x8b496c)=>{const _0xb998d2=a28_0x2297bc,{name:_0x1c35ac,color:_0x5465a5,greetingMessage:_0x54c3a2,outOfHoursMessage:_0x3da4f7,keywords:_0xf78eab,schedules:_0x509b01,orderQueue:_0xf3fa8b,integrationId:_0x8e4b3c}=_0x19d5fd['body'],{companyId:_0x1acc62}=_0x19d5fd[_0xb998d2(0x191)],_0x2118e3=await(0x0,CreateQueueService_1[_0xb998d2(0x18f)])({'name':_0x1c35ac,'color':_0x5465a5,'greetingMessage':_0x54c3a2,'companyId':_0x1acc62,'outOfHoursMessage':_0x3da4f7,'keywords':_0xf78eab,'schedules':_0x509b01,'orderQueue':_0xf3fa8b===''?null:_0xf3fa8b,'integrationId':_0x8e4b3c===''?null:_0x8e4b3c}),_0x35ca0e=(0x0,socket_1[_0xb998d2(0x19a)])();return _0x35ca0e['to'](_0xb998d2(0x194)+_0x1acc62+_0xb998d2(0x17c))[_0xb998d2(0x180)](_0xb998d2(0x194)+_0x1acc62+_0xb998d2(0x175),{'action':_0xb998d2(0x167),'queue':_0x2118e3}),_0x8b496c[_0xb998d2(0x169)](0xc8)[_0xb998d2(0x168)](_0x2118e3);};function a28_0x320c(_0x5bd6d9,_0x466d17){const _0x18cde0=a28_0x5a5c();return a28_0x320c=function(_0x49384c,_0x5a1b1a){_0x49384c=_0x49384c-0x165;let _0x5a5cdf=_0x18cde0[_0x49384c];return _0x5a5cdf;},a28_0x320c(_0x5bd6d9,_0x466d17);}exports['store']=store;const show=async(_0xe7fac5,_0x1366bf)=>{const _0x28e841=a28_0x2297bc,{queueId:_0x5d8bff}=_0xe7fac5['params'],{companyId:_0x5bdfcf}=_0xe7fac5[_0x28e841(0x191)],_0x53528f=await(0x0,ShowQueueService_1[_0x28e841(0x18f)])(_0x5d8bff,_0x5bdfcf);return _0x1366bf[_0x28e841(0x169)](0xc8)['json'](_0x53528f);};exports[a28_0x2297bc(0x173)]=show;const update=async(_0x372421,_0x4736a2)=>{const _0x17e04f=a28_0x2297bc,{queueId:_0x56c563}=_0x372421[_0x17e04f(0x199)],{companyId:_0xf5691a}=_0x372421['user'],{name:_0x4b3a23,color:_0x32b9e2,greetingMessage:_0x1e6896,outOfHoursMessage:_0x4881a9,keywords:_0x60bf6f,newTicketOnTransfer:_0x241ae3,schedules:_0x109d5f,orderQueue:_0x17df13,integrationId:_0x5871de}=_0x372421[_0x17e04f(0x16f)],_0x34317e=await(0x0,UpdateQueueService_1[_0x17e04f(0x18f)])(_0x56c563,{'name':_0x4b3a23,'color':_0x32b9e2,'greetingMessage':_0x1e6896,'outOfHoursMessage':_0x4881a9,'keywords':_0x60bf6f,'newTicketOnTransfer':_0x241ae3,'schedules':_0x109d5f,'orderQueue':_0x17df13===''?null:_0x17df13,'integrationId':_0x5871de===''?null:_0x5871de},_0xf5691a),_0x300e92=(0x0,socket_1[_0x17e04f(0x19a)])();return _0x300e92['to'](_0x17e04f(0x194)+_0xf5691a+_0x17e04f(0x17c))[_0x17e04f(0x180)](_0x17e04f(0x194)+_0xf5691a+_0x17e04f(0x175),{'action':_0x17e04f(0x167),'queue':_0x34317e}),_0x4736a2[_0x17e04f(0x169)](0xc9)[_0x17e04f(0x168)](_0x34317e);};exports[a28_0x2297bc(0x167)]=update;const remove=async(_0x5133a5,_0x1a045b)=>{const _0xeb8539=a28_0x2297bc,{queueId:_0x297d1e}=_0x5133a5[_0xeb8539(0x199)],{companyId:_0x4c733d}=_0x5133a5[_0xeb8539(0x191)];await(0x0,DeleteQueueService_1[_0xeb8539(0x18f)])(_0x297d1e,_0x4c733d);const _0x47a17c=(0x0,socket_1[_0xeb8539(0x19a)])();return _0x47a17c['to'](_0xeb8539(0x194)+_0x4c733d+_0xeb8539(0x17c))[_0xeb8539(0x180)](_0xeb8539(0x194)+_0x4c733d+_0xeb8539(0x175),{'action':'delete','queueId':+_0x297d1e}),_0x1a045b[_0xeb8539(0x169)](0xc8)[_0xeb8539(0x170)]();};exports['remove']=remove;const mediaUpload=async(_0x472589,_0x4fc808)=>{const _0x23f573=a28_0x2297bc,{queueId:_0x2e92c5}=_0x472589[_0x23f573(0x199)],_0x2919a1=_0x472589[_0x23f573(0x16d)],_0x4592d4=(0x0,lodash_2[_0x23f573(0x18c)])(_0x2919a1);try{const _0x3f523a=await Queue_1[_0x23f573(0x18f)][_0x23f573(0x172)](_0x2e92c5);return _0x3f523a[_0x23f573(0x167)]({'mediaPath':_0x4592d4['filename'],'mediaName':_0x4592d4['originalname']}),_0x4fc808[_0x23f573(0x170)]({'mensagem':_0x23f573(0x188)});}catch(_0x5c1d9a){throw new AppError_1[(_0x23f573(0x18f))](_0x5c1d9a['message']);}};exports['mediaUpload']=mediaUpload;const deleteMedia=async(_0x327982,_0x54a475)=>{const _0x36a70a=a28_0x2297bc,{queueId:_0x42efed}=_0x327982[_0x36a70a(0x199)];try{const _0x305c8b=await Queue_1['default']['findByPk'](_0x42efed),_0x1803db=path_1[_0x36a70a(0x18f)][_0x36a70a(0x17b)](_0x36a70a(0x193),_0x36a70a(0x190)+_0x305c8b[_0x36a70a(0x197)],_0x305c8b[_0x36a70a(0x16a)]),_0x450548=fs_1[_0x36a70a(0x18f)]['existsSync'](_0x1803db);return _0x450548&&fs_1[_0x36a70a(0x18f)][_0x36a70a(0x174)](_0x1803db),_0x305c8b[_0x36a70a(0x16a)]=null,_0x305c8b['mediaName']=null,await _0x305c8b['save'](),_0x54a475[_0x36a70a(0x170)]({'mensagem':_0x36a70a(0x17a)});}catch(_0x2b1338){throw new AppError_1['default'](_0x2b1338[_0x36a70a(0x183)]);}};exports[a28_0x2297bc(0x189)]=deleteMedia;