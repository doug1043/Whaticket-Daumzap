const a29_0x1d2c4d=a29_0x49ed;(function(_0x24d2b7,_0x51a831){const _0x126015=a29_0x49ed,_0x4d49bd=_0x24d2b7();while(!![]){try{const _0x3cc948=parseInt(_0x126015(0x1e0))/0x1*(-parseInt(_0x126015(0x1aa))/0x2)+parseInt(_0x126015(0x1c9))/0x3+parseInt(_0x126015(0x1c0))/0x4+-parseInt(_0x126015(0x1db))/0x5+parseInt(_0x126015(0x1b8))/0x6*(parseInt(_0x126015(0x1b4))/0x7)+parseInt(_0x126015(0x1d7))/0x8+-parseInt(_0x126015(0x1b7))/0x9;if(_0x3cc948===_0x51a831)break;else _0x4d49bd['push'](_0x4d49bd['shift']());}catch(_0x55f3a7){_0x4d49bd['push'](_0x4d49bd['shift']());}}}(a29_0x20bb,0x7c0ee));const a29_0x1e6627=(function(){let _0x3cdfe9=!![];return function(_0x49c71b,_0x58e19c){const _0x5a8b73=_0x3cdfe9?function(){const _0x2d124f=a29_0x49ed;if(_0x58e19c){const _0x20e917=_0x58e19c[_0x2d124f(0x1d5)](_0x49c71b,arguments);return _0x58e19c=null,_0x20e917;}}:function(){};return _0x3cdfe9=![],_0x5a8b73;};}()),a29_0x430275=a29_0x1e6627(this,function(){const _0x5a3c3f=a29_0x49ed;return a29_0x430275[_0x5a3c3f(0x1c4)]()[_0x5a3c3f(0x1dc)](_0x5a3c3f(0x1b9))[_0x5a3c3f(0x1c4)]()[_0x5a3c3f(0x1ac)](a29_0x430275)[_0x5a3c3f(0x1dc)](_0x5a3c3f(0x1b9));});a29_0x430275();'use strict';function a29_0x20bb(){const _0x2dad1f=['apply','head','7865896TxLQbV','../services/QueueService/CreateQueueService','../errors/AppError','mediaName','635735OYtCJF','search','emit','-queue','mediaUpload','61wvFBsu','files','getIO','findByPk','226pzmbDT','originalname','constructor','user','update','companyId','save','delete','default','../models/Queue','21tWlRjY','company-','-mainchannel','16792110RdKFQJ','1906518cmbmDc','(((.+)+)+)+$','params','remove','Arquivo\x20excluÃ­do','__esModule','path','message','920500hnuvJx','mediaPath','send','query','toString','json','body','../services/QueueService/UpdateQueueService','isNil','1024053rDcRxK','../services/QueueService/ShowQueueService','__importDefault','index','show','../services/QueueService/ListQueuesService','public','status','resolve','deleteMedia','../libs/socket','defineProperty'];a29_0x20bb=function(){return _0x2dad1f;};return a29_0x20bb();}var __importDefault=this&&this[a29_0x1d2c4d(0x1cb)]||function(_0x148fa1){const _0x594b68=a29_0x1d2c4d;return _0x148fa1&&_0x148fa1[_0x594b68(0x1bd)]?_0x148fa1:{'default':_0x148fa1};};Object[a29_0x1d2c4d(0x1d4)](exports,a29_0x1d2c4d(0x1bd),{'value':!![]}),exports[a29_0x1d2c4d(0x1d2)]=exports[a29_0x1d2c4d(0x1df)]=exports['remove']=exports[a29_0x1d2c4d(0x1ae)]=exports[a29_0x1d2c4d(0x1cd)]=exports['store']=exports[a29_0x1d2c4d(0x1cc)]=void 0x0;const socket_1=require(a29_0x1d2c4d(0x1d3)),CreateQueueService_1=__importDefault(require(a29_0x1d2c4d(0x1d8))),DeleteQueueService_1=__importDefault(require('../services/QueueService/DeleteQueueService')),ListQueuesService_1=__importDefault(require(a29_0x1d2c4d(0x1ce))),ShowQueueService_1=__importDefault(require(a29_0x1d2c4d(0x1ca))),UpdateQueueService_1=__importDefault(require(a29_0x1d2c4d(0x1c7))),lodash_1=require('lodash'),Queue_1=__importDefault(require(a29_0x1d2c4d(0x1b3))),lodash_2=require('lodash'),fs_1=__importDefault(require('fs')),path_1=__importDefault(require(a29_0x1d2c4d(0x1be))),AppError_1=__importDefault(require(a29_0x1d2c4d(0x1d9))),index=async(_0x2de7e0,_0xd39d88)=>{const _0x326587=a29_0x1d2c4d,{companyId:_0x536096}=_0x2de7e0['user'],{companyId:_0x55cd87}=_0x2de7e0[_0x326587(0x1c3)];let _0xead62f=_0x536096;!(0x0,lodash_1[_0x326587(0x1c8)])(_0x55cd87)&&(_0xead62f=+_0x55cd87);const _0x222736=await(0x0,ListQueuesService_1[_0x326587(0x1b2)])({'companyId':_0xead62f});return _0xd39d88[_0x326587(0x1d0)](0xc8)[_0x326587(0x1c5)](_0x222736);};exports[a29_0x1d2c4d(0x1cc)]=index;const store=async(_0x53c88d,_0x54755d)=>{const _0x1f6953=a29_0x1d2c4d,{name:_0x173e32,color:_0x49007d,greetingMessage:_0x5c4f85,outOfHoursMessage:_0xb04d0,keywords:_0x3956c5,schedules:_0x24b95e,orderQueue:_0xf74868,integrationId:_0x5def46,promptId:_0x4fe0b4}=_0x53c88d[_0x1f6953(0x1c6)],{companyId:_0x6de802}=_0x53c88d[_0x1f6953(0x1ad)],_0x3091d9=await(0x0,CreateQueueService_1['default'])({'name':_0x173e32,'color':_0x49007d,'greetingMessage':_0x5c4f85,'companyId':_0x6de802,'outOfHoursMessage':_0xb04d0,'keywords':_0x3956c5,'schedules':_0x24b95e,'orderQueue':_0xf74868===''?null:_0xf74868,'integrationId':_0x5def46===''?null:_0x5def46,'promptId':_0x4fe0b4===''?null:_0x4fe0b4}),_0x45b2ac=(0x0,socket_1[_0x1f6953(0x1a8)])();return _0x45b2ac['to']('company-'+_0x6de802+_0x1f6953(0x1b6))[_0x1f6953(0x1dd)]('company-'+_0x6de802+_0x1f6953(0x1de),{'action':'update','queue':_0x3091d9}),_0x54755d[_0x1f6953(0x1d0)](0xc8)[_0x1f6953(0x1c5)](_0x3091d9);};exports['store']=store;const show=async(_0x27f110,_0x5bcd08)=>{const _0x165992=a29_0x1d2c4d,{queueId:_0x55b477}=_0x27f110[_0x165992(0x1ba)],{companyId:_0x108675}=_0x27f110['user'],_0x4ff003=await(0x0,ShowQueueService_1['default'])(_0x55b477,_0x108675);return _0x5bcd08[_0x165992(0x1d0)](0xc8)[_0x165992(0x1c5)](_0x4ff003);};exports[a29_0x1d2c4d(0x1cd)]=show;function a29_0x49ed(_0x4a8140,_0x9e683e){const _0x4d35a0=a29_0x20bb();return a29_0x49ed=function(_0x430275,_0x1e6627){_0x430275=_0x430275-0x1a7;let _0x20bba8=_0x4d35a0[_0x430275];return _0x20bba8;},a29_0x49ed(_0x4a8140,_0x9e683e);}const update=async(_0xc034bc,_0x4acf12)=>{const _0x9c992e=a29_0x1d2c4d,{queueId:_0x3f0de4}=_0xc034bc[_0x9c992e(0x1ba)],{companyId:_0x1b7e3f}=_0xc034bc[_0x9c992e(0x1ad)],{name:_0x2b240d,color:_0x31e0c4,greetingMessage:_0x205de9,outOfHoursMessage:_0x47c9e3,keywords:_0x1d80e4,newTicketOnTransfer:_0x28e750,schedules:_0x4ad334,orderQueue:_0x5a5125,integrationId:_0x25d57,promptId:_0xa22bac}=_0xc034bc['body'],_0x2f4dbf=await(0x0,UpdateQueueService_1[_0x9c992e(0x1b2)])(_0x3f0de4,{'name':_0x2b240d,'color':_0x31e0c4,'greetingMessage':_0x205de9,'outOfHoursMessage':_0x47c9e3,'keywords':_0x1d80e4,'newTicketOnTransfer':_0x28e750,'schedules':_0x4ad334,'orderQueue':_0x5a5125===''?null:_0x5a5125,'integrationId':_0x25d57===''?null:_0x25d57,'promptId':_0xa22bac===''?null:_0xa22bac},_0x1b7e3f),_0x2a432b=(0x0,socket_1[_0x9c992e(0x1a8)])();return _0x2a432b['to'](_0x9c992e(0x1b5)+_0x1b7e3f+_0x9c992e(0x1b6))['emit'](_0x9c992e(0x1b5)+_0x1b7e3f+_0x9c992e(0x1de),{'action':_0x9c992e(0x1ae),'queue':_0x2f4dbf}),_0x4acf12[_0x9c992e(0x1d0)](0xc9)[_0x9c992e(0x1c5)](_0x2f4dbf);};exports[a29_0x1d2c4d(0x1ae)]=update;const remove=async(_0x229a3c,_0x210956)=>{const _0xbe1440=a29_0x1d2c4d,{queueId:_0x7345c8}=_0x229a3c[_0xbe1440(0x1ba)],{companyId:_0x3c9591}=_0x229a3c[_0xbe1440(0x1ad)];await(0x0,DeleteQueueService_1['default'])(_0x7345c8,_0x3c9591);const _0x4bd5d4=(0x0,socket_1[_0xbe1440(0x1a8)])();return _0x4bd5d4['to'](_0xbe1440(0x1b5)+_0x3c9591+_0xbe1440(0x1b6))[_0xbe1440(0x1dd)](_0xbe1440(0x1b5)+_0x3c9591+_0xbe1440(0x1de),{'action':_0xbe1440(0x1b1),'queueId':+_0x7345c8}),_0x210956[_0xbe1440(0x1d0)](0xc8)[_0xbe1440(0x1c2)]();};exports[a29_0x1d2c4d(0x1bb)]=remove;const mediaUpload=async(_0x253ec8,_0x215844)=>{const _0xf3b89c=a29_0x1d2c4d,{queueId:_0x56ab52}=_0x253ec8[_0xf3b89c(0x1ba)],_0x12495c=_0x253ec8[_0xf3b89c(0x1a7)],_0x172f36=(0x0,lodash_2[_0xf3b89c(0x1d6)])(_0x12495c);try{const _0x231d5f=await Queue_1[_0xf3b89c(0x1b2)][_0xf3b89c(0x1a9)](_0x56ab52);return _0x231d5f[_0xf3b89c(0x1ae)]({'mediaPath':_0x172f36['filename'],'mediaName':_0x172f36[_0xf3b89c(0x1ab)]}),_0x215844[_0xf3b89c(0x1c2)]({'mensagem':'Arquivo\x20Salvo'});}catch(_0x5eedf8){throw new AppError_1[(_0xf3b89c(0x1b2))](_0x5eedf8[_0xf3b89c(0x1bf)]);}};exports['mediaUpload']=mediaUpload;const deleteMedia=async(_0x1909e0,_0x3bee92)=>{const _0xedae8c=a29_0x1d2c4d,{queueId:_0x44fb88}=_0x1909e0[_0xedae8c(0x1ba)];try{const _0x4facbc=await Queue_1[_0xedae8c(0x1b2)][_0xedae8c(0x1a9)](_0x44fb88),_0x48903b=path_1['default'][_0xedae8c(0x1d1)](_0xedae8c(0x1cf),'company'+_0x4facbc[_0xedae8c(0x1af)],_0x4facbc[_0xedae8c(0x1c1)]),_0x3d9c40=fs_1[_0xedae8c(0x1b2)]['existsSync'](_0x48903b);return _0x3d9c40&&fs_1[_0xedae8c(0x1b2)]['unlinkSync'](_0x48903b),_0x4facbc[_0xedae8c(0x1c1)]=null,_0x4facbc[_0xedae8c(0x1da)]=null,await _0x4facbc[_0xedae8c(0x1b0)](),_0x3bee92[_0xedae8c(0x1c2)]({'mensagem':_0xedae8c(0x1bc)});}catch(_0x2cb7ee){throw new AppError_1['default'](_0x2cb7ee[_0xedae8c(0x1bf)]);}};exports['deleteMedia']=deleteMedia;