const a34_0x4443ad=a34_0xb36e;(function(_0x4cdba5,_0x3f1afb){const _0x11a845=a34_0xb36e,_0x2bd239=_0x4cdba5();while(!![]){try{const _0x183175=-parseInt(_0x11a845(0xe4))/0x1+-parseInt(_0x11a845(0xed))/0x2+parseInt(_0x11a845(0xf4))/0x3+parseInt(_0x11a845(0xdb))/0x4+parseInt(_0x11a845(0xd3))/0x5+-parseInt(_0x11a845(0xf2))/0x6+parseInt(_0x11a845(0xd9))/0x7;if(_0x183175===_0x3f1afb)break;else _0x2bd239['push'](_0x2bd239['shift']());}catch(_0x4ed054){_0x2bd239['push'](_0x2bd239['shift']());}}}(a34_0x6a6f,0xcd6fa));const a34_0x1e68c5=(function(){let _0x3fcee3=!![];return function(_0x1d7ed9,_0x520eb3){const _0x49a75f=_0x3fcee3?function(){const _0xfeba70=a34_0xb36e;if(_0x520eb3){const _0x4558b6=_0x520eb3[_0xfeba70(0xe7)](_0x1d7ed9,arguments);return _0x520eb3=null,_0x4558b6;}}:function(){};return _0x3fcee3=![],_0x49a75f;};}()),a34_0x50da84=a34_0x1e68c5(this,function(){const _0xc13c57=a34_0xb36e;return a34_0x50da84[_0xc13c57(0xf7)]()['search']('(((.+)+)+)+$')[_0xc13c57(0xf7)]()[_0xc13c57(0xef)](a34_0x50da84)[_0xc13c57(0xe3)](_0xc13c57(0xc8));});a34_0x50da84();'use strict';var __importDefault=this&&this[a34_0x4443ad(0xe8)]||function(_0x3ba00d){const _0x56ee57=a34_0x4443ad;return _0x3ba00d&&_0x3ba00d[_0x56ee57(0xea)]?_0x3ba00d:{'default':_0x3ba00d};};Object[a34_0x4443ad(0xec)](exports,a34_0x4443ad(0xea),{'value':!![]}),exports[a34_0x4443ad(0xfd)]=exports['mediaUpload']=exports[a34_0x4443ad(0xeb)]=exports[a34_0x4443ad(0xe2)]=exports[a34_0x4443ad(0xd5)]=exports[a34_0x4443ad(0xfa)]=exports[a34_0x4443ad(0xf1)]=void 0x0;function a34_0xb36e(_0x51f85f,_0x4d4548){const _0x55dca3=a34_0x6a6f();return a34_0xb36e=function(_0x50da84,_0x1e68c5){_0x50da84=_0x50da84-0xc8;let _0x6a6f54=_0x55dca3[_0x50da84];return _0x6a6f54;},a34_0xb36e(_0x51f85f,_0x4d4548);}const socket_1=require(a34_0x4443ad(0xca)),CreateQueueService_1=__importDefault(require(a34_0x4443ad(0xd2))),DeleteQueueService_1=__importDefault(require(a34_0x4443ad(0xdd))),ListQueuesService_1=__importDefault(require(a34_0x4443ad(0xf8))),ShowQueueService_1=__importDefault(require(a34_0x4443ad(0xe1))),UpdateQueueService_1=__importDefault(require(a34_0x4443ad(0xce))),lodash_1=require('lodash'),Queue_1=__importDefault(require('../models/Queue')),lodash_2=require(a34_0x4443ad(0xf9)),AppError_1=__importDefault(require('../errors/AppError')),StorageService_1=__importDefault(require('../services/StorageService/StorageService')),index=async(_0x52791f,_0x41fc13)=>{const _0x454e87=a34_0x4443ad,{companyId:_0x1cb102}=_0x52791f['user'],{companyId:_0x54b815}=_0x52791f[_0x454e87(0xd0)];let _0x263812=_0x1cb102;!(0x0,lodash_1['isNil'])(_0x54b815)&&(_0x263812=+_0x54b815);const _0x5812a0=await(0x0,ListQueuesService_1[_0x454e87(0xd6)])({'companyId':_0x263812});return _0x41fc13[_0x454e87(0xee)](0xc8)[_0x454e87(0xcf)](_0x5812a0);};exports[a34_0x4443ad(0xf1)]=index;const store=async(_0x2a1d33,_0x54b8f5)=>{const _0x539ab8=a34_0x4443ad,{name:_0x296cfa,color:_0x3ffe7b,greetingMessage:_0x475ef6,outOfHoursMessage:_0x4b44bc,orderQueue:_0x597eb3,integrationId:_0x4f565e,flowBuilderId:_0x302414}=_0x2a1d33[_0x539ab8(0xd8)],{companyId:_0x7f507c}=_0x2a1d33[_0x539ab8(0xff)],_0x2f82c5=await(0x0,CreateQueueService_1['default'])({'name':_0x296cfa,'color':_0x3ffe7b,'greetingMessage':_0x475ef6,'companyId':_0x7f507c,'outOfHoursMessage':_0x4b44bc,'orderQueue':_0x597eb3,'integrationId':_0x4f565e&&_0x4f565e!==''?_0x4f565e:null,'flowBuilderId':_0x302414&&_0x302414!==''?_0x302414:null}),_0x4f4315=(0x0,socket_1[_0x539ab8(0xde)])();return _0x4f4315[_0x539ab8(0xfc)](_0x539ab8(0xcd)+_0x7f507c+_0x539ab8(0xe0),{'action':_0x539ab8(0xe2),'queue':_0x2f82c5}),_0x54b8f5['status'](0xc8)['json'](_0x2f82c5);};exports['store']=store;const show=async(_0x3b7d9c,_0x5d7bc3)=>{const _0x57831b=a34_0x4443ad,{queueId:_0x2a2d9a}=_0x3b7d9c['params'],{companyId:_0x11046e}=_0x3b7d9c['user'],_0x2cc168=await(0x0,ShowQueueService_1[_0x57831b(0xd6)])(_0x2a2d9a,_0x11046e);return _0x5d7bc3['status'](0xc8)[_0x57831b(0xcf)](_0x2cc168);};exports[a34_0x4443ad(0xd5)]=show;const update=async(_0xd1203f,_0x47734b)=>{const _0x3496f4=a34_0x4443ad,{queueId:_0x41066e}=_0xd1203f['params'],{companyId:_0x26101b}=_0xd1203f[_0x3496f4(0xff)],_0x56822f={..._0xd1203f[_0x3496f4(0xd8)],'integrationId':_0xd1203f['body'][_0x3496f4(0xda)]&&_0xd1203f[_0x3496f4(0xd8)][_0x3496f4(0xda)]!==''?_0xd1203f[_0x3496f4(0xd8)][_0x3496f4(0xda)]:null,'flowBuilderId':_0xd1203f['body']['flowBuilderId']&&_0xd1203f[_0x3496f4(0xd8)][_0x3496f4(0xcb)]!==''?_0xd1203f[_0x3496f4(0xd8)][_0x3496f4(0xcb)]:null},_0x142df8=await(0x0,UpdateQueueService_1['default'])(_0x41066e,_0x56822f,_0x26101b),_0x1b7262=(0x0,socket_1[_0x3496f4(0xde)])();return _0x1b7262['emit'](_0x3496f4(0xcd)+_0x26101b+'-queue',{'action':'update','queue':_0x142df8}),_0x47734b['status'](0xc9)[_0x3496f4(0xcf)](_0x142df8);};exports['update']=update;const remove=async(_0x26a34c,_0xca7ce5)=>{const _0x5397fa=a34_0x4443ad,{queueId:_0x19e897}=_0x26a34c[_0x5397fa(0xfb)],{companyId:_0x488bca}=_0x26a34c[_0x5397fa(0xff)];await(0x0,DeleteQueueService_1[_0x5397fa(0xd6)])(_0x19e897,_0x488bca);const _0xb1315e=(0x0,socket_1['getIO'])();return _0xb1315e[_0x5397fa(0xfc)](_0x5397fa(0xcd)+_0x488bca+_0x5397fa(0xe0),{'action':_0x5397fa(0xcc),'queueId':+_0x19e897}),_0xca7ce5[_0x5397fa(0xee)](0xc8)['send']();};exports['remove']=remove;const mediaUpload=async(_0xdb8498,_0x48e7c4)=>{const _0x526437=a34_0x4443ad,{queueId:_0x17bfda}=_0xdb8498[_0x526437(0xfb)],_0x9ec5c4=_0xdb8498[_0x526437(0xf0)],_0x414e4b=(0x0,lodash_2[_0x526437(0xdf)])(_0x9ec5c4);try{const _0x1d1ddd=await Queue_1['default'][_0x526437(0xd7)](_0x17bfda),{companyId:_0x1a7844}=_0xdb8498[_0x526437(0xff)],{url:_0x2eb568}=await StorageService_1[_0x526437(0xd6)][_0x526437(0xfe)](_0x1a7844,_0x526437(0xf6),_0x414e4b[_0x526437(0xc9)],_0x414e4b['path'],_0x414e4b[_0x526437(0xd4)]);return _0x1d1ddd['update']({'mediaPath':_0x2eb568,'mediaName':_0x414e4b[_0x526437(0xe5)]}),_0x48e7c4['send']({'mensagem':_0x526437(0xe9)});}catch(_0x238162){throw new AppError_1['default'](_0x238162[_0x526437(0xf5)]);}};exports['mediaUpload']=mediaUpload;const deleteMedia=async(_0x5ba906,_0xa7149a)=>{const _0x427f3f=a34_0x4443ad,{queueId:_0x1b7863}=_0x5ba906[_0x427f3f(0xfb)],{companyId:_0x42405b}=_0x5ba906[_0x427f3f(0xff)];try{const _0x596380=await Queue_1[_0x427f3f(0xd6)][_0x427f3f(0xd7)](_0x1b7863);return _0x596380[_0x427f3f(0xd1)]&&await StorageService_1[_0x427f3f(0xd6)][_0x427f3f(0x100)](_0x42405b,_0x596380[_0x427f3f(0xd1)]),_0x596380['mediaPath']=null,_0x596380[_0x427f3f(0x101)]=null,await _0x596380[_0x427f3f(0xdc)](),_0xa7149a[_0x427f3f(0xe6)]({'mensagem':_0x427f3f(0xf3)});}catch(_0x4b7b56){throw new AppError_1[(_0x427f3f(0xd6))](_0x4b7b56[_0x427f3f(0xf5)]);}};exports[a34_0x4443ad(0xfd)]=deleteMedia;function a34_0x6a6f(){const _0x379f4f=['send','apply','__importDefault','Arquivo\x20Salvo','__esModule','remove','defineProperty','1657488AEWWyb','status','constructor','files','index','9704064zoRHHL','Arquivo\x20exclu√≠do','1639359TlgDBZ','message','filas','toString','../services/QueueService/ListQueuesService','lodash','store','params','emit','deleteMedia','uploadFile','user','deleteFile','mediaName','(((.+)+)+)+$','filename','../libs/socket','flowBuilderId','delete','company-','../services/QueueService/UpdateQueueService','json','query','mediaPath','../services/QueueService/CreateQueueService','7134780dGPxxv','mimetype','show','default','findByPk','body','7902384ecGdkI','integrationId','6277324CRkJnA','save','../services/QueueService/DeleteQueueService','getIO','head','-queue','../services/QueueService/ShowQueueService','update','search','1384098grRhbD','originalname'];a34_0x6a6f=function(){return _0x379f4f;};return a34_0x6a6f();}