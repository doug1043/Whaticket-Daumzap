const a29_0x9ec943=a29_0x2a19;(function(_0x557355,_0x3407e8){const _0x3b136c=a29_0x2a19,_0x29908b=_0x557355();while(!![]){try{const _0x34a00e=-parseInt(_0x3b136c(0x1b3))/0x1*(parseInt(_0x3b136c(0x1b0))/0x2)+parseInt(_0x3b136c(0x1e2))/0x3+-parseInt(_0x3b136c(0x1c7))/0x4*(-parseInt(_0x3b136c(0x1c2))/0x5)+parseInt(_0x3b136c(0x1cb))/0x6*(-parseInt(_0x3b136c(0x1bd))/0x7)+-parseInt(_0x3b136c(0x1c9))/0x8+parseInt(_0x3b136c(0x1bc))/0x9+-parseInt(_0x3b136c(0x1bb))/0xa*(-parseInt(_0x3b136c(0x1c8))/0xb);if(_0x34a00e===_0x3407e8)break;else _0x29908b['push'](_0x29908b['shift']());}catch(_0x1c5e1f){_0x29908b['push'](_0x29908b['shift']());}}}(a29_0x3dc0,0xc86fc));function a29_0x3dc0(){const _0x5d5f45=['head','save','default','body','index','defineProperty','../services/QueueService/DeleteQueueService','deleteMedia','filename','1208781cBZzhX','../libs/socket','status','Arquivo\x20excluÃ­do','update','isNil','emit','mediaName','remove','303682ILKZjU','message','params','9mUHxzY','__esModule','constructor','send','../services/QueueService/UpdateQueueService','../services/QueueService/ShowQueueService','../services/QueueService/CreateQueueService','../errors/AppError','9140FiszPE','6026625jjoXOm','1725857xZeoqn','mediaPath','(((.+)+)+)+$','path','company','4696715GxCqLd','public','company-','mediaUpload','files','4pMCqvG','5764yrhQKf','453784XwcNTr','json','6bQXrAC','lodash','getIO','companyId','store','search','apply','existsSync','Arquivo\x20Salvo','user','toString','show','-queue','-mainchannel'];a29_0x3dc0=function(){return _0x5d5f45;};return a29_0x3dc0();}const a29_0x47a102=(function(){let _0x5080fc=!![];return function(_0x4a7560,_0x4ea576){const _0x113480=_0x5080fc?function(){const _0xe0ba8=a29_0x2a19;if(_0x4ea576){const _0x364944=_0x4ea576[_0xe0ba8(0x1d1)](_0x4a7560,arguments);return _0x4ea576=null,_0x364944;}}:function(){};return _0x5080fc=![],_0x113480;};}()),a29_0x2d2032=a29_0x47a102(this,function(){const _0x233f3c=a29_0x2a19;return a29_0x2d2032[_0x233f3c(0x1d5)]()[_0x233f3c(0x1d0)](_0x233f3c(0x1bf))[_0x233f3c(0x1d5)]()[_0x233f3c(0x1b5)](a29_0x2d2032)[_0x233f3c(0x1d0)]('(((.+)+)+)+$');});a29_0x2d2032();'use strict';var __importDefault=this&&this['__importDefault']||function(_0x4649b1){const _0x3ea5f7=a29_0x2a19;return _0x4649b1&&_0x4649b1[_0x3ea5f7(0x1b4)]?_0x4649b1:{'default':_0x4649b1};};Object[a29_0x9ec943(0x1de)](exports,'__esModule',{'value':!![]}),exports[a29_0x9ec943(0x1e0)]=exports['mediaUpload']=exports[a29_0x9ec943(0x1ea)]=exports[a29_0x9ec943(0x1e6)]=exports['show']=exports[a29_0x9ec943(0x1cf)]=exports[a29_0x9ec943(0x1dd)]=void 0x0;const socket_1=require(a29_0x9ec943(0x1e3)),CreateQueueService_1=__importDefault(require(a29_0x9ec943(0x1b9))),DeleteQueueService_1=__importDefault(require(a29_0x9ec943(0x1df))),ListQueuesService_1=__importDefault(require('../services/QueueService/ListQueuesService')),ShowQueueService_1=__importDefault(require(a29_0x9ec943(0x1b8))),UpdateQueueService_1=__importDefault(require(a29_0x9ec943(0x1b7))),lodash_1=require(a29_0x9ec943(0x1cc)),Queue_1=__importDefault(require('../models/Queue')),lodash_2=require('lodash'),fs_1=__importDefault(require('fs')),path_1=__importDefault(require(a29_0x9ec943(0x1c0))),AppError_1=__importDefault(require(a29_0x9ec943(0x1ba))),index=async(_0x3aa157,_0xc18e2d)=>{const _0x320f9d=a29_0x9ec943,{companyId:_0x77a7af}=_0x3aa157[_0x320f9d(0x1d4)],{companyId:_0x115ae8}=_0x3aa157['query'];let _0x5934a3=_0x77a7af;!(0x0,lodash_1[_0x320f9d(0x1e7)])(_0x115ae8)&&(_0x5934a3=+_0x115ae8);const _0xb67f13=await(0x0,ListQueuesService_1[_0x320f9d(0x1db)])({'companyId':_0x5934a3});return _0xc18e2d[_0x320f9d(0x1e4)](0xc8)[_0x320f9d(0x1ca)](_0xb67f13);};exports['index']=index;const store=async(_0x2bf446,_0x4d25ab)=>{const _0x1f6b78=a29_0x9ec943,{name:_0x50ac36,color:_0x5f27b1,greetingMessage:_0x1b0e39,outOfHoursMessage:_0x5a5571,keywords:_0xc0c322,schedules:_0x1319ac,orderQueue:_0x324183,integrationId:_0xf07400,promptId:_0x3e5ce5}=_0x2bf446[_0x1f6b78(0x1dc)],{companyId:_0xa2e1a6}=_0x2bf446[_0x1f6b78(0x1d4)],_0x143fe4=await(0x0,CreateQueueService_1[_0x1f6b78(0x1db)])({'name':_0x50ac36,'color':_0x5f27b1,'greetingMessage':_0x1b0e39,'companyId':_0xa2e1a6,'outOfHoursMessage':_0x5a5571,'keywords':_0xc0c322,'schedules':_0x1319ac,'orderQueue':_0x324183===''?null:_0x324183,'integrationId':_0xf07400===''?null:_0xf07400,'promptId':_0x3e5ce5===''?null:_0x3e5ce5}),_0x41fe84=(0x0,socket_1[_0x1f6b78(0x1cd)])();return _0x41fe84['to']('company-'+_0xa2e1a6+_0x1f6b78(0x1d8))[_0x1f6b78(0x1e8)](_0x1f6b78(0x1c4)+_0xa2e1a6+_0x1f6b78(0x1d7),{'action':_0x1f6b78(0x1e6),'queue':_0x143fe4}),_0x4d25ab['status'](0xc8)[_0x1f6b78(0x1ca)](_0x143fe4);};exports[a29_0x9ec943(0x1cf)]=store;const show=async(_0x1d5b63,_0x11f36d)=>{const _0x3af347=a29_0x9ec943,{queueId:_0x184ef3}=_0x1d5b63[_0x3af347(0x1b2)],{companyId:_0x4b15d2}=_0x1d5b63[_0x3af347(0x1d4)],_0xd41689=await(0x0,ShowQueueService_1[_0x3af347(0x1db)])(_0x184ef3,_0x4b15d2);return _0x11f36d[_0x3af347(0x1e4)](0xc8)['json'](_0xd41689);};exports[a29_0x9ec943(0x1d6)]=show;const update=async(_0x531a3,_0xc17046)=>{const _0x184bd9=a29_0x9ec943,{queueId:_0x5180bd}=_0x531a3['params'],{companyId:_0x2545c2}=_0x531a3['user'],{name:_0x1d37de,color:_0x5b5c95,greetingMessage:_0x4529d5,outOfHoursMessage:_0xd902be,keywords:_0x4e0b74,newTicketOnTransfer:_0x336651,schedules:_0x55386b,orderQueue:_0xf93d8e,integrationId:_0x582321,promptId:_0x4ed687}=_0x531a3[_0x184bd9(0x1dc)],_0x49ef6a=await(0x0,UpdateQueueService_1[_0x184bd9(0x1db)])(_0x5180bd,{'name':_0x1d37de,'color':_0x5b5c95,'greetingMessage':_0x4529d5,'outOfHoursMessage':_0xd902be,'keywords':_0x4e0b74,'newTicketOnTransfer':_0x336651,'schedules':_0x55386b,'orderQueue':_0xf93d8e===''?null:_0xf93d8e,'integrationId':_0x582321===''?null:_0x582321,'promptId':_0x4ed687===''?null:_0x4ed687},_0x2545c2),_0x15bfe9=(0x0,socket_1[_0x184bd9(0x1cd)])();return _0x15bfe9['to'](_0x184bd9(0x1c4)+_0x2545c2+_0x184bd9(0x1d8))[_0x184bd9(0x1e8)](_0x184bd9(0x1c4)+_0x2545c2+_0x184bd9(0x1d7),{'action':_0x184bd9(0x1e6),'queue':_0x49ef6a}),_0xc17046[_0x184bd9(0x1e4)](0xc9)['json'](_0x49ef6a);};exports[a29_0x9ec943(0x1e6)]=update;function a29_0x2a19(_0x2a9717,_0x21d9ce){const _0x3f4533=a29_0x3dc0();return a29_0x2a19=function(_0x2d2032,_0x47a102){_0x2d2032=_0x2d2032-0x1b0;let _0x3dc080=_0x3f4533[_0x2d2032];return _0x3dc080;},a29_0x2a19(_0x2a9717,_0x21d9ce);}const remove=async(_0x4d1b2a,_0x28be54)=>{const _0x49aacb=a29_0x9ec943,{queueId:_0x5df33c}=_0x4d1b2a[_0x49aacb(0x1b2)],{companyId:_0x5b5773}=_0x4d1b2a[_0x49aacb(0x1d4)];await(0x0,DeleteQueueService_1['default'])(_0x5df33c,_0x5b5773);const _0x1ada97=(0x0,socket_1['getIO'])();return _0x1ada97['to'](_0x49aacb(0x1c4)+_0x5b5773+_0x49aacb(0x1d8))[_0x49aacb(0x1e8)](_0x49aacb(0x1c4)+_0x5b5773+'-queue',{'action':'delete','queueId':+_0x5df33c}),_0x28be54['status'](0xc8)[_0x49aacb(0x1b6)]();};exports[a29_0x9ec943(0x1ea)]=remove;const mediaUpload=async(_0x1ee9a6,_0x8f70bd)=>{const _0x568d7c=a29_0x9ec943,{queueId:_0x51ac98}=_0x1ee9a6[_0x568d7c(0x1b2)],_0x2aefb8=_0x1ee9a6[_0x568d7c(0x1c6)],_0x4c1f8a=(0x0,lodash_2[_0x568d7c(0x1d9)])(_0x2aefb8);try{const _0x4adfbf=await Queue_1['default']['findByPk'](_0x51ac98);return _0x4adfbf[_0x568d7c(0x1e6)]({'mediaPath':_0x4c1f8a[_0x568d7c(0x1e1)],'mediaName':_0x4c1f8a['originalname']}),_0x8f70bd[_0x568d7c(0x1b6)]({'mensagem':_0x568d7c(0x1d3)});}catch(_0x566118){throw new AppError_1[(_0x568d7c(0x1db))](_0x566118[_0x568d7c(0x1b1)]);}};exports[a29_0x9ec943(0x1c5)]=mediaUpload;const deleteMedia=async(_0x18b96e,_0x44ab60)=>{const _0x25d1d4=a29_0x9ec943,{queueId:_0x170294}=_0x18b96e[_0x25d1d4(0x1b2)];try{const _0x32b9ec=await Queue_1[_0x25d1d4(0x1db)]['findByPk'](_0x170294),_0x1165c1=path_1[_0x25d1d4(0x1db)]['resolve'](_0x25d1d4(0x1c3),_0x25d1d4(0x1c1)+_0x32b9ec[_0x25d1d4(0x1ce)],_0x32b9ec[_0x25d1d4(0x1be)]),_0x197030=fs_1['default'][_0x25d1d4(0x1d2)](_0x1165c1);return _0x197030&&fs_1[_0x25d1d4(0x1db)]['unlinkSync'](_0x1165c1),_0x32b9ec['mediaPath']=null,_0x32b9ec[_0x25d1d4(0x1e9)]=null,await _0x32b9ec[_0x25d1d4(0x1da)](),_0x44ab60[_0x25d1d4(0x1b6)]({'mensagem':_0x25d1d4(0x1e5)});}catch(_0x9ae0b){throw new AppError_1['default'](_0x9ae0b[_0x25d1d4(0x1b1)]);}};exports[a29_0x9ec943(0x1e0)]=deleteMedia;