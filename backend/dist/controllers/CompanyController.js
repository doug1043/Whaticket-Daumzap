const a13_0xc7fe70=a13_0x5c1e;(function(_0x419a19,_0x36d3bb){const _0x2535d6=a13_0x5c1e,_0x120f5f=_0x419a19();while(!![]){try{const _0x550172=-parseInt(_0x2535d6(0xd6))/0x1+-parseInt(_0x2535d6(0x117))/0x2+parseInt(_0x2535d6(0x107))/0x3+parseInt(_0x2535d6(0x102))/0x4*(parseInt(_0x2535d6(0xe3))/0x5)+parseInt(_0x2535d6(0x11b))/0x6*(parseInt(_0x2535d6(0xf8))/0x7)+-parseInt(_0x2535d6(0xfa))/0x8*(-parseInt(_0x2535d6(0xda))/0x9)+-parseInt(_0x2535d6(0xd9))/0xa*(parseInt(_0x2535d6(0xe1))/0xb);if(_0x550172===_0x36d3bb)break;else _0x120f5f['push'](_0x120f5f['shift']());}catch(_0x52de35){_0x120f5f['push'](_0x120f5f['shift']());}}}(a13_0x42a1,0x7b685));const a13_0x30b2fc=(function(){let _0x2a8fcc=!![];return function(_0x522b1e,_0xc7bb6a){const _0x3ff4fd=_0x2a8fcc?function(){if(_0xc7bb6a){const _0x2e71f3=_0xc7bb6a['apply'](_0x522b1e,arguments);return _0xc7bb6a=null,_0x2e71f3;}}:function(){};return _0x2a8fcc=![],_0x3ff4fd;};}()),a13_0x2c58f5=a13_0x30b2fc(this,function(){const _0x534e9b=a13_0x5c1e;return a13_0x2c58f5[_0x534e9b(0x104)]()['search']('(((.+)+)+)+$')[_0x534e9b(0x104)]()[_0x534e9b(0xef)](a13_0x2c58f5)['search'](_0x534e9b(0xe7));});a13_0x2c58f5();'use strict';var __createBinding=this&&this[a13_0xc7fe70(0xe4)]||(Object[a13_0xc7fe70(0xdb)]?function(_0x5c1f57,_0x406d6c,_0x5a632b,_0x5c0ba4){const _0x207ec6=a13_0xc7fe70;if(_0x5c0ba4===undefined)_0x5c0ba4=_0x5a632b;var _0xd3ef6f=Object['getOwnPropertyDescriptor'](_0x406d6c,_0x5a632b);(!_0xd3ef6f||(_0x207ec6(0x10e)in _0xd3ef6f?!_0x406d6c[_0x207ec6(0xe2)]:_0xd3ef6f[_0x207ec6(0xea)]||_0xd3ef6f[_0x207ec6(0xf4)]))&&(_0xd3ef6f={'enumerable':!![],'get':function(){return _0x406d6c[_0x5a632b];}}),Object[_0x207ec6(0x11a)](_0x5c1f57,_0x5c0ba4,_0xd3ef6f);}:function(_0x4a59d8,_0x46500d,_0x219d28,_0x13c4d9){if(_0x13c4d9===undefined)_0x13c4d9=_0x219d28;_0x4a59d8[_0x13c4d9]=_0x46500d[_0x219d28];}),__setModuleDefault=this&&this[a13_0xc7fe70(0xe0)]||(Object['create']?function(_0x373b88,_0xeac8b1){const _0x285ed2=a13_0xc7fe70;Object[_0x285ed2(0x11a)](_0x373b88,_0x285ed2(0x103),{'enumerable':!![],'value':_0xeac8b1});}:function(_0x591646,_0x3ac73e){const _0x5bd4b4=a13_0xc7fe70;_0x591646[_0x5bd4b4(0x103)]=_0x3ac73e;}),__importStar=this&&this[a13_0xc7fe70(0xd5)]||function(_0x583e65){const _0x409ffc=a13_0xc7fe70;if(_0x583e65&&_0x583e65[_0x409ffc(0xe2)])return _0x583e65;var _0xa40a28={};if(_0x583e65!=null){for(var _0x17eb27 in _0x583e65)if(_0x17eb27!==_0x409ffc(0x103)&&Object[_0x409ffc(0x101)][_0x409ffc(0xf3)][_0x409ffc(0x119)](_0x583e65,_0x17eb27))__createBinding(_0xa40a28,_0x583e65,_0x17eb27);}return __setModuleDefault(_0xa40a28,_0x583e65),_0xa40a28;},__importDefault=this&&this[a13_0xc7fe70(0xf1)]||function(_0x222e1a){return _0x222e1a&&_0x222e1a['__esModule']?_0x222e1a:{'default':_0x222e1a};};Object[a13_0xc7fe70(0x11a)](exports,a13_0xc7fe70(0xe2),{'value':!![]}),exports[a13_0xc7fe70(0x100)]=exports[a13_0xc7fe70(0xee)]=exports[a13_0xc7fe70(0x118)]=exports[a13_0xc7fe70(0xf5)]=exports[a13_0xc7fe70(0xf2)]=exports[a13_0xc7fe70(0xd4)]=exports[a13_0xc7fe70(0xce)]=exports[a13_0xc7fe70(0xfe)]=exports[a13_0xc7fe70(0x10f)]=exports['index']=void 0x0;const Yup=__importStar(require(a13_0xc7fe70(0xf6))),AppError_1=__importDefault(require(a13_0xc7fe70(0x11c))),auth_1=__importDefault(require('../config/auth')),ListCompaniesService_1=__importDefault(require(a13_0xc7fe70(0x10d))),CreateCompanyService_1=__importDefault(require('../services/CompanyService/CreateCompanyService')),UpdateCompanyService_1=__importDefault(require(a13_0xc7fe70(0xde))),ShowCompanyService_1=__importDefault(require(a13_0xc7fe70(0xdf))),UpdateSchedulesService_1=__importDefault(require(a13_0xc7fe70(0xcc))),DeleteCompanyService_1=__importDefault(require('../services/CompanyService/DeleteCompanyService')),FindAllCompaniesService_1=__importDefault(require(a13_0xc7fe70(0xe6))),jsonwebtoken_1=require(a13_0xc7fe70(0xcf)),User_1=__importDefault(require('../models/User')),ShowPlanCompanyService_1=__importDefault(require(a13_0xc7fe70(0x10b))),ListCompaniesPlanService_1=__importDefault(require(a13_0xc7fe70(0xdc))),CheckSettings_1=__importDefault(require('../helpers/CheckSettings')),moment_1=__importDefault(require(a13_0xc7fe70(0xdd))),fs_1=__importDefault(require('fs')),path_1=__importDefault(require(a13_0xc7fe70(0xe8))),publicFolder=path_1['default']['resolve'](__dirname,'..','..',a13_0xc7fe70(0x111)),index=async(_0x45a76f,_0x1d1861)=>{const _0x2216cd=a13_0xc7fe70,{searchParam:_0x32598d,pageNumber:_0x1c8f37}=_0x45a76f[_0x2216cd(0xf7)],{companies:_0x30c305,count:_0x539ae6,hasMore:_0xea63db}=await(0x0,ListCompaniesService_1[_0x2216cd(0x103)])({'searchParam':_0x32598d,'pageNumber':_0x1c8f37});return _0x1d1861[_0x2216cd(0x109)]({'companies':_0x30c305,'count':_0x539ae6,'hasMore':_0xea63db});};exports[a13_0xc7fe70(0x106)]=index;const signup=async(_0x441cc9,_0x405268)=>{const _0x59f0ac=a13_0xc7fe70;if(await(0x0,CheckSettings_1[_0x59f0ac(0x103)])('allowSignup')!==_0x59f0ac(0xe9))return _0x405268[_0x59f0ac(0x108)](0x191)[_0x59f0ac(0x109)]('🙎🏻‍♂️\x20Signup\x20disabled');return await(0x0,exports[_0x59f0ac(0xfe)])(_0x441cc9,_0x405268);};exports['signup']=signup;const store=async(_0x5bd5a5,_0x1c3d92)=>{const _0x24e834=a13_0xc7fe70,_0x4307c5=_0x5bd5a5[_0x24e834(0x115)];try{const _0x39d7f1=await(0x0,CheckSettings_1['default'])(_0x24e834(0xcd)),_0x30975b=parseInt(_0x39d7f1,0xa);isNaN(_0x30975b)||_0x30975b<=0x0?_0x4307c5[_0x24e834(0xec)]=(0x0,moment_1[_0x24e834(0x103)])()['add'](0x7,_0x24e834(0x105))['toDate']():_0x4307c5['dueDate']=(0x0,moment_1[_0x24e834(0x103)])()['add'](_0x30975b,_0x24e834(0x105))[_0x24e834(0x116)]();const _0x4a23b6=await(0x0,CreateCompanyService_1[_0x24e834(0x103)])(_0x4307c5);return _0x1c3d92[_0x24e834(0x108)](0xc9)[_0x24e834(0x109)](_0x4a23b6);}catch(_0x10e902){return _0x1c3d92[_0x24e834(0x108)](0x1f4)['json']({'message':'Error\x20creating\x20company','error':_0x10e902});}};exports[a13_0xc7fe70(0xfe)]=store;const show=async(_0xc27ea8,_0x3043bb)=>{const _0xb1b5ab=a13_0xc7fe70,{id:_0x4b8f43}=_0xc27ea8[_0xb1b5ab(0x10a)],_0x486797=await User_1[_0xb1b5ab(0x103)]['findByPk'](_0xc27ea8[_0xb1b5ab(0xf0)]['id']);if(!_0x486797['super']&&Number[_0xb1b5ab(0xd8)](_0x4b8f43,0xa)!==_0x486797[_0xb1b5ab(0x10c)])throw new AppError_1['default'](_0xb1b5ab(0x110),0x193);const _0x503f3c=await(0x0,ShowCompanyService_1[_0xb1b5ab(0x103)])(_0x4b8f43);return _0x3043bb[_0xb1b5ab(0x108)](0xc8)['json'](_0x503f3c);};function a13_0x5c1e(_0x4152c0,_0x319b8a){const _0x9d1e45=a13_0x42a1();return a13_0x5c1e=function(_0x2c58f5,_0x30b2fc){_0x2c58f5=_0x2c58f5-0xca;let _0x42a119=_0x9d1e45[_0x2c58f5];return _0x42a119;},a13_0x5c1e(_0x4152c0,_0x319b8a);}exports[a13_0xc7fe70(0xce)]=show;const list=async(_0x5b7ebe,_0xed3d6d)=>{const _0x432fbd=a13_0xc7fe70,_0x21e6c6=await(0x0,FindAllCompaniesService_1[_0x432fbd(0x103)])();return _0xed3d6d[_0x432fbd(0x108)](0xc8)[_0x432fbd(0x109)](_0x21e6c6);};exports[a13_0xc7fe70(0xd4)]=list;const update=async(_0x58a25f,_0x7f6aa6)=>{const _0x1d09e2=a13_0xc7fe70,_0x44df06=_0x58a25f[_0x1d09e2(0x115)],_0x172f84=Yup[_0x1d09e2(0xf9)]()[_0x1d09e2(0x112)]({'name':Yup[_0x1d09e2(0x113)]()[_0x1d09e2(0xfc)](),'email':Yup['string']()['email']()[_0x1d09e2(0x114)](),'phone':Yup[_0x1d09e2(0x113)]()[_0x1d09e2(0x114)](),'status':Yup[_0x1d09e2(0xeb)]()['nullable'](),'planId':Yup[_0x1d09e2(0xcb)]()[_0x1d09e2(0x114)](),'campaignsEnabled':Yup[_0x1d09e2(0xeb)]()[_0x1d09e2(0x114)](),'dueDate':Yup[_0x1d09e2(0xd3)]()[_0x1d09e2(0x114)](),'recurrence':Yup['string']()['nullable']()});try{await _0x172f84[_0x1d09e2(0xfb)](_0x44df06);}catch(_0x589e37){throw new AppError_1['default'](_0x589e37['message']);}const {id:_0x4cec0e}=_0x58a25f['params'],_0x19ccf6=await(0x0,UpdateCompanyService_1[_0x1d09e2(0x103)])({'id':_0x4cec0e,..._0x44df06});return _0x7f6aa6[_0x1d09e2(0x108)](0xc8)[_0x1d09e2(0x109)](_0x19ccf6);};exports[a13_0xc7fe70(0xf2)]=update;const updateSchedules=async(_0x1ec99d,_0x2fc7fc)=>{const _0x59607f=a13_0xc7fe70,{schedules:_0xded015}=_0x1ec99d[_0x59607f(0x115)],{id:_0x152c26}=_0x1ec99d[_0x59607f(0x10a)],_0x587218=await User_1[_0x59607f(0x103)]['findByPk'](_0x1ec99d[_0x59607f(0xf0)]['id']);if(!_0x587218[_0x59607f(0xff)]&&Number[_0x59607f(0xd8)](_0x152c26,0xa)!==_0x587218['companyId'])throw new AppError_1['default']('ERR_FORBIDDEN',0x193);const _0x434fee=await(0x0,UpdateSchedulesService_1['default'])({'id':_0x152c26,'schedules':_0xded015});return _0x2fc7fc[_0x59607f(0x108)](0xc8)[_0x59607f(0x109)](_0x434fee);};exports['updateSchedules']=updateSchedules;function a13_0x42a1(){const _0x4c7b9e=['__esModule','110fbMvWh','__createBinding','secret','../services/CompanyService/FindAllCompaniesService','(((.+)+)+)+$','path','enabled','writable','boolean','dueDate','/company','listPlan','constructor','user','__importDefault','update','hasOwnProperty','configurable','updateSchedules','yup','query','259RalxJH','object','2392352JtWgYN','validate','required','findByPk','store','super','indexPlan','prototype','7544yFjbIx','default','toString','days','index','2583942qLKhNY','status','json','params','../services/CompanyService/ShowPlanCompanyService','companyId','../services/CompanyService/ListCompaniesService','get','signup','ERR_FORBIDDEN','public','shape','string','nullable','body','toDate','153854HnyOyq','remove','call','defineProperty','94818saHwhb','../errors/AppError','authorization','number','../services/CompanyService/UpdateSchedulesService','trialExpiration','show','jsonwebtoken','headers','Você\x20não\x20possui\x20permissão\x20para\x20acessar\x20este\x20recurso!','existsSync','date','list','__importStar','621606zIckqr','split','parseInt','5825510GUWfcp','9XGyaRv','create','../services/CompanyService/ListCompaniesPlanService','moment','../services/CompanyService/UpdateCompanyService','../services/CompanyService/ShowCompanyService','__setModuleDefault','11XPfhqj'];a13_0x42a1=function(){return _0x4c7b9e;};return a13_0x42a1();}const remove=async(_0x3f6ae7,_0x3ddb84)=>{const _0x36fb52=a13_0xc7fe70,{id:_0x2c524b}=_0x3f6ae7[_0x36fb52(0x10a)];fs_1[_0x36fb52(0x103)][_0x36fb52(0xd2)](publicFolder+_0x36fb52(0xed)+_0x2c524b+'/')&&fs_1[_0x36fb52(0x103)]['rmdirSync'](publicFolder+'/company'+_0x2c524b+'/',{'recursive':!![]});const _0x413a0f=await(0x0,DeleteCompanyService_1['default'])(_0x2c524b);return _0x3ddb84['status'](0xc8)[_0x36fb52(0x109)](_0x413a0f);};exports['remove']=remove;const listPlan=async(_0x2c0673,_0x930704)=>{const _0x4a4976=a13_0xc7fe70,{id:_0x1a1da7}=_0x2c0673['params'],_0x4038b0=_0x2c0673[_0x4a4976(0xd0)][_0x4a4976(0xca)],[,_0x2ce32a]=_0x4038b0[_0x4a4976(0xd7)]('\x20'),_0xe3ef5=(0x0,jsonwebtoken_1['verify'])(_0x2ce32a,auth_1[_0x4a4976(0x103)][_0x4a4976(0xe5)]),{id:_0xf1e5f0,profile:_0x3987a8,companyId:_0x5b681e}=_0xe3ef5,_0x323060=await User_1[_0x4a4976(0x103)][_0x4a4976(0xfd)](_0xf1e5f0);if(_0x323060[_0x4a4976(0xff)]===!![]||_0x5b681e[_0x4a4976(0x104)]()===_0x1a1da7){const _0x566f22=await(0x0,ShowPlanCompanyService_1[_0x4a4976(0x103)])(_0x1a1da7);return _0x930704[_0x4a4976(0x108)](0xc8)[_0x4a4976(0x109)](_0x566f22);}else return _0x930704['status'](0x190)[_0x4a4976(0x109)]({'error':_0x4a4976(0xd1)});};exports[a13_0xc7fe70(0xee)]=listPlan;const indexPlan=async(_0x3ec590,_0x26ab89)=>{const _0x4b1f03=a13_0xc7fe70,{searchParam:_0x36cf02,pageNumber:_0x1d6cf0}=_0x3ec590['query'],_0x5c6476=_0x3ec590[_0x4b1f03(0xd0)][_0x4b1f03(0xca)],[,_0x1f9cc5]=_0x5c6476[_0x4b1f03(0xd7)]('\x20'),_0x3e1ee7=(0x0,jsonwebtoken_1['verify'])(_0x1f9cc5,auth_1[_0x4b1f03(0x103)][_0x4b1f03(0xe5)]),{id:_0x398de6,profile:_0x3dbd08,companyId:_0x5d8cae}=_0x3e1ee7,_0x5a6463=await User_1['default']['findByPk'](_0x398de6);if(_0x5a6463['super']===!![]){const _0x25fbd9=await(0x0,ListCompaniesPlanService_1[_0x4b1f03(0x103)])();return _0x26ab89[_0x4b1f03(0x109)]({'companies':_0x25fbd9});}else return _0x26ab89[_0x4b1f03(0x108)](0x190)[_0x4b1f03(0x109)]({'error':_0x4b1f03(0xd1)});};exports[a13_0xc7fe70(0x100)]=indexPlan;