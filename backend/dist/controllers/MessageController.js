const a26_0x3d8d9f=a26_0x4d8d;(function(_0x112e1f,_0x52eecd){const _0x595db7=a26_0x4d8d,_0x591339=_0x112e1f();while(!![]){try{const _0x1ee994=-parseInt(_0x595db7(0x21c))/0x1+parseInt(_0x595db7(0x222))/0x2*(-parseInt(_0x595db7(0x20b))/0x3)+-parseInt(_0x595db7(0x1ca))/0x4+parseInt(_0x595db7(0x228))/0x5+-parseInt(_0x595db7(0x1b2))/0x6+parseInt(_0x595db7(0x1d1))/0x7+parseInt(_0x595db7(0x1f4))/0x8*(parseInt(_0x595db7(0x1db))/0x9);if(_0x1ee994===_0x52eecd)break;else _0x591339['push'](_0x591339['shift']());}catch(_0x5b2c7d){_0x591339['push'](_0x591339['shift']());}}}(a26_0x3ea3,0xe2624));const a26_0x4472b2=(function(){let _0x308272=!![];return function(_0x582334,_0x1b95a6){const _0xe29f7d=_0x308272?function(){if(_0x1b95a6){const _0x3ddb51=_0x1b95a6['apply'](_0x582334,arguments);return _0x1b95a6=null,_0x3ddb51;}}:function(){};return _0x308272=![],_0xe29f7d;};}()),a26_0xb55a36=a26_0x4472b2(this,function(){const _0x4a0e99=a26_0x4d8d;return a26_0xb55a36[_0x4a0e99(0x1e9)]()['search'](_0x4a0e99(0x1d6))[_0x4a0e99(0x1e9)]()[_0x4a0e99(0x1de)](a26_0xb55a36)[_0x4a0e99(0x1c6)](_0x4a0e99(0x1d6));});function a26_0x3ea3(){const _0x214e66=['Reação\x20adicionada\x20com\x20sucesso!','Erro\x20na\x20conversão\x20do\x20áudio:','path','../models/Whatsapp','GetWhatsAppFromMessage','Mensagem\x20não\x20encontrada','storeAudio','Message\x20not\x20found','number','Não\x20foi\x20possível\x20realizar\x20a\x20operação','body','../services/TicketServices/ShowTicketService','index','app','hasOwnProperty','emit','originalname','queues','search','map','getIO','edit','6970128jGNFND','conversation','@g.us','Whatsapp\x20from\x20message\x20not\x20found','saveToFile','message','file','462735ZbNeTg','mp3','../services/UserServices/ShowUserService','files','notifyUpdate','(((.+)+)+)+$','__importDefault','messageQueue','get','messageId','801QipORw','__esModule','keys','constructor','../services/MessageServices/ListMessagesService','SendWhatsAppMediaFileAddress','contactId','error','save','extendedTextMessage','fluent-ffmpeg','../helpers/SetTicketMessagesAsRead','Erro\x20ao\x20adicionar\x20reação','update','toString','../models/Ticket','addReaction','\x20enviado\x20com\x20sucesso','../helpers/SendPresenceStatus','dateEnd','user','Contact\x20not\x20found','-appMessage','store','company-','402432WeXaZv','findByPk','crypto','../services/WbotServices/SendWhatsAppReaction','SendPausedStatus','toFormat','getAll','unreadMessages','../models/Message','create','SendMessage','mediaType','forwardMessage','call','../errors/AppError','filename','../helpers/Mustache','TicketId\x20is\x20required','Status\x20','MessageId\x20or\x20ContactId\x20not\x20found','replace','../libs/wbot','send','9KPNanT','mediaUrl','defineProperty','hex','getOwnPropertyDescriptor','../models/Queue','status','../services/MessageServices/TranslateAudioService','query','prototype','end','../services/WbotServices/SendWhatsAppMedia','../libs/socket','getWbot','toBoolean','reactions','../services/TicketServices/FindOrCreateTicketService','378572QtBRzv','open','../services/TicketServices/UpdateTicketService','companyId','Não\x20foi\x20possível\x20enviar\x20a\x20mensagem,\x20tente\x20novamente\x20em\x20alguns\x20instantes','s.whatsapp.net','365890hbGQOe','../services/ContactServices/CreateOrUpdateContactService','SendTypingStatus','Ticket\x20not\x20found','dateStart','../services/WbotServices/CheckNumber','4264025MDdTFX','>>>>>>>>>>>>>>>>>forwardMessage\x20X<<<<<<<<<<<<<<<<<<<','json','../services/WbotServices/DeleteWhatsAppMessage','Transcrição\x20não\x20disponível','admin','add','ShowContactService1','ticketId','../services/WbotServices/EditWhatsAppMessage','typing','default','Erro\x20ao\x20adicionar\x20reação:','whatsappId','log','../services/WbotServices/SendWhatsAppMessage','../helpers/GetWhatsappWbot','../models/User','.mp3','params','setFfmpegPath','queueId','jid','../utils/user','../services/ContactServices/ShowContactService','contact','O\x20número\x20é\x20obrigatório','configurable','g.us','__importStar','10792554zqEMoA','isGroup'];a26_0x3ea3=function(){return _0x214e66;};return a26_0x3ea3();}a26_0xb55a36();'use strict';var __createBinding=this&&this['__createBinding']||(Object[a26_0x3d8d9f(0x1fd)]?function(_0xd93e8,_0xe4ca75,_0x9b81f,_0x130a87){const _0x3595f7=a26_0x3d8d9f;if(_0x130a87===undefined)_0x130a87=_0x9b81f;var _0x29ba14=Object[_0x3595f7(0x20f)](_0xe4ca75,_0x9b81f);(!_0x29ba14||(_0x3595f7(0x1d9)in _0x29ba14?!_0xe4ca75[_0x3595f7(0x1dc)]:_0x29ba14['writable']||_0x29ba14[_0x3595f7(0x243)]))&&(_0x29ba14={'enumerable':!![],'get':function(){return _0xe4ca75[_0x9b81f];}}),Object[_0x3595f7(0x20d)](_0xd93e8,_0x130a87,_0x29ba14);}:function(_0x380ce1,_0x4b803b,_0x155ed7,_0x2e5e91){if(_0x2e5e91===undefined)_0x2e5e91=_0x155ed7;_0x380ce1[_0x2e5e91]=_0x4b803b[_0x155ed7];}),__setModuleDefault=this&&this['__setModuleDefault']||(Object[a26_0x3d8d9f(0x1fd)]?function(_0x2caebe,_0x421b20){const _0x35f60b=a26_0x3d8d9f;Object[_0x35f60b(0x20d)](_0x2caebe,_0x35f60b(0x233),{'enumerable':!![],'value':_0x421b20});}:function(_0x2be0a0,_0x47e4ba){const _0x27c33d=a26_0x3d8d9f;_0x2be0a0[_0x27c33d(0x233)]=_0x47e4ba;}),__importStar=this&&this[a26_0x3d8d9f(0x245)]||function(_0x5a8eb0){const _0x39558c=a26_0x3d8d9f;if(_0x5a8eb0&&_0x5a8eb0['__esModule'])return _0x5a8eb0;var _0x248089={};if(_0x5a8eb0!=null){for(var _0x317ad9 in _0x5a8eb0)if(_0x317ad9!==_0x39558c(0x233)&&Object[_0x39558c(0x214)][_0x39558c(0x1c2)][_0x39558c(0x201)](_0x5a8eb0,_0x317ad9))__createBinding(_0x248089,_0x5a8eb0,_0x317ad9);}return __setModuleDefault(_0x248089,_0x5a8eb0),_0x248089;},__importDefault=this&&this[a26_0x3d8d9f(0x1d7)]||function(_0x17d0a7){const _0x5a6fd6=a26_0x3d8d9f;return _0x17d0a7&&_0x17d0a7[_0x5a6fd6(0x1dc)]?_0x17d0a7:{'default':_0x17d0a7};};Object[a26_0x3d8d9f(0x20d)](exports,a26_0x3d8d9f(0x1dc),{'value':!![]}),exports[a26_0x3d8d9f(0x200)]=exports[a26_0x3d8d9f(0x1ba)]=exports['addReaction']=exports[a26_0x3d8d9f(0x20a)]=exports[a26_0x3d8d9f(0x232)]=exports['remove']=exports[a26_0x3d8d9f(0x1c9)]=exports[a26_0x3d8d9f(0x1fa)]=exports['store']=exports[a26_0x3d8d9f(0x1c0)]=void 0x0;const AppError_1=__importDefault(require(a26_0x3d8d9f(0x202))),SetTicketMessagesAsRead_1=__importDefault(require(a26_0x3d8d9f(0x1e6))),socket_1=require(a26_0x3d8d9f(0x217)),Message_1=__importDefault(require(a26_0x3d8d9f(0x1fc))),Ticket_1=__importDefault(require(a26_0x3d8d9f(0x1ea))),Queue_1=__importDefault(require(a26_0x3d8d9f(0x210))),User_1=__importDefault(require(a26_0x3d8d9f(0x239))),Whatsapp_1=__importDefault(require(a26_0x3d8d9f(0x1b7))),Mustache_1=__importDefault(require(a26_0x3d8d9f(0x204))),ListMessagesService_1=__importDefault(require(a26_0x3d8d9f(0x1df))),ShowTicketService_1=__importDefault(require(a26_0x3d8d9f(0x1bf))),FindOrCreateTicketService_1=__importDefault(require(a26_0x3d8d9f(0x21b))),UpdateTicketService_1=__importDefault(require(a26_0x3d8d9f(0x21e))),DeleteWhatsAppMessage_1=__importDefault(require(a26_0x3d8d9f(0x22b))),SendWhatsAppMedia_1=__importStar(require(a26_0x3d8d9f(0x216))),SendWhatsAppMessage_1=__importDefault(require(a26_0x3d8d9f(0x237))),SendWhatsAppReaction_1=__importDefault(require(a26_0x3d8d9f(0x1f7))),CheckNumber_1=__importDefault(require(a26_0x3d8d9f(0x227))),EditWhatsAppMessage_1=__importDefault(require(a26_0x3d8d9f(0x231))),TranslateAudioService_1=__importDefault(require(a26_0x3d8d9f(0x212))),CreateOrUpdateContactService_1=__importDefault(require(a26_0x3d8d9f(0x223))),ShowMessageService_1=__importStar(require('../services/MessageServices/ShowMessageService')),ShowContactService_1=require(a26_0x3d8d9f(0x240)),ShowUserService_1=__importDefault(require(a26_0x3d8d9f(0x1d3))),user_1=require(a26_0x3d8d9f(0x23f)),UpdateTicketService_2=require(a26_0x3d8d9f(0x21e)),ListAllMessagesService_1=__importDefault(require('../services/MessageServices/ListAllMessagesService')),validator_1=require('validator'),ffmpeg_static_1=__importDefault(require('ffmpeg-static')),fluent_ffmpeg_1=__importDefault(require(a26_0x3d8d9f(0x1e5))),crypto_1=__importDefault(require(a26_0x3d8d9f(0x1f6))),GetWhatsappWbot_1=__importDefault(require(a26_0x3d8d9f(0x238))),wbot_1=require(a26_0x3d8d9f(0x209)),SendPresenceStatus_1=require(a26_0x3d8d9f(0x1ed));fluent_ffmpeg_1[a26_0x3d8d9f(0x233)][a26_0x3d8d9f(0x23c)](ffmpeg_static_1[a26_0x3d8d9f(0x233)]);const index=async(_0x5d9123,_0x242826)=>{const _0x2ab982=a26_0x3d8d9f,{ticketId:_0x98b39f}=_0x5d9123['params'],{pageNumber:_0xf745c}=_0x5d9123[_0x2ab982(0x213)],{companyId:_0x2cc9c4,profile:_0x26e623}=_0x5d9123['user'],_0x329af5=[];if(_0x26e623!==_0x2ab982(0x22d)){const _0x4829a3=await User_1[_0x2ab982(0x233)][_0x2ab982(0x1f5)](_0x5d9123['user']['id'],{'include':[{'model':Queue_1['default'],'as':_0x2ab982(0x1c5)}]});_0x4829a3['queues']['forEach'](_0x452459=>{_0x329af5['push'](_0x452459['id']);});}const {count:_0x2695ca,messages:_0x55a1ba,ticket:_0x19b544,hasMore:_0x5b580c}=await(0x0,ListMessagesService_1['default'])({'pageNumber':_0xf745c,'ticketId':_0x98b39f,'companyId':_0x2cc9c4,'queues':_0x329af5});return(0x0,SetTicketMessagesAsRead_1[_0x2ab982(0x233)])(_0x19b544),_0x242826[_0x2ab982(0x22a)]({'count':_0x2695ca,'messages':_0x55a1ba,'ticket':_0x19b544,'hasMore':_0x5b580c});};exports['index']=index;const store=async(_0x390789,_0x3c5c9d)=>{const _0x127b69=a26_0x3d8d9f,{ticketId:_0x579025}=_0x390789[_0x127b69(0x23b)],{body:_0x5838e4,quotedMsg:_0x41d83c,vCard:_0x11b235}=_0x390789[_0x127b69(0x1be)],_0x2c0aa3=_0x390789['files'],{companyId:_0x142243,id:_0xcd0aca}=_0x390789[_0x127b69(0x1ef)],_0x2fd447=await(0x0,ShowTicketService_1[_0x127b69(0x233)])(_0x579025,_0x142243);_0x2fd447[_0x127b69(0x211)]!==_0x127b69(0x21d)&&await(0x0,UpdateTicketService_1['default'])({'ticketId':_0x2fd447['id'],'ticketData':{'status':'open','userId':parseInt(_0xcd0aca)},'companyId':_0x142243});if(_0x2fd447[_0x127b69(0x1fb)]>0x0)(0x0,SetTicketMessagesAsRead_1[_0x127b69(0x233)])(_0x2fd447);if(_0x2c0aa3)await Promise['all'](_0x2c0aa3[_0x127b69(0x1c7)](async(_0x16ae96,_0x14fd3f)=>{return(0x0,SendWhatsAppMedia_1['default'])({'media':_0x16ae96,'ticket':_0x2fd447,'body':Array['isArray'](_0x5838e4)?_0x5838e4[_0x14fd3f]:_0x5838e4});}));else{const _0x33fbe6=await(0x0,SendWhatsAppMessage_1[_0x127b69(0x233)])({'body':_0x5838e4,'ticket':_0x2fd447,'quotedMsg':_0x41d83c,'vCard':_0x11b235});}return _0x3c5c9d[_0x127b69(0x20a)]();};exports[a26_0x3d8d9f(0x1f2)]=store;function a26_0x4d8d(_0x4d76ef,_0x3e797c){const _0x4ec07d=a26_0x3ea3();return a26_0x4d8d=function(_0xb55a36,_0x4472b2){_0xb55a36=_0xb55a36-0x1b2;let _0x3ea323=_0x4ec07d[_0xb55a36];return _0x3ea323;},a26_0x4d8d(_0x4d76ef,_0x3e797c);}const getAll=async(_0x2cadc5,_0x26acb8)=>{const _0x182e64=a26_0x3d8d9f,_0x2e66a4=_0x2cadc5['query'][_0x182e64(0x226)],_0x26ccfe=_0x2cadc5['query'][_0x182e64(0x1ee)],_0x494614=(0x0,validator_1[_0x182e64(0x219)])(_0x2cadc5[_0x182e64(0x213)]['fromMe']),{companyId:_0x291f09}=_0x2cadc5[_0x182e64(0x1ef)],{count:_0x435667}=await(0x0,ListAllMessagesService_1[_0x182e64(0x233)])({'companyId':_0x291f09,'fromMe':_0x494614,'dateStart':_0x2e66a4,'dateEnd':_0x26ccfe});return _0x26acb8[_0x182e64(0x22a)]({'count':_0x435667});};exports[a26_0x3d8d9f(0x1fa)]=getAll;const edit=async(_0x471f14,_0x526a9c)=>{const _0x520ee5=a26_0x3d8d9f,{messageId:_0x5df126}=_0x471f14[_0x520ee5(0x23b)],{companyId:_0x227b17}=_0x471f14['user'],{body:_0x1b637e}=_0x471f14[_0x520ee5(0x1be)],{ticketId:_0x32cfdb,message:_0x2779c3}=await(0x0,EditWhatsAppMessage_1[_0x520ee5(0x233)])({'messageId':_0x5df126,'companyId':_0x227b17,'body':_0x1b637e}),_0x52dac5=(0x0,socket_1[_0x520ee5(0x1c8)])();return _0x52dac5['to'](_0x32cfdb[_0x520ee5(0x1e9)]())[_0x520ee5(0x1c3)](_0x520ee5(0x1f3)+_0x227b17+_0x520ee5(0x1f1),{'action':_0x520ee5(0x1e8),'message':_0x2779c3}),_0x526a9c['send']();};exports[a26_0x3d8d9f(0x1c9)]=edit;const remove=async(_0x15455e,_0x3935cf)=>{const _0x432947=a26_0x3d8d9f,{messageId:_0x5074a0}=_0x15455e[_0x432947(0x23b)],{companyId:_0x23480f}=_0x15455e[_0x432947(0x1ef)],_0x20e795=await(0x0,DeleteWhatsAppMessage_1['default'])(_0x5074a0),_0x28c646=(0x0,socket_1[_0x432947(0x1c8)])();return _0x28c646['to'](_0x20e795[_0x432947(0x230)]['toString']())[_0x432947(0x1c3)]('company-'+_0x23480f+'-appMessage',{'action':'update','message':_0x20e795}),_0x3935cf[_0x432947(0x20a)]();};exports['remove']=remove;const typing=async(_0x4a9198,_0x2971f9)=>{const _0x2a949e=a26_0x3d8d9f,{ticketId:_0xee38c0}=_0x4a9198[_0x2a949e(0x23b)],{companyId:_0x5dd728}=_0x4a9198[_0x2a949e(0x1ef)],{status:_0x54b490}=_0x4a9198[_0x2a949e(0x213)];if(!_0xee38c0)return _0x2971f9[_0x2a949e(0x211)](0x190)[_0x2a949e(0x20a)](_0x2a949e(0x205));const _0x1294d1=await(0x0,ShowTicketService_1[_0x2a949e(0x233)])(_0xee38c0,_0x5dd728);if(!_0x1294d1)return _0x2971f9[_0x2a949e(0x211)](0x194)[_0x2a949e(0x20a)](_0x2a949e(0x225));let _0x22e5c1=(0x0,wbot_1[_0x2a949e(0x218)])(_0x1294d1[_0x2a949e(0x235)]);return _0x54b490=='true'?await(0x0,SendPresenceStatus_1[_0x2a949e(0x224)])(_0x22e5c1,_0x1294d1[_0x2a949e(0x241)][_0x2a949e(0x1bc)]+'@'+(_0x1294d1[_0x2a949e(0x1b3)]?'g.us':_0x2a949e(0x221))):await(0x0,SendPresenceStatus_1[_0x2a949e(0x1f8)])(_0x22e5c1,_0x1294d1['contact'][_0x2a949e(0x1bc)]+'@'+(_0x1294d1[_0x2a949e(0x1b3)]?_0x2a949e(0x244):_0x2a949e(0x221))),_0x2971f9['status'](0xc8)['send'](_0x2a949e(0x206)+_0x54b490+_0x2a949e(0x1ec));};exports['typing']=typing;const send=async(_0x6ac8a9,_0x3459ac)=>{const _0x3aa11f=a26_0x3d8d9f,{whatsappId:_0x425e23}=_0x6ac8a9['params'],_0x3717=_0x6ac8a9[_0x3aa11f(0x1be)],_0x121ef0=_0x6ac8a9[_0x3aa11f(0x1d4)];try{const _0x26a0d9=await Whatsapp_1[_0x3aa11f(0x233)][_0x3aa11f(0x1f5)](_0x425e23);if(!_0x26a0d9)throw new Error(_0x3aa11f(0x1bd));if(_0x3717[_0x3aa11f(0x1bc)]===undefined)throw new Error(_0x3aa11f(0x242));const _0x484704=_0x3717[_0x3aa11f(0x1bc)],_0x59902e=_0x3717['body'],_0x1fb775=_0x26a0d9[_0x3aa11f(0x21f)],_0x2a0e12=await(0x0,CheckNumber_1[_0x3aa11f(0x233)])(_0x484704,_0x1fb775);var _0x3da2cc=_0x2a0e12[_0x3aa11f(0x23e)]['includes'](_0x3aa11f(0x1cc));console[_0x3aa11f(0x236)](_0x3da2cc);const _0x284551=_0x2a0e12[_0x3aa11f(0x23e)][_0x3aa11f(0x208)]('@s.whatsapp.net','')[_0x3aa11f(0x208)]('@g.us',''),_0x3d418f={'name':''+_0x284551,'number':_0x284551,'isGroup':_0x3da2cc,'companyId':_0x1fb775},_0x4ea9a5=await(0x0,GetWhatsappWbot_1[_0x3aa11f(0x233)])(_0x26a0d9),_0x1b490c=await(0x0,CreateOrUpdateContactService_1[_0x3aa11f(0x233)])(_0x3d418f,_0x4ea9a5,_0x2a0e12[_0x3aa11f(0x23e)]),_0x3d9613=await(0x0,FindOrCreateTicketService_1[_0x3aa11f(0x233)])(_0x1b490c,_0x26a0d9['id'],0x0,_0x1fb775);return _0x121ef0?await Promise['all'](_0x121ef0[_0x3aa11f(0x1c7)](async _0x24c881=>{const _0x4adfde=_0x3aa11f;await _0x6ac8a9[_0x4adfde(0x1c1)][_0x4adfde(0x1d9)](_0x4adfde(0x1c5))[_0x4adfde(0x1d8)][_0x4adfde(0x22e)](_0x4adfde(0x1fe),{'whatsappId':_0x425e23,'data':{'number':_0x284551,'body':_0x59902e?(0x0,Mustache_1[_0x4adfde(0x233)])(_0x59902e,_0x3d9613):_0x24c881[_0x4adfde(0x1c4)],'mediaPath':_0x24c881[_0x4adfde(0x1b6)],'finalName':_0x24c881[_0x4adfde(0x203)],'fileName':_0x24c881[_0x4adfde(0x1c4)]}},{'removeOnComplete':!![],'attempts':0x3});})):await(0x0,SendWhatsAppMessage_1[_0x3aa11f(0x233)])({'body':(0x0,Mustache_1['default'])(_0x59902e,_0x3d9613),'ticket':_0x3d9613}),_0x3717['closeTicket']&&setTimeout(async()=>{const _0x5cc55c=_0x3aa11f;await(0x0,UpdateTicketService_1[_0x5cc55c(0x233)])({'ticketId':_0x3d9613['id'],'ticketData':{'status':'closed'},'companyId':_0x1fb775});},0x3e8),await(0x0,SetTicketMessagesAsRead_1['default'])(_0x3d9613),_0x3459ac['send']({'mensagem':'Mensagem\x20enviada'});}catch(_0x41e580){console[_0x3aa11f(0x236)](_0x41e580);if(Object[_0x3aa11f(0x1dd)](_0x41e580)['length']===0x0)throw new AppError_1[(_0x3aa11f(0x233))](_0x3aa11f(0x220));else throw new AppError_1[(_0x3aa11f(0x233))](_0x41e580[_0x3aa11f(0x1cf)]);}};exports[a26_0x3d8d9f(0x20a)]=send;const addReaction=async(_0x187b36,_0x95de0c)=>{const _0x5d5472=a26_0x3d8d9f;try{const {messageId:_0x25bd6f}=_0x187b36[_0x5d5472(0x23b)],{type:_0x4c01e8}=_0x187b36[_0x5d5472(0x1be)],{companyId:_0x4a965c,id:_0x23d5d1}=_0x187b36[_0x5d5472(0x1ef)],_0x4e8f8e=await Message_1[_0x5d5472(0x233)]['findByPk'](_0x25bd6f),_0x5b8cb7=await Ticket_1[_0x5d5472(0x233)][_0x5d5472(0x1f5)](_0x4e8f8e[_0x5d5472(0x230)],{'include':['contact']});if(!_0x4e8f8e)return _0x95de0c[_0x5d5472(0x211)](0x194)[_0x5d5472(0x20a)]({'message':_0x5d5472(0x1b9)});const _0x4647d6=await(0x0,SendWhatsAppReaction_1[_0x5d5472(0x233)])({'messageId':_0x25bd6f,'ticket':_0x5b8cb7,'reactionType':_0x4c01e8}),_0x520b49=await _0x4e8f8e[_0x5d5472(0x1e8)]({'reactions':[..._0x4e8f8e[_0x5d5472(0x21a)],{'type':_0x4c01e8,'userId':_0x23d5d1}]}),_0x394cea=(0x0,socket_1['getIO'])();return _0x394cea['to'](_0x4e8f8e[_0x5d5472(0x230)][_0x5d5472(0x1e9)]())[_0x5d5472(0x1c3)](_0x5d5472(0x1f3)+_0x4a965c+_0x5d5472(0x1f1),{'action':'update','message':_0x4e8f8e}),_0x95de0c[_0x5d5472(0x211)](0xc8)[_0x5d5472(0x20a)]({'message':_0x5d5472(0x1b4),'reactionResult':_0x4647d6,'reactions':_0x520b49[_0x5d5472(0x21a)]});}catch(_0x4cc71c){console[_0x5d5472(0x1e2)](_0x5d5472(0x234),_0x4cc71c);if(_0x4cc71c instanceof AppError_1[_0x5d5472(0x233)])return _0x95de0c[_0x5d5472(0x211)](0x190)[_0x5d5472(0x20a)]({'message':_0x4cc71c['message']});return _0x95de0c[_0x5d5472(0x211)](0x1f4)[_0x5d5472(0x20a)]({'message':_0x5d5472(0x1e7),'error':_0x4cc71c[_0x5d5472(0x1cf)]});}};exports[a26_0x3d8d9f(0x1eb)]=addReaction;const storeAudio=async(_0xc1d633,_0x5b792a)=>{const _0x4a72a7=a26_0x3d8d9f,_0x548f47=_0xc1d633['user'][_0x4a72a7(0x21f)],_0x1c065e=_0xc1d633[_0x4a72a7(0x1d0)];let _0x18be7b='';const _0x253249=generateRandomFilename(),_0x5a62a3='./public/company'+_0x548f47+'/'+_0x253249;return await convertToMp3(_0x1c065e['path'],_0x5a62a3),_0x1c065e&&(_0x18be7b=await(0x0,TranslateAudioService_1[_0x4a72a7(0x233)])(_0x5a62a3)),_0x5b792a['send'](_0x18be7b||_0x4a72a7(0x22c));};exports[a26_0x3d8d9f(0x1ba)]=storeAudio;function convertToMp3(_0x1c9198,_0x2ec211){return new Promise((_0x184385,_0x4e1eb1)=>{const _0xffd1ad=a26_0x4d8d;(0x0,fluent_ffmpeg_1[_0xffd1ad(0x233)])(_0x1c9198)[_0xffd1ad(0x1f9)](_0xffd1ad(0x1d2))['on'](_0xffd1ad(0x215),()=>{_0x184385(_0x2ec211);})['on']('error',_0x54e62a=>{const _0x5e4b9f=_0xffd1ad;console[_0x5e4b9f(0x1e2)](_0x5e4b9f(0x1b5),_0x54e62a),_0x4e1eb1(_0x54e62a);})[_0xffd1ad(0x1ce)](_0x2ec211);});}function generateRandomFilename(){const _0x298ecd=a26_0x3d8d9f,_0x3652db=crypto_1[_0x298ecd(0x233)]['randomBytes'](0x10)[_0x298ecd(0x1e9)](_0x298ecd(0x20e));return _0x3652db+_0x298ecd(0x23a);}const forwardMessage=async(_0x510fc2,_0x4f3d57)=>{const _0x1fb6eb=a26_0x3d8d9f;console[_0x1fb6eb(0x236)](_0x1fb6eb(0x229));const {body:_0x372ee1,quotedMsg:_0x4d6089}=_0x510fc2[_0x1fb6eb(0x1be)],_0x2e3990=_0x510fc2[_0x1fb6eb(0x1be)][_0x1fb6eb(0x1da)],_0x4b9179=_0x510fc2['body'][_0x1fb6eb(0x1e1)];if(!_0x2e3990||!_0x4b9179)return _0x4f3d57['status'](0xc8)[_0x1fb6eb(0x20a)](_0x1fb6eb(0x207));const _0x162958=await(0x0,ShowMessageService_1[_0x1fb6eb(0x233)])(_0x2e3990),_0x50ecc2=await(0x0,ShowContactService_1[_0x1fb6eb(0x22f)])(_0x4b9179);if(!_0x162958)return _0x4f3d57[_0x1fb6eb(0x211)](0x194)[_0x1fb6eb(0x20a)](_0x1fb6eb(0x1bb));if(!_0x50ecc2)return _0x4f3d57[_0x1fb6eb(0x211)](0x194)[_0x1fb6eb(0x20a)](_0x1fb6eb(0x1f0));const _0x5da75f=await(0x0,ShowMessageService_1[_0x1fb6eb(0x1b8)])(_0x162958);if(!_0x5da75f)return _0x4f3d57['status'](0x194)['send'](_0x1fb6eb(0x1cd));const _0x19086c=_0x510fc2['user'][_0x1fb6eb(0x21f)],_0x539f2a=await(0x0,FindOrCreateTicketService_1['default'])(_0x50ecc2,_0x5da75f,0x0,_0x19086c);await(0x0,SetTicketMessagesAsRead_1[_0x1fb6eb(0x233)])(_0x539f2a);_0x162958[_0x1fb6eb(0x1ff)]===_0x1fb6eb(0x1cb)||_0x162958[_0x1fb6eb(0x1ff)]===_0x1fb6eb(0x1e4)?await(0x0,SendWhatsAppMessage_1[_0x1fb6eb(0x233)])({'body':_0x162958[_0x1fb6eb(0x1be)],'ticket':_0x539f2a,'quotedMsg':_0x4d6089}):await(0x0,SendWhatsAppMedia_1[_0x1fb6eb(0x1e0)])(_0x162958[_0x1fb6eb(0x20c)]||'',_0x539f2a,_0x162958[_0x1fb6eb(0x1be)]);const _0x528de2=await(0x0,ShowUserService_1['default'])(_0x510fc2[_0x1fb6eb(0x1ef)]['id']),_0x5b6b79=await(0x0,user_1['firstQueueThisUser'])(_0x528de2);_0x539f2a[_0x1fb6eb(0x211)]='open',_0x539f2a[_0x1fb6eb(0x23d)]=_0x5b6b79?.['id']||null,_0x539f2a['userId']=_0x528de2['id'],_0x539f2a[_0x1fb6eb(0x1e3)]();const _0x41fd4c=(0x0,socket_1[_0x1fb6eb(0x1c8)])();return(0x0,UpdateTicketService_2[_0x1fb6eb(0x1d5)])(_0x41fd4c,_0x539f2a,_0x539f2a['id'],_0x19086c),_0x4f3d57[_0x1fb6eb(0x20a)]();};exports[a26_0x3d8d9f(0x200)]=forwardMessage;