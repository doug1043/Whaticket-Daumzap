const a26_0x8412fd=a26_0x33c1;(function(_0x138b87,_0x3b8994){const _0x1b267c=a26_0x33c1,_0x24593e=_0x138b87();while(!![]){try{const _0x633293=parseInt(_0x1b267c(0x1a8))/0x1+parseInt(_0x1b267c(0x16a))/0x2+parseInt(_0x1b267c(0x195))/0x3*(parseInt(_0x1b267c(0x19c))/0x4)+-parseInt(_0x1b267c(0x14d))/0x5+parseInt(_0x1b267c(0x168))/0x6+-parseInt(_0x1b267c(0x1ae))/0x7+parseInt(_0x1b267c(0x176))/0x8*(-parseInt(_0x1b267c(0x127))/0x9);if(_0x633293===_0x3b8994)break;else _0x24593e['push'](_0x24593e['shift']());}catch(_0x2edbd1){_0x24593e['push'](_0x24593e['shift']());}}}(a26_0x32ab,0x6ce59));const a26_0x3ce890=(function(){let _0x329cd9=!![];return function(_0x2f3db4,_0x5df96f){const _0x14aeea=_0x329cd9?function(){const _0xf6ffe5=a26_0x33c1;if(_0x5df96f){const _0x1a253d=_0x5df96f[_0xf6ffe5(0x197)](_0x2f3db4,arguments);return _0x5df96f=null,_0x1a253d;}}:function(){};return _0x329cd9=![],_0x14aeea;};}()),a26_0x2faa6e=a26_0x3ce890(this,function(){const _0x21b3b8=a26_0x33c1;return a26_0x2faa6e[_0x21b3b8(0x171)]()[_0x21b3b8(0x1a2)](_0x21b3b8(0x139))[_0x21b3b8(0x171)]()[_0x21b3b8(0x150)](a26_0x2faa6e)[_0x21b3b8(0x1a2)](_0x21b3b8(0x139));});a26_0x2faa6e();'use strict';var __createBinding=this&&this[a26_0x8412fd(0x18b)]||(Object[a26_0x8412fd(0x172)]?function(_0x126fa3,_0xcf0998,_0x254bc0,_0x192bd8){const _0x3855d5=a26_0x8412fd;if(_0x192bd8===undefined)_0x192bd8=_0x254bc0;var _0x4ba223=Object[_0x3855d5(0x153)](_0xcf0998,_0x254bc0);(!_0x4ba223||(_0x3855d5(0x18d)in _0x4ba223?!_0xcf0998[_0x3855d5(0x167)]:_0x4ba223[_0x3855d5(0x124)]||_0x4ba223['configurable']))&&(_0x4ba223={'enumerable':!![],'get':function(){return _0xcf0998[_0x254bc0];}}),Object[_0x3855d5(0x145)](_0x126fa3,_0x192bd8,_0x4ba223);}:function(_0xd22ab2,_0xe37c08,_0x9fec16,_0x47b78f){if(_0x47b78f===undefined)_0x47b78f=_0x9fec16;_0xd22ab2[_0x47b78f]=_0xe37c08[_0x9fec16];}),__setModuleDefault=this&&this[a26_0x8412fd(0x13d)]||(Object[a26_0x8412fd(0x172)]?function(_0x4c7177,_0x273aad){const _0x261c08=a26_0x8412fd;Object[_0x261c08(0x145)](_0x4c7177,_0x261c08(0x1a5),{'enumerable':!![],'value':_0x273aad});}:function(_0x56083d,_0x396ad2){const _0x395444=a26_0x8412fd;_0x56083d[_0x395444(0x1a5)]=_0x396ad2;}),__importStar=this&&this[a26_0x8412fd(0x189)]||function(_0x41d0c0){const _0x5d2162=a26_0x8412fd;if(_0x41d0c0&&_0x41d0c0['__esModule'])return _0x41d0c0;var _0x113f12={};if(_0x41d0c0!=null){for(var _0x5f38cc in _0x41d0c0)if(_0x5f38cc!=='default'&&Object[_0x5d2162(0x16d)][_0x5d2162(0x15e)][_0x5d2162(0x19f)](_0x41d0c0,_0x5f38cc))__createBinding(_0x113f12,_0x41d0c0,_0x5f38cc);}return __setModuleDefault(_0x113f12,_0x41d0c0),_0x113f12;},__importDefault=this&&this[a26_0x8412fd(0x18f)]||function(_0x4e6d45){return _0x4e6d45&&_0x4e6d45['__esModule']?_0x4e6d45:{'default':_0x4e6d45};};Object[a26_0x8412fd(0x145)](exports,a26_0x8412fd(0x167),{'value':!![]}),exports[a26_0x8412fd(0x147)]=exports[a26_0x8412fd(0x121)]=exports[a26_0x8412fd(0x183)]=exports[a26_0x8412fd(0x130)]=exports[a26_0x8412fd(0x134)]=exports[a26_0x8412fd(0x158)]=exports['edit']=exports['getAll']=exports[a26_0x8412fd(0x154)]=exports[a26_0x8412fd(0x14e)]=void 0x0;const AppError_1=__importDefault(require(a26_0x8412fd(0x17b))),SetTicketMessagesAsRead_1=__importDefault(require(a26_0x8412fd(0x162))),socket_1=require(a26_0x8412fd(0x1ac)),Message_1=__importDefault(require(a26_0x8412fd(0x13b))),Ticket_1=__importDefault(require(a26_0x8412fd(0x16e))),Queue_1=__importDefault(require(a26_0x8412fd(0x1ab))),User_1=__importDefault(require(a26_0x8412fd(0x15a))),Whatsapp_1=__importDefault(require(a26_0x8412fd(0x14c))),Mustache_1=__importDefault(require(a26_0x8412fd(0x12f))),ListMessagesService_1=__importDefault(require(a26_0x8412fd(0x159))),ShowTicketService_1=__importDefault(require(a26_0x8412fd(0x149))),FindOrCreateTicketService_1=__importDefault(require(a26_0x8412fd(0x177))),UpdateTicketService_1=__importDefault(require(a26_0x8412fd(0x1a3))),DeleteWhatsAppMessage_1=__importDefault(require(a26_0x8412fd(0x120))),SendWhatsAppMedia_1=__importStar(require(a26_0x8412fd(0x1a7))),SendWhatsAppMessage_1=__importDefault(require(a26_0x8412fd(0x17c))),SendWhatsAppReaction_1=__importDefault(require(a26_0x8412fd(0x163))),CheckNumber_1=__importDefault(require(a26_0x8412fd(0x148))),EditWhatsAppMessage_1=__importDefault(require('../services/WbotServices/EditWhatsAppMessage')),TranslateAudioService_1=__importDefault(require(a26_0x8412fd(0x1ad))),CreateOrUpdateContactService_1=__importDefault(require(a26_0x8412fd(0x1a4))),ShowMessageService_1=__importStar(require('../services/MessageServices/ShowMessageService')),ShowContactService_1=require('../services/ContactServices/ShowContactService'),ShowUserService_1=__importDefault(require('../services/UserServices/ShowUserService')),user_1=require('../utils/user'),UpdateTicketService_2=require(a26_0x8412fd(0x1a3)),ListAllMessagesService_1=__importDefault(require(a26_0x8412fd(0x1a6))),validator_1=require(a26_0x8412fd(0x12d)),ffmpeg_static_1=__importDefault(require(a26_0x8412fd(0x199))),fluent_ffmpeg_1=__importDefault(require('fluent-ffmpeg')),crypto_1=__importDefault(require(a26_0x8412fd(0x1a1))),GetWhatsappWbot_1=__importDefault(require(a26_0x8412fd(0x132))),wbot_1=require(a26_0x8412fd(0x135)),SendPresenceStatus_1=require('../helpers/SendPresenceStatus');function a26_0x32ab(){const _0x452d10=['\x20enviado\x20com\x20sucesso','constructor','update','path','getOwnPropertyDescriptor','store','queues','Erro\x20ao\x20adicionar\x20reação','message','remove','../services/MessageServices/ListMessagesService','../models/User','SendMessage','files','add','hasOwnProperty','status','SendWhatsAppMediaFileAddress','Não\x20foi\x20possível\x20realizar\x20a\x20operação','../helpers/SetTicketMessagesAsRead','../services/WbotServices/SendWhatsAppReaction','conversation','Contact\x20not\x20found','findByPk','__esModule','4246098JwItLb','randomBytes','1385500aDBBAz','jid','getIO','prototype','../models/Ticket','map','emit','toString','create','Transcrição\x20não\x20disponível','s.whatsapp.net','extendedTextMessage','15896NlWLbH','../services/TicketServices/FindOrCreateTicketService','g.us','query','O\x20número\x20é\x20obrigatório','../errors/AppError','../services/WbotServices/SendWhatsAppMessage','companyId','Message\x20not\x20found','Não\x20foi\x20possível\x20enviar\x20a\x20mensagem,\x20tente\x20novamente\x20em\x20alguns\x20instantes','number','includes','originalname','addReaction','SendPausedStatus','company-','dateStart','isArray','saveToFile','__importStar','open','__createBinding','contactId','get','@g.us','__importDefault','-appMessage','body','ShowContactService1','push','error','3KgWJEn','firstQueueThisUser','apply','setFfmpegPath','ffmpeg-static','./public/company','true','2871224VhtwsT','Erro\x20na\x20conversão\x20do\x20áudio:','isGroup','call','admin','crypto','search','../services/TicketServices/UpdateTicketService','../services/ContactServices/CreateOrUpdateContactService','default','../services/MessageServices/ListAllMessagesService','../services/WbotServices/SendWhatsAppMedia','68929RDqLiP','getAll','ticketId','../models/Queue','../libs/socket','../services/MessageServices/TranslateAudioService','3518550VjQKnO','contact','../services/WbotServices/DeleteWhatsAppMessage','storeAudio','hex','all','writable','forEach','whatsappId','5517EGxwfO','edit','toFormat','mp3','reactions','Reação\x20adicionada\x20com\x20sucesso!','validator','params','../helpers/Mustache','send','log','../helpers/GetWhatsappWbot','length','typing','../libs/wbot','Whatsapp\x20from\x20message\x20not\x20found','SendTypingStatus','mediaType','(((.+)+)+)+$','messageQueue','../models/Message','toBoolean','__setModuleDefault','user','Mensagem\x20não\x20encontrada','Ticket\x20not\x20found','getWbot','messageId','filename','@s.whatsapp.net','defineProperty','json','forwardMessage','../services/WbotServices/CheckNumber','../services/TicketServices/ShowTicketService','file','notifyUpdate','../models/Whatsapp','102230qWHhKT','index'];a26_0x32ab=function(){return _0x452d10;};return a26_0x32ab();}fluent_ffmpeg_1[a26_0x8412fd(0x1a5)][a26_0x8412fd(0x198)](ffmpeg_static_1[a26_0x8412fd(0x1a5)]);const index=async(_0x535340,_0x349ebc)=>{const _0x2fc51f=a26_0x8412fd,{ticketId:_0x4fca51}=_0x535340[_0x2fc51f(0x12e)],{pageNumber:_0x38a95d}=_0x535340[_0x2fc51f(0x179)],{companyId:_0x1d3c81,profile:_0x513d6c}=_0x535340['user'],_0x1a0359=[];if(_0x513d6c!==_0x2fc51f(0x1a0)){const _0x374dbd=await User_1[_0x2fc51f(0x1a5)]['findByPk'](_0x535340[_0x2fc51f(0x13e)]['id'],{'include':[{'model':Queue_1[_0x2fc51f(0x1a5)],'as':_0x2fc51f(0x155)}]});_0x374dbd[_0x2fc51f(0x155)][_0x2fc51f(0x125)](_0x4dcfcb=>{const _0x2a0f57=_0x2fc51f;_0x1a0359[_0x2a0f57(0x193)](_0x4dcfcb['id']);});}const {count:_0x38e4c9,messages:_0x402f68,ticket:_0x3b8c51,hasMore:_0x4af69d}=await(0x0,ListMessagesService_1[_0x2fc51f(0x1a5)])({'pageNumber':_0x38a95d,'ticketId':_0x4fca51,'companyId':_0x1d3c81,'queues':_0x1a0359});return(0x0,SetTicketMessagesAsRead_1[_0x2fc51f(0x1a5)])(_0x3b8c51),_0x349ebc['json']({'count':_0x38e4c9,'messages':_0x402f68,'ticket':_0x3b8c51,'hasMore':_0x4af69d});};exports[a26_0x8412fd(0x14e)]=index;const store=async(_0x130bd9,_0x5dd4d9)=>{const _0x14935e=a26_0x8412fd,{ticketId:_0x2eafe3}=_0x130bd9[_0x14935e(0x12e)],{body:_0x55bd60,quotedMsg:_0x434a14,vCard:_0x267c75}=_0x130bd9[_0x14935e(0x191)],_0x4fe710=_0x130bd9['files'],{companyId:_0x4efd78,id:_0x141c4d}=_0x130bd9['user'],_0x3f5366=await(0x0,ShowTicketService_1['default'])(_0x2eafe3,_0x4efd78);_0x3f5366['status']!==_0x14935e(0x18a)&&await(0x0,UpdateTicketService_1['default'])({'ticketId':_0x3f5366['id'],'ticketData':{'status':_0x14935e(0x18a),'userId':parseInt(_0x141c4d)},'companyId':_0x4efd78});if(_0x3f5366['unreadMessages']>0x0)(0x0,SetTicketMessagesAsRead_1['default'])(_0x3f5366);if(_0x4fe710)await Promise[_0x14935e(0x123)](_0x4fe710['map'](async(_0xb4a4d1,_0x367cb9)=>{const _0x35222e=_0x14935e;return(0x0,SendWhatsAppMedia_1[_0x35222e(0x1a5)])({'media':_0xb4a4d1,'ticket':_0x3f5366,'body':Array[_0x35222e(0x187)](_0x55bd60)?_0x55bd60[_0x367cb9]:_0x55bd60});}));else{const _0x34e994=await(0x0,SendWhatsAppMessage_1[_0x14935e(0x1a5)])({'body':_0x55bd60,'ticket':_0x3f5366,'quotedMsg':_0x434a14,'vCard':_0x267c75});}return _0x5dd4d9[_0x14935e(0x130)]();};exports['store']=store;const getAll=async(_0x592317,_0x43d37d)=>{const _0x1c598f=a26_0x8412fd,_0xf1c777=_0x592317[_0x1c598f(0x179)][_0x1c598f(0x186)],_0x1ed986=_0x592317['query']['dateEnd'],_0x368d57=(0x0,validator_1[_0x1c598f(0x13c)])(_0x592317['query']['fromMe']),{companyId:_0x3a6c91}=_0x592317[_0x1c598f(0x13e)],{count:_0x455cca}=await(0x0,ListAllMessagesService_1['default'])({'companyId':_0x3a6c91,'fromMe':_0x368d57,'dateStart':_0xf1c777,'dateEnd':_0x1ed986});return _0x43d37d[_0x1c598f(0x146)]({'count':_0x455cca});};exports[a26_0x8412fd(0x1a9)]=getAll;function a26_0x33c1(_0x1be927,_0x293721){const _0x567af5=a26_0x32ab();return a26_0x33c1=function(_0x2faa6e,_0x3ce890){_0x2faa6e=_0x2faa6e-0x120;let _0x32ab34=_0x567af5[_0x2faa6e];return _0x32ab34;},a26_0x33c1(_0x1be927,_0x293721);}const edit=async(_0x49c574,_0x91f49a)=>{const _0x4a7fc0=a26_0x8412fd,{messageId:_0x5b2bb8}=_0x49c574[_0x4a7fc0(0x12e)],{companyId:_0x5e5381}=_0x49c574[_0x4a7fc0(0x13e)],{body:_0x49f298}=_0x49c574[_0x4a7fc0(0x191)],{ticketId:_0x2b6705,message:_0x5eceaa}=await(0x0,EditWhatsAppMessage_1[_0x4a7fc0(0x1a5)])({'messageId':_0x5b2bb8,'companyId':_0x5e5381,'body':_0x49f298}),_0x3f23e7=(0x0,socket_1['getIO'])();return _0x3f23e7['to'](_0x2b6705[_0x4a7fc0(0x171)]())[_0x4a7fc0(0x170)](_0x4a7fc0(0x185)+_0x5e5381+_0x4a7fc0(0x190),{'action':_0x4a7fc0(0x151),'message':_0x5eceaa}),_0x91f49a[_0x4a7fc0(0x130)]();};exports[a26_0x8412fd(0x128)]=edit;const remove=async(_0x482c1c,_0xdd3699)=>{const _0x27f4c0=a26_0x8412fd,{messageId:_0xa3845e}=_0x482c1c['params'],{companyId:_0x2237fe}=_0x482c1c[_0x27f4c0(0x13e)],_0xb54114=await(0x0,DeleteWhatsAppMessage_1[_0x27f4c0(0x1a5)])(_0xa3845e),_0x62fc38=(0x0,socket_1['getIO'])();return _0x62fc38['to'](_0xb54114['ticketId'][_0x27f4c0(0x171)]())['emit'](_0x27f4c0(0x185)+_0x2237fe+_0x27f4c0(0x190),{'action':_0x27f4c0(0x151),'message':_0xb54114}),_0xdd3699['send']();};exports['remove']=remove;const typing=async(_0x991d0d,_0x4d91e7)=>{const _0xabf8e5=a26_0x8412fd,{ticketId:_0x2bf3ce}=_0x991d0d[_0xabf8e5(0x12e)],{companyId:_0x42a3d5}=_0x991d0d[_0xabf8e5(0x13e)],{status:_0x578d61}=_0x991d0d[_0xabf8e5(0x179)];if(!_0x2bf3ce)return _0x4d91e7[_0xabf8e5(0x15f)](0x190)['send']('TicketId\x20is\x20required');const _0x24c43e=await(0x0,ShowTicketService_1[_0xabf8e5(0x1a5)])(_0x2bf3ce,_0x42a3d5);if(!_0x24c43e)return _0x4d91e7[_0xabf8e5(0x15f)](0x194)['send'](_0xabf8e5(0x140));let _0x3784ab=(0x0,wbot_1[_0xabf8e5(0x141)])(_0x24c43e[_0xabf8e5(0x126)]);return _0x578d61==_0xabf8e5(0x19b)?await(0x0,SendPresenceStatus_1[_0xabf8e5(0x137)])(_0x3784ab,_0x24c43e[_0xabf8e5(0x1af)][_0xabf8e5(0x180)]+'@'+(_0x24c43e[_0xabf8e5(0x19e)]?'g.us':'s.whatsapp.net')):await(0x0,SendPresenceStatus_1[_0xabf8e5(0x184)])(_0x3784ab,_0x24c43e[_0xabf8e5(0x1af)][_0xabf8e5(0x180)]+'@'+(_0x24c43e['isGroup']?_0xabf8e5(0x178):_0xabf8e5(0x174))),_0x4d91e7['status'](0xc8)[_0xabf8e5(0x130)]('Status\x20'+_0x578d61+_0xabf8e5(0x14f));};exports[a26_0x8412fd(0x134)]=typing;const send=async(_0x51a5c5,_0xcd3041)=>{const _0x1cb430=a26_0x8412fd,{whatsappId:_0x9ee844}=_0x51a5c5[_0x1cb430(0x12e)],_0x2b7356=_0x51a5c5['body'],_0x5bcc0c=_0x51a5c5[_0x1cb430(0x15c)];try{const _0x56d0ac=await Whatsapp_1[_0x1cb430(0x1a5)][_0x1cb430(0x166)](_0x9ee844);if(!_0x56d0ac)throw new Error(_0x1cb430(0x161));if(_0x2b7356[_0x1cb430(0x180)]===undefined)throw new Error(_0x1cb430(0x17a));const _0xc70e2f=_0x2b7356[_0x1cb430(0x180)],_0x3e7f9b=_0x2b7356[_0x1cb430(0x191)],_0x246ff1=_0x56d0ac[_0x1cb430(0x17d)],_0x274459=await(0x0,CheckNumber_1[_0x1cb430(0x1a5)])(_0xc70e2f,_0x246ff1);var _0x22f565=_0x274459[_0x1cb430(0x16b)][_0x1cb430(0x181)](_0x1cb430(0x18e));console[_0x1cb430(0x131)](_0x22f565);const _0xf12144=_0x274459[_0x1cb430(0x16b)]['replace'](_0x1cb430(0x144),'')['replace'](_0x1cb430(0x18e),''),_0x5a4073={'name':''+_0xf12144,'number':_0xf12144,'isGroup':_0x22f565,'companyId':_0x246ff1},_0x18d511=await(0x0,GetWhatsappWbot_1[_0x1cb430(0x1a5)])(_0x56d0ac),_0x2fcdd2=await(0x0,CreateOrUpdateContactService_1[_0x1cb430(0x1a5)])(_0x5a4073,_0x18d511,_0x274459[_0x1cb430(0x16b)]),_0x39a9dc=await(0x0,FindOrCreateTicketService_1['default'])(_0x2fcdd2,_0x56d0ac['id'],0x0,_0x246ff1);return _0x5bcc0c?await Promise[_0x1cb430(0x123)](_0x5bcc0c[_0x1cb430(0x16f)](async _0x1b8a21=>{const _0x35f340=_0x1cb430;await _0x51a5c5['app'][_0x35f340(0x18d)](_0x35f340(0x155))[_0x35f340(0x13a)][_0x35f340(0x15d)](_0x35f340(0x15b),{'whatsappId':_0x9ee844,'data':{'number':_0xf12144,'body':_0x3e7f9b?(0x0,Mustache_1[_0x35f340(0x1a5)])(_0x3e7f9b,_0x39a9dc):_0x1b8a21[_0x35f340(0x182)],'mediaPath':_0x1b8a21[_0x35f340(0x152)],'finalName':_0x1b8a21[_0x35f340(0x143)],'fileName':_0x1b8a21[_0x35f340(0x182)]}},{'removeOnComplete':!![],'attempts':0x3});})):await(0x0,SendWhatsAppMessage_1['default'])({'body':(0x0,Mustache_1[_0x1cb430(0x1a5)])(_0x3e7f9b,_0x39a9dc),'ticket':_0x39a9dc}),_0x2b7356['closeTicket']&&setTimeout(async()=>{await(0x0,UpdateTicketService_1['default'])({'ticketId':_0x39a9dc['id'],'ticketData':{'status':'closed'},'companyId':_0x246ff1});},0x3e8),await(0x0,SetTicketMessagesAsRead_1[_0x1cb430(0x1a5)])(_0x39a9dc),_0xcd3041['send']({'mensagem':'Mensagem\x20enviada'});}catch(_0x4875b7){console[_0x1cb430(0x131)](_0x4875b7);if(Object['keys'](_0x4875b7)[_0x1cb430(0x133)]===0x0)throw new AppError_1[(_0x1cb430(0x1a5))](_0x1cb430(0x17f));else throw new AppError_1[(_0x1cb430(0x1a5))](_0x4875b7[_0x1cb430(0x157)]);}};exports[a26_0x8412fd(0x130)]=send;const addReaction=async(_0x2c02b1,_0x3ca056)=>{const _0x2a32c2=a26_0x8412fd;try{const {messageId:_0x1fc318}=_0x2c02b1[_0x2a32c2(0x12e)],{type:_0x1304e3}=_0x2c02b1[_0x2a32c2(0x191)],{companyId:_0x5b5e28,id:_0x197c0f}=_0x2c02b1[_0x2a32c2(0x13e)],_0x26488f=await Message_1[_0x2a32c2(0x1a5)][_0x2a32c2(0x166)](_0x1fc318),_0xfb1321=await Ticket_1['default'][_0x2a32c2(0x166)](_0x26488f[_0x2a32c2(0x1aa)],{'include':[_0x2a32c2(0x1af)]});if(!_0x26488f)return _0x3ca056[_0x2a32c2(0x15f)](0x194)[_0x2a32c2(0x130)]({'message':_0x2a32c2(0x13f)});const _0x3d06bf=await(0x0,SendWhatsAppReaction_1['default'])({'messageId':_0x1fc318,'ticket':_0xfb1321,'reactionType':_0x1304e3}),_0x7c53b8=await _0x26488f[_0x2a32c2(0x151)]({'reactions':[..._0x26488f[_0x2a32c2(0x12b)],{'type':_0x1304e3,'userId':_0x197c0f}]}),_0x44f67a=(0x0,socket_1[_0x2a32c2(0x16c)])();return _0x44f67a['to'](_0x26488f[_0x2a32c2(0x1aa)]['toString']())['emit'](_0x2a32c2(0x185)+_0x5b5e28+_0x2a32c2(0x190),{'action':'update','message':_0x26488f}),_0x3ca056['status'](0xc8)[_0x2a32c2(0x130)]({'message':_0x2a32c2(0x12c),'reactionResult':_0x3d06bf,'reactions':_0x7c53b8[_0x2a32c2(0x12b)]});}catch(_0x5e2086){console[_0x2a32c2(0x194)]('Erro\x20ao\x20adicionar\x20reação:',_0x5e2086);if(_0x5e2086 instanceof AppError_1[_0x2a32c2(0x1a5)])return _0x3ca056[_0x2a32c2(0x15f)](0x190)[_0x2a32c2(0x130)]({'message':_0x5e2086[_0x2a32c2(0x157)]});return _0x3ca056['status'](0x1f4)[_0x2a32c2(0x130)]({'message':_0x2a32c2(0x156),'error':_0x5e2086[_0x2a32c2(0x157)]});}};exports[a26_0x8412fd(0x183)]=addReaction;const storeAudio=async(_0x587b43,_0x2f557a)=>{const _0x2ec253=a26_0x8412fd,_0x11cfcf=_0x587b43[_0x2ec253(0x13e)]['companyId'],_0x21817a=_0x587b43[_0x2ec253(0x14a)];let _0x42a89d='';const _0x187114=generateRandomFilename(),_0xb9cbd1=_0x2ec253(0x19a)+_0x11cfcf+'/'+_0x187114;return await convertToMp3(_0x21817a[_0x2ec253(0x152)],_0xb9cbd1),_0x21817a&&(_0x42a89d=await(0x0,TranslateAudioService_1[_0x2ec253(0x1a5)])(_0xb9cbd1)),_0x2f557a[_0x2ec253(0x130)](_0x42a89d||_0x2ec253(0x173));};exports['storeAudio']=storeAudio;function convertToMp3(_0xd2418f,_0x1bbf74){return new Promise((_0x441bc9,_0xd1ffc5)=>{const _0x24ca11=a26_0x33c1;(0x0,fluent_ffmpeg_1['default'])(_0xd2418f)[_0x24ca11(0x129)](_0x24ca11(0x12a))['on']('end',()=>{_0x441bc9(_0x1bbf74);})['on'](_0x24ca11(0x194),_0x79110d=>{const _0x2d34e1=_0x24ca11;console[_0x2d34e1(0x194)](_0x2d34e1(0x19d),_0x79110d),_0xd1ffc5(_0x79110d);})[_0x24ca11(0x188)](_0x1bbf74);});}function generateRandomFilename(){const _0x461326=a26_0x8412fd,_0x3a7052=crypto_1[_0x461326(0x1a5)][_0x461326(0x169)](0x10)[_0x461326(0x171)](_0x461326(0x122));return _0x3a7052+'.mp3';}const forwardMessage=async(_0x5228a6,_0x4baec2)=>{const _0x275ad0=a26_0x8412fd;console['log']('>>>>>>>>>>>>>>>>>forwardMessage\x20X<<<<<<<<<<<<<<<<<<<');const {body:_0x8489bd,quotedMsg:_0x214084}=_0x5228a6[_0x275ad0(0x191)],_0xe2906c=_0x5228a6[_0x275ad0(0x191)][_0x275ad0(0x142)],_0x5429ba=_0x5228a6[_0x275ad0(0x191)][_0x275ad0(0x18c)];if(!_0xe2906c||!_0x5429ba)return _0x4baec2[_0x275ad0(0x15f)](0xc8)['send']('MessageId\x20or\x20ContactId\x20not\x20found');const _0x18c1f9=await(0x0,ShowMessageService_1[_0x275ad0(0x1a5)])(_0xe2906c),_0x4ed5cf=await(0x0,ShowContactService_1[_0x275ad0(0x192)])(_0x5429ba);if(!_0x18c1f9)return _0x4baec2[_0x275ad0(0x15f)](0x194)[_0x275ad0(0x130)](_0x275ad0(0x17e));if(!_0x4ed5cf)return _0x4baec2[_0x275ad0(0x15f)](0x194)[_0x275ad0(0x130)](_0x275ad0(0x165));const _0x558510=await(0x0,ShowMessageService_1['GetWhatsAppFromMessage'])(_0x18c1f9);if(!_0x558510)return _0x4baec2['status'](0x194)[_0x275ad0(0x130)](_0x275ad0(0x136));const _0x39ed4b=_0x5228a6[_0x275ad0(0x13e)][_0x275ad0(0x17d)],_0x8d8c5d=await(0x0,FindOrCreateTicketService_1['default'])(_0x4ed5cf,_0x558510,0x0,_0x39ed4b);await(0x0,SetTicketMessagesAsRead_1['default'])(_0x8d8c5d);_0x18c1f9[_0x275ad0(0x138)]===_0x275ad0(0x164)||_0x18c1f9[_0x275ad0(0x138)]===_0x275ad0(0x175)?await(0x0,SendWhatsAppMessage_1[_0x275ad0(0x1a5)])({'body':_0x18c1f9['body'],'ticket':_0x8d8c5d,'quotedMsg':_0x214084}):await(0x0,SendWhatsAppMedia_1[_0x275ad0(0x160)])(_0x18c1f9['mediaUrl']||'',_0x8d8c5d,_0x18c1f9[_0x275ad0(0x191)]);const _0x586085=await(0x0,ShowUserService_1['default'])(_0x5228a6[_0x275ad0(0x13e)]['id']),_0x130453=await(0x0,user_1[_0x275ad0(0x196)])(_0x586085);_0x8d8c5d['status']=_0x275ad0(0x18a),_0x8d8c5d['queueId']=_0x130453?.['id']||null,_0x8d8c5d['userId']=_0x586085['id'],_0x8d8c5d['save']();const _0x4c5520=(0x0,socket_1[_0x275ad0(0x16c)])();return(0x0,UpdateTicketService_2[_0x275ad0(0x14b)])(_0x4c5520,_0x8d8c5d,_0x8d8c5d['id'],_0x39ed4b),_0x4baec2['send']();};exports['forwardMessage']=forwardMessage;