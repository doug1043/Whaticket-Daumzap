const a26_0x15d17f=a26_0x135c;function a26_0x135c(_0x4e77a3,_0x18f581){const _0x1fe57e=a26_0x44b0();return a26_0x135c=function(_0x26692a,_0x2e5e40){_0x26692a=_0x26692a-0xb7;let _0x44b0bd=_0x1fe57e[_0x26692a];return _0x44b0bd;},a26_0x135c(_0x4e77a3,_0x18f581);}(function(_0x4d9274,_0x31ec6b){const _0x58dd57=a26_0x135c,_0x2e7046=_0x4d9274();while(!![]){try{const _0x30dca7=-parseInt(_0x58dd57(0x107))/0x1+parseInt(_0x58dd57(0xe1))/0x2+parseInt(_0x58dd57(0xee))/0x3+parseInt(_0x58dd57(0xe7))/0x4*(parseInt(_0x58dd57(0xcc))/0x5)+-parseInt(_0x58dd57(0xbe))/0x6+-parseInt(_0x58dd57(0x116))/0x7*(-parseInt(_0x58dd57(0x13b))/0x8)+-parseInt(_0x58dd57(0xdb))/0x9*(parseInt(_0x58dd57(0xb7))/0xa);if(_0x30dca7===_0x31ec6b)break;else _0x2e7046['push'](_0x2e7046['shift']());}catch(_0x197e10){_0x2e7046['push'](_0x2e7046['shift']());}}}(a26_0x44b0,0x4734a));const a26_0x2e5e40=(function(){let _0x56f7cf=!![];return function(_0x6904a5,_0x135139){const _0x28dba2=_0x56f7cf?function(){const _0x159436=a26_0x135c;if(_0x135139){const _0x95aba1=_0x135139[_0x159436(0x10e)](_0x6904a5,arguments);return _0x135139=null,_0x95aba1;}}:function(){};return _0x56f7cf=![],_0x28dba2;};}()),a26_0x26692a=a26_0x2e5e40(this,function(){const _0x74a1d4=a26_0x135c;return a26_0x26692a['toString']()[_0x74a1d4(0xfc)](_0x74a1d4(0xca))[_0x74a1d4(0xe9)]()['constructor'](a26_0x26692a)['search']('(((.+)+)+)+$');});a26_0x26692a();'use strict';var __createBinding=this&&this[a26_0x15d17f(0xc1)]||(Object[a26_0x15d17f(0x112)]?function(_0x55b1a9,_0x4c64e0,_0x27c851,_0x397f73){const _0x1b0a49=a26_0x15d17f;if(_0x397f73===undefined)_0x397f73=_0x27c851;var _0x2d8e2a=Object['getOwnPropertyDescriptor'](_0x4c64e0,_0x27c851);(!_0x2d8e2a||(_0x1b0a49(0x136)in _0x2d8e2a?!_0x4c64e0['__esModule']:_0x2d8e2a[_0x1b0a49(0xd8)]||_0x2d8e2a['configurable']))&&(_0x2d8e2a={'enumerable':!![],'get':function(){return _0x4c64e0[_0x27c851];}}),Object[_0x1b0a49(0xbb)](_0x55b1a9,_0x397f73,_0x2d8e2a);}:function(_0x526e4f,_0x1a7d6c,_0x34e7a4,_0xd7502b){if(_0xd7502b===undefined)_0xd7502b=_0x34e7a4;_0x526e4f[_0xd7502b]=_0x1a7d6c[_0x34e7a4];}),__setModuleDefault=this&&this[a26_0x15d17f(0xfa)]||(Object[a26_0x15d17f(0x112)]?function(_0xdd73e8,_0x39ca55){Object['defineProperty'](_0xdd73e8,'default',{'enumerable':!![],'value':_0x39ca55});}:function(_0x3098ac,_0x35a9de){const _0x12fc93=a26_0x15d17f;_0x3098ac[_0x12fc93(0x10a)]=_0x35a9de;}),__importStar=this&&this[a26_0x15d17f(0x13f)]||function(_0x1415e6){const _0x2271f9=a26_0x15d17f;if(_0x1415e6&&_0x1415e6[_0x2271f9(0x12b)])return _0x1415e6;var _0x41543b={};if(_0x1415e6!=null){for(var _0x42414c in _0x1415e6)if(_0x42414c!==_0x2271f9(0x10a)&&Object['prototype']['hasOwnProperty'][_0x2271f9(0xf7)](_0x1415e6,_0x42414c))__createBinding(_0x41543b,_0x1415e6,_0x42414c);}return __setModuleDefault(_0x41543b,_0x1415e6),_0x41543b;},__importDefault=this&&this['__importDefault']||function(_0x26a0ad){return _0x26a0ad&&_0x26a0ad['__esModule']?_0x26a0ad:{'default':_0x26a0ad};};Object[a26_0x15d17f(0xbb)](exports,a26_0x15d17f(0x12b),{'value':!![]}),exports[a26_0x15d17f(0x12f)]=exports['storeAudio']=exports[a26_0x15d17f(0x11e)]=exports[a26_0x15d17f(0x132)]=exports[a26_0x15d17f(0x115)]=exports[a26_0x15d17f(0x110)]=exports[a26_0x15d17f(0xd5)]=exports['getAll']=exports[a26_0x15d17f(0xdc)]=exports['index']=void 0x0;function a26_0x44b0(){const _0x1c74ed=['call','validator','Ticket\x20not\x20found','__setModuleDefault','length','search','@g.us','../models/Queue','../models/Ticket','SendTypingStatus','storeAudio','getIO','all','Erro\x20na\x20conversão\x20do\x20áudio:','GetWhatsAppFromMessage','../services/TicketServices/ShowTicketService','92943kVUYBX','whatsappId','TicketId\x20is\x20required','default','file','unreadMessages','contact','apply','SendPausedStatus','remove','index','create','conversation','s.whatsapp.net','typing','182JmRGJC','../helpers/Mustache','companyId','../services/ContactServices/ShowContactService','emit','Mensagem\x20enviada','../services/MessageServices/ShowMessageService','getWbot','addReaction','isGroup','Não\x20foi\x20possível\x20enviar\x20a\x20mensagem,\x20tente\x20novamente\x20em\x20alguns\x20instantes','Erro\x20ao\x20adicionar\x20reação','queues','closeTicket','setFfmpegPath','reactions','queueId','mediaType','notifyUpdate','isArray','path','__esModule','number','add','../services/MessageServices/ListAllMessagesService','forwardMessage','body','fluent-ffmpeg','send','Whatsapp\x20from\x20message\x20not\x20found','query','findByPk','get','originalname','fromMe','ticketId','replace','46296tHVlrZ','user','randomBytes','forEach','__importStar','4190YrWcVQ','push','../models/Whatsapp','hex','defineProperty','../libs/socket','../services/WbotServices/SendWhatsAppReaction','805008cslRfd','keys','json','__createBinding','../services/TicketServices/FindOrCreateTicketService','Transcrição\x20não\x20disponível','../services/WbotServices/SendWhatsAppMedia','toBoolean','userId','map','-appMessage','SendMessage','(((.+)+)+)+$','company-','1320670WgzAXX','../utils/user','params','contactId','status','ShowContactService1','Mensagem\x20não\x20encontrada','g.us','toFormat','edit','../models/User','../services/WbotServices/DeleteWhatsAppMessage','writable','files','../services/WbotServices/EditWhatsAppMessage','24219VSqodm','store','log','error','true','admin','803392Kllnah','SendWhatsAppMediaFileAddress','Status\x20','.mp3','Não\x20foi\x20possível\x20realizar\x20a\x20operação','\x20enviado\x20com\x20sucesso','8iTUSby','jid','toString','../services/UserServices/ShowUserService','update','MessageId\x20or\x20ContactId\x20not\x20found','../services/WbotServices/SendWhatsAppMessage','1697616wMOgJw','Message\x20not\x20found','getAll','mp3','@s.whatsapp.net','../services/ContactServices/CreateOrUpdateContactService','open','../services/TicketServices/UpdateTicketService','crypto'];a26_0x44b0=function(){return _0x1c74ed;};return a26_0x44b0();}const AppError_1=__importDefault(require('../errors/AppError')),SetTicketMessagesAsRead_1=__importDefault(require('../helpers/SetTicketMessagesAsRead')),socket_1=require(a26_0x15d17f(0xbc)),Message_1=__importDefault(require('../models/Message')),Ticket_1=__importDefault(require(a26_0x15d17f(0xff))),Queue_1=__importDefault(require(a26_0x15d17f(0xfe))),User_1=__importDefault(require(a26_0x15d17f(0xd6))),Whatsapp_1=__importDefault(require(a26_0x15d17f(0xb9))),Mustache_1=__importDefault(require(a26_0x15d17f(0x117))),ListMessagesService_1=__importDefault(require('../services/MessageServices/ListMessagesService')),ShowTicketService_1=__importDefault(require(a26_0x15d17f(0x106))),FindOrCreateTicketService_1=__importDefault(require(a26_0x15d17f(0xc2))),UpdateTicketService_1=__importDefault(require(a26_0x15d17f(0xf5))),DeleteWhatsAppMessage_1=__importDefault(require(a26_0x15d17f(0xd7))),SendWhatsAppMedia_1=__importStar(require(a26_0x15d17f(0xc4))),SendWhatsAppMessage_1=__importDefault(require(a26_0x15d17f(0xed))),SendWhatsAppReaction_1=__importDefault(require(a26_0x15d17f(0xbd))),CheckNumber_1=__importDefault(require('../services/WbotServices/CheckNumber')),EditWhatsAppMessage_1=__importDefault(require(a26_0x15d17f(0xda))),TranslateAudioService_1=__importDefault(require('../services/MessageServices/TranslateAudioService')),CreateOrUpdateContactService_1=__importDefault(require(a26_0x15d17f(0xf3))),ShowMessageService_1=__importStar(require(a26_0x15d17f(0x11c))),ShowContactService_1=require(a26_0x15d17f(0x119)),ShowUserService_1=__importDefault(require(a26_0x15d17f(0xea))),user_1=require(a26_0x15d17f(0xcd)),UpdateTicketService_2=require(a26_0x15d17f(0xf5)),ListAllMessagesService_1=__importDefault(require(a26_0x15d17f(0x12e))),validator_1=require(a26_0x15d17f(0xf8)),ffmpeg_static_1=__importDefault(require('ffmpeg-static')),fluent_ffmpeg_1=__importDefault(require(a26_0x15d17f(0x131))),crypto_1=__importDefault(require(a26_0x15d17f(0xf6))),GetWhatsappWbot_1=__importDefault(require('../helpers/GetWhatsappWbot')),wbot_1=require('../libs/wbot'),SendPresenceStatus_1=require('../helpers/SendPresenceStatus');fluent_ffmpeg_1['default'][a26_0x15d17f(0x124)](ffmpeg_static_1[a26_0x15d17f(0x10a)]);const index=async(_0x463f7c,_0x449040)=>{const _0x3d207e=a26_0x15d17f,{ticketId:_0x5ecfa5}=_0x463f7c[_0x3d207e(0xce)],{pageNumber:_0x1b33ff}=_0x463f7c[_0x3d207e(0x134)],{companyId:_0x181afc,profile:_0x3a47a5}=_0x463f7c[_0x3d207e(0x13c)],_0x6a06ca=[];if(_0x3a47a5!==_0x3d207e(0xe0)){const _0xdf2952=await User_1[_0x3d207e(0x10a)][_0x3d207e(0x135)](_0x463f7c['user']['id'],{'include':[{'model':Queue_1[_0x3d207e(0x10a)],'as':_0x3d207e(0x122)}]});_0xdf2952[_0x3d207e(0x122)][_0x3d207e(0x13e)](_0x2b522c=>{const _0x3a5195=_0x3d207e;_0x6a06ca[_0x3a5195(0xb8)](_0x2b522c['id']);});}const {count:_0x422bf1,messages:_0x23aa20,ticket:_0x81e63f,hasMore:_0x380f7e}=await(0x0,ListMessagesService_1[_0x3d207e(0x10a)])({'pageNumber':_0x1b33ff,'ticketId':_0x5ecfa5,'companyId':_0x181afc,'queues':_0x6a06ca});return(0x0,SetTicketMessagesAsRead_1[_0x3d207e(0x10a)])(_0x81e63f),_0x449040[_0x3d207e(0xc0)]({'count':_0x422bf1,'messages':_0x23aa20,'ticket':_0x81e63f,'hasMore':_0x380f7e});};exports[a26_0x15d17f(0x111)]=index;const store=async(_0x117b23,_0x4669d6)=>{const _0x122616=a26_0x15d17f,{ticketId:_0x3fae48}=_0x117b23['params'],{body:_0x525984,quotedMsg:_0x3cee48,vCard:_0x17a22b}=_0x117b23['body'],_0x4e3ada=_0x117b23['files'],{companyId:_0x5b8827,id:_0x50d027}=_0x117b23['user'],_0x43e613=await(0x0,ShowTicketService_1[_0x122616(0x10a)])(_0x3fae48,_0x5b8827);_0x43e613[_0x122616(0xd0)]!==_0x122616(0xf4)&&await(0x0,UpdateTicketService_1['default'])({'ticketId':_0x43e613['id'],'ticketData':{'status':_0x122616(0xf4),'userId':parseInt(_0x50d027)},'companyId':_0x5b8827});if(_0x43e613[_0x122616(0x10c)]>0x0)(0x0,SetTicketMessagesAsRead_1[_0x122616(0x10a)])(_0x43e613);if(_0x4e3ada)await Promise['all'](_0x4e3ada['map'](async(_0x4cf0d8,_0x37c463)=>{const _0x2aab9a=_0x122616;return(0x0,SendWhatsAppMedia_1[_0x2aab9a(0x10a)])({'media':_0x4cf0d8,'ticket':_0x43e613,'body':Array[_0x2aab9a(0x129)](_0x525984)?_0x525984[_0x37c463]:_0x525984});}));else{const _0x3ac35b=await(0x0,SendWhatsAppMessage_1[_0x122616(0x10a)])({'body':_0x525984,'ticket':_0x43e613,'quotedMsg':_0x3cee48,'vCard':_0x17a22b});}return _0x4669d6['send']();};exports[a26_0x15d17f(0xdc)]=store;const getAll=async(_0x4d318d,_0x477372)=>{const _0x1db682=a26_0x15d17f,_0x325d55=_0x4d318d[_0x1db682(0x134)]['dateStart'],_0x316d8c=_0x4d318d['query']['dateEnd'],_0x1f4945=(0x0,validator_1[_0x1db682(0xc5)])(_0x4d318d[_0x1db682(0x134)][_0x1db682(0x138)]),{companyId:_0x38aa1c}=_0x4d318d[_0x1db682(0x13c)],{count:_0x1ebfa7}=await(0x0,ListAllMessagesService_1['default'])({'companyId':_0x38aa1c,'fromMe':_0x1f4945,'dateStart':_0x325d55,'dateEnd':_0x316d8c});return _0x477372[_0x1db682(0xc0)]({'count':_0x1ebfa7});};exports[a26_0x15d17f(0xf0)]=getAll;const edit=async(_0x1b5097,_0x3fb908)=>{const _0x26a0ed=a26_0x15d17f,{messageId:_0x483e4e}=_0x1b5097[_0x26a0ed(0xce)],{companyId:_0x1fed10}=_0x1b5097[_0x26a0ed(0x13c)],{body:_0x407f9e}=_0x1b5097[_0x26a0ed(0x130)],{ticketId:_0x1c1f6b,message:_0x509086}=await(0x0,EditWhatsAppMessage_1['default'])({'messageId':_0x483e4e,'companyId':_0x1fed10,'body':_0x407f9e}),_0x2b7ad0=(0x0,socket_1[_0x26a0ed(0x102)])();return _0x2b7ad0['to'](_0x1c1f6b['toString']())[_0x26a0ed(0x11a)](_0x26a0ed(0xcb)+_0x1fed10+_0x26a0ed(0xc8),{'action':_0x26a0ed(0xeb),'message':_0x509086}),_0x3fb908[_0x26a0ed(0x132)]();};exports[a26_0x15d17f(0xd5)]=edit;const remove=async(_0x121858,_0x3fc69f)=>{const _0x3baa87=a26_0x15d17f,{messageId:_0x380aa1}=_0x121858[_0x3baa87(0xce)],{companyId:_0x4bcc8f}=_0x121858[_0x3baa87(0x13c)],_0x4a7793=await(0x0,DeleteWhatsAppMessage_1[_0x3baa87(0x10a)])(_0x380aa1),_0xf624e5=(0x0,socket_1[_0x3baa87(0x102)])();return _0xf624e5['to'](_0x4a7793[_0x3baa87(0x139)]['toString']())[_0x3baa87(0x11a)](_0x3baa87(0xcb)+_0x4bcc8f+_0x3baa87(0xc8),{'action':_0x3baa87(0xeb),'message':_0x4a7793}),_0x3fc69f[_0x3baa87(0x132)]();};exports[a26_0x15d17f(0x110)]=remove;const typing=async(_0x2b1f99,_0x5ce525)=>{const _0x22cc88=a26_0x15d17f,{ticketId:_0x1cd513}=_0x2b1f99[_0x22cc88(0xce)],{companyId:_0x16eba2}=_0x2b1f99[_0x22cc88(0x13c)],{status:_0xe1f748}=_0x2b1f99[_0x22cc88(0x134)];if(!_0x1cd513)return _0x5ce525[_0x22cc88(0xd0)](0x190)[_0x22cc88(0x132)](_0x22cc88(0x109));const _0x120dc6=await(0x0,ShowTicketService_1[_0x22cc88(0x10a)])(_0x1cd513,_0x16eba2);if(!_0x120dc6)return _0x5ce525['status'](0x194)[_0x22cc88(0x132)](_0x22cc88(0xf9));let _0x4631fd=(0x0,wbot_1[_0x22cc88(0x11d)])(_0x120dc6[_0x22cc88(0x108)]);return _0xe1f748==_0x22cc88(0xdf)?await(0x0,SendPresenceStatus_1[_0x22cc88(0x100)])(_0x4631fd,_0x120dc6[_0x22cc88(0x10d)][_0x22cc88(0x12c)]+'@'+(_0x120dc6[_0x22cc88(0x11f)]?_0x22cc88(0xd3):'s.whatsapp.net')):await(0x0,SendPresenceStatus_1[_0x22cc88(0x10f)])(_0x4631fd,_0x120dc6['contact']['number']+'@'+(_0x120dc6[_0x22cc88(0x11f)]?_0x22cc88(0xd3):_0x22cc88(0x114))),_0x5ce525[_0x22cc88(0xd0)](0xc8)[_0x22cc88(0x132)](_0x22cc88(0xe3)+_0xe1f748+_0x22cc88(0xe6));};exports[a26_0x15d17f(0x115)]=typing;const send=async(_0x4d6152,_0x2515b0)=>{const _0x217a7b=a26_0x15d17f,{whatsappId:_0x59d093}=_0x4d6152['params'],_0x18c4bd=_0x4d6152[_0x217a7b(0x130)],_0x5aa244=_0x4d6152[_0x217a7b(0xd9)];try{const _0x447f72=await Whatsapp_1[_0x217a7b(0x10a)][_0x217a7b(0x135)](_0x59d093);if(!_0x447f72)throw new Error(_0x217a7b(0xe5));if(_0x18c4bd[_0x217a7b(0x12c)]===undefined)throw new Error('O\x20número\x20é\x20obrigatório');const _0x3030ce=_0x18c4bd[_0x217a7b(0x12c)],_0x5bde58=_0x18c4bd[_0x217a7b(0x130)],_0x3bb4f1=_0x447f72[_0x217a7b(0x118)],_0x262684=await(0x0,CheckNumber_1[_0x217a7b(0x10a)])(_0x3030ce,_0x3bb4f1);var _0x108bba=_0x262684[_0x217a7b(0xe8)]['includes'](_0x217a7b(0xfd));console[_0x217a7b(0xdd)](_0x108bba);const _0x4aeda7=_0x262684['jid'][_0x217a7b(0x13a)](_0x217a7b(0xf2),'')[_0x217a7b(0x13a)]('@g.us',''),_0x3838af={'name':''+_0x4aeda7,'number':_0x4aeda7,'isGroup':_0x108bba,'companyId':_0x3bb4f1},_0x75b3d2=await(0x0,GetWhatsappWbot_1[_0x217a7b(0x10a)])(_0x447f72),_0x228528=await(0x0,CreateOrUpdateContactService_1[_0x217a7b(0x10a)])(_0x3838af,_0x75b3d2,_0x262684[_0x217a7b(0xe8)]),_0x2d7c5c=await(0x0,FindOrCreateTicketService_1[_0x217a7b(0x10a)])(_0x228528,_0x447f72['id'],0x0,_0x3bb4f1);return _0x5aa244?await Promise[_0x217a7b(0x103)](_0x5aa244[_0x217a7b(0xc7)](async _0x3cf6e5=>{const _0x56b039=_0x217a7b;await _0x4d6152['app'][_0x56b039(0x136)](_0x56b039(0x122))['messageQueue'][_0x56b039(0x12d)](_0x56b039(0xc9),{'whatsappId':_0x59d093,'data':{'number':_0x4aeda7,'body':_0x5bde58?(0x0,Mustache_1[_0x56b039(0x10a)])(_0x5bde58,_0x2d7c5c):_0x3cf6e5[_0x56b039(0x137)],'mediaPath':_0x3cf6e5[_0x56b039(0x12a)],'finalName':_0x3cf6e5['filename'],'fileName':_0x3cf6e5['originalname']}},{'removeOnComplete':!![],'attempts':0x3});})):await(0x0,SendWhatsAppMessage_1[_0x217a7b(0x10a)])({'body':(0x0,Mustache_1[_0x217a7b(0x10a)])(_0x5bde58,_0x2d7c5c),'ticket':_0x2d7c5c}),_0x18c4bd[_0x217a7b(0x123)]&&setTimeout(async()=>{const _0xb46f35=_0x217a7b;await(0x0,UpdateTicketService_1[_0xb46f35(0x10a)])({'ticketId':_0x2d7c5c['id'],'ticketData':{'status':'closed'},'companyId':_0x3bb4f1});},0x3e8),await(0x0,SetTicketMessagesAsRead_1[_0x217a7b(0x10a)])(_0x2d7c5c),_0x2515b0['send']({'mensagem':_0x217a7b(0x11b)});}catch(_0x3c0fa5){console['log'](_0x3c0fa5);if(Object[_0x217a7b(0xbf)](_0x3c0fa5)[_0x217a7b(0xfb)]===0x0)throw new AppError_1[(_0x217a7b(0x10a))](_0x217a7b(0x120));else throw new AppError_1[(_0x217a7b(0x10a))](_0x3c0fa5['message']);}};exports['send']=send;const addReaction=async(_0x125e1f,_0x44d6f5)=>{const _0x2b5340=a26_0x15d17f;try{const {messageId:_0x53882c}=_0x125e1f[_0x2b5340(0xce)],{type:_0x6d9a2a}=_0x125e1f[_0x2b5340(0x130)],{companyId:_0x36c155,id:_0x155e3c}=_0x125e1f[_0x2b5340(0x13c)],_0x20b070=await Message_1[_0x2b5340(0x10a)][_0x2b5340(0x135)](_0x53882c),_0x518f44=await Ticket_1[_0x2b5340(0x10a)][_0x2b5340(0x135)](_0x20b070['ticketId'],{'include':[_0x2b5340(0x10d)]});if(!_0x20b070)return _0x44d6f5[_0x2b5340(0xd0)](0x194)['send']({'message':_0x2b5340(0xd2)});const _0x34701a=await(0x0,SendWhatsAppReaction_1['default'])({'messageId':_0x53882c,'ticket':_0x518f44,'reactionType':_0x6d9a2a}),_0x273dda=await _0x20b070['update']({'reactions':[..._0x20b070[_0x2b5340(0x125)],{'type':_0x6d9a2a,'userId':_0x155e3c}]}),_0x146f8b=(0x0,socket_1[_0x2b5340(0x102)])();return _0x146f8b['to'](_0x20b070['ticketId'][_0x2b5340(0xe9)]())[_0x2b5340(0x11a)]('company-'+_0x36c155+_0x2b5340(0xc8),{'action':'update','message':_0x20b070}),_0x44d6f5['status'](0xc8)['send']({'message':'Reação\x20adicionada\x20com\x20sucesso!','reactionResult':_0x34701a,'reactions':_0x273dda['reactions']});}catch(_0x4df440){console[_0x2b5340(0xde)]('Erro\x20ao\x20adicionar\x20reação:',_0x4df440);if(_0x4df440 instanceof AppError_1[_0x2b5340(0x10a)])return _0x44d6f5[_0x2b5340(0xd0)](0x190)[_0x2b5340(0x132)]({'message':_0x4df440['message']});return _0x44d6f5['status'](0x1f4)[_0x2b5340(0x132)]({'message':_0x2b5340(0x121),'error':_0x4df440['message']});}};exports[a26_0x15d17f(0x11e)]=addReaction;const storeAudio=async(_0x61ce21,_0xb5e82e)=>{const _0x2dfa5f=a26_0x15d17f,_0x6f73a9=_0x61ce21[_0x2dfa5f(0x13c)][_0x2dfa5f(0x118)],_0x355bc0=_0x61ce21[_0x2dfa5f(0x10b)];let _0x405047='';const _0x151338=generateRandomFilename(),_0x4c17d1='./public/company'+_0x6f73a9+'/'+_0x151338;return await convertToMp3(_0x355bc0['path'],_0x4c17d1),_0x355bc0&&(_0x405047=await(0x0,TranslateAudioService_1[_0x2dfa5f(0x10a)])(_0x4c17d1)),_0xb5e82e[_0x2dfa5f(0x132)](_0x405047||_0x2dfa5f(0xc3));};exports[a26_0x15d17f(0x101)]=storeAudio;function convertToMp3(_0x1f670a,_0xb877ba){return new Promise((_0x77039,_0x12e311)=>{const _0x471b23=a26_0x135c;(0x0,fluent_ffmpeg_1[_0x471b23(0x10a)])(_0x1f670a)[_0x471b23(0xd4)](_0x471b23(0xf1))['on']('end',()=>{_0x77039(_0xb877ba);})['on']('error',_0x4f67a9=>{const _0x46bc11=_0x471b23;console[_0x46bc11(0xde)](_0x46bc11(0x104),_0x4f67a9),_0x12e311(_0x4f67a9);})['saveToFile'](_0xb877ba);});}function generateRandomFilename(){const _0x5e2bdf=a26_0x15d17f,_0x3ac07e=crypto_1[_0x5e2bdf(0x10a)][_0x5e2bdf(0x13d)](0x10)[_0x5e2bdf(0xe9)](_0x5e2bdf(0xba));return _0x3ac07e+_0x5e2bdf(0xe4);}const forwardMessage=async(_0x2bf6f8,_0x4ee603)=>{const _0x159891=a26_0x15d17f;console[_0x159891(0xdd)]('>>>>>>>>>>>>>>>>>forwardMessage\x20X<<<<<<<<<<<<<<<<<<<');const {body:_0x245d56,quotedMsg:_0x364c41}=_0x2bf6f8[_0x159891(0x130)],_0x5a82f7=_0x2bf6f8[_0x159891(0x130)]['messageId'],_0x2bd4ac=_0x2bf6f8[_0x159891(0x130)][_0x159891(0xcf)];if(!_0x5a82f7||!_0x2bd4ac)return _0x4ee603['status'](0xc8)[_0x159891(0x132)](_0x159891(0xec));const _0x28fcc7=await(0x0,ShowMessageService_1[_0x159891(0x10a)])(_0x5a82f7),_0x3bb35d=await(0x0,ShowContactService_1[_0x159891(0xd1)])(_0x2bd4ac);if(!_0x28fcc7)return _0x4ee603[_0x159891(0xd0)](0x194)[_0x159891(0x132)](_0x159891(0xef));if(!_0x3bb35d)return _0x4ee603[_0x159891(0xd0)](0x194)['send']('Contact\x20not\x20found');const _0x58a24b=await(0x0,ShowMessageService_1[_0x159891(0x105)])(_0x28fcc7);if(!_0x58a24b)return _0x4ee603[_0x159891(0xd0)](0x194)['send'](_0x159891(0x133));const _0x303433=_0x2bf6f8[_0x159891(0x13c)][_0x159891(0x118)],_0x93f2ab=await(0x0,FindOrCreateTicketService_1['default'])(_0x3bb35d,_0x58a24b,0x0,_0x303433);await(0x0,SetTicketMessagesAsRead_1[_0x159891(0x10a)])(_0x93f2ab);_0x28fcc7[_0x159891(0x127)]===_0x159891(0x113)||_0x28fcc7[_0x159891(0x127)]==='extendedTextMessage'?await(0x0,SendWhatsAppMessage_1[_0x159891(0x10a)])({'body':_0x28fcc7[_0x159891(0x130)],'ticket':_0x93f2ab,'quotedMsg':_0x364c41}):await(0x0,SendWhatsAppMedia_1[_0x159891(0xe2)])(_0x28fcc7['mediaUrl']||'',_0x93f2ab,_0x28fcc7['body']);const _0x4a7440=await(0x0,ShowUserService_1[_0x159891(0x10a)])(_0x2bf6f8[_0x159891(0x13c)]['id']),_0x2a6ddb=await(0x0,user_1['firstQueueThisUser'])(_0x4a7440);_0x93f2ab[_0x159891(0xd0)]=_0x159891(0xf4),_0x93f2ab[_0x159891(0x126)]=_0x2a6ddb?.['id']||null,_0x93f2ab[_0x159891(0xc6)]=_0x4a7440['id'],_0x93f2ab['save']();const _0x35578b=(0x0,socket_1['getIO'])();return(0x0,UpdateTicketService_2[_0x159891(0x128)])(_0x35578b,_0x93f2ab,_0x93f2ab['id'],_0x303433),_0x4ee603['send']();};exports[a26_0x15d17f(0x12f)]=forwardMessage;