const a26_0x4e4dd6=a26_0x2098;(function(_0x88f9ed,_0xfb414){const _0x1c519c=a26_0x2098,_0x4be661=_0x88f9ed();while(!![]){try{const _0x3e8521=parseInt(_0x1c519c(0x161))/0x1+-parseInt(_0x1c519c(0x11f))/0x2+parseInt(_0x1c519c(0x14e))/0x3*(-parseInt(_0x1c519c(0xe7))/0x4)+-parseInt(_0x1c519c(0x12e))/0x5*(-parseInt(_0x1c519c(0x10f))/0x6)+parseInt(_0x1c519c(0x139))/0x7*(-parseInt(_0x1c519c(0x10a))/0x8)+-parseInt(_0x1c519c(0xe8))/0x9+parseInt(_0x1c519c(0x13d))/0xa;if(_0x3e8521===_0xfb414)break;else _0x4be661['push'](_0x4be661['shift']());}catch(_0x183ec6){_0x4be661['push'](_0x4be661['shift']());}}}(a26_0x49f2,0xa4e49));function a26_0x49f2(){const _0x3dc91d=['message','../services/MessageServices/ShowMessageService','number','../models/User','keys','MessageId\x20or\x20ContactId\x20not\x20found','params','../services/TicketServices/UpdateTicketService','ffmpeg-static','298868csASvE','344484pGwUbZ','companyId','company-','../services/WbotServices/DeleteWhatsAppMessage','SendWhatsAppMediaFileAddress','@s.whatsapp.net','all','Reação\x20adicionada\x20com\x20sucesso!','replace','index','Não\x20foi\x20possível\x20enviar\x20a\x20mensagem,\x20tente\x20novamente\x20em\x20alguns\x20instantes','O\x20número\x20é\x20obrigatório','whatsappId','isArray','Status\x20','./public/company','ticketId','default','edit','store','body','../libs/socket','__setModuleDefault','remove','../errors/AppError','storeAudio','setFfmpegPath','Mensagem\x20não\x20encontrada','search','includes','firstQueueThisUser','../services/MessageServices/ListMessagesService','@g.us','__importStar','5406888mNxKib','path','writable','-appMessage','send','18mcWyKT','contactId','true','.mp3','apply','Erro\x20ao\x20adicionar\x20reação','push','status','prototype','addReaction','messageQueue','../services/TicketServices/FindOrCreateTicketService','(((.+)+)+)+$','query','getAll','isGroup','879032dZDMRh','SendTypingStatus','originalname','userId','closed','Whatsapp\x20from\x20message\x20not\x20found','../services/ContactServices/ShowContactService','jid','g.us','randomBytes','../services/TicketServices/ShowTicketService','SendMessage','hasOwnProperty','__esModule','../services/WbotServices/SendWhatsAppReaction','1873995glMBAX','../services/MessageServices/TranslateAudioService','closeTicket','../services/WbotServices/SendWhatsAppMessage','end','mediaUrl','__createBinding','../services/WbotServices/CheckNumber','admin','toBoolean','../services/WbotServices/EditWhatsAppMessage','7jPPoZq','dateStart','__importDefault','Não\x20foi\x20possível\x20realizar\x20a\x20operação','5577030tytLEU','create','conversation','toString','emit','../libs/wbot','messageId','files','../models/Whatsapp','update','typing','constructor','TicketId\x20is\x20required','user','log','queues','crypto','3ZZJcLG','getWbot','dateEnd','map','defineProperty','>>>>>>>>>>>>>>>>>forwardMessage\x20X<<<<<<<<<<<<<<<<<<<','../services/ContactServices/CreateOrUpdateContactService','Contact\x20not\x20found','Erro\x20na\x20conversão\x20do\x20áudio:','forEach','json','../models/Message','mediaType','../helpers/GetWhatsappWbot','configurable','contact','error','open','s.whatsapp.net','221671ZCyoLc','queueId','ShowContactService1','SendPausedStatus','validator','reactions','../helpers/SendPresenceStatus','get','toFormat','findByPk'];a26_0x49f2=function(){return _0x3dc91d;};return a26_0x49f2();}const a26_0x400d95=(function(){let _0x14cd1c=!![];return function(_0x1abe9a,_0x42da1f){const _0x38ecf9=_0x14cd1c?function(){const _0x2d2350=a26_0x2098;if(_0x42da1f){const _0x238be0=_0x42da1f[_0x2d2350(0x113)](_0x1abe9a,arguments);return _0x42da1f=null,_0x238be0;}}:function(){};return _0x14cd1c=![],_0x38ecf9;};}()),a26_0x5e3528=a26_0x400d95(this,function(){const _0x123968=a26_0x2098;return a26_0x5e3528[_0x123968(0x140)]()['search'](_0x123968(0x11b))[_0x123968(0x140)]()[_0x123968(0x148)](a26_0x5e3528)[_0x123968(0x104)](_0x123968(0x11b));});function a26_0x2098(_0xa0509a,_0x5b99d3){const _0x3c892d=a26_0x49f2();return a26_0x2098=function(_0x5e3528,_0x400d95){_0x5e3528=_0x5e3528-0xe0;let _0x49f24c=_0x3c892d[_0x5e3528];return _0x49f24c;},a26_0x2098(_0xa0509a,_0x5b99d3);}a26_0x5e3528();'use strict';var __createBinding=this&&this[a26_0x4e4dd6(0x134)]||(Object[a26_0x4e4dd6(0x13e)]?function(_0x4dd5fb,_0x300d78,_0x5132fe,_0x12553c){const _0x8ba8eb=a26_0x4e4dd6;if(_0x12553c===undefined)_0x12553c=_0x5132fe;var _0x1e6f75=Object['getOwnPropertyDescriptor'](_0x300d78,_0x5132fe);(!_0x1e6f75||(_0x8ba8eb(0x168)in _0x1e6f75?!_0x300d78[_0x8ba8eb(0x12c)]:_0x1e6f75[_0x8ba8eb(0x10c)]||_0x1e6f75[_0x8ba8eb(0x15c)]))&&(_0x1e6f75={'enumerable':!![],'get':function(){return _0x300d78[_0x5132fe];}}),Object[_0x8ba8eb(0x152)](_0x4dd5fb,_0x12553c,_0x1e6f75);}:function(_0x512c3b,_0x4c8703,_0x33e289,_0x441688){if(_0x441688===undefined)_0x441688=_0x33e289;_0x512c3b[_0x441688]=_0x4c8703[_0x33e289];}),__setModuleDefault=this&&this[a26_0x4e4dd6(0xfe)]||(Object[a26_0x4e4dd6(0x13e)]?function(_0x5071f5,_0x48ac4f){const _0x45df77=a26_0x4e4dd6;Object[_0x45df77(0x152)](_0x5071f5,_0x45df77(0xf9),{'enumerable':!![],'value':_0x48ac4f});}:function(_0x20e64f,_0x22a20){const _0x137b03=a26_0x4e4dd6;_0x20e64f[_0x137b03(0xf9)]=_0x22a20;}),__importStar=this&&this[a26_0x4e4dd6(0x109)]||function(_0x2f6456){const _0x5a1747=a26_0x4e4dd6;if(_0x2f6456&&_0x2f6456[_0x5a1747(0x12c)])return _0x2f6456;var _0x3bc526={};if(_0x2f6456!=null){for(var _0x2f9d28 in _0x2f6456)if(_0x2f9d28!==_0x5a1747(0xf9)&&Object[_0x5a1747(0x117)][_0x5a1747(0x12b)]['call'](_0x2f6456,_0x2f9d28))__createBinding(_0x3bc526,_0x2f6456,_0x2f9d28);}return __setModuleDefault(_0x3bc526,_0x2f6456),_0x3bc526;},__importDefault=this&&this[a26_0x4e4dd6(0x13b)]||function(_0x5c20dd){return _0x5c20dd&&_0x5c20dd['__esModule']?_0x5c20dd:{'default':_0x5c20dd};};Object['defineProperty'](exports,a26_0x4e4dd6(0x12c),{'value':!![]}),exports['forwardMessage']=exports[a26_0x4e4dd6(0x101)]=exports[a26_0x4e4dd6(0x118)]=exports[a26_0x4e4dd6(0x10e)]=exports[a26_0x4e4dd6(0x147)]=exports['remove']=exports['edit']=exports[a26_0x4e4dd6(0x11d)]=exports[a26_0x4e4dd6(0xfb)]=exports[a26_0x4e4dd6(0xf1)]=void 0x0;const AppError_1=__importDefault(require(a26_0x4e4dd6(0x100))),SetTicketMessagesAsRead_1=__importDefault(require('../helpers/SetTicketMessagesAsRead')),socket_1=require(a26_0x4e4dd6(0xfd)),Message_1=__importDefault(require(a26_0x4e4dd6(0x159))),Ticket_1=__importDefault(require('../models/Ticket')),Queue_1=__importDefault(require('../models/Queue')),User_1=__importDefault(require(a26_0x4e4dd6(0xe1))),Whatsapp_1=__importDefault(require(a26_0x4e4dd6(0x145))),Mustache_1=__importDefault(require('../helpers/Mustache')),ListMessagesService_1=__importDefault(require(a26_0x4e4dd6(0x107))),ShowTicketService_1=__importDefault(require(a26_0x4e4dd6(0x129))),FindOrCreateTicketService_1=__importDefault(require(a26_0x4e4dd6(0x11a))),UpdateTicketService_1=__importDefault(require(a26_0x4e4dd6(0xe5))),DeleteWhatsAppMessage_1=__importDefault(require(a26_0x4e4dd6(0xeb))),SendWhatsAppMedia_1=__importStar(require('../services/WbotServices/SendWhatsAppMedia')),SendWhatsAppMessage_1=__importDefault(require(a26_0x4e4dd6(0x131))),SendWhatsAppReaction_1=__importDefault(require(a26_0x4e4dd6(0x12d))),CheckNumber_1=__importDefault(require(a26_0x4e4dd6(0x135))),EditWhatsAppMessage_1=__importDefault(require(a26_0x4e4dd6(0x138))),TranslateAudioService_1=__importDefault(require(a26_0x4e4dd6(0x12f))),CreateOrUpdateContactService_1=__importDefault(require(a26_0x4e4dd6(0x154))),ShowMessageService_1=__importStar(require(a26_0x4e4dd6(0x16c))),ShowContactService_1=require(a26_0x4e4dd6(0x125)),ShowUserService_1=__importDefault(require('../services/UserServices/ShowUserService')),user_1=require('../utils/user'),UpdateTicketService_2=require(a26_0x4e4dd6(0xe5)),ListAllMessagesService_1=__importDefault(require('../services/MessageServices/ListAllMessagesService')),validator_1=require(a26_0x4e4dd6(0x165)),ffmpeg_static_1=__importDefault(require(a26_0x4e4dd6(0xe6))),fluent_ffmpeg_1=__importDefault(require('fluent-ffmpeg')),crypto_1=__importDefault(require(a26_0x4e4dd6(0x14d))),GetWhatsappWbot_1=__importDefault(require(a26_0x4e4dd6(0x15b))),wbot_1=require(a26_0x4e4dd6(0x142)),SendPresenceStatus_1=require(a26_0x4e4dd6(0x167));fluent_ffmpeg_1[a26_0x4e4dd6(0xf9)][a26_0x4e4dd6(0x102)](ffmpeg_static_1[a26_0x4e4dd6(0xf9)]);const index=async(_0x472c48,_0xa3905f)=>{const _0x1b713d=a26_0x4e4dd6,{ticketId:_0x39449c}=_0x472c48[_0x1b713d(0xe4)],{pageNumber:_0x438fb4}=_0x472c48[_0x1b713d(0x11c)],{companyId:_0x4297bd,profile:_0x584c59}=_0x472c48[_0x1b713d(0x14a)],_0x444675=[];if(_0x584c59!==_0x1b713d(0x136)){const _0x5e0196=await User_1[_0x1b713d(0xf9)]['findByPk'](_0x472c48['user']['id'],{'include':[{'model':Queue_1[_0x1b713d(0xf9)],'as':_0x1b713d(0x14c)}]});_0x5e0196[_0x1b713d(0x14c)][_0x1b713d(0x157)](_0x555137=>{const _0x15ba4d=_0x1b713d;_0x444675[_0x15ba4d(0x115)](_0x555137['id']);});}const {count:_0x184f1c,messages:_0x57c450,ticket:_0x351480,hasMore:_0x5a5447}=await(0x0,ListMessagesService_1[_0x1b713d(0xf9)])({'pageNumber':_0x438fb4,'ticketId':_0x39449c,'companyId':_0x4297bd,'queues':_0x444675});return(0x0,SetTicketMessagesAsRead_1[_0x1b713d(0xf9)])(_0x351480),_0xa3905f[_0x1b713d(0x158)]({'count':_0x184f1c,'messages':_0x57c450,'ticket':_0x351480,'hasMore':_0x5a5447});};exports[a26_0x4e4dd6(0xf1)]=index;const store=async(_0x1bd592,_0x33824e)=>{const _0x3cd159=a26_0x4e4dd6,{ticketId:_0x50a531}=_0x1bd592[_0x3cd159(0xe4)],{body:_0xcbc79c,quotedMsg:_0x4110a3,vCard:_0x4088bd}=_0x1bd592[_0x3cd159(0xfc)],_0x14df28=_0x1bd592[_0x3cd159(0x144)],{companyId:_0x3ddf8f,id:_0x4d574b}=_0x1bd592['user'],_0x3f9d81=await(0x0,ShowTicketService_1[_0x3cd159(0xf9)])(_0x50a531,_0x3ddf8f);_0x3f9d81[_0x3cd159(0x116)]!==_0x3cd159(0x15f)&&await(0x0,UpdateTicketService_1[_0x3cd159(0xf9)])({'ticketId':_0x3f9d81['id'],'ticketData':{'status':_0x3cd159(0x15f),'userId':parseInt(_0x4d574b)},'companyId':_0x3ddf8f});if(_0x3f9d81['unreadMessages']>0x0)(0x0,SetTicketMessagesAsRead_1[_0x3cd159(0xf9)])(_0x3f9d81);if(_0x14df28)await Promise['all'](_0x14df28[_0x3cd159(0x151)](async(_0x2732ea,_0x1b232f)=>{const _0x3f1d23=_0x3cd159;return(0x0,SendWhatsAppMedia_1[_0x3f1d23(0xf9)])({'media':_0x2732ea,'ticket':_0x3f9d81,'body':Array[_0x3f1d23(0xf5)](_0xcbc79c)?_0xcbc79c[_0x1b232f]:_0xcbc79c});}));else{const _0x19a530=await(0x0,SendWhatsAppMessage_1[_0x3cd159(0xf9)])({'body':_0xcbc79c,'ticket':_0x3f9d81,'quotedMsg':_0x4110a3,'vCard':_0x4088bd});}return _0x33824e[_0x3cd159(0x10e)]();};exports[a26_0x4e4dd6(0xfb)]=store;const getAll=async(_0x23e4b9,_0x2c3e78)=>{const _0x5517c2=a26_0x4e4dd6,_0x548f38=_0x23e4b9[_0x5517c2(0x11c)][_0x5517c2(0x13a)],_0x39324e=_0x23e4b9['query'][_0x5517c2(0x150)],_0x332af7=(0x0,validator_1[_0x5517c2(0x137)])(_0x23e4b9[_0x5517c2(0x11c)]['fromMe']),{companyId:_0x1a87da}=_0x23e4b9[_0x5517c2(0x14a)],{count:_0x23b80e}=await(0x0,ListAllMessagesService_1[_0x5517c2(0xf9)])({'companyId':_0x1a87da,'fromMe':_0x332af7,'dateStart':_0x548f38,'dateEnd':_0x39324e});return _0x2c3e78[_0x5517c2(0x158)]({'count':_0x23b80e});};exports[a26_0x4e4dd6(0x11d)]=getAll;const edit=async(_0xd00e97,_0x1d5db9)=>{const _0x1fa2cd=a26_0x4e4dd6,{messageId:_0x420c9a}=_0xd00e97['params'],{companyId:_0x5bae5c}=_0xd00e97[_0x1fa2cd(0x14a)],{body:_0x396a15}=_0xd00e97[_0x1fa2cd(0xfc)],{ticketId:_0x40b42a,message:_0x16084c}=await(0x0,EditWhatsAppMessage_1[_0x1fa2cd(0xf9)])({'messageId':_0x420c9a,'companyId':_0x5bae5c,'body':_0x396a15}),_0x3f873d=(0x0,socket_1['getIO'])();return _0x3f873d['to'](_0x40b42a[_0x1fa2cd(0x140)]())['emit'](_0x1fa2cd(0xea)+_0x5bae5c+_0x1fa2cd(0x10d),{'action':_0x1fa2cd(0x146),'message':_0x16084c}),_0x1d5db9['send']();};exports[a26_0x4e4dd6(0xfa)]=edit;const remove=async(_0x363c81,_0x3c008a)=>{const _0x5b05b1=a26_0x4e4dd6,{messageId:_0xe632b8}=_0x363c81[_0x5b05b1(0xe4)],{companyId:_0x1f0e0a}=_0x363c81[_0x5b05b1(0x14a)],_0x4bf3e5=await(0x0,DeleteWhatsAppMessage_1['default'])(_0xe632b8),_0x249dde=(0x0,socket_1['getIO'])();return _0x249dde['to'](_0x4bf3e5[_0x5b05b1(0xf8)][_0x5b05b1(0x140)]())[_0x5b05b1(0x141)]('company-'+_0x1f0e0a+'-appMessage',{'action':_0x5b05b1(0x146),'message':_0x4bf3e5}),_0x3c008a[_0x5b05b1(0x10e)]();};exports[a26_0x4e4dd6(0xff)]=remove;const typing=async(_0x515716,_0x12116c)=>{const _0x3bd594=a26_0x4e4dd6,{ticketId:_0x4b7322}=_0x515716['params'],{companyId:_0x26faf8}=_0x515716[_0x3bd594(0x14a)],{status:_0x3a00f8}=_0x515716['query'];if(!_0x4b7322)return _0x12116c[_0x3bd594(0x116)](0x190)['send'](_0x3bd594(0x149));const _0x4cbdf0=await(0x0,ShowTicketService_1[_0x3bd594(0xf9)])(_0x4b7322,_0x26faf8);if(!_0x4cbdf0)return _0x12116c[_0x3bd594(0x116)](0x194)['send']('Ticket\x20not\x20found');let _0x421f45=(0x0,wbot_1[_0x3bd594(0x14f)])(_0x4cbdf0[_0x3bd594(0xf4)]);return _0x3a00f8==_0x3bd594(0x111)?await(0x0,SendPresenceStatus_1[_0x3bd594(0x120)])(_0x421f45,_0x4cbdf0[_0x3bd594(0x15d)][_0x3bd594(0xe0)]+'@'+(_0x4cbdf0[_0x3bd594(0x11e)]?_0x3bd594(0x127):'s.whatsapp.net')):await(0x0,SendPresenceStatus_1[_0x3bd594(0x164)])(_0x421f45,_0x4cbdf0[_0x3bd594(0x15d)][_0x3bd594(0xe0)]+'@'+(_0x4cbdf0[_0x3bd594(0x11e)]?_0x3bd594(0x127):_0x3bd594(0x160))),_0x12116c[_0x3bd594(0x116)](0xc8)[_0x3bd594(0x10e)](_0x3bd594(0xf6)+_0x3a00f8+'\x20enviado\x20com\x20sucesso');};exports[a26_0x4e4dd6(0x147)]=typing;const send=async(_0x1b479f,_0x513be3)=>{const _0x3e6a71=a26_0x4e4dd6,{whatsappId:_0x191360}=_0x1b479f[_0x3e6a71(0xe4)],_0x513c5d=_0x1b479f[_0x3e6a71(0xfc)],_0x69bfb6=_0x1b479f['files'];try{const _0x1446ec=await Whatsapp_1[_0x3e6a71(0xf9)][_0x3e6a71(0x16a)](_0x191360);if(!_0x1446ec)throw new Error(_0x3e6a71(0x13c));if(_0x513c5d['number']===undefined)throw new Error(_0x3e6a71(0xf3));const _0x1d67c6=_0x513c5d[_0x3e6a71(0xe0)],_0xdf7ddf=_0x513c5d[_0x3e6a71(0xfc)],_0x1c79ea=_0x1446ec[_0x3e6a71(0xe9)],_0x491daa=await(0x0,CheckNumber_1[_0x3e6a71(0xf9)])(_0x1d67c6,_0x1c79ea);var _0xf7647c=_0x491daa[_0x3e6a71(0x126)][_0x3e6a71(0x105)](_0x3e6a71(0x108));console[_0x3e6a71(0x14b)](_0xf7647c);const _0x536bf4=_0x491daa[_0x3e6a71(0x126)][_0x3e6a71(0xf0)](_0x3e6a71(0xed),'')['replace'](_0x3e6a71(0x108),''),_0x3c9474={'name':''+_0x536bf4,'number':_0x536bf4,'isGroup':_0xf7647c,'companyId':_0x1c79ea},_0x19d3db=await(0x0,GetWhatsappWbot_1[_0x3e6a71(0xf9)])(_0x1446ec),_0xe4c53d=await(0x0,CreateOrUpdateContactService_1[_0x3e6a71(0xf9)])(_0x3c9474,_0x19d3db,_0x491daa[_0x3e6a71(0x126)]),_0x1ffde1=await(0x0,FindOrCreateTicketService_1[_0x3e6a71(0xf9)])(_0xe4c53d,_0x1446ec['id'],0x0,_0x1c79ea);return _0x69bfb6?await Promise[_0x3e6a71(0xee)](_0x69bfb6[_0x3e6a71(0x151)](async _0x4c6115=>{const _0xb60f62=_0x3e6a71;await _0x1b479f['app'][_0xb60f62(0x168)]('queues')[_0xb60f62(0x119)]['add'](_0xb60f62(0x12a),{'whatsappId':_0x191360,'data':{'number':_0x536bf4,'body':_0xdf7ddf?(0x0,Mustache_1[_0xb60f62(0xf9)])(_0xdf7ddf,_0x1ffde1):_0x4c6115[_0xb60f62(0x121)],'mediaPath':_0x4c6115[_0xb60f62(0x10b)],'finalName':_0x4c6115['filename'],'fileName':_0x4c6115['originalname']}},{'removeOnComplete':!![],'attempts':0x3});})):await(0x0,SendWhatsAppMessage_1['default'])({'body':(0x0,Mustache_1[_0x3e6a71(0xf9)])(_0xdf7ddf,_0x1ffde1),'ticket':_0x1ffde1}),_0x513c5d[_0x3e6a71(0x130)]&&setTimeout(async()=>{const _0x251de8=_0x3e6a71;await(0x0,UpdateTicketService_1[_0x251de8(0xf9)])({'ticketId':_0x1ffde1['id'],'ticketData':{'status':_0x251de8(0x123)},'companyId':_0x1c79ea});},0x3e8),await(0x0,SetTicketMessagesAsRead_1['default'])(_0x1ffde1),_0x513be3[_0x3e6a71(0x10e)]({'mensagem':'Mensagem\x20enviada'});}catch(_0x249007){console[_0x3e6a71(0x14b)](_0x249007);if(Object[_0x3e6a71(0xe2)](_0x249007)['length']===0x0)throw new AppError_1[(_0x3e6a71(0xf9))](_0x3e6a71(0xf2));else throw new AppError_1[(_0x3e6a71(0xf9))](_0x249007[_0x3e6a71(0x16b)]);}};exports[a26_0x4e4dd6(0x10e)]=send;const addReaction=async(_0x899eb1,_0x51a3f4)=>{const _0x54ea00=a26_0x4e4dd6;try{const {messageId:_0xf5e414}=_0x899eb1['params'],{type:_0xfc57e3}=_0x899eb1[_0x54ea00(0xfc)],{companyId:_0x56ddbe,id:_0x273202}=_0x899eb1['user'],_0x28306c=await Message_1['default'][_0x54ea00(0x16a)](_0xf5e414),_0x52c676=await Ticket_1[_0x54ea00(0xf9)][_0x54ea00(0x16a)](_0x28306c[_0x54ea00(0xf8)],{'include':[_0x54ea00(0x15d)]});if(!_0x28306c)return _0x51a3f4['status'](0x194)['send']({'message':_0x54ea00(0x103)});const _0x32e18e=await(0x0,SendWhatsAppReaction_1['default'])({'messageId':_0xf5e414,'ticket':_0x52c676,'reactionType':_0xfc57e3}),_0x1af78f=await _0x28306c[_0x54ea00(0x146)]({'reactions':[..._0x28306c[_0x54ea00(0x166)],{'type':_0xfc57e3,'userId':_0x273202}]}),_0x485e8c=(0x0,socket_1['getIO'])();return _0x485e8c['to'](_0x28306c[_0x54ea00(0xf8)][_0x54ea00(0x140)]())[_0x54ea00(0x141)]('company-'+_0x56ddbe+'-appMessage',{'action':_0x54ea00(0x146),'message':_0x28306c}),_0x51a3f4[_0x54ea00(0x116)](0xc8)[_0x54ea00(0x10e)]({'message':_0x54ea00(0xef),'reactionResult':_0x32e18e,'reactions':_0x1af78f['reactions']});}catch(_0x2af585){console[_0x54ea00(0x15e)]('Erro\x20ao\x20adicionar\x20reação:',_0x2af585);if(_0x2af585 instanceof AppError_1[_0x54ea00(0xf9)])return _0x51a3f4['status'](0x190)[_0x54ea00(0x10e)]({'message':_0x2af585[_0x54ea00(0x16b)]});return _0x51a3f4['status'](0x1f4)['send']({'message':_0x54ea00(0x114),'error':_0x2af585[_0x54ea00(0x16b)]});}};exports[a26_0x4e4dd6(0x118)]=addReaction;const storeAudio=async(_0x305ed3,_0x27d1f4)=>{const _0x4bcea0=a26_0x4e4dd6,_0x40f874=_0x305ed3[_0x4bcea0(0x14a)]['companyId'],_0x46ca1b=_0x305ed3['file'];let _0x44eec9='';const _0x10e38a=generateRandomFilename(),_0x5e2c7a=_0x4bcea0(0xf7)+_0x40f874+'/'+_0x10e38a;return await convertToMp3(_0x46ca1b['path'],_0x5e2c7a),_0x46ca1b&&(_0x44eec9=await(0x0,TranslateAudioService_1['default'])(_0x5e2c7a)),_0x27d1f4['send'](_0x44eec9||'Transcrição\x20não\x20disponível');};exports[a26_0x4e4dd6(0x101)]=storeAudio;function convertToMp3(_0x82aaf0,_0x27516e){return new Promise((_0x155103,_0x39733b)=>{const _0x9ae15e=a26_0x2098;(0x0,fluent_ffmpeg_1[_0x9ae15e(0xf9)])(_0x82aaf0)[_0x9ae15e(0x169)]('mp3')['on'](_0x9ae15e(0x132),()=>{_0x155103(_0x27516e);})['on'](_0x9ae15e(0x15e),_0x55bc8d=>{const _0x375524=_0x9ae15e;console[_0x375524(0x15e)](_0x375524(0x156),_0x55bc8d),_0x39733b(_0x55bc8d);})['saveToFile'](_0x27516e);});}function generateRandomFilename(){const _0x1607a3=a26_0x4e4dd6,_0x104221=crypto_1[_0x1607a3(0xf9)][_0x1607a3(0x128)](0x10)[_0x1607a3(0x140)]('hex');return _0x104221+_0x1607a3(0x112);}const forwardMessage=async(_0x39be49,_0x5170d6)=>{const _0x2f91c7=a26_0x4e4dd6;console[_0x2f91c7(0x14b)](_0x2f91c7(0x153));const {body:_0x38aa2e,quotedMsg:_0x4d4103}=_0x39be49['body'],_0x413c99=_0x39be49[_0x2f91c7(0xfc)][_0x2f91c7(0x143)],_0x555c94=_0x39be49[_0x2f91c7(0xfc)][_0x2f91c7(0x110)];if(!_0x413c99||!_0x555c94)return _0x5170d6[_0x2f91c7(0x116)](0xc8)[_0x2f91c7(0x10e)](_0x2f91c7(0xe3));const _0x4822aa=await(0x0,ShowMessageService_1[_0x2f91c7(0xf9)])(_0x413c99),_0x476966=await(0x0,ShowContactService_1[_0x2f91c7(0x163)])(_0x555c94);if(!_0x4822aa)return _0x5170d6['status'](0x194)[_0x2f91c7(0x10e)]('Message\x20not\x20found');if(!_0x476966)return _0x5170d6[_0x2f91c7(0x116)](0x194)[_0x2f91c7(0x10e)](_0x2f91c7(0x155));const _0x996c08=await(0x0,ShowMessageService_1['GetWhatsAppFromMessage'])(_0x4822aa);if(!_0x996c08)return _0x5170d6[_0x2f91c7(0x116)](0x194)[_0x2f91c7(0x10e)](_0x2f91c7(0x124));const _0x1f53c2=_0x39be49['user'][_0x2f91c7(0xe9)],_0x384953=await(0x0,FindOrCreateTicketService_1['default'])(_0x476966,_0x996c08,0x0,_0x1f53c2);await(0x0,SetTicketMessagesAsRead_1['default'])(_0x384953);_0x4822aa[_0x2f91c7(0x15a)]===_0x2f91c7(0x13f)||_0x4822aa['mediaType']==='extendedTextMessage'?await(0x0,SendWhatsAppMessage_1[_0x2f91c7(0xf9)])({'body':_0x4822aa[_0x2f91c7(0xfc)],'ticket':_0x384953,'quotedMsg':_0x4d4103}):await(0x0,SendWhatsAppMedia_1[_0x2f91c7(0xec)])(_0x4822aa[_0x2f91c7(0x133)]||'',_0x384953,_0x4822aa[_0x2f91c7(0xfc)]);const _0x5378b7=await(0x0,ShowUserService_1[_0x2f91c7(0xf9)])(_0x39be49[_0x2f91c7(0x14a)]['id']),_0x278d9c=await(0x0,user_1[_0x2f91c7(0x106)])(_0x5378b7);_0x384953[_0x2f91c7(0x116)]='open',_0x384953[_0x2f91c7(0x162)]=_0x278d9c?.['id']||null,_0x384953[_0x2f91c7(0x122)]=_0x5378b7['id'],_0x384953['save']();const _0x61ebcb=(0x0,socket_1['getIO'])();return(0x0,UpdateTicketService_2['notifyUpdate'])(_0x61ebcb,_0x384953,_0x384953['id'],_0x1f53c2),_0x5170d6[_0x2f91c7(0x10e)]();};exports['forwardMessage']=forwardMessage;