const a26_0x107437=a26_0x42d4;(function(_0x24b5fa,_0x193b30){const _0x3221ca=a26_0x42d4,_0x45ef17=_0x24b5fa();while(!![]){try{const _0x3e6fe7=-parseInt(_0x3221ca(0xe1))/0x1*(parseInt(_0x3221ca(0x100))/0x2)+parseInt(_0x3221ca(0xde))/0x3*(-parseInt(_0x3221ca(0x10f))/0x4)+-parseInt(_0x3221ca(0xb8))/0x5*(-parseInt(_0x3221ca(0x11a))/0x6)+parseInt(_0x3221ca(0x110))/0x7*(parseInt(_0x3221ca(0xcc))/0x8)+parseInt(_0x3221ca(0xf1))/0x9*(parseInt(_0x3221ca(0xe4))/0xa)+-parseInt(_0x3221ca(0x8d))/0xb+parseInt(_0x3221ca(0xe3))/0xc*(parseInt(_0x3221ca(0xf9))/0xd);if(_0x3e6fe7===_0x193b30)break;else _0x45ef17['push'](_0x45ef17['shift']());}catch(_0x5466c3){_0x45ef17['push'](_0x45ef17['shift']());}}}(a26_0x54ac,0x538f0));const a26_0x34a8ac=(function(){let _0x591ffd=!![];return function(_0x264888,_0x424462){const _0x4335e8=_0x591ffd?function(){if(_0x424462){const _0x374164=_0x424462['apply'](_0x264888,arguments);return _0x424462=null,_0x374164;}}:function(){};return _0x591ffd=![],_0x4335e8;};}()),a26_0x1a54bb=a26_0x34a8ac(this,function(){const _0x17b59f=a26_0x42d4;return a26_0x1a54bb[_0x17b59f(0xb3)]()['search'](_0x17b59f(0x9b))[_0x17b59f(0xb3)]()['constructor'](a26_0x1a54bb)[_0x17b59f(0xce)](_0x17b59f(0x9b));});a26_0x1a54bb();'use strict';var __createBinding=this&&this[a26_0x107437(0xf5)]||(Object[a26_0x107437(0xfb)]?function(_0xf82511,_0x1e2d72,_0x304288,_0x134e54){const _0x34aeb7=a26_0x107437;if(_0x134e54===undefined)_0x134e54=_0x304288;var _0x520062=Object[_0x34aeb7(0x9c)](_0x1e2d72,_0x304288);(!_0x520062||(_0x34aeb7(0xd3)in _0x520062?!_0x1e2d72['__esModule']:_0x520062['writable']||_0x520062[_0x34aeb7(0x99)]))&&(_0x520062={'enumerable':!![],'get':function(){return _0x1e2d72[_0x304288];}}),Object[_0x34aeb7(0xa9)](_0xf82511,_0x134e54,_0x520062);}:function(_0x50a64f,_0x3d5427,_0xefd716,_0x5531ed){if(_0x5531ed===undefined)_0x5531ed=_0xefd716;_0x50a64f[_0x5531ed]=_0x3d5427[_0xefd716];}),__setModuleDefault=this&&this[a26_0x107437(0xf6)]||(Object[a26_0x107437(0xfb)]?function(_0x5803cd,_0x56e2c0){const _0x59190=a26_0x107437;Object[_0x59190(0xa9)](_0x5803cd,_0x59190(0xd8),{'enumerable':!![],'value':_0x56e2c0});}:function(_0x396cf1,_0x13d621){const _0x2b4137=a26_0x107437;_0x396cf1[_0x2b4137(0xd8)]=_0x13d621;}),__importStar=this&&this[a26_0x107437(0xd4)]||function(_0x61d84a){const _0x552f68=a26_0x107437;if(_0x61d84a&&_0x61d84a['__esModule'])return _0x61d84a;var _0xf0c75c={};if(_0x61d84a!=null){for(var _0x1d23ba in _0x61d84a)if(_0x1d23ba!=='default'&&Object[_0x552f68(0xb9)][_0x552f68(0x11b)][_0x552f68(0xfe)](_0x61d84a,_0x1d23ba))__createBinding(_0xf0c75c,_0x61d84a,_0x1d23ba);}return __setModuleDefault(_0xf0c75c,_0x61d84a),_0xf0c75c;},__importDefault=this&&this[a26_0x107437(0x113)]||function(_0x15456f){const _0xf70b6=a26_0x107437;return _0x15456f&&_0x15456f[_0xf70b6(0x11f)]?_0x15456f:{'default':_0x15456f};};Object[a26_0x107437(0xa9)](exports,a26_0x107437(0x11f),{'value':!![]}),exports[a26_0x107437(0x97)]=exports['storeAudio']=exports[a26_0x107437(0xd0)]=exports['send']=exports['typing']=exports[a26_0x107437(0xd1)]=exports['edit']=exports[a26_0x107437(0xa4)]=exports[a26_0x107437(0xef)]=exports['index']=void 0x0;function a26_0x42d4(_0x11041b,_0x1c508e){const _0x56dcb9=a26_0x54ac();return a26_0x42d4=function(_0x1a54bb,_0x34a8ac){_0x1a54bb=_0x1a54bb-0x8b;let _0x54acf7=_0x56dcb9[_0x1a54bb];return _0x54acf7;},a26_0x42d4(_0x11041b,_0x1c508e);}const AppError_1=__importDefault(require(a26_0x107437(0xeb))),SetTicketMessagesAsRead_1=__importDefault(require(a26_0x107437(0x118))),socket_1=require(a26_0x107437(0xd9)),Message_1=__importDefault(require('../models/Message')),Ticket_1=__importDefault(require(a26_0x107437(0xfc))),Queue_1=__importDefault(require(a26_0x107437(0x10e))),User_1=__importDefault(require('../models/User')),Whatsapp_1=__importDefault(require(a26_0x107437(0xc6))),Mustache_1=__importDefault(require(a26_0x107437(0x109))),ListMessagesService_1=__importDefault(require(a26_0x107437(0xcf))),ShowTicketService_1=__importDefault(require('../services/TicketServices/ShowTicketService')),FindOrCreateTicketService_1=__importDefault(require(a26_0x107437(0xa0))),UpdateTicketService_1=__importDefault(require('../services/TicketServices/UpdateTicketService')),DeleteWhatsAppMessage_1=__importDefault(require('../services/WbotServices/DeleteWhatsAppMessage')),SendWhatsAppMedia_1=__importStar(require(a26_0x107437(0x98))),SendWhatsAppMessage_1=__importDefault(require('../services/WbotServices/SendWhatsAppMessage')),SendWhatsAppReaction_1=__importDefault(require(a26_0x107437(0x8f))),CheckNumber_1=__importDefault(require(a26_0x107437(0xb6))),EditWhatsAppMessage_1=__importDefault(require(a26_0x107437(0x91))),TranslateAudioService_1=__importDefault(require(a26_0x107437(0xb4))),CreateOrUpdateContactService_1=__importDefault(require('../services/ContactServices/CreateOrUpdateContactService')),ShowMessageService_1=__importStar(require(a26_0x107437(0xb2))),ShowContactService_1=require(a26_0x107437(0xff)),ShowUserService_1=__importDefault(require(a26_0x107437(0xfd))),user_1=require(a26_0x107437(0x11d)),UpdateTicketService_2=require('../services/TicketServices/UpdateTicketService'),ListAllMessagesService_1=__importDefault(require('../services/MessageServices/ListAllMessagesService')),validator_1=require(a26_0x107437(0x116)),ffmpeg_static_1=__importDefault(require('ffmpeg-static')),fluent_ffmpeg_1=__importDefault(require(a26_0x107437(0xba))),crypto_1=__importDefault(require(a26_0x107437(0x106))),GetWhatsappWbot_1=__importDefault(require(a26_0x107437(0x93))),wbot_1=require(a26_0x107437(0xa7)),SendPresenceStatus_1=require(a26_0x107437(0xb7));fluent_ffmpeg_1['default'][a26_0x107437(0xac)](ffmpeg_static_1[a26_0x107437(0xd8)]);const index=async(_0x2cf843,_0x49ec25)=>{const _0x446ff9=a26_0x107437,{ticketId:_0x14e273}=_0x2cf843[_0x446ff9(0xf8)],{pageNumber:_0x4b8ebe}=_0x2cf843[_0x446ff9(0x107)],{companyId:_0x232cae,profile:_0x3e2d78}=_0x2cf843[_0x446ff9(0x119)],_0x89a862=[];if(_0x3e2d78!=='admin'){const _0x1f962b=await User_1[_0x446ff9(0xd8)][_0x446ff9(0xed)](_0x2cf843['user']['id'],{'include':[{'model':Queue_1[_0x446ff9(0xd8)],'as':_0x446ff9(0xbb)}]});_0x1f962b['queues'][_0x446ff9(0x11e)](_0x19799a=>{_0x89a862['push'](_0x19799a['id']);});}const {count:_0x42916b,messages:_0x3a1f2a,ticket:_0x2ea121,hasMore:_0x392c2e}=await(0x0,ListMessagesService_1['default'])({'pageNumber':_0x4b8ebe,'ticketId':_0x14e273,'companyId':_0x232cae,'queues':_0x89a862});return(0x0,SetTicketMessagesAsRead_1[_0x446ff9(0xd8)])(_0x2ea121),_0x49ec25[_0x446ff9(0x117)]({'count':_0x42916b,'messages':_0x3a1f2a,'ticket':_0x2ea121,'hasMore':_0x392c2e});};exports[a26_0x107437(0xad)]=index;const store=async(_0x30f7a5,_0x2b2925)=>{const _0x27d5c1=a26_0x107437,{ticketId:_0x28e480}=_0x30f7a5[_0x27d5c1(0xf8)],{body:_0x350c45,quotedMsg:_0x14a27b,vCard:_0x585ba5}=_0x30f7a5[_0x27d5c1(0xa1)],_0x3688f5=_0x30f7a5[_0x27d5c1(0xbe)],{companyId:_0x4bdf56,id:_0x2cecdf}=_0x30f7a5[_0x27d5c1(0x119)],_0x5a080c=await(0x0,ShowTicketService_1[_0x27d5c1(0xd8)])(_0x28e480,_0x4bdf56);_0x5a080c[_0x27d5c1(0xc4)]!=='open'&&await(0x0,UpdateTicketService_1[_0x27d5c1(0xd8)])({'ticketId':_0x5a080c['id'],'ticketData':{'status':'open','userId':parseInt(_0x2cecdf)},'companyId':_0x4bdf56});if(_0x5a080c[_0x27d5c1(0xa2)]>0x0)(0x0,SetTicketMessagesAsRead_1[_0x27d5c1(0xd8)])(_0x5a080c);if(_0x3688f5)await Promise[_0x27d5c1(0xa8)](_0x3688f5[_0x27d5c1(0xf3)](async(_0x1876a2,_0x119366)=>{const _0x3d1933=_0x27d5c1;return(0x0,SendWhatsAppMedia_1[_0x3d1933(0xd8)])({'media':_0x1876a2,'ticket':_0x5a080c,'body':Array[_0x3d1933(0xf2)](_0x350c45)?_0x350c45[_0x119366]:_0x350c45});}));else{const _0x39d141=await(0x0,SendWhatsAppMessage_1[_0x27d5c1(0xd8)])({'body':_0x350c45,'ticket':_0x5a080c,'quotedMsg':_0x14a27b,'vCard':_0x585ba5});}return _0x2b2925[_0x27d5c1(0x101)]();};function a26_0x54ac(){const _0x9b55f8=['Whatsapp\x20from\x20message\x20not\x20found','../services/TicketServices/FindOrCreateTicketService','body','unreadMessages','s.whatsapp.net','getAll','Reação\x20adicionada\x20com\x20sucesso!','contactId','../libs/wbot','all','defineProperty','./public/company','Transcrição\x20não\x20disponível','setFfmpegPath','index','-appMessage','messageQueue','message','randomBytes','../services/MessageServices/ShowMessageService','toString','../services/MessageServices/TranslateAudioService','conversation','../services/WbotServices/CheckNumber','../helpers/SendPresenceStatus','332585PqMqCJ','prototype','fluent-ffmpeg','queues','storeAudio','length','files','typing','notifyUpdate','mediaType','edit','jid','status','userId','../models/Whatsapp','emit','company-','whatsappId','mp3','contact','1957696oVuSTT','SendWhatsAppMediaFileAddress','search','../services/MessageServices/ListMessagesService','addReaction','remove','file','get','__importStar','toBoolean','update','Erro\x20na\x20conversão\x20do\x20áudio:','default','../libs/socket','Contact\x20not\x20found','O\x20número\x20é\x20obrigatório','GetWhatsAppFromMessage','MessageId\x20or\x20ContactId\x20not\x20found','18CrfkDf','hex','open','40072eVljmh','replace','125508eJwyDv','70hBZxGA','@g.us','mediaUrl','reactions','originalname','Erro\x20ao\x20adicionar\x20reação','companyId','../errors/AppError','toFormat','findByPk','isGroup','store','save','515241NExoUB','isArray','map','Não\x20foi\x20possível\x20realizar\x20a\x20operação','__createBinding','__setModuleDefault','Mensagem\x20não\x20encontrada','params','845ptgrUU','Erro\x20ao\x20adicionar\x20reação:','create','../models/Ticket','../services/UserServices/ShowUserService','call','../services/ContactServices/ShowContactService','32JuxrVS','send','@s.whatsapp.net','g.us','firstQueueThisUser','\x20enviado\x20com\x20sucesso','crypto','query','fromMe','../helpers/Mustache','filename','SendMessage','path','keys','../models/Queue','213884cIxbnZ','14tzrnUW','SendPausedStatus','number','__importDefault','error','app','validator','json','../helpers/SetTicketMessagesAsRead','user','6wTImKk','hasOwnProperty','dateEnd','../utils/user','forEach','__esModule','getIO','Message\x20not\x20found','3655135LPrmFG','ticketId','../services/WbotServices/SendWhatsAppReaction','TicketId\x20is\x20required','../services/WbotServices/EditWhatsAppMessage','SendTypingStatus','../helpers/GetWhatsappWbot','closeTicket','messageId','log','forwardMessage','../services/WbotServices/SendWhatsAppMedia','configurable','.mp3','(((.+)+)+)+$','getOwnPropertyDescriptor','true','Não\x20foi\x20possível\x20enviar\x20a\x20mensagem,\x20tente\x20novamente\x20em\x20alguns\x20instantes'];a26_0x54ac=function(){return _0x9b55f8;};return a26_0x54ac();}exports[a26_0x107437(0xef)]=store;const getAll=async(_0x4f2d5c,_0xe25edf)=>{const _0x300751=a26_0x107437,_0x79c38b=_0x4f2d5c[_0x300751(0x107)]['dateStart'],_0x4d3947=_0x4f2d5c['query'][_0x300751(0x11c)],_0x4b3e46=(0x0,validator_1[_0x300751(0xd5)])(_0x4f2d5c[_0x300751(0x107)][_0x300751(0x108)]),{companyId:_0x370c6b}=_0x4f2d5c['user'],{count:_0x41ae0d}=await(0x0,ListAllMessagesService_1['default'])({'companyId':_0x370c6b,'fromMe':_0x4b3e46,'dateStart':_0x79c38b,'dateEnd':_0x4d3947});return _0xe25edf[_0x300751(0x117)]({'count':_0x41ae0d});};exports['getAll']=getAll;const edit=async(_0x549541,_0x5dff88)=>{const _0x2cad72=a26_0x107437,{messageId:_0x28daf3}=_0x549541[_0x2cad72(0xf8)],{companyId:_0x4bae62}=_0x549541[_0x2cad72(0x119)],{body:_0x36d25b}=_0x549541[_0x2cad72(0xa1)],{ticketId:_0x203da8,message:_0x29c9ba}=await(0x0,EditWhatsAppMessage_1[_0x2cad72(0xd8)])({'messageId':_0x28daf3,'companyId':_0x4bae62,'body':_0x36d25b}),_0x1db8a2=(0x0,socket_1[_0x2cad72(0x8b)])();return _0x1db8a2['to'](_0x203da8['toString']())[_0x2cad72(0xc7)](_0x2cad72(0xc8)+_0x4bae62+_0x2cad72(0xae),{'action':_0x2cad72(0xd6),'message':_0x29c9ba}),_0x5dff88[_0x2cad72(0x101)]();};exports[a26_0x107437(0xc2)]=edit;const remove=async(_0x2396de,_0x5b2b94)=>{const _0x50a780=a26_0x107437,{messageId:_0x562f6d}=_0x2396de['params'],{companyId:_0x57b8eb}=_0x2396de[_0x50a780(0x119)],_0x96896=await(0x0,DeleteWhatsAppMessage_1[_0x50a780(0xd8)])(_0x562f6d),_0x47ba07=(0x0,socket_1[_0x50a780(0x8b)])();return _0x47ba07['to'](_0x96896[_0x50a780(0x8e)][_0x50a780(0xb3)]())[_0x50a780(0xc7)](_0x50a780(0xc8)+_0x57b8eb+_0x50a780(0xae),{'action':_0x50a780(0xd6),'message':_0x96896}),_0x5b2b94[_0x50a780(0x101)]();};exports[a26_0x107437(0xd1)]=remove;const typing=async(_0x38c458,_0x1e4d53)=>{const _0x4ee7ea=a26_0x107437,{ticketId:_0x71633e}=_0x38c458[_0x4ee7ea(0xf8)],{companyId:_0x232e98}=_0x38c458[_0x4ee7ea(0x119)],{status:_0x3a417b}=_0x38c458[_0x4ee7ea(0x107)];if(!_0x71633e)return _0x1e4d53['status'](0x190)[_0x4ee7ea(0x101)](_0x4ee7ea(0x90));const _0x795ea2=await(0x0,ShowTicketService_1[_0x4ee7ea(0xd8)])(_0x71633e,_0x232e98);if(!_0x795ea2)return _0x1e4d53[_0x4ee7ea(0xc4)](0x194)[_0x4ee7ea(0x101)]('Ticket\x20not\x20found');let _0x51ae99=(0x0,wbot_1['getWbot'])(_0x795ea2[_0x4ee7ea(0xc9)]);return _0x3a417b==_0x4ee7ea(0x9d)?await(0x0,SendPresenceStatus_1[_0x4ee7ea(0x92)])(_0x51ae99,_0x795ea2[_0x4ee7ea(0xcb)][_0x4ee7ea(0x112)]+'@'+(_0x795ea2['isGroup']?_0x4ee7ea(0x103):_0x4ee7ea(0xa3))):await(0x0,SendPresenceStatus_1[_0x4ee7ea(0x111)])(_0x51ae99,_0x795ea2[_0x4ee7ea(0xcb)][_0x4ee7ea(0x112)]+'@'+(_0x795ea2[_0x4ee7ea(0xee)]?_0x4ee7ea(0x103):_0x4ee7ea(0xa3))),_0x1e4d53[_0x4ee7ea(0xc4)](0xc8)['send']('Status\x20'+_0x3a417b+_0x4ee7ea(0x105));};exports[a26_0x107437(0xbf)]=typing;const send=async(_0x3579c7,_0x31cdb5)=>{const _0x42ae63=a26_0x107437,{whatsappId:_0x2679d7}=_0x3579c7[_0x42ae63(0xf8)],_0x500cff=_0x3579c7[_0x42ae63(0xa1)],_0x3eef0c=_0x3579c7[_0x42ae63(0xbe)];try{const _0x172bcd=await Whatsapp_1[_0x42ae63(0xd8)][_0x42ae63(0xed)](_0x2679d7);if(!_0x172bcd)throw new Error(_0x42ae63(0xf4));if(_0x500cff[_0x42ae63(0x112)]===undefined)throw new Error(_0x42ae63(0xdb));const _0x15ba1d=_0x500cff['number'],_0x449449=_0x500cff['body'],_0x20bc88=_0x172bcd[_0x42ae63(0xea)],_0x2970aa=await(0x0,CheckNumber_1['default'])(_0x15ba1d,_0x20bc88);var _0x4d378a=_0x2970aa[_0x42ae63(0xc3)]['includes'](_0x42ae63(0xe5));console[_0x42ae63(0x96)](_0x4d378a);const _0x51c886=_0x2970aa[_0x42ae63(0xc3)][_0x42ae63(0xe2)](_0x42ae63(0x102),'')[_0x42ae63(0xe2)]('@g.us',''),_0x5e446f={'name':''+_0x51c886,'number':_0x51c886,'isGroup':_0x4d378a,'companyId':_0x20bc88},_0x28c4a1=await(0x0,GetWhatsappWbot_1[_0x42ae63(0xd8)])(_0x172bcd),_0x22c90f=await(0x0,CreateOrUpdateContactService_1['default'])(_0x5e446f,_0x28c4a1,_0x2970aa[_0x42ae63(0xc3)]),_0x13b9b0=await(0x0,FindOrCreateTicketService_1[_0x42ae63(0xd8)])(_0x22c90f,_0x172bcd['id'],0x0,_0x20bc88);return _0x3eef0c?await Promise[_0x42ae63(0xa8)](_0x3eef0c[_0x42ae63(0xf3)](async _0x5c4aea=>{const _0x1964d3=_0x42ae63;await _0x3579c7[_0x1964d3(0x115)][_0x1964d3(0xd3)](_0x1964d3(0xbb))[_0x1964d3(0xaf)]['add'](_0x1964d3(0x10b),{'whatsappId':_0x2679d7,'data':{'number':_0x51c886,'body':_0x449449?(0x0,Mustache_1['default'])(_0x449449,_0x13b9b0):_0x5c4aea[_0x1964d3(0xe8)],'mediaPath':_0x5c4aea[_0x1964d3(0x10c)],'finalName':_0x5c4aea[_0x1964d3(0x10a)],'fileName':_0x5c4aea[_0x1964d3(0xe8)]}},{'removeOnComplete':!![],'attempts':0x3});})):await(0x0,SendWhatsAppMessage_1[_0x42ae63(0xd8)])({'body':(0x0,Mustache_1[_0x42ae63(0xd8)])(_0x449449,_0x13b9b0),'ticket':_0x13b9b0}),_0x500cff[_0x42ae63(0x94)]&&setTimeout(async()=>{const _0x4fb90a=_0x42ae63;await(0x0,UpdateTicketService_1[_0x4fb90a(0xd8)])({'ticketId':_0x13b9b0['id'],'ticketData':{'status':'closed'},'companyId':_0x20bc88});},0x3e8),await(0x0,SetTicketMessagesAsRead_1['default'])(_0x13b9b0),_0x31cdb5[_0x42ae63(0x101)]({'mensagem':'Mensagem\x20enviada'});}catch(_0x18c46d){console[_0x42ae63(0x96)](_0x18c46d);if(Object[_0x42ae63(0x10d)](_0x18c46d)[_0x42ae63(0xbd)]===0x0)throw new AppError_1[(_0x42ae63(0xd8))](_0x42ae63(0x9e));else throw new AppError_1[(_0x42ae63(0xd8))](_0x18c46d[_0x42ae63(0xb0)]);}};exports[a26_0x107437(0x101)]=send;const addReaction=async(_0x288562,_0x38b2b3)=>{const _0x5a23dc=a26_0x107437;try{const {messageId:_0x47774a}=_0x288562[_0x5a23dc(0xf8)],{type:_0x7395b2}=_0x288562[_0x5a23dc(0xa1)],{companyId:_0x27e673,id:_0x10e2a7}=_0x288562['user'],_0x896633=await Message_1[_0x5a23dc(0xd8)][_0x5a23dc(0xed)](_0x47774a),_0x339309=await Ticket_1['default'][_0x5a23dc(0xed)](_0x896633['ticketId'],{'include':[_0x5a23dc(0xcb)]});if(!_0x896633)return _0x38b2b3[_0x5a23dc(0xc4)](0x194)[_0x5a23dc(0x101)]({'message':_0x5a23dc(0xf7)});const _0x4f01b5=await(0x0,SendWhatsAppReaction_1['default'])({'messageId':_0x47774a,'ticket':_0x339309,'reactionType':_0x7395b2}),_0x7c183b=await _0x896633['update']({'reactions':[..._0x896633[_0x5a23dc(0xe7)],{'type':_0x7395b2,'userId':_0x10e2a7}]}),_0x31a77b=(0x0,socket_1[_0x5a23dc(0x8b)])();return _0x31a77b['to'](_0x896633['ticketId'][_0x5a23dc(0xb3)]())[_0x5a23dc(0xc7)](_0x5a23dc(0xc8)+_0x27e673+'-appMessage',{'action':_0x5a23dc(0xd6),'message':_0x896633}),_0x38b2b3[_0x5a23dc(0xc4)](0xc8)['send']({'message':_0x5a23dc(0xa5),'reactionResult':_0x4f01b5,'reactions':_0x7c183b[_0x5a23dc(0xe7)]});}catch(_0x4d8673){console[_0x5a23dc(0x114)](_0x5a23dc(0xfa),_0x4d8673);if(_0x4d8673 instanceof AppError_1[_0x5a23dc(0xd8)])return _0x38b2b3[_0x5a23dc(0xc4)](0x190)[_0x5a23dc(0x101)]({'message':_0x4d8673[_0x5a23dc(0xb0)]});return _0x38b2b3[_0x5a23dc(0xc4)](0x1f4)['send']({'message':_0x5a23dc(0xe9),'error':_0x4d8673['message']});}};exports[a26_0x107437(0xd0)]=addReaction;const storeAudio=async(_0xada96c,_0x2b101b)=>{const _0xde3ca1=a26_0x107437,_0x2c344c=_0xada96c['user'][_0xde3ca1(0xea)],_0x5868bc=_0xada96c[_0xde3ca1(0xd2)];let _0x584f8d='';const _0x13bc11=generateRandomFilename(),_0x47213b=_0xde3ca1(0xaa)+_0x2c344c+'/'+_0x13bc11;return await convertToMp3(_0x5868bc['path'],_0x47213b),_0x5868bc&&(_0x584f8d=await(0x0,TranslateAudioService_1[_0xde3ca1(0xd8)])(_0x47213b)),_0x2b101b[_0xde3ca1(0x101)](_0x584f8d||_0xde3ca1(0xab));};exports[a26_0x107437(0xbc)]=storeAudio;function convertToMp3(_0x52eaf9,_0x1e826b){return new Promise((_0x2be073,_0x470aea)=>{const _0x309969=a26_0x42d4;(0x0,fluent_ffmpeg_1[_0x309969(0xd8)])(_0x52eaf9)[_0x309969(0xec)](_0x309969(0xca))['on']('end',()=>{_0x2be073(_0x1e826b);})['on']('error',_0x5e4738=>{const _0x203f2c=_0x309969;console[_0x203f2c(0x114)](_0x203f2c(0xd7),_0x5e4738),_0x470aea(_0x5e4738);})['saveToFile'](_0x1e826b);});}function generateRandomFilename(){const _0x1b64cd=a26_0x107437,_0x30e120=crypto_1['default'][_0x1b64cd(0xb1)](0x10)[_0x1b64cd(0xb3)](_0x1b64cd(0xdf));return _0x30e120+_0x1b64cd(0x9a);}const forwardMessage=async(_0x59df9c,_0x4b4be0)=>{const _0x54d490=a26_0x107437;console[_0x54d490(0x96)]('>>>>>>>>>>>>>>>>>forwardMessage\x20X<<<<<<<<<<<<<<<<<<<');const {body:_0x26a788,quotedMsg:_0x3aceb6}=_0x59df9c['body'],_0x37dd9e=_0x59df9c[_0x54d490(0xa1)][_0x54d490(0x95)],_0x56902e=_0x59df9c[_0x54d490(0xa1)][_0x54d490(0xa6)];if(!_0x37dd9e||!_0x56902e)return _0x4b4be0['status'](0xc8)[_0x54d490(0x101)](_0x54d490(0xdd));const _0x511472=await(0x0,ShowMessageService_1[_0x54d490(0xd8)])(_0x37dd9e),_0x1be0c1=await(0x0,ShowContactService_1['ShowContactService1'])(_0x56902e);if(!_0x511472)return _0x4b4be0['status'](0x194)[_0x54d490(0x101)](_0x54d490(0x8c));if(!_0x1be0c1)return _0x4b4be0['status'](0x194)['send'](_0x54d490(0xda));const _0x2e4e4c=await(0x0,ShowMessageService_1[_0x54d490(0xdc)])(_0x511472);if(!_0x2e4e4c)return _0x4b4be0[_0x54d490(0xc4)](0x194)[_0x54d490(0x101)](_0x54d490(0x9f));const _0x191443=_0x59df9c[_0x54d490(0x119)]['companyId'],_0x115a8b=await(0x0,FindOrCreateTicketService_1[_0x54d490(0xd8)])(_0x1be0c1,_0x2e4e4c,0x0,_0x191443);await(0x0,SetTicketMessagesAsRead_1[_0x54d490(0xd8)])(_0x115a8b);_0x511472[_0x54d490(0xc1)]===_0x54d490(0xb5)||_0x511472[_0x54d490(0xc1)]==='extendedTextMessage'?await(0x0,SendWhatsAppMessage_1[_0x54d490(0xd8)])({'body':_0x511472[_0x54d490(0xa1)],'ticket':_0x115a8b,'quotedMsg':_0x3aceb6}):await(0x0,SendWhatsAppMedia_1[_0x54d490(0xcd)])(_0x511472[_0x54d490(0xe6)]||'',_0x115a8b,_0x511472[_0x54d490(0xa1)]);const _0x39ed67=await(0x0,ShowUserService_1[_0x54d490(0xd8)])(_0x59df9c[_0x54d490(0x119)]['id']),_0x354a8b=await(0x0,user_1[_0x54d490(0x104)])(_0x39ed67);_0x115a8b[_0x54d490(0xc4)]=_0x54d490(0xe0),_0x115a8b['queueId']=_0x354a8b?.['id']||null,_0x115a8b[_0x54d490(0xc5)]=_0x39ed67['id'],_0x115a8b[_0x54d490(0xf0)]();const _0x206a23=(0x0,socket_1[_0x54d490(0x8b)])();return(0x0,UpdateTicketService_2[_0x54d490(0xc0)])(_0x206a23,_0x115a8b,_0x115a8b['id'],_0x191443),_0x4b4be0[_0x54d490(0x101)]();};exports[a26_0x107437(0x97)]=forwardMessage;