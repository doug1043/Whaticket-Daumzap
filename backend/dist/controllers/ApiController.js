const a9_0xf755ab=a9_0x41ce;(function(_0x59192e,_0x5ea9ac){const _0x27d5eb=a9_0x41ce,_0x1e66fa=_0x59192e();while(!![]){try{const _0x1119f6=-parseInt(_0x27d5eb(0x164))/0x1+parseInt(_0x27d5eb(0x1bb))/0x2+parseInt(_0x27d5eb(0x214))/0x3+parseInt(_0x27d5eb(0x1f3))/0x4*(-parseInt(_0x27d5eb(0x1a6))/0x5)+-parseInt(_0x27d5eb(0x157))/0x6+parseInt(_0x27d5eb(0x208))/0x7*(-parseInt(_0x27d5eb(0x1f6))/0x8)+parseInt(_0x27d5eb(0x204))/0x9*(parseInt(_0x27d5eb(0x16c))/0xa);if(_0x1119f6===_0x5ea9ac)break;else _0x1e66fa['push'](_0x1e66fa['shift']());}catch(_0x5af37a){_0x1e66fa['push'](_0x1e66fa['shift']());}}}(a9_0x6c18,0x23737));const a9_0x12a7d7=(function(){let _0x29da9b=!![];return function(_0x1cf56c,_0x481a9b){const _0x228cd8=_0x29da9b?function(){const _0x862089=a9_0x41ce;if(_0x481a9b){const _0x5ede0d=_0x481a9b[_0x862089(0x1f5)](_0x1cf56c,arguments);return _0x481a9b=null,_0x5ede0d;}}:function(){};return _0x29da9b=![],_0x228cd8;};}()),a9_0x584147=a9_0x12a7d7(this,function(){const _0x20c542=a9_0x41ce;return a9_0x584147[_0x20c542(0x192)]()[_0x20c542(0x1e6)](_0x20c542(0x1cf))[_0x20c542(0x192)]()['constructor'](a9_0x584147)[_0x20c542(0x1e6)]('(((.+)+)+)+$');});a9_0x584147();function a9_0x6c18(){const _0x5b6de0=['contact','apply','16QyHKEf','Erro\x20ao\x20lidar\x20com\x20o\x20link\x20de\x20áudio','parseInt','showAllApi','../services/WbotServices/CheckIsValidContact','moment','storeContacts','All\x20contacts\x20removed\x20successfully','req','number','updateTicketTag','setDate','listContacts','../services/WbotServices/CheckNumber','975735tSZQEp','Token\x20de\x20autorização\x20inválido','company-','Internal\x20Server\x20Error','399651cCTAFZ','findByPk','toggleDisableBotContacts','path','Invalid\x20number\x20format.\x20Only\x20numbers\x20is\x20allowed.','Legenda\x20do\x20áudio','listTicketsByTagIsAuth','paid','indexContacts','deleteAll','OnWhatsAppDto','Acesso\x20não\x20autorizado.\x20Por\x20favor,\x20forneça\x20credenciais\x20válidas.','171378JwtCYx','exec','lodash','random','../services/WbotServices/GetProfilePicUrl','tags','Company\x20not\x20found','../models/Contact','required','SUCCESS','delete','extraInfo','../services/ContactServices/SimpleListService','Tag\x20already\x20associated\x20with\x20the\x20ticket','body','error','jid','ImportXLSContactsService','head','shape','../models/Company','@s.whatsapp.net','Error\x20updating\x20usage\x20stats:','Erro\x20ao\x20buscar\x20invoices:','image','updateUsageStats','format','profilePicUrl','company','../services/InvoicesService/ShowInvoiceService','audio/mp4','1132326DBDQYo','Tag\x20is\x20not\x20associated\x20with\x20the\x20ticket','queue','readFileSync','facebookUserId','../services/ContactServices/UpdateContactService','../helpers/GetDefaultWhatsApp','arraybuffer','Failed\x20to\x20remove\x20ticket\x20tag','Erro\x20ao\x20buscar\x20invoices','call','matches','Internal\x20server\x20error','266839ofBghJ','usedPDF','length','axios','replace','uploadContacts','../errors/AppError','../services/WbotServices/SendWhatsAppMedia','50PGZJzI','useDate','./public/company','video','from','@g.us','headers','ERROR','sendMessage','findOne','usedCheckNumber','originalname','../services/ContactServices/CreateOrUpdateContactService','indexLink','listTicketsByTag','validate','ticketData','url','data','__setModuleDefault','object','isInteger','yup','user','../services/InvoicesService/ListInvoicesServices','all','getWbot','media','status','createCompany','send','../services/TicketServices/FindOrCreateTicketService','../models/User','getIO','removeAllContacts','indexApi','Failed\x20to\x20update\x20ticket\x20tag','string','toString','usedImage','../services/WbotServices/SendWhatsappMediaImage','showContacts','color','nullable','mimetype','writeFileSync','authorization','create','-contact','companyId','files','default','log','../services/ContactServices/ToggleDisableBotService','usedOther','__esModule','showApi','../helpers/SetTicketMessagesAsRead','122530Vukbwd','Missing\x20user\x20or\x20companyId','../models/Whatsapp','SendPresenceStatus','email','\x20not\x20found','__importStar','facebookUserToken','indexWhatsappsId','../services/ContactServices/GetContactService','reload','-mainchannel','exists','query','../models/TicketTag','checkNumber','usedText','pending','whatsapp\x20#','removeContacts','writable','280516UynWsH','findAll','prototype','type','map','date','message','../utils/useDate','../services/ContactServices/ImportXLSContactsService','../services/TicketServices/UpdateTicketService','../services/InvoicesService/UpdateInvoiceService','acceptAudioMessage','../helpers/SendPresenceStatus','../models/Queue','json','handleAudioLink','UsedOnDay','updateContacts','findOrCreateContacts','disableBot','(((.+)+)+)+$','Not\x20exists\x20on\x20Whatsapp','updateCompany','Error\x20removing\x20all\x20contacts:','emit','whatsapp','update','makeid','index','defineProperty','caption','removeTicketTag','../services/TicketServices/ShowTicketService','blockCompany','updateQueueId','Contact\x20deleted','ERRO','ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789','hasOwnProperty','../libs/socket','../models/Invoices','pdf','active','search','usedVideo','onWhatsApp','dataValues','listTicketsByCompany','toISOString','includes','extname','name','../models/ApiUsages','split','params','.mp3','4GzVSqk'];a9_0x6c18=function(){return _0x5b6de0;};return a9_0x6c18();}'use strict';var __createBinding=this&&this['__createBinding']||(Object['create']?function(_0x1455d0,_0x5b9798,_0x58312d,_0x59fc77){const _0x364be1=a9_0x41ce;if(_0x59fc77===undefined)_0x59fc77=_0x58312d;var _0x3f8791=Object['getOwnPropertyDescriptor'](_0x5b9798,_0x58312d);(!_0x3f8791||('get'in _0x3f8791?!_0x5b9798['__esModule']:_0x3f8791[_0x364be1(0x1ba)]||_0x3f8791['configurable']))&&(_0x3f8791={'enumerable':!![],'get':function(){return _0x5b9798[_0x58312d];}}),Object[_0x364be1(0x1d8)](_0x1455d0,_0x59fc77,_0x3f8791);}:function(_0x5d4064,_0x23c4b8,_0x4f3241,_0x6674ef){if(_0x6674ef===undefined)_0x6674ef=_0x4f3241;_0x5d4064[_0x6674ef]=_0x23c4b8[_0x4f3241];}),__setModuleDefault=this&&this[a9_0xf755ab(0x17f)]||(Object[a9_0xf755ab(0x19b)]?function(_0x392301,_0x1a7987){Object['defineProperty'](_0x392301,'default',{'enumerable':!![],'value':_0x1a7987});}:function(_0x1fd456,_0x3c81f6){const _0x4d7e99=a9_0xf755ab;_0x1fd456[_0x4d7e99(0x19f)]=_0x3c81f6;}),__importStar=this&&this[a9_0xf755ab(0x1ac)]||function(_0x20a8e0){const _0x51f8b5=a9_0xf755ab;if(_0x20a8e0&&_0x20a8e0[_0x51f8b5(0x1a3)])return _0x20a8e0;var _0x519ba6={};if(_0x20a8e0!=null){for(var _0x458f6d in _0x20a8e0)if(_0x458f6d!==_0x51f8b5(0x19f)&&Object[_0x51f8b5(0x1bd)][_0x51f8b5(0x1e1)][_0x51f8b5(0x161)](_0x20a8e0,_0x458f6d))__createBinding(_0x519ba6,_0x20a8e0,_0x458f6d);}return __setModuleDefault(_0x519ba6,_0x20a8e0),_0x519ba6;},__importDefault=this&&this['__importDefault']||function(_0x4c7b5b){const _0x3a0b2d=a9_0xf755ab;return _0x4c7b5b&&_0x4c7b5b[_0x3a0b2d(0x1a3)]?_0x4c7b5b:{'default':_0x4c7b5b};};Object[a9_0xf755ab(0x1d8)](exports,'__esModule',{'value':!![]}),exports[a9_0xf755ab(0x20a)]=exports[a9_0xf755ab(0x169)]=exports[a9_0xf755ab(0x1b9)]=exports[a9_0xf755ab(0x1cc)]=exports[a9_0xf755ab(0x18e)]=exports['storeContacts']=exports[a9_0xf755ab(0x1cd)]=exports[a9_0xf755ab(0x195)]=exports[a9_0xf755ab(0x202)]=exports[a9_0xf755ab(0x210)]=exports[a9_0xf755ab(0x22d)]=exports['updateApi']=exports[a9_0xf755ab(0x1f9)]=exports[a9_0xf755ab(0x1a4)]=exports[a9_0xf755ab(0x18f)]=exports[a9_0xf755ab(0x1ca)]=exports[a9_0xf755ab(0x1d6)]=exports['listTicketsByTagIsAuth']=exports[a9_0xf755ab(0x17a)]=exports[a9_0xf755ab(0x1ea)]=exports['removeTicketTag']=exports['updateTicketTag']=exports['closeTicket']=exports[a9_0xf755ab(0x1dd)]=exports[a9_0xf755ab(0x1ae)]=exports['checkNumber']=exports['indexImage']=exports[a9_0xf755ab(0x1d7)]=exports[a9_0xf755ab(0x179)]=exports[a9_0xf755ab(0x1dc)]=exports[a9_0xf755ab(0x1d1)]=exports[a9_0xf755ab(0x189)]=exports[a9_0xf755ab(0x212)]=void 0x0;const axios_1=__importDefault(require(a9_0xf755ab(0x167))),fs_1=__importDefault(require('fs')),Yup=__importStar(require(a9_0xf755ab(0x182))),lodash_1=require(a9_0xf755ab(0x216)),GetDefaultWhatsApp_1=__importDefault(require(a9_0xf755ab(0x15d))),SetTicketMessagesAsRead_1=__importDefault(require(a9_0xf755ab(0x1a5))),socket_1=require(a9_0xf755ab(0x1e2)),Whatsapp_1=__importDefault(require(a9_0xf755ab(0x1a8))),Queue_1=__importDefault(require(a9_0xf755ab(0x1c8))),User_1=__importDefault(require(a9_0xf755ab(0x18c))),CreateOrUpdateContactService_1=__importDefault(require(a9_0xf755ab(0x178))),FindOrCreateTicketService_1=__importDefault(require(a9_0xf755ab(0x18b))),ShowTicketService_1=__importDefault(require(a9_0xf755ab(0x1db))),GetProfilePicUrl_1=__importDefault(require(a9_0xf755ab(0x218))),SendWhatsAppMedia_1=__importDefault(require(a9_0xf755ab(0x16b))),UpdateTicketService_1=__importDefault(require(a9_0xf755ab(0x1c4))),wbot_1=require('../libs/wbot'),SendWhatsAppMessageLink_1=__importDefault(require('../services/WbotServices/SendWhatsAppMessageLink')),SendWhatsAppMessageAPI_1=__importDefault(require('../services/WbotServices/SendWhatsAppMessageAPI')),SendWhatsappMediaImage_1=__importDefault(require(a9_0xf755ab(0x194))),ListInvoicesServices_1=__importDefault(require(a9_0xf755ab(0x184))),ShowInvoiceService_1=__importDefault(require(a9_0xf755ab(0x231))),UpdateInvoiceService_1=__importDefault(require(a9_0xf755ab(0x1c5))),Invoices_1=__importDefault(require(a9_0xf755ab(0x1e3))),ListContactsService_1=__importDefault(require('../services/ContactServices/ListContactsService')),CreateContactService_1=__importDefault(require('../services/ContactServices/CreateContactService')),ShowContactService_1=__importDefault(require('../services/ContactServices/ShowContactService')),UpdateContactService_1=__importDefault(require(a9_0xf755ab(0x15c))),DeleteContactService_1=__importDefault(require('../services/ContactServices/DeleteContactService')),GetContactService_1=__importDefault(require(a9_0xf755ab(0x1af))),ToggleDisableBotService_1=__importDefault(require(a9_0xf755ab(0x1a1))),CheckNumber_1=__importDefault(require(a9_0xf755ab(0x203))),CheckIsValidContact_1=__importDefault(require(a9_0xf755ab(0x1fa))),AppError_1=__importDefault(require(a9_0xf755ab(0x16a))),SimpleListService_1=__importDefault(require(a9_0xf755ab(0x220))),ImportXLSContactsService_1=require(a9_0xf755ab(0x1c3)),ApiUsages_1=__importDefault(require(a9_0xf755ab(0x1ef))),useDate_1=require(a9_0xf755ab(0x1c2)),TicketTag_1=__importDefault(require(a9_0xf755ab(0x1b4))),Tag_1=__importDefault(require('../models/Tag')),moment_1=__importDefault(require(a9_0xf755ab(0x1fb))),path_1=__importDefault(require(a9_0xf755ab(0x20b))),Ticket_1=__importDefault(require('../models/Ticket')),Contact_1=__importDefault(require(a9_0xf755ab(0x21b))),Company_1=__importDefault(require(a9_0xf755ab(0x228))),SendPresenceStatus_1=require(a9_0xf755ab(0x1c7));class OnWhatsAppDto{constructor(_0x53968e,_0x357fdb){const _0x124e4c=a9_0xf755ab;this[_0x124e4c(0x224)]=_0x53968e,this[_0x124e4c(0x1b2)]=_0x357fdb;}}exports[a9_0xf755ab(0x212)]=OnWhatsAppDto;const CompanySchema=Yup[a9_0xf755ab(0x180)]()[a9_0xf755ab(0x227)]({'name':Yup[a9_0xf755ab(0x191)]()[a9_0xf755ab(0x21c)](),'id':Yup[a9_0xf755ab(0x1ff)](),'phone':Yup[a9_0xf755ab(0x191)]()[a9_0xf755ab(0x197)](),'email':Yup[a9_0xf755ab(0x191)]()[a9_0xf755ab(0x1aa)]()[a9_0xf755ab(0x197)](),'status':Yup['boolean']()[a9_0xf755ab(0x197)](),'planId':Yup['number']()[a9_0xf755ab(0x197)](),'campaignsEnabled':Yup['boolean']()['nullable'](),'dueDate':Yup[a9_0xf755ab(0x1c0)]()[a9_0xf755ab(0x197)](),'recurrence':Yup[a9_0xf755ab(0x191)]()[a9_0xf755ab(0x197)]()}),createCompany=async(_0x194df6,_0xf5b674)=>{const _0x30d850=a9_0xf755ab;try{await CompanySchema[_0x30d850(0x17b)](_0x194df6['body']);const _0x5838c0=await Company_1[_0x30d850(0x19f)][_0x30d850(0x19b)](_0x194df6[_0x30d850(0x222)]);_0xf5b674[_0x30d850(0x188)](0xc9)[_0x30d850(0x1c9)](_0x5838c0);}catch(_0x2cdc57){_0xf5b674[_0x30d850(0x188)](0x190)[_0x30d850(0x1c9)]({'error':_0x2cdc57[_0x30d850(0x1c1)]});}};exports[a9_0xf755ab(0x189)]=createCompany;const updateCompany=async(_0xcb0ab6,_0xa422b3)=>{const _0x17421a=a9_0xf755ab;try{await CompanySchema[_0x17421a(0x17b)](_0xcb0ab6['body']);const {id:_0x5b3260}=_0xcb0ab6['params'],[_0x5f1059]=await Company_1[_0x17421a(0x19f)]['update'](_0xcb0ab6[_0x17421a(0x222)],{'where':{'id':_0x5b3260}});if(_0x5f1059){const _0x104b07=await Company_1[_0x17421a(0x19f)][_0x17421a(0x209)](_0x5b3260);_0xa422b3[_0x17421a(0x188)](0xc8)[_0x17421a(0x1c9)](_0x104b07);}else _0xa422b3['status'](0x194)[_0x17421a(0x1c9)]({'error':_0x17421a(0x21a)});}catch(_0x5bc890){_0xa422b3['status'](0x190)[_0x17421a(0x1c9)]({'error':_0x5bc890[_0x17421a(0x1c1)]});}};exports[a9_0xf755ab(0x1d1)]=updateCompany;const blockCompany=async(_0x37a505,_0x4dca08)=>{const _0x542d19=a9_0xf755ab;try{const {id:_0x577b17}=_0x37a505[_0x542d19(0x1f1)],[_0x525069]=await Company_1[_0x542d19(0x19f)][_0x542d19(0x1d5)]({'status':![]},{'where':{'id':_0x577b17}});if(_0x525069){const _0x2a561e=await Company_1['default'][_0x542d19(0x209)](_0x577b17);_0x4dca08['status'](0xc8)[_0x542d19(0x1c9)](_0x2a561e);}else _0x4dca08[_0x542d19(0x188)](0x194)[_0x542d19(0x1c9)]({'error':'Company\x20not\x20found'});}catch(_0x287445){_0x4dca08['status'](0x190)['json']({'error':_0x287445['message']});}};exports[a9_0xf755ab(0x1dc)]=blockCompany;const createContact=async(_0x23b486,_0x2d8cb9,_0x56b7ac)=>{const _0x521391=a9_0xf755ab;await(0x0,CheckIsValidContact_1['default'])(_0x56b7ac,_0x2d8cb9);const _0x23dc50=await(0x0,CheckNumber_1[_0x521391(0x19f)])(_0x56b7ac,_0x2d8cb9),_0xbd7f70=await(0x0,GetProfilePicUrl_1['default'])(_0x23dc50,_0x2d8cb9),_0x26f874=_0x23dc50,_0x44f908={'name':''+_0x26f874,'number':_0x26f874,'profilePicUrl':_0xbd7f70,'isGroup':![],'companyId':_0x2d8cb9},_0x36d7ff=await(0x0,CreateOrUpdateContactService_1[_0x521391(0x19f)])(_0x44f908,null,null);let _0x45c2de;if(_0x23b486===undefined)_0x45c2de=await(0x0,GetDefaultWhatsApp_1[_0x521391(0x19f)])(_0x2d8cb9);else{_0x45c2de=await Whatsapp_1[_0x521391(0x19f)][_0x521391(0x209)](_0x23b486);if(_0x45c2de===null)throw new AppError_1[(_0x521391(0x19f))](_0x521391(0x1b8)+_0x23b486+_0x521391(0x1ab));}const _0x5fc5b2=await(0x0,FindOrCreateTicketService_1[_0x521391(0x19f)])(_0x36d7ff,_0x45c2de['id'],0x0,_0x2d8cb9),_0x180bfc=await(0x0,ShowTicketService_1[_0x521391(0x19f)])(_0x5fc5b2['id'],_0x2d8cb9);return(0x0,SetTicketMessagesAsRead_1[_0x521391(0x19f)])(_0x180bfc),_0x180bfc;};function formatBRNumber(_0x23bac2){const _0x1e5427=a9_0xf755ab,_0xb2d701=new RegExp(/^(\d{2})(\d{2})\d{1}(\d{8})$/);if(_0xb2d701['test'](_0x23bac2)){const _0x100db9=_0xb2d701[_0x1e5427(0x215)](_0x23bac2);if(_0x100db9&&_0x100db9[0x1]==='55'&&Number[_0x1e5427(0x181)](Number['parseInt'](_0x100db9[0x2]))){const _0x3d3adc=Number[_0x1e5427(0x1f8)](_0x100db9[0x2]);if(_0x3d3adc<0x1f)return _0x100db9[0x0];else{if(_0x3d3adc>=0x1f)return _0x100db9[0x1]+_0x100db9[0x2]+_0x100db9[0x3];}}}else return _0x23bac2;}function createJid(_0x5a8c7e){const _0x1ae23c=a9_0xf755ab;if(_0x5a8c7e['includes'](_0x1ae23c(0x171))||_0x5a8c7e['includes']('@s.whatsapp.net'))return formatBRNumber(_0x5a8c7e);return _0x5a8c7e[_0x1ae23c(0x1ec)]('-')?_0x5a8c7e+'@g.us':formatBRNumber(_0x5a8c7e)+'@s.whatsapp.net';}const indexLink=async(_0x4903dc,_0x4988f1)=>{const _0xf3d3ed=a9_0xf755ab,_0x228fce=_0x4903dc[_0xf3d3ed(0x222)],{whatsappId:_0xb0f73b}=_0x4903dc[_0xf3d3ed(0x222)],{msdelay:_0x505e4f}=_0x4903dc['body'],_0x36f976=_0x4903dc[_0xf3d3ed(0x222)][_0xf3d3ed(0x17d)],_0x321339=_0x4903dc[_0xf3d3ed(0x222)][_0xf3d3ed(0x1d9)],_0x275bd1=_0x4903dc['headers'][_0xf3d3ed(0x19a)],[,_0x465ae0]=_0x275bd1[_0xf3d3ed(0x1f0)]('\x20'),_0x233ef8=await Whatsapp_1[_0xf3d3ed(0x19f)][_0xf3d3ed(0x175)]({'where':{'token':_0x465ae0}}),_0x41e2c8=_0x233ef8[_0xf3d3ed(0x19d)];_0x228fce['number']=_0x228fce[_0xf3d3ed(0x1ff)][_0xf3d3ed(0x168)]('-','')[_0xf3d3ed(0x168)]('\x20','');const _0x58e3e9=Yup[_0xf3d3ed(0x180)]()[_0xf3d3ed(0x227)]({'number':Yup[_0xf3d3ed(0x191)]()[_0xf3d3ed(0x21c)]()[_0xf3d3ed(0x162)](/^\d+$/,_0xf3d3ed(0x20c))});try{await _0x58e3e9[_0xf3d3ed(0x17b)](_0x228fce);}catch(_0x21388e){throw new AppError_1['default'](_0x21388e['message']);}const _0x4cb1a8=await createContact(_0xb0f73b,_0x41e2c8,_0x228fce[_0xf3d3ed(0x1ff)]);return await(0x0,SendWhatsAppMessageLink_1[_0xf3d3ed(0x19f)])({'ticket':_0x4cb1a8,'url':_0x36f976,'caption':_0x321339,'msdelay':_0x505e4f}),setTimeout(async()=>{const _0x414766=_0xf3d3ed;await(0x0,UpdateTicketService_1[_0x414766(0x19f)])({'ticketId':_0x4cb1a8['id'],'ticketData':{'status':_0x414766(0x1b7),'sendFarewellMessage':![],'amountUsedBotQueues':0x0},'companyId':_0x41e2c8});},0xc8),setTimeout(async()=>{const _0x56dd80=_0xf3d3ed,{dateToClient:_0x2d8980}=(0x0,useDate_1['useDate'])(),_0x4ace98=_0x2d8980(new Date()['toString']()),_0x47f035=(0x0,moment_1[_0x56dd80(0x19f)])()[_0x56dd80(0x22e)](),_0x24452=await ApiUsages_1[_0x56dd80(0x19f)][_0x56dd80(0x175)]({'where':{'dateUsed':_0x4ace98,'companyId':_0x41e2c8}});if(_0x24452)await _0x24452[_0x56dd80(0x1d5)]({'usedPDF':_0x24452[_0x56dd80(0x1e9)][_0x56dd80(0x165)]+0x1,'UsedOnDay':_0x24452[_0x56dd80(0x1e9)][_0x56dd80(0x1cb)]+0x1,'updatedAt':_0x47f035});else{const _0x20a7dc=await ApiUsages_1['default'][_0x56dd80(0x19b)]({'companyId':_0x41e2c8,'dateUsed':_0x4ace98});await _0x20a7dc[_0x56dd80(0x1d5)]({'usedPDF':_0x20a7dc['dataValues'][_0x56dd80(0x165)]+0x1,'UsedOnDay':_0x20a7dc[_0x56dd80(0x1e9)]['UsedOnDay']+0x1,'updatedAt':_0x47f035});}},0x64),_0x4988f1['send']({'status':_0xf3d3ed(0x21d)});};exports[a9_0xf755ab(0x179)]=indexLink;const index=async(_0x46d3d1,_0x3d0ba8)=>{const _0x1f64ba=a9_0xf755ab,_0x401679=_0x46d3d1[_0x1f64ba(0x222)],{whatsappId:_0x2e9250}=_0x46d3d1['body'],{msdelay:_0x15a93e}=_0x46d3d1[_0x1f64ba(0x222)],{body:_0x513b44,quotedMsg:_0x217ad3}=_0x46d3d1[_0x1f64ba(0x222)],_0x16734e=_0x46d3d1['files'],_0x448d4a=_0x46d3d1['headers'][_0x1f64ba(0x19a)],[,_0x4c01bb]=_0x448d4a[_0x1f64ba(0x1f0)]('\x20'),_0x44966a=await Whatsapp_1[_0x1f64ba(0x19f)][_0x1f64ba(0x175)]({'where':{'token':_0x4c01bb}}),_0x4aa68b=_0x44966a['companyId'];_0x401679[_0x1f64ba(0x1ff)]=_0x401679['number'][_0x1f64ba(0x168)]('-','')[_0x1f64ba(0x168)]('\x20','');const _0x2369bc=Yup[_0x1f64ba(0x180)]()[_0x1f64ba(0x227)]({'number':Yup['string']()[_0x1f64ba(0x21c)]()[_0x1f64ba(0x162)](/^\d+$/,_0x1f64ba(0x20c))});try{await _0x2369bc[_0x1f64ba(0x17b)](_0x401679);}catch(_0x4ac6de){throw new AppError_1[(_0x1f64ba(0x19f))](_0x4ac6de['message']);}const _0xaf1442=await createContact(_0x2e9250,_0x4aa68b,_0x401679[_0x1f64ba(0x1ff)]);return _0x16734e?await Promise[_0x1f64ba(0x185)](_0x16734e[_0x1f64ba(0x1bf)](async _0x57231d=>{await(0x0,SendWhatsAppMedia_1['default'])({'body':_0x513b44,'media':_0x57231d,'ticket':_0xaf1442});})):await(0x0,SendWhatsAppMessageAPI_1['default'])({'body':_0x513b44,'ticket':_0xaf1442,'quotedMsg':_0x217ad3,'msdelay':_0x15a93e}),setTimeout(async()=>{const _0x5eb98d=_0x1f64ba;await(0x0,UpdateTicketService_1[_0x5eb98d(0x19f)])({'ticketId':_0xaf1442['id'],'ticketData':{'status':'pending','sendFarewellMessage':![],'amountUsedBotQueues':0x0},'companyId':_0x4aa68b});},0x64),setTimeout(async()=>{const _0x26780f=_0x1f64ba,{dateToClient:_0x3c6ab5}=(0x0,useDate_1[_0x26780f(0x16d)])(),_0x10e562=_0x3c6ab5(new Date()[_0x26780f(0x192)]()),_0x2e0633=(0x0,moment_1[_0x26780f(0x19f)])()[_0x26780f(0x22e)](),_0x859295=await ApiUsages_1[_0x26780f(0x19f)]['findOne']({'where':{'dateUsed':_0x10e562,'companyId':_0x4aa68b}});_0x859295?_0x16734e?await Promise[_0x26780f(0x185)](_0x16734e[_0x26780f(0x1bf)](async _0x35fb00=>{const _0x2c0db4=_0x26780f;console['log'](_0x2c0db4(0x187),_0x35fb00);const _0x301e11=path_1['default'][_0x2c0db4(0x1ed)](_0x35fb00[_0x2c0db4(0x177)]);console[_0x2c0db4(0x1a0)](_0x2c0db4(0x1be),_0x301e11);if(_0x35fb00[_0x2c0db4(0x198)]['includes']('pdf'))await _0x859295[_0x2c0db4(0x1d5)]({'usedPDF':_0x859295[_0x2c0db4(0x1e9)][_0x2c0db4(0x165)]+0x1,'UsedOnDay':_0x859295[_0x2c0db4(0x1e9)][_0x2c0db4(0x1cb)]+0x1,'updatedAt':_0x2e0633});else{if(_0x35fb00[_0x2c0db4(0x198)][_0x2c0db4(0x1ec)]('image'))await _0x859295['update']({'usedImage':_0x859295[_0x2c0db4(0x1e9)][_0x2c0db4(0x193)]+0x1,'UsedOnDay':_0x859295[_0x2c0db4(0x1e9)][_0x2c0db4(0x1cb)]+0x1,'updatedAt':_0x2e0633});else _0x35fb00[_0x2c0db4(0x198)][_0x2c0db4(0x1ec)]('video')?await _0x859295['update']({'usedVideo':_0x859295[_0x2c0db4(0x1e9)][_0x2c0db4(0x1e7)]+0x1,'UsedOnDay':_0x859295[_0x2c0db4(0x1e9)]['UsedOnDay']+0x1,'updatedAt':_0x2e0633}):await _0x859295[_0x2c0db4(0x1d5)]({'usedOther':_0x859295['dataValues'][_0x2c0db4(0x1a2)]+0x1,'UsedOnDay':_0x859295[_0x2c0db4(0x1e9)][_0x2c0db4(0x1cb)]+0x1,'updatedAt':_0x2e0633});}})):await _0x859295['update']({'usedText':_0x859295[_0x26780f(0x1e9)]['usedText']+0x1,'UsedOnDay':_0x859295['dataValues'][_0x26780f(0x1cb)]+0x1,'updatedAt':_0x2e0633}):(await ApiUsages_1[_0x26780f(0x19f)]['create']({'companyId':_0x4aa68b,'dateUsed':_0x10e562}),_0x16734e?await Promise[_0x26780f(0x185)](_0x16734e[_0x26780f(0x1bf)](async _0x446e62=>{const _0x8c2f7c=_0x26780f;console[_0x8c2f7c(0x1a0)](_0x8c2f7c(0x187),_0x446e62);const _0x1c025b=path_1[_0x8c2f7c(0x19f)][_0x8c2f7c(0x1ed)](_0x446e62[_0x8c2f7c(0x177)]);console[_0x8c2f7c(0x1a0)](_0x8c2f7c(0x1be),_0x1c025b);if(_0x446e62[_0x8c2f7c(0x198)][_0x8c2f7c(0x1ec)](_0x8c2f7c(0x1e4)))await _0x859295[_0x8c2f7c(0x1d5)]({'usedPDF':_0x859295[_0x8c2f7c(0x1e9)][_0x8c2f7c(0x165)]+0x1,'UsedOnDay':_0x859295[_0x8c2f7c(0x1e9)][_0x8c2f7c(0x1cb)]+0x1,'updatedAt':_0x2e0633});else{if(_0x446e62['mimetype'][_0x8c2f7c(0x1ec)](_0x8c2f7c(0x22c)))await _0x859295['update']({'usedImage':_0x859295[_0x8c2f7c(0x1e9)][_0x8c2f7c(0x193)]+0x1,'UsedOnDay':_0x859295[_0x8c2f7c(0x1e9)]['UsedOnDay']+0x1,'updatedAt':_0x2e0633});else _0x446e62['mimetype'][_0x8c2f7c(0x1ec)](_0x8c2f7c(0x16f))?await _0x859295[_0x8c2f7c(0x1d5)]({'usedVideo':_0x859295[_0x8c2f7c(0x1e9)][_0x8c2f7c(0x1e7)]+0x1,'UsedOnDay':_0x859295[_0x8c2f7c(0x1e9)]['UsedOnDay']+0x1,'updatedAt':_0x2e0633}):await _0x859295[_0x8c2f7c(0x1d5)]({'usedOther':_0x859295[_0x8c2f7c(0x1e9)][_0x8c2f7c(0x1a2)]+0x1,'UsedOnDay':_0x859295[_0x8c2f7c(0x1e9)]['UsedOnDay']+0x1,'updatedAt':_0x2e0633});}})):await _0x859295[_0x26780f(0x1d5)]({'usedText':_0x859295[_0x26780f(0x1e9)][_0x26780f(0x1b6)]+0x1,'UsedOnDay':_0x859295['dataValues']['UsedOnDay']+0x1,'updatedAt':_0x2e0633}));},0x64),_0x3d0ba8[_0x1f64ba(0x18a)]({'status':'SUCCESS'});};exports[a9_0xf755ab(0x1d7)]=index;const indexImage=async(_0x265563,_0xe3be23)=>{const _0x53ebc9=a9_0xf755ab,_0x4a2dc2=_0x265563['body'],{whatsappId:_0x111979}=_0x265563[_0x53ebc9(0x222)],{msdelay:_0x1bce85}=_0x265563[_0x53ebc9(0x222)],_0x162d4b=_0x265563[_0x53ebc9(0x222)]['url'],_0x2be721=_0x265563[_0x53ebc9(0x222)]['caption'],_0xb7e208=_0x265563['headers'][_0x53ebc9(0x19a)],[,_0x7f651f]=_0xb7e208[_0x53ebc9(0x1f0)]('\x20'),_0x13e188=await Whatsapp_1[_0x53ebc9(0x19f)]['findOne']({'where':{'token':_0x7f651f}}),_0x210890=_0x13e188[_0x53ebc9(0x19d)];_0x4a2dc2[_0x53ebc9(0x1ff)]=_0x4a2dc2[_0x53ebc9(0x1ff)][_0x53ebc9(0x168)]('-','')[_0x53ebc9(0x168)]('\x20','');const _0x434b1d=Yup[_0x53ebc9(0x180)]()['shape']({'number':Yup[_0x53ebc9(0x191)]()['required']()['matches'](/^\d+$/,'Invalid\x20number\x20format.\x20Only\x20numbers\x20is\x20allowed.')});try{await _0x434b1d[_0x53ebc9(0x17b)](_0x4a2dc2);}catch(_0x2344e8){throw new AppError_1['default'](_0x2344e8[_0x53ebc9(0x1c1)]);}const _0x5618e0=await createContact(_0x111979,_0x210890,_0x4a2dc2[_0x53ebc9(0x1ff)]);return _0x162d4b&&await(0x0,SendWhatsappMediaImage_1['default'])({'ticket':_0x5618e0,'url':_0x162d4b,'caption':_0x2be721,'msdelay':_0x1bce85}),setTimeout(async()=>{const _0x467e9e=_0x53ebc9;await(0x0,UpdateTicketService_1[_0x467e9e(0x19f)])({'ticketId':_0x5618e0['id'],'ticketData':{'status':_0x467e9e(0x1b7),'sendFarewellMessage':![],'amountUsedBotQueues':0x0},'companyId':_0x210890});},0x64),setTimeout(async()=>{const _0x49d824=_0x53ebc9,{dateToClient:_0x16a0b7}=(0x0,useDate_1[_0x49d824(0x16d)])(),_0x286ad6=_0x16a0b7(new Date()[_0x49d824(0x192)]()),_0x1c6cb7=(0x0,moment_1[_0x49d824(0x19f)])()[_0x49d824(0x22e)](),_0x38b224=await ApiUsages_1[_0x49d824(0x19f)][_0x49d824(0x175)]({'where':{'dateUsed':_0x286ad6,'companyId':_0x210890}});if(_0x38b224)await _0x38b224[_0x49d824(0x1d5)]({'usedImage':_0x38b224[_0x49d824(0x1e9)][_0x49d824(0x193)]+0x1,'UsedOnDay':_0x38b224[_0x49d824(0x1e9)]['UsedOnDay']+0x1,'updatedAt':_0x1c6cb7});else{const _0x26abed=await ApiUsages_1[_0x49d824(0x19f)][_0x49d824(0x19b)]({'companyId':_0x210890,'dateUsed':_0x286ad6});await _0x26abed[_0x49d824(0x1d5)]({'usedImage':_0x26abed[_0x49d824(0x1e9)][_0x49d824(0x193)]+0x1,'UsedOnDay':_0x26abed[_0x49d824(0x1e9)][_0x49d824(0x1cb)]+0x1,'updatedAt':_0x1c6cb7});}},0x64),_0xe3be23['send']({'status':_0x53ebc9(0x21d)});};exports['indexImage']=indexImage;const checkNumber=async(_0x53b63e,_0x1ccb40)=>{const _0x2f2c27=a9_0xf755ab,_0x23e254=_0x53b63e[_0x2f2c27(0x222)],_0x50f9dc=_0x53b63e[_0x2f2c27(0x172)]['authorization'],[,_0x12fe5f]=_0x50f9dc[_0x2f2c27(0x1f0)]('\x20'),_0x4e4ed0=await Whatsapp_1[_0x2f2c27(0x19f)]['findOne']({'where':{'token':_0x12fe5f}}),_0x3769fc=_0x4e4ed0['companyId'],_0x16d141=_0x23e254['number'][_0x2f2c27(0x168)]('-','')['replace']('\x20',''),_0x356f13=await(0x0,GetDefaultWhatsApp_1['default'])(_0x3769fc),_0x39be7e=(0x0,wbot_1[_0x2f2c27(0x186)])(_0x356f13['id']),_0x30d063=createJid(_0x16d141);try{const [_0x36409e]=await _0x39be7e[_0x2f2c27(0x1e8)](_0x30d063);if(_0x36409e['exists'])return setTimeout(async()=>{const _0x2ee58a=_0x2f2c27,{dateToClient:_0xdda996}=(0x0,useDate_1[_0x2ee58a(0x16d)])(),_0x4afda6=_0xdda996(new Date()['toString']()),_0x1e76ba=(0x0,moment_1['default'])()[_0x2ee58a(0x22e)](),_0x2a9a1e=await ApiUsages_1['default'][_0x2ee58a(0x175)]({'where':{'dateUsed':_0x4afda6,'companyId':_0x3769fc}});if(_0x2a9a1e)await _0x2a9a1e['update']({'usedCheckNumber':_0x2a9a1e[_0x2ee58a(0x1e9)]['usedCheckNumber']+0x1,'UsedOnDay':_0x2a9a1e[_0x2ee58a(0x1e9)][_0x2ee58a(0x1cb)]+0x1,'updatedAt':_0x1e76ba});else{const _0x337f38=await ApiUsages_1[_0x2ee58a(0x19f)][_0x2ee58a(0x19b)]({'companyId':_0x3769fc,'dateUsed':_0x4afda6});await _0x337f38[_0x2ee58a(0x1d5)]({'usedCheckNumber':_0x337f38['dataValues'][_0x2ee58a(0x176)]+0x1,'UsedOnDay':_0x337f38[_0x2ee58a(0x1e9)][_0x2ee58a(0x1cb)]+0x1,'updatedAt':_0x1e76ba});}},0x64),_0x1ccb40['status'](0xc8)['json']({'existsInWhatsapp':!![],'number':_0x16d141,'numberFormatted':_0x36409e[_0x2f2c27(0x224)]});}catch(_0x3babe){return _0x1ccb40[_0x2f2c27(0x188)](0x190)[_0x2f2c27(0x1c9)]({'existsInWhatsapp':![],'number':_0x30d063,'error':_0x2f2c27(0x1d0)});}};exports[a9_0xf755ab(0x1b5)]=checkNumber;const indexWhatsappsId=async(_0x185946,_0x3bce6b)=>{const _0x402808=a9_0xf755ab;return console[_0x402808(0x1a0)](_0x402808(0x1fe),_0x185946),console[_0x402808(0x1a0)](_0x402808(0x1fe),_0x185946[_0x402808(0x183)]),_0x3bce6b[_0x402808(0x188)](0xc8)[_0x402808(0x1c9)]('oi');};exports[a9_0xf755ab(0x1ae)]=indexWhatsappsId;const updateQueueId=async(_0x52fcbf,_0x204e8f)=>{const _0x5d68a4=a9_0xf755ab,{ticketId:_0xf4b66}=_0x52fcbf[_0x5d68a4(0x1f1)],{queueId:_0x2d171d}=_0x52fcbf['body'],_0x3be3dd=_0x52fcbf[_0x5d68a4(0x172)]['authorization'],[,_0x5739b8]=_0x3be3dd[_0x5d68a4(0x1f0)]('\x20'),_0x534018=await Whatsapp_1[_0x5d68a4(0x19f)][_0x5d68a4(0x175)]({'where':{'token':_0x5739b8}}),_0x147a18=_0x534018[_0x5d68a4(0x19d)];try{const _0x3a0ae7=await Queue_1['default']['findOne']({'where':{'id':_0x2d171d,'companyId':_0x147a18}});if(!_0x3a0ae7)return _0x204e8f[_0x5d68a4(0x188)](0x190)[_0x5d68a4(0x1c9)]({'status':_0x5d68a4(0x173),'error':'Invalid\x20queue\x20for\x20the\x20company'});return await(0x0,UpdateTicketService_1[_0x5d68a4(0x19f)])({'ticketId':_0xf4b66,'ticketData':{'queueId':_0x2d171d},'companyId':_0x147a18}),_0x204e8f[_0x5d68a4(0x188)](0xc8)[_0x5d68a4(0x1c9)]({'status':_0x5d68a4(0x21d)});}catch(_0x3349ce){return console[_0x5d68a4(0x223)](_0x3349ce),_0x204e8f[_0x5d68a4(0x188)](0x1f4)[_0x5d68a4(0x1c9)]({'status':_0x5d68a4(0x173),'error':_0x5d68a4(0x207)});}};exports['updateQueueId']=updateQueueId;const closeTicket=async(_0x201532,_0x5785e4)=>{const _0x331be4=a9_0xf755ab,_0x1cfc27=_0x201532[_0x331be4(0x172)][_0x331be4(0x19a)],[,_0x24e7af]=_0x1cfc27[_0x331be4(0x1f0)]('\x20'),_0x5ce2e9=await Whatsapp_1[_0x331be4(0x19f)]['findOne']({'where':{'token':_0x24e7af}}),_0x1c193c=_0x5ce2e9['companyId'],{ticketId:_0x559adf}=_0x201532['params'],_0x673976=await(0x0,ShowTicketService_1[_0x331be4(0x19f)])(_0x559adf,_0x1c193c);_0x673976[_0x331be4(0x188)]=_0x201532[_0x331be4(0x222)][_0x331be4(0x17c)]['status'],console[_0x331be4(0x1a0)](_0x673976[_0x331be4(0x188)]);const {ticket:_0x197f21}=await(0x0,UpdateTicketService_1[_0x331be4(0x19f)])({'ticketData':_0x673976,'ticketId':_0x559adf,'companyId':_0x1c193c});return _0x5785e4[_0x331be4(0x188)](0xc8)[_0x331be4(0x1c9)](_0x197f21);};exports['closeTicket']=closeTicket;const updateTicketTag=async(_0x173013,_0x79579e)=>{const _0x4dfb14=a9_0xf755ab,{ticketId:_0x5c9a3c,tagId:_0xada893}=_0x173013[_0x4dfb14(0x222)],_0x542bab=_0x173013[_0x4dfb14(0x172)][_0x4dfb14(0x19a)],[,_0x5b42a7]=_0x542bab[_0x4dfb14(0x1f0)]('\x20');try{const _0x5807a2=await Whatsapp_1[_0x4dfb14(0x19f)][_0x4dfb14(0x175)]({'where':{'token':_0x5b42a7}}),_0x585e94=_0x5807a2[_0x4dfb14(0x19d)],_0x498392=await Tag_1[_0x4dfb14(0x19f)][_0x4dfb14(0x175)]({'where':{'id':_0xada893,'companyId':_0x585e94}});if(!_0x498392)return _0x79579e['status'](0x190)['json']({'status':_0x4dfb14(0x173),'error':'Tag\x20does\x20not\x20belong\x20to\x20the\x20specified\x20company'});const _0x2489c9=await TicketTag_1['default'][_0x4dfb14(0x175)]({'where':{'ticketId':_0x5c9a3c,'tagId':_0xada893}});if(_0x2489c9)return _0x79579e['status'](0x190)['json']({'status':'ERROR','error':_0x4dfb14(0x221)});const _0x7d4f63=await TicketTag_1[_0x4dfb14(0x19f)]['create']({'ticketId':_0x5c9a3c,'tagId':_0xada893});return _0x79579e[_0x4dfb14(0x188)](0xc8)[_0x4dfb14(0x1c9)]({'status':_0x4dfb14(0x21d),'ticketTag':_0x7d4f63});}catch(_0x435a14){return console[_0x4dfb14(0x223)](_0x435a14),_0x79579e[_0x4dfb14(0x188)](0x1f4)[_0x4dfb14(0x1c9)]({'status':'ERROR','error':_0x4dfb14(0x190)});}};exports[a9_0xf755ab(0x200)]=updateTicketTag;const removeTicketTag=async(_0x994e61,_0x46a890)=>{const _0x2dbea4=a9_0xf755ab,{ticketId:_0x4444df,tagId:_0x13688d}=_0x994e61['body'];try{const _0x44332c=await TicketTag_1['default']['findOne']({'where':{'ticketId':_0x4444df,'tagId':_0x13688d}});if(!_0x44332c)return _0x46a890[_0x2dbea4(0x188)](0x190)[_0x2dbea4(0x1c9)]({'status':_0x2dbea4(0x173),'error':_0x2dbea4(0x158)});return await _0x44332c['destroy'](),_0x46a890['status'](0xc8)[_0x2dbea4(0x1c9)]({'status':_0x2dbea4(0x21d)});}catch(_0x23f53d){return console[_0x2dbea4(0x223)](_0x23f53d),_0x46a890[_0x2dbea4(0x188)](0x1f4)[_0x2dbea4(0x1c9)]({'status':_0x2dbea4(0x173),'error':_0x2dbea4(0x15f)});}};exports[a9_0xf755ab(0x1da)]=removeTicketTag;const listTicketsByCompany=async(_0x5a79bf,_0xc3fc7e)=>{const _0x45b9b1=a9_0xf755ab,_0x4244c9=_0x5a79bf['headers'][_0x45b9b1(0x19a)],[,_0x39d060]=_0x4244c9[_0x45b9b1(0x1f0)]('\x20'),_0x1c180b=await Whatsapp_1[_0x45b9b1(0x19f)][_0x45b9b1(0x175)]({'where':{'token':_0x39d060}}),_0x1f3a80=_0x1c180b[_0x45b9b1(0x19d)];try{const _0xd68b41=await Ticket_1[_0x45b9b1(0x19f)][_0x45b9b1(0x1bc)]({'where':{'companyId':_0x1f3a80},'include':[{'model':Contact_1[_0x45b9b1(0x19f)],'as':_0x45b9b1(0x1f4),'attributes':['id',_0x45b9b1(0x1ee),'number',_0x45b9b1(0x1aa),'profilePicUrl','acceptAudioMessage','active',_0x45b9b1(0x1ce)],'include':[_0x45b9b1(0x21f)]},{'model':Queue_1['default'],'as':_0x45b9b1(0x159),'attributes':['id',_0x45b9b1(0x1ee),_0x45b9b1(0x196)]},{'model':User_1[_0x45b9b1(0x19f)],'as':_0x45b9b1(0x183),'attributes':['id',_0x45b9b1(0x1ee)]},{'model':Tag_1[_0x45b9b1(0x19f)],'as':'tags','attributes':['id','name',_0x45b9b1(0x196)]},{'model':Whatsapp_1[_0x45b9b1(0x19f)],'as':_0x45b9b1(0x1d4),'attributes':[_0x45b9b1(0x1ee),'facebookUserToken',_0x45b9b1(0x15b)]},{'model':Company_1['default'],'as':_0x45b9b1(0x230),'attributes':['name']}]});return _0xc3fc7e[_0x45b9b1(0x188)](0xc8)['json']({'status':_0x45b9b1(0x21d),'tickets':_0xd68b41});}catch(_0x217fab){return console[_0x45b9b1(0x223)](_0x217fab),_0xc3fc7e[_0x45b9b1(0x188)](0x1f4)[_0x45b9b1(0x1c9)]({'status':_0x45b9b1(0x173),'error':_0x45b9b1(0x207)});}};exports['listTicketsByCompany']=listTicketsByCompany;const listTicketsByTag=async(_0xdd6e13,_0xdb6dd4)=>{const _0x40cec7=a9_0xf755ab,{tagId:_0x4f9701}=_0xdd6e13[_0x40cec7(0x1f1)],_0x5cd34b=_0xdd6e13['headers']['authorization'],[,_0x565c1a]=_0x5cd34b['split']('\x20');try{const _0x745460=await Whatsapp_1[_0x40cec7(0x19f)]['findOne']({'where':{'token':_0x565c1a}}),_0x32597c=_0x745460[_0x40cec7(0x19d)],_0x2c6481=await Tag_1[_0x40cec7(0x19f)][_0x40cec7(0x175)]({'where':{'id':_0x4f9701,'companyId':_0x32597c}});if(!_0x2c6481)return _0xdb6dd4[_0x40cec7(0x188)](0x190)[_0x40cec7(0x1c9)]({'status':_0x40cec7(0x173),'error':'Tag\x20does\x20not\x20belong\x20to\x20the\x20specified\x20company'});const _0x23a67d=await Ticket_1[_0x40cec7(0x19f)]['findAll']({'include':[{'model':Tag_1[_0x40cec7(0x19f)],'as':_0x40cec7(0x219),'attributes':['id',_0x40cec7(0x1ee)],'through':{'attributes':[],'where':{'tagId':_0x4f9701}}},{'model':Contact_1[_0x40cec7(0x19f)],'as':_0x40cec7(0x1f4),'attributes':['id',_0x40cec7(0x1ee),_0x40cec7(0x1ff),'email',_0x40cec7(0x22f),_0x40cec7(0x1c6),_0x40cec7(0x1e5),_0x40cec7(0x1ce)],'include':[_0x40cec7(0x21f)]},{'model':Queue_1[_0x40cec7(0x19f)],'as':'queue','attributes':['id',_0x40cec7(0x1ee),_0x40cec7(0x196)]},{'model':User_1[_0x40cec7(0x19f)],'as':'user','attributes':['id','name']},{'model':Whatsapp_1[_0x40cec7(0x19f)],'as':_0x40cec7(0x1d4),'attributes':[_0x40cec7(0x1ee),'facebookUserToken','facebookUserId']},{'model':Company_1[_0x40cec7(0x19f)],'as':_0x40cec7(0x230),'attributes':[_0x40cec7(0x1ee)]}],'where':{'companyId':_0x32597c,'$tags.id$':_0x4f9701}});return _0xdb6dd4[_0x40cec7(0x188)](0xc8)[_0x40cec7(0x1c9)]({'status':'SUCCESS','tickets':_0x23a67d});}catch(_0x17ce62){return console['error'](_0x17ce62),_0xdb6dd4[_0x40cec7(0x188)](0x1f4)[_0x40cec7(0x1c9)]({'status':_0x40cec7(0x173),'error':_0x40cec7(0x207)});}};exports['listTicketsByTag']=listTicketsByTag;const listTicketsByTagIsAuth=async(_0x2ed4df,_0x42afd9)=>{const _0x28e4a2=a9_0xf755ab,{tagId:_0x2eb2e2}=_0x2ed4df['params'];try{const _0x5b67ad=await Ticket_1[_0x28e4a2(0x19f)][_0x28e4a2(0x1bc)]({'include':[{'model':Contact_1['default'],'as':_0x28e4a2(0x1f4),'attributes':[_0x28e4a2(0x1ee),_0x28e4a2(0x1ff),_0x28e4a2(0x1aa)],'include':[_0x28e4a2(0x21f)]},{'model':Tag_1[_0x28e4a2(0x19f)],'as':_0x28e4a2(0x219),'attributes':['id',_0x28e4a2(0x1ee),_0x28e4a2(0x196)],'where':{'id':_0x2eb2e2}},{'model':Whatsapp_1['default'],'as':_0x28e4a2(0x1d4),'attributes':[_0x28e4a2(0x1ee),_0x28e4a2(0x1ad),'facebookUserId']},{'model':Company_1[_0x28e4a2(0x19f)],'as':_0x28e4a2(0x230),'attributes':[_0x28e4a2(0x1ee)]}]});return _0x42afd9[_0x28e4a2(0x188)](0xc8)[_0x28e4a2(0x1c9)]({'status':_0x28e4a2(0x21d),'tickets':_0x5b67ad});}catch(_0x221c6f){return console['error'](_0x221c6f),_0x42afd9[_0x28e4a2(0x188)](0x1f4)[_0x28e4a2(0x1c9)]({'status':_0x28e4a2(0x173),'error':_0x28e4a2(0x207)});}};exports[a9_0xf755ab(0x20e)]=listTicketsByTagIsAuth;function makeid(_0x39c234){const _0x2af3e8=a9_0xf755ab;var _0x3a95f5='',_0x5056b7=_0x2af3e8(0x1e0),_0x2f757b=_0x5056b7[_0x2af3e8(0x166)];for(var _0x24e63a=0x0;_0x24e63a<_0x39c234;_0x24e63a++){_0x3a95f5+=_0x5056b7['charAt'](Math['floor'](Math[_0x2af3e8(0x217)]()*_0x2f757b));}return _0x3a95f5;}exports['makeid']=makeid;const handleAudioLink=async(_0x288173,_0xdfdc93)=>{const _0x3bf710=a9_0xf755ab,{link:_0x3c8fd8,contactNumber:_0x164178}=_0x288173[_0x3bf710(0x222)];try{const _0xb364cd=_0x288173['headers']['authorization'],[,_0x3a7a12]=_0xb364cd[_0x3bf710(0x1f0)]('\x20'),_0x1834cc=await Whatsapp_1[_0x3bf710(0x19f)][_0x3bf710(0x175)]({'where':{'token':_0x3a7a12}}),_0x13eb2d=_0x1834cc['companyId'],_0x3bc313=await(0x0,GetDefaultWhatsApp_1[_0x3bf710(0x19f)])(_0x13eb2d),_0x2168a1=(0x0,wbot_1[_0x3bf710(0x186)])(_0x3bc313['id']),_0x36fce6=_0x3bf710(0x16e)+_0x13eb2d+'/'+makeid(0xa)+_0x3bf710(0x1f2);if(!_0x1834cc)return _0xdfdc93[_0x3bf710(0x188)](0x191)[_0x3bf710(0x1c9)]({'status':'ERRO','error':_0x3bf710(0x205)});const _0x554736=await axios_1[_0x3bf710(0x19f)]['get'](_0x3c8fd8,{'responseType':_0x3bf710(0x15e)});fs_1[_0x3bf710(0x19f)][_0x3bf710(0x199)](_0x36fce6,Buffer[_0x3bf710(0x170)](_0x554736[_0x3bf710(0x17e)]));const _0x4e8d5a=_0x3bf710(0x20d);return await(0x0,SendPresenceStatus_1[_0x3bf710(0x1a9)])(_0x2168a1,_0x164178),await _0x2168a1[_0x3bf710(0x174)](_0x164178+_0x3bf710(0x229),{'audio':fs_1[_0x3bf710(0x19f)][_0x3bf710(0x15a)](_0x36fce6),'fileName':_0x4e8d5a,'caption':_0x4e8d5a,'mimetype':_0x3bf710(0x156),'ptt':!![]}),_0xdfdc93['status'](0xc8)[_0x3bf710(0x1c9)]({'status':'SUCESSO'});}catch(_0x1f3203){return console[_0x3bf710(0x223)](_0x1f3203),_0xdfdc93['status'](0x1f4)[_0x3bf710(0x1c9)]({'status':'ERRO','error':_0x3bf710(0x1f7)});}};exports[a9_0xf755ab(0x1ca)]=handleAudioLink;const indexApi=async(_0x2010b6,_0x28cc55)=>{const _0x194dca=a9_0xf755ab,_0x5135d4=_0x2010b6[_0x194dca(0x172)][_0x194dca(0x19a)],[,_0x51a8ce]=_0x5135d4['split']('\x20'),_0x442885=await Whatsapp_1[_0x194dca(0x19f)][_0x194dca(0x175)]({'where':{'token':_0x51a8ce}}),_0x41a0aa=_0x442885[_0x194dca(0x19d)],{searchParam:_0xfb2e36,pageNumber:_0x4db2bd}=_0x2010b6['query'];if(_0x41a0aa===0x1){const {invoices:_0x4f1c29,count:_0x4d7040,hasMore:_0x5c5b15}=await(0x0,ListInvoicesServices_1[_0x194dca(0x19f)])({'searchParam':_0xfb2e36,'pageNumber':_0x4db2bd});return _0x28cc55[_0x194dca(0x1c9)]({'invoices':_0x4f1c29,'count':_0x4d7040,'hasMore':_0x5c5b15});}else return _0x28cc55[_0x194dca(0x188)](0x191)[_0x194dca(0x1c9)]({'status':_0x194dca(0x1df),'error':_0x194dca(0x213)});};exports[a9_0xf755ab(0x18f)]=indexApi;const showApi=async(_0x137332,_0xcd4ba)=>{const _0x3a598b=a9_0xf755ab,_0x50c173=_0x137332[_0x3a598b(0x172)][_0x3a598b(0x19a)],[,_0xa11a0e]=_0x50c173['split']('\x20'),_0x4129d1=await Whatsapp_1[_0x3a598b(0x19f)][_0x3a598b(0x175)]({'where':{'token':_0xa11a0e}}),_0x291973=_0x4129d1[_0x3a598b(0x19d)],{Invoiceid:_0x39cb2e}=_0x137332[_0x3a598b(0x1f1)],_0x151742=await(0x0,ShowInvoiceService_1[_0x3a598b(0x19f)])(_0x39cb2e);return _0xcd4ba[_0x3a598b(0x188)](0xc8)[_0x3a598b(0x1c9)](_0x151742);};exports[a9_0xf755ab(0x1a4)]=showApi;const showAllApi=async(_0x462840,_0x2e37c6)=>{const _0x539511=a9_0xf755ab;try{const _0x130478=_0x462840['headers'][_0x539511(0x19a)],[,_0x46af6d]=_0x130478['split']('\x20'),_0x58c1ec=await Whatsapp_1[_0x539511(0x19f)][_0x539511(0x175)]({'where':{'token':_0x46af6d}}),_0x491b2d=_0x58c1ec[_0x539511(0x19d)],{companyId:_0x29b794,status:_0x13da2}=_0x462840[_0x539511(0x222)];if(_0x491b2d===0x1){const _0x3063b3=await Invoices_1[_0x539511(0x19f)][_0x539511(0x1bc)]({'where':{'companyId':_0x29b794,'status':_0x13da2}});return _0x2e37c6[_0x539511(0x188)](0xc8)[_0x539511(0x1c9)](_0x3063b3);}else return _0x2e37c6[_0x539511(0x188)](0x191)[_0x539511(0x1c9)]({'status':_0x539511(0x1df),'error':_0x539511(0x213)});}catch(_0x16f702){return console[_0x539511(0x223)](_0x539511(0x22b),_0x16f702),_0x2e37c6[_0x539511(0x188)](0x1f4)[_0x539511(0x1c9)]({'error':_0x539511(0x160)});}};exports['showAllApi']=showAllApi;const updateApi=async(_0x44eac5,_0x218b7a)=>{const _0x1067dd=a9_0xf755ab,_0x582dc0=_0x44eac5[_0x1067dd(0x172)][_0x1067dd(0x19a)],[,_0x5b95c9]=_0x582dc0[_0x1067dd(0x1f0)]('\x20'),_0x51872c=await Whatsapp_1[_0x1067dd(0x19f)][_0x1067dd(0x175)]({'where':{'token':_0x5b95c9}}),_0x1e2040=_0x51872c[_0x1067dd(0x19d)],_0x4b8389=_0x44eac5[_0x1067dd(0x222)],_0x36f0cb=Yup['object']()['shape']({'name':Yup[_0x1067dd(0x191)]()});try{await _0x36f0cb[_0x1067dd(0x17b)](_0x4b8389);}catch(_0x38f8ce){throw new AppError_1[(_0x1067dd(0x19f))](_0x38f8ce[_0x1067dd(0x1c1)]);}const {id:_0x4d1a54,status:_0x469c4d}=_0x4b8389;if(_0x1e2040===0x1){const _0x27093c=await(0x0,UpdateInvoiceService_1[_0x1067dd(0x19f)])({'id':_0x4d1a54,'status':_0x469c4d}),_0x4778c9=await Invoices_1[_0x1067dd(0x19f)][_0x1067dd(0x209)](_0x4d1a54),_0x39a7f7=_0x4778c9[_0x1067dd(0x19d)],_0x1d16dd=await Company_1['default'][_0x1067dd(0x209)](_0x39a7f7),_0x4a4fe6=new Date(_0x1d16dd['dueDate']);_0x4a4fe6[_0x1067dd(0x201)](_0x4a4fe6['getDate']()+0x1e);const _0x4d24b6=_0x4a4fe6[_0x1067dd(0x1eb)]()['split']('T')[0x0];if(_0x1d16dd){await _0x1d16dd[_0x1067dd(0x1d5)]({'dueDate':_0x4d24b6});const _0x147434=await _0x4778c9['update']({'id':_0x4d1a54,'status':_0x1067dd(0x20f)});await _0x1d16dd[_0x1067dd(0x1b0)]();const _0x4321c6=(0x0,socket_1[_0x1067dd(0x18d)])(),_0x2b5ea3=await Company_1['default']['findOne']({'where':{'id':_0x39a7f7}});}return _0x218b7a[_0x1067dd(0x188)](0xc8)[_0x1067dd(0x1c9)](_0x27093c);}else return _0x218b7a[_0x1067dd(0x188)](0x191)[_0x1067dd(0x1c9)]({'status':_0x1067dd(0x1df),'error':'Acesso\x20não\x20autorizado.\x20Por\x20favor,\x20forneça\x20credenciais\x20válidas.'});};exports['updateApi']=updateApi;const updateUsageStats=async(_0x2c46ed,_0x3f1628)=>{const _0x2bcbba=a9_0xf755ab;if(!_0x2c46ed[_0x2bcbba(0x183)]||!_0x2c46ed[_0x2bcbba(0x183)][_0x2bcbba(0x19d)])return _0x3f1628[_0x2bcbba(0x188)](0x190)['send']({'status':_0x2bcbba(0x173),'message':_0x2bcbba(0x1a7)});const {companyId:_0x6531ac}=_0x2c46ed[_0x2bcbba(0x183)],{contactId:_0x508757}=_0x2c46ed['params'];return setTimeout(async()=>{const _0x3bd594=_0x2bcbba,{dateToClient:_0x21a27e}=(0x0,useDate_1[_0x3bd594(0x16d)])(),_0x34a821=_0x21a27e(new Date()[_0x3bd594(0x192)]()),_0xc74add=(0x0,moment_1['default'])()[_0x3bd594(0x22e)]();try{const _0x1e442d=await ApiUsages_1[_0x3bd594(0x19f)][_0x3bd594(0x175)]({'where':{'dateUsed':_0x34a821,'companyId':_0x6531ac}});if(_0x1e442d)await _0x1e442d[_0x3bd594(0x1d5)]({'usedOther':_0x1e442d[_0x3bd594(0x1e9)]['usedOther']+0x1,'UsedOnDay':_0x1e442d['dataValues']['UsedOnDay']+0x1,'updatedAt':_0xc74add});else{const _0x202c8a=await ApiUsages_1[_0x3bd594(0x19f)][_0x3bd594(0x19b)]({'companyId':_0x6531ac,'dateUsed':_0x34a821});await _0x202c8a[_0x3bd594(0x1d5)]({'usedOther':_0x202c8a['dataValues']['usedOther']+0x1,'UsedOnDay':_0x202c8a[_0x3bd594(0x1e9)][_0x3bd594(0x1cb)]+0x1,'updatedAt':_0xc74add});}}catch(_0x1e8d4c){return console[_0x3bd594(0x223)](_0x3bd594(0x22a),_0x1e8d4c),_0x3f1628['status'](0x1f4)[_0x3bd594(0x18a)]({'status':'ERROR','message':_0x3bd594(0x163)});}},0x64),_0x3f1628[_0x2bcbba(0x18a)]({'status':_0x2bcbba(0x21d)});};exports['updateUsageStats']=updateUsageStats;const indexContacts=async(_0x195aa2,_0x3b1e8e)=>{const _0x5c73b4=a9_0xf755ab,{searchParam:_0x9d6fab,pageNumber:_0x8b0a8a}=_0x195aa2['query'],{companyId:_0x1825f5}=_0x195aa2[_0x5c73b4(0x183)],{contacts:_0x470e1b,count:_0x431c0d,hasMore:_0x3de5a1}=await(0x0,ListContactsService_1[_0x5c73b4(0x19f)])({'searchParam':_0x9d6fab,'pageNumber':_0x8b0a8a,'companyId':_0x1825f5});return _0x3b1e8e['json']({'contacts':_0x470e1b,'count':_0x431c0d,'hasMore':_0x3de5a1});};exports[a9_0xf755ab(0x210)]=indexContacts;const listContacts=async(_0x1f242d,_0x3f903b)=>{const _0x3ffda3=a9_0xf755ab,{name:_0x4b60f2}=_0x1f242d[_0x3ffda3(0x1b3)],{companyId:_0x22dabf}=_0x1f242d['user'],_0x44f15a=await(0x0,SimpleListService_1[_0x3ffda3(0x19f)])({'name':_0x4b60f2,'companyId':_0x22dabf});return _0x3f903b[_0x3ffda3(0x1c9)](_0x44f15a);};exports[a9_0xf755ab(0x202)]=listContacts;const showContacts=async(_0x30443d,_0x87644c)=>{const _0x2d3831=a9_0xf755ab,{contactId:_0x496811}=_0x30443d[_0x2d3831(0x1f1)],{companyId:_0x25f8c0}=_0x30443d[_0x2d3831(0x183)],_0xca0fb4=await(0x0,ShowContactService_1['default'])(_0x496811,_0x25f8c0);return _0x87644c[_0x2d3831(0x188)](0xc8)[_0x2d3831(0x1c9)](_0xca0fb4);};exports[a9_0xf755ab(0x195)]=showContacts;const findOrCreateContacts=async(_0x23e45b,_0x1383ff)=>{const _0x1d70cd=a9_0xf755ab,{name:_0x34c38f,number:_0x412b91}=_0x23e45b[_0x1d70cd(0x222)],{companyId:_0xa2cf84}=_0x23e45b[_0x1d70cd(0x183)],_0x4dd55a=await(0x0,GetContactService_1[_0x1d70cd(0x19f)])({'name':_0x34c38f,'number':_0x412b91,'companyId':_0xa2cf84});return _0x1383ff[_0x1d70cd(0x188)](0xc8)[_0x1d70cd(0x1c9)](_0x4dd55a);};exports['findOrCreateContacts']=findOrCreateContacts;const storeContacts=async(_0x412100,_0x465d8c)=>{const _0x1e71c7=a9_0xf755ab,{companyId:_0x1da726}=_0x412100[_0x1e71c7(0x183)],_0xb3415a=_0x412100[_0x1e71c7(0x222)];_0xb3415a['number']=_0xb3415a[_0x1e71c7(0x1ff)]['replace']('-','')['replace']('\x20','');const _0x18068e=Yup[_0x1e71c7(0x180)]()['shape']({'name':Yup[_0x1e71c7(0x191)]()[_0x1e71c7(0x21c)](),'number':Yup[_0x1e71c7(0x191)]()[_0x1e71c7(0x21c)]()['matches'](/^\d+$/,_0x1e71c7(0x20c))});try{await _0x18068e[_0x1e71c7(0x17b)](_0xb3415a);}catch(_0x3eeab1){throw new AppError_1[(_0x1e71c7(0x19f))](_0x3eeab1['message']);}await(0x0,CheckIsValidContact_1[_0x1e71c7(0x19f)])(_0xb3415a[_0x1e71c7(0x1ff)],_0x1da726);const _0x3d4838=await(0x0,CheckNumber_1[_0x1e71c7(0x19f)])(_0xb3415a['number'],_0x1da726),_0x43f0d7=_0x3d4838[_0x1e71c7(0x224)]['replace'](/\D/g,'');_0xb3415a['number']=_0x43f0d7;const _0x5b2504=await(0x0,CreateContactService_1['default'])({..._0xb3415a,'companyId':_0x1da726}),_0x3267d1=(0x0,socket_1['getIO'])();return _0x3267d1[_0x1e71c7(0x1d3)](_0x1e71c7(0x206)+_0x1da726+_0x1e71c7(0x19c),{'action':_0x1e71c7(0x19b),'contact':_0x5b2504}),_0x465d8c[_0x1e71c7(0x188)](0xc8)['json'](_0x5b2504);};exports[a9_0xf755ab(0x1fc)]=storeContacts;const removeAllContacts=async(_0x2a14fb,_0x466b62)=>{const _0x310040=a9_0xf755ab,{companyId:_0x4b0371}=_0x2a14fb[_0x310040(0x183)];try{await Contact_1[_0x310040(0x19f)]['destroy']({'where':{'companyId':_0x4b0371}});const _0x5c6173=(0x0,socket_1['getIO'])();return _0x5c6173['emit'](_0x310040(0x206)+_0x4b0371+'-contact',{'action':_0x310040(0x211)}),setTimeout(async()=>{const _0x45ab51=_0x310040,{dateToClient:_0x3c5f1c}=(0x0,useDate_1[_0x45ab51(0x16d)])(),_0x313fe3=_0x3c5f1c(new Date()[_0x45ab51(0x192)]()),_0x3733e2=(0x0,moment_1[_0x45ab51(0x19f)])()[_0x45ab51(0x22e)]();try{const _0x19b1c4=await ApiUsages_1['default'][_0x45ab51(0x175)]({'where':{'dateUsed':_0x313fe3,'companyId':_0x4b0371}});if(_0x19b1c4)await _0x19b1c4[_0x45ab51(0x1d5)]({'usedOther':_0x19b1c4[_0x45ab51(0x1e9)][_0x45ab51(0x1a2)]+0x1,'UsedOnDay':_0x19b1c4[_0x45ab51(0x1e9)][_0x45ab51(0x1cb)]+0x1,'updatedAt':_0x3733e2});else{const _0x501f25=await ApiUsages_1[_0x45ab51(0x19f)][_0x45ab51(0x19b)]({'companyId':_0x4b0371,'dateUsed':_0x313fe3});await _0x501f25[_0x45ab51(0x1d5)]({'usedOther':_0x501f25[_0x45ab51(0x1e9)][_0x45ab51(0x1a2)]+0x1,'UsedOnDay':_0x501f25[_0x45ab51(0x1e9)]['UsedOnDay']+0x1,'updatedAt':_0x3733e2});}}catch(_0x28329c){return console[_0x45ab51(0x223)](_0x45ab51(0x22a),_0x28329c),_0x466b62[_0x45ab51(0x188)](0x1f4)['send']({'status':_0x45ab51(0x173),'message':_0x45ab51(0x163)});}},0x64),_0x466b62[_0x310040(0x188)](0xc8)[_0x310040(0x18a)]({'status':_0x310040(0x21d),'message':_0x310040(0x1fd)});}catch(_0x425fd7){return console['error'](_0x310040(0x1d2),_0x425fd7),_0x466b62[_0x310040(0x188)](0x1f4)[_0x310040(0x18a)]({'status':'ERROR','message':'Internal\x20server\x20error'});}};exports['removeAllContacts']=removeAllContacts;const updateContacts=async(_0x1e1757,_0x1f3325)=>{const _0x23d0bf=a9_0xf755ab,_0x1c0929=_0x1e1757[_0x23d0bf(0x222)],{companyId:_0x3e659d}=_0x1e1757[_0x23d0bf(0x183)],_0x8e14fb=Yup[_0x23d0bf(0x180)]()[_0x23d0bf(0x227)]({'name':Yup[_0x23d0bf(0x191)](),'number':Yup[_0x23d0bf(0x191)]()[_0x23d0bf(0x162)](/^\d+$/,_0x23d0bf(0x20c))});try{await _0x8e14fb[_0x23d0bf(0x17b)](_0x1c0929);}catch(_0x2a057f){throw new AppError_1[(_0x23d0bf(0x19f))](_0x2a057f[_0x23d0bf(0x1c1)]);}await(0x0,CheckIsValidContact_1[_0x23d0bf(0x19f)])(_0x1c0929['number'],_0x3e659d);const _0x3607f1=await(0x0,CheckNumber_1[_0x23d0bf(0x19f)])(_0x1c0929[_0x23d0bf(0x1ff)],_0x3e659d),_0x19e777=_0x3607f1[_0x23d0bf(0x224)][_0x23d0bf(0x168)](/\D/g,'');_0x1c0929[_0x23d0bf(0x1ff)]=_0x19e777;const {contactId:_0x1541b7}=_0x1e1757['params'],_0x19051d=await(0x0,UpdateContactService_1['default'])({'contactData':_0x1c0929,'contactId':_0x1541b7,'companyId':_0x3e659d}),_0x2af779=(0x0,socket_1[_0x23d0bf(0x18d)])();return _0x2af779[_0x23d0bf(0x1d3)](_0x23d0bf(0x206)+_0x3e659d+_0x23d0bf(0x19c),{'action':_0x23d0bf(0x1d5),'contact':_0x19051d}),_0x1f3325[_0x23d0bf(0x188)](0xc8)[_0x23d0bf(0x1c9)](_0x19051d);};exports[a9_0xf755ab(0x1cc)]=updateContacts;const removeContacts=async(_0x3c4116,_0x5c0b19)=>{const _0x239546=a9_0xf755ab,{contactId:_0x44e2ab}=_0x3c4116['params'],{companyId:_0x3f5cd0}=_0x3c4116[_0x239546(0x183)];await(0x0,ShowContactService_1[_0x239546(0x19f)])(_0x44e2ab,_0x3f5cd0),await(0x0,DeleteContactService_1['default'])(_0x44e2ab);const _0x4488f8=(0x0,socket_1[_0x239546(0x18d)])();return _0x4488f8[_0x239546(0x1d3)](_0x239546(0x206)+_0x3f5cd0+'-contact',{'action':_0x239546(0x21e),'contactId':_0x44e2ab}),_0x5c0b19['status'](0xc8)[_0x239546(0x1c9)]({'message':_0x239546(0x1de)});};exports[a9_0xf755ab(0x1b9)]=removeContacts;const uploadContacts=async(_0x5ed398,_0xff2cbc)=>{const _0x201119=a9_0xf755ab,_0x5accd0=_0x5ed398[_0x201119(0x19e)],_0x3fe32e=(0x0,lodash_1[_0x201119(0x226)])(_0x5accd0),{companyId:_0x56a9f6}=_0x5ed398[_0x201119(0x183)],_0x26883c=await(0x0,ImportXLSContactsService_1[_0x201119(0x225)])(_0x56a9f6,_0x3fe32e),_0x3f6a1d=(0x0,socket_1[_0x201119(0x18d)])(),_0x55d9b4={'action':_0x201119(0x1b0),'records':_0x26883c};return _0x3f6a1d['to'](_0x201119(0x206)+_0x56a9f6+_0x201119(0x1b1))[_0x201119(0x1d3)](_0x201119(0x206)+_0x56a9f6+_0x201119(0x19c),_0x55d9b4),_0xff2cbc[_0x201119(0x188)](0xc8)['json'](_0x26883c);};function a9_0x41ce(_0x541743,_0x282559){const _0x128423=a9_0x6c18();return a9_0x41ce=function(_0x584147,_0x12a7d7){_0x584147=_0x584147-0x156;let _0x6c18fa=_0x128423[_0x584147];return _0x6c18fa;},a9_0x41ce(_0x541743,_0x282559);}exports[a9_0xf755ab(0x169)]=uploadContacts;const toggleDisableBotContacts=async(_0x57f271,_0x4999c9)=>{const _0x3b8a38=a9_0xf755ab,{contactId:_0x25561f}=_0x57f271[_0x3b8a38(0x1f1)],{companyId:_0x2e5cfc}=_0x57f271[_0x3b8a38(0x183)],_0x408224=await(0x0,ToggleDisableBotService_1['default'])(_0x25561f,_0x2e5cfc),_0x471df9=(0x0,socket_1[_0x3b8a38(0x18d)])();return _0x471df9[_0x3b8a38(0x1d3)]('company-'+_0x2e5cfc+_0x3b8a38(0x19c),{'action':'update','contact':_0x408224}),_0x4999c9[_0x3b8a38(0x188)](0xc8)[_0x3b8a38(0x1c9)](_0x408224);};exports[a9_0xf755ab(0x20a)]=toggleDisableBotContacts;