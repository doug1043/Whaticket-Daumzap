const a9_0x16f33f=a9_0x32b7;(function(_0x526b7c,_0x4348c2){const _0x2d8cfe=a9_0x32b7,_0x3e51e7=_0x526b7c();while(!![]){try{const _0x556cf5=-parseInt(_0x2d8cfe(0x1d0))/0x1*(-parseInt(_0x2d8cfe(0x1e4))/0x2)+-parseInt(_0x2d8cfe(0x175))/0x3+-parseInt(_0x2d8cfe(0x131))/0x4+-parseInt(_0x2d8cfe(0x19e))/0x5*(-parseInt(_0x2d8cfe(0x1d8))/0x6)+-parseInt(_0x2d8cfe(0x207))/0x7*(-parseInt(_0x2d8cfe(0x1c7))/0x8)+parseInt(_0x2d8cfe(0x1a1))/0x9*(-parseInt(_0x2d8cfe(0x209))/0xa)+parseInt(_0x2d8cfe(0x1ab))/0xb;if(_0x556cf5===_0x4348c2)break;else _0x3e51e7['push'](_0x3e51e7['shift']());}catch(_0x473a3e){_0x3e51e7['push'](_0x3e51e7['shift']());}}}(a9_0x5d8f,0x5fcff));const a9_0x449603=(function(){let _0x4d6fbd=!![];return function(_0x48d581,_0x57d34f){const _0x3ef6fa=_0x4d6fbd?function(){const _0x5b37b5=a9_0x32b7;if(_0x57d34f){const _0x16268f=_0x57d34f[_0x5b37b5(0x134)](_0x48d581,arguments);return _0x57d34f=null,_0x16268f;}}:function(){};return _0x4d6fbd=![],_0x3ef6fa;};}()),a9_0x3a0ea7=a9_0x449603(this,function(){const _0x50191f=a9_0x32b7;return a9_0x3a0ea7[_0x50191f(0x18d)]()['search'](_0x50191f(0x1c8))[_0x50191f(0x18d)]()[_0x50191f(0x20a)](a9_0x3a0ea7)[_0x50191f(0x1de)]('(((.+)+)+)+$');});a9_0x3a0ea7();'use strict';var __createBinding=this&&this[a9_0x16f33f(0x1f8)]||(Object[a9_0x16f33f(0x1bc)]?function(_0x489892,_0x3e27d2,_0x4c5747,_0x32d4ca){const _0x14eaee=a9_0x16f33f;if(_0x32d4ca===undefined)_0x32d4ca=_0x4c5747;var _0x331a22=Object[_0x14eaee(0x1aa)](_0x3e27d2,_0x4c5747);(!_0x331a22||(_0x14eaee(0x205)in _0x331a22?!_0x3e27d2[_0x14eaee(0x183)]:_0x331a22[_0x14eaee(0x164)]||_0x331a22[_0x14eaee(0x142)]))&&(_0x331a22={'enumerable':!![],'get':function(){return _0x3e27d2[_0x4c5747];}}),Object[_0x14eaee(0x18a)](_0x489892,_0x32d4ca,_0x331a22);}:function(_0x41ec49,_0x1eb16d,_0x378951,_0x5b53b2){if(_0x5b53b2===undefined)_0x5b53b2=_0x378951;_0x41ec49[_0x5b53b2]=_0x1eb16d[_0x378951];}),__setModuleDefault=this&&this[a9_0x16f33f(0x19d)]||(Object['create']?function(_0x2d3617,_0x37d4a0){const _0x319412=a9_0x16f33f;Object['defineProperty'](_0x2d3617,_0x319412(0x204),{'enumerable':!![],'value':_0x37d4a0});}:function(_0x13587a,_0x166c8a){_0x13587a['default']=_0x166c8a;}),__importStar=this&&this[a9_0x16f33f(0x169)]||function(_0xdc7347){const _0x572b95=a9_0x16f33f;if(_0xdc7347&&_0xdc7347['__esModule'])return _0xdc7347;var _0x1449af={};if(_0xdc7347!=null){for(var _0x5b7b47 in _0xdc7347)if(_0x5b7b47!==_0x572b95(0x204)&&Object[_0x572b95(0x16e)]['hasOwnProperty']['call'](_0xdc7347,_0x5b7b47))__createBinding(_0x1449af,_0xdc7347,_0x5b7b47);}return __setModuleDefault(_0x1449af,_0xdc7347),_0x1449af;},__importDefault=this&&this['__importDefault']||function(_0x3c723d){return _0x3c723d&&_0x3c723d['__esModule']?_0x3c723d:{'default':_0x3c723d};};Object[a9_0x16f33f(0x18a)](exports,a9_0x16f33f(0x183),{'value':!![]}),exports[a9_0x16f33f(0x192)]=exports[a9_0x16f33f(0x153)]=exports['removeContacts']=exports[a9_0x16f33f(0x1e9)]=exports['removeAllContacts']=exports['storeContacts']=exports['findOrCreateContacts']=exports['showContacts']=exports[a9_0x16f33f(0x1e3)]=exports[a9_0x16f33f(0x1e5)]=exports['updateUsageStats']=exports[a9_0x16f33f(0x14f)]=exports[a9_0x16f33f(0x208)]=exports['showApi']=exports[a9_0x16f33f(0x1ff)]=exports[a9_0x16f33f(0x15f)]=exports[a9_0x16f33f(0x176)]=exports[a9_0x16f33f(0x184)]=exports[a9_0x16f33f(0x1ce)]=exports[a9_0x16f33f(0x141)]=exports[a9_0x16f33f(0x172)]=exports[a9_0x16f33f(0x140)]=exports[a9_0x16f33f(0x19b)]=exports['updateQueueId']=exports[a9_0x16f33f(0x1a7)]=exports[a9_0x16f33f(0x17b)]=exports[a9_0x16f33f(0x19c)]=exports['index']=exports['indexLink']=exports[a9_0x16f33f(0x1b0)]=exports[a9_0x16f33f(0x16d)]=exports[a9_0x16f33f(0x154)]=exports[a9_0x16f33f(0x1b8)]=void 0x0;const axios_1=__importDefault(require('axios')),fs_1=__importDefault(require('fs')),Yup=__importStar(require(a9_0x16f33f(0x1da))),lodash_1=require(a9_0x16f33f(0x18f)),GetDefaultWhatsApp_1=__importDefault(require(a9_0x16f33f(0x139))),SetTicketMessagesAsRead_1=__importDefault(require(a9_0x16f33f(0x1fb))),socket_1=require(a9_0x16f33f(0x1af)),Whatsapp_1=__importDefault(require('../models/Whatsapp')),Queue_1=__importDefault(require(a9_0x16f33f(0x150))),User_1=__importDefault(require(a9_0x16f33f(0x1dc))),CreateOrUpdateContactService_1=__importDefault(require(a9_0x16f33f(0x17c))),FindOrCreateTicketService_1=__importDefault(require(a9_0x16f33f(0x1a2))),ShowTicketService_1=__importDefault(require(a9_0x16f33f(0x1d4))),GetProfilePicUrl_1=__importDefault(require(a9_0x16f33f(0x1e2))),SendWhatsAppMedia_1=__importDefault(require(a9_0x16f33f(0x1be))),UpdateTicketService_1=__importDefault(require(a9_0x16f33f(0x177))),wbot_1=require(a9_0x16f33f(0x156)),SendWhatsAppMessageLink_1=__importDefault(require(a9_0x16f33f(0x1fc))),SendWhatsAppMessageAPI_1=__importDefault(require(a9_0x16f33f(0x155))),SendWhatsappMediaImage_1=__importDefault(require('../services/WbotServices/SendWhatsappMediaImage')),ListInvoicesServices_1=__importDefault(require('../services/InvoicesService/ListInvoicesServices')),ShowInvoiceService_1=__importDefault(require('../services/InvoicesService/ShowInvoiceService')),UpdateInvoiceService_1=__importDefault(require(a9_0x16f33f(0x1f4))),Invoices_1=__importDefault(require(a9_0x16f33f(0x147))),ListContactsService_1=__importDefault(require('../services/ContactServices/ListContactsService')),CreateContactService_1=__importDefault(require(a9_0x16f33f(0x1c4))),ShowContactService_1=__importDefault(require('../services/ContactServices/ShowContactService')),UpdateContactService_1=__importDefault(require(a9_0x16f33f(0x17d))),DeleteContactService_1=__importDefault(require('../services/ContactServices/DeleteContactService')),GetContactService_1=__importDefault(require(a9_0x16f33f(0x149))),ToggleDisableBotService_1=__importDefault(require(a9_0x16f33f(0x1cb))),CheckNumber_1=__importDefault(require(a9_0x16f33f(0x1bf))),CheckIsValidContact_1=__importDefault(require(a9_0x16f33f(0x1d2))),AppError_1=__importDefault(require(a9_0x16f33f(0x17a))),SimpleListService_1=__importDefault(require(a9_0x16f33f(0x17f))),ImportXLSContactsService_1=require(a9_0x16f33f(0x1ad)),ApiUsages_1=__importDefault(require('../models/ApiUsages')),useDate_1=require(a9_0x16f33f(0x1ed)),TicketTag_1=__importDefault(require('../models/TicketTag')),Tag_1=__importDefault(require(a9_0x16f33f(0x15a))),moment_1=__importDefault(require(a9_0x16f33f(0x16c))),path_1=__importDefault(require(a9_0x16f33f(0x1fa))),Ticket_1=__importDefault(require(a9_0x16f33f(0x171))),Contact_1=__importDefault(require(a9_0x16f33f(0x1d6))),Company_1=__importDefault(require(a9_0x16f33f(0x1f1))),SendPresenceStatus_1=require('../helpers/SendPresenceStatus');class OnWhatsAppDto{constructor(_0x20c113,_0x56b232){const _0x3b99a3=a9_0x16f33f;this['jid']=_0x20c113,this[_0x3b99a3(0x1a0)]=_0x56b232;}}exports[a9_0x16f33f(0x1b8)]=OnWhatsAppDto;const CompanySchema=Yup[a9_0x16f33f(0x1b5)]()['shape']({'name':Yup[a9_0x16f33f(0x1ec)]()[a9_0x16f33f(0x179)](),'id':Yup[a9_0x16f33f(0x133)](),'phone':Yup[a9_0x16f33f(0x1ec)]()[a9_0x16f33f(0x206)](),'email':Yup[a9_0x16f33f(0x1ec)]()[a9_0x16f33f(0x174)]()['nullable'](),'status':Yup[a9_0x16f33f(0x160)]()['nullable'](),'planId':Yup['number']()['nullable'](),'campaignsEnabled':Yup[a9_0x16f33f(0x160)]()[a9_0x16f33f(0x206)](),'dueDate':Yup[a9_0x16f33f(0x16f)]()[a9_0x16f33f(0x206)](),'recurrence':Yup['string']()[a9_0x16f33f(0x206)]()}),createCompany=async(_0x5e9754,_0x2140c)=>{const _0x42e10b=a9_0x16f33f;try{await CompanySchema[_0x42e10b(0x158)](_0x5e9754[_0x42e10b(0x18e)]);const _0x2b5d7d=await Company_1[_0x42e10b(0x204)][_0x42e10b(0x1bc)](_0x5e9754['body']);_0x2140c[_0x42e10b(0x1f6)](0xc9)[_0x42e10b(0x143)](_0x2b5d7d);}catch(_0x3241da){_0x2140c[_0x42e10b(0x1f6)](0x190)[_0x42e10b(0x143)]({'error':_0x3241da[_0x42e10b(0x166)]});}};exports[a9_0x16f33f(0x154)]=createCompany;const updateCompany=async(_0x196d64,_0x5b290a)=>{const _0x2382b7=a9_0x16f33f;try{await CompanySchema[_0x2382b7(0x158)](_0x196d64[_0x2382b7(0x18e)]);const {id:_0x503590}=_0x196d64['params'],[_0x18f982]=await Company_1['default'][_0x2382b7(0x1eb)](_0x196d64['body'],{'where':{'id':_0x503590}});if(_0x18f982){const _0x29b562=await Company_1[_0x2382b7(0x204)][_0x2382b7(0x203)](_0x503590);_0x5b290a[_0x2382b7(0x1f6)](0xc8)[_0x2382b7(0x143)](_0x29b562);}else _0x5b290a[_0x2382b7(0x1f6)](0x194)['json']({'error':_0x2382b7(0x195)});}catch(_0x1811b2){_0x5b290a['status'](0x190)[_0x2382b7(0x143)]({'error':_0x1811b2[_0x2382b7(0x166)]});}};exports[a9_0x16f33f(0x16d)]=updateCompany;const blockCompany=async(_0x13f8c1,_0x458380)=>{const _0x395a7c=a9_0x16f33f;try{const {id:_0x2d24b2}=_0x13f8c1[_0x395a7c(0x1ee)],[_0xdc40ad]=await Company_1['default'][_0x395a7c(0x1eb)]({'status':![]},{'where':{'id':_0x2d24b2}});if(_0xdc40ad){const _0x2af5e8=await Company_1['default'][_0x395a7c(0x203)](_0x2d24b2);_0x458380[_0x395a7c(0x1f6)](0xc8)[_0x395a7c(0x143)](_0x2af5e8);}else _0x458380['status'](0x194)['json']({'error':'Company\x20not\x20found'});}catch(_0x57a2a5){_0x458380[_0x395a7c(0x1f6)](0x190)[_0x395a7c(0x143)]({'error':_0x57a2a5[_0x395a7c(0x166)]});}};exports[a9_0x16f33f(0x1b0)]=blockCompany;const createContact=async(_0x102704,_0x2fb5b6,_0x194e21)=>{const _0x3e1c32=a9_0x16f33f;await(0x0,CheckIsValidContact_1[_0x3e1c32(0x204)])(_0x194e21,_0x2fb5b6);const _0x4b86f4=await(0x0,CheckNumber_1[_0x3e1c32(0x204)])(_0x194e21,_0x2fb5b6),_0x1262e6=await(0x0,GetProfilePicUrl_1[_0x3e1c32(0x204)])(_0x4b86f4,_0x2fb5b6),_0x56711d=_0x4b86f4,_0x4a03a6={'name':''+_0x56711d,'number':_0x56711d,'profilePicUrl':_0x1262e6,'isGroup':![],'companyId':_0x2fb5b6},_0xc7ba9=await(0x0,CreateOrUpdateContactService_1[_0x3e1c32(0x204)])(_0x4a03a6,null,null);let _0x23e931;if(_0x102704===undefined)_0x23e931=await(0x0,GetDefaultWhatsApp_1[_0x3e1c32(0x204)])(_0x2fb5b6);else{_0x23e931=await Whatsapp_1[_0x3e1c32(0x204)][_0x3e1c32(0x203)](_0x102704);if(_0x23e931===null)throw new AppError_1[(_0x3e1c32(0x204))]('whatsapp\x20#'+_0x102704+_0x3e1c32(0x191));}const _0xc5ac52=await(0x0,FindOrCreateTicketService_1[_0x3e1c32(0x204)])(_0xc7ba9,_0x23e931['id'],0x0,_0x2fb5b6),_0x2e9897=await(0x0,ShowTicketService_1[_0x3e1c32(0x204)])(_0xc5ac52['id'],_0x2fb5b6);return(0x0,SetTicketMessagesAsRead_1[_0x3e1c32(0x204)])(_0x2e9897),_0x2e9897;};function formatBRNumber(_0x3d0382){const _0x498cd5=a9_0x16f33f,_0x3a86ec=new RegExp(/^(\d{2})(\d{2})\d{1}(\d{8})$/);if(_0x3a86ec[_0x498cd5(0x1f3)](_0x3d0382)){const _0x23cb3b=_0x3a86ec[_0x498cd5(0x157)](_0x3d0382);if(_0x23cb3b&&_0x23cb3b[0x1]==='55'&&Number['isInteger'](Number[_0x498cd5(0x14e)](_0x23cb3b[0x2]))){const _0x5076c4=Number['parseInt'](_0x23cb3b[0x2]);if(_0x5076c4<0x1f)return _0x23cb3b[0x0];else{if(_0x5076c4>=0x1f)return _0x23cb3b[0x1]+_0x23cb3b[0x2]+_0x23cb3b[0x3];}}}else return _0x3d0382;}function createJid(_0x430c6c){const _0x581ab3=a9_0x16f33f;if(_0x430c6c[_0x581ab3(0x1cf)]('@g.us')||_0x430c6c['includes'](_0x581ab3(0x198)))return formatBRNumber(_0x430c6c);return _0x430c6c[_0x581ab3(0x1cf)]('-')?_0x430c6c+_0x581ab3(0x13c):formatBRNumber(_0x430c6c)+_0x581ab3(0x198);}const indexLink=async(_0x4abe0e,_0x2b6406)=>{const _0x354178=a9_0x16f33f,_0xd6b084=_0x4abe0e[_0x354178(0x18e)],{whatsappId:_0x4b5a28}=_0x4abe0e['body'],{msdelay:_0x434ef0}=_0x4abe0e['body'],_0x795f9a=_0x4abe0e[_0x354178(0x18e)][_0x354178(0x1ef)],_0x58b2a2=_0x4abe0e[_0x354178(0x18e)][_0x354178(0x18b)],_0x2a96a4=_0x4abe0e['headers']['authorization'],[,_0x8273bb]=_0x2a96a4[_0x354178(0x1bd)]('\x20'),_0x2071de=await Whatsapp_1[_0x354178(0x204)][_0x354178(0x1b3)]({'where':{'token':_0x8273bb}}),_0x561f64=_0x2071de[_0x354178(0x146)];_0xd6b084['number']=_0xd6b084[_0x354178(0x133)][_0x354178(0x17e)]('-','')[_0x354178(0x17e)]('\x20','');const _0x38526c=Yup['object']()[_0x354178(0x194)]({'number':Yup['string']()[_0x354178(0x179)]()[_0x354178(0x197)](/^\d+$/,_0x354178(0x161))});try{await _0x38526c[_0x354178(0x158)](_0xd6b084);}catch(_0x52450c){throw new AppError_1[(_0x354178(0x204))](_0x52450c[_0x354178(0x166)]);}const _0x27e634=await createContact(_0x4b5a28,_0x561f64,_0xd6b084[_0x354178(0x133)]);return await(0x0,SendWhatsAppMessageLink_1[_0x354178(0x204)])({'ticket':_0x27e634,'url':_0x795f9a,'caption':_0x58b2a2,'msdelay':_0x434ef0}),setTimeout(async()=>{const _0x50f6d7=_0x354178;await(0x0,UpdateTicketService_1[_0x50f6d7(0x204)])({'ticketId':_0x27e634['id'],'ticketData':{'status':_0x50f6d7(0x1d7),'sendFarewellMessage':![],'amountUsedBotQueues':0x0},'companyId':_0x561f64});},0xc8),setTimeout(async()=>{const _0x3b28fb=_0x354178,{dateToClient:_0x3fe114}=(0x0,useDate_1[_0x3b28fb(0x201)])(),_0x842810=_0x3fe114(new Date()[_0x3b28fb(0x18d)]()),_0x2d485e=(0x0,moment_1[_0x3b28fb(0x204)])()[_0x3b28fb(0x1b7)](),_0x486e26=await ApiUsages_1[_0x3b28fb(0x204)][_0x3b28fb(0x1b3)]({'where':{'dateUsed':_0x842810,'companyId':_0x561f64}});if(_0x486e26)await _0x486e26[_0x3b28fb(0x1eb)]({'usedPDF':_0x486e26[_0x3b28fb(0x1b1)][_0x3b28fb(0x1a5)]+0x1,'UsedOnDay':_0x486e26[_0x3b28fb(0x1b1)][_0x3b28fb(0x1fd)]+0x1,'updatedAt':_0x2d485e});else{const _0x106add=await ApiUsages_1[_0x3b28fb(0x204)]['create']({'companyId':_0x561f64,'dateUsed':_0x842810});await _0x106add[_0x3b28fb(0x1eb)]({'usedPDF':_0x106add[_0x3b28fb(0x1b1)][_0x3b28fb(0x1a5)]+0x1,'UsedOnDay':_0x106add[_0x3b28fb(0x1b1)]['UsedOnDay']+0x1,'updatedAt':_0x2d485e});}},0x64),_0x2b6406['send']({'status':_0x354178(0x1c1)});};exports['indexLink']=indexLink;const index=async(_0x3a3d09,_0x10737d)=>{const _0x3ef679=a9_0x16f33f,_0x25b070=_0x3a3d09[_0x3ef679(0x18e)],{whatsappId:_0x29239f}=_0x3a3d09[_0x3ef679(0x18e)],{msdelay:_0x16debc}=_0x3a3d09[_0x3ef679(0x18e)],{body:_0x3e5a39,quotedMsg:_0x30a4d5}=_0x3a3d09[_0x3ef679(0x18e)],_0x50c426=_0x3a3d09['files'],_0x20b85e=_0x3a3d09['headers'][_0x3ef679(0x16a)],[,_0x712575]=_0x20b85e['split']('\x20'),_0x53fc28=await Whatsapp_1[_0x3ef679(0x204)][_0x3ef679(0x1b3)]({'where':{'token':_0x712575}}),_0x83c3ed=_0x53fc28['companyId'];_0x25b070[_0x3ef679(0x133)]=_0x25b070[_0x3ef679(0x133)][_0x3ef679(0x17e)]('-','')[_0x3ef679(0x17e)]('\x20','');const _0xdc801c=Yup[_0x3ef679(0x1b5)]()[_0x3ef679(0x194)]({'number':Yup[_0x3ef679(0x1ec)]()[_0x3ef679(0x179)]()[_0x3ef679(0x197)](/^\d+$/,_0x3ef679(0x161))});try{await _0xdc801c['validate'](_0x25b070);}catch(_0x2ad3a0){throw new AppError_1['default'](_0x2ad3a0[_0x3ef679(0x166)]);}const _0x3df8d5=await createContact(_0x29239f,_0x83c3ed,_0x25b070[_0x3ef679(0x133)]);return _0x50c426?await Promise[_0x3ef679(0x1b9)](_0x50c426[_0x3ef679(0x1e8)](async _0x1dd102=>{const _0x583742=_0x3ef679;await(0x0,SendWhatsAppMedia_1[_0x583742(0x204)])({'body':_0x3e5a39,'media':_0x1dd102,'ticket':_0x3df8d5});})):await(0x0,SendWhatsAppMessageAPI_1[_0x3ef679(0x204)])({'body':_0x3e5a39,'ticket':_0x3df8d5,'quotedMsg':_0x30a4d5,'msdelay':_0x16debc}),setTimeout(async()=>{const _0x4307a8=_0x3ef679;await(0x0,UpdateTicketService_1['default'])({'ticketId':_0x3df8d5['id'],'ticketData':{'status':_0x4307a8(0x1d7),'sendFarewellMessage':![],'amountUsedBotQueues':0x0},'companyId':_0x83c3ed});},0x64),setTimeout(async()=>{const _0x9bc1c1=_0x3ef679,{dateToClient:_0x45ce84}=(0x0,useDate_1[_0x9bc1c1(0x201)])(),_0x5490a3=_0x45ce84(new Date()[_0x9bc1c1(0x18d)]()),_0x67ca7b=(0x0,moment_1[_0x9bc1c1(0x204)])()[_0x9bc1c1(0x1b7)](),_0x554d25=await ApiUsages_1[_0x9bc1c1(0x204)][_0x9bc1c1(0x1b3)]({'where':{'dateUsed':_0x5490a3,'companyId':_0x83c3ed}});_0x554d25?_0x50c426?await Promise['all'](_0x50c426[_0x9bc1c1(0x1e8)](async _0x911c09=>{const _0x1f886d=_0x9bc1c1;console[_0x1f886d(0x1d3)](_0x1f886d(0x1b4),_0x911c09);const _0x395d3e=path_1[_0x1f886d(0x204)][_0x1f886d(0x180)](_0x911c09[_0x1f886d(0x170)]);console['log']('type',_0x395d3e);if(_0x911c09['mimetype'][_0x1f886d(0x1cf)](_0x1f886d(0x1f7)))await _0x554d25['update']({'usedPDF':_0x554d25['dataValues'][_0x1f886d(0x1a5)]+0x1,'UsedOnDay':_0x554d25[_0x1f886d(0x1b1)]['UsedOnDay']+0x1,'updatedAt':_0x67ca7b});else{if(_0x911c09[_0x1f886d(0x1f9)]['includes'](_0x1f886d(0x14d)))await _0x554d25['update']({'usedImage':_0x554d25['dataValues'][_0x1f886d(0x16b)]+0x1,'UsedOnDay':_0x554d25[_0x1f886d(0x1b1)][_0x1f886d(0x1fd)]+0x1,'updatedAt':_0x67ca7b});else _0x911c09[_0x1f886d(0x1f9)][_0x1f886d(0x1cf)]('video')?await _0x554d25[_0x1f886d(0x1eb)]({'usedVideo':_0x554d25[_0x1f886d(0x1b1)]['usedVideo']+0x1,'UsedOnDay':_0x554d25[_0x1f886d(0x1b1)][_0x1f886d(0x1fd)]+0x1,'updatedAt':_0x67ca7b}):await _0x554d25[_0x1f886d(0x1eb)]({'usedOther':_0x554d25[_0x1f886d(0x1b1)]['usedOther']+0x1,'UsedOnDay':_0x554d25[_0x1f886d(0x1b1)]['UsedOnDay']+0x1,'updatedAt':_0x67ca7b});}})):await _0x554d25[_0x9bc1c1(0x1eb)]({'usedText':_0x554d25[_0x9bc1c1(0x1b1)][_0x9bc1c1(0x167)]+0x1,'UsedOnDay':_0x554d25['dataValues'][_0x9bc1c1(0x1fd)]+0x1,'updatedAt':_0x67ca7b}):(await ApiUsages_1['default'][_0x9bc1c1(0x1bc)]({'companyId':_0x83c3ed,'dateUsed':_0x5490a3}),_0x50c426?await Promise[_0x9bc1c1(0x1b9)](_0x50c426[_0x9bc1c1(0x1e8)](async _0x2b873e=>{const _0x3c4b63=_0x9bc1c1;console[_0x3c4b63(0x1d3)](_0x3c4b63(0x1b4),_0x2b873e);const _0x1d053a=path_1[_0x3c4b63(0x204)][_0x3c4b63(0x180)](_0x2b873e['originalname']);console['log'](_0x3c4b63(0x182),_0x1d053a);if(_0x2b873e[_0x3c4b63(0x1f9)][_0x3c4b63(0x1cf)](_0x3c4b63(0x1f7)))await _0x554d25[_0x3c4b63(0x1eb)]({'usedPDF':_0x554d25[_0x3c4b63(0x1b1)]['usedPDF']+0x1,'UsedOnDay':_0x554d25[_0x3c4b63(0x1b1)][_0x3c4b63(0x1fd)]+0x1,'updatedAt':_0x67ca7b});else{if(_0x2b873e['mimetype'][_0x3c4b63(0x1cf)](_0x3c4b63(0x14d)))await _0x554d25[_0x3c4b63(0x1eb)]({'usedImage':_0x554d25[_0x3c4b63(0x1b1)][_0x3c4b63(0x16b)]+0x1,'UsedOnDay':_0x554d25['dataValues'][_0x3c4b63(0x1fd)]+0x1,'updatedAt':_0x67ca7b});else _0x2b873e['mimetype'][_0x3c4b63(0x1cf)](_0x3c4b63(0x173))?await _0x554d25[_0x3c4b63(0x1eb)]({'usedVideo':_0x554d25[_0x3c4b63(0x1b1)]['usedVideo']+0x1,'UsedOnDay':_0x554d25[_0x3c4b63(0x1b1)][_0x3c4b63(0x1fd)]+0x1,'updatedAt':_0x67ca7b}):await _0x554d25[_0x3c4b63(0x1eb)]({'usedOther':_0x554d25[_0x3c4b63(0x1b1)]['usedOther']+0x1,'UsedOnDay':_0x554d25['dataValues'][_0x3c4b63(0x1fd)]+0x1,'updatedAt':_0x67ca7b});}})):await _0x554d25[_0x9bc1c1(0x1eb)]({'usedText':_0x554d25[_0x9bc1c1(0x1b1)][_0x9bc1c1(0x167)]+0x1,'UsedOnDay':_0x554d25['dataValues'][_0x9bc1c1(0x1fd)]+0x1,'updatedAt':_0x67ca7b}));},0x64),_0x10737d[_0x3ef679(0x1ba)]({'status':'SUCCESS'});};exports[a9_0x16f33f(0x15d)]=index;const indexImage=async(_0x1b5b2,_0x1e4c7f)=>{const _0x2ea194=a9_0x16f33f,_0x26e791=_0x1b5b2[_0x2ea194(0x18e)],{whatsappId:_0x100673}=_0x1b5b2[_0x2ea194(0x18e)],{msdelay:_0x348055}=_0x1b5b2[_0x2ea194(0x18e)],_0x2d5524=_0x1b5b2[_0x2ea194(0x18e)]['url'],_0x3ebc9b=_0x1b5b2[_0x2ea194(0x18e)]['caption'],_0x322ba0=_0x1b5b2[_0x2ea194(0x1cc)]['authorization'],[,_0x22b106]=_0x322ba0[_0x2ea194(0x1bd)]('\x20'),_0x5ca3c2=await Whatsapp_1[_0x2ea194(0x204)][_0x2ea194(0x1b3)]({'where':{'token':_0x22b106}}),_0xac7b06=_0x5ca3c2['companyId'];_0x26e791['number']=_0x26e791[_0x2ea194(0x133)][_0x2ea194(0x17e)]('-','')[_0x2ea194(0x17e)]('\x20','');const _0x4efb0e=Yup['object']()[_0x2ea194(0x194)]({'number':Yup[_0x2ea194(0x1ec)]()[_0x2ea194(0x179)]()[_0x2ea194(0x197)](/^\d+$/,_0x2ea194(0x161))});try{await _0x4efb0e[_0x2ea194(0x158)](_0x26e791);}catch(_0x3a102d){throw new AppError_1[(_0x2ea194(0x204))](_0x3a102d[_0x2ea194(0x166)]);}const _0x31e136=await createContact(_0x100673,_0xac7b06,_0x26e791[_0x2ea194(0x133)]);return _0x2d5524&&await(0x0,SendWhatsappMediaImage_1['default'])({'ticket':_0x31e136,'url':_0x2d5524,'caption':_0x3ebc9b,'msdelay':_0x348055}),setTimeout(async()=>{const _0x3d7b67=_0x2ea194;await(0x0,UpdateTicketService_1[_0x3d7b67(0x204)])({'ticketId':_0x31e136['id'],'ticketData':{'status':_0x3d7b67(0x1d7),'sendFarewellMessage':![],'amountUsedBotQueues':0x0},'companyId':_0xac7b06});},0x64),setTimeout(async()=>{const _0x1bcf91=_0x2ea194,{dateToClient:_0x2ce5b4}=(0x0,useDate_1['useDate'])(),_0x3138b9=_0x2ce5b4(new Date()[_0x1bcf91(0x18d)]()),_0x2f9f5a=(0x0,moment_1[_0x1bcf91(0x204)])()[_0x1bcf91(0x1b7)](),_0x96966d=await ApiUsages_1[_0x1bcf91(0x204)]['findOne']({'where':{'dateUsed':_0x3138b9,'companyId':_0xac7b06}});if(_0x96966d)await _0x96966d[_0x1bcf91(0x1eb)]({'usedImage':_0x96966d[_0x1bcf91(0x1b1)][_0x1bcf91(0x16b)]+0x1,'UsedOnDay':_0x96966d[_0x1bcf91(0x1b1)][_0x1bcf91(0x1fd)]+0x1,'updatedAt':_0x2f9f5a});else{const _0xa8c04c=await ApiUsages_1[_0x1bcf91(0x204)][_0x1bcf91(0x1bc)]({'companyId':_0xac7b06,'dateUsed':_0x3138b9});await _0xa8c04c[_0x1bcf91(0x1eb)]({'usedImage':_0xa8c04c[_0x1bcf91(0x1b1)][_0x1bcf91(0x16b)]+0x1,'UsedOnDay':_0xa8c04c[_0x1bcf91(0x1b1)][_0x1bcf91(0x1fd)]+0x1,'updatedAt':_0x2f9f5a});}},0x64),_0x1e4c7f[_0x2ea194(0x1ba)]({'status':'SUCCESS'});};exports[a9_0x16f33f(0x19c)]=indexImage;const checkNumber=async(_0x2ac1f4,_0x3cd34f)=>{const _0x147e36=a9_0x16f33f,_0x229204=_0x2ac1f4[_0x147e36(0x18e)],_0x2511ae=_0x2ac1f4[_0x147e36(0x1cc)]['authorization'],[,_0x56d887]=_0x2511ae[_0x147e36(0x1bd)]('\x20'),_0x462c93=await Whatsapp_1['default'][_0x147e36(0x1b3)]({'where':{'token':_0x56d887}}),_0x214be2=_0x462c93[_0x147e36(0x146)],_0x1098ea=_0x229204['number'][_0x147e36(0x17e)]('-','')['replace']('\x20',''),_0x2dab0a=await(0x0,GetDefaultWhatsApp_1[_0x147e36(0x204)])(_0x214be2),_0x279fc9=(0x0,wbot_1[_0x147e36(0x1e7)])(_0x2dab0a['id']),_0x336695=createJid(_0x1098ea);try{const [_0x2c670e]=await _0x279fc9[_0x147e36(0x151)](_0x336695);if(_0x2c670e[_0x147e36(0x1a0)])return setTimeout(async()=>{const _0x2f9419=_0x147e36,{dateToClient:_0x13f92b}=(0x0,useDate_1[_0x2f9419(0x201)])(),_0x1c540b=_0x13f92b(new Date()[_0x2f9419(0x18d)]()),_0xb5e871=(0x0,moment_1[_0x2f9419(0x204)])()['format'](),_0x434a4b=await ApiUsages_1[_0x2f9419(0x204)][_0x2f9419(0x1b3)]({'where':{'dateUsed':_0x1c540b,'companyId':_0x214be2}});if(_0x434a4b)await _0x434a4b[_0x2f9419(0x1eb)]({'usedCheckNumber':_0x434a4b['dataValues'][_0x2f9419(0x1c2)]+0x1,'UsedOnDay':_0x434a4b[_0x2f9419(0x1b1)][_0x2f9419(0x1fd)]+0x1,'updatedAt':_0xb5e871});else{const _0x2cbc9d=await ApiUsages_1[_0x2f9419(0x204)]['create']({'companyId':_0x214be2,'dateUsed':_0x1c540b});await _0x2cbc9d[_0x2f9419(0x1eb)]({'usedCheckNumber':_0x2cbc9d[_0x2f9419(0x1b1)][_0x2f9419(0x1c2)]+0x1,'UsedOnDay':_0x2cbc9d[_0x2f9419(0x1b1)]['UsedOnDay']+0x1,'updatedAt':_0xb5e871});}},0x64),_0x3cd34f['status'](0xc8)['json']({'existsInWhatsapp':!![],'number':_0x1098ea,'numberFormatted':_0x2c670e[_0x147e36(0x13e)]});}catch(_0x5d9128){return _0x3cd34f[_0x147e36(0x1f6)](0x190)[_0x147e36(0x143)]({'existsInWhatsapp':![],'number':_0x336695,'error':_0x147e36(0x13b)});}};exports[a9_0x16f33f(0x17b)]=checkNumber;function a9_0x5d8f(){const _0x1f285b=['updateCompany','prototype','date','originalname','../models/Ticket','removeTicketTag','video','email','1932183ODUzqw','makeid','../services/TicketServices/UpdateTicketService','Acesso\x20não\x20autorizado.\x20Por\x20favor,\x20forneça\x20credenciais\x20válidas.','required','../errors/AppError','checkNumber','../services/ContactServices/CreateOrUpdateContactService','../services/ContactServices/UpdateContactService','replace','../services/ContactServices/SimpleListService','extname','ERRO','type','__esModule','listTicketsByTagIsAuth','length','whatsapp','findOrCreateContacts','-contact','extraInfo','defineProperty','caption','dueDate','toString','body','lodash','acceptAudioMessage','\x20not\x20found','toggleDisableBotContacts','setDate','shape','Company\x20not\x20found','company','matches','@s.whatsapp.net','reload','Missing\x20user\x20or\x20companyId','closeTicket','indexImage','__setModuleDefault','1090HWugQk','profilePicUrl','exists','45EjFWbi','../services/TicketServices/FindOrCreateTicketService','queue','Tag\x20does\x20not\x20belong\x20to\x20the\x20specified\x20company','usedPDF','writeFileSync','indexWhatsappsId','arraybuffer','SUCESSO','getOwnPropertyDescriptor','6769169qrGgCl','color','../services/ContactServices/ImportXLSContactsService','disableBot','../libs/socket','blockCompany','dataValues','showApi','findOne','media','object','Token\x20de\x20autorização\x20inválido','format','OnWhatsAppDto','all','send','ERROR','create','split','../services/WbotServices/SendWhatsAppMedia','../services/WbotServices/CheckNumber','usedOther','SUCCESS','usedCheckNumber','Failed\x20to\x20remove\x20ticket\x20tag','../services/ContactServices/CreateContactService','random','Internal\x20Server\x20Error','8DsKzsP','(((.+)+)+)+$','charAt','showContacts','../services/ContactServices/ToggleDisableBotService','headers','emit','listTicketsByTag','includes','89wnjOHh','tags','../services/WbotServices/CheckIsValidContact','log','../services/TicketServices/ShowTicketService','data','../models/Contact','pending','11814xgSPcf','Tag\x20is\x20not\x20associated\x20with\x20the\x20ticket','yup','destroy','../models/User','SendPresenceStatus','search','sendMessage','ticketData','files','../services/WbotServices/GetProfilePicUrl','listContacts','8926UVjqax','indexContacts','error','getWbot','map','updateContacts','findAll','update','string','../utils/useDate','params','url','user','../models/Company','name','test','../services/InvoicesService/UpdateInvoiceService','Legenda\x20do\x20áudio','status','pdf','__createBinding','mimetype','path','../helpers/SetTicketMessagesAsRead','../services/WbotServices/SendWhatsAppMessageLink','UsedOnDay','audio/mp4','indexApi','deleteAll','useDate','delete','findByPk','default','get','nullable','3169166vFiuCh','showAllApi','1563860qpcEYH','constructor','304512JqyuAg','Error\x20updating\x20usage\x20stats:','number','apply','ImportXLSContactsService','query','All\x20contacts\x20removed\x20successfully','contact','../helpers/GetDefaultWhatsApp','removeAllContacts','Not\x20exists\x20on\x20Whatsapp','@g.us','getIO','jid','ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789','updateTicketTag','listTicketsByCompany','configurable','json','company-','facebookUserId','companyId','../models/Invoices','req','../services/ContactServices/GetContactService','Failed\x20to\x20update\x20ticket\x20tag','./public/company','updateQueueId','image','parseInt','updateApi','../models/Queue','onWhatsApp','Erro\x20ao\x20buscar\x20invoices','uploadContacts','createCompany','../services/WbotServices/SendWhatsAppMessageAPI','../libs/wbot','exec','validate','paid','../models/Tag','facebookUserToken','storeContacts','index','from','handleAudioLink','boolean','Invalid\x20number\x20format.\x20Only\x20numbers\x20is\x20allowed.','.mp3','active','writable','-mainchannel','message','usedText','Internal\x20server\x20error','__importStar','authorization','usedImage','moment'];a9_0x5d8f=function(){return _0x1f285b;};return a9_0x5d8f();}const indexWhatsappsId=async(_0x302ec8,_0x299fd9)=>{const _0x113ccc=a9_0x16f33f;return console[_0x113ccc(0x1d3)](_0x113ccc(0x148),_0x302ec8),console[_0x113ccc(0x1d3)](_0x113ccc(0x148),_0x302ec8['user']),_0x299fd9['status'](0xc8)[_0x113ccc(0x143)]('oi');};exports[a9_0x16f33f(0x1a7)]=indexWhatsappsId;const updateQueueId=async(_0x4761d4,_0x5321bf)=>{const _0x467a5d=a9_0x16f33f,{ticketId:_0x499996}=_0x4761d4[_0x467a5d(0x1ee)],{queueId:_0x43021}=_0x4761d4['body'],_0x5364cb=_0x4761d4[_0x467a5d(0x1cc)][_0x467a5d(0x16a)],[,_0x51c966]=_0x5364cb[_0x467a5d(0x1bd)]('\x20'),_0x1a5bf5=await Whatsapp_1[_0x467a5d(0x204)][_0x467a5d(0x1b3)]({'where':{'token':_0x51c966}}),_0x511ee4=_0x1a5bf5[_0x467a5d(0x146)];try{const _0xef6ad7=await Queue_1['default'][_0x467a5d(0x1b3)]({'where':{'id':_0x43021,'companyId':_0x511ee4}});if(!_0xef6ad7)return _0x5321bf[_0x467a5d(0x1f6)](0x190)[_0x467a5d(0x143)]({'status':'ERROR','error':'Invalid\x20queue\x20for\x20the\x20company'});return await(0x0,UpdateTicketService_1['default'])({'ticketId':_0x499996,'ticketData':{'queueId':_0x43021},'companyId':_0x511ee4}),_0x5321bf['status'](0xc8)[_0x467a5d(0x143)]({'status':_0x467a5d(0x1c1)});}catch(_0x2d5096){return console[_0x467a5d(0x1e6)](_0x2d5096),_0x5321bf[_0x467a5d(0x1f6)](0x1f4)[_0x467a5d(0x143)]({'status':'ERROR','error':_0x467a5d(0x1c6)});}};exports[a9_0x16f33f(0x14c)]=updateQueueId;const closeTicket=async(_0x198577,_0x5edf37)=>{const _0x4e191a=a9_0x16f33f,_0x2efc74=_0x198577[_0x4e191a(0x1cc)]['authorization'],[,_0x5dd13b]=_0x2efc74[_0x4e191a(0x1bd)]('\x20'),_0x3f084b=await Whatsapp_1['default'][_0x4e191a(0x1b3)]({'where':{'token':_0x5dd13b}}),_0x531835=_0x3f084b[_0x4e191a(0x146)],{ticketId:_0x477f5a}=_0x198577[_0x4e191a(0x1ee)],_0x3cdf4c=await(0x0,ShowTicketService_1[_0x4e191a(0x204)])(_0x477f5a,_0x531835);_0x3cdf4c['status']=_0x198577[_0x4e191a(0x18e)][_0x4e191a(0x1e0)]['status'],console[_0x4e191a(0x1d3)](_0x3cdf4c['status']);const {ticket:_0x2650e4}=await(0x0,UpdateTicketService_1[_0x4e191a(0x204)])({'ticketData':_0x3cdf4c,'ticketId':_0x477f5a,'companyId':_0x531835});return _0x5edf37[_0x4e191a(0x1f6)](0xc8)[_0x4e191a(0x143)](_0x2650e4);};exports[a9_0x16f33f(0x19b)]=closeTicket;const updateTicketTag=async(_0x380e8e,_0x5bf828)=>{const _0x42f121=a9_0x16f33f,{ticketId:_0x37a163,tagId:_0x684fe2}=_0x380e8e[_0x42f121(0x18e)],_0xf059f1=_0x380e8e[_0x42f121(0x1cc)][_0x42f121(0x16a)],[,_0x4ebbe7]=_0xf059f1[_0x42f121(0x1bd)]('\x20');try{const _0x24b9b7=await Whatsapp_1[_0x42f121(0x204)]['findOne']({'where':{'token':_0x4ebbe7}}),_0x5863f8=_0x24b9b7[_0x42f121(0x146)],_0x318224=await Tag_1['default'][_0x42f121(0x1b3)]({'where':{'id':_0x684fe2,'companyId':_0x5863f8}});if(!_0x318224)return _0x5bf828[_0x42f121(0x1f6)](0x190)[_0x42f121(0x143)]({'status':_0x42f121(0x1bb),'error':'Tag\x20does\x20not\x20belong\x20to\x20the\x20specified\x20company'});const _0x1c2691=await TicketTag_1['default'][_0x42f121(0x1b3)]({'where':{'ticketId':_0x37a163,'tagId':_0x684fe2}});if(_0x1c2691)return _0x5bf828['status'](0x190)['json']({'status':_0x42f121(0x1bb),'error':'Tag\x20already\x20associated\x20with\x20the\x20ticket'});const _0x464f46=await TicketTag_1['default'][_0x42f121(0x1bc)]({'ticketId':_0x37a163,'tagId':_0x684fe2});return _0x5bf828[_0x42f121(0x1f6)](0xc8)['json']({'status':_0x42f121(0x1c1),'ticketTag':_0x464f46});}catch(_0x2899c7){return console[_0x42f121(0x1e6)](_0x2899c7),_0x5bf828[_0x42f121(0x1f6)](0x1f4)[_0x42f121(0x143)]({'status':_0x42f121(0x1bb),'error':_0x42f121(0x14a)});}};exports[a9_0x16f33f(0x140)]=updateTicketTag;const removeTicketTag=async(_0x227060,_0x659499)=>{const _0x2554cc=a9_0x16f33f,{ticketId:_0x12973d,tagId:_0x35b82c}=_0x227060[_0x2554cc(0x18e)];try{const _0x5a554d=await TicketTag_1[_0x2554cc(0x204)][_0x2554cc(0x1b3)]({'where':{'ticketId':_0x12973d,'tagId':_0x35b82c}});if(!_0x5a554d)return _0x659499[_0x2554cc(0x1f6)](0x190)[_0x2554cc(0x143)]({'status':_0x2554cc(0x1bb),'error':_0x2554cc(0x1d9)});return await _0x5a554d[_0x2554cc(0x1db)](),_0x659499[_0x2554cc(0x1f6)](0xc8)[_0x2554cc(0x143)]({'status':_0x2554cc(0x1c1)});}catch(_0x2c1ba3){return console[_0x2554cc(0x1e6)](_0x2c1ba3),_0x659499[_0x2554cc(0x1f6)](0x1f4)[_0x2554cc(0x143)]({'status':_0x2554cc(0x1bb),'error':_0x2554cc(0x1c3)});}};exports['removeTicketTag']=removeTicketTag;const listTicketsByCompany=async(_0x5b6704,_0x3d9c66)=>{const _0x4646f9=a9_0x16f33f,_0x215259=_0x5b6704[_0x4646f9(0x1cc)][_0x4646f9(0x16a)],[,_0x9b9a9e]=_0x215259[_0x4646f9(0x1bd)]('\x20'),_0x50702e=await Whatsapp_1[_0x4646f9(0x204)][_0x4646f9(0x1b3)]({'where':{'token':_0x9b9a9e}}),_0x1efa3=_0x50702e[_0x4646f9(0x146)];try{const _0x4c9d84=await Ticket_1['default']['findAll']({'where':{'companyId':_0x1efa3},'include':[{'model':Contact_1[_0x4646f9(0x204)],'as':_0x4646f9(0x138),'attributes':['id',_0x4646f9(0x1f2),_0x4646f9(0x133),'email',_0x4646f9(0x19f),_0x4646f9(0x190),'active',_0x4646f9(0x1ae)],'include':[_0x4646f9(0x189)]},{'model':Queue_1['default'],'as':_0x4646f9(0x1a3),'attributes':['id',_0x4646f9(0x1f2),_0x4646f9(0x1ac)]},{'model':User_1[_0x4646f9(0x204)],'as':'user','attributes':['id','name']},{'model':Tag_1[_0x4646f9(0x204)],'as':'tags','attributes':['id',_0x4646f9(0x1f2),_0x4646f9(0x1ac)]},{'model':Whatsapp_1[_0x4646f9(0x204)],'as':'whatsapp','attributes':['name',_0x4646f9(0x15b),'facebookUserId']},{'model':Company_1[_0x4646f9(0x204)],'as':'company','attributes':['name']}]});return _0x3d9c66['status'](0xc8)[_0x4646f9(0x143)]({'status':'SUCCESS','tickets':_0x4c9d84});}catch(_0x51bea8){return console[_0x4646f9(0x1e6)](_0x51bea8),_0x3d9c66['status'](0x1f4)[_0x4646f9(0x143)]({'status':_0x4646f9(0x1bb),'error':_0x4646f9(0x1c6)});}};exports['listTicketsByCompany']=listTicketsByCompany;const listTicketsByTag=async(_0x3c9ee4,_0x3fadcb)=>{const _0x2ce116=a9_0x16f33f,{tagId:_0x19666d}=_0x3c9ee4[_0x2ce116(0x1ee)],_0x41a125=_0x3c9ee4['headers'][_0x2ce116(0x16a)],[,_0x5ed0ef]=_0x41a125[_0x2ce116(0x1bd)]('\x20');try{const _0x2ffa78=await Whatsapp_1['default']['findOne']({'where':{'token':_0x5ed0ef}}),_0x4b1fe9=_0x2ffa78[_0x2ce116(0x146)],_0x55a1d6=await Tag_1['default'][_0x2ce116(0x1b3)]({'where':{'id':_0x19666d,'companyId':_0x4b1fe9}});if(!_0x55a1d6)return _0x3fadcb[_0x2ce116(0x1f6)](0x190)[_0x2ce116(0x143)]({'status':_0x2ce116(0x1bb),'error':_0x2ce116(0x1a4)});const _0x5236ad=await Ticket_1[_0x2ce116(0x204)]['findAll']({'include':[{'model':Tag_1[_0x2ce116(0x204)],'as':'tags','attributes':['id','name'],'through':{'attributes':[],'where':{'tagId':_0x19666d}}},{'model':Contact_1[_0x2ce116(0x204)],'as':_0x2ce116(0x138),'attributes':['id',_0x2ce116(0x1f2),_0x2ce116(0x133),'email','profilePicUrl',_0x2ce116(0x190),_0x2ce116(0x163),'disableBot'],'include':['extraInfo']},{'model':Queue_1[_0x2ce116(0x204)],'as':_0x2ce116(0x1a3),'attributes':['id',_0x2ce116(0x1f2),_0x2ce116(0x1ac)]},{'model':User_1['default'],'as':_0x2ce116(0x1f0),'attributes':['id','name']},{'model':Whatsapp_1['default'],'as':_0x2ce116(0x186),'attributes':['name','facebookUserToken','facebookUserId']},{'model':Company_1[_0x2ce116(0x204)],'as':_0x2ce116(0x196),'attributes':[_0x2ce116(0x1f2)]}],'where':{'companyId':_0x4b1fe9,'$tags.id$':_0x19666d}});return _0x3fadcb[_0x2ce116(0x1f6)](0xc8)['json']({'status':_0x2ce116(0x1c1),'tickets':_0x5236ad});}catch(_0x3ccb5d){return console['error'](_0x3ccb5d),_0x3fadcb[_0x2ce116(0x1f6)](0x1f4)[_0x2ce116(0x143)]({'status':_0x2ce116(0x1bb),'error':'Internal\x20Server\x20Error'});}};exports['listTicketsByTag']=listTicketsByTag;const listTicketsByTagIsAuth=async(_0x56c2e6,_0x40149a)=>{const _0x488568=a9_0x16f33f,{tagId:_0x596a24}=_0x56c2e6[_0x488568(0x1ee)];try{const _0x14f9cd=await Ticket_1[_0x488568(0x204)][_0x488568(0x1ea)]({'include':[{'model':Contact_1['default'],'as':_0x488568(0x138),'attributes':['name','number',_0x488568(0x174)],'include':[_0x488568(0x189)]},{'model':Tag_1[_0x488568(0x204)],'as':_0x488568(0x1d1),'attributes':['id',_0x488568(0x1f2),_0x488568(0x1ac)],'where':{'id':_0x596a24}},{'model':Whatsapp_1[_0x488568(0x204)],'as':_0x488568(0x186),'attributes':['name',_0x488568(0x15b),_0x488568(0x145)]},{'model':Company_1['default'],'as':_0x488568(0x196),'attributes':[_0x488568(0x1f2)]}]});return _0x40149a[_0x488568(0x1f6)](0xc8)[_0x488568(0x143)]({'status':_0x488568(0x1c1),'tickets':_0x14f9cd});}catch(_0x1b858b){return console[_0x488568(0x1e6)](_0x1b858b),_0x40149a[_0x488568(0x1f6)](0x1f4)[_0x488568(0x143)]({'status':'ERROR','error':_0x488568(0x1c6)});}};exports[a9_0x16f33f(0x184)]=listTicketsByTagIsAuth;function makeid(_0x6d1a3d){const _0x285d5c=a9_0x16f33f;var _0x535437='',_0x630de7=_0x285d5c(0x13f),_0x305ae4=_0x630de7[_0x285d5c(0x185)];for(var _0x35cbca=0x0;_0x35cbca<_0x6d1a3d;_0x35cbca++){_0x535437+=_0x630de7[_0x285d5c(0x1c9)](Math['floor'](Math[_0x285d5c(0x1c5)]()*_0x305ae4));}return _0x535437;}exports[a9_0x16f33f(0x176)]=makeid;const handleAudioLink=async(_0x556cf7,_0x5d1f65)=>{const _0x31ba44=a9_0x16f33f,{link:_0x39a59b,contactNumber:_0x2d87a3}=_0x556cf7[_0x31ba44(0x18e)];try{const _0x31fc72=_0x556cf7[_0x31ba44(0x1cc)][_0x31ba44(0x16a)],[,_0x351859]=_0x31fc72['split']('\x20'),_0x3e152b=await Whatsapp_1[_0x31ba44(0x204)][_0x31ba44(0x1b3)]({'where':{'token':_0x351859}}),_0x56d4b4=_0x3e152b[_0x31ba44(0x146)],_0x200656=await(0x0,GetDefaultWhatsApp_1['default'])(_0x56d4b4),_0x7c98da=(0x0,wbot_1[_0x31ba44(0x1e7)])(_0x200656['id']),_0x108a84=_0x31ba44(0x14b)+_0x56d4b4+'/'+makeid(0xa)+_0x31ba44(0x162);if(!_0x3e152b)return _0x5d1f65[_0x31ba44(0x1f6)](0x191)[_0x31ba44(0x143)]({'status':_0x31ba44(0x181),'error':_0x31ba44(0x1b6)});const _0x3e9299=await axios_1['default']['get'](_0x39a59b,{'responseType':_0x31ba44(0x1a8)});fs_1['default'][_0x31ba44(0x1a6)](_0x108a84,Buffer[_0x31ba44(0x15e)](_0x3e9299[_0x31ba44(0x1d5)]));const _0x1175e0=_0x31ba44(0x1f5);return await(0x0,SendPresenceStatus_1[_0x31ba44(0x1dd)])(_0x7c98da,_0x2d87a3),await _0x7c98da[_0x31ba44(0x1df)](_0x2d87a3+_0x31ba44(0x198),{'audio':fs_1['default']['readFileSync'](_0x108a84),'fileName':_0x1175e0,'caption':_0x1175e0,'mimetype':_0x31ba44(0x1fe),'ptt':!![]}),_0x5d1f65['status'](0xc8)[_0x31ba44(0x143)]({'status':_0x31ba44(0x1a9)});}catch(_0x5d058c){return console['error'](_0x5d058c),_0x5d1f65[_0x31ba44(0x1f6)](0x1f4)[_0x31ba44(0x143)]({'status':'ERRO','error':'Erro\x20ao\x20lidar\x20com\x20o\x20link\x20de\x20áudio'});}};exports[a9_0x16f33f(0x15f)]=handleAudioLink;const indexApi=async(_0x143ec9,_0x2b15a2)=>{const _0x2c87e4=a9_0x16f33f,_0x46b315=_0x143ec9[_0x2c87e4(0x1cc)][_0x2c87e4(0x16a)],[,_0x4ad2b4]=_0x46b315['split']('\x20'),_0x481343=await Whatsapp_1[_0x2c87e4(0x204)][_0x2c87e4(0x1b3)]({'where':{'token':_0x4ad2b4}}),_0x20cd7f=_0x481343[_0x2c87e4(0x146)],{searchParam:_0x45aaaf,pageNumber:_0x55e11e}=_0x143ec9[_0x2c87e4(0x136)];if(_0x20cd7f===0x1){const {invoices:_0x37a62e,count:_0x3c0753,hasMore:_0x362172}=await(0x0,ListInvoicesServices_1['default'])({'searchParam':_0x45aaaf,'pageNumber':_0x55e11e});return _0x2b15a2[_0x2c87e4(0x143)]({'invoices':_0x37a62e,'count':_0x3c0753,'hasMore':_0x362172});}else return _0x2b15a2['status'](0x191)['json']({'status':_0x2c87e4(0x181),'error':_0x2c87e4(0x178)});};exports['indexApi']=indexApi;const showApi=async(_0x392b22,_0x2e276c)=>{const _0x330167=a9_0x16f33f,_0x1c2ede=_0x392b22[_0x330167(0x1cc)][_0x330167(0x16a)],[,_0x46a4ad]=_0x1c2ede['split']('\x20'),_0x3b1f37=await Whatsapp_1[_0x330167(0x204)][_0x330167(0x1b3)]({'where':{'token':_0x46a4ad}}),_0xbe64b0=_0x3b1f37[_0x330167(0x146)],{Invoiceid:_0x502db9}=_0x392b22[_0x330167(0x1ee)],_0x3a9e6f=await(0x0,ShowInvoiceService_1['default'])(_0x502db9);return _0x2e276c[_0x330167(0x1f6)](0xc8)[_0x330167(0x143)](_0x3a9e6f);};function a9_0x32b7(_0x24aa0a,_0x4bb270){const _0xb33e69=a9_0x5d8f();return a9_0x32b7=function(_0x3a0ea7,_0x449603){_0x3a0ea7=_0x3a0ea7-0x131;let _0x5d8fea=_0xb33e69[_0x3a0ea7];return _0x5d8fea;},a9_0x32b7(_0x24aa0a,_0x4bb270);}exports[a9_0x16f33f(0x1b2)]=showApi;const showAllApi=async(_0x16b29b,_0x5ec7f6)=>{const _0x4dc90b=a9_0x16f33f;try{const _0x4ca503=_0x16b29b[_0x4dc90b(0x1cc)][_0x4dc90b(0x16a)],[,_0x30c91a]=_0x4ca503[_0x4dc90b(0x1bd)]('\x20'),_0x10a370=await Whatsapp_1['default'][_0x4dc90b(0x1b3)]({'where':{'token':_0x30c91a}}),_0x2a7b4b=_0x10a370[_0x4dc90b(0x146)],{companyId:_0x414542,status:_0x732bf7}=_0x16b29b[_0x4dc90b(0x18e)];if(_0x2a7b4b===0x1){const _0x1dfd95=await Invoices_1['default'][_0x4dc90b(0x1ea)]({'where':{'companyId':_0x414542,'status':_0x732bf7}});return _0x5ec7f6['status'](0xc8)[_0x4dc90b(0x143)](_0x1dfd95);}else return _0x5ec7f6['status'](0x191)[_0x4dc90b(0x143)]({'status':'ERRO','error':'Acesso\x20não\x20autorizado.\x20Por\x20favor,\x20forneça\x20credenciais\x20válidas.'});}catch(_0xc1f705){return console[_0x4dc90b(0x1e6)]('Erro\x20ao\x20buscar\x20invoices:',_0xc1f705),_0x5ec7f6[_0x4dc90b(0x1f6)](0x1f4)['json']({'error':_0x4dc90b(0x152)});}};exports[a9_0x16f33f(0x208)]=showAllApi;const updateApi=async(_0xa32bc5,_0x53e848)=>{const _0xeb9f67=a9_0x16f33f,_0x7c402d=_0xa32bc5['headers'][_0xeb9f67(0x16a)],[,_0x2eee86]=_0x7c402d['split']('\x20'),_0x23fdfa=await Whatsapp_1[_0xeb9f67(0x204)][_0xeb9f67(0x1b3)]({'where':{'token':_0x2eee86}}),_0x223893=_0x23fdfa[_0xeb9f67(0x146)],_0x30ebbb=_0xa32bc5['body'],_0x354cd4=Yup[_0xeb9f67(0x1b5)]()[_0xeb9f67(0x194)]({'name':Yup[_0xeb9f67(0x1ec)]()});try{await _0x354cd4[_0xeb9f67(0x158)](_0x30ebbb);}catch(_0x40dd2c){throw new AppError_1['default'](_0x40dd2c[_0xeb9f67(0x166)]);}const {id:_0xfc4f73,status:_0x287551}=_0x30ebbb;if(_0x223893===0x1){const _0x16e3c0=await(0x0,UpdateInvoiceService_1['default'])({'id':_0xfc4f73,'status':_0x287551}),_0xfdae39=await Invoices_1[_0xeb9f67(0x204)][_0xeb9f67(0x203)](_0xfc4f73),_0x448e76=_0xfdae39[_0xeb9f67(0x146)],_0x29d1c8=await Company_1['default'][_0xeb9f67(0x203)](_0x448e76),_0x722d88=new Date(_0x29d1c8[_0xeb9f67(0x18c)]);_0x722d88[_0xeb9f67(0x193)](_0x722d88['getDate']()+0x1e);const _0x561214=_0x722d88['toISOString']()[_0xeb9f67(0x1bd)]('T')[0x0];if(_0x29d1c8){await _0x29d1c8['update']({'dueDate':_0x561214});const _0x4f39f9=await _0xfdae39[_0xeb9f67(0x1eb)]({'id':_0xfc4f73,'status':_0xeb9f67(0x159)});await _0x29d1c8[_0xeb9f67(0x199)]();const _0x15cd59=(0x0,socket_1[_0xeb9f67(0x13d)])(),_0x2e4279=await Company_1[_0xeb9f67(0x204)][_0xeb9f67(0x1b3)]({'where':{'id':_0x448e76}});}return _0x53e848[_0xeb9f67(0x1f6)](0xc8)[_0xeb9f67(0x143)](_0x16e3c0);}else return _0x53e848[_0xeb9f67(0x1f6)](0x191)[_0xeb9f67(0x143)]({'status':_0xeb9f67(0x181),'error':'Acesso\x20não\x20autorizado.\x20Por\x20favor,\x20forneça\x20credenciais\x20válidas.'});};exports[a9_0x16f33f(0x14f)]=updateApi;const updateUsageStats=async(_0x292d0b,_0x2a97e8)=>{const _0x50f8db=a9_0x16f33f;if(!_0x292d0b[_0x50f8db(0x1f0)]||!_0x292d0b['user'][_0x50f8db(0x146)])return _0x2a97e8[_0x50f8db(0x1f6)](0x190)[_0x50f8db(0x1ba)]({'status':_0x50f8db(0x1bb),'message':_0x50f8db(0x19a)});const {companyId:_0x3d0221}=_0x292d0b[_0x50f8db(0x1f0)],{contactId:_0xdaf6c6}=_0x292d0b[_0x50f8db(0x1ee)];return setTimeout(async()=>{const _0x36587e=_0x50f8db,{dateToClient:_0x29d0c3}=(0x0,useDate_1['useDate'])(),_0xff8b98=_0x29d0c3(new Date()[_0x36587e(0x18d)]()),_0x2f47a9=(0x0,moment_1[_0x36587e(0x204)])()[_0x36587e(0x1b7)]();try{const _0x22e797=await ApiUsages_1[_0x36587e(0x204)][_0x36587e(0x1b3)]({'where':{'dateUsed':_0xff8b98,'companyId':_0x3d0221}});if(_0x22e797)await _0x22e797['update']({'usedOther':_0x22e797[_0x36587e(0x1b1)][_0x36587e(0x1c0)]+0x1,'UsedOnDay':_0x22e797['dataValues'][_0x36587e(0x1fd)]+0x1,'updatedAt':_0x2f47a9});else{const _0xab19a1=await ApiUsages_1[_0x36587e(0x204)][_0x36587e(0x1bc)]({'companyId':_0x3d0221,'dateUsed':_0xff8b98});await _0xab19a1[_0x36587e(0x1eb)]({'usedOther':_0xab19a1['dataValues'][_0x36587e(0x1c0)]+0x1,'UsedOnDay':_0xab19a1['dataValues'][_0x36587e(0x1fd)]+0x1,'updatedAt':_0x2f47a9});}}catch(_0x7a745e){return console[_0x36587e(0x1e6)](_0x36587e(0x132),_0x7a745e),_0x2a97e8['status'](0x1f4)[_0x36587e(0x1ba)]({'status':'ERROR','message':_0x36587e(0x168)});}},0x64),_0x2a97e8[_0x50f8db(0x1ba)]({'status':_0x50f8db(0x1c1)});};exports['updateUsageStats']=updateUsageStats;const indexContacts=async(_0x1c47f8,_0xe29a2d)=>{const _0x3bab6d=a9_0x16f33f,{searchParam:_0x54fd75,pageNumber:_0x16f822}=_0x1c47f8[_0x3bab6d(0x136)],{companyId:_0x464ceb}=_0x1c47f8['user'],{contacts:_0xe9db94,count:_0x1817ce,hasMore:_0x4a5292}=await(0x0,ListContactsService_1['default'])({'searchParam':_0x54fd75,'pageNumber':_0x16f822,'companyId':_0x464ceb});return _0xe29a2d[_0x3bab6d(0x143)]({'contacts':_0xe9db94,'count':_0x1817ce,'hasMore':_0x4a5292});};exports['indexContacts']=indexContacts;const listContacts=async(_0x2dcf36,_0x9e1105)=>{const _0x59aa40=a9_0x16f33f,{name:_0x1e5cbe}=_0x2dcf36[_0x59aa40(0x136)],{companyId:_0xfe11b5}=_0x2dcf36[_0x59aa40(0x1f0)],_0x1cd2fc=await(0x0,SimpleListService_1[_0x59aa40(0x204)])({'name':_0x1e5cbe,'companyId':_0xfe11b5});return _0x9e1105[_0x59aa40(0x143)](_0x1cd2fc);};exports[a9_0x16f33f(0x1e3)]=listContacts;const showContacts=async(_0x4a3ef5,_0xa15dd2)=>{const _0x522a7f=a9_0x16f33f,{contactId:_0x48fe47}=_0x4a3ef5['params'],{companyId:_0x426516}=_0x4a3ef5[_0x522a7f(0x1f0)],_0x28596d=await(0x0,ShowContactService_1[_0x522a7f(0x204)])(_0x48fe47,_0x426516);return _0xa15dd2['status'](0xc8)[_0x522a7f(0x143)](_0x28596d);};exports[a9_0x16f33f(0x1ca)]=showContacts;const findOrCreateContacts=async(_0x886514,_0x2ed65a)=>{const _0x504089=a9_0x16f33f,{name:_0x577a25,number:_0x3b0842}=_0x886514[_0x504089(0x18e)],{companyId:_0x2b21d0}=_0x886514['user'],_0x420e89=await(0x0,GetContactService_1[_0x504089(0x204)])({'name':_0x577a25,'number':_0x3b0842,'companyId':_0x2b21d0});return _0x2ed65a[_0x504089(0x1f6)](0xc8)[_0x504089(0x143)](_0x420e89);};exports[a9_0x16f33f(0x187)]=findOrCreateContacts;const storeContacts=async(_0x294e6f,_0x3e472b)=>{const _0x284879=a9_0x16f33f,{companyId:_0x5ea8c1}=_0x294e6f[_0x284879(0x1f0)],_0x22be08=_0x294e6f[_0x284879(0x18e)];_0x22be08[_0x284879(0x133)]=_0x22be08[_0x284879(0x133)][_0x284879(0x17e)]('-','')[_0x284879(0x17e)]('\x20','');const _0x7435c=Yup['object']()[_0x284879(0x194)]({'name':Yup[_0x284879(0x1ec)]()[_0x284879(0x179)](),'number':Yup['string']()[_0x284879(0x179)]()[_0x284879(0x197)](/^\d+$/,_0x284879(0x161))});try{await _0x7435c[_0x284879(0x158)](_0x22be08);}catch(_0x5b1acb){throw new AppError_1[(_0x284879(0x204))](_0x5b1acb['message']);}await(0x0,CheckIsValidContact_1['default'])(_0x22be08[_0x284879(0x133)],_0x5ea8c1);const _0x127a7f=await(0x0,CheckNumber_1['default'])(_0x22be08[_0x284879(0x133)],_0x5ea8c1),_0x550f82=_0x127a7f[_0x284879(0x13e)][_0x284879(0x17e)](/\D/g,'');_0x22be08[_0x284879(0x133)]=_0x550f82;const _0x160608=await(0x0,CreateContactService_1[_0x284879(0x204)])({..._0x22be08,'companyId':_0x5ea8c1}),_0xacb86=(0x0,socket_1[_0x284879(0x13d)])();return _0xacb86[_0x284879(0x1cd)](_0x284879(0x144)+_0x5ea8c1+_0x284879(0x188),{'action':_0x284879(0x1bc),'contact':_0x160608}),_0x3e472b[_0x284879(0x1f6)](0xc8)[_0x284879(0x143)](_0x160608);};exports[a9_0x16f33f(0x15c)]=storeContacts;const removeAllContacts=async(_0x5578dc,_0x33f574)=>{const _0x3f1ff8=a9_0x16f33f,{companyId:_0x5476f7}=_0x5578dc[_0x3f1ff8(0x1f0)];try{await Contact_1['default']['destroy']({'where':{'companyId':_0x5476f7}});const _0x404f24=(0x0,socket_1[_0x3f1ff8(0x13d)])();return _0x404f24[_0x3f1ff8(0x1cd)](_0x3f1ff8(0x144)+_0x5476f7+_0x3f1ff8(0x188),{'action':_0x3f1ff8(0x200)}),setTimeout(async()=>{const _0x158daa=_0x3f1ff8,{dateToClient:_0x124c64}=(0x0,useDate_1['useDate'])(),_0x167503=_0x124c64(new Date()[_0x158daa(0x18d)]()),_0x4b86e2=(0x0,moment_1[_0x158daa(0x204)])()[_0x158daa(0x1b7)]();try{const _0x409423=await ApiUsages_1['default']['findOne']({'where':{'dateUsed':_0x167503,'companyId':_0x5476f7}});if(_0x409423)await _0x409423[_0x158daa(0x1eb)]({'usedOther':_0x409423['dataValues'][_0x158daa(0x1c0)]+0x1,'UsedOnDay':_0x409423[_0x158daa(0x1b1)][_0x158daa(0x1fd)]+0x1,'updatedAt':_0x4b86e2});else{const _0x5bb792=await ApiUsages_1[_0x158daa(0x204)][_0x158daa(0x1bc)]({'companyId':_0x5476f7,'dateUsed':_0x167503});await _0x5bb792[_0x158daa(0x1eb)]({'usedOther':_0x5bb792[_0x158daa(0x1b1)][_0x158daa(0x1c0)]+0x1,'UsedOnDay':_0x5bb792['dataValues'][_0x158daa(0x1fd)]+0x1,'updatedAt':_0x4b86e2});}}catch(_0x450479){return console[_0x158daa(0x1e6)](_0x158daa(0x132),_0x450479),_0x33f574['status'](0x1f4)[_0x158daa(0x1ba)]({'status':_0x158daa(0x1bb),'message':_0x158daa(0x168)});}},0x64),_0x33f574['status'](0xc8)['send']({'status':_0x3f1ff8(0x1c1),'message':_0x3f1ff8(0x137)});}catch(_0x1493f6){return console['error']('Error\x20removing\x20all\x20contacts:',_0x1493f6),_0x33f574[_0x3f1ff8(0x1f6)](0x1f4)[_0x3f1ff8(0x1ba)]({'status':_0x3f1ff8(0x1bb),'message':_0x3f1ff8(0x168)});}};exports[a9_0x16f33f(0x13a)]=removeAllContacts;const updateContacts=async(_0x272925,_0xd97646)=>{const _0x1f65f8=a9_0x16f33f,_0x310533=_0x272925[_0x1f65f8(0x18e)],{companyId:_0x1e7f01}=_0x272925[_0x1f65f8(0x1f0)],_0x366367=Yup[_0x1f65f8(0x1b5)]()['shape']({'name':Yup['string'](),'number':Yup['string']()[_0x1f65f8(0x197)](/^\d+$/,'Invalid\x20number\x20format.\x20Only\x20numbers\x20is\x20allowed.')});try{await _0x366367['validate'](_0x310533);}catch(_0x19ff52){throw new AppError_1['default'](_0x19ff52[_0x1f65f8(0x166)]);}await(0x0,CheckIsValidContact_1[_0x1f65f8(0x204)])(_0x310533[_0x1f65f8(0x133)],_0x1e7f01);const _0x3ffb48=await(0x0,CheckNumber_1[_0x1f65f8(0x204)])(_0x310533[_0x1f65f8(0x133)],_0x1e7f01),_0x29d9ba=_0x3ffb48[_0x1f65f8(0x13e)][_0x1f65f8(0x17e)](/\D/g,'');_0x310533[_0x1f65f8(0x133)]=_0x29d9ba;const {contactId:_0x3de7de}=_0x272925[_0x1f65f8(0x1ee)],_0x29ff5f=await(0x0,UpdateContactService_1[_0x1f65f8(0x204)])({'contactData':_0x310533,'contactId':_0x3de7de,'companyId':_0x1e7f01}),_0x2cceb6=(0x0,socket_1['getIO'])();return _0x2cceb6[_0x1f65f8(0x1cd)](_0x1f65f8(0x144)+_0x1e7f01+_0x1f65f8(0x188),{'action':_0x1f65f8(0x1eb),'contact':_0x29ff5f}),_0xd97646[_0x1f65f8(0x1f6)](0xc8)[_0x1f65f8(0x143)](_0x29ff5f);};exports[a9_0x16f33f(0x1e9)]=updateContacts;const removeContacts=async(_0xcb51a2,_0x2a5ec4)=>{const _0x55bf46=a9_0x16f33f,{contactId:_0x1f5d4e}=_0xcb51a2['params'],{companyId:_0xd2e10a}=_0xcb51a2['user'];await(0x0,ShowContactService_1[_0x55bf46(0x204)])(_0x1f5d4e,_0xd2e10a),await(0x0,DeleteContactService_1['default'])(_0x1f5d4e);const _0x5223d0=(0x0,socket_1[_0x55bf46(0x13d)])();return _0x5223d0[_0x55bf46(0x1cd)](_0x55bf46(0x144)+_0xd2e10a+'-contact',{'action':_0x55bf46(0x202),'contactId':_0x1f5d4e}),_0x2a5ec4[_0x55bf46(0x1f6)](0xc8)[_0x55bf46(0x143)]({'message':'Contact\x20deleted'});};exports['removeContacts']=removeContacts;const uploadContacts=async(_0x303d4c,_0x31bfa1)=>{const _0x5a0805=a9_0x16f33f,_0x5b60c7=_0x303d4c[_0x5a0805(0x1e1)],_0x2bab4c=(0x0,lodash_1['head'])(_0x5b60c7),{companyId:_0x1c3f66}=_0x303d4c[_0x5a0805(0x1f0)],_0x4ffda2=await(0x0,ImportXLSContactsService_1[_0x5a0805(0x135)])(_0x1c3f66,_0x2bab4c),_0x42362e=(0x0,socket_1['getIO'])(),_0x3a9961={'action':_0x5a0805(0x199),'records':_0x4ffda2};return _0x42362e['to']('company-'+_0x1c3f66+_0x5a0805(0x165))[_0x5a0805(0x1cd)](_0x5a0805(0x144)+_0x1c3f66+_0x5a0805(0x188),_0x3a9961),_0x31bfa1['status'](0xc8)[_0x5a0805(0x143)](_0x4ffda2);};exports[a9_0x16f33f(0x153)]=uploadContacts;const toggleDisableBotContacts=async(_0x3ca80b,_0x45059e)=>{const _0x16c52e=a9_0x16f33f,{contactId:_0x22a4ee}=_0x3ca80b[_0x16c52e(0x1ee)],{companyId:_0x3d6588}=_0x3ca80b['user'],_0x5b45dd=await(0x0,ToggleDisableBotService_1[_0x16c52e(0x204)])(_0x22a4ee,_0x3d6588),_0x4e3dfc=(0x0,socket_1[_0x16c52e(0x13d)])();return _0x4e3dfc[_0x16c52e(0x1cd)](_0x16c52e(0x144)+_0x3d6588+_0x16c52e(0x188),{'action':'update','contact':_0x5b45dd}),_0x45059e[_0x16c52e(0x1f6)](0xc8)[_0x16c52e(0x143)](_0x5b45dd);};exports[a9_0x16f33f(0x192)]=toggleDisableBotContacts;