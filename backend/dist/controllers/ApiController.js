const a9_0x858e8b=a9_0x26f9;(function(_0x24077d,_0x5c84ad){const _0x7059ef=a9_0x26f9,_0x37b691=_0x24077d();while(!![]){try{const _0x540aee=parseInt(_0x7059ef(0xad))/0x1+-parseInt(_0x7059ef(0x14a))/0x2+-parseInt(_0x7059ef(0xc3))/0x3*(-parseInt(_0x7059ef(0x77))/0x4)+parseInt(_0x7059ef(0x140))/0x5*(parseInt(_0x7059ef(0x11b))/0x6)+-parseInt(_0x7059ef(0xa1))/0x7+parseInt(_0x7059ef(0x13f))/0x8*(-parseInt(_0x7059ef(0xb7))/0x9)+parseInt(_0x7059ef(0x8b))/0xa*(parseInt(_0x7059ef(0xae))/0xb);if(_0x540aee===_0x5c84ad)break;else _0x37b691['push'](_0x37b691['shift']());}catch(_0x3fc57b){_0x37b691['push'](_0x37b691['shift']());}}}(a9_0xe006,0x5db1e));const a9_0xaacd48=(function(){let _0x5ded92=!![];return function(_0xe61ca6,_0x49fc42){const _0x190ca5=_0x5ded92?function(){if(_0x49fc42){const _0x1d0d58=_0x49fc42['apply'](_0xe61ca6,arguments);return _0x49fc42=null,_0x1d0d58;}}:function(){};return _0x5ded92=![],_0x190ca5;};}()),a9_0x2b79ae=a9_0xaacd48(this,function(){const _0x31909e=a9_0x26f9;return a9_0x2b79ae[_0x31909e(0x79)]()['search'](_0x31909e(0x9f))[_0x31909e(0x79)]()[_0x31909e(0x10a)](a9_0x2b79ae)[_0x31909e(0xbc)]('(((.+)+)+)+$');});a9_0x2b79ae();'use strict';var __createBinding=this&&this['__createBinding']||(Object[a9_0x858e8b(0x13e)]?function(_0x196312,_0x51261e,_0x5a620e,_0x4ea974){const _0x162f51=a9_0x858e8b;if(_0x4ea974===undefined)_0x4ea974=_0x5a620e;var _0x3e4d4a=Object['getOwnPropertyDescriptor'](_0x51261e,_0x5a620e);(!_0x3e4d4a||(_0x162f51(0x8e)in _0x3e4d4a?!_0x51261e[_0x162f51(0x117)]:_0x3e4d4a[_0x162f51(0xe8)]||_0x3e4d4a['configurable']))&&(_0x3e4d4a={'enumerable':!![],'get':function(){return _0x51261e[_0x5a620e];}}),Object['defineProperty'](_0x196312,_0x4ea974,_0x3e4d4a);}:function(_0x3aa849,_0x915b49,_0x51ed39,_0x315ad6){if(_0x315ad6===undefined)_0x315ad6=_0x51ed39;_0x3aa849[_0x315ad6]=_0x915b49[_0x51ed39];}),__setModuleDefault=this&&this['__setModuleDefault']||(Object['create']?function(_0xdbb0bc,_0x47de05){const _0x2c200d=a9_0x858e8b;Object['defineProperty'](_0xdbb0bc,_0x2c200d(0x8d),{'enumerable':!![],'value':_0x47de05});}:function(_0x5caa61,_0xf5ce30){const _0x39a5e8=a9_0x858e8b;_0x5caa61[_0x39a5e8(0x8d)]=_0xf5ce30;}),__importStar=this&&this[a9_0x858e8b(0x120)]||function(_0x4be949){const _0x1ae1e6=a9_0x858e8b;if(_0x4be949&&_0x4be949['__esModule'])return _0x4be949;var _0xdebc6e={};if(_0x4be949!=null){for(var _0x1cf6a2 in _0x4be949)if(_0x1cf6a2!==_0x1ae1e6(0x8d)&&Object[_0x1ae1e6(0xfe)]['hasOwnProperty'][_0x1ae1e6(0x128)](_0x4be949,_0x1cf6a2))__createBinding(_0xdebc6e,_0x4be949,_0x1cf6a2);}return __setModuleDefault(_0xdebc6e,_0x4be949),_0xdebc6e;},__importDefault=this&&this[a9_0x858e8b(0xec)]||function(_0x94abf9){return _0x94abf9&&_0x94abf9['__esModule']?_0x94abf9:{'default':_0x94abf9};};Object['defineProperty'](exports,'__esModule',{'value':!![]}),exports[a9_0x858e8b(0xb2)]=exports[a9_0x858e8b(0x98)]=exports[a9_0x858e8b(0x78)]=exports[a9_0x858e8b(0x10e)]=exports['removeAllContacts']=exports[a9_0x858e8b(0xb1)]=exports[a9_0x858e8b(0x14d)]=exports[a9_0x858e8b(0xc0)]=exports[a9_0x858e8b(0x8f)]=exports['indexContacts']=exports[a9_0x858e8b(0xe6)]=exports[a9_0x858e8b(0x127)]=exports[a9_0x858e8b(0xcb)]=exports[a9_0x858e8b(0x110)]=exports[a9_0x858e8b(0x148)]=exports[a9_0x858e8b(0xe3)]=exports[a9_0x858e8b(0xc4)]=exports[a9_0x858e8b(0x81)]=exports[a9_0x858e8b(0x123)]=exports[a9_0x858e8b(0x9a)]=exports[a9_0x858e8b(0x130)]=exports[a9_0x858e8b(0xef)]=exports[a9_0x858e8b(0xa2)]=exports[a9_0x858e8b(0xe2)]=exports[a9_0x858e8b(0x139)]=exports[a9_0x858e8b(0xb9)]=exports['indexImage']=exports['index']=exports[a9_0x858e8b(0xc7)]=exports[a9_0x858e8b(0xc1)]=exports[a9_0x858e8b(0xfd)]=exports['createCompany']=exports['OnWhatsAppDto']=void 0x0;const axios_1=__importDefault(require(a9_0x858e8b(0xf0))),fs_1=__importDefault(require('fs')),Yup=__importStar(require(a9_0x858e8b(0xe0))),lodash_1=require(a9_0x858e8b(0x108)),GetDefaultWhatsApp_1=__importDefault(require('../helpers/GetDefaultWhatsApp')),SetTicketMessagesAsRead_1=__importDefault(require('../helpers/SetTicketMessagesAsRead')),socket_1=require(a9_0x858e8b(0x147)),Whatsapp_1=__importDefault(require(a9_0x858e8b(0x11c))),Queue_1=__importDefault(require('../models/Queue')),User_1=__importDefault(require('../models/User')),CreateOrUpdateContactService_1=__importDefault(require(a9_0x858e8b(0xde))),FindOrCreateTicketService_1=__importDefault(require(a9_0x858e8b(0x74))),ShowTicketService_1=__importDefault(require(a9_0x858e8b(0x88))),GetProfilePicUrl_1=__importDefault(require(a9_0x858e8b(0xd2))),SendWhatsAppMedia_1=__importDefault(require(a9_0x858e8b(0x115))),UpdateTicketService_1=__importDefault(require(a9_0x858e8b(0x97))),wbot_1=require(a9_0x858e8b(0x116)),SendWhatsAppMessageLink_1=__importDefault(require(a9_0x858e8b(0xbb))),SendWhatsAppMessageAPI_1=__importDefault(require(a9_0x858e8b(0x12a))),SendWhatsappMediaImage_1=__importDefault(require(a9_0x858e8b(0x104))),ListInvoicesServices_1=__importDefault(require(a9_0x858e8b(0x125))),ShowInvoiceService_1=__importDefault(require(a9_0x858e8b(0xa9))),UpdateInvoiceService_1=__importDefault(require(a9_0x858e8b(0x80))),Invoices_1=__importDefault(require(a9_0x858e8b(0x129))),ListContactsService_1=__importDefault(require(a9_0x858e8b(0x90))),CreateContactService_1=__importDefault(require(a9_0x858e8b(0xfa))),ShowContactService_1=__importDefault(require(a9_0x858e8b(0x12d))),UpdateContactService_1=__importDefault(require(a9_0x858e8b(0x7f))),DeleteContactService_1=__importDefault(require(a9_0x858e8b(0xd9))),GetContactService_1=__importDefault(require(a9_0x858e8b(0xbd))),ToggleDisableBotService_1=__importDefault(require('../services/ContactServices/ToggleDisableBotService')),CheckNumber_1=__importDefault(require('../services/WbotServices/CheckNumber')),CheckIsValidContact_1=__importDefault(require(a9_0x858e8b(0x7c))),AppError_1=__importDefault(require(a9_0x858e8b(0xcd))),SimpleListService_1=__importDefault(require('../services/ContactServices/SimpleListService')),ImportXLSContactsService_1=require(a9_0x858e8b(0x126)),ApiUsages_1=__importDefault(require(a9_0x858e8b(0x111))),useDate_1=require(a9_0x858e8b(0x103)),TicketTag_1=__importDefault(require(a9_0x858e8b(0xaf))),Tag_1=__importDefault(require(a9_0x858e8b(0x95))),moment_1=__importDefault(require('moment')),path_1=__importDefault(require(a9_0x858e8b(0xf4))),Ticket_1=__importDefault(require(a9_0x858e8b(0x9c))),Contact_1=__importDefault(require(a9_0x858e8b(0x9e))),Company_1=__importDefault(require(a9_0x858e8b(0x132))),SendPresenceStatus_1=require(a9_0x858e8b(0xa5));class OnWhatsAppDto{constructor(_0x5719ea,_0x17b66e){const _0x12ca7b=a9_0x858e8b;this[_0x12ca7b(0x12f)]=_0x5719ea,this[_0x12ca7b(0x144)]=_0x17b66e;}}exports[a9_0x858e8b(0x102)]=OnWhatsAppDto;const CompanySchema=Yup[a9_0x858e8b(0xf9)]()[a9_0x858e8b(0x113)]({'name':Yup[a9_0x858e8b(0x76)]()[a9_0x858e8b(0xca)](),'id':Yup[a9_0x858e8b(0x133)](),'phone':Yup[a9_0x858e8b(0x76)]()[a9_0x858e8b(0xe5)](),'email':Yup[a9_0x858e8b(0x76)]()['email']()[a9_0x858e8b(0xe5)](),'status':Yup[a9_0x858e8b(0xd0)]()['nullable'](),'planId':Yup[a9_0x858e8b(0x133)]()[a9_0x858e8b(0xe5)](),'campaignsEnabled':Yup['boolean']()[a9_0x858e8b(0xe5)](),'dueDate':Yup[a9_0x858e8b(0xf3)]()['nullable'](),'recurrence':Yup[a9_0x858e8b(0x76)]()[a9_0x858e8b(0xe5)]()}),createCompany=async(_0x352c95,_0x2adb9f)=>{const _0x3bfa0c=a9_0x858e8b;try{await CompanySchema[_0x3bfa0c(0x91)](_0x352c95['body']);const _0x325075=await Company_1['default']['create'](_0x352c95[_0x3bfa0c(0x135)]);_0x2adb9f['status'](0xc9)[_0x3bfa0c(0x82)](_0x325075);}catch(_0x365693){_0x2adb9f['status'](0x190)[_0x3bfa0c(0x82)]({'error':_0x365693[_0x3bfa0c(0xff)]});}};exports[a9_0x858e8b(0xb6)]=createCompany;const updateCompany=async(_0x758e7e,_0x2b6b3a)=>{const _0x2d8bc=a9_0x858e8b;try{await CompanySchema[_0x2d8bc(0x91)](_0x758e7e[_0x2d8bc(0x135)]);const {id:_0x28d308}=_0x758e7e[_0x2d8bc(0x13c)],[_0x33c911]=await Company_1[_0x2d8bc(0x8d)][_0x2d8bc(0xe7)](_0x758e7e[_0x2d8bc(0x135)],{'where':{'id':_0x28d308}});if(_0x33c911){const _0x4ae523=await Company_1[_0x2d8bc(0x8d)][_0x2d8bc(0xf1)](_0x28d308);_0x2b6b3a[_0x2d8bc(0xcc)](0xc8)[_0x2d8bc(0x82)](_0x4ae523);}else _0x2b6b3a[_0x2d8bc(0xcc)](0x194)[_0x2d8bc(0x82)]({'error':_0x2d8bc(0x101)});}catch(_0x4b451f){_0x2b6b3a[_0x2d8bc(0xcc)](0x190)[_0x2d8bc(0x82)]({'error':_0x4b451f[_0x2d8bc(0xff)]});}};exports['updateCompany']=updateCompany;const blockCompany=async(_0x3e0221,_0x15d8af)=>{const _0x42fafd=a9_0x858e8b;try{const {id:_0x1fa4d3}=_0x3e0221[_0x42fafd(0x13c)],[_0x4e246a]=await Company_1[_0x42fafd(0x8d)][_0x42fafd(0xe7)]({'status':![]},{'where':{'id':_0x1fa4d3}});if(_0x4e246a){const _0x11288f=await Company_1['default'][_0x42fafd(0xf1)](_0x1fa4d3);_0x15d8af[_0x42fafd(0xcc)](0xc8)[_0x42fafd(0x82)](_0x11288f);}else _0x15d8af[_0x42fafd(0xcc)](0x194)[_0x42fafd(0x82)]({'error':'Company\x20not\x20found'});}catch(_0x1565c4){_0x15d8af[_0x42fafd(0xcc)](0x190)['json']({'error':_0x1565c4[_0x42fafd(0xff)]});}};exports['blockCompany']=blockCompany;const createContact=async(_0x1cff8b,_0x17c4bb,_0x1a43e6)=>{const _0x5b0445=a9_0x858e8b;await(0x0,CheckIsValidContact_1[_0x5b0445(0x8d)])(_0x1a43e6,_0x17c4bb);const _0x2769df=await(0x0,CheckNumber_1[_0x5b0445(0x8d)])(_0x1a43e6,_0x17c4bb),_0x1cdc04=await(0x0,GetProfilePicUrl_1[_0x5b0445(0x8d)])(_0x2769df,_0x17c4bb),_0x4afe3f=_0x2769df,_0x2a7995={'name':''+_0x4afe3f,'number':_0x4afe3f,'profilePicUrl':_0x1cdc04,'isGroup':![],'companyId':_0x17c4bb},_0x56dd04=await(0x0,CreateOrUpdateContactService_1[_0x5b0445(0x8d)])(_0x2a7995,null,null);let _0x10c2e2;if(_0x1cff8b===undefined)_0x10c2e2=await(0x0,GetDefaultWhatsApp_1[_0x5b0445(0x8d)])(_0x17c4bb);else{_0x10c2e2=await Whatsapp_1[_0x5b0445(0x8d)][_0x5b0445(0xf1)](_0x1cff8b);if(_0x10c2e2===null)throw new AppError_1['default'](_0x5b0445(0x14e)+_0x1cff8b+'\x20not\x20found');}const _0x191832=await(0x0,FindOrCreateTicketService_1[_0x5b0445(0x8d)])(_0x56dd04,_0x10c2e2['id'],0x0,_0x17c4bb),_0x22018d=await(0x0,ShowTicketService_1['default'])(_0x191832['id'],_0x17c4bb);return(0x0,SetTicketMessagesAsRead_1[_0x5b0445(0x8d)])(_0x22018d),_0x22018d;};function a9_0x26f9(_0x562443,_0x4ac257){const _0x1417c6=a9_0xe006();return a9_0x26f9=function(_0x2b79ae,_0xaacd48){_0x2b79ae=_0x2b79ae-0x74;let _0xe0067d=_0x1417c6[_0x2b79ae];return _0xe0067d;},a9_0x26f9(_0x562443,_0x4ac257);}function formatBRNumber(_0x2d4ced){const _0x57a5d0=a9_0x858e8b,_0x2a6b17=new RegExp(/^(\d{2})(\d{2})\d{1}(\d{8})$/);if(_0x2a6b17[_0x57a5d0(0xdc)](_0x2d4ced)){const _0x2141ac=_0x2a6b17[_0x57a5d0(0xee)](_0x2d4ced);if(_0x2141ac&&_0x2141ac[0x1]==='55'&&Number['isInteger'](Number[_0x57a5d0(0xc2)](_0x2141ac[0x2]))){const _0x16bd97=Number[_0x57a5d0(0xc2)](_0x2141ac[0x2]);if(_0x16bd97<0x1f)return _0x2141ac[0x0];else{if(_0x16bd97>=0x1f)return _0x2141ac[0x1]+_0x2141ac[0x2]+_0x2141ac[0x3];}}}else return _0x2d4ced;}function createJid(_0x16c676){const _0x8667e5=a9_0x858e8b;if(_0x16c676[_0x8667e5(0x8c)](_0x8667e5(0x136))||_0x16c676[_0x8667e5(0x8c)](_0x8667e5(0x107)))return formatBRNumber(_0x16c676);return _0x16c676[_0x8667e5(0x8c)]('-')?_0x16c676+_0x8667e5(0x136):formatBRNumber(_0x16c676)+_0x8667e5(0x107);}const indexLink=async(_0x2a09ea,_0x5043e2)=>{const _0xfa9c88=a9_0x858e8b,_0x1e55b4=_0x2a09ea['body'],{whatsappId:_0x4c9e36}=_0x2a09ea[_0xfa9c88(0x135)],{msdelay:_0x10f9f9}=_0x2a09ea[_0xfa9c88(0x135)],_0x1c1d44=_0x2a09ea[_0xfa9c88(0x135)][_0xfa9c88(0x106)],_0x4d920a=_0x2a09ea[_0xfa9c88(0x135)]['caption'],_0x1f1406=_0x2a09ea[_0xfa9c88(0xfc)][_0xfa9c88(0x149)],[,_0x54b90e]=_0x1f1406[_0xfa9c88(0xd7)]('\x20'),_0x3cef60=await Whatsapp_1[_0xfa9c88(0x8d)][_0xfa9c88(0x118)]({'where':{'token':_0x54b90e}}),_0x581d99=_0x3cef60[_0xfa9c88(0xed)];_0x1e55b4[_0xfa9c88(0x133)]=_0x1e55b4[_0xfa9c88(0x133)][_0xfa9c88(0xd8)]('-','')[_0xfa9c88(0xd8)]('\x20','');const _0x3c6065=Yup[_0xfa9c88(0xf9)]()[_0xfa9c88(0x113)]({'number':Yup['string']()[_0xfa9c88(0xca)]()[_0xfa9c88(0xeb)](/^\d+$/,_0xfa9c88(0x100))});try{await _0x3c6065[_0xfa9c88(0x91)](_0x1e55b4);}catch(_0x312317){throw new AppError_1[(_0xfa9c88(0x8d))](_0x312317[_0xfa9c88(0xff)]);}const _0x338dba=await createContact(_0x4c9e36,_0x581d99,_0x1e55b4[_0xfa9c88(0x133)]);return await(0x0,SendWhatsAppMessageLink_1[_0xfa9c88(0x8d)])({'ticket':_0x338dba,'url':_0x1c1d44,'caption':_0x4d920a,'msdelay':_0x10f9f9}),setTimeout(async()=>{const _0x3dc861=_0xfa9c88;await(0x0,UpdateTicketService_1['default'])({'ticketId':_0x338dba['id'],'ticketData':{'status':_0x3dc861(0xb4),'sendFarewellMessage':![],'amountUsedBotQueues':0x0},'companyId':_0x581d99});},0xc8),setTimeout(async()=>{const _0xa19f64=_0xfa9c88,{dateToClient:_0x5a4c62}=(0x0,useDate_1[_0xa19f64(0xbe)])(),_0x1632d8=_0x5a4c62(new Date()[_0xa19f64(0x79)]()),_0x3635f3=(0x0,moment_1[_0xa19f64(0x8d)])()[_0xa19f64(0x10c)](),_0x5641a1=await ApiUsages_1[_0xa19f64(0x8d)][_0xa19f64(0x118)]({'where':{'dateUsed':_0x1632d8,'companyId':_0x581d99}});if(_0x5641a1)await _0x5641a1[_0xa19f64(0xe7)]({'usedPDF':_0x5641a1[_0xa19f64(0x12e)][_0xa19f64(0xa6)]+0x1,'UsedOnDay':_0x5641a1[_0xa19f64(0x12e)]['UsedOnDay']+0x1,'updatedAt':_0x3635f3});else{const _0x93fc3e=await ApiUsages_1[_0xa19f64(0x8d)][_0xa19f64(0x13e)]({'companyId':_0x581d99,'dateUsed':_0x1632d8});await _0x93fc3e[_0xa19f64(0xe7)]({'usedPDF':_0x93fc3e['dataValues'][_0xa19f64(0xa6)]+0x1,'UsedOnDay':_0x93fc3e[_0xa19f64(0x12e)]['UsedOnDay']+0x1,'updatedAt':_0x3635f3});}},0x64),_0x5043e2[_0xfa9c88(0xc8)]({'status':_0xfa9c88(0xfb)});};exports[a9_0x858e8b(0xc7)]=indexLink;const index=async(_0x437bf0,_0x302cf7)=>{const _0x8efdb=a9_0x858e8b,_0x4819e6=_0x437bf0['body'],{whatsappId:_0x2f0e52}=_0x437bf0['body'],{msdelay:_0x3c6e60}=_0x437bf0[_0x8efdb(0x135)],{body:_0x5a8a3f,quotedMsg:_0x436f69}=_0x437bf0[_0x8efdb(0x135)],_0x6713d9=_0x437bf0[_0x8efdb(0xf8)],_0x53bc3c=_0x437bf0['headers']['authorization'],[,_0x2204c3]=_0x53bc3c[_0x8efdb(0xd7)]('\x20'),_0x3dbe3a=await Whatsapp_1[_0x8efdb(0x8d)]['findOne']({'where':{'token':_0x2204c3}}),_0x561b06=_0x3dbe3a['companyId'];_0x4819e6[_0x8efdb(0x133)]=_0x4819e6[_0x8efdb(0x133)][_0x8efdb(0xd8)]('-','')[_0x8efdb(0xd8)]('\x20','');const _0x4ab89a=Yup[_0x8efdb(0xf9)]()['shape']({'number':Yup[_0x8efdb(0x76)]()[_0x8efdb(0xca)]()[_0x8efdb(0xeb)](/^\d+$/,_0x8efdb(0x100))});try{await _0x4ab89a['validate'](_0x4819e6);}catch(_0x1dafb4){throw new AppError_1[(_0x8efdb(0x8d))](_0x1dafb4['message']);}const _0x4b78e9=await createContact(_0x2f0e52,_0x561b06,_0x4819e6['number']);return _0x6713d9?await Promise[_0x8efdb(0x87)](_0x6713d9[_0x8efdb(0xd1)](async _0x2ca47f=>{const _0x1d4cb9=_0x8efdb;await(0x0,SendWhatsAppMedia_1[_0x1d4cb9(0x8d)])({'body':_0x5a8a3f,'media':_0x2ca47f,'ticket':_0x4b78e9});})):await(0x0,SendWhatsAppMessageAPI_1[_0x8efdb(0x8d)])({'body':_0x5a8a3f,'ticket':_0x4b78e9,'quotedMsg':_0x436f69,'msdelay':_0x3c6e60}),setTimeout(async()=>{const _0x16b2f1=_0x8efdb;await(0x0,UpdateTicketService_1[_0x16b2f1(0x8d)])({'ticketId':_0x4b78e9['id'],'ticketData':{'status':_0x16b2f1(0xb4),'sendFarewellMessage':![],'amountUsedBotQueues':0x0},'companyId':_0x561b06});},0x64),setTimeout(async()=>{const _0x2179b3=_0x8efdb,{dateToClient:_0x1d943e}=(0x0,useDate_1[_0x2179b3(0xbe)])(),_0x3a4111=_0x1d943e(new Date()['toString']()),_0x5183a0=(0x0,moment_1['default'])()[_0x2179b3(0x10c)](),_0x2c40f6=await ApiUsages_1[_0x2179b3(0x8d)][_0x2179b3(0x118)]({'where':{'dateUsed':_0x3a4111,'companyId':_0x561b06}});_0x2c40f6?_0x6713d9?await Promise['all'](_0x6713d9['map'](async _0x2af34c=>{const _0x348102=_0x2179b3;console[_0x348102(0x84)]('media',_0x2af34c);const _0x5e9a11=path_1[_0x348102(0x8d)]['extname'](_0x2af34c[_0x348102(0x109)]);console['log']('type',_0x5e9a11);if(_0x2af34c[_0x348102(0xce)][_0x348102(0x8c)](_0x348102(0xba)))await _0x2c40f6[_0x348102(0xe7)]({'usedPDF':_0x2c40f6[_0x348102(0x12e)]['usedPDF']+0x1,'UsedOnDay':_0x2c40f6[_0x348102(0x12e)][_0x348102(0xd3)]+0x1,'updatedAt':_0x5183a0});else{if(_0x2af34c[_0x348102(0xce)][_0x348102(0x8c)](_0x348102(0x105)))await _0x2c40f6[_0x348102(0xe7)]({'usedImage':_0x2c40f6['dataValues'][_0x348102(0xd5)]+0x1,'UsedOnDay':_0x2c40f6['dataValues'][_0x348102(0xd3)]+0x1,'updatedAt':_0x5183a0});else _0x2af34c[_0x348102(0xce)]['includes']('video')?await _0x2c40f6[_0x348102(0xe7)]({'usedVideo':_0x2c40f6[_0x348102(0x12e)]['usedVideo']+0x1,'UsedOnDay':_0x2c40f6[_0x348102(0x12e)][_0x348102(0xd3)]+0x1,'updatedAt':_0x5183a0}):await _0x2c40f6[_0x348102(0xe7)]({'usedOther':_0x2c40f6[_0x348102(0x12e)][_0x348102(0xe4)]+0x1,'UsedOnDay':_0x2c40f6[_0x348102(0x12e)][_0x348102(0xd3)]+0x1,'updatedAt':_0x5183a0});}})):await _0x2c40f6[_0x2179b3(0xe7)]({'usedText':_0x2c40f6[_0x2179b3(0x12e)][_0x2179b3(0x94)]+0x1,'UsedOnDay':_0x2c40f6['dataValues'][_0x2179b3(0xd3)]+0x1,'updatedAt':_0x5183a0}):(await ApiUsages_1[_0x2179b3(0x8d)][_0x2179b3(0x13e)]({'companyId':_0x561b06,'dateUsed':_0x3a4111}),_0x6713d9?await Promise['all'](_0x6713d9['map'](async _0x35657b=>{const _0x499373=_0x2179b3;console[_0x499373(0x84)](_0x499373(0x86),_0x35657b);const _0xc87c3=path_1[_0x499373(0x8d)][_0x499373(0xa4)](_0x35657b[_0x499373(0x109)]);console[_0x499373(0x84)](_0x499373(0x142),_0xc87c3);if(_0x35657b[_0x499373(0xce)][_0x499373(0x8c)](_0x499373(0xba)))await _0x2c40f6['update']({'usedPDF':_0x2c40f6[_0x499373(0x12e)][_0x499373(0xa6)]+0x1,'UsedOnDay':_0x2c40f6[_0x499373(0x12e)][_0x499373(0xd3)]+0x1,'updatedAt':_0x5183a0});else{if(_0x35657b[_0x499373(0xce)][_0x499373(0x8c)](_0x499373(0x105)))await _0x2c40f6[_0x499373(0xe7)]({'usedImage':_0x2c40f6[_0x499373(0x12e)][_0x499373(0xd5)]+0x1,'UsedOnDay':_0x2c40f6['dataValues'][_0x499373(0xd3)]+0x1,'updatedAt':_0x5183a0});else _0x35657b[_0x499373(0xce)][_0x499373(0x8c)](_0x499373(0x13d))?await _0x2c40f6[_0x499373(0xe7)]({'usedVideo':_0x2c40f6['dataValues'][_0x499373(0x138)]+0x1,'UsedOnDay':_0x2c40f6[_0x499373(0x12e)][_0x499373(0xd3)]+0x1,'updatedAt':_0x5183a0}):await _0x2c40f6[_0x499373(0xe7)]({'usedOther':_0x2c40f6[_0x499373(0x12e)][_0x499373(0xe4)]+0x1,'UsedOnDay':_0x2c40f6[_0x499373(0x12e)]['UsedOnDay']+0x1,'updatedAt':_0x5183a0});}})):await _0x2c40f6[_0x2179b3(0xe7)]({'usedText':_0x2c40f6[_0x2179b3(0x12e)][_0x2179b3(0x94)]+0x1,'UsedOnDay':_0x2c40f6[_0x2179b3(0x12e)][_0x2179b3(0xd3)]+0x1,'updatedAt':_0x5183a0}));},0x64),_0x302cf7['send']({'status':_0x8efdb(0xfb)});};exports['index']=index;const indexImage=async(_0x407c7c,_0x23450f)=>{const _0x42727e=a9_0x858e8b,_0x253b50=_0x407c7c['body'],{whatsappId:_0xb06ce6}=_0x407c7c[_0x42727e(0x135)],{msdelay:_0x381fd0}=_0x407c7c[_0x42727e(0x135)],_0x3ff3fb=_0x407c7c['body'][_0x42727e(0x106)],_0x5970ec=_0x407c7c[_0x42727e(0x135)][_0x42727e(0x7b)],_0x4cc245=_0x407c7c[_0x42727e(0xfc)][_0x42727e(0x149)],[,_0x37ddff]=_0x4cc245[_0x42727e(0xd7)]('\x20'),_0xe353a6=await Whatsapp_1[_0x42727e(0x8d)][_0x42727e(0x118)]({'where':{'token':_0x37ddff}}),_0x287605=_0xe353a6[_0x42727e(0xed)];_0x253b50[_0x42727e(0x133)]=_0x253b50[_0x42727e(0x133)]['replace']('-','')[_0x42727e(0xd8)]('\x20','');const _0x170785=Yup[_0x42727e(0xf9)]()[_0x42727e(0x113)]({'number':Yup[_0x42727e(0x76)]()['required']()[_0x42727e(0xeb)](/^\d+$/,_0x42727e(0x100))});try{await _0x170785[_0x42727e(0x91)](_0x253b50);}catch(_0x316c33){throw new AppError_1[(_0x42727e(0x8d))](_0x316c33[_0x42727e(0xff)]);}const _0x740b92=await createContact(_0xb06ce6,_0x287605,_0x253b50[_0x42727e(0x133)]);return _0x3ff3fb&&await(0x0,SendWhatsappMediaImage_1['default'])({'ticket':_0x740b92,'url':_0x3ff3fb,'caption':_0x5970ec,'msdelay':_0x381fd0}),setTimeout(async()=>{await(0x0,UpdateTicketService_1['default'])({'ticketId':_0x740b92['id'],'ticketData':{'status':'pending','sendFarewellMessage':![],'amountUsedBotQueues':0x0},'companyId':_0x287605});},0x64),setTimeout(async()=>{const _0x55926e=_0x42727e,{dateToClient:_0x315094}=(0x0,useDate_1[_0x55926e(0xbe)])(),_0x114e35=_0x315094(new Date()[_0x55926e(0x79)]()),_0x142874=(0x0,moment_1['default'])()['format'](),_0x3d9f0a=await ApiUsages_1[_0x55926e(0x8d)][_0x55926e(0x118)]({'where':{'dateUsed':_0x114e35,'companyId':_0x287605}});if(_0x3d9f0a)await _0x3d9f0a['update']({'usedImage':_0x3d9f0a[_0x55926e(0x12e)][_0x55926e(0xd5)]+0x1,'UsedOnDay':_0x3d9f0a[_0x55926e(0x12e)][_0x55926e(0xd3)]+0x1,'updatedAt':_0x142874});else{const _0xfb6792=await ApiUsages_1[_0x55926e(0x8d)]['create']({'companyId':_0x287605,'dateUsed':_0x114e35});await _0xfb6792[_0x55926e(0xe7)]({'usedImage':_0xfb6792[_0x55926e(0x12e)]['usedImage']+0x1,'UsedOnDay':_0xfb6792[_0x55926e(0x12e)][_0x55926e(0xd3)]+0x1,'updatedAt':_0x142874});}},0x64),_0x23450f[_0x42727e(0xc8)]({'status':_0x42727e(0xfb)});};exports[a9_0x858e8b(0x14b)]=indexImage;const checkNumber=async(_0x1a4f0a,_0x658675)=>{const _0x4ab49e=a9_0x858e8b,_0x381c43=_0x1a4f0a['body'],_0x35aa5e=_0x1a4f0a[_0x4ab49e(0xfc)][_0x4ab49e(0x149)],[,_0x2915c8]=_0x35aa5e[_0x4ab49e(0xd7)]('\x20'),_0xaaf40=await Whatsapp_1['default'][_0x4ab49e(0x118)]({'where':{'token':_0x2915c8}}),_0x3ce665=_0xaaf40['companyId'],_0x3b8740=_0x381c43[_0x4ab49e(0x133)]['replace']('-','')['replace']('\x20',''),_0x5b1387=await(0x0,GetDefaultWhatsApp_1[_0x4ab49e(0x8d)])(_0x3ce665),_0x2576c0=(0x0,wbot_1[_0x4ab49e(0x10d)])(_0x5b1387['id']),_0x5091b0=createJid(_0x3b8740);try{const [_0x2f9d0a]=await _0x2576c0[_0x4ab49e(0xc5)](_0x5091b0);if(_0x2f9d0a[_0x4ab49e(0x144)])return setTimeout(async()=>{const _0x1d2197=_0x4ab49e,{dateToClient:_0xb7d44e}=(0x0,useDate_1[_0x1d2197(0xbe)])(),_0x49f338=_0xb7d44e(new Date()[_0x1d2197(0x79)]()),_0x422284=(0x0,moment_1['default'])()[_0x1d2197(0x10c)](),_0x4c885e=await ApiUsages_1['default'][_0x1d2197(0x118)]({'where':{'dateUsed':_0x49f338,'companyId':_0x3ce665}});if(_0x4c885e)await _0x4c885e[_0x1d2197(0xe7)]({'usedCheckNumber':_0x4c885e[_0x1d2197(0x12e)][_0x1d2197(0x8a)]+0x1,'UsedOnDay':_0x4c885e[_0x1d2197(0x12e)][_0x1d2197(0xd3)]+0x1,'updatedAt':_0x422284});else{const _0x86b931=await ApiUsages_1['default'][_0x1d2197(0x13e)]({'companyId':_0x3ce665,'dateUsed':_0x49f338});await _0x86b931[_0x1d2197(0xe7)]({'usedCheckNumber':_0x86b931['dataValues'][_0x1d2197(0x8a)]+0x1,'UsedOnDay':_0x86b931[_0x1d2197(0x12e)][_0x1d2197(0xd3)]+0x1,'updatedAt':_0x422284});}},0x64),_0x658675[_0x4ab49e(0xcc)](0xc8)[_0x4ab49e(0x82)]({'existsInWhatsapp':!![],'number':_0x3b8740,'numberFormatted':_0x2f9d0a[_0x4ab49e(0x12f)]});}catch(_0x5c8ad5){return _0x658675[_0x4ab49e(0xcc)](0x190)[_0x4ab49e(0x82)]({'existsInWhatsapp':![],'number':_0x5091b0,'error':'Not\x20exists\x20on\x20Whatsapp'});}};exports[a9_0x858e8b(0xb9)]=checkNumber;const indexWhatsappsId=async(_0x29c5e0,_0x20d95f)=>{const _0x5f45f2=a9_0x858e8b;return console[_0x5f45f2(0x84)](_0x5f45f2(0xdd),_0x29c5e0),console['log'](_0x5f45f2(0xdd),_0x29c5e0[_0x5f45f2(0x124)]),_0x20d95f[_0x5f45f2(0xcc)](0xc8)[_0x5f45f2(0x82)]('oi');};exports['indexWhatsappsId']=indexWhatsappsId;const updateQueueId=async(_0x25c94d,_0x258c97)=>{const _0x1521cf=a9_0x858e8b,{ticketId:_0x2dc6f7}=_0x25c94d[_0x1521cf(0x13c)],{queueId:_0x526300}=_0x25c94d[_0x1521cf(0x135)],_0x59ceee=_0x25c94d[_0x1521cf(0xfc)][_0x1521cf(0x149)],[,_0x4674cd]=_0x59ceee[_0x1521cf(0xd7)]('\x20'),_0x3240b8=await Whatsapp_1[_0x1521cf(0x8d)]['findOne']({'where':{'token':_0x4674cd}}),_0x4c9479=_0x3240b8['companyId'];try{const _0x94073b=await Queue_1[_0x1521cf(0x8d)][_0x1521cf(0x118)]({'where':{'id':_0x526300,'companyId':_0x4c9479}});if(!_0x94073b)return _0x258c97[_0x1521cf(0xcc)](0x190)['json']({'status':_0x1521cf(0xb3),'error':_0x1521cf(0xcf)});return await(0x0,UpdateTicketService_1[_0x1521cf(0x8d)])({'ticketId':_0x2dc6f7,'ticketData':{'queueId':_0x526300},'companyId':_0x4c9479}),_0x258c97['status'](0xc8)[_0x1521cf(0x82)]({'status':'SUCCESS'});}catch(_0x29872d){return console[_0x1521cf(0x122)](_0x29872d),_0x258c97['status'](0x1f4)[_0x1521cf(0x82)]({'status':_0x1521cf(0xb3),'error':_0x1521cf(0x10b)});}};exports[a9_0x858e8b(0xe2)]=updateQueueId;const closeTicket=async(_0x2b8b09,_0x3e4fb1)=>{const _0xbf5868=a9_0x858e8b,_0x1d910a=_0x2b8b09[_0xbf5868(0xfc)]['authorization'],[,_0x2fe49a]=_0x1d910a[_0xbf5868(0xd7)]('\x20'),_0x203a7c=await Whatsapp_1[_0xbf5868(0x8d)][_0xbf5868(0x118)]({'where':{'token':_0x2fe49a}}),_0x1b75c7=_0x203a7c[_0xbf5868(0xed)],{ticketId:_0x42346b}=_0x2b8b09['params'],_0x41f508=await(0x0,ShowTicketService_1['default'])(_0x42346b,_0x1b75c7);_0x41f508['status']=_0x2b8b09['body'][_0xbf5868(0x112)][_0xbf5868(0xcc)],console['log'](_0x41f508[_0xbf5868(0xcc)]);const {ticket:_0x3e4d00}=await(0x0,UpdateTicketService_1[_0xbf5868(0x8d)])({'ticketData':_0x41f508,'ticketId':_0x42346b,'companyId':_0x1b75c7});return _0x3e4fb1[_0xbf5868(0xcc)](0xc8)[_0xbf5868(0x82)](_0x3e4d00);};exports['closeTicket']=closeTicket;const updateTicketTag=async(_0x52eece,_0x10806f)=>{const _0x4eeca7=a9_0x858e8b,{ticketId:_0x5c86ea,tagId:_0x1d0fe2}=_0x52eece[_0x4eeca7(0x135)],_0x2b9a8e=_0x52eece['headers']['authorization'],[,_0x3a61e1]=_0x2b9a8e[_0x4eeca7(0xd7)]('\x20');try{const _0x93b8e5=await Whatsapp_1[_0x4eeca7(0x8d)][_0x4eeca7(0x118)]({'where':{'token':_0x3a61e1}}),_0x4939c2=_0x93b8e5[_0x4eeca7(0xed)],_0x5777a8=await Tag_1[_0x4eeca7(0x8d)]['findOne']({'where':{'id':_0x1d0fe2,'companyId':_0x4939c2}});if(!_0x5777a8)return _0x10806f[_0x4eeca7(0xcc)](0x190)[_0x4eeca7(0x82)]({'status':_0x4eeca7(0xb3),'error':_0x4eeca7(0x12c)});const _0x595fd8=await TicketTag_1[_0x4eeca7(0x8d)]['findOne']({'where':{'ticketId':_0x5c86ea,'tagId':_0x1d0fe2}});if(_0x595fd8)return _0x10806f[_0x4eeca7(0xcc)](0x190)[_0x4eeca7(0x82)]({'status':_0x4eeca7(0xb3),'error':_0x4eeca7(0x121)});const _0x66bfd7=await TicketTag_1['default']['create']({'ticketId':_0x5c86ea,'tagId':_0x1d0fe2});return _0x10806f[_0x4eeca7(0xcc)](0xc8)[_0x4eeca7(0x82)]({'status':'SUCCESS','ticketTag':_0x66bfd7});}catch(_0x386b3b){return console[_0x4eeca7(0x122)](_0x386b3b),_0x10806f['status'](0x1f4)['json']({'status':_0x4eeca7(0xb3),'error':'Failed\x20to\x20update\x20ticket\x20tag'});}};exports['updateTicketTag']=updateTicketTag;const removeTicketTag=async(_0x8d6dc6,_0x519752)=>{const _0x4fbcab=a9_0x858e8b,{ticketId:_0x3a07c6,tagId:_0x1e027d}=_0x8d6dc6['body'];try{const _0x23238d=await TicketTag_1[_0x4fbcab(0x8d)][_0x4fbcab(0x118)]({'where':{'ticketId':_0x3a07c6,'tagId':_0x1e027d}});if(!_0x23238d)return _0x519752[_0x4fbcab(0xcc)](0x190)[_0x4fbcab(0x82)]({'status':'ERROR','error':_0x4fbcab(0xb5)});return await _0x23238d[_0x4fbcab(0xf2)](),_0x519752['status'](0xc8)[_0x4fbcab(0x82)]({'status':'SUCCESS'});}catch(_0x123532){return console[_0x4fbcab(0x122)](_0x123532),_0x519752[_0x4fbcab(0xcc)](0x1f4)[_0x4fbcab(0x82)]({'status':_0x4fbcab(0xb3),'error':_0x4fbcab(0x134)});}};exports[a9_0x858e8b(0x130)]=removeTicketTag;function a9_0xe006(){const _0x578f88=['uploadContacts','head','listTicketsByCompany','extraInfo','../models/Ticket','Contact\x20deleted','../models/Contact','(((.+)+)+)+$','facebookUserId','3349010SjVzkX','closeTicket','Erro\x20ao\x20buscar\x20invoices','extname','../helpers/SendPresenceStatus','usedPDF','ImportXLSContactsService','profilePicUrl','../services/InvoicesService/ShowInvoiceService','toISOString','charAt','Internal\x20server\x20error','443700ZQnNtC','33QJtpWT','../models/TicketTag','ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789','storeContacts','toggleDisableBotContacts','ERROR','pending','Tag\x20is\x20not\x20associated\x20with\x20the\x20ticket','createCompany','887517bbGUgL','disableBot','checkNumber','pdf','../services/WbotServices/SendWhatsAppMessageLink','search','../services/ContactServices/GetContactService','useDate','dueDate','showContacts','blockCompany','parseInt','309yjWQGv','makeid','onWhatsApp','SendPresenceStatus','indexLink','send','delete','required','showAllApi','status','../errors/AppError','mimetype','Invalid\x20queue\x20for\x20the\x20company','boolean','map','../services/WbotServices/GetProfilePicUrl','UsedOnDay','paid','usedImage','acceptAudioMessage','split','replace','../services/ContactServices/DeleteContactService','writeFileSync','query','test','req','../services/ContactServices/CreateOrUpdateContactService','length','yup','company-','updateQueueId','handleAudioLink','usedOther','nullable','updateUsageStats','update','writable','findAll','random','matches','__importDefault','companyId','exec','updateTicketTag','axios','findByPk','destroy','date','path','company','All\x20contacts\x20removed\x20successfully','Missing\x20user\x20or\x20companyId','files','object','../services/ContactServices/CreateContactService','SUCCESS','headers','updateCompany','prototype','message','Invalid\x20number\x20format.\x20Only\x20numbers\x20is\x20allowed.','Company\x20not\x20found','OnWhatsAppDto','../utils/useDate','../services/WbotServices/SendWhatsappMediaImage','image','url','@s.whatsapp.net','lodash','originalname','constructor','Internal\x20Server\x20Error','format','getWbot','updateContacts','Acesso\x20não\x20autorizado.\x20Por\x20favor,\x20forneça\x20credenciais\x20válidas.','showApi','../models/ApiUsages','ticketData','shape','facebookUserToken','../services/WbotServices/SendWhatsAppMedia','../libs/wbot','__esModule','findOne','Error\x20updating\x20usage\x20stats:','emit','126VBSYcU','../models/Whatsapp','active','-mainchannel','setDate','__importStar','Tag\x20already\x20associated\x20with\x20the\x20ticket','error','listTicketsByTag','user','../services/InvoicesService/ListInvoicesServices','../services/ContactServices/ImportXLSContactsService','updateApi','call','../models/Invoices','../services/WbotServices/SendWhatsAppMessageAPI','getIO','Tag\x20does\x20not\x20belong\x20to\x20the\x20specified\x20company','../services/ContactServices/ShowContactService','dataValues','jid','removeTicketTag','arraybuffer','../models/Company','number','Failed\x20to\x20remove\x20ticket\x20tag','body','@g.us','reload','usedVideo','indexWhatsappsId','ERRO','tags','params','video','create','48rXAAEg','178230NELcJx','./public/company','type','indexContacts','exists','Error\x20removing\x20all\x20contacts:','whatsapp','../libs/socket','indexApi','authorization','1276588XtaHyZ','indexImage','.mp3','findOrCreateContacts','whatsapp\x20#','contact','../services/TicketServices/FindOrCreateTicketService','color','string','17484zhGpXE','removeContacts','toString','from','caption','../services/WbotServices/CheckIsValidContact','Erro\x20ao\x20buscar\x20invoices:','SUCESSO','../services/ContactServices/UpdateContactService','../services/InvoicesService/UpdateInvoiceService','listTicketsByTagIsAuth','json','-contact','log','readFileSync','media','all','../services/TicketServices/ShowTicketService','queue','usedCheckNumber','1498990HVxJEI','includes','default','get','listContacts','../services/ContactServices/ListContactsService','validate','email','removeAllContacts','usedText','../models/Tag','name','../services/TicketServices/UpdateTicketService'];a9_0xe006=function(){return _0x578f88;};return a9_0xe006();}const listTicketsByCompany=async(_0x204d35,_0x147cea)=>{const _0x395618=a9_0x858e8b,_0x2b0bea=_0x204d35[_0x395618(0xfc)][_0x395618(0x149)],[,_0xfccf54]=_0x2b0bea['split']('\x20'),_0x51b3d8=await Whatsapp_1[_0x395618(0x8d)][_0x395618(0x118)]({'where':{'token':_0xfccf54}}),_0x4d6fb5=_0x51b3d8[_0x395618(0xed)];try{const _0x40c892=await Ticket_1[_0x395618(0x8d)]['findAll']({'where':{'companyId':_0x4d6fb5},'include':[{'model':Contact_1['default'],'as':_0x395618(0x14f),'attributes':['id',_0x395618(0x96),'number',_0x395618(0x92),'profilePicUrl',_0x395618(0xd6),_0x395618(0x11d),_0x395618(0xb8)],'include':[_0x395618(0x9b)]},{'model':Queue_1[_0x395618(0x8d)],'as':_0x395618(0x89),'attributes':['id',_0x395618(0x96),'color']},{'model':User_1['default'],'as':_0x395618(0x124),'attributes':['id',_0x395618(0x96)]},{'model':Tag_1['default'],'as':'tags','attributes':['id',_0x395618(0x96),'color']},{'model':Whatsapp_1[_0x395618(0x8d)],'as':'whatsapp','attributes':[_0x395618(0x96),_0x395618(0x114),_0x395618(0xa0)]},{'model':Company_1[_0x395618(0x8d)],'as':_0x395618(0xf5),'attributes':[_0x395618(0x96)]}]});return _0x147cea[_0x395618(0xcc)](0xc8)[_0x395618(0x82)]({'status':_0x395618(0xfb),'tickets':_0x40c892});}catch(_0x546ba6){return console[_0x395618(0x122)](_0x546ba6),_0x147cea[_0x395618(0xcc)](0x1f4)[_0x395618(0x82)]({'status':'ERROR','error':_0x395618(0x10b)});}};exports[a9_0x858e8b(0x9a)]=listTicketsByCompany;const listTicketsByTag=async(_0x3cb279,_0x5520e8)=>{const _0x72b64b=a9_0x858e8b,{tagId:_0x3fab0d}=_0x3cb279[_0x72b64b(0x13c)],_0x3c9b85=_0x3cb279[_0x72b64b(0xfc)]['authorization'],[,_0x2f4192]=_0x3c9b85[_0x72b64b(0xd7)]('\x20');try{const _0x4150ca=await Whatsapp_1[_0x72b64b(0x8d)]['findOne']({'where':{'token':_0x2f4192}}),_0x5b03c2=_0x4150ca[_0x72b64b(0xed)],_0x49eb02=await Tag_1[_0x72b64b(0x8d)][_0x72b64b(0x118)]({'where':{'id':_0x3fab0d,'companyId':_0x5b03c2}});if(!_0x49eb02)return _0x5520e8[_0x72b64b(0xcc)](0x190)[_0x72b64b(0x82)]({'status':_0x72b64b(0xb3),'error':'Tag\x20does\x20not\x20belong\x20to\x20the\x20specified\x20company'});const _0x5ac842=await Ticket_1[_0x72b64b(0x8d)][_0x72b64b(0xe9)]({'include':[{'model':Tag_1['default'],'as':_0x72b64b(0x13b),'attributes':['id',_0x72b64b(0x96)],'through':{'attributes':[],'where':{'tagId':_0x3fab0d}}},{'model':Contact_1[_0x72b64b(0x8d)],'as':'contact','attributes':['id',_0x72b64b(0x96),'number',_0x72b64b(0x92),_0x72b64b(0xa8),_0x72b64b(0xd6),_0x72b64b(0x11d),_0x72b64b(0xb8)],'include':[_0x72b64b(0x9b)]},{'model':Queue_1['default'],'as':'queue','attributes':['id',_0x72b64b(0x96),_0x72b64b(0x75)]},{'model':User_1['default'],'as':_0x72b64b(0x124),'attributes':['id',_0x72b64b(0x96)]},{'model':Whatsapp_1['default'],'as':_0x72b64b(0x146),'attributes':[_0x72b64b(0x96),_0x72b64b(0x114),'facebookUserId']},{'model':Company_1['default'],'as':_0x72b64b(0xf5),'attributes':['name']}],'where':{'companyId':_0x5b03c2,'$tags.id$':_0x3fab0d}});return _0x5520e8['status'](0xc8)['json']({'status':'SUCCESS','tickets':_0x5ac842});}catch(_0x13e00c){return console[_0x72b64b(0x122)](_0x13e00c),_0x5520e8['status'](0x1f4)[_0x72b64b(0x82)]({'status':_0x72b64b(0xb3),'error':_0x72b64b(0x10b)});}};exports[a9_0x858e8b(0x123)]=listTicketsByTag;const listTicketsByTagIsAuth=async(_0x4f4bcb,_0x503b01)=>{const _0x39bc7a=a9_0x858e8b,{tagId:_0x49297f}=_0x4f4bcb[_0x39bc7a(0x13c)];try{const _0xb137da=await Ticket_1[_0x39bc7a(0x8d)][_0x39bc7a(0xe9)]({'include':[{'model':Contact_1[_0x39bc7a(0x8d)],'as':_0x39bc7a(0x14f),'attributes':[_0x39bc7a(0x96),_0x39bc7a(0x133),'email'],'include':['extraInfo']},{'model':Tag_1[_0x39bc7a(0x8d)],'as':_0x39bc7a(0x13b),'attributes':['id',_0x39bc7a(0x96),_0x39bc7a(0x75)],'where':{'id':_0x49297f}},{'model':Whatsapp_1[_0x39bc7a(0x8d)],'as':'whatsapp','attributes':[_0x39bc7a(0x96),_0x39bc7a(0x114),_0x39bc7a(0xa0)]},{'model':Company_1[_0x39bc7a(0x8d)],'as':_0x39bc7a(0xf5),'attributes':['name']}]});return _0x503b01[_0x39bc7a(0xcc)](0xc8)[_0x39bc7a(0x82)]({'status':_0x39bc7a(0xfb),'tickets':_0xb137da});}catch(_0x589ebe){return console[_0x39bc7a(0x122)](_0x589ebe),_0x503b01[_0x39bc7a(0xcc)](0x1f4)[_0x39bc7a(0x82)]({'status':_0x39bc7a(0xb3),'error':_0x39bc7a(0x10b)});}};exports[a9_0x858e8b(0x81)]=listTicketsByTagIsAuth;function makeid(_0x20ef79){const _0x34d200=a9_0x858e8b;var _0x254f1e='',_0x545f7b=_0x34d200(0xb0),_0xe23f7e=_0x545f7b[_0x34d200(0xdf)];for(var _0xb98c4c=0x0;_0xb98c4c<_0x20ef79;_0xb98c4c++){_0x254f1e+=_0x545f7b[_0x34d200(0xab)](Math['floor'](Math[_0x34d200(0xea)]()*_0xe23f7e));}return _0x254f1e;}exports[a9_0x858e8b(0xc4)]=makeid;const handleAudioLink=async(_0x2ae4db,_0x439363)=>{const _0x188c40=a9_0x858e8b,{link:_0x34ec9c,contactNumber:_0x1abae8}=_0x2ae4db[_0x188c40(0x135)];try{const _0x77e22f=_0x2ae4db['headers'][_0x188c40(0x149)],[,_0x2a89de]=_0x77e22f['split']('\x20'),_0x5d2f3a=await Whatsapp_1[_0x188c40(0x8d)][_0x188c40(0x118)]({'where':{'token':_0x2a89de}}),_0x480309=_0x5d2f3a[_0x188c40(0xed)],_0x126354=await(0x0,GetDefaultWhatsApp_1[_0x188c40(0x8d)])(_0x480309),_0x2ee2be=(0x0,wbot_1['getWbot'])(_0x126354['id']),_0x34cb0f=_0x188c40(0x141)+_0x480309+'/'+makeid(0xa)+_0x188c40(0x14c);if(!_0x5d2f3a)return _0x439363[_0x188c40(0xcc)](0x191)[_0x188c40(0x82)]({'status':_0x188c40(0x13a),'error':'Token\x20de\x20autorização\x20inválido'});const _0x9e512f=await axios_1[_0x188c40(0x8d)][_0x188c40(0x8e)](_0x34ec9c,{'responseType':_0x188c40(0x131)});fs_1['default'][_0x188c40(0xda)](_0x34cb0f,Buffer[_0x188c40(0x7a)](_0x9e512f['data']));const _0x5218bb='Legenda\x20do\x20áudio';return await(0x0,SendPresenceStatus_1[_0x188c40(0xc6)])(_0x2ee2be,_0x1abae8),await _0x2ee2be['sendMessage'](_0x1abae8+_0x188c40(0x107),{'audio':fs_1['default'][_0x188c40(0x85)](_0x34cb0f),'fileName':_0x5218bb,'caption':_0x5218bb,'mimetype':'audio/mp4','ptt':!![]}),_0x439363[_0x188c40(0xcc)](0xc8)[_0x188c40(0x82)]({'status':_0x188c40(0x7e)});}catch(_0x2640f5){return console[_0x188c40(0x122)](_0x2640f5),_0x439363[_0x188c40(0xcc)](0x1f4)[_0x188c40(0x82)]({'status':_0x188c40(0x13a),'error':'Erro\x20ao\x20lidar\x20com\x20o\x20link\x20de\x20áudio'});}};exports[a9_0x858e8b(0xe3)]=handleAudioLink;const indexApi=async(_0x511bf5,_0x2cea2f)=>{const _0x1e937c=a9_0x858e8b,_0x45841e=_0x511bf5[_0x1e937c(0xfc)][_0x1e937c(0x149)],[,_0xe13634]=_0x45841e[_0x1e937c(0xd7)]('\x20'),_0x749c94=await Whatsapp_1[_0x1e937c(0x8d)][_0x1e937c(0x118)]({'where':{'token':_0xe13634}}),_0x30268f=_0x749c94['companyId'],{searchParam:_0x5740e9,pageNumber:_0x3ec2a1}=_0x511bf5[_0x1e937c(0xdb)];if(_0x30268f===0x1){const {invoices:_0x4d9011,count:_0x9f7594,hasMore:_0xbfa53e}=await(0x0,ListInvoicesServices_1[_0x1e937c(0x8d)])({'searchParam':_0x5740e9,'pageNumber':_0x3ec2a1});return _0x2cea2f[_0x1e937c(0x82)]({'invoices':_0x4d9011,'count':_0x9f7594,'hasMore':_0xbfa53e});}else return _0x2cea2f[_0x1e937c(0xcc)](0x191)['json']({'status':'ERRO','error':_0x1e937c(0x10f)});};exports[a9_0x858e8b(0x148)]=indexApi;const showApi=async(_0x5beff6,_0x291bf3)=>{const _0x5a16a2=a9_0x858e8b,_0x35bb4e=_0x5beff6[_0x5a16a2(0xfc)][_0x5a16a2(0x149)],[,_0x28ee24]=_0x35bb4e['split']('\x20'),_0x1fdd83=await Whatsapp_1[_0x5a16a2(0x8d)][_0x5a16a2(0x118)]({'where':{'token':_0x28ee24}}),_0x2c10d1=_0x1fdd83[_0x5a16a2(0xed)],{Invoiceid:_0x440fa5}=_0x5beff6['params'],_0x539ba3=await(0x0,ShowInvoiceService_1[_0x5a16a2(0x8d)])(_0x440fa5);return _0x291bf3[_0x5a16a2(0xcc)](0xc8)['json'](_0x539ba3);};exports['showApi']=showApi;const showAllApi=async(_0x3d69d6,_0x327d3c)=>{const _0x12f871=a9_0x858e8b;try{const _0x34ad62=_0x3d69d6[_0x12f871(0xfc)][_0x12f871(0x149)],[,_0x2bfe66]=_0x34ad62['split']('\x20'),_0x31a7b4=await Whatsapp_1['default']['findOne']({'where':{'token':_0x2bfe66}}),_0x13bc58=_0x31a7b4[_0x12f871(0xed)],{companyId:_0x8ed8a1,status:_0x20f828}=_0x3d69d6[_0x12f871(0x135)];if(_0x13bc58===0x1){const _0x468131=await Invoices_1[_0x12f871(0x8d)][_0x12f871(0xe9)]({'where':{'companyId':_0x8ed8a1,'status':_0x20f828}});return _0x327d3c[_0x12f871(0xcc)](0xc8)[_0x12f871(0x82)](_0x468131);}else return _0x327d3c[_0x12f871(0xcc)](0x191)[_0x12f871(0x82)]({'status':_0x12f871(0x13a),'error':_0x12f871(0x10f)});}catch(_0x2ec572){return console['error'](_0x12f871(0x7d),_0x2ec572),_0x327d3c[_0x12f871(0xcc)](0x1f4)[_0x12f871(0x82)]({'error':_0x12f871(0xa3)});}};exports[a9_0x858e8b(0xcb)]=showAllApi;const updateApi=async(_0x443ae2,_0x29e491)=>{const _0x4c16ed=a9_0x858e8b,_0x373888=_0x443ae2[_0x4c16ed(0xfc)][_0x4c16ed(0x149)],[,_0x57a42f]=_0x373888[_0x4c16ed(0xd7)]('\x20'),_0x49ebb5=await Whatsapp_1[_0x4c16ed(0x8d)]['findOne']({'where':{'token':_0x57a42f}}),_0x4a82b0=_0x49ebb5[_0x4c16ed(0xed)],_0x29ca14=_0x443ae2[_0x4c16ed(0x135)],_0x54c146=Yup[_0x4c16ed(0xf9)]()[_0x4c16ed(0x113)]({'name':Yup[_0x4c16ed(0x76)]()});try{await _0x54c146[_0x4c16ed(0x91)](_0x29ca14);}catch(_0x41100d){throw new AppError_1[(_0x4c16ed(0x8d))](_0x41100d[_0x4c16ed(0xff)]);}const {id:_0x11a161,status:_0x5967db}=_0x29ca14;if(_0x4a82b0===0x1){const _0x490c4e=await(0x0,UpdateInvoiceService_1[_0x4c16ed(0x8d)])({'id':_0x11a161,'status':_0x5967db}),_0x3f1b5a=await Invoices_1[_0x4c16ed(0x8d)][_0x4c16ed(0xf1)](_0x11a161),_0x378ce3=_0x3f1b5a[_0x4c16ed(0xed)],_0x3daaaa=await Company_1[_0x4c16ed(0x8d)]['findByPk'](_0x378ce3),_0x5cc082=new Date(_0x3daaaa[_0x4c16ed(0xbf)]);_0x5cc082[_0x4c16ed(0x11f)](_0x5cc082['getDate']()+0x1e);const _0x440eeb=_0x5cc082[_0x4c16ed(0xaa)]()[_0x4c16ed(0xd7)]('T')[0x0];if(_0x3daaaa){await _0x3daaaa[_0x4c16ed(0xe7)]({'dueDate':_0x440eeb});const _0x1fa880=await _0x3f1b5a[_0x4c16ed(0xe7)]({'id':_0x11a161,'status':_0x4c16ed(0xd4)});await _0x3daaaa[_0x4c16ed(0x137)]();const _0x3ede7d=(0x0,socket_1[_0x4c16ed(0x12b)])(),_0x236100=await Company_1[_0x4c16ed(0x8d)][_0x4c16ed(0x118)]({'where':{'id':_0x378ce3}});}return _0x29e491[_0x4c16ed(0xcc)](0xc8)[_0x4c16ed(0x82)](_0x490c4e);}else return _0x29e491[_0x4c16ed(0xcc)](0x191)[_0x4c16ed(0x82)]({'status':_0x4c16ed(0x13a),'error':_0x4c16ed(0x10f)});};exports[a9_0x858e8b(0x127)]=updateApi;const updateUsageStats=async(_0x2aa127,_0x5ccdf4)=>{const _0x2266fb=a9_0x858e8b;if(!_0x2aa127[_0x2266fb(0x124)]||!_0x2aa127[_0x2266fb(0x124)][_0x2266fb(0xed)])return _0x5ccdf4[_0x2266fb(0xcc)](0x190)[_0x2266fb(0xc8)]({'status':_0x2266fb(0xb3),'message':_0x2266fb(0xf7)});const {companyId:_0x5603c2}=_0x2aa127['user'],{contactId:_0x2e71f5}=_0x2aa127[_0x2266fb(0x13c)];return setTimeout(async()=>{const _0x3a03a4=_0x2266fb,{dateToClient:_0x2fca1b}=(0x0,useDate_1[_0x3a03a4(0xbe)])(),_0x2e94b9=_0x2fca1b(new Date()[_0x3a03a4(0x79)]()),_0x27bd3a=(0x0,moment_1[_0x3a03a4(0x8d)])()[_0x3a03a4(0x10c)]();try{const _0x1a05e6=await ApiUsages_1[_0x3a03a4(0x8d)][_0x3a03a4(0x118)]({'where':{'dateUsed':_0x2e94b9,'companyId':_0x5603c2}});if(_0x1a05e6)await _0x1a05e6[_0x3a03a4(0xe7)]({'usedOther':_0x1a05e6['dataValues'][_0x3a03a4(0xe4)]+0x1,'UsedOnDay':_0x1a05e6['dataValues'][_0x3a03a4(0xd3)]+0x1,'updatedAt':_0x27bd3a});else{const _0x1e1506=await ApiUsages_1[_0x3a03a4(0x8d)][_0x3a03a4(0x13e)]({'companyId':_0x5603c2,'dateUsed':_0x2e94b9});await _0x1e1506[_0x3a03a4(0xe7)]({'usedOther':_0x1e1506['dataValues'][_0x3a03a4(0xe4)]+0x1,'UsedOnDay':_0x1e1506[_0x3a03a4(0x12e)][_0x3a03a4(0xd3)]+0x1,'updatedAt':_0x27bd3a});}}catch(_0x95adaa){return console[_0x3a03a4(0x122)](_0x3a03a4(0x119),_0x95adaa),_0x5ccdf4[_0x3a03a4(0xcc)](0x1f4)[_0x3a03a4(0xc8)]({'status':_0x3a03a4(0xb3),'message':_0x3a03a4(0xac)});}},0x64),_0x5ccdf4[_0x2266fb(0xc8)]({'status':_0x2266fb(0xfb)});};exports[a9_0x858e8b(0xe6)]=updateUsageStats;const indexContacts=async(_0x512148,_0x1e3b2e)=>{const _0x593fda=a9_0x858e8b,{searchParam:_0x1dda2f,pageNumber:_0x206a24}=_0x512148['query'],{companyId:_0x3a0c44}=_0x512148[_0x593fda(0x124)],{contacts:_0x293de4,count:_0x27f7df,hasMore:_0x3303a2}=await(0x0,ListContactsService_1[_0x593fda(0x8d)])({'searchParam':_0x1dda2f,'pageNumber':_0x206a24,'companyId':_0x3a0c44});return _0x1e3b2e[_0x593fda(0x82)]({'contacts':_0x293de4,'count':_0x27f7df,'hasMore':_0x3303a2});};exports[a9_0x858e8b(0x143)]=indexContacts;const listContacts=async(_0x25879e,_0x250387)=>{const _0x33b8b1=a9_0x858e8b,{name:_0x54c095}=_0x25879e[_0x33b8b1(0xdb)],{companyId:_0x117f5f}=_0x25879e['user'],_0x4ae221=await(0x0,SimpleListService_1[_0x33b8b1(0x8d)])({'name':_0x54c095,'companyId':_0x117f5f});return _0x250387[_0x33b8b1(0x82)](_0x4ae221);};exports[a9_0x858e8b(0x8f)]=listContacts;const showContacts=async(_0x3d0557,_0x2daacf)=>{const _0x26a168=a9_0x858e8b,{contactId:_0x5e8745}=_0x3d0557[_0x26a168(0x13c)],{companyId:_0x421091}=_0x3d0557[_0x26a168(0x124)],_0x58d172=await(0x0,ShowContactService_1[_0x26a168(0x8d)])(_0x5e8745,_0x421091);return _0x2daacf[_0x26a168(0xcc)](0xc8)[_0x26a168(0x82)](_0x58d172);};exports['showContacts']=showContacts;const findOrCreateContacts=async(_0x2b25a9,_0x10b926)=>{const _0xfac103=a9_0x858e8b,{name:_0x88be18,number:_0x32ca57}=_0x2b25a9[_0xfac103(0x135)],{companyId:_0x4d0a42}=_0x2b25a9[_0xfac103(0x124)],_0x51b6ce=await(0x0,GetContactService_1[_0xfac103(0x8d)])({'name':_0x88be18,'number':_0x32ca57,'companyId':_0x4d0a42});return _0x10b926['status'](0xc8)[_0xfac103(0x82)](_0x51b6ce);};exports[a9_0x858e8b(0x14d)]=findOrCreateContacts;const storeContacts=async(_0x295932,_0x309574)=>{const _0x1073d2=a9_0x858e8b,{companyId:_0x12fc95}=_0x295932[_0x1073d2(0x124)],_0x3931ac=_0x295932['body'];_0x3931ac[_0x1073d2(0x133)]=_0x3931ac[_0x1073d2(0x133)][_0x1073d2(0xd8)]('-','')[_0x1073d2(0xd8)]('\x20','');const _0x162084=Yup[_0x1073d2(0xf9)]()['shape']({'name':Yup[_0x1073d2(0x76)]()[_0x1073d2(0xca)](),'number':Yup['string']()[_0x1073d2(0xca)]()['matches'](/^\d+$/,'Invalid\x20number\x20format.\x20Only\x20numbers\x20is\x20allowed.')});try{await _0x162084['validate'](_0x3931ac);}catch(_0x19e4c7){throw new AppError_1[(_0x1073d2(0x8d))](_0x19e4c7['message']);}await(0x0,CheckIsValidContact_1[_0x1073d2(0x8d)])(_0x3931ac[_0x1073d2(0x133)],_0x12fc95);const _0xa09de2=await(0x0,CheckNumber_1[_0x1073d2(0x8d)])(_0x3931ac[_0x1073d2(0x133)],_0x12fc95),_0x2121e6=_0xa09de2[_0x1073d2(0x12f)][_0x1073d2(0xd8)](/\D/g,'');_0x3931ac[_0x1073d2(0x133)]=_0x2121e6;const _0xf34019=await(0x0,CreateContactService_1[_0x1073d2(0x8d)])({..._0x3931ac,'companyId':_0x12fc95}),_0x1f72cf=(0x0,socket_1[_0x1073d2(0x12b)])();return _0x1f72cf[_0x1073d2(0x11a)](_0x1073d2(0xe1)+_0x12fc95+_0x1073d2(0x83),{'action':_0x1073d2(0x13e),'contact':_0xf34019}),_0x309574['status'](0xc8)[_0x1073d2(0x82)](_0xf34019);};exports['storeContacts']=storeContacts;const removeAllContacts=async(_0xb36b29,_0x38d405)=>{const _0x1f689e=a9_0x858e8b,{companyId:_0x569a64}=_0xb36b29[_0x1f689e(0x124)];try{await Contact_1[_0x1f689e(0x8d)]['destroy']({'where':{'companyId':_0x569a64}});const _0x3fafcd=(0x0,socket_1[_0x1f689e(0x12b)])();return _0x3fafcd['emit'](_0x1f689e(0xe1)+_0x569a64+_0x1f689e(0x83),{'action':'deleteAll'}),setTimeout(async()=>{const _0x21b2bf=_0x1f689e,{dateToClient:_0x1c6574}=(0x0,useDate_1[_0x21b2bf(0xbe)])(),_0x6cb52f=_0x1c6574(new Date()['toString']()),_0x18af93=(0x0,moment_1[_0x21b2bf(0x8d)])()[_0x21b2bf(0x10c)]();try{const _0x3e667d=await ApiUsages_1['default']['findOne']({'where':{'dateUsed':_0x6cb52f,'companyId':_0x569a64}});if(_0x3e667d)await _0x3e667d[_0x21b2bf(0xe7)]({'usedOther':_0x3e667d['dataValues'][_0x21b2bf(0xe4)]+0x1,'UsedOnDay':_0x3e667d[_0x21b2bf(0x12e)]['UsedOnDay']+0x1,'updatedAt':_0x18af93});else{const _0x4b1fc8=await ApiUsages_1[_0x21b2bf(0x8d)][_0x21b2bf(0x13e)]({'companyId':_0x569a64,'dateUsed':_0x6cb52f});await _0x4b1fc8['update']({'usedOther':_0x4b1fc8[_0x21b2bf(0x12e)]['usedOther']+0x1,'UsedOnDay':_0x4b1fc8['dataValues']['UsedOnDay']+0x1,'updatedAt':_0x18af93});}}catch(_0x310f6a){return console['error'](_0x21b2bf(0x119),_0x310f6a),_0x38d405['status'](0x1f4)[_0x21b2bf(0xc8)]({'status':_0x21b2bf(0xb3),'message':_0x21b2bf(0xac)});}},0x64),_0x38d405[_0x1f689e(0xcc)](0xc8)[_0x1f689e(0xc8)]({'status':_0x1f689e(0xfb),'message':_0x1f689e(0xf6)});}catch(_0x20c9ae){return console[_0x1f689e(0x122)](_0x1f689e(0x145),_0x20c9ae),_0x38d405[_0x1f689e(0xcc)](0x1f4)[_0x1f689e(0xc8)]({'status':_0x1f689e(0xb3),'message':_0x1f689e(0xac)});}};exports[a9_0x858e8b(0x93)]=removeAllContacts;const updateContacts=async(_0xe1496f,_0x385490)=>{const _0x416a15=a9_0x858e8b,_0x29f436=_0xe1496f['body'],{companyId:_0x1f20db}=_0xe1496f['user'],_0x1b9ad9=Yup[_0x416a15(0xf9)]()[_0x416a15(0x113)]({'name':Yup[_0x416a15(0x76)](),'number':Yup[_0x416a15(0x76)]()[_0x416a15(0xeb)](/^\d+$/,_0x416a15(0x100))});try{await _0x1b9ad9[_0x416a15(0x91)](_0x29f436);}catch(_0x301653){throw new AppError_1[(_0x416a15(0x8d))](_0x301653[_0x416a15(0xff)]);}await(0x0,CheckIsValidContact_1['default'])(_0x29f436['number'],_0x1f20db);const _0x322e1f=await(0x0,CheckNumber_1[_0x416a15(0x8d)])(_0x29f436['number'],_0x1f20db),_0x2177bb=_0x322e1f[_0x416a15(0x12f)][_0x416a15(0xd8)](/\D/g,'');_0x29f436[_0x416a15(0x133)]=_0x2177bb;const {contactId:_0x1afbac}=_0xe1496f[_0x416a15(0x13c)],_0x189eae=await(0x0,UpdateContactService_1['default'])({'contactData':_0x29f436,'contactId':_0x1afbac,'companyId':_0x1f20db}),_0x2b06fb=(0x0,socket_1[_0x416a15(0x12b)])();return _0x2b06fb[_0x416a15(0x11a)](_0x416a15(0xe1)+_0x1f20db+_0x416a15(0x83),{'action':_0x416a15(0xe7),'contact':_0x189eae}),_0x385490[_0x416a15(0xcc)](0xc8)[_0x416a15(0x82)](_0x189eae);};exports[a9_0x858e8b(0x10e)]=updateContacts;const removeContacts=async(_0x3493dc,_0x3d842b)=>{const _0x1bf3ea=a9_0x858e8b,{contactId:_0x132936}=_0x3493dc[_0x1bf3ea(0x13c)],{companyId:_0x1ffcf5}=_0x3493dc[_0x1bf3ea(0x124)];await(0x0,ShowContactService_1['default'])(_0x132936,_0x1ffcf5),await(0x0,DeleteContactService_1[_0x1bf3ea(0x8d)])(_0x132936);const _0x53e94e=(0x0,socket_1[_0x1bf3ea(0x12b)])();return _0x53e94e[_0x1bf3ea(0x11a)](_0x1bf3ea(0xe1)+_0x1ffcf5+'-contact',{'action':_0x1bf3ea(0xc9),'contactId':_0x132936}),_0x3d842b[_0x1bf3ea(0xcc)](0xc8)[_0x1bf3ea(0x82)]({'message':_0x1bf3ea(0x9d)});};exports[a9_0x858e8b(0x78)]=removeContacts;const uploadContacts=async(_0x3eff34,_0x2f7077)=>{const _0xb722df=a9_0x858e8b,_0x20f49f=_0x3eff34[_0xb722df(0xf8)],_0x27e3c8=(0x0,lodash_1[_0xb722df(0x99)])(_0x20f49f),{companyId:_0x52042}=_0x3eff34[_0xb722df(0x124)],_0x45903b=await(0x0,ImportXLSContactsService_1[_0xb722df(0xa7)])(_0x52042,_0x27e3c8),_0x449061=(0x0,socket_1[_0xb722df(0x12b)])(),_0x541f16={'action':_0xb722df(0x137),'records':_0x45903b};return _0x449061['to'](_0xb722df(0xe1)+_0x52042+_0xb722df(0x11e))[_0xb722df(0x11a)]('company-'+_0x52042+_0xb722df(0x83),_0x541f16),_0x2f7077[_0xb722df(0xcc)](0xc8)['json'](_0x45903b);};exports[a9_0x858e8b(0x98)]=uploadContacts;const toggleDisableBotContacts=async(_0x272fb0,_0x5cdd50)=>{const _0x2c92b4=a9_0x858e8b,{contactId:_0x1d2772}=_0x272fb0['params'],{companyId:_0x55d4bb}=_0x272fb0[_0x2c92b4(0x124)],_0x3be540=await(0x0,ToggleDisableBotService_1[_0x2c92b4(0x8d)])(_0x1d2772,_0x55d4bb),_0x22ed8c=(0x0,socket_1[_0x2c92b4(0x12b)])();return _0x22ed8c[_0x2c92b4(0x11a)]('company-'+_0x55d4bb+_0x2c92b4(0x83),{'action':'update','contact':_0x3be540}),_0x5cdd50['status'](0xc8)[_0x2c92b4(0x82)](_0x3be540);};exports[a9_0x858e8b(0xb2)]=toggleDisableBotContacts;