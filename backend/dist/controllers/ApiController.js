const a9_0x295872=a9_0x134e;(function(_0x3a711a,_0x1bdbfb){const _0x1aa7c0=a9_0x134e,_0x128b63=_0x3a711a();while(!![]){try{const _0x5cf1c3=-parseInt(_0x1aa7c0(0x1c2))/0x1+parseInt(_0x1aa7c0(0x1a8))/0x2*(-parseInt(_0x1aa7c0(0x150))/0x3)+-parseInt(_0x1aa7c0(0x1d1))/0x4*(parseInt(_0x1aa7c0(0x132))/0x5)+-parseInt(_0x1aa7c0(0x19e))/0x6+-parseInt(_0x1aa7c0(0x1b9))/0x7+parseInt(_0x1aa7c0(0x1d5))/0x8+-parseInt(_0x1aa7c0(0x183))/0x9*(-parseInt(_0x1aa7c0(0x1e0))/0xa);if(_0x5cf1c3===_0x1bdbfb)break;else _0x128b63['push'](_0x128b63['shift']());}catch(_0x58fc22){_0x128b63['push'](_0x128b63['shift']());}}}(a9_0x1b7e,0x2feb7));const a9_0xe763f5=(function(){let _0x3d6bdf=!![];return function(_0xf4b5e2,_0x2eef8e){const _0x4e9c6f=_0x3d6bdf?function(){const _0x49a62a=a9_0x134e;if(_0x2eef8e){const _0x526935=_0x2eef8e[_0x49a62a(0x172)](_0xf4b5e2,arguments);return _0x2eef8e=null,_0x526935;}}:function(){};return _0x3d6bdf=![],_0x4e9c6f;};}()),a9_0x48cf6f=a9_0xe763f5(this,function(){const _0x51c149=a9_0x134e;return a9_0x48cf6f['toString']()[_0x51c149(0x137)]('(((.+)+)+)+$')[_0x51c149(0x167)]()['constructor'](a9_0x48cf6f)[_0x51c149(0x137)](_0x51c149(0x1e3));});a9_0x48cf6f();'use strict';var __createBinding=this&&this['__createBinding']||(Object[a9_0x295872(0x121)]?function(_0x4a5e51,_0x1da562,_0x4e2962,_0x189ad1){const _0x2db7dc=a9_0x295872;if(_0x189ad1===undefined)_0x189ad1=_0x4e2962;var _0x1b0aa8=Object['getOwnPropertyDescriptor'](_0x1da562,_0x4e2962);(!_0x1b0aa8||('get'in _0x1b0aa8?!_0x1da562[_0x2db7dc(0x163)]:_0x1b0aa8[_0x2db7dc(0x139)]||_0x1b0aa8[_0x2db7dc(0x188)]))&&(_0x1b0aa8={'enumerable':!![],'get':function(){return _0x1da562[_0x4e2962];}}),Object[_0x2db7dc(0x156)](_0x4a5e51,_0x189ad1,_0x1b0aa8);}:function(_0x30ffbb,_0x287568,_0x101936,_0xb7a780){if(_0xb7a780===undefined)_0xb7a780=_0x101936;_0x30ffbb[_0xb7a780]=_0x287568[_0x101936];}),__setModuleDefault=this&&this['__setModuleDefault']||(Object[a9_0x295872(0x121)]?function(_0xa5b547,_0xb6fd6){const _0x296e40=a9_0x295872;Object[_0x296e40(0x156)](_0xa5b547,'default',{'enumerable':!![],'value':_0xb6fd6});}:function(_0x415906,_0x7ff021){_0x415906['default']=_0x7ff021;}),__importStar=this&&this[a9_0x295872(0x18e)]||function(_0x41861e){const _0x32e31e=a9_0x295872;if(_0x41861e&&_0x41861e[_0x32e31e(0x163)])return _0x41861e;var _0x566873={};if(_0x41861e!=null){for(var _0x53b6df in _0x41861e)if(_0x53b6df!==_0x32e31e(0x1dc)&&Object['prototype']['hasOwnProperty']['call'](_0x41861e,_0x53b6df))__createBinding(_0x566873,_0x41861e,_0x53b6df);}return __setModuleDefault(_0x566873,_0x41861e),_0x566873;},__importDefault=this&&this[a9_0x295872(0x12f)]||function(_0x437d43){return _0x437d43&&_0x437d43['__esModule']?_0x437d43:{'default':_0x437d43};};Object[a9_0x295872(0x156)](exports,a9_0x295872(0x163),{'value':!![]}),exports['toggleDisableBotContacts']=exports[a9_0x295872(0x138)]=exports[a9_0x295872(0x1db)]=exports[a9_0x295872(0x186)]=exports['removeAllContacts']=exports['storeContacts']=exports[a9_0x295872(0x182)]=exports[a9_0x295872(0x1b0)]=exports[a9_0x295872(0x16a)]=exports['indexContacts']=exports[a9_0x295872(0x1c6)]=exports[a9_0x295872(0x165)]=exports[a9_0x295872(0x1cc)]=exports['showApi']=exports[a9_0x295872(0x180)]=exports['handleAudioLink']=exports['makeid']=exports[a9_0x295872(0x161)]=exports[a9_0x295872(0x1de)]=exports[a9_0x295872(0x1bd)]=exports[a9_0x295872(0x1d6)]=exports[a9_0x295872(0x158)]=exports[a9_0x295872(0x1c3)]=exports[a9_0x295872(0x154)]=exports[a9_0x295872(0x173)]=exports[a9_0x295872(0x144)]=exports[a9_0x295872(0x11f)]=exports[a9_0x295872(0x1e4)]=exports[a9_0x295872(0x13c)]=exports[a9_0x295872(0x133)]=exports[a9_0x295872(0x18a)]=exports[a9_0x295872(0x175)]=exports[a9_0x295872(0x1b5)]=void 0x0;const axios_1=__importDefault(require(a9_0x295872(0x170))),fs_1=__importDefault(require('fs')),Yup=__importStar(require(a9_0x295872(0x148))),lodash_1=require('lodash'),GetDefaultWhatsApp_1=__importDefault(require(a9_0x295872(0x19a))),SetTicketMessagesAsRead_1=__importDefault(require(a9_0x295872(0x115))),socket_1=require(a9_0x295872(0x1c0)),Whatsapp_1=__importDefault(require(a9_0x295872(0x15d))),Queue_1=__importDefault(require('../models/Queue')),User_1=__importDefault(require('../models/User')),CreateOrUpdateContactService_1=__importDefault(require(a9_0x295872(0x1da))),FindOrCreateTicketService_1=__importDefault(require(a9_0x295872(0x147))),ShowTicketService_1=__importDefault(require(a9_0x295872(0x13b))),GetProfilePicUrl_1=__importDefault(require(a9_0x295872(0x17c))),SendWhatsAppMedia_1=__importDefault(require(a9_0x295872(0x15a))),UpdateTicketService_1=__importDefault(require(a9_0x295872(0x1cf))),wbot_1=require('../libs/wbot'),SendWhatsAppMessageLink_1=__importDefault(require(a9_0x295872(0x142))),SendWhatsAppMessageAPI_1=__importDefault(require(a9_0x295872(0x177))),SendWhatsappMediaImage_1=__importDefault(require(a9_0x295872(0x11a))),ListInvoicesServices_1=__importDefault(require('../services/InvoicesService/ListInvoicesServices')),ShowInvoiceService_1=__importDefault(require(a9_0x295872(0x176))),UpdateInvoiceService_1=__importDefault(require(a9_0x295872(0x18f))),Invoices_1=__importDefault(require(a9_0x295872(0x187))),ListContactsService_1=__importDefault(require(a9_0x295872(0x174))),CreateContactService_1=__importDefault(require(a9_0x295872(0x1c5))),ShowContactService_1=__importDefault(require('../services/ContactServices/ShowContactService')),UpdateContactService_1=__importDefault(require('../services/ContactServices/UpdateContactService')),DeleteContactService_1=__importDefault(require(a9_0x295872(0x128))),GetContactService_1=__importDefault(require('../services/ContactServices/GetContactService')),ToggleDisableBotService_1=__importDefault(require('../services/ContactServices/ToggleDisableBotService')),CheckNumber_1=__importDefault(require('../services/WbotServices/CheckNumber')),CheckIsValidContact_1=__importDefault(require('../services/WbotServices/CheckIsValidContact')),AppError_1=__importDefault(require('../errors/AppError')),SimpleListService_1=__importDefault(require('../services/ContactServices/SimpleListService')),ImportXLSContactsService_1=require(a9_0x295872(0x1e1)),ApiUsages_1=__importDefault(require(a9_0x295872(0x16b))),useDate_1=require(a9_0x295872(0x13e)),TicketTag_1=__importDefault(require('../models/TicketTag')),Tag_1=__importDefault(require(a9_0x295872(0x140))),moment_1=__importDefault(require(a9_0x295872(0x12c))),path_1=__importDefault(require('path')),Ticket_1=__importDefault(require('../models/Ticket')),Contact_1=__importDefault(require(a9_0x295872(0x14f))),Company_1=__importDefault(require(a9_0x295872(0x1bc))),SendPresenceStatus_1=require(a9_0x295872(0x190));class OnWhatsAppDto{constructor(_0x5b945d,_0x5a5c1f){const _0x770c03=a9_0x295872;this[_0x770c03(0x1aa)]=_0x5b945d,this[_0x770c03(0x134)]=_0x5a5c1f;}}exports[a9_0x295872(0x1b5)]=OnWhatsAppDto;const CompanySchema=Yup[a9_0x295872(0x16d)]()[a9_0x295872(0x17b)]({'name':Yup[a9_0x295872(0x155)]()[a9_0x295872(0x185)](),'id':Yup['number'](),'phone':Yup[a9_0x295872(0x155)]()[a9_0x295872(0x1a4)](),'email':Yup['string']()[a9_0x295872(0x11e)]()[a9_0x295872(0x1a4)](),'status':Yup[a9_0x295872(0x15e)]()[a9_0x295872(0x1a4)](),'planId':Yup[a9_0x295872(0x131)]()[a9_0x295872(0x1a4)](),'campaignsEnabled':Yup[a9_0x295872(0x15e)]()[a9_0x295872(0x1a4)](),'dueDate':Yup[a9_0x295872(0x130)]()[a9_0x295872(0x1a4)](),'recurrence':Yup[a9_0x295872(0x155)]()[a9_0x295872(0x1a4)]()}),createCompany=async(_0x1557ea,_0x22d544)=>{const _0x5bdccb=a9_0x295872;try{await CompanySchema[_0x5bdccb(0x15c)](_0x1557ea['body']);const _0x20ff8c=await Company_1[_0x5bdccb(0x1dc)][_0x5bdccb(0x121)](_0x1557ea[_0x5bdccb(0x124)]);_0x22d544[_0x5bdccb(0x152)](0xc9)[_0x5bdccb(0x114)](_0x20ff8c);}catch(_0x1001fd){_0x22d544[_0x5bdccb(0x152)](0x190)[_0x5bdccb(0x114)]({'error':_0x1001fd['message']});}};exports[a9_0x295872(0x175)]=createCompany;const updateCompany=async(_0x295803,_0x1d3d15)=>{const _0x52e8cd=a9_0x295872;try{await CompanySchema[_0x52e8cd(0x15c)](_0x295803[_0x52e8cd(0x124)]);const {id:_0x17fcc7}=_0x295803[_0x52e8cd(0x1ab)],[_0x1ecca7]=await Company_1['default'][_0x52e8cd(0x189)](_0x295803[_0x52e8cd(0x124)],{'where':{'id':_0x17fcc7}});if(_0x1ecca7){const _0x3da01b=await Company_1[_0x52e8cd(0x1dc)][_0x52e8cd(0x120)](_0x17fcc7);_0x1d3d15[_0x52e8cd(0x152)](0xc8)[_0x52e8cd(0x114)](_0x3da01b);}else _0x1d3d15[_0x52e8cd(0x152)](0x194)[_0x52e8cd(0x114)]({'error':_0x52e8cd(0x1bb)});}catch(_0xe5f056){_0x1d3d15['status'](0x190)['json']({'error':_0xe5f056['message']});}};exports['updateCompany']=updateCompany;const blockCompany=async(_0x65b86,_0x34b63a)=>{const _0x3b8bff=a9_0x295872;try{const {id:_0x5b0d82}=_0x65b86[_0x3b8bff(0x1ab)],[_0x521c00]=await Company_1[_0x3b8bff(0x1dc)][_0x3b8bff(0x189)]({'status':![]},{'where':{'id':_0x5b0d82}});if(_0x521c00){const _0x598040=await Company_1[_0x3b8bff(0x1dc)][_0x3b8bff(0x120)](_0x5b0d82);_0x34b63a[_0x3b8bff(0x152)](0xc8)[_0x3b8bff(0x114)](_0x598040);}else _0x34b63a[_0x3b8bff(0x152)](0x194)[_0x3b8bff(0x114)]({'error':_0x3b8bff(0x1bb)});}catch(_0x4ddef7){_0x34b63a['status'](0x190)[_0x3b8bff(0x114)]({'error':_0x4ddef7[_0x3b8bff(0x196)]});}};exports[a9_0x295872(0x133)]=blockCompany;const createContact=async(_0x3ab0e3,_0x6f59c4,_0x40040f)=>{const _0x347b13=a9_0x295872;await(0x0,CheckIsValidContact_1['default'])(_0x40040f,_0x6f59c4);const _0xaeb9ae=await(0x0,CheckNumber_1[_0x347b13(0x1dc)])(_0x40040f,_0x6f59c4),_0x3691d8=await(0x0,GetProfilePicUrl_1[_0x347b13(0x1dc)])(_0xaeb9ae,_0x6f59c4),_0xa80314=_0xaeb9ae,_0x2e6921={'name':''+_0xa80314,'number':_0xa80314,'profilePicUrl':_0x3691d8,'isGroup':![],'companyId':_0x6f59c4},_0x477698=await(0x0,CreateOrUpdateContactService_1['default'])(_0x2e6921,null,null);let _0x9d5ecf;if(_0x3ab0e3===undefined)_0x9d5ecf=await(0x0,GetDefaultWhatsApp_1[_0x347b13(0x1dc)])(_0x6f59c4);else{_0x9d5ecf=await Whatsapp_1[_0x347b13(0x1dc)][_0x347b13(0x120)](_0x3ab0e3);if(_0x9d5ecf===null)throw new AppError_1[(_0x347b13(0x1dc))](_0x347b13(0x19c)+_0x3ab0e3+_0x347b13(0x16f));}const _0x74add4=await(0x0,FindOrCreateTicketService_1[_0x347b13(0x1dc)])(_0x477698,_0x9d5ecf['id'],0x0,_0x6f59c4),_0x4d7bd4=await(0x0,ShowTicketService_1[_0x347b13(0x1dc)])(_0x74add4['id'],_0x6f59c4);return(0x0,SetTicketMessagesAsRead_1[_0x347b13(0x1dc)])(_0x4d7bd4),_0x4d7bd4;};function formatBRNumber(_0x232228){const _0x47131a=a9_0x295872,_0x4381a5=new RegExp(/^(\d{2})(\d{2})\d{1}(\d{8})$/);if(_0x4381a5[_0x47131a(0x1ce)](_0x232228)){const _0x32d379=_0x4381a5['exec'](_0x232228);if(_0x32d379&&_0x32d379[0x1]==='55'&&Number[_0x47131a(0x1c4)](Number[_0x47131a(0x1a3)](_0x32d379[0x2]))){const _0x202cfe=Number[_0x47131a(0x1a3)](_0x32d379[0x2]);if(_0x202cfe<0x1f)return _0x32d379[0x0];else{if(_0x202cfe>=0x1f)return _0x32d379[0x1]+_0x32d379[0x2]+_0x32d379[0x3];}}}else return _0x232228;}function createJid(_0x4965a8){const _0x5eec1f=a9_0x295872;if(_0x4965a8[_0x5eec1f(0x1a2)](_0x5eec1f(0x13f))||_0x4965a8[_0x5eec1f(0x1a2)]('@s.whatsapp.net'))return formatBRNumber(_0x4965a8);return _0x4965a8[_0x5eec1f(0x1a2)]('-')?_0x4965a8+_0x5eec1f(0x13f):formatBRNumber(_0x4965a8)+_0x5eec1f(0x194);}const indexLink=async(_0x19f464,_0x30e163)=>{const _0x3cff83=a9_0x295872,_0xca608=_0x19f464[_0x3cff83(0x124)],{whatsappId:_0x13d922}=_0x19f464[_0x3cff83(0x124)],{msdelay:_0x127273}=_0x19f464[_0x3cff83(0x124)],_0x416f0b=_0x19f464[_0x3cff83(0x124)][_0x3cff83(0x1a7)],_0x32bd8c=_0x19f464[_0x3cff83(0x124)][_0x3cff83(0x14d)],_0x2a0f45=_0x19f464[_0x3cff83(0x179)][_0x3cff83(0x1b2)],[,_0x407750]=_0x2a0f45[_0x3cff83(0x1b8)]('\x20'),_0x5cf6a2=await Whatsapp_1[_0x3cff83(0x1dc)]['findOne']({'where':{'token':_0x407750}}),_0x55d357=_0x5cf6a2[_0x3cff83(0x168)];_0xca608['number']=_0xca608[_0x3cff83(0x131)][_0x3cff83(0x17d)]('-','')[_0x3cff83(0x17d)]('\x20','');const _0x4f0f6a=Yup[_0x3cff83(0x16d)]()[_0x3cff83(0x17b)]({'number':Yup[_0x3cff83(0x155)]()[_0x3cff83(0x185)]()[_0x3cff83(0x181)](/^\d+$/,_0x3cff83(0x17e))});try{await _0x4f0f6a[_0x3cff83(0x15c)](_0xca608);}catch(_0x5b9dc1){throw new AppError_1['default'](_0x5b9dc1[_0x3cff83(0x196)]);}const _0x401d0b=await createContact(_0x13d922,_0x55d357,_0xca608['number']);return await(0x0,SendWhatsAppMessageLink_1[_0x3cff83(0x1dc)])({'ticket':_0x401d0b,'url':_0x416f0b,'caption':_0x32bd8c,'msdelay':_0x127273}),setTimeout(async()=>{await(0x0,UpdateTicketService_1['default'])({'ticketId':_0x401d0b['id'],'ticketData':{'status':'pending','sendFarewellMessage':![],'amountUsedBotQueues':0x0},'companyId':_0x55d357});},0xc8),setTimeout(async()=>{const _0x182af7=_0x3cff83,{dateToClient:_0x1d587e}=(0x0,useDate_1['useDate'])(),_0x2cec78=_0x1d587e(new Date()['toString']()),_0x353a32=(0x0,moment_1[_0x182af7(0x1dc)])()[_0x182af7(0x126)](),_0xe72bd1=await ApiUsages_1['default'][_0x182af7(0x1ba)]({'where':{'dateUsed':_0x2cec78,'companyId':_0x55d357}});if(_0xe72bd1)await _0xe72bd1['update']({'usedPDF':_0xe72bd1[_0x182af7(0x117)][_0x182af7(0x166)]+0x1,'UsedOnDay':_0xe72bd1[_0x182af7(0x117)][_0x182af7(0x1b1)]+0x1,'updatedAt':_0x353a32});else{const _0x129341=await ApiUsages_1[_0x182af7(0x1dc)][_0x182af7(0x121)]({'companyId':_0x55d357,'dateUsed':_0x2cec78});await _0x129341[_0x182af7(0x189)]({'usedPDF':_0x129341['dataValues'][_0x182af7(0x166)]+0x1,'UsedOnDay':_0x129341[_0x182af7(0x117)][_0x182af7(0x1b1)]+0x1,'updatedAt':_0x353a32});}},0x64),_0x30e163['send']({'status':_0x3cff83(0x1b6)});};exports[a9_0x295872(0x13c)]=indexLink;const index=async(_0x6e4f85,_0x7b1a7a)=>{const _0x185ba0=a9_0x295872,_0x47d6d2=_0x6e4f85[_0x185ba0(0x124)],{whatsappId:_0x4cb867}=_0x6e4f85[_0x185ba0(0x124)],{msdelay:_0x58467c}=_0x6e4f85[_0x185ba0(0x124)],{body:_0xc84ae5,quotedMsg:_0xd83dd3}=_0x6e4f85['body'],_0x386fbc=_0x6e4f85['files'],_0x538d90=_0x6e4f85[_0x185ba0(0x179)]['authorization'],[,_0xa9f7d]=_0x538d90[_0x185ba0(0x1b8)]('\x20'),_0x433708=await Whatsapp_1[_0x185ba0(0x1dc)]['findOne']({'where':{'token':_0xa9f7d}}),_0x528128=_0x433708[_0x185ba0(0x168)];_0x47d6d2[_0x185ba0(0x131)]=_0x47d6d2[_0x185ba0(0x131)][_0x185ba0(0x17d)]('-','')[_0x185ba0(0x17d)]('\x20','');const _0xa5e4cd=Yup[_0x185ba0(0x16d)]()[_0x185ba0(0x17b)]({'number':Yup[_0x185ba0(0x155)]()[_0x185ba0(0x185)]()[_0x185ba0(0x181)](/^\d+$/,_0x185ba0(0x17e))});try{await _0xa5e4cd[_0x185ba0(0x15c)](_0x47d6d2);}catch(_0x485c6a){throw new AppError_1['default'](_0x485c6a['message']);}const _0x4dc60d=await createContact(_0x4cb867,_0x528128,_0x47d6d2[_0x185ba0(0x131)]);return _0x386fbc?await Promise['all'](_0x386fbc[_0x185ba0(0x1a1)](async _0x4af420=>{const _0x3b06bd=_0x185ba0;await(0x0,SendWhatsAppMedia_1[_0x3b06bd(0x1dc)])({'body':_0xc84ae5,'media':_0x4af420,'ticket':_0x4dc60d});})):await(0x0,SendWhatsAppMessageAPI_1[_0x185ba0(0x1dc)])({'body':_0xc84ae5,'ticket':_0x4dc60d,'quotedMsg':_0xd83dd3,'msdelay':_0x58467c}),setTimeout(async()=>{const _0x4f1e72=_0x185ba0;await(0x0,UpdateTicketService_1[_0x4f1e72(0x1dc)])({'ticketId':_0x4dc60d['id'],'ticketData':{'status':_0x4f1e72(0x178),'sendFarewellMessage':![],'amountUsedBotQueues':0x0},'companyId':_0x528128});},0x64),setTimeout(async()=>{const _0x1a7b51=_0x185ba0,{dateToClient:_0x4eedf8}=(0x0,useDate_1[_0x1a7b51(0x1b7)])(),_0x31830e=_0x4eedf8(new Date()[_0x1a7b51(0x167)]()),_0x23d37e=(0x0,moment_1[_0x1a7b51(0x1dc)])()[_0x1a7b51(0x126)](),_0x1b0022=await ApiUsages_1['default']['findOne']({'where':{'dateUsed':_0x31830e,'companyId':_0x528128}});_0x1b0022?_0x386fbc?await Promise['all'](_0x386fbc[_0x1a7b51(0x1a1)](async _0x5a9376=>{const _0x440281=_0x1a7b51;console[_0x440281(0x141)](_0x440281(0x14a),_0x5a9376);const _0x512d83=path_1['default']['extname'](_0x5a9376[_0x440281(0x1e5)]);console[_0x440281(0x141)](_0x440281(0x1d3),_0x512d83);if(_0x5a9376[_0x440281(0x199)][_0x440281(0x1a2)](_0x440281(0x18c)))await _0x1b0022[_0x440281(0x189)]({'usedPDF':_0x1b0022[_0x440281(0x117)]['usedPDF']+0x1,'UsedOnDay':_0x1b0022['dataValues'][_0x440281(0x1b1)]+0x1,'updatedAt':_0x23d37e});else{if(_0x5a9376[_0x440281(0x199)][_0x440281(0x1a2)](_0x440281(0x113)))await _0x1b0022[_0x440281(0x189)]({'usedImage':_0x1b0022['dataValues'][_0x440281(0x123)]+0x1,'UsedOnDay':_0x1b0022[_0x440281(0x117)][_0x440281(0x1b1)]+0x1,'updatedAt':_0x23d37e});else _0x5a9376[_0x440281(0x199)][_0x440281(0x1a2)](_0x440281(0x151))?await _0x1b0022['update']({'usedVideo':_0x1b0022[_0x440281(0x117)][_0x440281(0x14b)]+0x1,'UsedOnDay':_0x1b0022['dataValues']['UsedOnDay']+0x1,'updatedAt':_0x23d37e}):await _0x1b0022[_0x440281(0x189)]({'usedOther':_0x1b0022['dataValues'][_0x440281(0x146)]+0x1,'UsedOnDay':_0x1b0022[_0x440281(0x117)][_0x440281(0x1b1)]+0x1,'updatedAt':_0x23d37e});}})):await _0x1b0022[_0x1a7b51(0x189)]({'usedText':_0x1b0022[_0x1a7b51(0x117)][_0x1a7b51(0x193)]+0x1,'UsedOnDay':_0x1b0022[_0x1a7b51(0x117)]['UsedOnDay']+0x1,'updatedAt':_0x23d37e}):(await ApiUsages_1[_0x1a7b51(0x1dc)]['create']({'companyId':_0x528128,'dateUsed':_0x31830e}),_0x386fbc?await Promise[_0x1a7b51(0x1be)](_0x386fbc[_0x1a7b51(0x1a1)](async _0x503296=>{const _0x426f91=_0x1a7b51;console[_0x426f91(0x141)]('media',_0x503296);const _0x679106=path_1[_0x426f91(0x1dc)][_0x426f91(0x18b)](_0x503296[_0x426f91(0x1e5)]);console[_0x426f91(0x141)](_0x426f91(0x1d3),_0x679106);if(_0x503296['mimetype']['includes'](_0x426f91(0x18c)))await _0x1b0022[_0x426f91(0x189)]({'usedPDF':_0x1b0022[_0x426f91(0x117)]['usedPDF']+0x1,'UsedOnDay':_0x1b0022[_0x426f91(0x117)]['UsedOnDay']+0x1,'updatedAt':_0x23d37e});else{if(_0x503296[_0x426f91(0x199)][_0x426f91(0x1a2)](_0x426f91(0x113)))await _0x1b0022[_0x426f91(0x189)]({'usedImage':_0x1b0022[_0x426f91(0x117)]['usedImage']+0x1,'UsedOnDay':_0x1b0022[_0x426f91(0x117)][_0x426f91(0x1b1)]+0x1,'updatedAt':_0x23d37e});else _0x503296[_0x426f91(0x199)][_0x426f91(0x1a2)](_0x426f91(0x151))?await _0x1b0022['update']({'usedVideo':_0x1b0022['dataValues'][_0x426f91(0x14b)]+0x1,'UsedOnDay':_0x1b0022[_0x426f91(0x117)]['UsedOnDay']+0x1,'updatedAt':_0x23d37e}):await _0x1b0022[_0x426f91(0x189)]({'usedOther':_0x1b0022['dataValues'][_0x426f91(0x146)]+0x1,'UsedOnDay':_0x1b0022[_0x426f91(0x117)]['UsedOnDay']+0x1,'updatedAt':_0x23d37e});}})):await _0x1b0022[_0x1a7b51(0x189)]({'usedText':_0x1b0022[_0x1a7b51(0x117)]['usedText']+0x1,'UsedOnDay':_0x1b0022['dataValues']['UsedOnDay']+0x1,'updatedAt':_0x23d37e}));},0x64),_0x7b1a7a[_0x185ba0(0x1d2)]({'status':'SUCCESS'});};exports['index']=index;const indexImage=async(_0x6445f5,_0x231d7e)=>{const _0x21c280=a9_0x295872,_0x57af43=_0x6445f5[_0x21c280(0x124)],{whatsappId:_0x4df6e1}=_0x6445f5[_0x21c280(0x124)],{msdelay:_0x38e3f3}=_0x6445f5[_0x21c280(0x124)],_0x47d639=_0x6445f5['body']['url'],_0x3674ae=_0x6445f5[_0x21c280(0x124)]['caption'],_0x2f8b80=_0x6445f5['headers'][_0x21c280(0x1b2)],[,_0x1cea96]=_0x2f8b80[_0x21c280(0x1b8)]('\x20'),_0x579da7=await Whatsapp_1[_0x21c280(0x1dc)][_0x21c280(0x1ba)]({'where':{'token':_0x1cea96}}),_0x4547ec=_0x579da7[_0x21c280(0x168)];_0x57af43[_0x21c280(0x131)]=_0x57af43['number'][_0x21c280(0x17d)]('-','')[_0x21c280(0x17d)]('\x20','');const _0x5827bf=Yup[_0x21c280(0x16d)]()[_0x21c280(0x17b)]({'number':Yup[_0x21c280(0x155)]()[_0x21c280(0x185)]()[_0x21c280(0x181)](/^\d+$/,_0x21c280(0x17e))});try{await _0x5827bf[_0x21c280(0x15c)](_0x57af43);}catch(_0x206a86){throw new AppError_1[(_0x21c280(0x1dc))](_0x206a86[_0x21c280(0x196)]);}const _0x3c3d88=await createContact(_0x4df6e1,_0x4547ec,_0x57af43[_0x21c280(0x131)]);return _0x47d639&&await(0x0,SendWhatsappMediaImage_1[_0x21c280(0x1dc)])({'ticket':_0x3c3d88,'url':_0x47d639,'caption':_0x3674ae,'msdelay':_0x38e3f3}),setTimeout(async()=>{const _0x169524=_0x21c280;await(0x0,UpdateTicketService_1[_0x169524(0x1dc)])({'ticketId':_0x3c3d88['id'],'ticketData':{'status':_0x169524(0x178),'sendFarewellMessage':![],'amountUsedBotQueues':0x0},'companyId':_0x4547ec});},0x64),setTimeout(async()=>{const _0x11f775=_0x21c280,{dateToClient:_0x32a49a}=(0x0,useDate_1[_0x11f775(0x1b7)])(),_0x593867=_0x32a49a(new Date()[_0x11f775(0x167)]()),_0x1eb757=(0x0,moment_1[_0x11f775(0x1dc)])()[_0x11f775(0x126)](),_0x202e5e=await ApiUsages_1[_0x11f775(0x1dc)]['findOne']({'where':{'dateUsed':_0x593867,'companyId':_0x4547ec}});if(_0x202e5e)await _0x202e5e[_0x11f775(0x189)]({'usedImage':_0x202e5e[_0x11f775(0x117)][_0x11f775(0x123)]+0x1,'UsedOnDay':_0x202e5e[_0x11f775(0x117)]['UsedOnDay']+0x1,'updatedAt':_0x1eb757});else{const _0x53864c=await ApiUsages_1[_0x11f775(0x1dc)][_0x11f775(0x121)]({'companyId':_0x4547ec,'dateUsed':_0x593867});await _0x53864c[_0x11f775(0x189)]({'usedImage':_0x53864c['dataValues'][_0x11f775(0x123)]+0x1,'UsedOnDay':_0x53864c[_0x11f775(0x117)][_0x11f775(0x1b1)]+0x1,'updatedAt':_0x1eb757});}},0x64),_0x231d7e['send']({'status':_0x21c280(0x1b6)});};exports['indexImage']=indexImage;const checkNumber=async(_0x3d11c7,_0x12ba3d)=>{const _0x44b94d=a9_0x295872,_0x1571ab=_0x3d11c7['body'],_0x198e8d=_0x3d11c7[_0x44b94d(0x179)][_0x44b94d(0x1b2)],[,_0x3e28f8]=_0x198e8d[_0x44b94d(0x1b8)]('\x20'),_0x39b560=await Whatsapp_1[_0x44b94d(0x1dc)]['findOne']({'where':{'token':_0x3e28f8}}),_0x267a68=_0x39b560['companyId'],_0x540ebf=_0x1571ab[_0x44b94d(0x131)][_0x44b94d(0x17d)]('-','')[_0x44b94d(0x17d)]('\x20',''),_0x20da39=await(0x0,GetDefaultWhatsApp_1[_0x44b94d(0x1dc)])(_0x267a68),_0x38aacf=(0x0,wbot_1[_0x44b94d(0x1b4)])(_0x20da39['id']),_0x241a6a=createJid(_0x540ebf);try{const [_0x1a59f1]=await _0x38aacf['onWhatsApp'](_0x241a6a);if(_0x1a59f1[_0x44b94d(0x134)])return setTimeout(async()=>{const _0xfd79bf=_0x44b94d,{dateToClient:_0xfda663}=(0x0,useDate_1[_0xfd79bf(0x1b7)])(),_0x2112bc=_0xfda663(new Date()[_0xfd79bf(0x167)]()),_0x30a8df=(0x0,moment_1[_0xfd79bf(0x1dc)])()[_0xfd79bf(0x126)](),_0x43fc5e=await ApiUsages_1['default']['findOne']({'where':{'dateUsed':_0x2112bc,'companyId':_0x267a68}});if(_0x43fc5e)await _0x43fc5e[_0xfd79bf(0x189)]({'usedCheckNumber':_0x43fc5e[_0xfd79bf(0x117)][_0xfd79bf(0x1b3)]+0x1,'UsedOnDay':_0x43fc5e[_0xfd79bf(0x117)][_0xfd79bf(0x1b1)]+0x1,'updatedAt':_0x30a8df});else{const _0x34428a=await ApiUsages_1[_0xfd79bf(0x1dc)]['create']({'companyId':_0x267a68,'dateUsed':_0x2112bc});await _0x34428a[_0xfd79bf(0x189)]({'usedCheckNumber':_0x34428a['dataValues'][_0xfd79bf(0x1b3)]+0x1,'UsedOnDay':_0x34428a[_0xfd79bf(0x117)][_0xfd79bf(0x1b1)]+0x1,'updatedAt':_0x30a8df});}},0x64),_0x12ba3d[_0x44b94d(0x152)](0xc8)[_0x44b94d(0x114)]({'existsInWhatsapp':!![],'number':_0x540ebf,'numberFormatted':_0x1a59f1[_0x44b94d(0x1aa)]});}catch(_0x1a20e0){return _0x12ba3d[_0x44b94d(0x152)](0x190)[_0x44b94d(0x114)]({'existsInWhatsapp':![],'number':_0x241a6a,'error':_0x44b94d(0x15b)});}};exports['checkNumber']=checkNumber;const indexWhatsappsId=async(_0x588afd,_0x18870d)=>{const _0x21a5de=a9_0x295872;return console[_0x21a5de(0x141)](_0x21a5de(0x157),_0x588afd),console[_0x21a5de(0x141)](_0x21a5de(0x157),_0x588afd['user']),_0x18870d['status'](0xc8)[_0x21a5de(0x114)]('oi');};exports[a9_0x295872(0x173)]=indexWhatsappsId;const updateQueueId=async(_0x3230f2,_0xfc5432)=>{const _0x39cce0=a9_0x295872,{ticketId:_0xc4449c}=_0x3230f2['params'],{queueId:_0x202861}=_0x3230f2['body'],_0x1f8c9f=_0x3230f2['headers'][_0x39cce0(0x1b2)],[,_0x49fae3]=_0x1f8c9f[_0x39cce0(0x1b8)]('\x20'),_0xeeec22=await Whatsapp_1[_0x39cce0(0x1dc)][_0x39cce0(0x1ba)]({'where':{'token':_0x49fae3}}),_0x4f6234=_0xeeec22[_0x39cce0(0x168)];try{const _0x3f5c5f=await Queue_1[_0x39cce0(0x1dc)][_0x39cce0(0x1ba)]({'where':{'id':_0x202861,'companyId':_0x4f6234}});if(!_0x3f5c5f)return _0xfc5432['status'](0x190)[_0x39cce0(0x114)]({'status':_0x39cce0(0x1c1),'error':_0x39cce0(0x125)});return await(0x0,UpdateTicketService_1[_0x39cce0(0x1dc)])({'ticketId':_0xc4449c,'ticketData':{'queueId':_0x202861},'companyId':_0x4f6234}),_0xfc5432['status'](0xc8)[_0x39cce0(0x114)]({'status':_0x39cce0(0x1b6)});}catch(_0x344e44){return console[_0x39cce0(0x1cb)](_0x344e44),_0xfc5432[_0x39cce0(0x152)](0x1f4)[_0x39cce0(0x114)]({'status':_0x39cce0(0x1c1),'error':_0x39cce0(0x19b)});}};exports[a9_0x295872(0x154)]=updateQueueId;const closeTicket=async(_0x4cad61,_0x8c3677)=>{const _0x426e18=a9_0x295872,_0x6621fc=_0x4cad61['headers'][_0x426e18(0x1b2)],[,_0x14340b]=_0x6621fc[_0x426e18(0x1b8)]('\x20'),_0x4ed237=await Whatsapp_1[_0x426e18(0x1dc)][_0x426e18(0x1ba)]({'where':{'token':_0x14340b}}),_0x5ab02b=_0x4ed237[_0x426e18(0x168)],{ticketId:_0x2b8c5c}=_0x4cad61[_0x426e18(0x1ab)],_0x30c7ab=await(0x0,ShowTicketService_1['default'])(_0x2b8c5c,_0x5ab02b);_0x30c7ab[_0x426e18(0x152)]=_0x4cad61[_0x426e18(0x124)][_0x426e18(0x192)]['status'],console[_0x426e18(0x141)](_0x30c7ab[_0x426e18(0x152)]);const {ticket:_0x39208d}=await(0x0,UpdateTicketService_1[_0x426e18(0x1dc)])({'ticketData':_0x30c7ab,'ticketId':_0x2b8c5c,'companyId':_0x5ab02b});return _0x8c3677[_0x426e18(0x152)](0xc8)[_0x426e18(0x114)](_0x39208d);};exports['closeTicket']=closeTicket;const updateTicketTag=async(_0x577ff6,_0x53e667)=>{const _0x18f317=a9_0x295872,{ticketId:_0x30cb5b,tagId:_0x29ad4f}=_0x577ff6[_0x18f317(0x124)],_0x53203c=_0x577ff6[_0x18f317(0x179)][_0x18f317(0x1b2)],[,_0x4211a9]=_0x53203c[_0x18f317(0x1b8)]('\x20');try{const _0x1d4412=await Whatsapp_1[_0x18f317(0x1dc)]['findOne']({'where':{'token':_0x4211a9}}),_0xf99f=_0x1d4412['companyId'],_0x4cc04f=await Tag_1['default']['findOne']({'where':{'id':_0x29ad4f,'companyId':_0xf99f}});if(!_0x4cc04f)return _0x53e667['status'](0x190)['json']({'status':_0x18f317(0x1c1),'error':_0x18f317(0x13d)});const _0x37c814=await TicketTag_1['default'][_0x18f317(0x1ba)]({'where':{'ticketId':_0x30cb5b,'tagId':_0x29ad4f}});if(_0x37c814)return _0x53e667['status'](0x190)[_0x18f317(0x114)]({'status':_0x18f317(0x1c1),'error':_0x18f317(0x164)});const _0x63afd=await TicketTag_1[_0x18f317(0x1dc)][_0x18f317(0x121)]({'ticketId':_0x30cb5b,'tagId':_0x29ad4f});return _0x53e667[_0x18f317(0x152)](0xc8)[_0x18f317(0x114)]({'status':_0x18f317(0x1b6),'ticketTag':_0x63afd});}catch(_0x338885){return console['error'](_0x338885),_0x53e667[_0x18f317(0x152)](0x1f4)[_0x18f317(0x114)]({'status':'ERROR','error':_0x18f317(0x198)});}};exports[a9_0x295872(0x158)]=updateTicketTag;const removeTicketTag=async(_0x3e5b33,_0x18db2a)=>{const _0x18a871=a9_0x295872,{ticketId:_0x57520c,tagId:_0x66754e}=_0x3e5b33[_0x18a871(0x124)];try{const _0xcf9998=await TicketTag_1[_0x18a871(0x1dc)][_0x18a871(0x1ba)]({'where':{'ticketId':_0x57520c,'tagId':_0x66754e}});if(!_0xcf9998)return _0x18db2a[_0x18a871(0x152)](0x190)[_0x18a871(0x114)]({'status':'ERROR','error':'Tag\x20is\x20not\x20associated\x20with\x20the\x20ticket'});return await _0xcf9998[_0x18a871(0x143)](),_0x18db2a[_0x18a871(0x152)](0xc8)[_0x18a871(0x114)]({'status':_0x18a871(0x1b6)});}catch(_0x453c08){return console['error'](_0x453c08),_0x18db2a[_0x18a871(0x152)](0x1f4)[_0x18a871(0x114)]({'status':_0x18a871(0x1c1),'error':'Failed\x20to\x20remove\x20ticket\x20tag'});}};exports[a9_0x295872(0x1d6)]=removeTicketTag;const listTicketsByCompany=async(_0x2840e8,_0x309a15)=>{const _0x35aa43=a9_0x295872,_0x2d5a7b=_0x2840e8[_0x35aa43(0x179)][_0x35aa43(0x1b2)],[,_0x15a124]=_0x2d5a7b[_0x35aa43(0x1b8)]('\x20'),_0x228f7d=await Whatsapp_1[_0x35aa43(0x1dc)]['findOne']({'where':{'token':_0x15a124}}),_0x30eb64=_0x228f7d[_0x35aa43(0x168)];try{const _0x2e250c=await Ticket_1['default'][_0x35aa43(0x1e2)]({'where':{'companyId':_0x30eb64},'include':[{'model':Contact_1[_0x35aa43(0x1dc)],'as':_0x35aa43(0x13a),'attributes':['id',_0x35aa43(0x12d),_0x35aa43(0x131),'email',_0x35aa43(0x16e),_0x35aa43(0x1c8),'active',_0x35aa43(0x149)],'include':[_0x35aa43(0x17a)]},{'model':Queue_1[_0x35aa43(0x1dc)],'as':_0x35aa43(0x122),'attributes':['id',_0x35aa43(0x12d),_0x35aa43(0x1e7)]},{'model':User_1['default'],'as':_0x35aa43(0x1ae),'attributes':['id',_0x35aa43(0x12d)]},{'model':Tag_1[_0x35aa43(0x1dc)],'as':_0x35aa43(0x119),'attributes':['id',_0x35aa43(0x12d),_0x35aa43(0x1e7)]},{'model':Whatsapp_1[_0x35aa43(0x1dc)],'as':_0x35aa43(0x1dd),'attributes':['name','facebookUserToken',_0x35aa43(0x160)]},{'model':Company_1[_0x35aa43(0x1dc)],'as':_0x35aa43(0x1e6),'attributes':[_0x35aa43(0x12d)]}]});return _0x309a15[_0x35aa43(0x152)](0xc8)['json']({'status':_0x35aa43(0x1b6),'tickets':_0x2e250c});}catch(_0x3bbe73){return console[_0x35aa43(0x1cb)](_0x3bbe73),_0x309a15[_0x35aa43(0x152)](0x1f4)['json']({'status':'ERROR','error':_0x35aa43(0x19b)});}};exports['listTicketsByCompany']=listTicketsByCompany;const listTicketsByTag=async(_0x59c5d9,_0x2053f1)=>{const _0xa4f6bd=a9_0x295872,{tagId:_0x5e3a61}=_0x59c5d9[_0xa4f6bd(0x1ab)],_0x2f7b9b=_0x59c5d9[_0xa4f6bd(0x179)]['authorization'],[,_0x59a3e0]=_0x2f7b9b[_0xa4f6bd(0x1b8)]('\x20');try{const _0xc45ef6=await Whatsapp_1['default'][_0xa4f6bd(0x1ba)]({'where':{'token':_0x59a3e0}}),_0x37e86f=_0xc45ef6[_0xa4f6bd(0x168)],_0xe8b1a5=await Tag_1[_0xa4f6bd(0x1dc)]['findOne']({'where':{'id':_0x5e3a61,'companyId':_0x37e86f}});if(!_0xe8b1a5)return _0x2053f1[_0xa4f6bd(0x152)](0x190)['json']({'status':_0xa4f6bd(0x1c1),'error':_0xa4f6bd(0x13d)});const _0x1280ec=await Ticket_1[_0xa4f6bd(0x1dc)][_0xa4f6bd(0x1e2)]({'include':[{'model':Tag_1[_0xa4f6bd(0x1dc)],'as':_0xa4f6bd(0x119),'attributes':['id',_0xa4f6bd(0x12d)],'through':{'attributes':[],'where':{'tagId':_0x5e3a61}}},{'model':Contact_1[_0xa4f6bd(0x1dc)],'as':_0xa4f6bd(0x13a),'attributes':['id',_0xa4f6bd(0x12d),_0xa4f6bd(0x131),_0xa4f6bd(0x11e),_0xa4f6bd(0x16e),_0xa4f6bd(0x1c8),_0xa4f6bd(0x15f),_0xa4f6bd(0x149)],'include':[_0xa4f6bd(0x17a)]},{'model':Queue_1[_0xa4f6bd(0x1dc)],'as':_0xa4f6bd(0x122),'attributes':['id',_0xa4f6bd(0x12d),'color']},{'model':User_1['default'],'as':_0xa4f6bd(0x1ae),'attributes':['id','name']},{'model':Whatsapp_1[_0xa4f6bd(0x1dc)],'as':_0xa4f6bd(0x1dd),'attributes':[_0xa4f6bd(0x12d),_0xa4f6bd(0x135),_0xa4f6bd(0x160)]},{'model':Company_1[_0xa4f6bd(0x1dc)],'as':_0xa4f6bd(0x1e6),'attributes':['name']}],'where':{'companyId':_0x37e86f,'$tags.id$':_0x5e3a61}});return _0x2053f1[_0xa4f6bd(0x152)](0xc8)['json']({'status':_0xa4f6bd(0x1b6),'tickets':_0x1280ec});}catch(_0x4cd9e4){return console[_0xa4f6bd(0x1cb)](_0x4cd9e4),_0x2053f1[_0xa4f6bd(0x152)](0x1f4)[_0xa4f6bd(0x114)]({'status':_0xa4f6bd(0x1c1),'error':_0xa4f6bd(0x19b)});}};exports[a9_0x295872(0x1de)]=listTicketsByTag;const listTicketsByTagIsAuth=async(_0xab68e6,_0x3269ce)=>{const _0x4c64f9=a9_0x295872,{tagId:_0x11b365}=_0xab68e6[_0x4c64f9(0x1ab)];try{const _0x243110=await Ticket_1[_0x4c64f9(0x1dc)]['findAll']({'include':[{'model':Contact_1['default'],'as':_0x4c64f9(0x13a),'attributes':[_0x4c64f9(0x12d),_0x4c64f9(0x131),_0x4c64f9(0x11e)],'include':['extraInfo']},{'model':Tag_1['default'],'as':'tags','attributes':['id',_0x4c64f9(0x12d),_0x4c64f9(0x1e7)],'where':{'id':_0x11b365}},{'model':Whatsapp_1[_0x4c64f9(0x1dc)],'as':_0x4c64f9(0x1dd),'attributes':[_0x4c64f9(0x12d),'facebookUserToken',_0x4c64f9(0x160)]},{'model':Company_1[_0x4c64f9(0x1dc)],'as':_0x4c64f9(0x1e6),'attributes':[_0x4c64f9(0x12d)]}]});return _0x3269ce['status'](0xc8)[_0x4c64f9(0x114)]({'status':_0x4c64f9(0x1b6),'tickets':_0x243110});}catch(_0x3b237c){return console[_0x4c64f9(0x1cb)](_0x3b237c),_0x3269ce['status'](0x1f4)[_0x4c64f9(0x114)]({'status':_0x4c64f9(0x1c1),'error':_0x4c64f9(0x19b)});}};exports['listTicketsByTagIsAuth']=listTicketsByTagIsAuth;function makeid(_0x55a799){const _0x472cab=a9_0x295872;var _0x2c1fc6='',_0x482537=_0x472cab(0x1d0),_0x431e15=_0x482537[_0x472cab(0x1d9)];for(var _0x622761=0x0;_0x622761<_0x55a799;_0x622761++){_0x2c1fc6+=_0x482537[_0x472cab(0x12a)](Math[_0x472cab(0x1a0)](Math[_0x472cab(0x197)]()*_0x431e15));}return _0x2c1fc6;}exports[a9_0x295872(0x129)]=makeid;const handleAudioLink=async(_0x57f106,_0x23d368)=>{const _0x4fa170=a9_0x295872,{link:_0x1822f5,contactNumber:_0x551464}=_0x57f106[_0x4fa170(0x124)];try{const _0x33f22c=_0x57f106[_0x4fa170(0x179)]['authorization'],[,_0x54dcdf]=_0x33f22c['split']('\x20'),_0x448d93=await Whatsapp_1[_0x4fa170(0x1dc)][_0x4fa170(0x1ba)]({'where':{'token':_0x54dcdf}}),_0x1612e8=_0x448d93[_0x4fa170(0x168)],_0x1bd4d1=await(0x0,GetDefaultWhatsApp_1[_0x4fa170(0x1dc)])(_0x1612e8),_0x23f110=(0x0,wbot_1['getWbot'])(_0x1bd4d1['id']),_0x48f983=_0x4fa170(0x18d)+_0x1612e8+'/'+makeid(0xa)+_0x4fa170(0x1bf);if(!_0x448d93)return _0x23d368[_0x4fa170(0x152)](0x191)[_0x4fa170(0x114)]({'status':_0x4fa170(0x159),'error':_0x4fa170(0x1a6)});const _0x331702=await axios_1[_0x4fa170(0x1dc)][_0x4fa170(0x19f)](_0x1822f5,{'responseType':'arraybuffer'});fs_1[_0x4fa170(0x1dc)][_0x4fa170(0x162)](_0x48f983,Buffer[_0x4fa170(0x153)](_0x331702[_0x4fa170(0x191)]));const _0x3656e1=_0x4fa170(0x136);return await(0x0,SendPresenceStatus_1['SendPresenceStatus'])(_0x23f110,_0x551464),await _0x23f110[_0x4fa170(0x184)](_0x551464+_0x4fa170(0x194),{'audio':fs_1['default'][_0x4fa170(0x16c)](_0x48f983),'fileName':_0x3656e1,'caption':_0x3656e1,'mimetype':_0x4fa170(0x12e),'ptt':!![]}),_0x23d368['status'](0xc8)[_0x4fa170(0x114)]({'status':_0x4fa170(0x171)});}catch(_0x311811){return console[_0x4fa170(0x1cb)](_0x311811),_0x23d368[_0x4fa170(0x152)](0x1f4)[_0x4fa170(0x114)]({'status':_0x4fa170(0x159),'error':_0x4fa170(0x127)});}};exports['handleAudioLink']=handleAudioLink;function a9_0x134e(_0x38122f,_0x32b2bf){const _0x4ef334=a9_0x1b7e();return a9_0x134e=function(_0x48cf6f,_0xe763f5){_0x48cf6f=_0x48cf6f-0x113;let _0x1b7e24=_0x4ef334[_0x48cf6f];return _0x1b7e24;},a9_0x134e(_0x38122f,_0x32b2bf);}const indexApi=async(_0xfb472,_0x2f505f)=>{const _0x38ed73=a9_0x295872,_0x2fdbb7=_0xfb472[_0x38ed73(0x179)]['authorization'],[,_0x2a164c]=_0x2fdbb7['split']('\x20'),_0x36b36d=await Whatsapp_1[_0x38ed73(0x1dc)][_0x38ed73(0x1ba)]({'where':{'token':_0x2a164c}}),_0xf8c330=_0x36b36d[_0x38ed73(0x168)],{searchParam:_0x4285ec,pageNumber:_0x5c637e}=_0xfb472[_0x38ed73(0x1a5)];if(_0xf8c330===0x1){const {invoices:_0x15680d,count:_0x5f3183,hasMore:_0x2c1414}=await(0x0,ListInvoicesServices_1['default'])({'searchParam':_0x4285ec,'pageNumber':_0x5c637e});return _0x2f505f[_0x38ed73(0x114)]({'invoices':_0x15680d,'count':_0x5f3183,'hasMore':_0x2c1414});}else return _0x2f505f['status'](0x191)[_0x38ed73(0x114)]({'status':_0x38ed73(0x159),'error':'Acesso\x20não\x20autorizado.\x20Por\x20favor,\x20forneça\x20credenciais\x20válidas.'});};exports[a9_0x295872(0x180)]=indexApi;const showApi=async(_0x525809,_0x5bd717)=>{const _0x1a8a12=a9_0x295872,_0x50f664=_0x525809[_0x1a8a12(0x179)]['authorization'],[,_0x2dec9c]=_0x50f664['split']('\x20'),_0x26dbed=await Whatsapp_1[_0x1a8a12(0x1dc)]['findOne']({'where':{'token':_0x2dec9c}}),_0x25bf0c=_0x26dbed[_0x1a8a12(0x168)],{Invoiceid:_0x231593}=_0x525809[_0x1a8a12(0x1ab)],_0x7b2128=await(0x0,ShowInvoiceService_1['default'])(_0x231593);return _0x5bd717[_0x1a8a12(0x152)](0xc8)['json'](_0x7b2128);};exports['showApi']=showApi;const showAllApi=async(_0x453434,_0x51a086)=>{const _0x4cf341=a9_0x295872;try{const _0x36efc4=_0x453434['headers'][_0x4cf341(0x1b2)],[,_0x3b94ea]=_0x36efc4[_0x4cf341(0x1b8)]('\x20'),_0x323c2b=await Whatsapp_1[_0x4cf341(0x1dc)][_0x4cf341(0x1ba)]({'where':{'token':_0x3b94ea}}),_0x1ca719=_0x323c2b[_0x4cf341(0x168)],{companyId:_0x238b03,status:_0x21cef4}=_0x453434['body'];if(_0x1ca719===0x1){const _0x323174=await Invoices_1[_0x4cf341(0x1dc)]['findAll']({'where':{'companyId':_0x238b03,'status':_0x21cef4}});return _0x51a086[_0x4cf341(0x152)](0xc8)['json'](_0x323174);}else return _0x51a086['status'](0x191)['json']({'status':_0x4cf341(0x159),'error':_0x4cf341(0x17f)});}catch(_0x362b43){return console[_0x4cf341(0x1cb)](_0x4cf341(0x1c9),_0x362b43),_0x51a086[_0x4cf341(0x152)](0x1f4)[_0x4cf341(0x114)]({'error':_0x4cf341(0x1af)});}};exports[a9_0x295872(0x1cc)]=showAllApi;const updateApi=async(_0x542160,_0x366813)=>{const _0xa197b=a9_0x295872,_0xe8ccd5=_0x542160[_0xa197b(0x179)][_0xa197b(0x1b2)],[,_0x3cffa8]=_0xe8ccd5[_0xa197b(0x1b8)]('\x20'),_0x1cbd34=await Whatsapp_1[_0xa197b(0x1dc)]['findOne']({'where':{'token':_0x3cffa8}}),_0x42b36d=_0x1cbd34[_0xa197b(0x168)],_0x25b46e=_0x542160[_0xa197b(0x124)],_0x2f183e=Yup[_0xa197b(0x16d)]()[_0xa197b(0x17b)]({'name':Yup[_0xa197b(0x155)]()});try{await _0x2f183e[_0xa197b(0x15c)](_0x25b46e);}catch(_0x4225eb){throw new AppError_1[(_0xa197b(0x1dc))](_0x4225eb[_0xa197b(0x196)]);}const {id:_0x10315b,status:_0x1c0b49}=_0x25b46e;if(_0x42b36d===0x1){const _0x1bebc2=await(0x0,UpdateInvoiceService_1[_0xa197b(0x1dc)])({'id':_0x10315b,'status':_0x1c0b49}),_0x123018=await Invoices_1[_0xa197b(0x1dc)][_0xa197b(0x120)](_0x10315b),_0x2e0b8f=_0x123018['companyId'],_0x1f3297=await Company_1[_0xa197b(0x1dc)][_0xa197b(0x120)](_0x2e0b8f),_0x36fe80=new Date(_0x1f3297[_0xa197b(0x11c)]);_0x36fe80[_0xa197b(0x11d)](_0x36fe80[_0xa197b(0x1d4)]()+0x1e);const _0x5ba311=_0x36fe80[_0xa197b(0x1c7)]()['split']('T')[0x0];if(_0x1f3297){await _0x1f3297[_0xa197b(0x189)]({'dueDate':_0x5ba311});const _0x4db80d=await _0x123018['update']({'id':_0x10315b,'status':_0xa197b(0x1df)});await _0x1f3297[_0xa197b(0x1d7)]();const _0x28d4bc=(0x0,socket_1[_0xa197b(0x11b)])(),_0x7e2d29=await Company_1[_0xa197b(0x1dc)]['findOne']({'where':{'id':_0x2e0b8f}});}return _0x366813[_0xa197b(0x152)](0xc8)[_0xa197b(0x114)](_0x1bebc2);}else return _0x366813[_0xa197b(0x152)](0x191)['json']({'status':'ERRO','error':_0xa197b(0x17f)});};exports[a9_0x295872(0x165)]=updateApi;const updateUsageStats=async(_0x2d2a31,_0x13e70e)=>{const _0x486c65=a9_0x295872;if(!_0x2d2a31[_0x486c65(0x1ae)]||!_0x2d2a31[_0x486c65(0x1ae)]['companyId'])return _0x13e70e[_0x486c65(0x152)](0x190)[_0x486c65(0x1d2)]({'status':_0x486c65(0x1c1),'message':'Missing\x20user\x20or\x20companyId'});const {companyId:_0x5b53eb}=_0x2d2a31[_0x486c65(0x1ae)],{contactId:_0x1d8bde}=_0x2d2a31[_0x486c65(0x1ab)];return setTimeout(async()=>{const _0x41baf2=_0x486c65,{dateToClient:_0x34cf1e}=(0x0,useDate_1[_0x41baf2(0x1b7)])(),_0x42795f=_0x34cf1e(new Date()[_0x41baf2(0x167)]()),_0x4a2d4e=(0x0,moment_1[_0x41baf2(0x1dc)])()[_0x41baf2(0x126)]();try{const _0x457279=await ApiUsages_1[_0x41baf2(0x1dc)][_0x41baf2(0x1ba)]({'where':{'dateUsed':_0x42795f,'companyId':_0x5b53eb}});if(_0x457279)await _0x457279['update']({'usedOther':_0x457279[_0x41baf2(0x117)][_0x41baf2(0x146)]+0x1,'UsedOnDay':_0x457279[_0x41baf2(0x117)][_0x41baf2(0x1b1)]+0x1,'updatedAt':_0x4a2d4e});else{const _0x20bccc=await ApiUsages_1[_0x41baf2(0x1dc)]['create']({'companyId':_0x5b53eb,'dateUsed':_0x42795f});await _0x20bccc[_0x41baf2(0x189)]({'usedOther':_0x20bccc[_0x41baf2(0x117)][_0x41baf2(0x146)]+0x1,'UsedOnDay':_0x20bccc[_0x41baf2(0x117)][_0x41baf2(0x1b1)]+0x1,'updatedAt':_0x4a2d4e});}}catch(_0x5c9b82){return console[_0x41baf2(0x1cb)](_0x41baf2(0x1ad),_0x5c9b82),_0x13e70e[_0x41baf2(0x152)](0x1f4)[_0x41baf2(0x1d2)]({'status':_0x41baf2(0x1c1),'message':_0x41baf2(0x19d)});}},0x64),_0x13e70e['send']({'status':_0x486c65(0x1b6)});};exports[a9_0x295872(0x1c6)]=updateUsageStats;const indexContacts=async(_0x5d52f3,_0x536ab0)=>{const _0x2ae874=a9_0x295872,{searchParam:_0x149cd2,pageNumber:_0x3c37b7}=_0x5d52f3[_0x2ae874(0x1a5)],{companyId:_0x4f73b1}=_0x5d52f3['user'],{contacts:_0x237209,count:_0x3c363a,hasMore:_0x36126c}=await(0x0,ListContactsService_1[_0x2ae874(0x1dc)])({'searchParam':_0x149cd2,'pageNumber':_0x3c37b7,'companyId':_0x4f73b1});return _0x536ab0[_0x2ae874(0x114)]({'contacts':_0x237209,'count':_0x3c363a,'hasMore':_0x36126c});};exports['indexContacts']=indexContacts;const listContacts=async(_0x1ad077,_0x16ab49)=>{const _0x4b9467=a9_0x295872,{name:_0x1d8531}=_0x1ad077[_0x4b9467(0x1a5)],{companyId:_0x564078}=_0x1ad077['user'],_0x51660d=await(0x0,SimpleListService_1[_0x4b9467(0x1dc)])({'name':_0x1d8531,'companyId':_0x564078});return _0x16ab49[_0x4b9467(0x114)](_0x51660d);};exports[a9_0x295872(0x16a)]=listContacts;const showContacts=async(_0x45f710,_0x45cfab)=>{const _0x56e9c4=a9_0x295872,{contactId:_0x203eac}=_0x45f710[_0x56e9c4(0x1ab)],{companyId:_0x2fd2f7}=_0x45f710['user'],_0x56f903=await(0x0,ShowContactService_1['default'])(_0x203eac,_0x2fd2f7);return _0x45cfab[_0x56e9c4(0x152)](0xc8)[_0x56e9c4(0x114)](_0x56f903);};exports[a9_0x295872(0x1b0)]=showContacts;const findOrCreateContacts=async(_0x2560da,_0x41d54d)=>{const _0x3b3292=a9_0x295872,{name:_0xe4786d,number:_0x1d517b}=_0x2560da['body'],{companyId:_0xb1de1}=_0x2560da[_0x3b3292(0x1ae)],_0x3c6e3d=await(0x0,GetContactService_1[_0x3b3292(0x1dc)])({'name':_0xe4786d,'number':_0x1d517b,'companyId':_0xb1de1});return _0x41d54d[_0x3b3292(0x152)](0xc8)[_0x3b3292(0x114)](_0x3c6e3d);};exports[a9_0x295872(0x182)]=findOrCreateContacts;const storeContacts=async(_0x5fdc75,_0x5bc6e4)=>{const _0xf7c2f6=a9_0x295872,{companyId:_0x3fe06c}=_0x5fdc75[_0xf7c2f6(0x1ae)],_0x1636cc=_0x5fdc75[_0xf7c2f6(0x124)];_0x1636cc['number']=_0x1636cc['number']['replace']('-','')[_0xf7c2f6(0x17d)]('\x20','');const _0x5b64e6=Yup[_0xf7c2f6(0x16d)]()[_0xf7c2f6(0x17b)]({'name':Yup[_0xf7c2f6(0x155)]()[_0xf7c2f6(0x185)](),'number':Yup[_0xf7c2f6(0x155)]()[_0xf7c2f6(0x185)]()['matches'](/^\d+$/,_0xf7c2f6(0x17e))});try{await _0x5b64e6[_0xf7c2f6(0x15c)](_0x1636cc);}catch(_0x3322fe){throw new AppError_1[(_0xf7c2f6(0x1dc))](_0x3322fe[_0xf7c2f6(0x196)]);}await(0x0,CheckIsValidContact_1['default'])(_0x1636cc[_0xf7c2f6(0x131)],_0x3fe06c);const _0x1e00a2=await(0x0,CheckNumber_1[_0xf7c2f6(0x1dc)])(_0x1636cc[_0xf7c2f6(0x131)],_0x3fe06c),_0x17f8b3=_0x1e00a2[_0xf7c2f6(0x1aa)][_0xf7c2f6(0x17d)](/\D/g,'');_0x1636cc[_0xf7c2f6(0x131)]=_0x17f8b3;const _0x2e4ec6=await(0x0,CreateContactService_1[_0xf7c2f6(0x1dc)])({..._0x1636cc,'companyId':_0x3fe06c}),_0x171ff5=(0x0,socket_1[_0xf7c2f6(0x11b)])();return _0x171ff5[_0xf7c2f6(0x14c)]('company-'+_0x3fe06c+'-contact',{'action':_0xf7c2f6(0x121),'contact':_0x2e4ec6}),_0x5bc6e4[_0xf7c2f6(0x152)](0xc8)[_0xf7c2f6(0x114)](_0x2e4ec6);};exports['storeContacts']=storeContacts;const removeAllContacts=async(_0x78e57e,_0x308d3c)=>{const _0x5bba5d=a9_0x295872,{companyId:_0x248b6b}=_0x78e57e['user'];try{await Contact_1[_0x5bba5d(0x1dc)][_0x5bba5d(0x143)]({'where':{'companyId':_0x248b6b}});const _0x229c4b=(0x0,socket_1['getIO'])();return _0x229c4b['emit'](_0x5bba5d(0x1d8)+_0x248b6b+_0x5bba5d(0x1cd),{'action':_0x5bba5d(0x169)}),setTimeout(async()=>{const _0x3ec1a2=_0x5bba5d,{dateToClient:_0x3e31f1}=(0x0,useDate_1['useDate'])(),_0x28dda1=_0x3e31f1(new Date()[_0x3ec1a2(0x167)]()),_0x43ad5b=(0x0,moment_1[_0x3ec1a2(0x1dc)])()[_0x3ec1a2(0x126)]();try{const _0x12913b=await ApiUsages_1[_0x3ec1a2(0x1dc)][_0x3ec1a2(0x1ba)]({'where':{'dateUsed':_0x28dda1,'companyId':_0x248b6b}});if(_0x12913b)await _0x12913b[_0x3ec1a2(0x189)]({'usedOther':_0x12913b[_0x3ec1a2(0x117)]['usedOther']+0x1,'UsedOnDay':_0x12913b[_0x3ec1a2(0x117)]['UsedOnDay']+0x1,'updatedAt':_0x43ad5b});else{const _0x129912=await ApiUsages_1[_0x3ec1a2(0x1dc)][_0x3ec1a2(0x121)]({'companyId':_0x248b6b,'dateUsed':_0x28dda1});await _0x129912[_0x3ec1a2(0x189)]({'usedOther':_0x129912[_0x3ec1a2(0x117)]['usedOther']+0x1,'UsedOnDay':_0x129912[_0x3ec1a2(0x117)][_0x3ec1a2(0x1b1)]+0x1,'updatedAt':_0x43ad5b});}}catch(_0x377ee7){return console[_0x3ec1a2(0x1cb)](_0x3ec1a2(0x1ad),_0x377ee7),_0x308d3c[_0x3ec1a2(0x152)](0x1f4)[_0x3ec1a2(0x1d2)]({'status':_0x3ec1a2(0x1c1),'message':_0x3ec1a2(0x19d)});}},0x64),_0x308d3c['status'](0xc8)[_0x5bba5d(0x1d2)]({'status':'SUCCESS','message':'All\x20contacts\x20removed\x20successfully'});}catch(_0x3092c3){return console[_0x5bba5d(0x1cb)](_0x5bba5d(0x116),_0x3092c3),_0x308d3c['status'](0x1f4)[_0x5bba5d(0x1d2)]({'status':'ERROR','message':_0x5bba5d(0x19d)});}};exports[a9_0x295872(0x1ca)]=removeAllContacts;const updateContacts=async(_0xcd75,_0x50f1ba)=>{const _0x1bd688=a9_0x295872,_0x5a0b44=_0xcd75[_0x1bd688(0x124)],{companyId:_0x2d639d}=_0xcd75[_0x1bd688(0x1ae)],_0x293b27=Yup[_0x1bd688(0x16d)]()[_0x1bd688(0x17b)]({'name':Yup['string'](),'number':Yup[_0x1bd688(0x155)]()[_0x1bd688(0x181)](/^\d+$/,_0x1bd688(0x17e))});try{await _0x293b27['validate'](_0x5a0b44);}catch(_0x345824){throw new AppError_1['default'](_0x345824[_0x1bd688(0x196)]);}await(0x0,CheckIsValidContact_1[_0x1bd688(0x1dc)])(_0x5a0b44[_0x1bd688(0x131)],_0x2d639d);const _0x2aa3b2=await(0x0,CheckNumber_1[_0x1bd688(0x1dc)])(_0x5a0b44[_0x1bd688(0x131)],_0x2d639d),_0x3549a3=_0x2aa3b2[_0x1bd688(0x1aa)][_0x1bd688(0x17d)](/\D/g,'');_0x5a0b44[_0x1bd688(0x131)]=_0x3549a3;const {contactId:_0x29f98f}=_0xcd75['params'],_0x2d0d25=await(0x0,UpdateContactService_1[_0x1bd688(0x1dc)])({'contactData':_0x5a0b44,'contactId':_0x29f98f,'companyId':_0x2d639d}),_0xf343ea=(0x0,socket_1[_0x1bd688(0x11b)])();return _0xf343ea[_0x1bd688(0x14c)](_0x1bd688(0x1d8)+_0x2d639d+'-contact',{'action':'update','contact':_0x2d0d25}),_0x50f1ba[_0x1bd688(0x152)](0xc8)[_0x1bd688(0x114)](_0x2d0d25);};exports[a9_0x295872(0x186)]=updateContacts;const removeContacts=async(_0x5d1753,_0x59e202)=>{const _0x528095=a9_0x295872,{contactId:_0x5971b9}=_0x5d1753[_0x528095(0x1ab)],{companyId:_0x126ba9}=_0x5d1753[_0x528095(0x1ae)];await(0x0,ShowContactService_1[_0x528095(0x1dc)])(_0x5971b9,_0x126ba9),await(0x0,DeleteContactService_1[_0x528095(0x1dc)])(_0x5971b9);const _0x238e95=(0x0,socket_1[_0x528095(0x11b)])();return _0x238e95['emit'](_0x528095(0x1d8)+_0x126ba9+_0x528095(0x1cd),{'action':_0x528095(0x14e),'contactId':_0x5971b9}),_0x59e202[_0x528095(0x152)](0xc8)['json']({'message':_0x528095(0x1ac)});};exports['removeContacts']=removeContacts;const uploadContacts=async(_0x1fbe46,_0x55e118)=>{const _0x2288a5=a9_0x295872,_0xda5a53=_0x1fbe46[_0x2288a5(0x12b)],_0x4a8b3b=(0x0,lodash_1[_0x2288a5(0x118)])(_0xda5a53),{companyId:_0x184e6c}=_0x1fbe46['user'],_0x5d2371=await(0x0,ImportXLSContactsService_1[_0x2288a5(0x195)])(_0x184e6c,_0x4a8b3b),_0x162b12=(0x0,socket_1[_0x2288a5(0x11b)])(),_0x3774d3={'action':'reload','records':_0x5d2371};return _0x162b12['to'](_0x2288a5(0x1d8)+_0x184e6c+_0x2288a5(0x1a9))[_0x2288a5(0x14c)]('company-'+_0x184e6c+'-contact',_0x3774d3),_0x55e118[_0x2288a5(0x152)](0xc8)[_0x2288a5(0x114)](_0x5d2371);};function a9_0x1b7e(){const _0x2f0840=['updateQueueId','string','defineProperty','req','updateTicketTag','ERRO','../services/WbotServices/SendWhatsAppMedia','Not\x20exists\x20on\x20Whatsapp','validate','../models/Whatsapp','boolean','active','facebookUserId','listTicketsByTagIsAuth','writeFileSync','__esModule','Tag\x20already\x20associated\x20with\x20the\x20ticket','updateApi','usedPDF','toString','companyId','deleteAll','listContacts','../models/ApiUsages','readFileSync','object','profilePicUrl','\x20not\x20found','axios','SUCESSO','apply','indexWhatsappsId','../services/ContactServices/ListContactsService','createCompany','../services/InvoicesService/ShowInvoiceService','../services/WbotServices/SendWhatsAppMessageAPI','pending','headers','extraInfo','shape','../services/WbotServices/GetProfilePicUrl','replace','Invalid\x20number\x20format.\x20Only\x20numbers\x20is\x20allowed.','Acesso\x20não\x20autorizado.\x20Por\x20favor,\x20forneça\x20credenciais\x20válidas.','indexApi','matches','findOrCreateContacts','68337HwjRBl','sendMessage','required','updateContacts','../models/Invoices','configurable','update','updateCompany','extname','pdf','./public/company','__importStar','../services/InvoicesService/UpdateInvoiceService','../helpers/SendPresenceStatus','data','ticketData','usedText','@s.whatsapp.net','ImportXLSContactsService','message','random','Failed\x20to\x20update\x20ticket\x20tag','mimetype','../helpers/GetDefaultWhatsApp','Internal\x20Server\x20Error','whatsapp\x20#','Internal\x20server\x20error','1273410GIIWQt','get','floor','map','includes','parseInt','nullable','query','Token\x20de\x20autorização\x20inválido','url','77222VjqMEY','-mainchannel','jid','params','Contact\x20deleted','Error\x20updating\x20usage\x20stats:','user','Erro\x20ao\x20buscar\x20invoices','showContacts','UsedOnDay','authorization','usedCheckNumber','getWbot','OnWhatsAppDto','SUCCESS','useDate','split','1577408wYrWGU','findOne','Company\x20not\x20found','../models/Company','listTicketsByCompany','all','.mp3','../libs/socket','ERROR','194039BdNUjl','closeTicket','isInteger','../services/ContactServices/CreateContactService','updateUsageStats','toISOString','acceptAudioMessage','Erro\x20ao\x20buscar\x20invoices:','removeAllContacts','error','showAllApi','-contact','test','../services/TicketServices/UpdateTicketService','ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789','244rhCUMO','send','type','getDate','960944WilBoO','removeTicketTag','reload','company-','length','../services/ContactServices/CreateOrUpdateContactService','removeContacts','default','whatsapp','listTicketsByTag','paid','1570DCVhRi','../services/ContactServices/ImportXLSContactsService','findAll','(((.+)+)+)+$','index','originalname','company','color','image','json','../helpers/SetTicketMessagesAsRead','Error\x20removing\x20all\x20contacts:','dataValues','head','tags','../services/WbotServices/SendWhatsappMediaImage','getIO','dueDate','setDate','email','indexImage','findByPk','create','queue','usedImage','body','Invalid\x20queue\x20for\x20the\x20company','format','Erro\x20ao\x20lidar\x20com\x20o\x20link\x20de\x20áudio','../services/ContactServices/DeleteContactService','makeid','charAt','files','moment','name','audio/mp4','__importDefault','date','number','11215larpzL','blockCompany','exists','facebookUserToken','Legenda\x20do\x20áudio','search','uploadContacts','writable','contact','../services/TicketServices/ShowTicketService','indexLink','Tag\x20does\x20not\x20belong\x20to\x20the\x20specified\x20company','../utils/useDate','@g.us','../models/Tag','log','../services/WbotServices/SendWhatsAppMessageLink','destroy','checkNumber','toggleDisableBotContacts','usedOther','../services/TicketServices/FindOrCreateTicketService','yup','disableBot','media','usedVideo','emit','caption','delete','../models/Contact','27gSqxfs','video','status','from'];a9_0x1b7e=function(){return _0x2f0840;};return a9_0x1b7e();}exports[a9_0x295872(0x138)]=uploadContacts;const toggleDisableBotContacts=async(_0xe54b2e,_0x3b3a47)=>{const _0x347e1a=a9_0x295872,{contactId:_0x100a6b}=_0xe54b2e[_0x347e1a(0x1ab)],{companyId:_0x48b096}=_0xe54b2e['user'],_0x5e4ee2=await(0x0,ToggleDisableBotService_1[_0x347e1a(0x1dc)])(_0x100a6b,_0x48b096),_0x4acc8f=(0x0,socket_1[_0x347e1a(0x11b)])();return _0x4acc8f[_0x347e1a(0x14c)](_0x347e1a(0x1d8)+_0x48b096+_0x347e1a(0x1cd),{'action':'update','contact':_0x5e4ee2}),_0x3b3a47['status'](0xc8)[_0x347e1a(0x114)](_0x5e4ee2);};exports[a9_0x295872(0x145)]=toggleDisableBotContacts;