const a9_0x105992=a9_0x1975;(function(_0x118184,_0x453239){const _0x44f0ac=a9_0x1975,_0xd1edda=_0x118184();while(!![]){try{const _0x249de4=parseInt(_0x44f0ac(0x19f))/0x1+-parseInt(_0x44f0ac(0x217))/0x2*(parseInt(_0x44f0ac(0x1c8))/0x3)+parseInt(_0x44f0ac(0x238))/0x4*(-parseInt(_0x44f0ac(0x228))/0x5)+-parseInt(_0x44f0ac(0x211))/0x6+-parseInt(_0x44f0ac(0x1cc))/0x7*(parseInt(_0x44f0ac(0x1f6))/0x8)+parseInt(_0x44f0ac(0x216))/0x9*(-parseInt(_0x44f0ac(0x1e4))/0xa)+parseInt(_0x44f0ac(0x20c))/0xb;if(_0x249de4===_0x453239)break;else _0xd1edda['push'](_0xd1edda['shift']());}catch(_0x1176c4){_0xd1edda['push'](_0xd1edda['shift']());}}}(a9_0x5c29,0xac17b));const a9_0xba81b5=(function(){let _0x24e797=!![];return function(_0x3e2cce,_0x1e9e28){const _0x5a6289=_0x24e797?function(){const _0x2c4e56=a9_0x1975;if(_0x1e9e28){const _0x12101a=_0x1e9e28[_0x2c4e56(0x23e)](_0x3e2cce,arguments);return _0x1e9e28=null,_0x12101a;}}:function(){};return _0x24e797=![],_0x5a6289;};}()),a9_0x3a31e9=a9_0xba81b5(this,function(){const _0x406cc7=a9_0x1975;return a9_0x3a31e9[_0x406cc7(0x1bf)]()[_0x406cc7(0x1c1)](_0x406cc7(0x173))[_0x406cc7(0x1bf)]()[_0x406cc7(0x1d2)](a9_0x3a31e9)['search'](_0x406cc7(0x173));});a9_0x3a31e9();'use strict';var __createBinding=this&&this['__createBinding']||(Object[a9_0x105992(0x1ab)]?function(_0x5275cc,_0x177c6b,_0x180cd1,_0x3629ce){const _0x5c4f45=a9_0x105992;if(_0x3629ce===undefined)_0x3629ce=_0x180cd1;var _0x2fed4d=Object[_0x5c4f45(0x1b6)](_0x177c6b,_0x180cd1);(!_0x2fed4d||(_0x5c4f45(0x1b4)in _0x2fed4d?!_0x177c6b[_0x5c4f45(0x201)]:_0x2fed4d['writable']||_0x2fed4d[_0x5c4f45(0x22a)]))&&(_0x2fed4d={'enumerable':!![],'get':function(){return _0x177c6b[_0x180cd1];}}),Object['defineProperty'](_0x5275cc,_0x3629ce,_0x2fed4d);}:function(_0x35841d,_0x236633,_0x296e04,_0x3abe80){if(_0x3abe80===undefined)_0x3abe80=_0x296e04;_0x35841d[_0x3abe80]=_0x236633[_0x296e04];}),__setModuleDefault=this&&this[a9_0x105992(0x1ad)]||(Object[a9_0x105992(0x1ab)]?function(_0x118d77,_0x8ca941){const _0x3d12fe=a9_0x105992;Object[_0x3d12fe(0x180)](_0x118d77,'default',{'enumerable':!![],'value':_0x8ca941});}:function(_0x3712e1,_0x411d15){const _0x179345=a9_0x105992;_0x3712e1[_0x179345(0x210)]=_0x411d15;}),__importStar=this&&this[a9_0x105992(0x1ff)]||function(_0x401f9a){const _0x56fa66=a9_0x105992;if(_0x401f9a&&_0x401f9a['__esModule'])return _0x401f9a;var _0x5a97e0={};if(_0x401f9a!=null){for(var _0x29cff0 in _0x401f9a)if(_0x29cff0!=='default'&&Object[_0x56fa66(0x197)][_0x56fa66(0x18a)][_0x56fa66(0x230)](_0x401f9a,_0x29cff0))__createBinding(_0x5a97e0,_0x401f9a,_0x29cff0);}return __setModuleDefault(_0x5a97e0,_0x401f9a),_0x5a97e0;},__importDefault=this&&this['__importDefault']||function(_0x2cb5be){const _0x31aa7f=a9_0x105992;return _0x2cb5be&&_0x2cb5be[_0x31aa7f(0x201)]?_0x2cb5be:{'default':_0x2cb5be};};Object['defineProperty'](exports,a9_0x105992(0x201),{'value':!![]}),exports['toggleDisableBotContacts']=exports[a9_0x105992(0x1c5)]=exports[a9_0x105992(0x1ba)]=exports[a9_0x105992(0x232)]=exports[a9_0x105992(0x23f)]=exports[a9_0x105992(0x235)]=exports[a9_0x105992(0x1f8)]=exports[a9_0x105992(0x1bc)]=exports[a9_0x105992(0x17e)]=exports[a9_0x105992(0x20d)]=exports['updateUsageStats']=exports['updateApi']=exports[a9_0x105992(0x1a7)]=exports[a9_0x105992(0x20b)]=exports[a9_0x105992(0x178)]=exports[a9_0x105992(0x1ef)]=exports[a9_0x105992(0x218)]=exports['listTicketsByTagIsAuth']=exports[a9_0x105992(0x239)]=exports[a9_0x105992(0x1c4)]=exports['removeTicketTag']=exports[a9_0x105992(0x21e)]=exports[a9_0x105992(0x19a)]=exports['updateQueueId']=exports[a9_0x105992(0x191)]=exports['checkNumber']=exports[a9_0x105992(0x223)]=exports[a9_0x105992(0x18e)]=exports[a9_0x105992(0x171)]=exports[a9_0x105992(0x187)]=exports[a9_0x105992(0x1db)]=exports[a9_0x105992(0x1d6)]=exports[a9_0x105992(0x1d0)]=void 0x0;const axios_1=__importDefault(require('axios')),fs_1=__importDefault(require('fs')),Yup=__importStar(require('yup')),lodash_1=require(a9_0x105992(0x213)),GetDefaultWhatsApp_1=__importDefault(require(a9_0x105992(0x23b))),SetTicketMessagesAsRead_1=__importDefault(require(a9_0x105992(0x16f))),socket_1=require('../libs/socket'),Whatsapp_1=__importDefault(require('../models/Whatsapp')),Queue_1=__importDefault(require('../models/Queue')),User_1=__importDefault(require(a9_0x105992(0x1a9))),CreateOrUpdateContactService_1=__importDefault(require('../services/ContactServices/CreateOrUpdateContactService')),FindOrCreateTicketService_1=__importDefault(require(a9_0x105992(0x1be))),ShowTicketService_1=__importDefault(require(a9_0x105992(0x234))),GetProfilePicUrl_1=__importDefault(require(a9_0x105992(0x1ca))),SendWhatsAppMedia_1=__importDefault(require(a9_0x105992(0x1cb))),UpdateTicketService_1=__importDefault(require(a9_0x105992(0x1d3))),wbot_1=require('../libs/wbot'),SendWhatsAppMessageLink_1=__importDefault(require(a9_0x105992(0x1cd))),SendWhatsAppMessageAPI_1=__importDefault(require(a9_0x105992(0x1ce))),SendWhatsappMediaImage_1=__importDefault(require('../services/WbotServices/SendWhatsappMediaImage')),ListInvoicesServices_1=__importDefault(require(a9_0x105992(0x183))),ShowInvoiceService_1=__importDefault(require(a9_0x105992(0x22f))),UpdateInvoiceService_1=__importDefault(require(a9_0x105992(0x1a8))),Invoices_1=__importDefault(require(a9_0x105992(0x1d7))),ListContactsService_1=__importDefault(require(a9_0x105992(0x19c))),CreateContactService_1=__importDefault(require(a9_0x105992(0x222))),ShowContactService_1=__importDefault(require(a9_0x105992(0x1a2))),UpdateContactService_1=__importDefault(require(a9_0x105992(0x1f3))),DeleteContactService_1=__importDefault(require(a9_0x105992(0x22e))),GetContactService_1=__importDefault(require(a9_0x105992(0x196))),ToggleDisableBotService_1=__importDefault(require(a9_0x105992(0x1f1))),CheckNumber_1=__importDefault(require(a9_0x105992(0x240))),CheckIsValidContact_1=__importDefault(require('../services/WbotServices/CheckIsValidContact')),AppError_1=__importDefault(require('../errors/AppError')),SimpleListService_1=__importDefault(require(a9_0x105992(0x1d5))),ImportXLSContactsService_1=require(a9_0x105992(0x1c3)),ApiUsages_1=__importDefault(require(a9_0x105992(0x229))),useDate_1=require('../utils/useDate'),TicketTag_1=__importDefault(require(a9_0x105992(0x1e8))),Tag_1=__importDefault(require(a9_0x105992(0x1cf))),moment_1=__importDefault(require(a9_0x105992(0x1b0))),path_1=__importDefault(require(a9_0x105992(0x22c))),Ticket_1=__importDefault(require(a9_0x105992(0x17d))),Contact_1=__importDefault(require('../models/Contact')),Company_1=__importDefault(require(a9_0x105992(0x243))),SendPresenceStatus_1=require('../helpers/SendPresenceStatus');class OnWhatsAppDto{constructor(_0x5bad1c,_0x5d8029){const _0x2d2aba=a9_0x105992;this['jid']=_0x5bad1c,this[_0x2d2aba(0x16e)]=_0x5d8029;}}exports['OnWhatsAppDto']=OnWhatsAppDto;const CompanySchema=Yup[a9_0x105992(0x21d)]()[a9_0x105992(0x1e1)]({'name':Yup[a9_0x105992(0x1ac)]()[a9_0x105992(0x1bb)](),'id':Yup['number'](),'phone':Yup[a9_0x105992(0x1ac)]()[a9_0x105992(0x1e7)](),'email':Yup[a9_0x105992(0x1ac)]()['email']()[a9_0x105992(0x1e7)](),'status':Yup[a9_0x105992(0x21b)]()[a9_0x105992(0x1e7)](),'planId':Yup['number']()['nullable'](),'campaignsEnabled':Yup[a9_0x105992(0x21b)]()['nullable'](),'dueDate':Yup[a9_0x105992(0x22b)]()[a9_0x105992(0x1e7)](),'recurrence':Yup[a9_0x105992(0x1ac)]()[a9_0x105992(0x1e7)]()}),createCompany=async(_0x349e7d,_0x58622e)=>{const _0x528800=a9_0x105992;try{await CompanySchema[_0x528800(0x1b2)](_0x349e7d['body']);const _0x42a6d9=await Company_1[_0x528800(0x210)][_0x528800(0x1ab)](_0x349e7d['body']);_0x58622e[_0x528800(0x221)](0xc9)[_0x528800(0x172)](_0x42a6d9);}catch(_0x281cdb){_0x58622e[_0x528800(0x221)](0x190)['json']({'error':_0x281cdb[_0x528800(0x174)]});}};exports[a9_0x105992(0x1d6)]=createCompany;const updateCompany=async(_0x585b55,_0xe614f8)=>{const _0x599879=a9_0x105992;try{await CompanySchema[_0x599879(0x1b2)](_0x585b55[_0x599879(0x20e)]);const {id:_0x4a6438}=_0x585b55[_0x599879(0x1f4)],[_0x46f1d7]=await Company_1[_0x599879(0x210)][_0x599879(0x1e6)](_0x585b55['body'],{'where':{'id':_0x4a6438}});if(_0x46f1d7){const _0x436ef6=await Company_1['default']['findByPk'](_0x4a6438);_0xe614f8['status'](0xc8)['json'](_0x436ef6);}else _0xe614f8['status'](0x194)[_0x599879(0x172)]({'error':_0x599879(0x1ee)});}catch(_0x292bc4){_0xe614f8['status'](0x190)['json']({'error':_0x292bc4[_0x599879(0x174)]});}};exports[a9_0x105992(0x1db)]=updateCompany;const blockCompany=async(_0x16e2aa,_0x39cb31)=>{const _0x292e4b=a9_0x105992;try{const {id:_0x133525}=_0x16e2aa[_0x292e4b(0x1f4)],[_0x5b9b71]=await Company_1['default']['update']({'status':![]},{'where':{'id':_0x133525}});if(_0x5b9b71){const _0x4b5e5c=await Company_1[_0x292e4b(0x210)][_0x292e4b(0x1aa)](_0x133525);_0x39cb31[_0x292e4b(0x221)](0xc8)['json'](_0x4b5e5c);}else _0x39cb31['status'](0x194)[_0x292e4b(0x172)]({'error':_0x292e4b(0x1ee)});}catch(_0x45cb6c){_0x39cb31[_0x292e4b(0x221)](0x190)[_0x292e4b(0x172)]({'error':_0x45cb6c[_0x292e4b(0x174)]});}};exports[a9_0x105992(0x187)]=blockCompany;const createContact=async(_0x31f615,_0x56e1f7,_0x1f46ef)=>{const _0x2de2d6=a9_0x105992;await(0x0,CheckIsValidContact_1[_0x2de2d6(0x210)])(_0x1f46ef,_0x56e1f7);const _0x35370d=await(0x0,CheckNumber_1['default'])(_0x1f46ef,_0x56e1f7),_0x460233=await(0x0,GetProfilePicUrl_1[_0x2de2d6(0x210)])(_0x35370d,_0x56e1f7),_0x374b46=_0x35370d,_0xde09d1={'name':''+_0x374b46,'number':_0x374b46,'profilePicUrl':_0x460233,'isGroup':![],'companyId':_0x56e1f7},_0x506e80=await(0x0,CreateOrUpdateContactService_1[_0x2de2d6(0x210)])(_0xde09d1,null,null);let _0x1fe08b;if(_0x31f615===undefined)_0x1fe08b=await(0x0,GetDefaultWhatsApp_1[_0x2de2d6(0x210)])(_0x56e1f7);else{_0x1fe08b=await Whatsapp_1['default']['findByPk'](_0x31f615);if(_0x1fe08b===null)throw new AppError_1[(_0x2de2d6(0x210))](_0x2de2d6(0x219)+_0x31f615+'\x20not\x20found');}const _0x8af20=await(0x0,FindOrCreateTicketService_1['default'])(_0x506e80,_0x1fe08b['id'],0x0,_0x56e1f7),_0x2f4527=await(0x0,ShowTicketService_1[_0x2de2d6(0x210)])(_0x8af20['id'],_0x56e1f7);return(0x0,SetTicketMessagesAsRead_1['default'])(_0x2f4527),_0x2f4527;};function formatBRNumber(_0x5f2e39){const _0x21886d=a9_0x105992,_0x977611=new RegExp(/^(\d{2})(\d{2})\d{1}(\d{8})$/);if(_0x977611[_0x21886d(0x214)](_0x5f2e39)){const _0x79a1ea=_0x977611['exec'](_0x5f2e39);if(_0x79a1ea&&_0x79a1ea[0x1]==='55'&&Number[_0x21886d(0x245)](Number[_0x21886d(0x19b)](_0x79a1ea[0x2]))){const _0x2384b6=Number[_0x21886d(0x19b)](_0x79a1ea[0x2]);if(_0x2384b6<0x1f)return _0x79a1ea[0x0];else{if(_0x2384b6>=0x1f)return _0x79a1ea[0x1]+_0x79a1ea[0x2]+_0x79a1ea[0x3];}}}else return _0x5f2e39;}function createJid(_0x53f0e5){const _0x173995=a9_0x105992;if(_0x53f0e5[_0x173995(0x185)](_0x173995(0x212))||_0x53f0e5['includes'](_0x173995(0x179)))return formatBRNumber(_0x53f0e5);return _0x53f0e5[_0x173995(0x185)]('-')?_0x53f0e5+_0x173995(0x212):formatBRNumber(_0x53f0e5)+_0x173995(0x179);}const indexLink=async(_0x2b689f,_0x2a9de1)=>{const _0x5ac2a6=a9_0x105992,_0x5d0b28=_0x2b689f[_0x5ac2a6(0x20e)],{whatsappId:_0x296963}=_0x2b689f[_0x5ac2a6(0x20e)],{msdelay:_0x226daa}=_0x2b689f[_0x5ac2a6(0x20e)],_0x174a8b=_0x2b689f['body'][_0x5ac2a6(0x188)],_0x1c36ab=_0x2b689f[_0x5ac2a6(0x20e)][_0x5ac2a6(0x17a)],_0x4687f9=_0x2b689f[_0x5ac2a6(0x23d)]['authorization'],[,_0x46297a]=_0x4687f9[_0x5ac2a6(0x207)]('\x20'),_0x51d69b=await Whatsapp_1[_0x5ac2a6(0x210)]['findOne']({'where':{'token':_0x46297a}}),_0x437d5f=_0x51d69b[_0x5ac2a6(0x22d)];_0x5d0b28[_0x5ac2a6(0x1b5)]=_0x5d0b28[_0x5ac2a6(0x1b5)][_0x5ac2a6(0x198)]('-','')['replace']('\x20','');const _0x2b3fc7=Yup['object']()[_0x5ac2a6(0x1e1)]({'number':Yup['string']()['required']()['matches'](/^\d+$/,_0x5ac2a6(0x200))});try{await _0x2b3fc7[_0x5ac2a6(0x1b2)](_0x5d0b28);}catch(_0x3b1d33){throw new AppError_1[(_0x5ac2a6(0x210))](_0x3b1d33[_0x5ac2a6(0x174)]);}const _0x1035e3=await createContact(_0x296963,_0x437d5f,_0x5d0b28[_0x5ac2a6(0x1b5)]);return await(0x0,SendWhatsAppMessageLink_1['default'])({'ticket':_0x1035e3,'url':_0x174a8b,'caption':_0x1c36ab,'msdelay':_0x226daa}),setTimeout(async()=>{const _0x4a7345=_0x5ac2a6;await(0x0,UpdateTicketService_1[_0x4a7345(0x210)])({'ticketId':_0x1035e3['id'],'ticketData':{'status':'pending','sendFarewellMessage':![],'amountUsedBotQueues':0x0},'companyId':_0x437d5f});},0xc8),setTimeout(async()=>{const _0x4b41db=_0x5ac2a6,{dateToClient:_0x33ead3}=(0x0,useDate_1[_0x4b41db(0x1f0)])(),_0x2ae150=_0x33ead3(new Date()[_0x4b41db(0x1bf)]()),_0x4f311d=(0x0,moment_1[_0x4b41db(0x210)])()['format'](),_0x407cf0=await ApiUsages_1[_0x4b41db(0x210)][_0x4b41db(0x1de)]({'where':{'dateUsed':_0x2ae150,'companyId':_0x437d5f}});if(_0x407cf0)await _0x407cf0[_0x4b41db(0x1e6)]({'usedPDF':_0x407cf0['dataValues'][_0x4b41db(0x1c7)]+0x1,'UsedOnDay':_0x407cf0[_0x4b41db(0x20f)][_0x4b41db(0x17f)]+0x1,'updatedAt':_0x4f311d});else{const _0x36185b=await ApiUsages_1['default'][_0x4b41db(0x1ab)]({'companyId':_0x437d5f,'dateUsed':_0x2ae150});await _0x36185b['update']({'usedPDF':_0x36185b[_0x4b41db(0x20f)][_0x4b41db(0x1c7)]+0x1,'UsedOnDay':_0x36185b[_0x4b41db(0x20f)]['UsedOnDay']+0x1,'updatedAt':_0x4f311d});}},0x64),_0x2a9de1[_0x5ac2a6(0x1df)]({'status':_0x5ac2a6(0x225)});};exports[a9_0x105992(0x171)]=indexLink;const index=async(_0x30b02c,_0x3b14fa)=>{const _0x493d7a=a9_0x105992,_0x579bb8=_0x30b02c['body'],{whatsappId:_0x4d5566}=_0x30b02c[_0x493d7a(0x20e)],{msdelay:_0x51575b}=_0x30b02c['body'],{body:_0x2e4484,quotedMsg:_0x4eb3f9}=_0x30b02c[_0x493d7a(0x20e)],_0x1cc511=_0x30b02c['files'],_0x20443f=_0x30b02c[_0x493d7a(0x23d)][_0x493d7a(0x194)],[,_0x2e5f7d]=_0x20443f['split']('\x20'),_0x4328dd=await Whatsapp_1['default'][_0x493d7a(0x1de)]({'where':{'token':_0x2e5f7d}}),_0x41ecd3=_0x4328dd[_0x493d7a(0x22d)];_0x579bb8[_0x493d7a(0x1b5)]=_0x579bb8[_0x493d7a(0x1b5)][_0x493d7a(0x198)]('-','')[_0x493d7a(0x198)]('\x20','');const _0x356748=Yup['object']()[_0x493d7a(0x1e1)]({'number':Yup[_0x493d7a(0x1ac)]()[_0x493d7a(0x1bb)]()[_0x493d7a(0x1d4)](/^\d+$/,_0x493d7a(0x200))});try{await _0x356748[_0x493d7a(0x1b2)](_0x579bb8);}catch(_0x2a0588){throw new AppError_1['default'](_0x2a0588['message']);}const _0x5ae0ee=await createContact(_0x4d5566,_0x41ecd3,_0x579bb8[_0x493d7a(0x1b5)]);return _0x1cc511?await Promise[_0x493d7a(0x18c)](_0x1cc511['map'](async _0x3abeac=>{await(0x0,SendWhatsAppMedia_1['default'])({'body':_0x2e4484,'media':_0x3abeac,'ticket':_0x5ae0ee});})):await(0x0,SendWhatsAppMessageAPI_1['default'])({'body':_0x2e4484,'ticket':_0x5ae0ee,'quotedMsg':_0x4eb3f9,'msdelay':_0x51575b}),setTimeout(async()=>{const _0x214a39=_0x493d7a;await(0x0,UpdateTicketService_1[_0x214a39(0x210)])({'ticketId':_0x5ae0ee['id'],'ticketData':{'status':_0x214a39(0x1d9),'sendFarewellMessage':![],'amountUsedBotQueues':0x0},'companyId':_0x41ecd3});},0x64),setTimeout(async()=>{const _0x2b9591=_0x493d7a,{dateToClient:_0x12c5a8}=(0x0,useDate_1[_0x2b9591(0x1f0)])(),_0x474375=_0x12c5a8(new Date()['toString']()),_0x23bc10=(0x0,moment_1[_0x2b9591(0x210)])()[_0x2b9591(0x1da)](),_0x3d2ebe=await ApiUsages_1[_0x2b9591(0x210)][_0x2b9591(0x1de)]({'where':{'dateUsed':_0x474375,'companyId':_0x41ecd3}});_0x3d2ebe?_0x1cc511?await Promise['all'](_0x1cc511[_0x2b9591(0x1f2)](async _0x1d2f7d=>{const _0x1794b4=_0x2b9591;console[_0x1794b4(0x18b)](_0x1794b4(0x1b1),_0x1d2f7d);const _0x179458=path_1['default'][_0x1794b4(0x237)](_0x1d2f7d[_0x1794b4(0x1eb)]);console[_0x1794b4(0x18b)](_0x1794b4(0x202),_0x179458);if(_0x1d2f7d[_0x1794b4(0x227)][_0x1794b4(0x185)](_0x1794b4(0x20a)))await _0x3d2ebe[_0x1794b4(0x1e6)]({'usedPDF':_0x3d2ebe[_0x1794b4(0x20f)][_0x1794b4(0x1c7)]+0x1,'UsedOnDay':_0x3d2ebe['dataValues']['UsedOnDay']+0x1,'updatedAt':_0x23bc10});else{if(_0x1d2f7d[_0x1794b4(0x227)]['includes']('image'))await _0x3d2ebe[_0x1794b4(0x1e6)]({'usedImage':_0x3d2ebe[_0x1794b4(0x20f)][_0x1794b4(0x1a4)]+0x1,'UsedOnDay':_0x3d2ebe[_0x1794b4(0x20f)][_0x1794b4(0x17f)]+0x1,'updatedAt':_0x23bc10});else _0x1d2f7d[_0x1794b4(0x227)][_0x1794b4(0x185)](_0x1794b4(0x1f7))?await _0x3d2ebe[_0x1794b4(0x1e6)]({'usedVideo':_0x3d2ebe[_0x1794b4(0x20f)][_0x1794b4(0x203)]+0x1,'UsedOnDay':_0x3d2ebe[_0x1794b4(0x20f)][_0x1794b4(0x17f)]+0x1,'updatedAt':_0x23bc10}):await _0x3d2ebe[_0x1794b4(0x1e6)]({'usedOther':_0x3d2ebe[_0x1794b4(0x20f)][_0x1794b4(0x1e2)]+0x1,'UsedOnDay':_0x3d2ebe[_0x1794b4(0x20f)][_0x1794b4(0x17f)]+0x1,'updatedAt':_0x23bc10});}})):await _0x3d2ebe['update']({'usedText':_0x3d2ebe[_0x2b9591(0x20f)][_0x2b9591(0x1d8)]+0x1,'UsedOnDay':_0x3d2ebe['dataValues']['UsedOnDay']+0x1,'updatedAt':_0x23bc10}):(await ApiUsages_1[_0x2b9591(0x210)][_0x2b9591(0x1ab)]({'companyId':_0x41ecd3,'dateUsed':_0x474375}),_0x1cc511?await Promise[_0x2b9591(0x18c)](_0x1cc511[_0x2b9591(0x1f2)](async _0xaea3c8=>{const _0x5ccca6=_0x2b9591;console[_0x5ccca6(0x18b)]('media',_0xaea3c8);const _0x5b4c64=path_1[_0x5ccca6(0x210)][_0x5ccca6(0x237)](_0xaea3c8[_0x5ccca6(0x1eb)]);console['log'](_0x5ccca6(0x202),_0x5b4c64);if(_0xaea3c8[_0x5ccca6(0x227)][_0x5ccca6(0x185)](_0x5ccca6(0x20a)))await _0x3d2ebe[_0x5ccca6(0x1e6)]({'usedPDF':_0x3d2ebe[_0x5ccca6(0x20f)][_0x5ccca6(0x1c7)]+0x1,'UsedOnDay':_0x3d2ebe[_0x5ccca6(0x20f)]['UsedOnDay']+0x1,'updatedAt':_0x23bc10});else{if(_0xaea3c8[_0x5ccca6(0x227)][_0x5ccca6(0x185)](_0x5ccca6(0x195)))await _0x3d2ebe[_0x5ccca6(0x1e6)]({'usedImage':_0x3d2ebe[_0x5ccca6(0x20f)][_0x5ccca6(0x1a4)]+0x1,'UsedOnDay':_0x3d2ebe[_0x5ccca6(0x20f)][_0x5ccca6(0x17f)]+0x1,'updatedAt':_0x23bc10});else _0xaea3c8[_0x5ccca6(0x227)]['includes'](_0x5ccca6(0x1f7))?await _0x3d2ebe[_0x5ccca6(0x1e6)]({'usedVideo':_0x3d2ebe[_0x5ccca6(0x20f)][_0x5ccca6(0x203)]+0x1,'UsedOnDay':_0x3d2ebe[_0x5ccca6(0x20f)]['UsedOnDay']+0x1,'updatedAt':_0x23bc10}):await _0x3d2ebe[_0x5ccca6(0x1e6)]({'usedOther':_0x3d2ebe[_0x5ccca6(0x20f)][_0x5ccca6(0x1e2)]+0x1,'UsedOnDay':_0x3d2ebe[_0x5ccca6(0x20f)][_0x5ccca6(0x17f)]+0x1,'updatedAt':_0x23bc10});}})):await _0x3d2ebe[_0x2b9591(0x1e6)]({'usedText':_0x3d2ebe[_0x2b9591(0x20f)][_0x2b9591(0x1d8)]+0x1,'UsedOnDay':_0x3d2ebe[_0x2b9591(0x20f)][_0x2b9591(0x17f)]+0x1,'updatedAt':_0x23bc10}));},0x64),_0x3b14fa[_0x493d7a(0x1df)]({'status':_0x493d7a(0x225)});};exports['index']=index;const indexImage=async(_0x43cc18,_0x59212c)=>{const _0x6476a3=a9_0x105992,_0x4b56fa=_0x43cc18[_0x6476a3(0x20e)],{whatsappId:_0x506227}=_0x43cc18[_0x6476a3(0x20e)],{msdelay:_0x2cbcfa}=_0x43cc18[_0x6476a3(0x20e)],_0x27439d=_0x43cc18[_0x6476a3(0x20e)]['url'],_0x1e977d=_0x43cc18['body'][_0x6476a3(0x17a)],_0x513d60=_0x43cc18['headers'][_0x6476a3(0x194)],[,_0x29e239]=_0x513d60[_0x6476a3(0x207)]('\x20'),_0x51aa86=await Whatsapp_1[_0x6476a3(0x210)][_0x6476a3(0x1de)]({'where':{'token':_0x29e239}}),_0x3f5c99=_0x51aa86[_0x6476a3(0x22d)];_0x4b56fa[_0x6476a3(0x1b5)]=_0x4b56fa[_0x6476a3(0x1b5)][_0x6476a3(0x198)]('-','')[_0x6476a3(0x198)]('\x20','');const _0x1c0d03=Yup[_0x6476a3(0x21d)]()['shape']({'number':Yup[_0x6476a3(0x1ac)]()[_0x6476a3(0x1bb)]()['matches'](/^\d+$/,_0x6476a3(0x200))});try{await _0x1c0d03[_0x6476a3(0x1b2)](_0x4b56fa);}catch(_0x4d3795){throw new AppError_1[(_0x6476a3(0x210))](_0x4d3795[_0x6476a3(0x174)]);}const _0x3f591c=await createContact(_0x506227,_0x3f5c99,_0x4b56fa['number']);return _0x27439d&&await(0x0,SendWhatsappMediaImage_1[_0x6476a3(0x210)])({'ticket':_0x3f591c,'url':_0x27439d,'caption':_0x1e977d,'msdelay':_0x2cbcfa}),setTimeout(async()=>{const _0x5db37c=_0x6476a3;await(0x0,UpdateTicketService_1[_0x5db37c(0x210)])({'ticketId':_0x3f591c['id'],'ticketData':{'status':'pending','sendFarewellMessage':![],'amountUsedBotQueues':0x0},'companyId':_0x3f5c99});},0x64),setTimeout(async()=>{const _0x235a0c=_0x6476a3,{dateToClient:_0x362a79}=(0x0,useDate_1[_0x235a0c(0x1f0)])(),_0x1db174=_0x362a79(new Date()['toString']()),_0x241269=(0x0,moment_1[_0x235a0c(0x210)])()[_0x235a0c(0x1da)](),_0x494ff5=await ApiUsages_1[_0x235a0c(0x210)][_0x235a0c(0x1de)]({'where':{'dateUsed':_0x1db174,'companyId':_0x3f5c99}});if(_0x494ff5)await _0x494ff5[_0x235a0c(0x1e6)]({'usedImage':_0x494ff5[_0x235a0c(0x20f)]['usedImage']+0x1,'UsedOnDay':_0x494ff5[_0x235a0c(0x20f)][_0x235a0c(0x17f)]+0x1,'updatedAt':_0x241269});else{const _0x31d958=await ApiUsages_1[_0x235a0c(0x210)]['create']({'companyId':_0x3f5c99,'dateUsed':_0x1db174});await _0x31d958[_0x235a0c(0x1e6)]({'usedImage':_0x31d958[_0x235a0c(0x20f)][_0x235a0c(0x1a4)]+0x1,'UsedOnDay':_0x31d958[_0x235a0c(0x20f)][_0x235a0c(0x17f)]+0x1,'updatedAt':_0x241269});}},0x64),_0x59212c[_0x6476a3(0x1df)]({'status':_0x6476a3(0x225)});};exports[a9_0x105992(0x223)]=indexImage;const checkNumber=async(_0x5621ac,_0x4e56d0)=>{const _0x5a7245=a9_0x105992,_0x1cf8e6=_0x5621ac[_0x5a7245(0x20e)],_0x5bcc11=_0x5621ac['headers'][_0x5a7245(0x194)],[,_0x544dac]=_0x5bcc11[_0x5a7245(0x207)]('\x20'),_0x25fae2=await Whatsapp_1[_0x5a7245(0x210)][_0x5a7245(0x1de)]({'where':{'token':_0x544dac}}),_0x330b26=_0x25fae2['companyId'],_0x3d7f32=_0x1cf8e6[_0x5a7245(0x1b5)][_0x5a7245(0x198)]('-','')[_0x5a7245(0x198)]('\x20',''),_0x346445=await(0x0,GetDefaultWhatsApp_1[_0x5a7245(0x210)])(_0x330b26),_0xa438df=(0x0,wbot_1[_0x5a7245(0x19e)])(_0x346445['id']),_0x56870e=createJid(_0x3d7f32);try{const [_0x512402]=await _0xa438df[_0x5a7245(0x1fb)](_0x56870e);if(_0x512402['exists'])return setTimeout(async()=>{const _0x2cd8de=_0x5a7245,{dateToClient:_0x556d02}=(0x0,useDate_1[_0x2cd8de(0x1f0)])(),_0x4777a2=_0x556d02(new Date()[_0x2cd8de(0x1bf)]()),_0x1149a5=(0x0,moment_1[_0x2cd8de(0x210)])()[_0x2cd8de(0x1da)](),_0x296939=await ApiUsages_1['default'][_0x2cd8de(0x1de)]({'where':{'dateUsed':_0x4777a2,'companyId':_0x330b26}});if(_0x296939)await _0x296939[_0x2cd8de(0x1e6)]({'usedCheckNumber':_0x296939[_0x2cd8de(0x20f)][_0x2cd8de(0x244)]+0x1,'UsedOnDay':_0x296939[_0x2cd8de(0x20f)][_0x2cd8de(0x17f)]+0x1,'updatedAt':_0x1149a5});else{const _0x53e5e3=await ApiUsages_1[_0x2cd8de(0x210)][_0x2cd8de(0x1ab)]({'companyId':_0x330b26,'dateUsed':_0x4777a2});await _0x53e5e3[_0x2cd8de(0x1e6)]({'usedCheckNumber':_0x53e5e3[_0x2cd8de(0x20f)]['usedCheckNumber']+0x1,'UsedOnDay':_0x53e5e3[_0x2cd8de(0x20f)][_0x2cd8de(0x17f)]+0x1,'updatedAt':_0x1149a5});}},0x64),_0x4e56d0[_0x5a7245(0x221)](0xc8)[_0x5a7245(0x172)]({'existsInWhatsapp':!![],'number':_0x3d7f32,'numberFormatted':_0x512402[_0x5a7245(0x18d)]});}catch(_0xb2c6d2){return _0x4e56d0['status'](0x190)['json']({'existsInWhatsapp':![],'number':_0x56870e,'error':_0x5a7245(0x1f5)});}};exports[a9_0x105992(0x205)]=checkNumber;const indexWhatsappsId=async(_0x44c67e,_0x120615)=>{const _0x45eb8a=a9_0x105992;return console['log'](_0x45eb8a(0x23c),_0x44c67e),console[_0x45eb8a(0x18b)](_0x45eb8a(0x23c),_0x44c67e['user']),_0x120615[_0x45eb8a(0x221)](0xc8)['json']('oi');};exports['indexWhatsappsId']=indexWhatsappsId;const updateQueueId=async(_0x47ddc0,_0x208e2d)=>{const _0x1018e8=a9_0x105992,{ticketId:_0x387e10}=_0x47ddc0[_0x1018e8(0x1f4)],{queueId:_0x6a09a6}=_0x47ddc0[_0x1018e8(0x20e)],_0x448258=_0x47ddc0[_0x1018e8(0x23d)]['authorization'],[,_0x11fed3]=_0x448258[_0x1018e8(0x207)]('\x20'),_0x38cbbb=await Whatsapp_1[_0x1018e8(0x210)][_0x1018e8(0x1de)]({'where':{'token':_0x11fed3}}),_0x44de9a=_0x38cbbb[_0x1018e8(0x22d)];try{const _0x4bcdb4=await Queue_1[_0x1018e8(0x210)][_0x1018e8(0x1de)]({'where':{'id':_0x6a09a6,'companyId':_0x44de9a}});if(!_0x4bcdb4)return _0x208e2d['status'](0x190)[_0x1018e8(0x172)]({'status':_0x1018e8(0x1c9),'error':_0x1018e8(0x1e5)});return await(0x0,UpdateTicketService_1[_0x1018e8(0x210)])({'ticketId':_0x387e10,'ticketData':{'queueId':_0x6a09a6},'companyId':_0x44de9a}),_0x208e2d[_0x1018e8(0x221)](0xc8)[_0x1018e8(0x172)]({'status':_0x1018e8(0x225)});}catch(_0x1852d8){return console[_0x1018e8(0x1a5)](_0x1852d8),_0x208e2d['status'](0x1f4)['json']({'status':_0x1018e8(0x1c9),'error':_0x1018e8(0x1e0)});}};exports[a9_0x105992(0x1ec)]=updateQueueId;const closeTicket=async(_0x40dc72,_0x56eb0b)=>{const _0x48fce6=a9_0x105992,_0x459e4c=_0x40dc72[_0x48fce6(0x23d)][_0x48fce6(0x194)],[,_0x844802]=_0x459e4c['split']('\x20'),_0x2ce7ca=await Whatsapp_1[_0x48fce6(0x210)][_0x48fce6(0x1de)]({'where':{'token':_0x844802}}),_0x5ca1ab=_0x2ce7ca[_0x48fce6(0x22d)],{ticketId:_0x64c303}=_0x40dc72[_0x48fce6(0x1f4)],_0x4dcb97=await(0x0,ShowTicketService_1[_0x48fce6(0x210)])(_0x64c303,_0x5ca1ab);_0x4dcb97['status']=_0x40dc72['body'][_0x48fce6(0x208)][_0x48fce6(0x221)],console[_0x48fce6(0x18b)](_0x4dcb97[_0x48fce6(0x221)]);const {ticket:_0x2f79b4}=await(0x0,UpdateTicketService_1['default'])({'ticketData':_0x4dcb97,'ticketId':_0x64c303,'companyId':_0x5ca1ab});return _0x56eb0b[_0x48fce6(0x221)](0xc8)[_0x48fce6(0x172)](_0x2f79b4);};exports[a9_0x105992(0x19a)]=closeTicket;function a9_0x5c29(){const _0x40d98d=['video','findOrCreateContacts','contact','facebookUserId','onWhatsApp','Acesso\x20não\x20autorizado.\x20Por\x20favor,\x20forneça\x20credenciais\x20válidas.','reload','active','__importStar','Invalid\x20number\x20format.\x20Only\x20numbers\x20is\x20allowed.','__esModule','type','usedVideo','charAt','checkNumber','facebookUserToken','split','ticketData','profilePicUrl','pdf','showApi','29806425ExGEqM','indexContacts','body','dataValues','default','5268BEiMpt','@g.us','lodash','test','deleteAll','19539UiKkSd','8EreRgO','makeid','whatsapp\x20#','SUCESSO','boolean','query','object','updateTicketTag','-mainchannel','Tag\x20already\x20associated\x20with\x20the\x20ticket','status','../services/ContactServices/CreateContactService','indexImage','-contact','SUCCESS','updateUsageStats','mimetype','15dOarba','../models/ApiUsages','configurable','date','path','companyId','../services/ContactServices/DeleteContactService','../services/InvoicesService/ShowInvoiceService','call','paid','updateContacts','Token\x20de\x20autorização\x20inválido','../services/TicketServices/ShowTicketService','storeContacts','arraybuffer','extname','847256QYpgTp','listTicketsByTag','length','../helpers/GetDefaultWhatsApp','req','headers','apply','removeAllContacts','../services/WbotServices/CheckNumber','Erro\x20ao\x20lidar\x20com\x20o\x20link\x20de\x20áudio','Internal\x20server\x20error','../models/Company','usedCheckNumber','isInteger','destroy','exists','../helpers/SetTicketMessagesAsRead','getIO','indexLink','json','(((.+)+)+)+$','message','random','findAll','delete','indexApi','@s.whatsapp.net','caption','extraInfo','ImportXLSContactsService','../models/Ticket','listContacts','UsedOnDay','defineProperty','Failed\x20to\x20remove\x20ticket\x20tag','whatsapp','../services/InvoicesService/ListInvoicesServices','SendPresenceStatus','includes','updateApi','blockCompany','url','readFileSync','hasOwnProperty','log','all','jid','index','Failed\x20to\x20update\x20ticket\x20tag','Legenda\x20do\x20áudio','indexWhatsappsId','writeFileSync','company','authorization','image','../services/ContactServices/GetContactService','prototype','replace','Tag\x20is\x20not\x20associated\x20with\x20the\x20ticket','closeTicket','parseInt','../services/ContactServices/ListContactsService','Contact\x20deleted','getWbot','966884wXQuJu','toggleDisableBotContacts','user','../services/ContactServices/ShowContactService','from','usedImage','error','Tag\x20does\x20not\x20belong\x20to\x20the\x20specified\x20company','showAllApi','../services/InvoicesService/UpdateInvoiceService','../models/User','findByPk','create','string','__setModuleDefault','queue','data','moment','media','validate','All\x20contacts\x20removed\x20successfully','get','number','getOwnPropertyDescriptor','./public/company','setDate','.mp3','removeContacts','required','showContacts','name','../services/TicketServices/FindOrCreateTicketService','toString','acceptAudioMessage','search','company-','../services/ContactServices/ImportXLSContactsService','listTicketsByCompany','uploadContacts','tags','usedPDF','683754dfJrTJ','ERROR','../services/WbotServices/GetProfilePicUrl','../services/WbotServices/SendWhatsAppMedia','5664981WNvhsv','../services/WbotServices/SendWhatsAppMessageLink','../services/WbotServices/SendWhatsAppMessageAPI','../models/Tag','OnWhatsAppDto','email','constructor','../services/TicketServices/UpdateTicketService','matches','../services/ContactServices/SimpleListService','createCompany','../models/Invoices','usedText','pending','format','updateCompany','ERRO','emit','findOne','send','Internal\x20Server\x20Error','shape','usedOther','files','2830BBcBgL','Invalid\x20queue\x20for\x20the\x20company','update','nullable','../models/TicketTag','floor','dueDate','originalname','updateQueueId','color','Company\x20not\x20found','handleAudioLink','useDate','../services/ContactServices/ToggleDisableBotService','map','../services/ContactServices/UpdateContactService','params','Not\x20exists\x20on\x20Whatsapp','8XvfKdU'];a9_0x5c29=function(){return _0x40d98d;};return a9_0x5c29();}const updateTicketTag=async(_0x11d532,_0xd371e1)=>{const _0x583f0f=a9_0x105992,{ticketId:_0x55cff2,tagId:_0x52aa4d}=_0x11d532['body'],_0x2c4ec1=_0x11d532[_0x583f0f(0x23d)][_0x583f0f(0x194)],[,_0x3bf4cc]=_0x2c4ec1[_0x583f0f(0x207)]('\x20');try{const _0x4f97d7=await Whatsapp_1['default'][_0x583f0f(0x1de)]({'where':{'token':_0x3bf4cc}}),_0x3fd060=_0x4f97d7[_0x583f0f(0x22d)],_0x3a9b2a=await Tag_1['default'][_0x583f0f(0x1de)]({'where':{'id':_0x52aa4d,'companyId':_0x3fd060}});if(!_0x3a9b2a)return _0xd371e1[_0x583f0f(0x221)](0x190)[_0x583f0f(0x172)]({'status':_0x583f0f(0x1c9),'error':'Tag\x20does\x20not\x20belong\x20to\x20the\x20specified\x20company'});const _0x399c24=await TicketTag_1[_0x583f0f(0x210)]['findOne']({'where':{'ticketId':_0x55cff2,'tagId':_0x52aa4d}});if(_0x399c24)return _0xd371e1['status'](0x190)[_0x583f0f(0x172)]({'status':'ERROR','error':_0x583f0f(0x220)});const _0x2f2e1a=await TicketTag_1[_0x583f0f(0x210)]['create']({'ticketId':_0x55cff2,'tagId':_0x52aa4d});return _0xd371e1['status'](0xc8)[_0x583f0f(0x172)]({'status':_0x583f0f(0x225),'ticketTag':_0x2f2e1a});}catch(_0x14659a){return console[_0x583f0f(0x1a5)](_0x14659a),_0xd371e1[_0x583f0f(0x221)](0x1f4)[_0x583f0f(0x172)]({'status':_0x583f0f(0x1c9),'error':_0x583f0f(0x18f)});}};exports[a9_0x105992(0x21e)]=updateTicketTag;const removeTicketTag=async(_0x14d668,_0x1c0089)=>{const _0x122703=a9_0x105992,{ticketId:_0x35597e,tagId:_0x4688ac}=_0x14d668['body'];try{const _0x17b66e=await TicketTag_1[_0x122703(0x210)][_0x122703(0x1de)]({'where':{'ticketId':_0x35597e,'tagId':_0x4688ac}});if(!_0x17b66e)return _0x1c0089[_0x122703(0x221)](0x190)['json']({'status':_0x122703(0x1c9),'error':_0x122703(0x199)});return await _0x17b66e[_0x122703(0x16d)](),_0x1c0089[_0x122703(0x221)](0xc8)[_0x122703(0x172)]({'status':_0x122703(0x225)});}catch(_0x5e2d25){return console[_0x122703(0x1a5)](_0x5e2d25),_0x1c0089[_0x122703(0x221)](0x1f4)[_0x122703(0x172)]({'status':_0x122703(0x1c9),'error':_0x122703(0x181)});}};exports['removeTicketTag']=removeTicketTag;const listTicketsByCompany=async(_0x2bf4f4,_0x2f5365)=>{const _0x38276e=a9_0x105992,_0x1959a8=_0x2bf4f4[_0x38276e(0x23d)][_0x38276e(0x194)],[,_0x107849]=_0x1959a8[_0x38276e(0x207)]('\x20'),_0x3c0f74=await Whatsapp_1[_0x38276e(0x210)][_0x38276e(0x1de)]({'where':{'token':_0x107849}}),_0x4c3f77=_0x3c0f74[_0x38276e(0x22d)];try{const _0x17d326=await Ticket_1[_0x38276e(0x210)][_0x38276e(0x176)]({'where':{'companyId':_0x4c3f77},'include':[{'model':Contact_1[_0x38276e(0x210)],'as':_0x38276e(0x1f9),'attributes':['id',_0x38276e(0x1bd),_0x38276e(0x1b5),_0x38276e(0x1d1),_0x38276e(0x209),_0x38276e(0x1c0),_0x38276e(0x1fe),'disableBot'],'include':['extraInfo']},{'model':Queue_1[_0x38276e(0x210)],'as':_0x38276e(0x1ae),'attributes':['id','name',_0x38276e(0x1ed)]},{'model':User_1['default'],'as':_0x38276e(0x1a1),'attributes':['id',_0x38276e(0x1bd)]},{'model':Tag_1[_0x38276e(0x210)],'as':_0x38276e(0x1c6),'attributes':['id','name',_0x38276e(0x1ed)]},{'model':Whatsapp_1[_0x38276e(0x210)],'as':_0x38276e(0x182),'attributes':['name',_0x38276e(0x206),_0x38276e(0x1fa)]},{'model':Company_1[_0x38276e(0x210)],'as':_0x38276e(0x193),'attributes':[_0x38276e(0x1bd)]}]});return _0x2f5365[_0x38276e(0x221)](0xc8)[_0x38276e(0x172)]({'status':_0x38276e(0x225),'tickets':_0x17d326});}catch(_0x3a3e9c){return console['error'](_0x3a3e9c),_0x2f5365[_0x38276e(0x221)](0x1f4)['json']({'status':_0x38276e(0x1c9),'error':_0x38276e(0x1e0)});}};exports[a9_0x105992(0x1c4)]=listTicketsByCompany;const listTicketsByTag=async(_0x38a2de,_0x146c15)=>{const _0x155d17=a9_0x105992,{tagId:_0x32a631}=_0x38a2de[_0x155d17(0x1f4)],_0x33862e=_0x38a2de['headers'][_0x155d17(0x194)],[,_0xb15d3f]=_0x33862e['split']('\x20');try{const _0x504b86=await Whatsapp_1['default']['findOne']({'where':{'token':_0xb15d3f}}),_0x4cc827=_0x504b86['companyId'],_0x119454=await Tag_1[_0x155d17(0x210)][_0x155d17(0x1de)]({'where':{'id':_0x32a631,'companyId':_0x4cc827}});if(!_0x119454)return _0x146c15['status'](0x190)[_0x155d17(0x172)]({'status':_0x155d17(0x1c9),'error':_0x155d17(0x1a6)});const _0x518f0c=await Ticket_1[_0x155d17(0x210)][_0x155d17(0x176)]({'include':[{'model':Tag_1[_0x155d17(0x210)],'as':_0x155d17(0x1c6),'attributes':['id',_0x155d17(0x1bd)],'through':{'attributes':[],'where':{'tagId':_0x32a631}}},{'model':Contact_1['default'],'as':_0x155d17(0x1f9),'attributes':['id',_0x155d17(0x1bd),'number',_0x155d17(0x1d1),_0x155d17(0x209),_0x155d17(0x1c0),'active','disableBot'],'include':[_0x155d17(0x17b)]},{'model':Queue_1['default'],'as':'queue','attributes':['id',_0x155d17(0x1bd),_0x155d17(0x1ed)]},{'model':User_1[_0x155d17(0x210)],'as':_0x155d17(0x1a1),'attributes':['id',_0x155d17(0x1bd)]},{'model':Whatsapp_1[_0x155d17(0x210)],'as':_0x155d17(0x182),'attributes':[_0x155d17(0x1bd),'facebookUserToken',_0x155d17(0x1fa)]},{'model':Company_1['default'],'as':'company','attributes':['name']}],'where':{'companyId':_0x4cc827,'$tags.id$':_0x32a631}});return _0x146c15['status'](0xc8)[_0x155d17(0x172)]({'status':_0x155d17(0x225),'tickets':_0x518f0c});}catch(_0x4ae249){return console[_0x155d17(0x1a5)](_0x4ae249),_0x146c15[_0x155d17(0x221)](0x1f4)[_0x155d17(0x172)]({'status':'ERROR','error':_0x155d17(0x1e0)});}};exports[a9_0x105992(0x239)]=listTicketsByTag;const listTicketsByTagIsAuth=async(_0x15515c,_0x323c1d)=>{const _0x3fbabe=a9_0x105992,{tagId:_0x5153d7}=_0x15515c['params'];try{const _0x43df8a=await Ticket_1[_0x3fbabe(0x210)]['findAll']({'include':[{'model':Contact_1[_0x3fbabe(0x210)],'as':_0x3fbabe(0x1f9),'attributes':[_0x3fbabe(0x1bd),_0x3fbabe(0x1b5),_0x3fbabe(0x1d1)],'include':[_0x3fbabe(0x17b)]},{'model':Tag_1['default'],'as':_0x3fbabe(0x1c6),'attributes':['id','name','color'],'where':{'id':_0x5153d7}},{'model':Whatsapp_1[_0x3fbabe(0x210)],'as':_0x3fbabe(0x182),'attributes':[_0x3fbabe(0x1bd),_0x3fbabe(0x206),_0x3fbabe(0x1fa)]},{'model':Company_1[_0x3fbabe(0x210)],'as':_0x3fbabe(0x193),'attributes':[_0x3fbabe(0x1bd)]}]});return _0x323c1d[_0x3fbabe(0x221)](0xc8)[_0x3fbabe(0x172)]({'status':'SUCCESS','tickets':_0x43df8a});}catch(_0x2752e8){return console[_0x3fbabe(0x1a5)](_0x2752e8),_0x323c1d[_0x3fbabe(0x221)](0x1f4)['json']({'status':_0x3fbabe(0x1c9),'error':_0x3fbabe(0x1e0)});}};exports['listTicketsByTagIsAuth']=listTicketsByTagIsAuth;function makeid(_0x35e01f){const _0x1e5262=a9_0x105992;var _0x579bbf='',_0x54f46d='ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789',_0x5e2744=_0x54f46d[_0x1e5262(0x23a)];for(var _0x4e25a9=0x0;_0x4e25a9<_0x35e01f;_0x4e25a9++){_0x579bbf+=_0x54f46d[_0x1e5262(0x204)](Math[_0x1e5262(0x1e9)](Math[_0x1e5262(0x175)]()*_0x5e2744));}return _0x579bbf;}exports['makeid']=makeid;const handleAudioLink=async(_0x41790b,_0x5c0e6e)=>{const _0x33f1ed=a9_0x105992,{link:_0xe67983,contactNumber:_0x23d62d}=_0x41790b[_0x33f1ed(0x20e)];try{const _0x3a2fdd=_0x41790b['headers'][_0x33f1ed(0x194)],[,_0x476008]=_0x3a2fdd[_0x33f1ed(0x207)]('\x20'),_0x4ed5dc=await Whatsapp_1[_0x33f1ed(0x210)][_0x33f1ed(0x1de)]({'where':{'token':_0x476008}}),_0xb6fea=_0x4ed5dc[_0x33f1ed(0x22d)],_0x246e55=await(0x0,GetDefaultWhatsApp_1[_0x33f1ed(0x210)])(_0xb6fea),_0x467d99=(0x0,wbot_1[_0x33f1ed(0x19e)])(_0x246e55['id']),_0x231323=_0x33f1ed(0x1b7)+_0xb6fea+'/'+makeid(0xa)+_0x33f1ed(0x1b9);if(!_0x4ed5dc)return _0x5c0e6e[_0x33f1ed(0x221)](0x191)[_0x33f1ed(0x172)]({'status':'ERRO','error':_0x33f1ed(0x233)});const _0x23e67a=await axios_1[_0x33f1ed(0x210)][_0x33f1ed(0x1b4)](_0xe67983,{'responseType':_0x33f1ed(0x236)});fs_1[_0x33f1ed(0x210)][_0x33f1ed(0x192)](_0x231323,Buffer[_0x33f1ed(0x1a3)](_0x23e67a[_0x33f1ed(0x1af)]));const _0x5c1f99=_0x33f1ed(0x190);return await(0x0,SendPresenceStatus_1[_0x33f1ed(0x184)])(_0x467d99,_0x23d62d),await _0x467d99['sendMessage'](_0x23d62d+_0x33f1ed(0x179),{'audio':fs_1[_0x33f1ed(0x210)][_0x33f1ed(0x189)](_0x231323),'fileName':_0x5c1f99,'caption':_0x5c1f99,'mimetype':'audio/mp4','ptt':!![]}),_0x5c0e6e[_0x33f1ed(0x221)](0xc8)[_0x33f1ed(0x172)]({'status':_0x33f1ed(0x21a)});}catch(_0x45cb14){return console[_0x33f1ed(0x1a5)](_0x45cb14),_0x5c0e6e[_0x33f1ed(0x221)](0x1f4)['json']({'status':'ERRO','error':_0x33f1ed(0x241)});}};exports[a9_0x105992(0x1ef)]=handleAudioLink;const indexApi=async(_0x5a3ac8,_0x24efb3)=>{const _0x569393=a9_0x105992,_0xf89151=_0x5a3ac8[_0x569393(0x23d)][_0x569393(0x194)],[,_0x2a8d55]=_0xf89151[_0x569393(0x207)]('\x20'),_0x1d7f2f=await Whatsapp_1[_0x569393(0x210)]['findOne']({'where':{'token':_0x2a8d55}}),_0x2e4853=_0x1d7f2f[_0x569393(0x22d)],{searchParam:_0x13a60a,pageNumber:_0x286c68}=_0x5a3ac8[_0x569393(0x21c)];if(_0x2e4853===0x1){const {invoices:_0x292269,count:_0x28f77e,hasMore:_0x15e337}=await(0x0,ListInvoicesServices_1[_0x569393(0x210)])({'searchParam':_0x13a60a,'pageNumber':_0x286c68});return _0x24efb3[_0x569393(0x172)]({'invoices':_0x292269,'count':_0x28f77e,'hasMore':_0x15e337});}else return _0x24efb3['status'](0x191)[_0x569393(0x172)]({'status':_0x569393(0x1dc),'error':_0x569393(0x1fc)});};exports[a9_0x105992(0x178)]=indexApi;const showApi=async(_0x511ff1,_0x3e5521)=>{const _0x3790da=a9_0x105992,_0x43ed34=_0x511ff1[_0x3790da(0x23d)][_0x3790da(0x194)],[,_0x1e7a29]=_0x43ed34[_0x3790da(0x207)]('\x20'),_0x53460c=await Whatsapp_1[_0x3790da(0x210)]['findOne']({'where':{'token':_0x1e7a29}}),_0x4fea7e=_0x53460c[_0x3790da(0x22d)],{Invoiceid:_0x2b6f47}=_0x511ff1['params'],_0x4b9a04=await(0x0,ShowInvoiceService_1[_0x3790da(0x210)])(_0x2b6f47);return _0x3e5521['status'](0xc8)[_0x3790da(0x172)](_0x4b9a04);};exports[a9_0x105992(0x20b)]=showApi;const showAllApi=async(_0x3918f8,_0x1388dc)=>{const _0x4f85cf=a9_0x105992;try{const _0x351e20=_0x3918f8[_0x4f85cf(0x23d)][_0x4f85cf(0x194)],[,_0x1cd83b]=_0x351e20[_0x4f85cf(0x207)]('\x20'),_0x2b5aed=await Whatsapp_1['default']['findOne']({'where':{'token':_0x1cd83b}}),_0x3d7b54=_0x2b5aed[_0x4f85cf(0x22d)],{companyId:_0x29350a,status:_0x257929}=_0x3918f8[_0x4f85cf(0x20e)];if(_0x3d7b54===0x1){const _0x10351e=await Invoices_1[_0x4f85cf(0x210)]['findAll']({'where':{'companyId':_0x29350a,'status':_0x257929}});return _0x1388dc[_0x4f85cf(0x221)](0xc8)[_0x4f85cf(0x172)](_0x10351e);}else return _0x1388dc['status'](0x191)[_0x4f85cf(0x172)]({'status':'ERRO','error':_0x4f85cf(0x1fc)});}catch(_0x2f0cc4){return console['error']('Erro\x20ao\x20buscar\x20invoices:',_0x2f0cc4),_0x1388dc[_0x4f85cf(0x221)](0x1f4)[_0x4f85cf(0x172)]({'error':'Erro\x20ao\x20buscar\x20invoices'});}};exports[a9_0x105992(0x1a7)]=showAllApi;function a9_0x1975(_0x2107cf,_0x1fee0e){const _0x3d9153=a9_0x5c29();return a9_0x1975=function(_0x3a31e9,_0xba81b5){_0x3a31e9=_0x3a31e9-0x16d;let _0x5c29e1=_0x3d9153[_0x3a31e9];return _0x5c29e1;},a9_0x1975(_0x2107cf,_0x1fee0e);}const updateApi=async(_0x1337b7,_0x2dfe08)=>{const _0x2116af=a9_0x105992,_0x1c2ccd=_0x1337b7[_0x2116af(0x23d)][_0x2116af(0x194)],[,_0xb6ffbf]=_0x1c2ccd[_0x2116af(0x207)]('\x20'),_0x450431=await Whatsapp_1[_0x2116af(0x210)][_0x2116af(0x1de)]({'where':{'token':_0xb6ffbf}}),_0x1a6220=_0x450431[_0x2116af(0x22d)],_0x3760b0=_0x1337b7[_0x2116af(0x20e)],_0x5d4553=Yup['object']()['shape']({'name':Yup[_0x2116af(0x1ac)]()});try{await _0x5d4553['validate'](_0x3760b0);}catch(_0x41423){throw new AppError_1[(_0x2116af(0x210))](_0x41423[_0x2116af(0x174)]);}const {id:_0xf68d7c,status:_0x54033b}=_0x3760b0;if(_0x1a6220===0x1){const _0x3ffe0c=await(0x0,UpdateInvoiceService_1[_0x2116af(0x210)])({'id':_0xf68d7c,'status':_0x54033b}),_0x55c797=await Invoices_1[_0x2116af(0x210)][_0x2116af(0x1aa)](_0xf68d7c),_0x5c43e0=_0x55c797[_0x2116af(0x22d)],_0x17d588=await Company_1[_0x2116af(0x210)]['findByPk'](_0x5c43e0),_0x57a4cf=new Date(_0x17d588[_0x2116af(0x1ea)]);_0x57a4cf[_0x2116af(0x1b8)](_0x57a4cf['getDate']()+0x1e);const _0x350402=_0x57a4cf['toISOString']()[_0x2116af(0x207)]('T')[0x0];if(_0x17d588){await _0x17d588[_0x2116af(0x1e6)]({'dueDate':_0x350402});const _0x4a9c45=await _0x55c797['update']({'id':_0xf68d7c,'status':_0x2116af(0x231)});await _0x17d588[_0x2116af(0x1fd)]();const _0x12778e=(0x0,socket_1[_0x2116af(0x170)])(),_0x5eb1d5=await Company_1[_0x2116af(0x210)][_0x2116af(0x1de)]({'where':{'id':_0x5c43e0}});}return _0x2dfe08[_0x2116af(0x221)](0xc8)[_0x2116af(0x172)](_0x3ffe0c);}else return _0x2dfe08[_0x2116af(0x221)](0x191)[_0x2116af(0x172)]({'status':_0x2116af(0x1dc),'error':_0x2116af(0x1fc)});};exports[a9_0x105992(0x186)]=updateApi;const updateUsageStats=async(_0x30d3fb,_0x479a89)=>{const _0x4372f5=a9_0x105992;if(!_0x30d3fb[_0x4372f5(0x1a1)]||!_0x30d3fb[_0x4372f5(0x1a1)]['companyId'])return _0x479a89[_0x4372f5(0x221)](0x190)[_0x4372f5(0x1df)]({'status':_0x4372f5(0x1c9),'message':'Missing\x20user\x20or\x20companyId'});const {companyId:_0x26289b}=_0x30d3fb['user'],{contactId:_0x3c094a}=_0x30d3fb[_0x4372f5(0x1f4)];return setTimeout(async()=>{const _0x32c9f5=_0x4372f5,{dateToClient:_0x5ba32f}=(0x0,useDate_1[_0x32c9f5(0x1f0)])(),_0x1db326=_0x5ba32f(new Date()['toString']()),_0x171ee4=(0x0,moment_1[_0x32c9f5(0x210)])()['format']();try{const _0x48e36d=await ApiUsages_1[_0x32c9f5(0x210)][_0x32c9f5(0x1de)]({'where':{'dateUsed':_0x1db326,'companyId':_0x26289b}});if(_0x48e36d)await _0x48e36d[_0x32c9f5(0x1e6)]({'usedOther':_0x48e36d[_0x32c9f5(0x20f)][_0x32c9f5(0x1e2)]+0x1,'UsedOnDay':_0x48e36d[_0x32c9f5(0x20f)][_0x32c9f5(0x17f)]+0x1,'updatedAt':_0x171ee4});else{const _0x4dca25=await ApiUsages_1['default'][_0x32c9f5(0x1ab)]({'companyId':_0x26289b,'dateUsed':_0x1db326});await _0x4dca25[_0x32c9f5(0x1e6)]({'usedOther':_0x4dca25[_0x32c9f5(0x20f)][_0x32c9f5(0x1e2)]+0x1,'UsedOnDay':_0x4dca25[_0x32c9f5(0x20f)][_0x32c9f5(0x17f)]+0x1,'updatedAt':_0x171ee4});}}catch(_0x54c831){return console[_0x32c9f5(0x1a5)]('Error\x20updating\x20usage\x20stats:',_0x54c831),_0x479a89[_0x32c9f5(0x221)](0x1f4)[_0x32c9f5(0x1df)]({'status':_0x32c9f5(0x1c9),'message':_0x32c9f5(0x242)});}},0x64),_0x479a89[_0x4372f5(0x1df)]({'status':_0x4372f5(0x225)});};exports[a9_0x105992(0x226)]=updateUsageStats;const indexContacts=async(_0x3f1cd5,_0x560666)=>{const _0x5d2e40=a9_0x105992,{searchParam:_0x4152d0,pageNumber:_0x1c893f}=_0x3f1cd5[_0x5d2e40(0x21c)],{companyId:_0x32544f}=_0x3f1cd5[_0x5d2e40(0x1a1)],{contacts:_0x291d10,count:_0x470ff4,hasMore:_0x474d5f}=await(0x0,ListContactsService_1['default'])({'searchParam':_0x4152d0,'pageNumber':_0x1c893f,'companyId':_0x32544f});return _0x560666[_0x5d2e40(0x172)]({'contacts':_0x291d10,'count':_0x470ff4,'hasMore':_0x474d5f});};exports[a9_0x105992(0x20d)]=indexContacts;const listContacts=async(_0x4b1155,_0x3c11d8)=>{const _0x2eae58=a9_0x105992,{name:_0x117a3c}=_0x4b1155[_0x2eae58(0x21c)],{companyId:_0x2fc0d0}=_0x4b1155['user'],_0x53ad60=await(0x0,SimpleListService_1['default'])({'name':_0x117a3c,'companyId':_0x2fc0d0});return _0x3c11d8['json'](_0x53ad60);};exports['listContacts']=listContacts;const showContacts=async(_0x4f4c8b,_0x5bf377)=>{const _0xd7d8d2=a9_0x105992,{contactId:_0x15e5b3}=_0x4f4c8b[_0xd7d8d2(0x1f4)],{companyId:_0x50b5aa}=_0x4f4c8b[_0xd7d8d2(0x1a1)],_0x30f316=await(0x0,ShowContactService_1['default'])(_0x15e5b3,_0x50b5aa);return _0x5bf377[_0xd7d8d2(0x221)](0xc8)[_0xd7d8d2(0x172)](_0x30f316);};exports['showContacts']=showContacts;const findOrCreateContacts=async(_0x5bdd2f,_0x304b65)=>{const _0x13512f=a9_0x105992,{name:_0x255bfb,number:_0x5241c2}=_0x5bdd2f[_0x13512f(0x20e)],{companyId:_0x33c6ef}=_0x5bdd2f['user'],_0x29b0b4=await(0x0,GetContactService_1['default'])({'name':_0x255bfb,'number':_0x5241c2,'companyId':_0x33c6ef});return _0x304b65[_0x13512f(0x221)](0xc8)[_0x13512f(0x172)](_0x29b0b4);};exports[a9_0x105992(0x1f8)]=findOrCreateContacts;const storeContacts=async(_0xa43eb4,_0x28163a)=>{const _0x1457ae=a9_0x105992,{companyId:_0xb9e5d1}=_0xa43eb4[_0x1457ae(0x1a1)],_0x5c6c6c=_0xa43eb4[_0x1457ae(0x20e)];_0x5c6c6c['number']=_0x5c6c6c[_0x1457ae(0x1b5)]['replace']('-','')['replace']('\x20','');const _0x89b3f0=Yup[_0x1457ae(0x21d)]()[_0x1457ae(0x1e1)]({'name':Yup['string']()[_0x1457ae(0x1bb)](),'number':Yup[_0x1457ae(0x1ac)]()[_0x1457ae(0x1bb)]()[_0x1457ae(0x1d4)](/^\d+$/,_0x1457ae(0x200))});try{await _0x89b3f0[_0x1457ae(0x1b2)](_0x5c6c6c);}catch(_0x508484){throw new AppError_1[(_0x1457ae(0x210))](_0x508484['message']);}await(0x0,CheckIsValidContact_1[_0x1457ae(0x210)])(_0x5c6c6c[_0x1457ae(0x1b5)],_0xb9e5d1);const _0x287fb8=await(0x0,CheckNumber_1[_0x1457ae(0x210)])(_0x5c6c6c[_0x1457ae(0x1b5)],_0xb9e5d1),_0x24b2dc=_0x287fb8[_0x1457ae(0x18d)][_0x1457ae(0x198)](/\D/g,'');_0x5c6c6c[_0x1457ae(0x1b5)]=_0x24b2dc;const _0x44969a=await(0x0,CreateContactService_1[_0x1457ae(0x210)])({..._0x5c6c6c,'companyId':_0xb9e5d1}),_0x1336f2=(0x0,socket_1[_0x1457ae(0x170)])();return _0x1336f2[_0x1457ae(0x1dd)](_0x1457ae(0x1c2)+_0xb9e5d1+_0x1457ae(0x224),{'action':'create','contact':_0x44969a}),_0x28163a[_0x1457ae(0x221)](0xc8)[_0x1457ae(0x172)](_0x44969a);};exports['storeContacts']=storeContacts;const removeAllContacts=async(_0x5eaee5,_0x2d68ff)=>{const _0x22253a=a9_0x105992,{companyId:_0x4f28c0}=_0x5eaee5[_0x22253a(0x1a1)];try{await Contact_1[_0x22253a(0x210)][_0x22253a(0x16d)]({'where':{'companyId':_0x4f28c0}});const _0x86fe42=(0x0,socket_1[_0x22253a(0x170)])();return _0x86fe42[_0x22253a(0x1dd)]('company-'+_0x4f28c0+_0x22253a(0x224),{'action':_0x22253a(0x215)}),setTimeout(async()=>{const _0x4fd208=_0x22253a,{dateToClient:_0x5130f1}=(0x0,useDate_1[_0x4fd208(0x1f0)])(),_0x1a1878=_0x5130f1(new Date()['toString']()),_0x41514c=(0x0,moment_1[_0x4fd208(0x210)])()[_0x4fd208(0x1da)]();try{const _0x46a740=await ApiUsages_1[_0x4fd208(0x210)][_0x4fd208(0x1de)]({'where':{'dateUsed':_0x1a1878,'companyId':_0x4f28c0}});if(_0x46a740)await _0x46a740['update']({'usedOther':_0x46a740[_0x4fd208(0x20f)]['usedOther']+0x1,'UsedOnDay':_0x46a740[_0x4fd208(0x20f)][_0x4fd208(0x17f)]+0x1,'updatedAt':_0x41514c});else{const _0x12dd82=await ApiUsages_1[_0x4fd208(0x210)][_0x4fd208(0x1ab)]({'companyId':_0x4f28c0,'dateUsed':_0x1a1878});await _0x12dd82[_0x4fd208(0x1e6)]({'usedOther':_0x12dd82[_0x4fd208(0x20f)]['usedOther']+0x1,'UsedOnDay':_0x12dd82[_0x4fd208(0x20f)][_0x4fd208(0x17f)]+0x1,'updatedAt':_0x41514c});}}catch(_0x595b41){return console[_0x4fd208(0x1a5)]('Error\x20updating\x20usage\x20stats:',_0x595b41),_0x2d68ff[_0x4fd208(0x221)](0x1f4)[_0x4fd208(0x1df)]({'status':'ERROR','message':_0x4fd208(0x242)});}},0x64),_0x2d68ff[_0x22253a(0x221)](0xc8)['send']({'status':_0x22253a(0x225),'message':_0x22253a(0x1b3)});}catch(_0x56d17b){return console[_0x22253a(0x1a5)]('Error\x20removing\x20all\x20contacts:',_0x56d17b),_0x2d68ff[_0x22253a(0x221)](0x1f4)[_0x22253a(0x1df)]({'status':'ERROR','message':'Internal\x20server\x20error'});}};exports[a9_0x105992(0x23f)]=removeAllContacts;const updateContacts=async(_0x3e319f,_0x1c17a1)=>{const _0x5cad08=a9_0x105992,_0x1f811d=_0x3e319f[_0x5cad08(0x20e)],{companyId:_0x588539}=_0x3e319f[_0x5cad08(0x1a1)],_0x16ea9b=Yup[_0x5cad08(0x21d)]()[_0x5cad08(0x1e1)]({'name':Yup[_0x5cad08(0x1ac)](),'number':Yup[_0x5cad08(0x1ac)]()[_0x5cad08(0x1d4)](/^\d+$/,_0x5cad08(0x200))});try{await _0x16ea9b[_0x5cad08(0x1b2)](_0x1f811d);}catch(_0xa28ae4){throw new AppError_1[(_0x5cad08(0x210))](_0xa28ae4[_0x5cad08(0x174)]);}await(0x0,CheckIsValidContact_1[_0x5cad08(0x210)])(_0x1f811d[_0x5cad08(0x1b5)],_0x588539);const _0x54af48=await(0x0,CheckNumber_1[_0x5cad08(0x210)])(_0x1f811d[_0x5cad08(0x1b5)],_0x588539),_0x384826=_0x54af48[_0x5cad08(0x18d)][_0x5cad08(0x198)](/\D/g,'');_0x1f811d[_0x5cad08(0x1b5)]=_0x384826;const {contactId:_0x49a570}=_0x3e319f[_0x5cad08(0x1f4)],_0xe28f3b=await(0x0,UpdateContactService_1[_0x5cad08(0x210)])({'contactData':_0x1f811d,'contactId':_0x49a570,'companyId':_0x588539}),_0x1fb512=(0x0,socket_1[_0x5cad08(0x170)])();return _0x1fb512[_0x5cad08(0x1dd)](_0x5cad08(0x1c2)+_0x588539+_0x5cad08(0x224),{'action':_0x5cad08(0x1e6),'contact':_0xe28f3b}),_0x1c17a1[_0x5cad08(0x221)](0xc8)[_0x5cad08(0x172)](_0xe28f3b);};exports['updateContacts']=updateContacts;const removeContacts=async(_0x40742c,_0x532ddb)=>{const _0x5757a5=a9_0x105992,{contactId:_0x461845}=_0x40742c['params'],{companyId:_0x3fc20c}=_0x40742c[_0x5757a5(0x1a1)];await(0x0,ShowContactService_1[_0x5757a5(0x210)])(_0x461845,_0x3fc20c),await(0x0,DeleteContactService_1[_0x5757a5(0x210)])(_0x461845);const _0x5b630b=(0x0,socket_1[_0x5757a5(0x170)])();return _0x5b630b[_0x5757a5(0x1dd)](_0x5757a5(0x1c2)+_0x3fc20c+_0x5757a5(0x224),{'action':_0x5757a5(0x177),'contactId':_0x461845}),_0x532ddb['status'](0xc8)['json']({'message':_0x5757a5(0x19d)});};exports['removeContacts']=removeContacts;const uploadContacts=async(_0x1be21b,_0x1570b2)=>{const _0x39f9fb=a9_0x105992,_0x4958ad=_0x1be21b[_0x39f9fb(0x1e3)],_0x4ea1b9=(0x0,lodash_1['head'])(_0x4958ad),{companyId:_0x54f85a}=_0x1be21b[_0x39f9fb(0x1a1)],_0x24d63a=await(0x0,ImportXLSContactsService_1[_0x39f9fb(0x17c)])(_0x54f85a,_0x4ea1b9),_0x67b69d=(0x0,socket_1[_0x39f9fb(0x170)])(),_0x3a2b21={'action':'reload','records':_0x24d63a};return _0x67b69d['to']('company-'+_0x54f85a+_0x39f9fb(0x21f))['emit'](_0x39f9fb(0x1c2)+_0x54f85a+_0x39f9fb(0x224),_0x3a2b21),_0x1570b2['status'](0xc8)[_0x39f9fb(0x172)](_0x24d63a);};exports['uploadContacts']=uploadContacts;const toggleDisableBotContacts=async(_0x2525b2,_0x49bbae)=>{const _0x3633eb=a9_0x105992,{contactId:_0x255f91}=_0x2525b2[_0x3633eb(0x1f4)],{companyId:_0x5ec48d}=_0x2525b2[_0x3633eb(0x1a1)],_0x40e219=await(0x0,ToggleDisableBotService_1['default'])(_0x255f91,_0x5ec48d),_0x2f01b2=(0x0,socket_1[_0x3633eb(0x170)])();return _0x2f01b2['emit'](_0x3633eb(0x1c2)+_0x5ec48d+_0x3633eb(0x224),{'action':_0x3633eb(0x1e6),'contact':_0x40e219}),_0x49bbae[_0x3633eb(0x221)](0xc8)['json'](_0x40e219);};exports[a9_0x105992(0x1a0)]=toggleDisableBotContacts;