const a9_0x1194e2=a9_0x5e0c;(function(_0x4e89d0,_0x3cef3c){const _0x1ba814=a9_0x5e0c,_0x22f098=_0x4e89d0();while(!![]){try{const _0x16b9fa=-parseInt(_0x1ba814(0x15e))/0x1*(-parseInt(_0x1ba814(0x145))/0x2)+parseInt(_0x1ba814(0x18c))/0x3+parseInt(_0x1ba814(0x172))/0x4*(parseInt(_0x1ba814(0x150))/0x5)+parseInt(_0x1ba814(0x147))/0x6*(-parseInt(_0x1ba814(0x126))/0x7)+-parseInt(_0x1ba814(0x173))/0x8+-parseInt(_0x1ba814(0x16b))/0x9*(parseInt(_0x1ba814(0x151))/0xa)+parseInt(_0x1ba814(0x156))/0xb;if(_0x16b9fa===_0x3cef3c)break;else _0x22f098['push'](_0x22f098['shift']());}catch(_0x59e7e3){_0x22f098['push'](_0x22f098['shift']());}}}(a9_0x25e5,0x3d711));const a9_0x31fc7f=(function(){let _0x4edae2=!![];return function(_0x372f60,_0x209421){const _0x468a67=_0x4edae2?function(){const _0x4f0c2b=a9_0x5e0c;if(_0x209421){const _0x12eedc=_0x209421[_0x4f0c2b(0x160)](_0x372f60,arguments);return _0x209421=null,_0x12eedc;}}:function(){};return _0x4edae2=![],_0x468a67;};}()),a9_0x18ddf8=a9_0x31fc7f(this,function(){const _0x4ce2dd=a9_0x5e0c;return a9_0x18ddf8[_0x4ce2dd(0x192)]()[_0x4ce2dd(0xcf)]('(((.+)+)+)+$')[_0x4ce2dd(0x192)]()[_0x4ce2dd(0x193)](a9_0x18ddf8)[_0x4ce2dd(0xcf)](_0x4ce2dd(0x18d));});a9_0x18ddf8();'use strict';var __createBinding=this&&this[a9_0x1194e2(0x175)]||(Object[a9_0x1194e2(0x167)]?function(_0x2a82ef,_0x51056f,_0x14b5da,_0x24a37f){const _0x51f732=a9_0x1194e2;if(_0x24a37f===undefined)_0x24a37f=_0x14b5da;var _0x8533fd=Object['getOwnPropertyDescriptor'](_0x51056f,_0x14b5da);(!_0x8533fd||('get'in _0x8533fd?!_0x51056f[_0x51f732(0x17d)]:_0x8533fd['writable']||_0x8533fd[_0x51f732(0x16a)]))&&(_0x8533fd={'enumerable':!![],'get':function(){return _0x51056f[_0x14b5da];}}),Object[_0x51f732(0xd8)](_0x2a82ef,_0x24a37f,_0x8533fd);}:function(_0x3cab81,_0x42b1f6,_0x4eb3e1,_0x565f10){if(_0x565f10===undefined)_0x565f10=_0x4eb3e1;_0x3cab81[_0x565f10]=_0x42b1f6[_0x4eb3e1];}),__setModuleDefault=this&&this[a9_0x1194e2(0xff)]||(Object[a9_0x1194e2(0x167)]?function(_0x5cd3cc,_0x2fa22a){const _0x12758b=a9_0x1194e2;Object[_0x12758b(0xd8)](_0x5cd3cc,_0x12758b(0x10e),{'enumerable':!![],'value':_0x2fa22a});}:function(_0x2866d9,_0x5ad6e4){const _0xcde21f=a9_0x1194e2;_0x2866d9[_0xcde21f(0x10e)]=_0x5ad6e4;}),__importStar=this&&this[a9_0x1194e2(0xd3)]||function(_0x37bcba){const _0x34a762=a9_0x1194e2;if(_0x37bcba&&_0x37bcba[_0x34a762(0x17d)])return _0x37bcba;var _0x2a357b={};if(_0x37bcba!=null){for(var _0x134cdb in _0x37bcba)if(_0x134cdb!=='default'&&Object[_0x34a762(0x168)][_0x34a762(0x13b)][_0x34a762(0x162)](_0x37bcba,_0x134cdb))__createBinding(_0x2a357b,_0x37bcba,_0x134cdb);}return __setModuleDefault(_0x2a357b,_0x37bcba),_0x2a357b;},__importDefault=this&&this['__importDefault']||function(_0x10a551){const _0x39c624=a9_0x1194e2;return _0x10a551&&_0x10a551[_0x39c624(0x17d)]?_0x10a551:{'default':_0x10a551};};Object[a9_0x1194e2(0xd8)](exports,'__esModule',{'value':!![]}),exports[a9_0x1194e2(0x116)]=exports['uploadContacts']=exports[a9_0x1194e2(0x103)]=exports[a9_0x1194e2(0xbd)]=exports['removeAllContacts']=exports[a9_0x1194e2(0x15d)]=exports[a9_0x1194e2(0xe4)]=exports[a9_0x1194e2(0x11e)]=exports[a9_0x1194e2(0xbe)]=exports[a9_0x1194e2(0x14f)]=exports[a9_0x1194e2(0xcb)]=exports[a9_0x1194e2(0x165)]=exports['showAllApi']=exports['showApi']=exports[a9_0x1194e2(0xdf)]=exports[a9_0x1194e2(0x17c)]=exports['makeid']=exports[a9_0x1194e2(0x146)]=exports[a9_0x1194e2(0x139)]=exports['listTicketsByCompany']=exports[a9_0x1194e2(0x196)]=exports[a9_0x1194e2(0x17f)]=exports[a9_0x1194e2(0x138)]=exports[a9_0x1194e2(0x181)]=exports[a9_0x1194e2(0x184)]=exports[a9_0x1194e2(0x15b)]=exports[a9_0x1194e2(0x108)]=exports['index']=exports[a9_0x1194e2(0x109)]=exports[a9_0x1194e2(0x158)]=exports[a9_0x1194e2(0x129)]=exports['createCompany']=exports['OnWhatsAppDto']=void 0x0;const axios_1=__importDefault(require(a9_0x1194e2(0xc2))),fs_1=__importDefault(require('fs')),Yup=__importStar(require(a9_0x1194e2(0x110))),lodash_1=require(a9_0x1194e2(0x143)),GetDefaultWhatsApp_1=__importDefault(require(a9_0x1194e2(0x12f))),SetTicketMessagesAsRead_1=__importDefault(require(a9_0x1194e2(0x170))),socket_1=require('../libs/socket'),Whatsapp_1=__importDefault(require(a9_0x1194e2(0x174))),Queue_1=__importDefault(require(a9_0x1194e2(0x18b))),User_1=__importDefault(require(a9_0x1194e2(0x10d))),CreateOrUpdateContactService_1=__importDefault(require('../services/ContactServices/CreateOrUpdateContactService')),FindOrCreateTicketService_1=__importDefault(require(a9_0x1194e2(0x180))),ShowTicketService_1=__importDefault(require(a9_0x1194e2(0xeb))),GetProfilePicUrl_1=__importDefault(require(a9_0x1194e2(0xc0))),SendWhatsAppMedia_1=__importDefault(require(a9_0x1194e2(0x12b))),UpdateTicketService_1=__importDefault(require(a9_0x1194e2(0x161))),wbot_1=require('../libs/wbot'),SendWhatsAppMessageLink_1=__importDefault(require('../services/WbotServices/SendWhatsAppMessageLink')),SendWhatsAppMessageAPI_1=__importDefault(require(a9_0x1194e2(0x154))),SendWhatsappMediaImage_1=__importDefault(require(a9_0x1194e2(0x13d))),ListInvoicesServices_1=__importDefault(require(a9_0x1194e2(0x121))),ShowInvoiceService_1=__importDefault(require(a9_0x1194e2(0x124))),UpdateInvoiceService_1=__importDefault(require(a9_0x1194e2(0x18a))),Invoices_1=__importDefault(require('../models/Invoices')),ListContactsService_1=__importDefault(require('../services/ContactServices/ListContactsService')),CreateContactService_1=__importDefault(require(a9_0x1194e2(0x187))),ShowContactService_1=__importDefault(require('../services/ContactServices/ShowContactService')),UpdateContactService_1=__importDefault(require(a9_0x1194e2(0xf7))),DeleteContactService_1=__importDefault(require(a9_0x1194e2(0xe5))),GetContactService_1=__importDefault(require(a9_0x1194e2(0x125))),ToggleDisableBotService_1=__importDefault(require(a9_0x1194e2(0x149))),CheckNumber_1=__importDefault(require(a9_0x1194e2(0x105))),CheckIsValidContact_1=__importDefault(require(a9_0x1194e2(0xee))),AppError_1=__importDefault(require(a9_0x1194e2(0x178))),SimpleListService_1=__importDefault(require('../services/ContactServices/SimpleListService')),ImportXLSContactsService_1=require(a9_0x1194e2(0x190)),ApiUsages_1=__importDefault(require(a9_0x1194e2(0x17e))),useDate_1=require('../utils/useDate'),TicketTag_1=__importDefault(require(a9_0x1194e2(0x11a))),Tag_1=__importDefault(require(a9_0x1194e2(0x159))),moment_1=__importDefault(require('moment')),path_1=__importDefault(require(a9_0x1194e2(0x131))),Ticket_1=__importDefault(require(a9_0x1194e2(0xca))),Contact_1=__importDefault(require(a9_0x1194e2(0xd5))),Company_1=__importDefault(require('../models/Company')),SendPresenceStatus_1=require(a9_0x1194e2(0x17b));class OnWhatsAppDto{constructor(_0x39d942,_0x96dfb0){const _0x3f74f6=a9_0x1194e2;this[_0x3f74f6(0xe0)]=_0x39d942,this[_0x3f74f6(0xbc)]=_0x96dfb0;}}exports[a9_0x1194e2(0x10a)]=OnWhatsAppDto;const CompanySchema=Yup['object']()[a9_0x1194e2(0x14d)]({'name':Yup['string']()[a9_0x1194e2(0x153)](),'id':Yup[a9_0x1194e2(0xe3)](),'phone':Yup[a9_0x1194e2(0xc8)]()[a9_0x1194e2(0xd2)](),'email':Yup[a9_0x1194e2(0xc8)]()[a9_0x1194e2(0x179)]()['nullable'](),'status':Yup[a9_0x1194e2(0x194)]()[a9_0x1194e2(0xd2)](),'planId':Yup[a9_0x1194e2(0xe3)]()[a9_0x1194e2(0xd2)](),'campaignsEnabled':Yup[a9_0x1194e2(0x194)]()['nullable'](),'dueDate':Yup[a9_0x1194e2(0x136)]()[a9_0x1194e2(0xd2)](),'recurrence':Yup[a9_0x1194e2(0xc8)]()[a9_0x1194e2(0xd2)]()}),createCompany=async(_0x142205,_0x30d924)=>{const _0x11b01d=a9_0x1194e2;try{await CompanySchema[_0x11b01d(0xd9)](_0x142205[_0x11b01d(0xf3)]);const _0x262c4c=await Company_1[_0x11b01d(0x10e)][_0x11b01d(0x167)](_0x142205[_0x11b01d(0xf3)]);_0x30d924['status'](0xc9)[_0x11b01d(0x182)](_0x262c4c);}catch(_0xb5385b){_0x30d924[_0x11b01d(0x13e)](0x190)[_0x11b01d(0x182)]({'error':_0xb5385b[_0x11b01d(0x107)]});}};exports[a9_0x1194e2(0x134)]=createCompany;const updateCompany=async(_0x1f1516,_0x4aa713)=>{const _0x1baeb7=a9_0x1194e2;try{await CompanySchema[_0x1baeb7(0xd9)](_0x1f1516[_0x1baeb7(0xf3)]);const {id:_0x47a101}=_0x1f1516[_0x1baeb7(0x100)],[_0x46b61c]=await Company_1[_0x1baeb7(0x10e)]['update'](_0x1f1516['body'],{'where':{'id':_0x47a101}});if(_0x46b61c){const _0x56fa40=await Company_1[_0x1baeb7(0x10e)]['findByPk'](_0x47a101);_0x4aa713[_0x1baeb7(0x13e)](0xc8)[_0x1baeb7(0x182)](_0x56fa40);}else _0x4aa713[_0x1baeb7(0x13e)](0x194)['json']({'error':_0x1baeb7(0x117)});}catch(_0x2c20bd){_0x4aa713[_0x1baeb7(0x13e)](0x190)[_0x1baeb7(0x182)]({'error':_0x2c20bd[_0x1baeb7(0x107)]});}};exports[a9_0x1194e2(0x129)]=updateCompany;const blockCompany=async(_0x35f26d,_0x564046)=>{const _0x5a7a2f=a9_0x1194e2;try{const {id:_0x552e8b}=_0x35f26d[_0x5a7a2f(0x100)],[_0x81c1f8]=await Company_1['default'][_0x5a7a2f(0xfe)]({'status':![]},{'where':{'id':_0x552e8b}});if(_0x81c1f8){const _0x58e59e=await Company_1[_0x5a7a2f(0x10e)][_0x5a7a2f(0x135)](_0x552e8b);_0x564046[_0x5a7a2f(0x13e)](0xc8)['json'](_0x58e59e);}else _0x564046[_0x5a7a2f(0x13e)](0x194)[_0x5a7a2f(0x182)]({'error':_0x5a7a2f(0x117)});}catch(_0x4e0852){_0x564046[_0x5a7a2f(0x13e)](0x190)[_0x5a7a2f(0x182)]({'error':_0x4e0852[_0x5a7a2f(0x107)]});}};exports[a9_0x1194e2(0x158)]=blockCompany;const createContact=async(_0x404b38,_0x40e6ad,_0x281d96)=>{const _0x24176f=a9_0x1194e2;await(0x0,CheckIsValidContact_1[_0x24176f(0x10e)])(_0x281d96,_0x40e6ad);const _0x4b35ad=await(0x0,CheckNumber_1[_0x24176f(0x10e)])(_0x281d96,_0x40e6ad),_0x2b8671=await(0x0,GetProfilePicUrl_1[_0x24176f(0x10e)])(_0x4b35ad,_0x40e6ad),_0x5f1e74=_0x4b35ad,_0x31b382={'name':''+_0x5f1e74,'number':_0x5f1e74,'profilePicUrl':_0x2b8671,'isGroup':![],'companyId':_0x40e6ad},_0x331f6b=await(0x0,CreateOrUpdateContactService_1[_0x24176f(0x10e)])(_0x31b382,null,null);let _0x3376dc;if(_0x404b38===undefined)_0x3376dc=await(0x0,GetDefaultWhatsApp_1['default'])(_0x40e6ad);else{_0x3376dc=await Whatsapp_1[_0x24176f(0x10e)]['findByPk'](_0x404b38);if(_0x3376dc===null)throw new AppError_1[(_0x24176f(0x10e))](_0x24176f(0xea)+_0x404b38+_0x24176f(0x130));}const _0x802f1b=await(0x0,FindOrCreateTicketService_1['default'])(_0x331f6b,_0x3376dc['id'],0x0,_0x40e6ad),_0x176b2a=await(0x0,ShowTicketService_1[_0x24176f(0x10e)])(_0x802f1b['id'],_0x40e6ad);return(0x0,SetTicketMessagesAsRead_1['default'])(_0x176b2a),_0x176b2a;};function formatBRNumber(_0x34f14d){const _0x2e6180=a9_0x1194e2,_0x342132=new RegExp(/^(\d{2})(\d{2})\d{1}(\d{8})$/);if(_0x342132[_0x2e6180(0x10f)](_0x34f14d)){const _0x4d4fd4=_0x342132[_0x2e6180(0x12d)](_0x34f14d);if(_0x4d4fd4&&_0x4d4fd4[0x1]==='55'&&Number[_0x2e6180(0xde)](Number[_0x2e6180(0xd0)](_0x4d4fd4[0x2]))){const _0x16426a=Number[_0x2e6180(0xd0)](_0x4d4fd4[0x2]);if(_0x16426a<0x1f)return _0x4d4fd4[0x0];else{if(_0x16426a>=0x1f)return _0x4d4fd4[0x1]+_0x4d4fd4[0x2]+_0x4d4fd4[0x3];}}}else return _0x34f14d;}function createJid(_0x240ede){const _0x29e1fd=a9_0x1194e2;if(_0x240ede[_0x29e1fd(0xc6)](_0x29e1fd(0x132))||_0x240ede['includes'](_0x29e1fd(0xf4)))return formatBRNumber(_0x240ede);return _0x240ede[_0x29e1fd(0xc6)]('-')?_0x240ede+_0x29e1fd(0x132):formatBRNumber(_0x240ede)+_0x29e1fd(0xf4);}const indexLink=async(_0x14e20c,_0x23bdd8)=>{const _0x38b701=a9_0x1194e2,_0x250af7=_0x14e20c[_0x38b701(0xf3)],{whatsappId:_0x165f5c}=_0x14e20c[_0x38b701(0xf3)],{msdelay:_0x2970bb}=_0x14e20c['body'],_0xa9d177=_0x14e20c[_0x38b701(0xf3)][_0x38b701(0xe1)],_0xeab357=_0x14e20c['body'][_0x38b701(0x152)],_0x21ea1a=_0x14e20c[_0x38b701(0xf6)]['authorization'],[,_0x1ae3bb]=_0x21ea1a[_0x38b701(0x157)]('\x20'),_0x4ae220=await Whatsapp_1[_0x38b701(0x10e)][_0x38b701(0x14b)]({'where':{'token':_0x1ae3bb}}),_0x4d1702=_0x4ae220['companyId'];_0x250af7[_0x38b701(0xe3)]=_0x250af7[_0x38b701(0xe3)][_0x38b701(0xd4)]('-','')[_0x38b701(0xd4)]('\x20','');const _0xff9824=Yup[_0x38b701(0x11f)]()[_0x38b701(0x14d)]({'number':Yup['string']()[_0x38b701(0x153)]()[_0x38b701(0xed)](/^\d+$/,'Invalid\x20number\x20format.\x20Only\x20numbers\x20is\x20allowed.')});try{await _0xff9824[_0x38b701(0xd9)](_0x250af7);}catch(_0x4b826a){throw new AppError_1[(_0x38b701(0x10e))](_0x4b826a[_0x38b701(0x107)]);}const _0x2e75db=await createContact(_0x165f5c,_0x4d1702,_0x250af7[_0x38b701(0xe3)]);return await(0x0,SendWhatsAppMessageLink_1['default'])({'ticket':_0x2e75db,'url':_0xa9d177,'caption':_0xeab357,'msdelay':_0x2970bb}),setTimeout(async()=>{const _0x20b394=_0x38b701;await(0x0,UpdateTicketService_1['default'])({'ticketId':_0x2e75db['id'],'ticketData':{'status':_0x20b394(0xfa),'sendFarewellMessage':![],'amountUsedBotQueues':0x0},'companyId':_0x4d1702});},0xc8),setTimeout(async()=>{const _0x5504ee=_0x38b701,{dateToClient:_0x2964d2}=(0x0,useDate_1[_0x5504ee(0xfd)])(),_0x3a95ae=_0x2964d2(new Date()[_0x5504ee(0x192)]()),_0x30b678=(0x0,moment_1['default'])()['format'](),_0x451841=await ApiUsages_1[_0x5504ee(0x10e)][_0x5504ee(0x14b)]({'where':{'dateUsed':_0x3a95ae,'companyId':_0x4d1702}});if(_0x451841)await _0x451841['update']({'usedPDF':_0x451841[_0x5504ee(0x186)]['usedPDF']+0x1,'UsedOnDay':_0x451841['dataValues'][_0x5504ee(0xc7)]+0x1,'updatedAt':_0x30b678});else{const _0x8eb339=await ApiUsages_1[_0x5504ee(0x10e)][_0x5504ee(0x167)]({'companyId':_0x4d1702,'dateUsed':_0x3a95ae});await _0x8eb339[_0x5504ee(0xfe)]({'usedPDF':_0x8eb339[_0x5504ee(0x186)][_0x5504ee(0x102)]+0x1,'UsedOnDay':_0x8eb339[_0x5504ee(0x186)][_0x5504ee(0xc7)]+0x1,'updatedAt':_0x30b678});}},0x64),_0x23bdd8['send']({'status':'SUCCESS'});};exports[a9_0x1194e2(0x109)]=indexLink;const index=async(_0x387a7a,_0x5e41b0)=>{const _0x44d4a1=a9_0x1194e2,_0x13fb4e=_0x387a7a[_0x44d4a1(0xf3)],{whatsappId:_0x1e4f22}=_0x387a7a[_0x44d4a1(0xf3)],{msdelay:_0x1f7cdc}=_0x387a7a[_0x44d4a1(0xf3)],{body:_0x4f35d1,quotedMsg:_0x3d4528}=_0x387a7a['body'],_0xbe1702=_0x387a7a[_0x44d4a1(0x12a)],_0x23c76d=_0x387a7a[_0x44d4a1(0xf6)][_0x44d4a1(0xcc)],[,_0x4549e8]=_0x23c76d[_0x44d4a1(0x157)]('\x20'),_0x2c87fa=await Whatsapp_1[_0x44d4a1(0x10e)][_0x44d4a1(0x14b)]({'where':{'token':_0x4549e8}}),_0x26065d=_0x2c87fa[_0x44d4a1(0xda)];_0x13fb4e[_0x44d4a1(0xe3)]=_0x13fb4e[_0x44d4a1(0xe3)][_0x44d4a1(0xd4)]('-','')['replace']('\x20','');const _0x350bad=Yup['object']()[_0x44d4a1(0x14d)]({'number':Yup[_0x44d4a1(0xc8)]()[_0x44d4a1(0x153)]()[_0x44d4a1(0xed)](/^\d+$/,_0x44d4a1(0xf8))});try{await _0x350bad[_0x44d4a1(0xd9)](_0x13fb4e);}catch(_0x57ac08){throw new AppError_1[(_0x44d4a1(0x10e))](_0x57ac08[_0x44d4a1(0x107)]);}const _0x34fa28=await createContact(_0x1e4f22,_0x26065d,_0x13fb4e[_0x44d4a1(0xe3)]);return _0xbe1702?await Promise['all'](_0xbe1702['map'](async _0x3923e3=>{const _0x598d2d=_0x44d4a1;await(0x0,SendWhatsAppMedia_1[_0x598d2d(0x10e)])({'body':_0x4f35d1,'media':_0x3923e3,'ticket':_0x34fa28});})):await(0x0,SendWhatsAppMessageAPI_1['default'])({'body':_0x4f35d1,'ticket':_0x34fa28,'quotedMsg':_0x3d4528,'msdelay':_0x1f7cdc}),setTimeout(async()=>{const _0x42cd79=_0x44d4a1;await(0x0,UpdateTicketService_1[_0x42cd79(0x10e)])({'ticketId':_0x34fa28['id'],'ticketData':{'status':_0x42cd79(0xfa),'sendFarewellMessage':![],'amountUsedBotQueues':0x0},'companyId':_0x26065d});},0x64),setTimeout(async()=>{const _0x3e5092=_0x44d4a1,{dateToClient:_0x2e6162}=(0x0,useDate_1['useDate'])(),_0x4c34c8=_0x2e6162(new Date()['toString']()),_0x587e42=(0x0,moment_1[_0x3e5092(0x10e)])()[_0x3e5092(0x140)](),_0x4b77cc=await ApiUsages_1[_0x3e5092(0x10e)][_0x3e5092(0x14b)]({'where':{'dateUsed':_0x4c34c8,'companyId':_0x26065d}});_0x4b77cc?_0xbe1702?await Promise[_0x3e5092(0xfb)](_0xbe1702[_0x3e5092(0xc5)](async _0x3bee3b=>{const _0x56921d=_0x3e5092;console['log'](_0x56921d(0x15c),_0x3bee3b);const _0x802a39=path_1['default'][_0x56921d(0xc9)](_0x3bee3b[_0x56921d(0xf1)]);console[_0x56921d(0x123)](_0x56921d(0x176),_0x802a39);if(_0x3bee3b['mimetype'][_0x56921d(0xc6)](_0x56921d(0x14a)))await _0x4b77cc[_0x56921d(0xfe)]({'usedPDF':_0x4b77cc['dataValues'][_0x56921d(0x102)]+0x1,'UsedOnDay':_0x4b77cc[_0x56921d(0x186)][_0x56921d(0xc7)]+0x1,'updatedAt':_0x587e42});else{if(_0x3bee3b['mimetype']['includes'](_0x56921d(0x14c)))await _0x4b77cc[_0x56921d(0xfe)]({'usedImage':_0x4b77cc[_0x56921d(0x186)][_0x56921d(0x183)]+0x1,'UsedOnDay':_0x4b77cc[_0x56921d(0x186)]['UsedOnDay']+0x1,'updatedAt':_0x587e42});else _0x3bee3b['mimetype']['includes'](_0x56921d(0x10b))?await _0x4b77cc[_0x56921d(0xfe)]({'usedVideo':_0x4b77cc[_0x56921d(0x186)]['usedVideo']+0x1,'UsedOnDay':_0x4b77cc[_0x56921d(0x186)][_0x56921d(0xc7)]+0x1,'updatedAt':_0x587e42}):await _0x4b77cc['update']({'usedOther':_0x4b77cc['dataValues'][_0x56921d(0x106)]+0x1,'UsedOnDay':_0x4b77cc[_0x56921d(0x186)][_0x56921d(0xc7)]+0x1,'updatedAt':_0x587e42});}})):await _0x4b77cc['update']({'usedText':_0x4b77cc[_0x3e5092(0x186)][_0x3e5092(0xf2)]+0x1,'UsedOnDay':_0x4b77cc[_0x3e5092(0x186)][_0x3e5092(0xc7)]+0x1,'updatedAt':_0x587e42}):(await ApiUsages_1[_0x3e5092(0x10e)]['create']({'companyId':_0x26065d,'dateUsed':_0x4c34c8}),_0xbe1702?await Promise['all'](_0xbe1702[_0x3e5092(0xc5)](async _0x19b605=>{const _0x1612f0=_0x3e5092;console[_0x1612f0(0x123)](_0x1612f0(0x15c),_0x19b605);const _0x5f3d6d=path_1[_0x1612f0(0x10e)][_0x1612f0(0xc9)](_0x19b605[_0x1612f0(0xf1)]);console['log'](_0x1612f0(0x176),_0x5f3d6d);if(_0x19b605['mimetype'][_0x1612f0(0xc6)]('pdf'))await _0x4b77cc[_0x1612f0(0xfe)]({'usedPDF':_0x4b77cc['dataValues'][_0x1612f0(0x102)]+0x1,'UsedOnDay':_0x4b77cc['dataValues'][_0x1612f0(0xc7)]+0x1,'updatedAt':_0x587e42});else{if(_0x19b605[_0x1612f0(0x163)][_0x1612f0(0xc6)](_0x1612f0(0x14c)))await _0x4b77cc[_0x1612f0(0xfe)]({'usedImage':_0x4b77cc[_0x1612f0(0x186)]['usedImage']+0x1,'UsedOnDay':_0x4b77cc[_0x1612f0(0x186)][_0x1612f0(0xc7)]+0x1,'updatedAt':_0x587e42});else _0x19b605[_0x1612f0(0x163)]['includes'](_0x1612f0(0x10b))?await _0x4b77cc['update']({'usedVideo':_0x4b77cc[_0x1612f0(0x186)]['usedVideo']+0x1,'UsedOnDay':_0x4b77cc[_0x1612f0(0x186)][_0x1612f0(0xc7)]+0x1,'updatedAt':_0x587e42}):await _0x4b77cc['update']({'usedOther':_0x4b77cc['dataValues']['usedOther']+0x1,'UsedOnDay':_0x4b77cc['dataValues']['UsedOnDay']+0x1,'updatedAt':_0x587e42});}})):await _0x4b77cc[_0x3e5092(0xfe)]({'usedText':_0x4b77cc['dataValues'][_0x3e5092(0xf2)]+0x1,'UsedOnDay':_0x4b77cc[_0x3e5092(0x186)][_0x3e5092(0xc7)]+0x1,'updatedAt':_0x587e42}));},0x64),_0x5e41b0['send']({'status':_0x44d4a1(0x164)});};exports[a9_0x1194e2(0xe7)]=index;const indexImage=async(_0x311d27,_0x4fac38)=>{const _0x362ff6=a9_0x1194e2,_0x15392a=_0x311d27['body'],{whatsappId:_0x5cdfbd}=_0x311d27[_0x362ff6(0xf3)],{msdelay:_0x4bb8b1}=_0x311d27['body'],_0x36a2b1=_0x311d27['body'][_0x362ff6(0xe1)],_0x549265=_0x311d27[_0x362ff6(0xf3)][_0x362ff6(0x152)],_0x5256ff=_0x311d27[_0x362ff6(0xf6)][_0x362ff6(0xcc)],[,_0x27903b]=_0x5256ff[_0x362ff6(0x157)]('\x20'),_0x20505e=await Whatsapp_1[_0x362ff6(0x10e)][_0x362ff6(0x14b)]({'where':{'token':_0x27903b}}),_0x204f12=_0x20505e[_0x362ff6(0xda)];_0x15392a[_0x362ff6(0xe3)]=_0x15392a[_0x362ff6(0xe3)][_0x362ff6(0xd4)]('-','')[_0x362ff6(0xd4)]('\x20','');const _0x2db7e3=Yup['object']()[_0x362ff6(0x14d)]({'number':Yup['string']()[_0x362ff6(0x153)]()[_0x362ff6(0xed)](/^\d+$/,'Invalid\x20number\x20format.\x20Only\x20numbers\x20is\x20allowed.')});try{await _0x2db7e3[_0x362ff6(0xd9)](_0x15392a);}catch(_0xa59449){throw new AppError_1[(_0x362ff6(0x10e))](_0xa59449[_0x362ff6(0x107)]);}const _0x586a02=await createContact(_0x5cdfbd,_0x204f12,_0x15392a[_0x362ff6(0xe3)]);return _0x36a2b1&&await(0x0,SendWhatsappMediaImage_1[_0x362ff6(0x10e)])({'ticket':_0x586a02,'url':_0x36a2b1,'caption':_0x549265,'msdelay':_0x4bb8b1}),setTimeout(async()=>{const _0x57c51f=_0x362ff6;await(0x0,UpdateTicketService_1['default'])({'ticketId':_0x586a02['id'],'ticketData':{'status':_0x57c51f(0xfa),'sendFarewellMessage':![],'amountUsedBotQueues':0x0},'companyId':_0x204f12});},0x64),setTimeout(async()=>{const _0x2458cd=_0x362ff6,{dateToClient:_0x463c61}=(0x0,useDate_1[_0x2458cd(0xfd)])(),_0xf8c3fc=_0x463c61(new Date()[_0x2458cd(0x192)]()),_0x5d67a6=(0x0,moment_1['default'])()[_0x2458cd(0x140)](),_0x32e4fd=await ApiUsages_1[_0x2458cd(0x10e)]['findOne']({'where':{'dateUsed':_0xf8c3fc,'companyId':_0x204f12}});if(_0x32e4fd)await _0x32e4fd[_0x2458cd(0xfe)]({'usedImage':_0x32e4fd['dataValues'][_0x2458cd(0x183)]+0x1,'UsedOnDay':_0x32e4fd['dataValues'][_0x2458cd(0xc7)]+0x1,'updatedAt':_0x5d67a6});else{const _0x1e0831=await ApiUsages_1[_0x2458cd(0x10e)][_0x2458cd(0x167)]({'companyId':_0x204f12,'dateUsed':_0xf8c3fc});await _0x1e0831['update']({'usedImage':_0x1e0831['dataValues'][_0x2458cd(0x183)]+0x1,'UsedOnDay':_0x1e0831[_0x2458cd(0x186)]['UsedOnDay']+0x1,'updatedAt':_0x5d67a6});}},0x64),_0x4fac38['send']({'status':'SUCCESS'});};exports['indexImage']=indexImage;const checkNumber=async(_0x59f535,_0x86991f)=>{const _0x1944d8=a9_0x1194e2,_0x41d99b=_0x59f535[_0x1944d8(0xf3)],_0x4a0e40=_0x59f535[_0x1944d8(0xf6)]['authorization'],[,_0xa75591]=_0x4a0e40['split']('\x20'),_0x356f14=await Whatsapp_1[_0x1944d8(0x10e)][_0x1944d8(0x14b)]({'where':{'token':_0xa75591}}),_0x4a51aa=_0x356f14[_0x1944d8(0xda)],_0x351378=_0x41d99b[_0x1944d8(0xe3)][_0x1944d8(0xd4)]('-','')[_0x1944d8(0xd4)]('\x20',''),_0x12cf25=await(0x0,GetDefaultWhatsApp_1[_0x1944d8(0x10e)])(_0x4a51aa),_0x167a6c=(0x0,wbot_1['getWbot'])(_0x12cf25['id']),_0xba6201=createJid(_0x351378);try{const [_0x17a633]=await _0x167a6c[_0x1944d8(0x101)](_0xba6201);if(_0x17a633[_0x1944d8(0xbc)])return setTimeout(async()=>{const _0x5f2660=_0x1944d8,{dateToClient:_0x767be7}=(0x0,useDate_1[_0x5f2660(0xfd)])(),_0x29301b=_0x767be7(new Date()[_0x5f2660(0x192)]()),_0xb7748f=(0x0,moment_1['default'])()[_0x5f2660(0x140)](),_0x53ad83=await ApiUsages_1['default']['findOne']({'where':{'dateUsed':_0x29301b,'companyId':_0x4a51aa}});if(_0x53ad83)await _0x53ad83['update']({'usedCheckNumber':_0x53ad83[_0x5f2660(0x186)][_0x5f2660(0x17a)]+0x1,'UsedOnDay':_0x53ad83[_0x5f2660(0x186)][_0x5f2660(0xc7)]+0x1,'updatedAt':_0xb7748f});else{const _0x57c8c8=await ApiUsages_1[_0x5f2660(0x10e)][_0x5f2660(0x167)]({'companyId':_0x4a51aa,'dateUsed':_0x29301b});await _0x57c8c8['update']({'usedCheckNumber':_0x57c8c8['dataValues']['usedCheckNumber']+0x1,'UsedOnDay':_0x57c8c8[_0x5f2660(0x186)][_0x5f2660(0xc7)]+0x1,'updatedAt':_0xb7748f});}},0x64),_0x86991f['status'](0xc8)['json']({'existsInWhatsapp':!![],'number':_0x351378,'numberFormatted':_0x17a633[_0x1944d8(0xe0)]});}catch(_0x3cdc53){return _0x86991f[_0x1944d8(0x13e)](0x190)[_0x1944d8(0x182)]({'existsInWhatsapp':![],'number':_0xba6201,'error':_0x1944d8(0x137)});}};exports[a9_0x1194e2(0x15b)]=checkNumber;const indexWhatsappsId=async(_0x1461ad,_0x4d1452)=>{const _0x221601=a9_0x1194e2;return console[_0x221601(0x123)]('req',_0x1461ad),console[_0x221601(0x123)](_0x221601(0xe2),_0x1461ad['user']),_0x4d1452[_0x221601(0x13e)](0xc8)[_0x221601(0x182)]('oi');};exports[a9_0x1194e2(0x184)]=indexWhatsappsId;const updateQueueId=async(_0x3c658c,_0x25d83f)=>{const _0x18233c=a9_0x1194e2,{ticketId:_0x4757ee}=_0x3c658c[_0x18233c(0x100)],{queueId:_0x2df56b}=_0x3c658c[_0x18233c(0xf3)],_0x5226d1=_0x3c658c[_0x18233c(0xf6)][_0x18233c(0xcc)],[,_0x1cc19b]=_0x5226d1['split']('\x20'),_0x6830b7=await Whatsapp_1['default'][_0x18233c(0x14b)]({'where':{'token':_0x1cc19b}}),_0x3fd2f8=_0x6830b7[_0x18233c(0xda)];try{const _0x10208c=await Queue_1[_0x18233c(0x10e)][_0x18233c(0x14b)]({'where':{'id':_0x2df56b,'companyId':_0x3fd2f8}});if(!_0x10208c)return _0x25d83f[_0x18233c(0x13e)](0x190)[_0x18233c(0x182)]({'status':_0x18233c(0x141),'error':_0x18233c(0xe6)});return await(0x0,UpdateTicketService_1[_0x18233c(0x10e)])({'ticketId':_0x4757ee,'ticketData':{'queueId':_0x2df56b},'companyId':_0x3fd2f8}),_0x25d83f[_0x18233c(0x13e)](0xc8)['json']({'status':'SUCCESS'});}catch(_0x3a2307){return console[_0x18233c(0x115)](_0x3a2307),_0x25d83f[_0x18233c(0x13e)](0x1f4)['json']({'status':_0x18233c(0x141),'error':_0x18233c(0x18e)});}};exports[a9_0x1194e2(0x181)]=updateQueueId;const closeTicket=async(_0x32b392,_0x2cfefb)=>{const _0x3f2e8a=a9_0x1194e2,_0x544926=_0x32b392[_0x3f2e8a(0xf6)]['authorization'],[,_0xd2576b]=_0x544926[_0x3f2e8a(0x157)]('\x20'),_0x15088f=await Whatsapp_1[_0x3f2e8a(0x10e)][_0x3f2e8a(0x14b)]({'where':{'token':_0xd2576b}}),_0x316670=_0x15088f[_0x3f2e8a(0xda)],{ticketId:_0x5a4ac2}=_0x32b392[_0x3f2e8a(0x100)],_0xc12819=await(0x0,ShowTicketService_1[_0x3f2e8a(0x10e)])(_0x5a4ac2,_0x316670);_0xc12819[_0x3f2e8a(0x13e)]=_0x32b392['body'][_0x3f2e8a(0x112)][_0x3f2e8a(0x13e)],console['log'](_0xc12819[_0x3f2e8a(0x13e)]);const {ticket:_0x12a262}=await(0x0,UpdateTicketService_1['default'])({'ticketData':_0xc12819,'ticketId':_0x5a4ac2,'companyId':_0x316670});return _0x2cfefb[_0x3f2e8a(0x13e)](0xc8)[_0x3f2e8a(0x182)](_0x12a262);};exports[a9_0x1194e2(0x138)]=closeTicket;const updateTicketTag=async(_0x1011c6,_0x2c4ecb)=>{const _0x5b0437=a9_0x1194e2,{ticketId:_0x5bc757,tagId:_0x17668a}=_0x1011c6['body'],_0x1c5702=_0x1011c6[_0x5b0437(0xf6)][_0x5b0437(0xcc)],[,_0x5768c6]=_0x1c5702['split']('\x20');try{const _0x418b32=await Whatsapp_1[_0x5b0437(0x10e)][_0x5b0437(0x14b)]({'where':{'token':_0x5768c6}}),_0x2ade8f=_0x418b32[_0x5b0437(0xda)],_0x163dd4=await Tag_1['default'][_0x5b0437(0x14b)]({'where':{'id':_0x17668a,'companyId':_0x2ade8f}});if(!_0x163dd4)return _0x2c4ecb[_0x5b0437(0x13e)](0x190)[_0x5b0437(0x182)]({'status':_0x5b0437(0x141),'error':_0x5b0437(0x11c)});const _0x47cfaa=await TicketTag_1[_0x5b0437(0x10e)][_0x5b0437(0x14b)]({'where':{'ticketId':_0x5bc757,'tagId':_0x17668a}});if(_0x47cfaa)return _0x2c4ecb[_0x5b0437(0x13e)](0x190)[_0x5b0437(0x182)]({'status':'ERROR','error':_0x5b0437(0x155)});const _0x330883=await TicketTag_1['default'][_0x5b0437(0x167)]({'ticketId':_0x5bc757,'tagId':_0x17668a});return _0x2c4ecb[_0x5b0437(0x13e)](0xc8)[_0x5b0437(0x182)]({'status':_0x5b0437(0x164),'ticketTag':_0x330883});}catch(_0x30b5be){return console['error'](_0x30b5be),_0x2c4ecb[_0x5b0437(0x13e)](0x1f4)[_0x5b0437(0x182)]({'status':_0x5b0437(0x141),'error':_0x5b0437(0x119)});}};exports[a9_0x1194e2(0x17f)]=updateTicketTag;const removeTicketTag=async(_0x1802a7,_0x23c6da)=>{const _0x5a50a3=a9_0x1194e2,{ticketId:_0x2f4b8a,tagId:_0x4f5bbb}=_0x1802a7[_0x5a50a3(0xf3)];try{const _0x4d4e97=await TicketTag_1[_0x5a50a3(0x10e)]['findOne']({'where':{'ticketId':_0x2f4b8a,'tagId':_0x4f5bbb}});if(!_0x4d4e97)return _0x23c6da[_0x5a50a3(0x13e)](0x190)['json']({'status':_0x5a50a3(0x141),'error':_0x5a50a3(0x18f)});return await _0x4d4e97[_0x5a50a3(0xef)](),_0x23c6da[_0x5a50a3(0x13e)](0xc8)[_0x5a50a3(0x182)]({'status':'SUCCESS'});}catch(_0x5e8092){return console[_0x5a50a3(0x115)](_0x5e8092),_0x23c6da[_0x5a50a3(0x13e)](0x1f4)['json']({'status':_0x5a50a3(0x141),'error':_0x5a50a3(0xe9)});}};exports['removeTicketTag']=removeTicketTag;const listTicketsByCompany=async(_0x41df63,_0x5e402d)=>{const _0x4e9662=a9_0x1194e2,_0x16a91b=_0x41df63[_0x4e9662(0xf6)]['authorization'],[,_0x3d933a]=_0x16a91b['split']('\x20'),_0x201911=await Whatsapp_1['default'][_0x4e9662(0x14b)]({'where':{'token':_0x3d933a}}),_0x5b10c9=_0x201911['companyId'];try{const _0x228427=await Ticket_1[_0x4e9662(0x10e)][_0x4e9662(0x16c)]({'where':{'companyId':_0x5b10c9},'include':[{'model':Contact_1[_0x4e9662(0x10e)],'as':_0x4e9662(0x185),'attributes':['id',_0x4e9662(0x118),_0x4e9662(0xe3),_0x4e9662(0x179),'profilePicUrl',_0x4e9662(0xc4),_0x4e9662(0x16e),'disableBot'],'include':['extraInfo']},{'model':Queue_1[_0x4e9662(0x10e)],'as':'queue','attributes':['id',_0x4e9662(0x118),'color']},{'model':User_1[_0x4e9662(0x10e)],'as':'user','attributes':['id',_0x4e9662(0x118)]},{'model':Tag_1['default'],'as':'tags','attributes':['id','name',_0x4e9662(0xd7)]},{'model':Whatsapp_1['default'],'as':_0x4e9662(0x11b),'attributes':[_0x4e9662(0x118),'facebookUserToken','facebookUserId']},{'model':Company_1[_0x4e9662(0x10e)],'as':_0x4e9662(0x111),'attributes':[_0x4e9662(0x118)]}]});return _0x5e402d[_0x4e9662(0x13e)](0xc8)[_0x4e9662(0x182)]({'status':_0x4e9662(0x164),'tickets':_0x228427});}catch(_0x3ea65f){return console[_0x4e9662(0x115)](_0x3ea65f),_0x5e402d[_0x4e9662(0x13e)](0x1f4)[_0x4e9662(0x182)]({'status':_0x4e9662(0x141),'error':_0x4e9662(0x18e)});}};exports[a9_0x1194e2(0x133)]=listTicketsByCompany;const listTicketsByTag=async(_0x5c61fb,_0x1d50c1)=>{const _0x9fefe8=a9_0x1194e2,{tagId:_0x47f594}=_0x5c61fb[_0x9fefe8(0x100)],_0x9118dc=_0x5c61fb['headers'][_0x9fefe8(0xcc)],[,_0x412dcd]=_0x9118dc[_0x9fefe8(0x157)]('\x20');try{const _0x4d5667=await Whatsapp_1[_0x9fefe8(0x10e)][_0x9fefe8(0x14b)]({'where':{'token':_0x412dcd}}),_0x159dfe=_0x4d5667[_0x9fefe8(0xda)],_0x4cac3d=await Tag_1['default'][_0x9fefe8(0x14b)]({'where':{'id':_0x47f594,'companyId':_0x159dfe}});if(!_0x4cac3d)return _0x1d50c1[_0x9fefe8(0x13e)](0x190)['json']({'status':'ERROR','error':_0x9fefe8(0x11c)});const _0x1d97e5=await Ticket_1['default']['findAll']({'include':[{'model':Tag_1[_0x9fefe8(0x10e)],'as':_0x9fefe8(0x177),'attributes':['id',_0x9fefe8(0x118)],'through':{'attributes':[],'where':{'tagId':_0x47f594}}},{'model':Contact_1['default'],'as':_0x9fefe8(0x185),'attributes':['id',_0x9fefe8(0x118),_0x9fefe8(0xe3),'email',_0x9fefe8(0x16f),_0x9fefe8(0xc4),_0x9fefe8(0x16e),'disableBot'],'include':[_0x9fefe8(0x15f)]},{'model':Queue_1[_0x9fefe8(0x10e)],'as':_0x9fefe8(0xce),'attributes':['id','name',_0x9fefe8(0xd7)]},{'model':User_1[_0x9fefe8(0x10e)],'as':_0x9fefe8(0xf5),'attributes':['id',_0x9fefe8(0x118)]},{'model':Whatsapp_1[_0x9fefe8(0x10e)],'as':_0x9fefe8(0x11b),'attributes':[_0x9fefe8(0x118),_0x9fefe8(0x195),_0x9fefe8(0x142)]},{'model':Company_1[_0x9fefe8(0x10e)],'as':_0x9fefe8(0x111),'attributes':[_0x9fefe8(0x118)]}],'where':{'companyId':_0x159dfe,'$tags.id$':_0x47f594}});return _0x1d50c1[_0x9fefe8(0x13e)](0xc8)['json']({'status':_0x9fefe8(0x164),'tickets':_0x1d97e5});}catch(_0x249cf3){return console[_0x9fefe8(0x115)](_0x249cf3),_0x1d50c1[_0x9fefe8(0x13e)](0x1f4)[_0x9fefe8(0x182)]({'status':_0x9fefe8(0x141),'error':_0x9fefe8(0x18e)});}};exports[a9_0x1194e2(0x139)]=listTicketsByTag;const listTicketsByTagIsAuth=async(_0x4c90d8,_0x14418a)=>{const _0xc61b47=a9_0x1194e2,{tagId:_0x40cfbb}=_0x4c90d8['params'];try{const _0x15f4b6=await Ticket_1[_0xc61b47(0x10e)]['findAll']({'include':[{'model':Contact_1['default'],'as':'contact','attributes':[_0xc61b47(0x118),'number',_0xc61b47(0x179)],'include':[_0xc61b47(0x15f)]},{'model':Tag_1[_0xc61b47(0x10e)],'as':_0xc61b47(0x177),'attributes':['id','name',_0xc61b47(0xd7)],'where':{'id':_0x40cfbb}},{'model':Whatsapp_1['default'],'as':_0xc61b47(0x11b),'attributes':[_0xc61b47(0x118),'facebookUserToken',_0xc61b47(0x142)]},{'model':Company_1[_0xc61b47(0x10e)],'as':'company','attributes':['name']}]});return _0x14418a[_0xc61b47(0x13e)](0xc8)[_0xc61b47(0x182)]({'status':_0xc61b47(0x164),'tickets':_0x15f4b6});}catch(_0x1129fa){return console['error'](_0x1129fa),_0x14418a[_0xc61b47(0x13e)](0x1f4)[_0xc61b47(0x182)]({'status':_0xc61b47(0x141),'error':_0xc61b47(0x18e)});}};exports[a9_0x1194e2(0x146)]=listTicketsByTagIsAuth;function makeid(_0x1ad8fb){const _0xc14f62=a9_0x1194e2;var _0x448eeb='',_0x605640=_0xc14f62(0x12e),_0x278ff2=_0x605640[_0xc14f62(0xc3)];for(var _0x290071=0x0;_0x290071<_0x1ad8fb;_0x290071++){_0x448eeb+=_0x605640['charAt'](Math[_0xc14f62(0x198)](Math[_0xc14f62(0x16d)]()*_0x278ff2));}return _0x448eeb;}exports['makeid']=makeid;const handleAudioLink=async(_0x4fd880,_0xcad693)=>{const _0x11835f=a9_0x1194e2,{link:_0x23124f,contactNumber:_0x554436}=_0x4fd880[_0x11835f(0xf3)];try{const _0x6bf4d0=_0x4fd880[_0x11835f(0xf6)][_0x11835f(0xcc)],[,_0x54f2ba]=_0x6bf4d0[_0x11835f(0x157)]('\x20'),_0x413cdd=await Whatsapp_1[_0x11835f(0x10e)]['findOne']({'where':{'token':_0x54f2ba}}),_0x54544c=_0x413cdd[_0x11835f(0xda)],_0x48d0da=await(0x0,GetDefaultWhatsApp_1[_0x11835f(0x10e)])(_0x54544c),_0x56a882=(0x0,wbot_1[_0x11835f(0x166)])(_0x48d0da['id']),_0x349e22=_0x11835f(0x122)+_0x54544c+'/'+makeid(0xa)+'.mp3';if(!_0x413cdd)return _0xcad693[_0x11835f(0x13e)](0x191)[_0x11835f(0x182)]({'status':_0x11835f(0xfc),'error':_0x11835f(0x11d)});const _0x158852=await axios_1[_0x11835f(0x10e)][_0x11835f(0x15a)](_0x23124f,{'responseType':_0x11835f(0x197)});fs_1['default'][_0x11835f(0xf0)](_0x349e22,Buffer['from'](_0x158852[_0x11835f(0xcd)]));const _0x1b6bad=_0x11835f(0x189);return await(0x0,SendPresenceStatus_1['SendPresenceStatus'])(_0x56a882,_0x554436),await _0x56a882['sendMessage'](_0x554436+'@s.whatsapp.net',{'audio':fs_1[_0x11835f(0x10e)][_0x11835f(0x144)](_0x349e22),'fileName':_0x1b6bad,'caption':_0x1b6bad,'mimetype':_0x11835f(0xd1),'ptt':!![]}),_0xcad693[_0x11835f(0x13e)](0xc8)[_0x11835f(0x182)]({'status':_0x11835f(0x148)});}catch(_0x5ebc0e){return console['error'](_0x5ebc0e),_0xcad693[_0x11835f(0x13e)](0x1f4)[_0x11835f(0x182)]({'status':'ERRO','error':_0x11835f(0xe8)});}};exports[a9_0x1194e2(0x17c)]=handleAudioLink;const indexApi=async(_0x10d8f8,_0x31448e)=>{const _0x71a563=a9_0x1194e2,_0x194dd9=_0x10d8f8[_0x71a563(0xf6)][_0x71a563(0xcc)],[,_0x250f9f]=_0x194dd9[_0x71a563(0x157)]('\x20'),_0x12e23c=await Whatsapp_1[_0x71a563(0x10e)][_0x71a563(0x14b)]({'where':{'token':_0x250f9f}}),_0xa12011=_0x12e23c['companyId'],{searchParam:_0x1d5789,pageNumber:_0x9dc0f7}=_0x10d8f8[_0x71a563(0xc1)];if(_0xa12011===0x1){const {invoices:_0x51b510,count:_0x4e2d08,hasMore:_0x3995be}=await(0x0,ListInvoicesServices_1[_0x71a563(0x10e)])({'searchParam':_0x1d5789,'pageNumber':_0x9dc0f7});return _0x31448e[_0x71a563(0x182)]({'invoices':_0x51b510,'count':_0x4e2d08,'hasMore':_0x3995be});}else return _0x31448e[_0x71a563(0x13e)](0x191)['json']({'status':'ERRO','error':_0x71a563(0x104)});};exports[a9_0x1194e2(0xdf)]=indexApi;const showApi=async(_0x305c9c,_0x56402f)=>{const _0x2c485f=a9_0x1194e2,_0x35f3ba=_0x305c9c[_0x2c485f(0xf6)][_0x2c485f(0xcc)],[,_0x1e4fac]=_0x35f3ba[_0x2c485f(0x157)]('\x20'),_0x540265=await Whatsapp_1['default'][_0x2c485f(0x14b)]({'where':{'token':_0x1e4fac}}),_0x146e93=_0x540265[_0x2c485f(0xda)],{Invoiceid:_0x4ab810}=_0x305c9c[_0x2c485f(0x100)],_0x572b5e=await(0x0,ShowInvoiceService_1[_0x2c485f(0x10e)])(_0x4ab810);return _0x56402f[_0x2c485f(0x13e)](0xc8)[_0x2c485f(0x182)](_0x572b5e);};exports[a9_0x1194e2(0x188)]=showApi;const showAllApi=async(_0x4c47b0,_0x1a227e)=>{const _0x534e3d=a9_0x1194e2;try{const _0x48281b=_0x4c47b0[_0x534e3d(0xf6)][_0x534e3d(0xcc)],[,_0x58e694]=_0x48281b[_0x534e3d(0x157)]('\x20'),_0x3793ce=await Whatsapp_1[_0x534e3d(0x10e)][_0x534e3d(0x14b)]({'where':{'token':_0x58e694}}),_0x63cbad=_0x3793ce[_0x534e3d(0xda)],{companyId:_0x499eca,status:_0x425bb0}=_0x4c47b0['body'];if(_0x63cbad===0x1){const _0x442167=await Invoices_1[_0x534e3d(0x10e)]['findAll']({'where':{'companyId':_0x499eca,'status':_0x425bb0}});return _0x1a227e[_0x534e3d(0x13e)](0xc8)[_0x534e3d(0x182)](_0x442167);}else return _0x1a227e[_0x534e3d(0x13e)](0x191)[_0x534e3d(0x182)]({'status':'ERRO','error':_0x534e3d(0x104)});}catch(_0x8f693c){return console['error'](_0x534e3d(0x13a),_0x8f693c),_0x1a227e['status'](0x1f4)[_0x534e3d(0x182)]({'error':_0x534e3d(0xbf)});}};exports['showAllApi']=showAllApi;const updateApi=async(_0x3721ce,_0x41364a)=>{const _0x4ff737=a9_0x1194e2,_0x4240f3=_0x3721ce[_0x4ff737(0xf6)][_0x4ff737(0xcc)],[,_0x300727]=_0x4240f3[_0x4ff737(0x157)]('\x20'),_0x589e87=await Whatsapp_1[_0x4ff737(0x10e)][_0x4ff737(0x14b)]({'where':{'token':_0x300727}}),_0xc3aa96=_0x589e87[_0x4ff737(0xda)],_0x5c0fab=_0x3721ce[_0x4ff737(0xf3)],_0x28a253=Yup[_0x4ff737(0x11f)]()[_0x4ff737(0x14d)]({'name':Yup[_0x4ff737(0xc8)]()});try{await _0x28a253['validate'](_0x5c0fab);}catch(_0x303945){throw new AppError_1['default'](_0x303945[_0x4ff737(0x107)]);}const {id:_0x46d7af,status:_0x1d3b27}=_0x5c0fab;if(_0xc3aa96===0x1){const _0x4570c6=await(0x0,UpdateInvoiceService_1[_0x4ff737(0x10e)])({'id':_0x46d7af,'status':_0x1d3b27}),_0x441dc7=await Invoices_1[_0x4ff737(0x10e)][_0x4ff737(0x135)](_0x46d7af),_0x31c8c5=_0x441dc7['companyId'],_0x95e30e=await Company_1[_0x4ff737(0x10e)][_0x4ff737(0x135)](_0x31c8c5),_0x3175d3=new Date(_0x95e30e[_0x4ff737(0x12c)]);_0x3175d3[_0x4ff737(0xd6)](_0x3175d3['getDate']()+0x1e);const _0x3a6d46=_0x3175d3['toISOString']()['split']('T')[0x0];if(_0x95e30e){await _0x95e30e[_0x4ff737(0xfe)]({'dueDate':_0x3a6d46});const _0x3b2b91=await _0x441dc7['update']({'id':_0x46d7af,'status':_0x4ff737(0xdd)});await _0x95e30e[_0x4ff737(0x191)]();const _0x1852ea=(0x0,socket_1[_0x4ff737(0x127)])(),_0xea6889=await Company_1[_0x4ff737(0x10e)][_0x4ff737(0x14b)]({'where':{'id':_0x31c8c5}});}return _0x41364a['status'](0xc8)[_0x4ff737(0x182)](_0x4570c6);}else return _0x41364a[_0x4ff737(0x13e)](0x191)[_0x4ff737(0x182)]({'status':_0x4ff737(0xfc),'error':_0x4ff737(0x104)});};exports['updateApi']=updateApi;const updateUsageStats=async(_0x10818a,_0x405e77)=>{const _0x5f1139=a9_0x1194e2;if(!_0x10818a[_0x5f1139(0xf5)]||!_0x10818a[_0x5f1139(0xf5)][_0x5f1139(0xda)])return _0x405e77['status'](0x190)['send']({'status':_0x5f1139(0x141),'message':_0x5f1139(0x14e)});const {companyId:_0x5297eb}=_0x10818a[_0x5f1139(0xf5)],{contactId:_0x5d5db5}=_0x10818a[_0x5f1139(0x100)];return setTimeout(async()=>{const _0x5e5e68=_0x5f1139,{dateToClient:_0x589dea}=(0x0,useDate_1[_0x5e5e68(0xfd)])(),_0x1c285d=_0x589dea(new Date()['toString']()),_0x3ac6a8=(0x0,moment_1[_0x5e5e68(0x10e)])()['format']();try{const _0x5d8a19=await ApiUsages_1[_0x5e5e68(0x10e)]['findOne']({'where':{'dateUsed':_0x1c285d,'companyId':_0x5297eb}});if(_0x5d8a19)await _0x5d8a19[_0x5e5e68(0xfe)]({'usedOther':_0x5d8a19[_0x5e5e68(0x186)][_0x5e5e68(0x106)]+0x1,'UsedOnDay':_0x5d8a19[_0x5e5e68(0x186)][_0x5e5e68(0xc7)]+0x1,'updatedAt':_0x3ac6a8});else{const _0x5d5a41=await ApiUsages_1[_0x5e5e68(0x10e)][_0x5e5e68(0x167)]({'companyId':_0x5297eb,'dateUsed':_0x1c285d});await _0x5d5a41[_0x5e5e68(0xfe)]({'usedOther':_0x5d5a41[_0x5e5e68(0x186)][_0x5e5e68(0x106)]+0x1,'UsedOnDay':_0x5d5a41[_0x5e5e68(0x186)]['UsedOnDay']+0x1,'updatedAt':_0x3ac6a8});}}catch(_0x2b96c8){return console[_0x5e5e68(0x115)](_0x5e5e68(0xdc),_0x2b96c8),_0x405e77['status'](0x1f4)[_0x5e5e68(0xf9)]({'status':_0x5e5e68(0x141),'message':_0x5e5e68(0x128)});}},0x64),_0x405e77[_0x5f1139(0xf9)]({'status':_0x5f1139(0x164)});};exports[a9_0x1194e2(0xcb)]=updateUsageStats;const indexContacts=async(_0x385ba2,_0x1971b5)=>{const _0xa667e=a9_0x1194e2,{searchParam:_0x397d87,pageNumber:_0x11ede1}=_0x385ba2['query'],{companyId:_0x14c801}=_0x385ba2[_0xa667e(0xf5)],{contacts:_0x11dacf,count:_0x32f248,hasMore:_0x13e238}=await(0x0,ListContactsService_1[_0xa667e(0x10e)])({'searchParam':_0x397d87,'pageNumber':_0x11ede1,'companyId':_0x14c801});return _0x1971b5[_0xa667e(0x182)]({'contacts':_0x11dacf,'count':_0x32f248,'hasMore':_0x13e238});};exports['indexContacts']=indexContacts;const listContacts=async(_0x43c2b7,_0x37525f)=>{const _0x58481d=a9_0x1194e2,{name:_0x5d2487}=_0x43c2b7[_0x58481d(0xc1)],{companyId:_0x558a74}=_0x43c2b7['user'],_0x14e8ec=await(0x0,SimpleListService_1[_0x58481d(0x10e)])({'name':_0x5d2487,'companyId':_0x558a74});return _0x37525f[_0x58481d(0x182)](_0x14e8ec);};exports[a9_0x1194e2(0xbe)]=listContacts;const showContacts=async(_0x447903,_0x416fa6)=>{const _0x40d266=a9_0x1194e2,{contactId:_0x337db8}=_0x447903[_0x40d266(0x100)],{companyId:_0x137e5b}=_0x447903['user'],_0x19e273=await(0x0,ShowContactService_1[_0x40d266(0x10e)])(_0x337db8,_0x137e5b);return _0x416fa6[_0x40d266(0x13e)](0xc8)[_0x40d266(0x182)](_0x19e273);};exports[a9_0x1194e2(0x11e)]=showContacts;const findOrCreateContacts=async(_0xe0b635,_0x1cd794)=>{const _0x2aca90=a9_0x1194e2,{name:_0xa422ae,number:_0x3bf2bb}=_0xe0b635[_0x2aca90(0xf3)],{companyId:_0xcb425}=_0xe0b635[_0x2aca90(0xf5)],_0x461342=await(0x0,GetContactService_1[_0x2aca90(0x10e)])({'name':_0xa422ae,'number':_0x3bf2bb,'companyId':_0xcb425});return _0x1cd794[_0x2aca90(0x13e)](0xc8)[_0x2aca90(0x182)](_0x461342);};function a9_0x25e5(){const _0x5b52f4=['../models/Contact','setDate','color','defineProperty','validate','companyId','-contact','Error\x20updating\x20usage\x20stats:','paid','isInteger','indexApi','jid','url','req','number','findOrCreateContacts','../services/ContactServices/DeleteContactService','Invalid\x20queue\x20for\x20the\x20company','index','Erro\x20ao\x20lidar\x20com\x20o\x20link\x20de\x20áudio','Failed\x20to\x20remove\x20ticket\x20tag','whatsapp\x20#','../services/TicketServices/ShowTicketService','All\x20contacts\x20removed\x20successfully','matches','../services/WbotServices/CheckIsValidContact','destroy','writeFileSync','originalname','usedText','body','@s.whatsapp.net','user','headers','../services/ContactServices/UpdateContactService','Invalid\x20number\x20format.\x20Only\x20numbers\x20is\x20allowed.','send','pending','all','ERRO','useDate','update','__setModuleDefault','params','onWhatsApp','usedPDF','removeContacts','Acesso\x20não\x20autorizado.\x20Por\x20favor,\x20forneça\x20credenciais\x20válidas.','../services/WbotServices/CheckNumber','usedOther','message','indexImage','indexLink','OnWhatsAppDto','video','Contact\x20deleted','../models/User','default','test','yup','company','ticketData','head','Error\x20removing\x20all\x20contacts:','error','toggleDisableBotContacts','Company\x20not\x20found','name','Failed\x20to\x20update\x20ticket\x20tag','../models/TicketTag','whatsapp','Tag\x20does\x20not\x20belong\x20to\x20the\x20specified\x20company','Token\x20de\x20autorização\x20inválido','showContacts','object','company-','../services/InvoicesService/ListInvoicesServices','./public/company','log','../services/InvoicesService/ShowInvoiceService','../services/ContactServices/GetContactService','3468143DKjwVf','getIO','Internal\x20server\x20error','updateCompany','files','../services/WbotServices/SendWhatsAppMedia','dueDate','exec','ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789','../helpers/GetDefaultWhatsApp','\x20not\x20found','path','@g.us','listTicketsByCompany','createCompany','findByPk','date','Not\x20exists\x20on\x20Whatsapp','closeTicket','listTicketsByTag','Erro\x20ao\x20buscar\x20invoices:','hasOwnProperty','removeAllContacts','../services/WbotServices/SendWhatsappMediaImage','status','emit','format','ERROR','facebookUserId','lodash','readFileSync','2keygqH','listTicketsByTagIsAuth','6BtSkYe','SUCESSO','../services/ContactServices/ToggleDisableBotService','pdf','findOne','image','shape','Missing\x20user\x20or\x20companyId','indexContacts','3140hoCXNb','67790GLBENk','caption','required','../services/WbotServices/SendWhatsAppMessageAPI','Tag\x20already\x20associated\x20with\x20the\x20ticket','5449477TgYYoo','split','blockCompany','../models/Tag','get','checkNumber','media','storeContacts','261162rJqJwc','extraInfo','apply','../services/TicketServices/UpdateTicketService','call','mimetype','SUCCESS','updateApi','getWbot','create','prototype','-mainchannel','configurable','9eHQEoA','findAll','random','active','profilePicUrl','../helpers/SetTicketMessagesAsRead','delete','136NEVtAg','1142744wmyuHA','../models/Whatsapp','__createBinding','type','tags','../errors/AppError','email','usedCheckNumber','../helpers/SendPresenceStatus','handleAudioLink','__esModule','../models/ApiUsages','updateTicketTag','../services/TicketServices/FindOrCreateTicketService','updateQueueId','json','usedImage','indexWhatsappsId','contact','dataValues','../services/ContactServices/CreateContactService','showApi','Legenda\x20do\x20áudio','../services/InvoicesService/UpdateInvoiceService','../models/Queue','356445zcaEjm','(((.+)+)+)+$','Internal\x20Server\x20Error','Tag\x20is\x20not\x20associated\x20with\x20the\x20ticket','../services/ContactServices/ImportXLSContactsService','reload','toString','constructor','boolean','facebookUserToken','removeTicketTag','arraybuffer','floor','exists','updateContacts','listContacts','Erro\x20ao\x20buscar\x20invoices','../services/WbotServices/GetProfilePicUrl','query','axios','length','acceptAudioMessage','map','includes','UsedOnDay','string','extname','../models/Ticket','updateUsageStats','authorization','data','queue','search','parseInt','audio/mp4','nullable','__importStar','replace'];a9_0x25e5=function(){return _0x5b52f4;};return a9_0x25e5();}exports[a9_0x1194e2(0xe4)]=findOrCreateContacts;const storeContacts=async(_0x536bdc,_0x10d8cc)=>{const _0x5de617=a9_0x1194e2,{companyId:_0x1c5d73}=_0x536bdc[_0x5de617(0xf5)],_0x5c5381=_0x536bdc[_0x5de617(0xf3)];_0x5c5381['number']=_0x5c5381[_0x5de617(0xe3)][_0x5de617(0xd4)]('-','')[_0x5de617(0xd4)]('\x20','');const _0x1a10a0=Yup[_0x5de617(0x11f)]()['shape']({'name':Yup['string']()[_0x5de617(0x153)](),'number':Yup[_0x5de617(0xc8)]()[_0x5de617(0x153)]()[_0x5de617(0xed)](/^\d+$/,_0x5de617(0xf8))});try{await _0x1a10a0[_0x5de617(0xd9)](_0x5c5381);}catch(_0x477fd2){throw new AppError_1[(_0x5de617(0x10e))](_0x477fd2[_0x5de617(0x107)]);}await(0x0,CheckIsValidContact_1['default'])(_0x5c5381[_0x5de617(0xe3)],_0x1c5d73);const _0x47801e=await(0x0,CheckNumber_1[_0x5de617(0x10e)])(_0x5c5381[_0x5de617(0xe3)],_0x1c5d73),_0x11e11c=_0x47801e[_0x5de617(0xe0)][_0x5de617(0xd4)](/\D/g,'');_0x5c5381[_0x5de617(0xe3)]=_0x11e11c;const _0x26c500=await(0x0,CreateContactService_1[_0x5de617(0x10e)])({..._0x5c5381,'companyId':_0x1c5d73}),_0x45de66=(0x0,socket_1['getIO'])();return _0x45de66[_0x5de617(0x13f)](_0x5de617(0x120)+_0x1c5d73+_0x5de617(0xdb),{'action':_0x5de617(0x167),'contact':_0x26c500}),_0x10d8cc[_0x5de617(0x13e)](0xc8)[_0x5de617(0x182)](_0x26c500);};exports[a9_0x1194e2(0x15d)]=storeContacts;const removeAllContacts=async(_0x2be37,_0x2f41f8)=>{const _0x126a7d=a9_0x1194e2,{companyId:_0x4b70f0}=_0x2be37[_0x126a7d(0xf5)];try{await Contact_1[_0x126a7d(0x10e)][_0x126a7d(0xef)]({'where':{'companyId':_0x4b70f0}});const _0x5e4e9f=(0x0,socket_1[_0x126a7d(0x127)])();return _0x5e4e9f['emit'](_0x126a7d(0x120)+_0x4b70f0+_0x126a7d(0xdb),{'action':'deleteAll'}),setTimeout(async()=>{const _0x387ab9=_0x126a7d,{dateToClient:_0x5e036f}=(0x0,useDate_1[_0x387ab9(0xfd)])(),_0x2fee38=_0x5e036f(new Date()['toString']()),_0x58733d=(0x0,moment_1[_0x387ab9(0x10e)])()[_0x387ab9(0x140)]();try{const _0x124d9d=await ApiUsages_1['default'][_0x387ab9(0x14b)]({'where':{'dateUsed':_0x2fee38,'companyId':_0x4b70f0}});if(_0x124d9d)await _0x124d9d[_0x387ab9(0xfe)]({'usedOther':_0x124d9d[_0x387ab9(0x186)][_0x387ab9(0x106)]+0x1,'UsedOnDay':_0x124d9d[_0x387ab9(0x186)]['UsedOnDay']+0x1,'updatedAt':_0x58733d});else{const _0x5a1f50=await ApiUsages_1[_0x387ab9(0x10e)][_0x387ab9(0x167)]({'companyId':_0x4b70f0,'dateUsed':_0x2fee38});await _0x5a1f50[_0x387ab9(0xfe)]({'usedOther':_0x5a1f50[_0x387ab9(0x186)][_0x387ab9(0x106)]+0x1,'UsedOnDay':_0x5a1f50[_0x387ab9(0x186)][_0x387ab9(0xc7)]+0x1,'updatedAt':_0x58733d});}}catch(_0x4f0c85){return console[_0x387ab9(0x115)](_0x387ab9(0xdc),_0x4f0c85),_0x2f41f8['status'](0x1f4)[_0x387ab9(0xf9)]({'status':_0x387ab9(0x141),'message':_0x387ab9(0x128)});}},0x64),_0x2f41f8[_0x126a7d(0x13e)](0xc8)[_0x126a7d(0xf9)]({'status':_0x126a7d(0x164),'message':_0x126a7d(0xec)});}catch(_0x1d3657){return console[_0x126a7d(0x115)](_0x126a7d(0x114),_0x1d3657),_0x2f41f8[_0x126a7d(0x13e)](0x1f4)[_0x126a7d(0xf9)]({'status':'ERROR','message':_0x126a7d(0x128)});}};exports[a9_0x1194e2(0x13c)]=removeAllContacts;function a9_0x5e0c(_0x3407eb,_0x2e0ca6){const _0x4d5d62=a9_0x25e5();return a9_0x5e0c=function(_0x18ddf8,_0x31fc7f){_0x18ddf8=_0x18ddf8-0xbc;let _0x25e582=_0x4d5d62[_0x18ddf8];return _0x25e582;},a9_0x5e0c(_0x3407eb,_0x2e0ca6);}const updateContacts=async(_0x318043,_0xace34d)=>{const _0x508745=a9_0x1194e2,_0x33a57c=_0x318043['body'],{companyId:_0x4d5b82}=_0x318043[_0x508745(0xf5)],_0x448858=Yup['object']()[_0x508745(0x14d)]({'name':Yup[_0x508745(0xc8)](),'number':Yup[_0x508745(0xc8)]()[_0x508745(0xed)](/^\d+$/,_0x508745(0xf8))});try{await _0x448858[_0x508745(0xd9)](_0x33a57c);}catch(_0x21b6dd){throw new AppError_1['default'](_0x21b6dd['message']);}await(0x0,CheckIsValidContact_1['default'])(_0x33a57c[_0x508745(0xe3)],_0x4d5b82);const _0x622431=await(0x0,CheckNumber_1['default'])(_0x33a57c[_0x508745(0xe3)],_0x4d5b82),_0x28b0cb=_0x622431[_0x508745(0xe0)][_0x508745(0xd4)](/\D/g,'');_0x33a57c[_0x508745(0xe3)]=_0x28b0cb;const {contactId:_0xc5e02b}=_0x318043[_0x508745(0x100)],_0x2b44b8=await(0x0,UpdateContactService_1['default'])({'contactData':_0x33a57c,'contactId':_0xc5e02b,'companyId':_0x4d5b82}),_0x2b2355=(0x0,socket_1['getIO'])();return _0x2b2355[_0x508745(0x13f)]('company-'+_0x4d5b82+_0x508745(0xdb),{'action':_0x508745(0xfe),'contact':_0x2b44b8}),_0xace34d[_0x508745(0x13e)](0xc8)[_0x508745(0x182)](_0x2b44b8);};exports[a9_0x1194e2(0xbd)]=updateContacts;const removeContacts=async(_0x9302b3,_0x4f63e1)=>{const _0x1c99cd=a9_0x1194e2,{contactId:_0x146a63}=_0x9302b3['params'],{companyId:_0x1ba7f3}=_0x9302b3[_0x1c99cd(0xf5)];await(0x0,ShowContactService_1[_0x1c99cd(0x10e)])(_0x146a63,_0x1ba7f3),await(0x0,DeleteContactService_1[_0x1c99cd(0x10e)])(_0x146a63);const _0x5c2a9b=(0x0,socket_1[_0x1c99cd(0x127)])();return _0x5c2a9b[_0x1c99cd(0x13f)]('company-'+_0x1ba7f3+'-contact',{'action':_0x1c99cd(0x171),'contactId':_0x146a63}),_0x4f63e1[_0x1c99cd(0x13e)](0xc8)['json']({'message':_0x1c99cd(0x10c)});};exports[a9_0x1194e2(0x103)]=removeContacts;const uploadContacts=async(_0xd25170,_0x549df4)=>{const _0x3bedda=a9_0x1194e2,_0x1503a8=_0xd25170[_0x3bedda(0x12a)],_0x47caef=(0x0,lodash_1[_0x3bedda(0x113)])(_0x1503a8),{companyId:_0x9d5265}=_0xd25170['user'],_0x5bb70e=await(0x0,ImportXLSContactsService_1['ImportXLSContactsService'])(_0x9d5265,_0x47caef),_0x49fb1d=(0x0,socket_1[_0x3bedda(0x127)])(),_0x2868a5={'action':_0x3bedda(0x191),'records':_0x5bb70e};return _0x49fb1d['to'](_0x3bedda(0x120)+_0x9d5265+_0x3bedda(0x169))[_0x3bedda(0x13f)](_0x3bedda(0x120)+_0x9d5265+_0x3bedda(0xdb),_0x2868a5),_0x549df4[_0x3bedda(0x13e)](0xc8)[_0x3bedda(0x182)](_0x5bb70e);};exports['uploadContacts']=uploadContacts;const toggleDisableBotContacts=async(_0x2282fb,_0x1c7652)=>{const _0x4ed8f9=a9_0x1194e2,{contactId:_0x5e520a}=_0x2282fb[_0x4ed8f9(0x100)],{companyId:_0x4bd075}=_0x2282fb['user'],_0x3a1fd7=await(0x0,ToggleDisableBotService_1['default'])(_0x5e520a,_0x4bd075),_0x161f7c=(0x0,socket_1[_0x4ed8f9(0x127)])();return _0x161f7c['emit'](_0x4ed8f9(0x120)+_0x4bd075+_0x4ed8f9(0xdb),{'action':'update','contact':_0x3a1fd7}),_0x1c7652['status'](0xc8)[_0x4ed8f9(0x182)](_0x3a1fd7);};exports[a9_0x1194e2(0x116)]=toggleDisableBotContacts;