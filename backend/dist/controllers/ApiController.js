const a9_0x38c6d9=a9_0x54e2;(function(_0x4f8a32,_0x296e9d){const _0x1be39b=a9_0x54e2,_0x3e64ac=_0x4f8a32();while(!![]){try{const _0x56f54a=parseInt(_0x1be39b(0x1af))/0x1*(parseInt(_0x1be39b(0x244))/0x2)+parseInt(_0x1be39b(0x204))/0x3*(parseInt(_0x1be39b(0x1f3))/0x4)+parseInt(_0x1be39b(0x1b2))/0x5*(-parseInt(_0x1be39b(0x193))/0x6)+parseInt(_0x1be39b(0x1a6))/0x7*(-parseInt(_0x1be39b(0x192))/0x8)+-parseInt(_0x1be39b(0x1ad))/0x9+parseInt(_0x1be39b(0x1cf))/0xa+parseInt(_0x1be39b(0x230))/0xb;if(_0x56f54a===_0x296e9d)break;else _0x3e64ac['push'](_0x3e64ac['shift']());}catch(_0x32f06e){_0x3e64ac['push'](_0x3e64ac['shift']());}}}(a9_0x4bd8,0x81598));const a9_0x5ce5ad=(function(){let _0x1b08c4=!![];return function(_0x5eb5d5,_0x515d98){const _0x2f550d=_0x1b08c4?function(){const _0x33d2e2=a9_0x54e2;if(_0x515d98){const _0x12ff19=_0x515d98[_0x33d2e2(0x22d)](_0x5eb5d5,arguments);return _0x515d98=null,_0x12ff19;}}:function(){};return _0x1b08c4=![],_0x2f550d;};}()),a9_0x48a9cd=a9_0x5ce5ad(this,function(){const _0x5bf388=a9_0x54e2;return a9_0x48a9cd['toString']()[_0x5bf388(0x1e7)](_0x5bf388(0x1b5))[_0x5bf388(0x1ea)]()[_0x5bf388(0x209)](a9_0x48a9cd)[_0x5bf388(0x1e7)]('(((.+)+)+)+$');});function a9_0x54e2(_0x2ada6a,_0x2bc0a6){const _0x79eeee=a9_0x4bd8();return a9_0x54e2=function(_0x48a9cd,_0x5ce5ad){_0x48a9cd=_0x48a9cd-0x18b;let _0x4bd8a7=_0x79eeee[_0x48a9cd];return _0x4bd8a7;},a9_0x54e2(_0x2ada6a,_0x2bc0a6);}a9_0x48a9cd();'use strict';var __createBinding=this&&this[a9_0x38c6d9(0x1f5)]||(Object[a9_0x38c6d9(0x18e)]?function(_0x1e2354,_0x556a85,_0x66776e,_0x5bc3d2){const _0x5ac348=a9_0x38c6d9;if(_0x5bc3d2===undefined)_0x5bc3d2=_0x66776e;var _0x31b2c2=Object['getOwnPropertyDescriptor'](_0x556a85,_0x66776e);(!_0x31b2c2||(_0x5ac348(0x1fc)in _0x31b2c2?!_0x556a85[_0x5ac348(0x24a)]:_0x31b2c2['writable']||_0x31b2c2['configurable']))&&(_0x31b2c2={'enumerable':!![],'get':function(){return _0x556a85[_0x66776e];}}),Object[_0x5ac348(0x25e)](_0x1e2354,_0x5bc3d2,_0x31b2c2);}:function(_0x2c6e42,_0x3c2ef3,_0x82d46e,_0x27d000){if(_0x27d000===undefined)_0x27d000=_0x82d46e;_0x2c6e42[_0x27d000]=_0x3c2ef3[_0x82d46e];}),__setModuleDefault=this&&this['__setModuleDefault']||(Object[a9_0x38c6d9(0x18e)]?function(_0x35a3fa,_0x5c0bd3){const _0x54b754=a9_0x38c6d9;Object[_0x54b754(0x25e)](_0x35a3fa,'default',{'enumerable':!![],'value':_0x5c0bd3});}:function(_0x6f709,_0xb89602){_0x6f709['default']=_0xb89602;}),__importStar=this&&this['__importStar']||function(_0x50d91f){const _0x50c709=a9_0x38c6d9;if(_0x50d91f&&_0x50d91f[_0x50c709(0x24a)])return _0x50d91f;var _0x35110c={};if(_0x50d91f!=null){for(var _0x2e20db in _0x50d91f)if(_0x2e20db!==_0x50c709(0x1a3)&&Object['prototype'][_0x50c709(0x1ba)][_0x50c709(0x249)](_0x50d91f,_0x2e20db))__createBinding(_0x35110c,_0x50d91f,_0x2e20db);}return __setModuleDefault(_0x35110c,_0x50d91f),_0x35110c;},__importDefault=this&&this[a9_0x38c6d9(0x21b)]||function(_0x5e87c0){const _0x5121f4=a9_0x38c6d9;return _0x5e87c0&&_0x5e87c0[_0x5121f4(0x24a)]?_0x5e87c0:{'default':_0x5e87c0};};Object[a9_0x38c6d9(0x25e)](exports,a9_0x38c6d9(0x24a),{'value':!![]}),exports[a9_0x38c6d9(0x1b8)]=exports[a9_0x38c6d9(0x20d)]=exports[a9_0x38c6d9(0x1d8)]=exports[a9_0x38c6d9(0x22b)]=exports['removeAllContacts']=exports[a9_0x38c6d9(0x24e)]=exports[a9_0x38c6d9(0x1ed)]=exports[a9_0x38c6d9(0x1cb)]=exports[a9_0x38c6d9(0x1c1)]=exports[a9_0x38c6d9(0x1c5)]=exports[a9_0x38c6d9(0x198)]=exports['updateApi']=exports[a9_0x38c6d9(0x1c8)]=exports['showApi']=exports[a9_0x38c6d9(0x1c9)]=exports[a9_0x38c6d9(0x19c)]=exports[a9_0x38c6d9(0x234)]=exports[a9_0x38c6d9(0x218)]=exports['listTicketsByTag']=exports[a9_0x38c6d9(0x219)]=exports[a9_0x38c6d9(0x1d6)]=exports['updateTicketTag']=exports[a9_0x38c6d9(0x265)]=exports[a9_0x38c6d9(0x1ee)]=exports[a9_0x38c6d9(0x22f)]=exports[a9_0x38c6d9(0x215)]=exports[a9_0x38c6d9(0x18f)]=exports[a9_0x38c6d9(0x1b6)]=exports[a9_0x38c6d9(0x23a)]=exports[a9_0x38c6d9(0x226)]=exports[a9_0x38c6d9(0x1f7)]=exports[a9_0x38c6d9(0x1d1)]=exports[a9_0x38c6d9(0x1a2)]=void 0x0;const axios_1=__importDefault(require(a9_0x38c6d9(0x228))),fs_1=__importDefault(require('fs')),Yup=__importStar(require(a9_0x38c6d9(0x231))),lodash_1=require(a9_0x38c6d9(0x1c4)),GetDefaultWhatsApp_1=__importDefault(require(a9_0x38c6d9(0x233))),SetTicketMessagesAsRead_1=__importDefault(require('../helpers/SetTicketMessagesAsRead')),socket_1=require(a9_0x38c6d9(0x213)),Whatsapp_1=__importDefault(require('../models/Whatsapp')),Queue_1=__importDefault(require(a9_0x38c6d9(0x1e9))),User_1=__importDefault(require(a9_0x38c6d9(0x253))),CreateOrUpdateContactService_1=__importDefault(require(a9_0x38c6d9(0x212))),FindOrCreateTicketService_1=__importDefault(require('../services/TicketServices/FindOrCreateTicketService')),ShowTicketService_1=__importDefault(require(a9_0x38c6d9(0x236))),GetProfilePicUrl_1=__importDefault(require(a9_0x38c6d9(0x21d))),SendWhatsAppMedia_1=__importDefault(require(a9_0x38c6d9(0x1a7))),UpdateTicketService_1=__importDefault(require(a9_0x38c6d9(0x1e6))),wbot_1=require(a9_0x38c6d9(0x1c2)),SendWhatsAppMessageLink_1=__importDefault(require('../services/WbotServices/SendWhatsAppMessageLink')),SendWhatsAppMessageAPI_1=__importDefault(require(a9_0x38c6d9(0x25b))),SendWhatsappMediaImage_1=__importDefault(require(a9_0x38c6d9(0x1ae))),ListInvoicesServices_1=__importDefault(require(a9_0x38c6d9(0x1dc))),ShowInvoiceService_1=__importDefault(require(a9_0x38c6d9(0x248))),UpdateInvoiceService_1=__importDefault(require(a9_0x38c6d9(0x255))),Invoices_1=__importDefault(require('../models/Invoices')),ListContactsService_1=__importDefault(require(a9_0x38c6d9(0x19b))),CreateContactService_1=__importDefault(require(a9_0x38c6d9(0x1aa))),ShowContactService_1=__importDefault(require(a9_0x38c6d9(0x252))),UpdateContactService_1=__importDefault(require('../services/ContactServices/UpdateContactService')),DeleteContactService_1=__importDefault(require(a9_0x38c6d9(0x1f6))),GetContactService_1=__importDefault(require(a9_0x38c6d9(0x1e5))),ToggleDisableBotService_1=__importDefault(require('../services/ContactServices/ToggleDisableBotService')),CheckNumber_1=__importDefault(require(a9_0x38c6d9(0x19e))),CheckIsValidContact_1=__importDefault(require(a9_0x38c6d9(0x1f4))),AppError_1=__importDefault(require(a9_0x38c6d9(0x24b))),SimpleListService_1=__importDefault(require(a9_0x38c6d9(0x22e))),ImportXLSContactsService_1=require('../services/ContactServices/ImportXLSContactsService'),ApiUsages_1=__importDefault(require(a9_0x38c6d9(0x239))),useDate_1=require('../utils/useDate'),TicketTag_1=__importDefault(require(a9_0x38c6d9(0x1e2))),Tag_1=__importDefault(require('../models/Tag')),moment_1=__importDefault(require(a9_0x38c6d9(0x1d5))),path_1=__importDefault(require(a9_0x38c6d9(0x202))),Ticket_1=__importDefault(require(a9_0x38c6d9(0x1fb))),Contact_1=__importDefault(require(a9_0x38c6d9(0x1ac))),Company_1=__importDefault(require('../models/Company')),SendPresenceStatus_1=require(a9_0x38c6d9(0x241));class OnWhatsAppDto{constructor(_0x49cc89,_0x1be1b7){const _0x5cd639=a9_0x38c6d9;this[_0x5cd639(0x1d0)]=_0x49cc89,this[_0x5cd639(0x1fe)]=_0x1be1b7;}}exports['OnWhatsAppDto']=OnWhatsAppDto;const CompanySchema=Yup[a9_0x38c6d9(0x1b0)]()[a9_0x38c6d9(0x18d)]({'name':Yup[a9_0x38c6d9(0x1d7)]()[a9_0x38c6d9(0x262)](),'id':Yup[a9_0x38c6d9(0x214)](),'phone':Yup[a9_0x38c6d9(0x1d7)]()[a9_0x38c6d9(0x237)](),'email':Yup[a9_0x38c6d9(0x1d7)]()[a9_0x38c6d9(0x1a1)]()[a9_0x38c6d9(0x237)](),'status':Yup[a9_0x38c6d9(0x264)]()[a9_0x38c6d9(0x237)](),'planId':Yup[a9_0x38c6d9(0x214)]()['nullable'](),'campaignsEnabled':Yup[a9_0x38c6d9(0x264)]()[a9_0x38c6d9(0x237)](),'dueDate':Yup[a9_0x38c6d9(0x1c6)]()[a9_0x38c6d9(0x237)](),'recurrence':Yup[a9_0x38c6d9(0x1d7)]()[a9_0x38c6d9(0x237)]()}),createCompany=async(_0x5d6ac1,_0x3b1949)=>{const _0x594029=a9_0x38c6d9;try{await CompanySchema[_0x594029(0x242)](_0x5d6ac1['body']);const _0x253089=await Company_1[_0x594029(0x1a3)][_0x594029(0x18e)](_0x5d6ac1[_0x594029(0x260)]);_0x3b1949[_0x594029(0x222)](0xc9)[_0x594029(0x1b4)](_0x253089);}catch(_0x15bcda){_0x3b1949['status'](0x190)[_0x594029(0x1b4)]({'error':_0x15bcda['message']});}};exports[a9_0x38c6d9(0x1d1)]=createCompany;const updateCompany=async(_0x3858e3,_0xc35c11)=>{const _0x6bd3be=a9_0x38c6d9;try{await CompanySchema[_0x6bd3be(0x242)](_0x3858e3[_0x6bd3be(0x260)]);const {id:_0x26b34c}=_0x3858e3[_0x6bd3be(0x257)],[_0x495625]=await Company_1[_0x6bd3be(0x1a3)][_0x6bd3be(0x1be)](_0x3858e3[_0x6bd3be(0x260)],{'where':{'id':_0x26b34c}});if(_0x495625){const _0x5bb02e=await Company_1['default'][_0x6bd3be(0x227)](_0x26b34c);_0xc35c11['status'](0xc8)[_0x6bd3be(0x1b4)](_0x5bb02e);}else _0xc35c11[_0x6bd3be(0x222)](0x194)[_0x6bd3be(0x1b4)]({'error':_0x6bd3be(0x190)});}catch(_0x24e2a4){_0xc35c11['status'](0x190)[_0x6bd3be(0x1b4)]({'error':_0x24e2a4[_0x6bd3be(0x20b)]});}};exports[a9_0x38c6d9(0x1f7)]=updateCompany;const blockCompany=async(_0x320898,_0x14cfd9)=>{const _0x218cf0=a9_0x38c6d9;try{const {id:_0x5a964a}=_0x320898[_0x218cf0(0x257)],[_0x4f0a96]=await Company_1[_0x218cf0(0x1a3)][_0x218cf0(0x1be)]({'status':![]},{'where':{'id':_0x5a964a}});if(_0x4f0a96){const _0x3fed41=await Company_1[_0x218cf0(0x1a3)][_0x218cf0(0x227)](_0x5a964a);_0x14cfd9['status'](0xc8)[_0x218cf0(0x1b4)](_0x3fed41);}else _0x14cfd9[_0x218cf0(0x222)](0x194)[_0x218cf0(0x1b4)]({'error':_0x218cf0(0x190)});}catch(_0x573404){_0x14cfd9[_0x218cf0(0x222)](0x190)[_0x218cf0(0x1b4)]({'error':_0x573404['message']});}};exports[a9_0x38c6d9(0x226)]=blockCompany;const createContact=async(_0x3a30b1,_0x53a1cf,_0x89be8b)=>{const _0x39abe6=a9_0x38c6d9;await(0x0,CheckIsValidContact_1['default'])(_0x89be8b,_0x53a1cf);const _0x1741b3=await(0x0,CheckNumber_1[_0x39abe6(0x1a3)])(_0x89be8b,_0x53a1cf),_0x16eb39=await(0x0,GetProfilePicUrl_1[_0x39abe6(0x1a3)])(_0x1741b3,_0x53a1cf),_0x2ad177=_0x1741b3,_0x366d34={'name':''+_0x2ad177,'number':_0x2ad177,'profilePicUrl':_0x16eb39,'isGroup':![],'companyId':_0x53a1cf},_0xe16f66=await(0x0,CreateOrUpdateContactService_1[_0x39abe6(0x1a3)])(_0x366d34,null,null);let _0x2af6a6;if(_0x3a30b1===undefined)_0x2af6a6=await(0x0,GetDefaultWhatsApp_1[_0x39abe6(0x1a3)])(_0x53a1cf);else{_0x2af6a6=await Whatsapp_1['default']['findByPk'](_0x3a30b1);if(_0x2af6a6===null)throw new AppError_1[(_0x39abe6(0x1a3))](_0x39abe6(0x261)+_0x3a30b1+_0x39abe6(0x224));}const _0x4556f2=await(0x0,FindOrCreateTicketService_1[_0x39abe6(0x1a3)])(_0xe16f66,_0x2af6a6['id'],0x0,_0x53a1cf),_0x4fa3a5=await(0x0,ShowTicketService_1[_0x39abe6(0x1a3)])(_0x4556f2['id'],_0x53a1cf);return(0x0,SetTicketMessagesAsRead_1[_0x39abe6(0x1a3)])(_0x4fa3a5),_0x4fa3a5;};function formatBRNumber(_0x487277){const _0x490651=a9_0x38c6d9,_0x805482=new RegExp(/^(\d{2})(\d{2})\d{1}(\d{8})$/);if(_0x805482[_0x490651(0x24d)](_0x487277)){const _0x4ae40c=_0x805482[_0x490651(0x1bd)](_0x487277);if(_0x4ae40c&&_0x4ae40c[0x1]==='55'&&Number['isInteger'](Number[_0x490651(0x1ca)](_0x4ae40c[0x2]))){const _0x3da601=Number['parseInt'](_0x4ae40c[0x2]);if(_0x3da601<0x1f)return _0x4ae40c[0x0];else{if(_0x3da601>=0x1f)return _0x4ae40c[0x1]+_0x4ae40c[0x2]+_0x4ae40c[0x3];}}}else return _0x487277;}function createJid(_0x193a41){const _0x58c216=a9_0x38c6d9;if(_0x193a41[_0x58c216(0x229)](_0x58c216(0x1cc))||_0x193a41[_0x58c216(0x229)]('@s.whatsapp.net'))return formatBRNumber(_0x193a41);return _0x193a41[_0x58c216(0x229)]('-')?_0x193a41+_0x58c216(0x1cc):formatBRNumber(_0x193a41)+_0x58c216(0x1bb);}const indexLink=async(_0x155dcd,_0x39b111)=>{const _0x1d092d=a9_0x38c6d9,_0x224afb=_0x155dcd[_0x1d092d(0x260)],{whatsappId:_0x1c0503}=_0x155dcd[_0x1d092d(0x260)],{msdelay:_0x19db7b}=_0x155dcd['body'],_0x249895=_0x155dcd[_0x1d092d(0x260)][_0x1d092d(0x22c)],_0x260b69=_0x155dcd[_0x1d092d(0x260)]['caption'],_0x4f01e1=_0x155dcd[_0x1d092d(0x1b3)][_0x1d092d(0x1ef)],[,_0x2d2775]=_0x4f01e1['split']('\x20'),_0x2a5b31=await Whatsapp_1['default']['findOne']({'where':{'token':_0x2d2775}}),_0x462c7d=_0x2a5b31[_0x1d092d(0x20e)];_0x224afb[_0x1d092d(0x214)]=_0x224afb[_0x1d092d(0x214)][_0x1d092d(0x1d9)]('-','')[_0x1d092d(0x1d9)]('\x20','');const _0x34a509=Yup[_0x1d092d(0x1b0)]()[_0x1d092d(0x18d)]({'number':Yup[_0x1d092d(0x1d7)]()[_0x1d092d(0x262)]()[_0x1d092d(0x210)](/^\d+$/,'Invalid\x20number\x20format.\x20Only\x20numbers\x20is\x20allowed.')});try{await _0x34a509['validate'](_0x224afb);}catch(_0x479ce0){throw new AppError_1['default'](_0x479ce0['message']);}const _0x2ff854=await createContact(_0x1c0503,_0x462c7d,_0x224afb[_0x1d092d(0x214)]);return await(0x0,SendWhatsAppMessageLink_1['default'])({'ticket':_0x2ff854,'url':_0x249895,'caption':_0x260b69,'msdelay':_0x19db7b}),setTimeout(async()=>{const _0x45679b=_0x1d092d;await(0x0,UpdateTicketService_1[_0x45679b(0x1a3)])({'ticketId':_0x2ff854['id'],'ticketData':{'status':_0x45679b(0x19d),'sendFarewellMessage':![],'amountUsedBotQueues':0x0},'companyId':_0x462c7d});},0xc8),setTimeout(async()=>{const _0x26ab6a=_0x1d092d,{dateToClient:_0x2b82eb}=(0x0,useDate_1[_0x26ab6a(0x245)])(),_0x410636=_0x2b82eb(new Date()['toString']()),_0xb2314e=(0x0,moment_1['default'])()[_0x26ab6a(0x19a)](),_0x3b1bac=await ApiUsages_1[_0x26ab6a(0x1a3)][_0x26ab6a(0x1e0)]({'where':{'dateUsed':_0x410636,'companyId':_0x462c7d}});if(_0x3b1bac)await _0x3b1bac[_0x26ab6a(0x1be)]({'usedPDF':_0x3b1bac['dataValues']['usedPDF']+0x1,'UsedOnDay':_0x3b1bac['dataValues']['UsedOnDay']+0x1,'updatedAt':_0xb2314e});else{const _0x3546dc=await ApiUsages_1[_0x26ab6a(0x1a3)][_0x26ab6a(0x18e)]({'companyId':_0x462c7d,'dateUsed':_0x410636});await _0x3546dc['update']({'usedPDF':_0x3546dc['dataValues'][_0x26ab6a(0x263)]+0x1,'UsedOnDay':_0x3546dc[_0x26ab6a(0x200)][_0x26ab6a(0x243)]+0x1,'updatedAt':_0xb2314e});}},0x64),_0x39b111[_0x1d092d(0x25a)]({'status':_0x1d092d(0x1c7)});};exports['indexLink']=indexLink;const index=async(_0x824074,_0x1e7a27)=>{const _0x24135b=a9_0x38c6d9,_0x5ecc1d=_0x824074['body'],{whatsappId:_0x1545cd}=_0x824074[_0x24135b(0x260)],{msdelay:_0x47bcff}=_0x824074['body'],{body:_0x54d449,quotedMsg:_0x49a821}=_0x824074['body'],_0x1af9e0=_0x824074[_0x24135b(0x1f1)],_0x107357=_0x824074[_0x24135b(0x1b3)][_0x24135b(0x1ef)],[,_0x5eb240]=_0x107357[_0x24135b(0x267)]('\x20'),_0x48a83c=await Whatsapp_1[_0x24135b(0x1a3)][_0x24135b(0x1e0)]({'where':{'token':_0x5eb240}}),_0x74dca5=_0x48a83c[_0x24135b(0x20e)];_0x5ecc1d['number']=_0x5ecc1d[_0x24135b(0x214)][_0x24135b(0x1d9)]('-','')[_0x24135b(0x1d9)]('\x20','');const _0x59fbb3=Yup[_0x24135b(0x1b0)]()['shape']({'number':Yup[_0x24135b(0x1d7)]()['required']()['matches'](/^\d+$/,_0x24135b(0x1f2))});try{await _0x59fbb3[_0x24135b(0x242)](_0x5ecc1d);}catch(_0x2c3dd0){throw new AppError_1[(_0x24135b(0x1a3))](_0x2c3dd0[_0x24135b(0x20b)]);}const _0x2d5096=await createContact(_0x1545cd,_0x74dca5,_0x5ecc1d[_0x24135b(0x214)]);return _0x1af9e0?await Promise[_0x24135b(0x1d3)](_0x1af9e0[_0x24135b(0x1d2)](async _0x373295=>{const _0xcd4012=_0x24135b;await(0x0,SendWhatsAppMedia_1[_0xcd4012(0x1a3)])({'body':_0x54d449,'media':_0x373295,'ticket':_0x2d5096});})):await(0x0,SendWhatsAppMessageAPI_1[_0x24135b(0x1a3)])({'body':_0x54d449,'ticket':_0x2d5096,'quotedMsg':_0x49a821,'msdelay':_0x47bcff}),setTimeout(async()=>{const _0x10affe=_0x24135b;await(0x0,UpdateTicketService_1[_0x10affe(0x1a3)])({'ticketId':_0x2d5096['id'],'ticketData':{'status':_0x10affe(0x19d),'sendFarewellMessage':![],'amountUsedBotQueues':0x0},'companyId':_0x74dca5});},0x64),setTimeout(async()=>{const _0x221623=_0x24135b,{dateToClient:_0x438686}=(0x0,useDate_1['useDate'])(),_0x34b354=_0x438686(new Date()[_0x221623(0x1ea)]()),_0x35f5d4=(0x0,moment_1[_0x221623(0x1a3)])()[_0x221623(0x19a)](),_0x5abc21=await ApiUsages_1['default'][_0x221623(0x1e0)]({'where':{'dateUsed':_0x34b354,'companyId':_0x74dca5}});_0x5abc21?_0x1af9e0?await Promise[_0x221623(0x1d3)](_0x1af9e0['map'](async _0x208511=>{const _0x27e41c=_0x221623;console['log']('media',_0x208511);const _0x1c6349=path_1['default']['extname'](_0x208511[_0x27e41c(0x1a9)]);console[_0x27e41c(0x21c)](_0x27e41c(0x211),_0x1c6349);if(_0x208511[_0x27e41c(0x207)][_0x27e41c(0x229)]('pdf'))await _0x5abc21[_0x27e41c(0x1be)]({'usedPDF':_0x5abc21['dataValues']['usedPDF']+0x1,'UsedOnDay':_0x5abc21[_0x27e41c(0x200)][_0x27e41c(0x243)]+0x1,'updatedAt':_0x35f5d4});else{if(_0x208511[_0x27e41c(0x207)][_0x27e41c(0x229)](_0x27e41c(0x1f0)))await _0x5abc21[_0x27e41c(0x1be)]({'usedImage':_0x5abc21[_0x27e41c(0x200)][_0x27e41c(0x223)]+0x1,'UsedOnDay':_0x5abc21[_0x27e41c(0x200)][_0x27e41c(0x243)]+0x1,'updatedAt':_0x35f5d4});else _0x208511[_0x27e41c(0x207)][_0x27e41c(0x229)](_0x27e41c(0x250))?await _0x5abc21[_0x27e41c(0x1be)]({'usedVideo':_0x5abc21[_0x27e41c(0x200)][_0x27e41c(0x194)]+0x1,'UsedOnDay':_0x5abc21[_0x27e41c(0x200)]['UsedOnDay']+0x1,'updatedAt':_0x35f5d4}):await _0x5abc21['update']({'usedOther':_0x5abc21[_0x27e41c(0x200)][_0x27e41c(0x238)]+0x1,'UsedOnDay':_0x5abc21[_0x27e41c(0x200)][_0x27e41c(0x243)]+0x1,'updatedAt':_0x35f5d4});}})):await _0x5abc21[_0x221623(0x1be)]({'usedText':_0x5abc21[_0x221623(0x200)][_0x221623(0x1b1)]+0x1,'UsedOnDay':_0x5abc21[_0x221623(0x200)][_0x221623(0x243)]+0x1,'updatedAt':_0x35f5d4}):(await ApiUsages_1[_0x221623(0x1a3)]['create']({'companyId':_0x74dca5,'dateUsed':_0x34b354}),_0x1af9e0?await Promise[_0x221623(0x1d3)](_0x1af9e0['map'](async _0x2c8d5a=>{const _0x5243fa=_0x221623;console[_0x5243fa(0x21c)](_0x5243fa(0x197),_0x2c8d5a);const _0x2e0b06=path_1['default'][_0x5243fa(0x203)](_0x2c8d5a[_0x5243fa(0x1a9)]);console[_0x5243fa(0x21c)](_0x5243fa(0x211),_0x2e0b06);if(_0x2c8d5a[_0x5243fa(0x207)]['includes'](_0x5243fa(0x1ce)))await _0x5abc21[_0x5243fa(0x1be)]({'usedPDF':_0x5abc21[_0x5243fa(0x200)][_0x5243fa(0x263)]+0x1,'UsedOnDay':_0x5abc21[_0x5243fa(0x200)][_0x5243fa(0x243)]+0x1,'updatedAt':_0x35f5d4});else{if(_0x2c8d5a['mimetype'][_0x5243fa(0x229)]('image'))await _0x5abc21[_0x5243fa(0x1be)]({'usedImage':_0x5abc21[_0x5243fa(0x200)][_0x5243fa(0x223)]+0x1,'UsedOnDay':_0x5abc21[_0x5243fa(0x200)]['UsedOnDay']+0x1,'updatedAt':_0x35f5d4});else _0x2c8d5a[_0x5243fa(0x207)][_0x5243fa(0x229)](_0x5243fa(0x250))?await _0x5abc21[_0x5243fa(0x1be)]({'usedVideo':_0x5abc21[_0x5243fa(0x200)]['usedVideo']+0x1,'UsedOnDay':_0x5abc21[_0x5243fa(0x200)]['UsedOnDay']+0x1,'updatedAt':_0x35f5d4}):await _0x5abc21[_0x5243fa(0x1be)]({'usedOther':_0x5abc21[_0x5243fa(0x200)][_0x5243fa(0x238)]+0x1,'UsedOnDay':_0x5abc21[_0x5243fa(0x200)][_0x5243fa(0x243)]+0x1,'updatedAt':_0x35f5d4});}})):await _0x5abc21[_0x221623(0x1be)]({'usedText':_0x5abc21['dataValues'][_0x221623(0x1b1)]+0x1,'UsedOnDay':_0x5abc21['dataValues']['UsedOnDay']+0x1,'updatedAt':_0x35f5d4}));},0x64),_0x1e7a27[_0x24135b(0x25a)]({'status':_0x24135b(0x1c7)});};exports[a9_0x38c6d9(0x1b6)]=index;const indexImage=async(_0x28498e,_0x17a083)=>{const _0x36e759=a9_0x38c6d9,_0x5094d2=_0x28498e[_0x36e759(0x260)],{whatsappId:_0x571310}=_0x28498e[_0x36e759(0x260)],{msdelay:_0x520f2c}=_0x28498e[_0x36e759(0x260)],_0xf2541f=_0x28498e[_0x36e759(0x260)][_0x36e759(0x22c)],_0x191c59=_0x28498e[_0x36e759(0x260)][_0x36e759(0x251)],_0x124cd9=_0x28498e[_0x36e759(0x1b3)][_0x36e759(0x1ef)],[,_0x4ce10a]=_0x124cd9['split']('\x20'),_0x5ba654=await Whatsapp_1[_0x36e759(0x1a3)][_0x36e759(0x1e0)]({'where':{'token':_0x4ce10a}}),_0x589349=_0x5ba654[_0x36e759(0x20e)];_0x5094d2['number']=_0x5094d2[_0x36e759(0x214)][_0x36e759(0x1d9)]('-','')[_0x36e759(0x1d9)]('\x20','');const _0x40ea7c=Yup[_0x36e759(0x1b0)]()[_0x36e759(0x18d)]({'number':Yup[_0x36e759(0x1d7)]()[_0x36e759(0x262)]()[_0x36e759(0x210)](/^\d+$/,_0x36e759(0x1f2))});try{await _0x40ea7c[_0x36e759(0x242)](_0x5094d2);}catch(_0x47db8e){throw new AppError_1[(_0x36e759(0x1a3))](_0x47db8e['message']);}const _0x2e1ecd=await createContact(_0x571310,_0x589349,_0x5094d2[_0x36e759(0x214)]);return _0xf2541f&&await(0x0,SendWhatsappMediaImage_1[_0x36e759(0x1a3)])({'ticket':_0x2e1ecd,'url':_0xf2541f,'caption':_0x191c59,'msdelay':_0x520f2c}),setTimeout(async()=>{const _0x43565e=_0x36e759;await(0x0,UpdateTicketService_1[_0x43565e(0x1a3)])({'ticketId':_0x2e1ecd['id'],'ticketData':{'status':_0x43565e(0x19d),'sendFarewellMessage':![],'amountUsedBotQueues':0x0},'companyId':_0x589349});},0x64),setTimeout(async()=>{const _0x317336=_0x36e759,{dateToClient:_0x3f05df}=(0x0,useDate_1[_0x317336(0x245)])(),_0xb86da8=_0x3f05df(new Date()[_0x317336(0x1ea)]()),_0x44e5b9=(0x0,moment_1[_0x317336(0x1a3)])()[_0x317336(0x19a)](),_0x5209ea=await ApiUsages_1['default'][_0x317336(0x1e0)]({'where':{'dateUsed':_0xb86da8,'companyId':_0x589349}});if(_0x5209ea)await _0x5209ea['update']({'usedImage':_0x5209ea[_0x317336(0x200)]['usedImage']+0x1,'UsedOnDay':_0x5209ea['dataValues'][_0x317336(0x243)]+0x1,'updatedAt':_0x44e5b9});else{const _0x35c3d8=await ApiUsages_1[_0x317336(0x1a3)][_0x317336(0x18e)]({'companyId':_0x589349,'dateUsed':_0xb86da8});await _0x35c3d8[_0x317336(0x1be)]({'usedImage':_0x35c3d8[_0x317336(0x200)]['usedImage']+0x1,'UsedOnDay':_0x35c3d8[_0x317336(0x200)]['UsedOnDay']+0x1,'updatedAt':_0x44e5b9});}},0x64),_0x17a083[_0x36e759(0x25a)]({'status':_0x36e759(0x1c7)});};exports[a9_0x38c6d9(0x18f)]=indexImage;const checkNumber=async(_0x93a3b1,_0x588024)=>{const _0x540369=a9_0x38c6d9,_0x3fe8c1=_0x93a3b1['body'],_0x5f3aa5=_0x93a3b1[_0x540369(0x1b3)]['authorization'],[,_0x563ab7]=_0x5f3aa5[_0x540369(0x267)]('\x20'),_0x7a949f=await Whatsapp_1[_0x540369(0x1a3)][_0x540369(0x1e0)]({'where':{'token':_0x563ab7}}),_0x47682c=_0x7a949f[_0x540369(0x20e)],_0x109f6b=_0x3fe8c1[_0x540369(0x214)][_0x540369(0x1d9)]('-','')[_0x540369(0x1d9)]('\x20',''),_0x5b760e=await(0x0,GetDefaultWhatsApp_1['default'])(_0x47682c),_0x9fab21=(0x0,wbot_1[_0x540369(0x246)])(_0x5b760e['id']),_0x288249=createJid(_0x109f6b);try{const [_0x49b3ee]=await _0x9fab21[_0x540369(0x1c3)](_0x288249);if(_0x49b3ee[_0x540369(0x1fe)])return setTimeout(async()=>{const _0x49fe2d=_0x540369,{dateToClient:_0x7e38ae}=(0x0,useDate_1[_0x49fe2d(0x245)])(),_0x5c56b4=_0x7e38ae(new Date()[_0x49fe2d(0x1ea)]()),_0x2d663d=(0x0,moment_1['default'])()[_0x49fe2d(0x19a)](),_0x12a33f=await ApiUsages_1[_0x49fe2d(0x1a3)][_0x49fe2d(0x1e0)]({'where':{'dateUsed':_0x5c56b4,'companyId':_0x47682c}});if(_0x12a33f)await _0x12a33f[_0x49fe2d(0x1be)]({'usedCheckNumber':_0x12a33f[_0x49fe2d(0x200)]['usedCheckNumber']+0x1,'UsedOnDay':_0x12a33f[_0x49fe2d(0x200)]['UsedOnDay']+0x1,'updatedAt':_0x2d663d});else{const _0x43e52c=await ApiUsages_1[_0x49fe2d(0x1a3)]['create']({'companyId':_0x47682c,'dateUsed':_0x5c56b4});await _0x43e52c[_0x49fe2d(0x1be)]({'usedCheckNumber':_0x43e52c[_0x49fe2d(0x200)]['usedCheckNumber']+0x1,'UsedOnDay':_0x43e52c[_0x49fe2d(0x200)][_0x49fe2d(0x243)]+0x1,'updatedAt':_0x2d663d});}},0x64),_0x588024[_0x540369(0x222)](0xc8)['json']({'existsInWhatsapp':!![],'number':_0x109f6b,'numberFormatted':_0x49b3ee[_0x540369(0x1d0)]});}catch(_0x102fa6){return _0x588024[_0x540369(0x222)](0x190)[_0x540369(0x1b4)]({'existsInWhatsapp':![],'number':_0x288249,'error':_0x540369(0x199)});}};exports[a9_0x38c6d9(0x215)]=checkNumber;const indexWhatsappsId=async(_0x23db14,_0x45a433)=>{const _0x3a79b1=a9_0x38c6d9;return console[_0x3a79b1(0x21c)]('req',_0x23db14),console[_0x3a79b1(0x21c)](_0x3a79b1(0x1de),_0x23db14[_0x3a79b1(0x21e)]),_0x45a433['status'](0xc8)[_0x3a79b1(0x1b4)]('oi');};exports[a9_0x38c6d9(0x22f)]=indexWhatsappsId;const updateQueueId=async(_0xa3189e,_0x5ae17f)=>{const _0x57e0a1=a9_0x38c6d9,{ticketId:_0x4144ee}=_0xa3189e[_0x57e0a1(0x257)],{queueId:_0x5eca76}=_0xa3189e[_0x57e0a1(0x260)],_0x3d65e4=_0xa3189e[_0x57e0a1(0x1b3)]['authorization'],[,_0x2ffd79]=_0x3d65e4[_0x57e0a1(0x267)]('\x20'),_0x147821=await Whatsapp_1['default'][_0x57e0a1(0x1e0)]({'where':{'token':_0x2ffd79}}),_0x59fb5b=_0x147821[_0x57e0a1(0x20e)];try{const _0x2cb4d2=await Queue_1[_0x57e0a1(0x1a3)]['findOne']({'where':{'id':_0x5eca76,'companyId':_0x59fb5b}});if(!_0x2cb4d2)return _0x5ae17f[_0x57e0a1(0x222)](0x190)['json']({'status':_0x57e0a1(0x23f),'error':_0x57e0a1(0x1ec)});return await(0x0,UpdateTicketService_1['default'])({'ticketId':_0x4144ee,'ticketData':{'queueId':_0x5eca76},'companyId':_0x59fb5b}),_0x5ae17f[_0x57e0a1(0x222)](0xc8)['json']({'status':_0x57e0a1(0x1c7)});}catch(_0x2cb61f){return console[_0x57e0a1(0x24c)](_0x2cb61f),_0x5ae17f[_0x57e0a1(0x222)](0x1f4)[_0x57e0a1(0x1b4)]({'status':'ERROR','error':_0x57e0a1(0x1bf)});}};exports['updateQueueId']=updateQueueId;const closeTicket=async(_0x1daf3a,_0x304bc6)=>{const _0x794618=a9_0x38c6d9,_0x22fcbd=_0x1daf3a[_0x794618(0x1b3)][_0x794618(0x1ef)],[,_0x408e8b]=_0x22fcbd[_0x794618(0x267)]('\x20'),_0x40bf8c=await Whatsapp_1[_0x794618(0x1a3)]['findOne']({'where':{'token':_0x408e8b}}),_0x346d5a=_0x40bf8c['companyId'],{ticketId:_0x4baf8f}=_0x1daf3a[_0x794618(0x257)],_0x58dd6a=await(0x0,ShowTicketService_1[_0x794618(0x1a3)])(_0x4baf8f,_0x346d5a);_0x58dd6a[_0x794618(0x222)]=_0x1daf3a[_0x794618(0x260)][_0x794618(0x235)][_0x794618(0x222)],console[_0x794618(0x21c)](_0x58dd6a['status']);const {ticket:_0x330e41}=await(0x0,UpdateTicketService_1[_0x794618(0x1a3)])({'ticketData':_0x58dd6a,'ticketId':_0x4baf8f,'companyId':_0x346d5a});return _0x304bc6[_0x794618(0x222)](0xc8)[_0x794618(0x1b4)](_0x330e41);};exports[a9_0x38c6d9(0x265)]=closeTicket;const updateTicketTag=async(_0x23b43a,_0x5cdd46)=>{const _0x135a9d=a9_0x38c6d9,{ticketId:_0x2fb360,tagId:_0x3b5245}=_0x23b43a[_0x135a9d(0x260)],_0x55822a=_0x23b43a['headers'][_0x135a9d(0x1ef)],[,_0xd69448]=_0x55822a[_0x135a9d(0x267)]('\x20');try{const _0x36468f=await Whatsapp_1[_0x135a9d(0x1a3)][_0x135a9d(0x1e0)]({'where':{'token':_0xd69448}}),_0x1fed47=_0x36468f[_0x135a9d(0x20e)],_0x18ef1e=await Tag_1['default'][_0x135a9d(0x1e0)]({'where':{'id':_0x3b5245,'companyId':_0x1fed47}});if(!_0x18ef1e)return _0x5cdd46['status'](0x190)[_0x135a9d(0x1b4)]({'status':_0x135a9d(0x23f),'error':'Tag\x20does\x20not\x20belong\x20to\x20the\x20specified\x20company'});const _0x5574f0=await TicketTag_1[_0x135a9d(0x1a3)][_0x135a9d(0x1e0)]({'where':{'ticketId':_0x2fb360,'tagId':_0x3b5245}});if(_0x5574f0)return _0x5cdd46[_0x135a9d(0x222)](0x190)[_0x135a9d(0x1b4)]({'status':_0x135a9d(0x23f),'error':_0x135a9d(0x206)});const _0x3c0aed=await TicketTag_1[_0x135a9d(0x1a3)][_0x135a9d(0x18e)]({'ticketId':_0x2fb360,'tagId':_0x3b5245});return _0x5cdd46[_0x135a9d(0x222)](0xc8)[_0x135a9d(0x1b4)]({'status':_0x135a9d(0x1c7),'ticketTag':_0x3c0aed});}catch(_0x355e82){return console[_0x135a9d(0x24c)](_0x355e82),_0x5cdd46[_0x135a9d(0x222)](0x1f4)[_0x135a9d(0x1b4)]({'status':_0x135a9d(0x23f),'error':_0x135a9d(0x254)});}};exports[a9_0x38c6d9(0x1e3)]=updateTicketTag;const removeTicketTag=async(_0x52c573,_0x36f93a)=>{const _0x1b4e8a=a9_0x38c6d9,{ticketId:_0x40399f,tagId:_0x456db3}=_0x52c573[_0x1b4e8a(0x260)];try{const _0x55ce72=await TicketTag_1[_0x1b4e8a(0x1a3)][_0x1b4e8a(0x1e0)]({'where':{'ticketId':_0x40399f,'tagId':_0x456db3}});if(!_0x55ce72)return _0x36f93a[_0x1b4e8a(0x222)](0x190)[_0x1b4e8a(0x1b4)]({'status':_0x1b4e8a(0x23f),'error':'Tag\x20is\x20not\x20associated\x20with\x20the\x20ticket'});return await _0x55ce72[_0x1b4e8a(0x1a8)](),_0x36f93a[_0x1b4e8a(0x222)](0xc8)[_0x1b4e8a(0x1b4)]({'status':'SUCCESS'});}catch(_0x47a702){return console[_0x1b4e8a(0x24c)](_0x47a702),_0x36f93a[_0x1b4e8a(0x222)](0x1f4)[_0x1b4e8a(0x1b4)]({'status':_0x1b4e8a(0x23f),'error':_0x1b4e8a(0x1a4)});}};exports[a9_0x38c6d9(0x1d6)]=removeTicketTag;const listTicketsByCompany=async(_0x5e1773,_0x84f9e3)=>{const _0x20eeba=a9_0x38c6d9,_0x1f307d=_0x5e1773[_0x20eeba(0x1b3)][_0x20eeba(0x1ef)],[,_0x5c663a]=_0x1f307d[_0x20eeba(0x267)]('\x20'),_0x5b6185=await Whatsapp_1[_0x20eeba(0x1a3)][_0x20eeba(0x1e0)]({'where':{'token':_0x5c663a}}),_0x562acb=_0x5b6185[_0x20eeba(0x20e)];try{const _0x1ef6f1=await Ticket_1[_0x20eeba(0x1a3)][_0x20eeba(0x220)]({'where':{'companyId':_0x562acb},'include':[{'model':Contact_1[_0x20eeba(0x1a3)],'as':'contact','attributes':['id',_0x20eeba(0x247),_0x20eeba(0x214),_0x20eeba(0x1a1),'profilePicUrl',_0x20eeba(0x25f),_0x20eeba(0x1eb),_0x20eeba(0x1c0)],'include':[_0x20eeba(0x23c)]},{'model':Queue_1[_0x20eeba(0x1a3)],'as':_0x20eeba(0x18c),'attributes':['id','name',_0x20eeba(0x23b)]},{'model':User_1[_0x20eeba(0x1a3)],'as':_0x20eeba(0x21e),'attributes':['id',_0x20eeba(0x247)]},{'model':Tag_1[_0x20eeba(0x1a3)],'as':_0x20eeba(0x256),'attributes':['id',_0x20eeba(0x247),'color']},{'model':Whatsapp_1[_0x20eeba(0x1a3)],'as':_0x20eeba(0x22a),'attributes':['name','facebookUserToken',_0x20eeba(0x21f)]},{'model':Company_1[_0x20eeba(0x1a3)],'as':_0x20eeba(0x1da),'attributes':['name']}]});return _0x84f9e3[_0x20eeba(0x222)](0xc8)[_0x20eeba(0x1b4)]({'status':'SUCCESS','tickets':_0x1ef6f1});}catch(_0xc8a0d){return console[_0x20eeba(0x24c)](_0xc8a0d),_0x84f9e3['status'](0x1f4)['json']({'status':_0x20eeba(0x23f),'error':_0x20eeba(0x1bf)});}};exports[a9_0x38c6d9(0x219)]=listTicketsByCompany;const listTicketsByTag=async(_0x5c553a,_0x1e0035)=>{const _0x56b069=a9_0x38c6d9,{tagId:_0x4a2d66}=_0x5c553a[_0x56b069(0x257)],_0x5692b7=_0x5c553a[_0x56b069(0x1b3)][_0x56b069(0x1ef)],[,_0x2500e4]=_0x5692b7[_0x56b069(0x267)]('\x20');try{const _0x2d2577=await Whatsapp_1[_0x56b069(0x1a3)][_0x56b069(0x1e0)]({'where':{'token':_0x2500e4}}),_0x26f1b7=_0x2d2577[_0x56b069(0x20e)],_0xc4ea21=await Tag_1[_0x56b069(0x1a3)][_0x56b069(0x1e0)]({'where':{'id':_0x4a2d66,'companyId':_0x26f1b7}});if(!_0xc4ea21)return _0x1e0035['status'](0x190)[_0x56b069(0x1b4)]({'status':_0x56b069(0x23f),'error':_0x56b069(0x1d4)});const _0x1f6c5d=await Ticket_1['default'][_0x56b069(0x220)]({'include':[{'model':Tag_1[_0x56b069(0x1a3)],'as':_0x56b069(0x256),'attributes':['id',_0x56b069(0x247)],'through':{'attributes':[],'where':{'tagId':_0x4a2d66}}},{'model':Contact_1['default'],'as':_0x56b069(0x1bc),'attributes':['id',_0x56b069(0x247),_0x56b069(0x214),'email',_0x56b069(0x1e1),_0x56b069(0x25f),'active',_0x56b069(0x1c0)],'include':[_0x56b069(0x23c)]},{'model':Queue_1['default'],'as':_0x56b069(0x18c),'attributes':['id','name','color']},{'model':User_1[_0x56b069(0x1a3)],'as':_0x56b069(0x21e),'attributes':['id',_0x56b069(0x247)]},{'model':Whatsapp_1['default'],'as':'whatsapp','attributes':['name','facebookUserToken',_0x56b069(0x21f)]},{'model':Company_1[_0x56b069(0x1a3)],'as':_0x56b069(0x1da),'attributes':[_0x56b069(0x247)]}],'where':{'companyId':_0x26f1b7,'$tags.id$':_0x4a2d66}});return _0x1e0035['status'](0xc8)[_0x56b069(0x1b4)]({'status':_0x56b069(0x1c7),'tickets':_0x1f6c5d});}catch(_0x155c8e){return console[_0x56b069(0x24c)](_0x155c8e),_0x1e0035[_0x56b069(0x222)](0x1f4)[_0x56b069(0x1b4)]({'status':'ERROR','error':'Internal\x20Server\x20Error'});}};exports[a9_0x38c6d9(0x225)]=listTicketsByTag;const listTicketsByTagIsAuth=async(_0x2f2c86,_0x157594)=>{const _0x30f453=a9_0x38c6d9,{tagId:_0x5dfffa}=_0x2f2c86[_0x30f453(0x257)];try{const _0x51ecc5=await Ticket_1[_0x30f453(0x1a3)]['findAll']({'include':[{'model':Contact_1[_0x30f453(0x1a3)],'as':_0x30f453(0x1bc),'attributes':[_0x30f453(0x247),_0x30f453(0x214),'email'],'include':[_0x30f453(0x23c)]},{'model':Tag_1[_0x30f453(0x1a3)],'as':_0x30f453(0x256),'attributes':['id','name',_0x30f453(0x23b)],'where':{'id':_0x5dfffa}},{'model':Whatsapp_1[_0x30f453(0x1a3)],'as':_0x30f453(0x22a),'attributes':[_0x30f453(0x247),_0x30f453(0x21a),'facebookUserId']},{'model':Company_1[_0x30f453(0x1a3)],'as':_0x30f453(0x1da),'attributes':[_0x30f453(0x247)]}]});return _0x157594[_0x30f453(0x222)](0xc8)[_0x30f453(0x1b4)]({'status':_0x30f453(0x1c7),'tickets':_0x51ecc5});}catch(_0x6eeb86){return console[_0x30f453(0x24c)](_0x6eeb86),_0x157594[_0x30f453(0x222)](0x1f4)[_0x30f453(0x1b4)]({'status':_0x30f453(0x23f),'error':_0x30f453(0x1bf)});}};exports['listTicketsByTagIsAuth']=listTicketsByTagIsAuth;function makeid(_0xf2bd68){const _0x12c6a5=a9_0x38c6d9;var _0xd7d30f='',_0x15f786=_0x12c6a5(0x196),_0x34dbc0=_0x15f786[_0x12c6a5(0x258)];for(var _0x1f4ce1=0x0;_0x1f4ce1<_0xf2bd68;_0x1f4ce1++){_0xd7d30f+=_0x15f786[_0x12c6a5(0x20c)](Math[_0x12c6a5(0x25d)](Math[_0x12c6a5(0x217)]()*_0x34dbc0));}return _0xd7d30f;}exports['makeid']=makeid;const handleAudioLink=async(_0x137d18,_0x5f5935)=>{const _0x41c95c=a9_0x38c6d9,{link:_0xcf9779,contactNumber:_0x27cf71}=_0x137d18[_0x41c95c(0x260)];try{const _0x324516=_0x137d18[_0x41c95c(0x1b3)]['authorization'],[,_0x3e805c]=_0x324516[_0x41c95c(0x267)]('\x20'),_0x2c9ef8=await Whatsapp_1[_0x41c95c(0x1a3)]['findOne']({'where':{'token':_0x3e805c}}),_0x5db884=_0x2c9ef8['companyId'],_0x2d8cec=await(0x0,GetDefaultWhatsApp_1[_0x41c95c(0x1a3)])(_0x5db884),_0x5dad5f=(0x0,wbot_1['getWbot'])(_0x2d8cec['id']),_0xa82f28=_0x41c95c(0x1e4)+_0x5db884+'/'+makeid(0xa)+'.mp3';if(!_0x2c9ef8)return _0x5f5935[_0x41c95c(0x222)](0x191)[_0x41c95c(0x1b4)]({'status':_0x41c95c(0x259),'error':_0x41c95c(0x240)});const _0x3d29ee=await axios_1[_0x41c95c(0x1a3)]['get'](_0xcf9779,{'responseType':'arraybuffer'});fs_1[_0x41c95c(0x1a3)][_0x41c95c(0x1fa)](_0xa82f28,Buffer[_0x41c95c(0x232)](_0x3d29ee[_0x41c95c(0x1a0)]));const _0x3cefea=_0x41c95c(0x201);return await(0x0,SendPresenceStatus_1[_0x41c95c(0x1fd)])(_0x5dad5f,_0x27cf71),await _0x5dad5f[_0x41c95c(0x1e8)](_0x27cf71+_0x41c95c(0x1bb),{'audio':fs_1['default'][_0x41c95c(0x205)](_0xa82f28),'fileName':_0x3cefea,'caption':_0x3cefea,'mimetype':_0x41c95c(0x221),'ptt':!![]}),_0x5f5935[_0x41c95c(0x222)](0xc8)[_0x41c95c(0x1b4)]({'status':'SUCESSO'});}catch(_0x21e30e){return console[_0x41c95c(0x24c)](_0x21e30e),_0x5f5935[_0x41c95c(0x222)](0x1f4)[_0x41c95c(0x1b4)]({'status':'ERRO','error':'Erro\x20ao\x20lidar\x20com\x20o\x20link\x20de\x20áudio'});}};exports[a9_0x38c6d9(0x19c)]=handleAudioLink;const indexApi=async(_0x845f16,_0x35cdf8)=>{const _0x59b79e=a9_0x38c6d9,_0x4b987c=_0x845f16[_0x59b79e(0x1b3)][_0x59b79e(0x1ef)],[,_0x19d5e8]=_0x4b987c[_0x59b79e(0x267)]('\x20'),_0xf81a6b=await Whatsapp_1[_0x59b79e(0x1a3)][_0x59b79e(0x1e0)]({'where':{'token':_0x19d5e8}}),_0x178f45=_0xf81a6b[_0x59b79e(0x20e)],{searchParam:_0x32809f,pageNumber:_0x379250}=_0x845f16[_0x59b79e(0x216)];if(_0x178f45===0x1){const {invoices:_0x2f3b43,count:_0x41373a,hasMore:_0x2c8f27}=await(0x0,ListInvoicesServices_1['default'])({'searchParam':_0x32809f,'pageNumber':_0x379250});return _0x35cdf8[_0x59b79e(0x1b4)]({'invoices':_0x2f3b43,'count':_0x41373a,'hasMore':_0x2c8f27});}else return _0x35cdf8[_0x59b79e(0x222)](0x191)[_0x59b79e(0x1b4)]({'status':_0x59b79e(0x259),'error':_0x59b79e(0x18b)});};exports[a9_0x38c6d9(0x1c9)]=indexApi;const showApi=async(_0x47dbc5,_0x2cdaab)=>{const _0x1191f5=a9_0x38c6d9,_0x597c05=_0x47dbc5['headers'][_0x1191f5(0x1ef)],[,_0x309c91]=_0x597c05[_0x1191f5(0x267)]('\x20'),_0x349ff=await Whatsapp_1[_0x1191f5(0x1a3)][_0x1191f5(0x1e0)]({'where':{'token':_0x309c91}}),_0x502b10=_0x349ff[_0x1191f5(0x20e)],{Invoiceid:_0x2d736d}=_0x47dbc5[_0x1191f5(0x257)],_0x8b65ce=await(0x0,ShowInvoiceService_1[_0x1191f5(0x1a3)])(_0x2d736d);return _0x2cdaab[_0x1191f5(0x222)](0xc8)[_0x1191f5(0x1b4)](_0x8b65ce);};exports[a9_0x38c6d9(0x25c)]=showApi;const showAllApi=async(_0x133127,_0x2e6902)=>{const _0x5bf9b6=a9_0x38c6d9;try{const _0x6132a2=_0x133127[_0x5bf9b6(0x1b3)][_0x5bf9b6(0x1ef)],[,_0x3f69c6]=_0x6132a2[_0x5bf9b6(0x267)]('\x20'),_0x15390f=await Whatsapp_1['default'][_0x5bf9b6(0x1e0)]({'where':{'token':_0x3f69c6}}),_0x5d3f47=_0x15390f['companyId'],{companyId:_0x11830a,status:_0x1473d1}=_0x133127[_0x5bf9b6(0x260)];if(_0x5d3f47===0x1){const _0x267ca7=await Invoices_1[_0x5bf9b6(0x1a3)][_0x5bf9b6(0x220)]({'where':{'companyId':_0x11830a,'status':_0x1473d1}});return _0x2e6902[_0x5bf9b6(0x222)](0xc8)['json'](_0x267ca7);}else return _0x2e6902[_0x5bf9b6(0x222)](0x191)[_0x5bf9b6(0x1b4)]({'status':_0x5bf9b6(0x259),'error':_0x5bf9b6(0x18b)});}catch(_0x1a7d1f){return console[_0x5bf9b6(0x24c)](_0x5bf9b6(0x23d),_0x1a7d1f),_0x2e6902['status'](0x1f4)[_0x5bf9b6(0x1b4)]({'error':_0x5bf9b6(0x1a5)});}};exports['showAllApi']=showAllApi;const updateApi=async(_0x4e7970,_0x9709b8)=>{const _0x227dd1=a9_0x38c6d9,_0x373b8e=_0x4e7970['headers'][_0x227dd1(0x1ef)],[,_0x26e8c6]=_0x373b8e[_0x227dd1(0x267)]('\x20'),_0xc1f929=await Whatsapp_1[_0x227dd1(0x1a3)][_0x227dd1(0x1e0)]({'where':{'token':_0x26e8c6}}),_0x6f0e32=_0xc1f929[_0x227dd1(0x20e)],_0x102579=_0x4e7970[_0x227dd1(0x260)],_0x5a7a99=Yup[_0x227dd1(0x1b0)]()[_0x227dd1(0x18d)]({'name':Yup[_0x227dd1(0x1d7)]()});try{await _0x5a7a99[_0x227dd1(0x242)](_0x102579);}catch(_0x10c626){throw new AppError_1[(_0x227dd1(0x1a3))](_0x10c626['message']);}const {id:_0x358fad,status:_0x460b14}=_0x102579;if(_0x6f0e32===0x1){const _0x114278=await(0x0,UpdateInvoiceService_1[_0x227dd1(0x1a3)])({'id':_0x358fad,'status':_0x460b14}),_0x589681=await Invoices_1['default'][_0x227dd1(0x227)](_0x358fad),_0x504bc9=_0x589681[_0x227dd1(0x20e)],_0x1d4dee=await Company_1['default'][_0x227dd1(0x227)](_0x504bc9),_0x8315bb=new Date(_0x1d4dee[_0x227dd1(0x20f)]);_0x8315bb['setDate'](_0x8315bb['getDate']()+0x1e);const _0x2c4e51=_0x8315bb[_0x227dd1(0x1dd)]()['split']('T')[0x0];if(_0x1d4dee){await _0x1d4dee['update']({'dueDate':_0x2c4e51});const _0x330564=await _0x589681[_0x227dd1(0x1be)]({'id':_0x358fad,'status':_0x227dd1(0x19f)});await _0x1d4dee[_0x227dd1(0x1db)]();const _0x5aa29e=(0x0,socket_1[_0x227dd1(0x1f8)])(),_0x124557=await Company_1[_0x227dd1(0x1a3)]['findOne']({'where':{'id':_0x504bc9}});}return _0x9709b8[_0x227dd1(0x222)](0xc8)['json'](_0x114278);}else return _0x9709b8[_0x227dd1(0x222)](0x191)['json']({'status':_0x227dd1(0x259),'error':_0x227dd1(0x18b)});};exports[a9_0x38c6d9(0x191)]=updateApi;const updateUsageStats=async(_0x38da75,_0xcfb203)=>{const _0x4adccb=a9_0x38c6d9;if(!_0x38da75[_0x4adccb(0x21e)]||!_0x38da75[_0x4adccb(0x21e)]['companyId'])return _0xcfb203['status'](0x190)['send']({'status':_0x4adccb(0x23f),'message':_0x4adccb(0x24f)});const {companyId:_0x40fee6}=_0x38da75[_0x4adccb(0x21e)],{contactId:_0x3f2f7c}=_0x38da75[_0x4adccb(0x257)];return setTimeout(async()=>{const _0x5f3a52=_0x4adccb,{dateToClient:_0x49a44c}=(0x0,useDate_1[_0x5f3a52(0x245)])(),_0x5a4049=_0x49a44c(new Date()[_0x5f3a52(0x1ea)]()),_0xc816cc=(0x0,moment_1['default'])()['format']();try{const _0xb93da8=await ApiUsages_1['default'][_0x5f3a52(0x1e0)]({'where':{'dateUsed':_0x5a4049,'companyId':_0x40fee6}});if(_0xb93da8)await _0xb93da8[_0x5f3a52(0x1be)]({'usedOther':_0xb93da8[_0x5f3a52(0x200)]['usedOther']+0x1,'UsedOnDay':_0xb93da8[_0x5f3a52(0x200)][_0x5f3a52(0x243)]+0x1,'updatedAt':_0xc816cc});else{const _0x9da170=await ApiUsages_1['default'][_0x5f3a52(0x18e)]({'companyId':_0x40fee6,'dateUsed':_0x5a4049});await _0x9da170[_0x5f3a52(0x1be)]({'usedOther':_0x9da170[_0x5f3a52(0x200)][_0x5f3a52(0x238)]+0x1,'UsedOnDay':_0x9da170[_0x5f3a52(0x200)]['UsedOnDay']+0x1,'updatedAt':_0xc816cc});}}catch(_0x271ea6){return console['error'](_0x5f3a52(0x1ff),_0x271ea6),_0xcfb203[_0x5f3a52(0x222)](0x1f4)[_0x5f3a52(0x25a)]({'status':'ERROR','message':_0x5f3a52(0x23e)});}},0x64),_0xcfb203[_0x4adccb(0x25a)]({'status':_0x4adccb(0x1c7)});};exports[a9_0x38c6d9(0x198)]=updateUsageStats;const indexContacts=async(_0x129b04,_0x4048d6)=>{const _0x58efb4=a9_0x38c6d9,{searchParam:_0x4bfb3e,pageNumber:_0x18f3c3}=_0x129b04[_0x58efb4(0x216)],{companyId:_0x16f9b0}=_0x129b04[_0x58efb4(0x21e)],{contacts:_0x2474d0,count:_0x477114,hasMore:_0x4dbe8e}=await(0x0,ListContactsService_1[_0x58efb4(0x1a3)])({'searchParam':_0x4bfb3e,'pageNumber':_0x18f3c3,'companyId':_0x16f9b0});return _0x4048d6[_0x58efb4(0x1b4)]({'contacts':_0x2474d0,'count':_0x477114,'hasMore':_0x4dbe8e});};exports[a9_0x38c6d9(0x1c5)]=indexContacts;function a9_0x4bd8(){const _0x12be25=['-contact','writeFileSync','../models/Ticket','get','SendPresenceStatus','exists','Error\x20updating\x20usage\x20stats:','dataValues','Legenda\x20do\x20áudio','path','extname','7761WcmbyJ','readFileSync','Tag\x20already\x20associated\x20with\x20the\x20ticket','mimetype','Contact\x20deleted','constructor','Error\x20removing\x20all\x20contacts:','message','charAt','uploadContacts','companyId','dueDate','matches','type','../services/ContactServices/CreateOrUpdateContactService','../libs/socket','number','checkNumber','query','random','listTicketsByTagIsAuth','listTicketsByCompany','facebookUserToken','__importDefault','log','../services/WbotServices/GetProfilePicUrl','user','facebookUserId','findAll','audio/mp4','status','usedImage','\x20not\x20found','listTicketsByTag','blockCompany','findByPk','axios','includes','whatsapp','updateContacts','url','apply','../services/ContactServices/SimpleListService','indexWhatsappsId','6025855mrhiZS','yup','from','../helpers/GetDefaultWhatsApp','makeid','ticketData','../services/TicketServices/ShowTicketService','nullable','usedOther','../models/ApiUsages','indexLink','color','extraInfo','Erro\x20ao\x20buscar\x20invoices:','Internal\x20server\x20error','ERROR','Token\x20de\x20autorização\x20inválido','../helpers/SendPresenceStatus','validate','UsedOnDay','40954nvwMEx','useDate','getWbot','name','../services/InvoicesService/ShowInvoiceService','call','__esModule','../errors/AppError','error','test','storeContacts','Missing\x20user\x20or\x20companyId','video','caption','../services/ContactServices/ShowContactService','../models/User','Failed\x20to\x20update\x20ticket\x20tag','../services/InvoicesService/UpdateInvoiceService','tags','params','length','ERRO','send','../services/WbotServices/SendWhatsAppMessageAPI','showApi','floor','defineProperty','acceptAudioMessage','body','whatsapp\x20#','required','usedPDF','boolean','closeTicket','All\x20contacts\x20removed\x20successfully','split','Acesso\x20não\x20autorizado.\x20Por\x20favor,\x20forneça\x20credenciais\x20válidas.','queue','shape','create','indexImage','Company\x20not\x20found','updateApi','8vczJPt','47148cqHMKW','usedVideo','head','ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789','media','updateUsageStats','Not\x20exists\x20on\x20Whatsapp','format','../services/ContactServices/ListContactsService','handleAudioLink','pending','../services/WbotServices/CheckNumber','paid','data','email','OnWhatsAppDto','default','Failed\x20to\x20remove\x20ticket\x20tag','Erro\x20ao\x20buscar\x20invoices','4410070BkQhVX','../services/WbotServices/SendWhatsAppMedia','destroy','originalname','../services/ContactServices/CreateContactService','emit','../models/Contact','3024972sOyndR','../services/WbotServices/SendWhatsappMediaImage','11mcxoPl','object','usedText','185mojuKl','headers','json','(((.+)+)+)+$','index','ImportXLSContactsService','toggleDisableBotContacts','delete','hasOwnProperty','@s.whatsapp.net','contact','exec','update','Internal\x20Server\x20Error','disableBot','listContacts','../libs/wbot','onWhatsApp','lodash','indexContacts','date','SUCCESS','showAllApi','indexApi','parseInt','showContacts','@g.us','-mainchannel','pdf','8402990NgAQHO','jid','createCompany','map','all','Tag\x20does\x20not\x20belong\x20to\x20the\x20specified\x20company','moment','removeTicketTag','string','removeContacts','replace','company','reload','../services/InvoicesService/ListInvoicesServices','toISOString','req','company-','findOne','profilePicUrl','../models/TicketTag','updateTicketTag','./public/company','../services/ContactServices/GetContactService','../services/TicketServices/UpdateTicketService','search','sendMessage','../models/Queue','toString','active','Invalid\x20queue\x20for\x20the\x20company','findOrCreateContacts','updateQueueId','authorization','image','files','Invalid\x20number\x20format.\x20Only\x20numbers\x20is\x20allowed.','268YJGWUx','../services/WbotServices/CheckIsValidContact','__createBinding','../services/ContactServices/DeleteContactService','updateCompany','getIO'];a9_0x4bd8=function(){return _0x12be25;};return a9_0x4bd8();}const listContacts=async(_0x34778e,_0x17d180)=>{const _0x1d68d5=a9_0x38c6d9,{name:_0x2228e4}=_0x34778e[_0x1d68d5(0x216)],{companyId:_0x42c676}=_0x34778e[_0x1d68d5(0x21e)],_0x218814=await(0x0,SimpleListService_1[_0x1d68d5(0x1a3)])({'name':_0x2228e4,'companyId':_0x42c676});return _0x17d180[_0x1d68d5(0x1b4)](_0x218814);};exports[a9_0x38c6d9(0x1c1)]=listContacts;const showContacts=async(_0x14ebb8,_0x3c99b6)=>{const _0x2decb7=a9_0x38c6d9,{contactId:_0x469638}=_0x14ebb8[_0x2decb7(0x257)],{companyId:_0x371ce3}=_0x14ebb8[_0x2decb7(0x21e)],_0x1bc913=await(0x0,ShowContactService_1[_0x2decb7(0x1a3)])(_0x469638,_0x371ce3);return _0x3c99b6['status'](0xc8)[_0x2decb7(0x1b4)](_0x1bc913);};exports[a9_0x38c6d9(0x1cb)]=showContacts;const findOrCreateContacts=async(_0x510b79,_0x1b7776)=>{const _0x35e55d=a9_0x38c6d9,{name:_0x31fd91,number:_0x5c8209}=_0x510b79[_0x35e55d(0x260)],{companyId:_0x301fbc}=_0x510b79[_0x35e55d(0x21e)],_0x185897=await(0x0,GetContactService_1[_0x35e55d(0x1a3)])({'name':_0x31fd91,'number':_0x5c8209,'companyId':_0x301fbc});return _0x1b7776['status'](0xc8)[_0x35e55d(0x1b4)](_0x185897);};exports[a9_0x38c6d9(0x1ed)]=findOrCreateContacts;const storeContacts=async(_0x24ae4b,_0x5310ca)=>{const _0x1d4142=a9_0x38c6d9,{companyId:_0x5eb880}=_0x24ae4b['user'],_0x2d2e96=_0x24ae4b[_0x1d4142(0x260)];_0x2d2e96[_0x1d4142(0x214)]=_0x2d2e96['number']['replace']('-','')[_0x1d4142(0x1d9)]('\x20','');const _0x3d6698=Yup[_0x1d4142(0x1b0)]()[_0x1d4142(0x18d)]({'name':Yup[_0x1d4142(0x1d7)]()[_0x1d4142(0x262)](),'number':Yup['string']()['required']()[_0x1d4142(0x210)](/^\d+$/,_0x1d4142(0x1f2))});try{await _0x3d6698[_0x1d4142(0x242)](_0x2d2e96);}catch(_0x340d0f){throw new AppError_1[(_0x1d4142(0x1a3))](_0x340d0f[_0x1d4142(0x20b)]);}await(0x0,CheckIsValidContact_1[_0x1d4142(0x1a3)])(_0x2d2e96[_0x1d4142(0x214)],_0x5eb880);const _0x301ad8=await(0x0,CheckNumber_1[_0x1d4142(0x1a3)])(_0x2d2e96['number'],_0x5eb880),_0x266684=_0x301ad8[_0x1d4142(0x1d0)][_0x1d4142(0x1d9)](/\D/g,'');_0x2d2e96[_0x1d4142(0x214)]=_0x266684;const _0x519022=await(0x0,CreateContactService_1[_0x1d4142(0x1a3)])({..._0x2d2e96,'companyId':_0x5eb880}),_0x42a655=(0x0,socket_1[_0x1d4142(0x1f8)])();return _0x42a655[_0x1d4142(0x1ab)](_0x1d4142(0x1df)+_0x5eb880+'-contact',{'action':'create','contact':_0x519022}),_0x5310ca['status'](0xc8)[_0x1d4142(0x1b4)](_0x519022);};exports[a9_0x38c6d9(0x24e)]=storeContacts;const removeAllContacts=async(_0x124020,_0x264701)=>{const _0x1594d0=a9_0x38c6d9,{companyId:_0x4bddcd}=_0x124020[_0x1594d0(0x21e)];try{await Contact_1[_0x1594d0(0x1a3)][_0x1594d0(0x1a8)]({'where':{'companyId':_0x4bddcd}});const _0x339261=(0x0,socket_1[_0x1594d0(0x1f8)])();return _0x339261[_0x1594d0(0x1ab)](_0x1594d0(0x1df)+_0x4bddcd+'-contact',{'action':'deleteAll'}),setTimeout(async()=>{const _0x1d872c=_0x1594d0,{dateToClient:_0x486efb}=(0x0,useDate_1[_0x1d872c(0x245)])(),_0x14d562=_0x486efb(new Date()['toString']()),_0x329471=(0x0,moment_1[_0x1d872c(0x1a3)])()[_0x1d872c(0x19a)]();try{const _0x5df7a0=await ApiUsages_1[_0x1d872c(0x1a3)][_0x1d872c(0x1e0)]({'where':{'dateUsed':_0x14d562,'companyId':_0x4bddcd}});if(_0x5df7a0)await _0x5df7a0[_0x1d872c(0x1be)]({'usedOther':_0x5df7a0['dataValues'][_0x1d872c(0x238)]+0x1,'UsedOnDay':_0x5df7a0[_0x1d872c(0x200)][_0x1d872c(0x243)]+0x1,'updatedAt':_0x329471});else{const _0x445fec=await ApiUsages_1[_0x1d872c(0x1a3)][_0x1d872c(0x18e)]({'companyId':_0x4bddcd,'dateUsed':_0x14d562});await _0x445fec['update']({'usedOther':_0x445fec[_0x1d872c(0x200)][_0x1d872c(0x238)]+0x1,'UsedOnDay':_0x445fec['dataValues'][_0x1d872c(0x243)]+0x1,'updatedAt':_0x329471});}}catch(_0x2d2756){return console[_0x1d872c(0x24c)](_0x1d872c(0x1ff),_0x2d2756),_0x264701[_0x1d872c(0x222)](0x1f4)[_0x1d872c(0x25a)]({'status':_0x1d872c(0x23f),'message':_0x1d872c(0x23e)});}},0x64),_0x264701[_0x1594d0(0x222)](0xc8)[_0x1594d0(0x25a)]({'status':_0x1594d0(0x1c7),'message':_0x1594d0(0x266)});}catch(_0x14afa3){return console[_0x1594d0(0x24c)](_0x1594d0(0x20a),_0x14afa3),_0x264701['status'](0x1f4)[_0x1594d0(0x25a)]({'status':_0x1594d0(0x23f),'message':_0x1594d0(0x23e)});}};exports['removeAllContacts']=removeAllContacts;const updateContacts=async(_0x2acde4,_0x56843c)=>{const _0x23d2f5=a9_0x38c6d9,_0x48571c=_0x2acde4[_0x23d2f5(0x260)],{companyId:_0x2dc6ea}=_0x2acde4[_0x23d2f5(0x21e)],_0x5ecf5d=Yup[_0x23d2f5(0x1b0)]()[_0x23d2f5(0x18d)]({'name':Yup[_0x23d2f5(0x1d7)](),'number':Yup[_0x23d2f5(0x1d7)]()[_0x23d2f5(0x210)](/^\d+$/,'Invalid\x20number\x20format.\x20Only\x20numbers\x20is\x20allowed.')});try{await _0x5ecf5d[_0x23d2f5(0x242)](_0x48571c);}catch(_0x4c7081){throw new AppError_1[(_0x23d2f5(0x1a3))](_0x4c7081[_0x23d2f5(0x20b)]);}await(0x0,CheckIsValidContact_1[_0x23d2f5(0x1a3)])(_0x48571c[_0x23d2f5(0x214)],_0x2dc6ea);const _0x3e73af=await(0x0,CheckNumber_1[_0x23d2f5(0x1a3)])(_0x48571c[_0x23d2f5(0x214)],_0x2dc6ea),_0x2d6465=_0x3e73af[_0x23d2f5(0x1d0)][_0x23d2f5(0x1d9)](/\D/g,'');_0x48571c['number']=_0x2d6465;const {contactId:_0x1319fa}=_0x2acde4[_0x23d2f5(0x257)],_0x8ace2c=await(0x0,UpdateContactService_1['default'])({'contactData':_0x48571c,'contactId':_0x1319fa,'companyId':_0x2dc6ea}),_0x3aae48=(0x0,socket_1[_0x23d2f5(0x1f8)])();return _0x3aae48['emit'](_0x23d2f5(0x1df)+_0x2dc6ea+_0x23d2f5(0x1f9),{'action':'update','contact':_0x8ace2c}),_0x56843c[_0x23d2f5(0x222)](0xc8)['json'](_0x8ace2c);};exports['updateContacts']=updateContacts;const removeContacts=async(_0x3ef669,_0x1b870c)=>{const _0x2b9e3f=a9_0x38c6d9,{contactId:_0x360edd}=_0x3ef669['params'],{companyId:_0x504fd1}=_0x3ef669[_0x2b9e3f(0x21e)];await(0x0,ShowContactService_1['default'])(_0x360edd,_0x504fd1),await(0x0,DeleteContactService_1[_0x2b9e3f(0x1a3)])(_0x360edd);const _0x2d8c09=(0x0,socket_1[_0x2b9e3f(0x1f8)])();return _0x2d8c09[_0x2b9e3f(0x1ab)](_0x2b9e3f(0x1df)+_0x504fd1+'-contact',{'action':_0x2b9e3f(0x1b9),'contactId':_0x360edd}),_0x1b870c[_0x2b9e3f(0x222)](0xc8)[_0x2b9e3f(0x1b4)]({'message':_0x2b9e3f(0x208)});};exports[a9_0x38c6d9(0x1d8)]=removeContacts;const uploadContacts=async(_0x4e5f46,_0x5c4759)=>{const _0x2e18b2=a9_0x38c6d9,_0x267af6=_0x4e5f46['files'],_0x57b06b=(0x0,lodash_1[_0x2e18b2(0x195)])(_0x267af6),{companyId:_0x5a601a}=_0x4e5f46['user'],_0x5cef3b=await(0x0,ImportXLSContactsService_1[_0x2e18b2(0x1b7)])(_0x5a601a,_0x57b06b),_0x2856cc=(0x0,socket_1[_0x2e18b2(0x1f8)])(),_0x20755e={'action':'reload','records':_0x5cef3b};return _0x2856cc['to'](_0x2e18b2(0x1df)+_0x5a601a+_0x2e18b2(0x1cd))[_0x2e18b2(0x1ab)](_0x2e18b2(0x1df)+_0x5a601a+_0x2e18b2(0x1f9),_0x20755e),_0x5c4759['status'](0xc8)[_0x2e18b2(0x1b4)](_0x5cef3b);};exports[a9_0x38c6d9(0x20d)]=uploadContacts;const toggleDisableBotContacts=async(_0xe695b4,_0x358361)=>{const _0x10936c=a9_0x38c6d9,{contactId:_0x3a871e}=_0xe695b4[_0x10936c(0x257)],{companyId:_0x46e691}=_0xe695b4[_0x10936c(0x21e)],_0x1eb7cc=await(0x0,ToggleDisableBotService_1['default'])(_0x3a871e,_0x46e691),_0x878740=(0x0,socket_1[_0x10936c(0x1f8)])();return _0x878740[_0x10936c(0x1ab)](_0x10936c(0x1df)+_0x46e691+'-contact',{'action':_0x10936c(0x1be),'contact':_0x1eb7cc}),_0x358361[_0x10936c(0x222)](0xc8)[_0x10936c(0x1b4)](_0x1eb7cc);};exports[a9_0x38c6d9(0x1b8)]=toggleDisableBotContacts;