const a31_0x46c462=a31_0x19ad;(function(_0x2f8f45,_0x34bfc7){const _0x5d8d4c=a31_0x19ad,_0x2dec9e=_0x2f8f45();while(!![]){try{const _0x308cb5=-parseInt(_0x5d8d4c(0x179))/0x1+-parseInt(_0x5d8d4c(0x16b))/0x2*(parseInt(_0x5d8d4c(0x18d))/0x3)+parseInt(_0x5d8d4c(0x18b))/0x4*(parseInt(_0x5d8d4c(0x17b))/0x5)+-parseInt(_0x5d8d4c(0x174))/0x6*(parseInt(_0x5d8d4c(0x189))/0x7)+-parseInt(_0x5d8d4c(0x16d))/0x8*(-parseInt(_0x5d8d4c(0x19e))/0x9)+parseInt(_0x5d8d4c(0x178))/0xa*(-parseInt(_0x5d8d4c(0x172))/0xb)+parseInt(_0x5d8d4c(0x187))/0xc;if(_0x308cb5===_0x34bfc7)break;else _0x2dec9e['push'](_0x2dec9e['shift']());}catch(_0x2455c7){_0x2dec9e['push'](_0x2dec9e['shift']());}}}(a31_0x2600,0x5e90e));const a31_0x4230d5=(function(){let _0x17de1a=!![];return function(_0x38303b,_0x1c2c9a){const _0x29e835=_0x17de1a?function(){const _0x1815d5=a31_0x19ad;if(_0x1c2c9a){const _0x5ef76e=_0x1c2c9a[_0x1815d5(0x1a0)](_0x38303b,arguments);return _0x1c2c9a=null,_0x5ef76e;}}:function(){};return _0x17de1a=![],_0x29e835;};}()),a31_0x2605b2=a31_0x4230d5(this,function(){const _0xecca4=a31_0x19ad;return a31_0x2605b2[_0xecca4(0x196)]()[_0xecca4(0x176)](_0xecca4(0x19b))['toString']()[_0xecca4(0x1a3)](a31_0x2605b2)[_0xecca4(0x176)](_0xecca4(0x19b));});a31_0x2605b2();function a31_0x2600(){const _0x36c79f=['day','321939mQRMie','defineProperty','apply','sequelize','whatsapp','constructor','isBetween','ratingAt','minute','2GxiSGE','../models/Whatsapp','48Qfvuid','contactId','number','subtract','queueId','55ZDLlUL','rated','457206LDMxZI','findAll','search','endOf','584020KhjeZM','533879tSgVJq','tag','10xmsKmM','toDate','../models/Queue','add','finishedAt','queuedAt','name','userId','moment/moment','../models/Contact','__esModule','user','7290492xtTUNe','DESC','7sdZWOT','profile','950348QVXlYL','../models/TicketTag','23727BHfAPo','N/A','default','__importDefault','between','createdAt','../models/Tag','startOf','queue','toString','findOne','json','status','startedAt','(((.+)+)+)+$','../models/Ticket'];a31_0x2600=function(){return _0x36c79f;};return a31_0x2600();}'use strict';var __importDefault=this&&this[a31_0x46c462(0x190)]||function(_0x20d05e){const _0x3314c1=a31_0x46c462;return _0x20d05e&&_0x20d05e[_0x3314c1(0x185)]?_0x20d05e:{'default':_0x20d05e};};Object[a31_0x46c462(0x19f)](exports,a31_0x46c462(0x185),{'value':!![]});function a31_0x19ad(_0x45d65f,_0x5e48be){const _0x28d10f=a31_0x2600();return a31_0x19ad=function(_0x2605b2,_0x4230d5){_0x2605b2=_0x2605b2-0x169;let _0x260037=_0x28d10f[_0x2605b2];return _0x260037;},a31_0x19ad(_0x45d65f,_0x5e48be);}const Ticket_1=__importDefault(require(a31_0x46c462(0x19c))),sequelize_1=require(a31_0x46c462(0x1a1)),moment_1=__importDefault(require(a31_0x46c462(0x183))),User_1=__importDefault(require('../models/User')),Queue_1=__importDefault(require(a31_0x46c462(0x17d))),TicketTag_1=__importDefault(require(a31_0x46c462(0x18c))),Tag_1=__importDefault(require(a31_0x46c462(0x193))),Whatsapp_1=__importDefault(require(a31_0x46c462(0x16c))),TicketTraking_1=__importDefault(require('../models/TicketTraking')),Contact_1=__importDefault(require(a31_0x46c462(0x184))),ReportController={'tickets':async(_0x5e4874,_0x147c09)=>{const _0x1e5754=a31_0x46c462,{companyId:_0x5158ba}=_0x5e4874[_0x1e5754(0x186)];let {dateStart:_0x1b4916,dateEnd:_0x55b8be,status:_0x50fc36,queueId:_0x4f7596}=_0x5e4874['body'],_0x301e80={'companyId':_0x5158ba};_0x4f7596&&(_0x301e80['queueId']=_0x4f7596);_0x50fc36&&(_0x301e80[_0x1e5754(0x199)]=_0x50fc36);let _0x243378=await Ticket_1[_0x1e5754(0x18f)][_0x1e5754(0x175)]({'where':{..._0x301e80,'createdAt':{[sequelize_1['Op'][_0x1e5754(0x191)]]:[(0x0,moment_1[_0x1e5754(0x18f)])(_0x1b4916)[_0x1e5754(0x194)](_0x1e5754(0x19d))['toDate'](),(0x0,moment_1['default'])(_0x55b8be)[_0x1e5754(0x177)](_0x1e5754(0x19d))[_0x1e5754(0x17c)]()]}},'include':[{'model':User_1[_0x1e5754(0x18f)],'as':_0x1e5754(0x186),'attributes':['id',_0x1e5754(0x181),_0x1e5754(0x18a)]},{'model':Queue_1[_0x1e5754(0x18f)],'as':_0x1e5754(0x195),'attributes':['id',_0x1e5754(0x181)]},{'model':Whatsapp_1['default'],'as':_0x1e5754(0x1a2),'attributes':['id',_0x1e5754(0x181)]}],'attributes':['id',_0x1e5754(0x192),_0x1e5754(0x199),_0x1e5754(0x171),'userId',_0x1e5754(0x16e)],'order':[[_0x1e5754(0x192),_0x1e5754(0x188)]]}),_0x1d141c=[];for(let _0x2efc95 of _0x243378){const _0x5c4edd=await TicketTag_1[_0x1e5754(0x18f)]['findAll']({'attributes':['tagId'],'where':{'ticketId':_0x2efc95['id']},'include':[{'model':Tag_1['default'],'as':_0x1e5754(0x17a),'attributes':['id',_0x1e5754(0x181)]}]});var _0xe36e31=await TicketTraking_1[_0x1e5754(0x18f)]['findOne']({'where':{'ticketId':_0x2efc95['id']},'attributes':[_0x1e5754(0x19a),_0x1e5754(0x180),_0x1e5754(0x169),_0x1e5754(0x173),_0x1e5754(0x192),_0x1e5754(0x17f)]});let _0x3a2ab1=await Contact_1[_0x1e5754(0x18f)][_0x1e5754(0x197)]({'attributes':['createdAt',_0x1e5754(0x181),_0x1e5754(0x16f)],'where':{'id':_0x2efc95[_0x1e5754(0x16e)]}}),_0x3619fa=![];_0x3a2ab1&&(_0x3619fa=(0x0,moment_1[_0x1e5754(0x18f)])(_0x3a2ab1[_0x1e5754(0x192)])[_0x1e5754(0x1a4)]((0x0,moment_1[_0x1e5754(0x18f)])(_0x2efc95[_0x1e5754(0x192)])[_0x1e5754(0x170)](0x1,_0x1e5754(0x16a)),(0x0,moment_1['default'])(_0x2efc95[_0x1e5754(0x192)])[_0x1e5754(0x17e)](0x1,_0x1e5754(0x16a)))),_0x1d141c['push']({'id':_0x2efc95['id'],'contactName':_0x3a2ab1?.[_0x1e5754(0x181)]||_0x1e5754(0x18e),'contactNumber':_0x3a2ab1?.[_0x1e5754(0x16f)]||'N/A','createdAt':_0x2efc95?.[_0x1e5754(0x192)],'startedAt':_0xe36e31?.['startedAt'],'queuedAt':_0xe36e31?.[_0x1e5754(0x180)],'ratingAt':_0xe36e31?.[_0x1e5754(0x169)],'rated':_0xe36e31?.[_0x1e5754(0x173)],'status':_0x2efc95[_0x1e5754(0x199)],'user':_0x2efc95[_0x1e5754(0x186)]?.['name']||_0x1e5754(0x18e),'userId':_0x2efc95[_0x1e5754(0x182)],'queue':_0x2efc95['queue']?.[_0x1e5754(0x181)]||'N/A','queueId':_0x2efc95[_0x1e5754(0x171)],'connection':_0x2efc95['whatsapp'][_0x1e5754(0x181)],'connectionId':_0x2efc95['whatsapp']['id'],'firstSentMessageAt':_0xe36e31?.['createdAt'],'resolvedAt':_0xe36e31?.[_0x1e5754(0x17f)],'isNewContact':_0x3619fa,'tags':_0x5c4edd['map'](_0x51fb80=>_0x51fb80['tag'][_0x1e5754(0x181)])['join'](',')});}return _0x147c09[_0x1e5754(0x198)](_0x1d141c);}};exports[a31_0x46c462(0x18f)]=ReportController;