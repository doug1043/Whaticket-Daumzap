const a31_0x39df65=a31_0x43c2;(function(_0xfb124a,_0xf89220){const _0x116abe=a31_0x43c2,_0x241bb8=_0xfb124a();while(!![]){try{const _0x22de85=-parseInt(_0x116abe(0xeb))/0x1+-parseInt(_0x116abe(0xbd))/0x2*(parseInt(_0x116abe(0xd2))/0x3)+-parseInt(_0x116abe(0xdc))/0x4*(parseInt(_0x116abe(0xc1))/0x5)+parseInt(_0x116abe(0xed))/0x6*(-parseInt(_0x116abe(0xc5))/0x7)+parseInt(_0x116abe(0xf2))/0x8+parseInt(_0x116abe(0xf5))/0x9+-parseInt(_0x116abe(0xe3))/0xa*(-parseInt(_0x116abe(0xd8))/0xb);if(_0x22de85===_0xf89220)break;else _0x241bb8['push'](_0x241bb8['shift']());}catch(_0x4ba870){_0x241bb8['push'](_0x241bb8['shift']());}}}(a31_0x247f,0x8b6ae));const a31_0x271114=(function(){let _0x23274a=!![];return function(_0x4b01a8,_0x2e4d72){const _0x3bf799=_0x23274a?function(){const _0x3295bc=a31_0x43c2;if(_0x2e4d72){const _0x10b96d=_0x2e4d72[_0x3295bc(0xbf)](_0x4b01a8,arguments);return _0x2e4d72=null,_0x10b96d;}}:function(){};return _0x23274a=![],_0x3bf799;};}()),a31_0x13463c=a31_0x271114(this,function(){const _0x1b0ef5=a31_0x43c2;return a31_0x13463c['toString']()[_0x1b0ef5(0xe4)](_0x1b0ef5(0xe6))[_0x1b0ef5(0xbe)]()[_0x1b0ef5(0xe0)](a31_0x13463c)[_0x1b0ef5(0xe4)](_0x1b0ef5(0xe6));});a31_0x13463c();'use strict';var __importDefault=this&&this[a31_0x39df65(0xea)]||function(_0x129c2b){const _0x3ee6a4=a31_0x39df65;return _0x129c2b&&_0x129c2b[_0x3ee6a4(0xc6)]?_0x129c2b:{'default':_0x129c2b};};function a31_0x247f(){const _0x2febca=['toDate','10215xjqEqa','rated','createdAt','contactId','21kCPtfL','__esModule','between','endOf','../models/Contact','name','add','default','startOf','user','join','../models/TicketTraking','userId','2493687ididsI','push','subtract','queueId','queuedAt','queue','11AznXNB','tag','whatsapp','DESC','804gGdIZx','number','../models/Tag','../models/User','constructor','../models/Queue','findAll','17263410xeddfE','search','startedAt','(((.+)+)+)+$','finishedAt','../models/Ticket','day','__importDefault','541334VrckOQ','body','945954pNlFep','findOne','isBetween','status','N/A','2252040kLRpVZ','../models/TicketTag','ratingAt','7374519jkYYEw','json','tagId','2RXEMeW','toString','apply'];a31_0x247f=function(){return _0x2febca;};return a31_0x247f();}Object['defineProperty'](exports,'__esModule',{'value':!![]});function a31_0x43c2(_0x5ba4e0,_0x3500b0){const _0x5576f7=a31_0x247f();return a31_0x43c2=function(_0x13463c,_0x271114){_0x13463c=_0x13463c-0xbb;let _0x247fa0=_0x5576f7[_0x13463c];return _0x247fa0;},a31_0x43c2(_0x5ba4e0,_0x3500b0);}const Ticket_1=__importDefault(require(a31_0x39df65(0xe8))),sequelize_1=require('sequelize'),moment_1=__importDefault(require('moment/moment')),User_1=__importDefault(require(a31_0x39df65(0xdf))),Queue_1=__importDefault(require(a31_0x39df65(0xe1))),TicketTag_1=__importDefault(require(a31_0x39df65(0xf3))),Tag_1=__importDefault(require(a31_0x39df65(0xde))),Whatsapp_1=__importDefault(require('../models/Whatsapp')),TicketTraking_1=__importDefault(require(a31_0x39df65(0xd0))),Contact_1=__importDefault(require(a31_0x39df65(0xc9))),ReportController={'tickets':async(_0x259430,_0x55f564)=>{const _0x34e888=a31_0x39df65,{companyId:_0x1379be}=_0x259430[_0x34e888(0xce)];let {dateStart:_0x48960f,dateEnd:_0x1b3ddb,status:_0x460426,queueId:_0x3bbca7}=_0x259430[_0x34e888(0xec)],_0x39dc6c={'companyId':_0x1379be};_0x3bbca7&&(_0x39dc6c[_0x34e888(0xd5)]=_0x3bbca7);_0x460426&&(_0x39dc6c['status']=_0x460426);let _0x4255be=await Ticket_1[_0x34e888(0xcc)][_0x34e888(0xe2)]({'where':{..._0x39dc6c,'createdAt':{[sequelize_1['Op'][_0x34e888(0xc7)]]:[(0x0,moment_1['default'])(_0x48960f)[_0x34e888(0xcd)](_0x34e888(0xe9))[_0x34e888(0xc0)](),(0x0,moment_1['default'])(_0x1b3ddb)[_0x34e888(0xc8)](_0x34e888(0xe9))[_0x34e888(0xc0)]()]}},'include':[{'model':User_1['default'],'as':'user','attributes':['id',_0x34e888(0xca),'profile']},{'model':Queue_1[_0x34e888(0xcc)],'as':_0x34e888(0xd7),'attributes':['id',_0x34e888(0xca)]},{'model':Whatsapp_1['default'],'as':_0x34e888(0xda),'attributes':['id','name']}],'attributes':['id',_0x34e888(0xc3),_0x34e888(0xf0),'queueId',_0x34e888(0xd1),_0x34e888(0xc4)],'order':[[_0x34e888(0xc3),_0x34e888(0xdb)]]}),_0x25b2b2=[];for(let _0x3eb818 of _0x4255be){const _0x53e53a=await TicketTag_1[_0x34e888(0xcc)][_0x34e888(0xe2)]({'attributes':[_0x34e888(0xbc)],'where':{'ticketId':_0x3eb818['id']},'include':[{'model':Tag_1[_0x34e888(0xcc)],'as':_0x34e888(0xd9),'attributes':['id',_0x34e888(0xca)]}]});var _0x521843=await TicketTraking_1[_0x34e888(0xcc)][_0x34e888(0xee)]({'where':{'ticketId':_0x3eb818['id']},'attributes':[_0x34e888(0xe5),_0x34e888(0xd6),_0x34e888(0xf4),_0x34e888(0xc2),_0x34e888(0xc3),'finishedAt']});let _0x26de84=await Contact_1[_0x34e888(0xcc)][_0x34e888(0xee)]({'attributes':[_0x34e888(0xc3),_0x34e888(0xca),_0x34e888(0xdd)],'where':{'id':_0x3eb818['contactId']}}),_0x33f77a=![];_0x26de84&&(_0x33f77a=(0x0,moment_1[_0x34e888(0xcc)])(_0x26de84[_0x34e888(0xc3)])[_0x34e888(0xef)]((0x0,moment_1[_0x34e888(0xcc)])(_0x3eb818[_0x34e888(0xc3)])[_0x34e888(0xd4)](0x1,'minute'),(0x0,moment_1[_0x34e888(0xcc)])(_0x3eb818[_0x34e888(0xc3)])[_0x34e888(0xcb)](0x1,'minute'))),_0x25b2b2[_0x34e888(0xd3)]({'id':_0x3eb818['id'],'contactName':_0x26de84?.['name']||'N/A','contactNumber':_0x26de84?.[_0x34e888(0xdd)]||'N/A','createdAt':_0x3eb818?.['createdAt'],'startedAt':_0x521843?.[_0x34e888(0xe5)],'queuedAt':_0x521843?.[_0x34e888(0xd6)],'ratingAt':_0x521843?.[_0x34e888(0xf4)],'rated':_0x521843?.[_0x34e888(0xc2)],'status':_0x3eb818[_0x34e888(0xf0)],'user':_0x3eb818['user']?.[_0x34e888(0xca)]||'N/A','userId':_0x3eb818[_0x34e888(0xd1)],'queue':_0x3eb818['queue']?.['name']||_0x34e888(0xf1),'queueId':_0x3eb818[_0x34e888(0xd5)],'connection':_0x3eb818[_0x34e888(0xda)]['name'],'connectionId':_0x3eb818[_0x34e888(0xda)]['id'],'firstSentMessageAt':_0x521843?.[_0x34e888(0xc3)],'resolvedAt':_0x521843?.[_0x34e888(0xe7)],'isNewContact':_0x33f77a,'tags':_0x53e53a['map'](_0x31125b=>_0x31125b[_0x34e888(0xd9)]['name'])[_0x34e888(0xcf)](',')});}return _0x55f564[_0x34e888(0xbb)](_0x25b2b2);}};exports['default']=ReportController;