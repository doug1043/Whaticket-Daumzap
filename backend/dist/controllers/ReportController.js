const a33_0x308a13=a33_0xbcde;function a33_0x1dd4(){const _0x5c9446=['../models/Tag','__esModule','4480ckgLPQ','contactId','tag','../models/User','N/A','77pUPyKC','1490586FwTzqL','findOne','push','__importDefault','toString','subtract','24YjjwSt','join','search','defineProperty','../models/Whatsapp','moment/moment','ratingAt','2741898qnVUBM','../models/Queue','default','../models/Ticket','json','startedAt','startOf','../models/Contact','queue','toDate','map','queueId','53870PbYJNv','whatsapp','between','tagId','rated','findAll','finishedAt','queuedAt','createdAt','isBetween','userId','sequelize','3382860IbOroE','apply','../models/TicketTag','name','day','2171604miCmNG','5ORhjPk','../models/TicketTraking','user','add','minute','number','status','19692IHWIJP','(((.+)+)+)+$','304HwcrVj','188867nEkeLR'];a33_0x1dd4=function(){return _0x5c9446;};return a33_0x1dd4();}(function(_0x20dac6,_0x590139){const _0xe368c6=a33_0xbcde,_0x47a84a=_0x20dac6();while(!![]){try{const _0x3676ca=parseInt(_0xe368c6(0x18a))/0x1*(-parseInt(_0xe368c6(0x19d))/0x2)+parseInt(_0xe368c6(0x191))/0x3+parseInt(_0xe368c6(0x170))/0x4+-parseInt(_0xe368c6(0x171))/0x5*(parseInt(_0xe368c6(0x184))/0x6)+-parseInt(_0xe368c6(0x17b))/0x7*(parseInt(_0xe368c6(0x17a))/0x8)+-parseInt(_0xe368c6(0x178))/0x9*(parseInt(_0xe368c6(0x17e))/0xa)+-parseInt(_0xe368c6(0x183))/0xb*(-parseInt(_0xe368c6(0x16b))/0xc);if(_0x3676ca===_0x590139)break;else _0x47a84a['push'](_0x47a84a['shift']());}catch(_0x2ee8a0){_0x47a84a['push'](_0x47a84a['shift']());}}}(a33_0x1dd4,0x815a5));const a33_0x3428bf=(function(){let _0x14d3a2=!![];return function(_0xa0e03a,_0x1275b9){const _0x5db1bc=_0x14d3a2?function(){const _0x6193b3=a33_0xbcde;if(_0x1275b9){const _0x410441=_0x1275b9[_0x6193b3(0x16c)](_0xa0e03a,arguments);return _0x1275b9=null,_0x410441;}}:function(){};return _0x14d3a2=![],_0x5db1bc;};}()),a33_0x12b277=a33_0x3428bf(this,function(){const _0x478682=a33_0xbcde;return a33_0x12b277['toString']()['search'](_0x478682(0x179))[_0x478682(0x188)]()['constructor'](a33_0x12b277)[_0x478682(0x18c)]('(((.+)+)+)+$');});a33_0x12b277();'use strict';var __importDefault=this&&this[a33_0x308a13(0x187)]||function(_0x380831){return _0x380831&&_0x380831['__esModule']?_0x380831:{'default':_0x380831};};Object[a33_0x308a13(0x18d)](exports,a33_0x308a13(0x17d),{'value':!![]});function a33_0xbcde(_0x1c6554,_0x5f56dd){const _0xcf402f=a33_0x1dd4();return a33_0xbcde=function(_0x12b277,_0x3428bf){_0x12b277=_0x12b277-0x16b;let _0x1dd4ce=_0xcf402f[_0x12b277];return _0x1dd4ce;},a33_0xbcde(_0x1c6554,_0x5f56dd);}const Ticket_1=__importDefault(require(a33_0x308a13(0x194))),sequelize_1=require(a33_0x308a13(0x1a8)),moment_1=__importDefault(require(a33_0x308a13(0x18f))),User_1=__importDefault(require(a33_0x308a13(0x181))),Queue_1=__importDefault(require(a33_0x308a13(0x192))),TicketTag_1=__importDefault(require(a33_0x308a13(0x16d))),Tag_1=__importDefault(require(a33_0x308a13(0x17c))),Whatsapp_1=__importDefault(require(a33_0x308a13(0x18e))),TicketTraking_1=__importDefault(require(a33_0x308a13(0x172))),Contact_1=__importDefault(require(a33_0x308a13(0x198))),ReportController={'tickets':async(_0x73b429,_0x2732d1)=>{const _0x38902c=a33_0x308a13,{companyId:_0xc09dad}=_0x73b429[_0x38902c(0x173)];let {dateStart:_0x54bb8f,dateEnd:_0x37ff78,status:_0xec0fdc,queueId:_0x44780e}=_0x73b429['body'],_0x3bed88={'companyId':_0xc09dad};_0x44780e&&(_0x3bed88[_0x38902c(0x19c)]=_0x44780e);_0xec0fdc&&(_0x3bed88['status']=_0xec0fdc);let _0x2c1c8a=await Ticket_1[_0x38902c(0x193)][_0x38902c(0x1a2)]({'where':{..._0x3bed88,'createdAt':{[sequelize_1['Op'][_0x38902c(0x19f)]]:[(0x0,moment_1['default'])(_0x54bb8f)[_0x38902c(0x197)](_0x38902c(0x16f))[_0x38902c(0x19a)](),(0x0,moment_1[_0x38902c(0x193)])(_0x37ff78)['endOf'](_0x38902c(0x16f))[_0x38902c(0x19a)]()]}},'include':[{'model':User_1[_0x38902c(0x193)],'as':_0x38902c(0x173),'attributes':['id',_0x38902c(0x16e),'profile']},{'model':Queue_1[_0x38902c(0x193)],'as':_0x38902c(0x199),'attributes':['id',_0x38902c(0x16e)]},{'model':Whatsapp_1[_0x38902c(0x193)],'as':'whatsapp','attributes':['id',_0x38902c(0x16e)]}],'attributes':['id',_0x38902c(0x1a5),_0x38902c(0x177),_0x38902c(0x19c),_0x38902c(0x1a7),_0x38902c(0x17f)],'order':[[_0x38902c(0x1a5),'DESC']]}),_0x1916c3=[];for(let _0x207278 of _0x2c1c8a){const _0x9980cf=await TicketTag_1[_0x38902c(0x193)][_0x38902c(0x1a2)]({'attributes':[_0x38902c(0x1a0)],'where':{'ticketId':_0x207278['id']},'include':[{'model':Tag_1[_0x38902c(0x193)],'as':_0x38902c(0x180),'attributes':['id','name']}]});var _0xa654dc=await TicketTraking_1[_0x38902c(0x193)][_0x38902c(0x185)]({'where':{'ticketId':_0x207278['id']},'attributes':[_0x38902c(0x196),_0x38902c(0x1a4),_0x38902c(0x190),_0x38902c(0x1a1),_0x38902c(0x1a5),'finishedAt']});let _0x457e00=await Contact_1[_0x38902c(0x193)][_0x38902c(0x185)]({'attributes':['createdAt',_0x38902c(0x16e),_0x38902c(0x176)],'where':{'id':_0x207278[_0x38902c(0x17f)]}}),_0x512307=![];_0x457e00&&(_0x512307=(0x0,moment_1['default'])(_0x457e00[_0x38902c(0x1a5)])[_0x38902c(0x1a6)]((0x0,moment_1[_0x38902c(0x193)])(_0x207278[_0x38902c(0x1a5)])[_0x38902c(0x189)](0x1,_0x38902c(0x175)),(0x0,moment_1[_0x38902c(0x193)])(_0x207278['createdAt'])[_0x38902c(0x174)](0x1,_0x38902c(0x175)))),_0x1916c3[_0x38902c(0x186)]({'id':_0x207278['id'],'contactName':_0x457e00?.[_0x38902c(0x16e)]||_0x38902c(0x182),'contactNumber':_0x457e00?.[_0x38902c(0x176)]||_0x38902c(0x182),'createdAt':_0x207278?.[_0x38902c(0x1a5)],'startedAt':_0xa654dc?.['startedAt'],'queuedAt':_0xa654dc?.[_0x38902c(0x1a4)],'ratingAt':_0xa654dc?.[_0x38902c(0x190)],'rated':_0xa654dc?.[_0x38902c(0x1a1)],'status':_0x207278[_0x38902c(0x177)],'user':_0x207278[_0x38902c(0x173)]?.['name']||_0x38902c(0x182),'userId':_0x207278['userId'],'queue':_0x207278[_0x38902c(0x199)]?.['name']||_0x38902c(0x182),'queueId':_0x207278[_0x38902c(0x19c)],'connection':_0x207278[_0x38902c(0x19e)]['name'],'connectionId':_0x207278[_0x38902c(0x19e)]['id'],'firstSentMessageAt':_0xa654dc?.[_0x38902c(0x1a5)],'resolvedAt':_0xa654dc?.[_0x38902c(0x1a3)],'isNewContact':_0x512307,'tags':_0x9980cf[_0x38902c(0x19b)](_0x338b08=>_0x338b08['tag'][_0x38902c(0x16e)])[_0x38902c(0x18b)](',')});}return _0x2732d1[_0x38902c(0x195)](_0x1916c3);}};exports['default']=ReportController;