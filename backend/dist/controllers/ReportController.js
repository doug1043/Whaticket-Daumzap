const a38_0x4dc513=a38_0x2252;(function(_0x326f46,_0x41ddb1){const _0x29a3c4=a38_0x2252,_0x5776ee=_0x326f46();while(!![]){try{const _0x59dfcc=parseInt(_0x29a3c4(0xab))/0x1*(-parseInt(_0x29a3c4(0xaa))/0x2)+-parseInt(_0x29a3c4(0xa5))/0x3*(-parseInt(_0x29a3c4(0xb8))/0x4)+parseInt(_0x29a3c4(0xc0))/0x5*(parseInt(_0x29a3c4(0xb1))/0x6)+parseInt(_0x29a3c4(0x8a))/0x7*(parseInt(_0x29a3c4(0xb6))/0x8)+parseInt(_0x29a3c4(0x88))/0x9*(parseInt(_0x29a3c4(0x8f))/0xa)+parseInt(_0x29a3c4(0x9f))/0xb*(-parseInt(_0x29a3c4(0x9a))/0xc)+-parseInt(_0x29a3c4(0xbe))/0xd*(parseInt(_0x29a3c4(0xaf))/0xe);if(_0x59dfcc===_0x41ddb1)break;else _0x5776ee['push'](_0x5776ee['shift']());}catch(_0x812c6f){_0x5776ee['push'](_0x5776ee['shift']());}}}(a38_0x1bcc,0x22152));const a38_0x522e94=(function(){let _0x12d6fb=!![];return function(_0x1261c5,_0x21e7e6){const _0x36c4e6=_0x12d6fb?function(){const _0xe01de9=a38_0x2252;if(_0x21e7e6){const _0x137336=_0x21e7e6[_0xe01de9(0xb5)](_0x1261c5,arguments);return _0x21e7e6=null,_0x137336;}}:function(){};return _0x12d6fb=![],_0x36c4e6;};}()),a38_0x35687f=a38_0x522e94(this,function(){const _0x5e74d4=a38_0x2252;return a38_0x35687f[_0x5e74d4(0xa3)]()[_0x5e74d4(0xbd)](_0x5e74d4(0x99))[_0x5e74d4(0xa3)]()['constructor'](a38_0x35687f)['search'](_0x5e74d4(0x99));});a38_0x35687f();'use strict';function a38_0x2252(_0xaee9fe,_0x5df414){const _0x1048de=a38_0x1bcc();return a38_0x2252=function(_0x35687f,_0x522e94){_0x35687f=_0x35687f-0x85;let _0x1bcca2=_0x1048de[_0x35687f];return _0x1bcca2;},a38_0x2252(_0xaee9fe,_0x5df414);}var __importDefault=this&&this[a38_0x4dc513(0x8d)]||function(_0x3eeb85){const _0x174a66=a38_0x4dc513;return _0x3eeb85&&_0x3eeb85[_0x174a66(0xa4)]?_0x3eeb85:{'default':_0x3eeb85};};Object[a38_0x4dc513(0xac)](exports,a38_0x4dc513(0xa4),{'value':!![]});const Ticket_1=__importDefault(require(a38_0x4dc513(0x8c))),sequelize_1=require(a38_0x4dc513(0xba)),moment_1=__importDefault(require(a38_0x4dc513(0x92))),User_1=__importDefault(require(a38_0x4dc513(0x86))),Queue_1=__importDefault(require(a38_0x4dc513(0xb2))),TicketTag_1=__importDefault(require('../models/TicketTag')),Tag_1=__importDefault(require(a38_0x4dc513(0xa8))),Whatsapp_1=__importDefault(require('../models/Whatsapp')),TicketTraking_1=__importDefault(require(a38_0x4dc513(0x95))),Contact_1=__importDefault(require(a38_0x4dc513(0xa1))),ReportController={'tickets':async(_0xfa9792,_0x57b7b3)=>{const _0x1643bc=a38_0x4dc513,{companyId:_0x2e6667}=_0xfa9792[_0x1643bc(0xb3)];let {dateStart:_0x911fb5,dateEnd:_0x21a610,status:_0x4d0963,queueId:_0x2030c1}=_0xfa9792[_0x1643bc(0xa2)],_0xcb6661={'companyId':_0x2e6667};_0x2030c1&&(_0xcb6661[_0x1643bc(0x87)]=_0x2030c1);_0x4d0963&&(_0xcb6661['status']=_0x4d0963);let _0x466598=await Ticket_1[_0x1643bc(0x96)][_0x1643bc(0xa0)]({'where':{..._0xcb6661,'createdAt':{[sequelize_1['Op'][_0x1643bc(0xbf)]]:[(0x0,moment_1[_0x1643bc(0x96)])(_0x911fb5)[_0x1643bc(0xbb)]('day')[_0x1643bc(0x97)](),(0x0,moment_1[_0x1643bc(0x96)])(_0x21a610)[_0x1643bc(0x98)]('day')[_0x1643bc(0x97)]()]}},'include':[{'model':User_1[_0x1643bc(0x96)],'as':_0x1643bc(0xb3),'attributes':['id',_0x1643bc(0x89),_0x1643bc(0xad)]},{'model':Queue_1[_0x1643bc(0x96)],'as':'queue','attributes':['id',_0x1643bc(0x89)]},{'model':Whatsapp_1[_0x1643bc(0x96)],'as':_0x1643bc(0xa7),'attributes':['id',_0x1643bc(0x89)]}],'attributes':['id',_0x1643bc(0x9b),_0x1643bc(0xb9),_0x1643bc(0x87),_0x1643bc(0x85),_0x1643bc(0x91)],'order':[[_0x1643bc(0x9b),_0x1643bc(0xbc)]]}),_0x15773b=[];for(let _0x408428 of _0x466598){const _0x424bb9=await TicketTag_1[_0x1643bc(0x96)]['findAll']({'attributes':[_0x1643bc(0x90)],'where':{'ticketId':_0x408428['id']},'include':[{'model':Tag_1['default'],'as':_0x1643bc(0xae),'attributes':['id',_0x1643bc(0x89)]}]});var _0x140575=await TicketTraking_1['default'][_0x1643bc(0x9c)]({'where':{'ticketId':_0x408428['id']},'attributes':['startedAt','queuedAt','ratingAt',_0x1643bc(0x8e),_0x1643bc(0x9b),_0x1643bc(0xa9)]});let _0x2c67b8=await Contact_1[_0x1643bc(0x96)][_0x1643bc(0x9c)]({'attributes':[_0x1643bc(0x9b),_0x1643bc(0x89),_0x1643bc(0x9e)],'where':{'id':_0x408428[_0x1643bc(0x91)]}}),_0x42508a=![];_0x2c67b8&&(_0x42508a=(0x0,moment_1[_0x1643bc(0x96)])(_0x2c67b8[_0x1643bc(0x9b)])['isBetween']((0x0,moment_1[_0x1643bc(0x96)])(_0x408428[_0x1643bc(0x9b)])[_0x1643bc(0xb7)](0x1,_0x1643bc(0xc1)),(0x0,moment_1[_0x1643bc(0x96)])(_0x408428[_0x1643bc(0x9b)])[_0x1643bc(0x93)](0x1,_0x1643bc(0xc1)))),_0x15773b['push']({'id':_0x408428['id'],'contactName':_0x2c67b8?.[_0x1643bc(0x89)]||'N/A','contactNumber':_0x2c67b8?.['number']||'N/A','createdAt':_0x408428?.[_0x1643bc(0x9b)],'startedAt':_0x140575?.['startedAt'],'queuedAt':_0x140575?.['queuedAt'],'ratingAt':_0x140575?.[_0x1643bc(0x8b)],'rated':_0x140575?.[_0x1643bc(0x8e)],'status':_0x408428['status'],'user':_0x408428['user']?.[_0x1643bc(0x89)]||_0x1643bc(0x9d),'userId':_0x408428['userId'],'queue':_0x408428[_0x1643bc(0xb4)]?.[_0x1643bc(0x89)]||_0x1643bc(0x9d),'queueId':_0x408428[_0x1643bc(0x87)],'connection':_0x408428['whatsapp'][_0x1643bc(0x89)],'connectionId':_0x408428[_0x1643bc(0xa7)]['id'],'firstSentMessageAt':_0x140575?.['createdAt'],'resolvedAt':_0x140575?.[_0x1643bc(0xa9)],'isNewContact':_0x42508a,'tags':_0x424bb9[_0x1643bc(0x94)](_0x2b75ce=>_0x2b75ce[_0x1643bc(0xae)]['name'])[_0x1643bc(0xa6)](',')});}return _0x57b7b3[_0x1643bc(0xb0)](_0x15773b);}};function a38_0x1bcc(){const _0x3336e8=['5BabtFo','minute','userId','../models/User','queueId','2101419obLsxb','name','217kyUJHJ','ratingAt','../models/Ticket','__importDefault','rated','10SEnAWG','tagId','contactId','moment/moment','add','map','../models/TicketTraking','default','toDate','endOf','(((.+)+)+)+$','1807116rnhalD','createdAt','findOne','N/A','number','11YGDdza','findAll','../models/Contact','body','toString','__esModule','573LYOQKO','join','whatsapp','../models/Tag','finishedAt','20lICTyh','19387kGdQPU','defineProperty','profile','tag','224TpWQvu','json','477204bznUmZ','../models/Queue','user','queue','apply','29896yiKgYA','subtract','3612vsXexR','status','sequelize','startOf','DESC','search','95290jMsejK','between'];a38_0x1bcc=function(){return _0x3336e8;};return a38_0x1bcc();}exports[a38_0x4dc513(0x96)]=ReportController;