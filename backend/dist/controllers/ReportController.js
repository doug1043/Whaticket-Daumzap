const a32_0x5aaa10=a32_0x5b99;(function(_0xc6e7ce,_0x4cf4a5){const _0x79bdfc=a32_0x5b99,_0x28f522=_0xc6e7ce();while(!![]){try{const _0x381db5=parseInt(_0x79bdfc(0x139))/0x1+parseInt(_0x79bdfc(0x154))/0x2*(-parseInt(_0x79bdfc(0x134))/0x3)+-parseInt(_0x79bdfc(0x151))/0x4+parseInt(_0x79bdfc(0x121))/0x5*(parseInt(_0x79bdfc(0x12b))/0x6)+-parseInt(_0x79bdfc(0x126))/0x7*(parseInt(_0x79bdfc(0x138))/0x8)+parseInt(_0x79bdfc(0x142))/0x9+parseInt(_0x79bdfc(0x148))/0xa*(parseInt(_0x79bdfc(0x14c))/0xb);if(_0x381db5===_0x4cf4a5)break;else _0x28f522['push'](_0x28f522['shift']());}catch(_0x5ae82d){_0x28f522['push'](_0x28f522['shift']());}}}(a32_0x8dab,0x4317c));const a32_0x5beb09=(function(){let _0x1b7e72=!![];return function(_0x5943a5,_0x291c9d){const _0x4b17bf=_0x1b7e72?function(){if(_0x291c9d){const _0x292f52=_0x291c9d['apply'](_0x5943a5,arguments);return _0x291c9d=null,_0x292f52;}}:function(){};return _0x1b7e72=![],_0x4b17bf;};}()),a32_0x10d310=a32_0x5beb09(this,function(){const _0x1cc227=a32_0x5b99;return a32_0x10d310[_0x1cc227(0x12d)]()[_0x1cc227(0x140)]('(((.+)+)+)+$')[_0x1cc227(0x12d)]()['constructor'](a32_0x10d310)[_0x1cc227(0x140)]('(((.+)+)+)+$');});a32_0x10d310();'use strict';var __importDefault=this&&this['__importDefault']||function(_0x350cd0){const _0x14ba55=a32_0x5b99;return _0x350cd0&&_0x350cd0[_0x14ba55(0x13b)]?_0x350cd0:{'default':_0x350cd0};};Object[a32_0x5aaa10(0x152)](exports,a32_0x5aaa10(0x13b),{'value':!![]});function a32_0x5b99(_0x137d31,_0x33841b){const _0x31e34b=a32_0x8dab();return a32_0x5b99=function(_0x10d310,_0x5beb09){_0x10d310=_0x10d310-0x11b;let _0x8dab7d=_0x31e34b[_0x10d310];return _0x8dab7d;},a32_0x5b99(_0x137d31,_0x33841b);}function a32_0x8dab(){const _0x44c2b5=['endOf','836GCNrMe','minute','startOf','toDate','../models/Whatsapp','441116hrcKyO','defineProperty','ratingAt','562962pHoXMw','name','../models/User','findAll','rated','userId','json','12050BmhzSr','number','sequelize','profile','contactId','105BfpQwD','../models/TicketTag','add','N/A','user','354jkmFQU','body','toString','../models/TicketTraking','startedAt','createdAt','isBetween','findOne','status','3vuLhCC','moment/moment','../models/Ticket','default','69952BoebCG','354696NPbVWd','queuedAt','__esModule','between','day','queueId','../models/Tag','search','../models/Contact','433998wKkDJn','join','finishedAt','map','subtract','tagId','33240TQuAsT','whatsapp','tag'];a32_0x8dab=function(){return _0x44c2b5;};return a32_0x8dab();}const Ticket_1=__importDefault(require(a32_0x5aaa10(0x136))),sequelize_1=require(a32_0x5aaa10(0x123)),moment_1=__importDefault(require(a32_0x5aaa10(0x135))),User_1=__importDefault(require(a32_0x5aaa10(0x11c))),Queue_1=__importDefault(require('../models/Queue')),TicketTag_1=__importDefault(require(a32_0x5aaa10(0x127))),Tag_1=__importDefault(require(a32_0x5aaa10(0x13f))),Whatsapp_1=__importDefault(require(a32_0x5aaa10(0x150))),TicketTraking_1=__importDefault(require(a32_0x5aaa10(0x12e))),Contact_1=__importDefault(require(a32_0x5aaa10(0x141))),ReportController={'tickets':async(_0x1b1901,_0x32e6f4)=>{const _0x35dd71=a32_0x5aaa10,{companyId:_0x2bfa6d}=_0x1b1901[_0x35dd71(0x12a)];let {dateStart:_0x398648,dateEnd:_0x4678aa,status:_0x551ec6,queueId:_0x23e2e1}=_0x1b1901[_0x35dd71(0x12c)],_0x5ebc64={'companyId':_0x2bfa6d};_0x23e2e1&&(_0x5ebc64['queueId']=_0x23e2e1);_0x551ec6&&(_0x5ebc64['status']=_0x551ec6);let _0x193354=await Ticket_1[_0x35dd71(0x137)][_0x35dd71(0x11d)]({'where':{..._0x5ebc64,'createdAt':{[sequelize_1['Op'][_0x35dd71(0x13c)]]:[(0x0,moment_1[_0x35dd71(0x137)])(_0x398648)[_0x35dd71(0x14e)](_0x35dd71(0x13d))[_0x35dd71(0x14f)](),(0x0,moment_1[_0x35dd71(0x137)])(_0x4678aa)[_0x35dd71(0x14b)]('day')[_0x35dd71(0x14f)]()]}},'include':[{'model':User_1[_0x35dd71(0x137)],'as':_0x35dd71(0x12a),'attributes':['id',_0x35dd71(0x11b),_0x35dd71(0x124)]},{'model':Queue_1[_0x35dd71(0x137)],'as':'queue','attributes':['id',_0x35dd71(0x11b)]},{'model':Whatsapp_1[_0x35dd71(0x137)],'as':_0x35dd71(0x149),'attributes':['id',_0x35dd71(0x11b)]}],'attributes':['id',_0x35dd71(0x130),'status','queueId',_0x35dd71(0x11f),_0x35dd71(0x125)],'order':[[_0x35dd71(0x130),'DESC']]}),_0x4abb18=[];for(let _0xacfb6f of _0x193354){const _0x15bd35=await TicketTag_1[_0x35dd71(0x137)][_0x35dd71(0x11d)]({'attributes':[_0x35dd71(0x147)],'where':{'ticketId':_0xacfb6f['id']},'include':[{'model':Tag_1['default'],'as':_0x35dd71(0x14a),'attributes':['id',_0x35dd71(0x11b)]}]});var _0x28f180=await TicketTraking_1[_0x35dd71(0x137)][_0x35dd71(0x132)]({'where':{'ticketId':_0xacfb6f['id']},'attributes':['startedAt',_0x35dd71(0x13a),_0x35dd71(0x153),'rated',_0x35dd71(0x130),'finishedAt']});let _0x55a627=await Contact_1[_0x35dd71(0x137)][_0x35dd71(0x132)]({'attributes':['createdAt','name',_0x35dd71(0x122)],'where':{'id':_0xacfb6f[_0x35dd71(0x125)]}}),_0xc56294=![];_0x55a627&&(_0xc56294=(0x0,moment_1[_0x35dd71(0x137)])(_0x55a627[_0x35dd71(0x130)])[_0x35dd71(0x131)]((0x0,moment_1['default'])(_0xacfb6f['createdAt'])[_0x35dd71(0x146)](0x1,_0x35dd71(0x14d)),(0x0,moment_1[_0x35dd71(0x137)])(_0xacfb6f[_0x35dd71(0x130)])[_0x35dd71(0x128)](0x1,_0x35dd71(0x14d)))),_0x4abb18['push']({'id':_0xacfb6f['id'],'contactName':_0x55a627?.[_0x35dd71(0x11b)]||_0x35dd71(0x129),'contactNumber':_0x55a627?.[_0x35dd71(0x122)]||_0x35dd71(0x129),'createdAt':_0xacfb6f?.[_0x35dd71(0x130)],'startedAt':_0x28f180?.[_0x35dd71(0x12f)],'queuedAt':_0x28f180?.[_0x35dd71(0x13a)],'ratingAt':_0x28f180?.['ratingAt'],'rated':_0x28f180?.[_0x35dd71(0x11e)],'status':_0xacfb6f[_0x35dd71(0x133)],'user':_0xacfb6f[_0x35dd71(0x12a)]?.[_0x35dd71(0x11b)]||_0x35dd71(0x129),'userId':_0xacfb6f[_0x35dd71(0x11f)],'queue':_0xacfb6f['queue']?.[_0x35dd71(0x11b)]||_0x35dd71(0x129),'queueId':_0xacfb6f[_0x35dd71(0x13e)],'connection':_0xacfb6f[_0x35dd71(0x149)]['name'],'connectionId':_0xacfb6f['whatsapp']['id'],'firstSentMessageAt':_0x28f180?.['createdAt'],'resolvedAt':_0x28f180?.[_0x35dd71(0x144)],'isNewContact':_0xc56294,'tags':_0x15bd35[_0x35dd71(0x145)](_0x13065f=>_0x13065f[_0x35dd71(0x14a)]['name'])[_0x35dd71(0x143)](',')});}return _0x32e6f4[_0x35dd71(0x120)](_0x4abb18);}};exports[a32_0x5aaa10(0x137)]=ReportController;