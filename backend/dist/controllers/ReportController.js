const a31_0x1a1c4d=a31_0x5538;(function(_0x2726b2,_0x4c17de){const _0x1c9ae5=a31_0x5538,_0x2b509a=_0x2726b2();while(!![]){try{const _0x484f26=-parseInt(_0x1c9ae5(0x16e))/0x1*(-parseInt(_0x1c9ae5(0x188))/0x2)+parseInt(_0x1c9ae5(0x164))/0x3+parseInt(_0x1c9ae5(0x184))/0x4*(-parseInt(_0x1c9ae5(0x18a))/0x5)+-parseInt(_0x1c9ae5(0x14d))/0x6*(parseInt(_0x1c9ae5(0x14e))/0x7)+-parseInt(_0x1c9ae5(0x161))/0x8*(parseInt(_0x1c9ae5(0x151))/0x9)+-parseInt(_0x1c9ae5(0x156))/0xa+-parseInt(_0x1c9ae5(0x163))/0xb*(-parseInt(_0x1c9ae5(0x150))/0xc);if(_0x484f26===_0x4c17de)break;else _0x2b509a['push'](_0x2b509a['shift']());}catch(_0xf4a768){_0x2b509a['push'](_0x2b509a['shift']());}}}(a31_0x1ced,0x4fe87));const a31_0x3c5682=(function(){let _0x5b4d4d=!![];return function(_0x4eab1b,_0x270b8e){const _0x1a2f7f=_0x5b4d4d?function(){const _0x410b38=a31_0x5538;if(_0x270b8e){const _0x2da55a=_0x270b8e[_0x410b38(0x176)](_0x4eab1b,arguments);return _0x270b8e=null,_0x2da55a;}}:function(){};return _0x5b4d4d=![],_0x1a2f7f;};}()),a31_0x379038=a31_0x3c5682(this,function(){const _0x121400=a31_0x5538;return a31_0x379038[_0x121400(0x187)]()[_0x121400(0x172)](_0x121400(0x168))['toString']()['constructor'](a31_0x379038)[_0x121400(0x172)](_0x121400(0x168));});a31_0x379038();function a31_0x1ced(){const _0x30b0b3=['user','../models/TicketTag','__importDefault','apply','startedAt','rated','day','whatsapp','../models/Contact','toDate','__esModule','tag','default','isBetween','name','json','profile','206728ytjXPU','status','body','toString','14ThKIVb','between','20nWIcez','1143642udRtCM','21CunNJH','minute','12KzxSOD','711DPPOtp','../models/Tag','contactId','tagId','createdAt','4869910Ejiwpo','queue','number','moment/moment','subtract','userId','ratingAt','defineProperty','finishedAt','join','findAll','45728eVpmuv','add','17413484kbTxoZ','1237698JMcnWX','N/A','findOne','DESC','(((.+)+)+)+$','queueId','endOf','sequelize','../models/Whatsapp','push','6971pVENEv','startOf','map','queuedAt','search'];a31_0x1ced=function(){return _0x30b0b3;};return a31_0x1ced();}'use strict';var __importDefault=this&&this[a31_0x1a1c4d(0x175)]||function(_0x54a638){const _0x1b24da=a31_0x1a1c4d;return _0x54a638&&_0x54a638[_0x1b24da(0x17d)]?_0x54a638:{'default':_0x54a638};};Object[a31_0x1a1c4d(0x15d)](exports,a31_0x1a1c4d(0x17d),{'value':!![]});function a31_0x5538(_0x269180,_0x32edcb){const _0x2aa2ae=a31_0x1ced();return a31_0x5538=function(_0x379038,_0x3c5682){_0x379038=_0x379038-0x14d;let _0x1ced08=_0x2aa2ae[_0x379038];return _0x1ced08;},a31_0x5538(_0x269180,_0x32edcb);}const Ticket_1=__importDefault(require('../models/Ticket')),sequelize_1=require(a31_0x1a1c4d(0x16b)),moment_1=__importDefault(require(a31_0x1a1c4d(0x159))),User_1=__importDefault(require('../models/User')),Queue_1=__importDefault(require('../models/Queue')),TicketTag_1=__importDefault(require(a31_0x1a1c4d(0x174))),Tag_1=__importDefault(require(a31_0x1a1c4d(0x152))),Whatsapp_1=__importDefault(require(a31_0x1a1c4d(0x16c))),TicketTraking_1=__importDefault(require('../models/TicketTraking')),Contact_1=__importDefault(require(a31_0x1a1c4d(0x17b))),ReportController={'tickets':async(_0x18a9dd,_0x30caca)=>{const _0x251f06=a31_0x1a1c4d,{companyId:_0x4b22f6}=_0x18a9dd['user'];let {dateStart:_0x325c9c,dateEnd:_0x19121e,status:_0x15e642,queueId:_0x185f97}=_0x18a9dd[_0x251f06(0x186)],_0x2487e={'companyId':_0x4b22f6};_0x185f97&&(_0x2487e[_0x251f06(0x169)]=_0x185f97);_0x15e642&&(_0x2487e[_0x251f06(0x185)]=_0x15e642);let _0xe1b54e=await Ticket_1[_0x251f06(0x17f)][_0x251f06(0x160)]({'where':{..._0x2487e,'createdAt':{[sequelize_1['Op'][_0x251f06(0x189)]]:[(0x0,moment_1[_0x251f06(0x17f)])(_0x325c9c)[_0x251f06(0x16f)](_0x251f06(0x179))[_0x251f06(0x17c)](),(0x0,moment_1[_0x251f06(0x17f)])(_0x19121e)[_0x251f06(0x16a)](_0x251f06(0x179))[_0x251f06(0x17c)]()]}},'include':[{'model':User_1[_0x251f06(0x17f)],'as':_0x251f06(0x173),'attributes':['id','name',_0x251f06(0x183)]},{'model':Queue_1[_0x251f06(0x17f)],'as':'queue','attributes':['id','name']},{'model':Whatsapp_1[_0x251f06(0x17f)],'as':_0x251f06(0x17a),'attributes':['id',_0x251f06(0x181)]}],'attributes':['id',_0x251f06(0x155),'status',_0x251f06(0x169),_0x251f06(0x15b),'contactId'],'order':[[_0x251f06(0x155),_0x251f06(0x167)]]}),_0x4b04f1=[];for(let _0x5cf186 of _0xe1b54e){const _0x39dd32=await TicketTag_1[_0x251f06(0x17f)][_0x251f06(0x160)]({'attributes':[_0x251f06(0x154)],'where':{'ticketId':_0x5cf186['id']},'include':[{'model':Tag_1['default'],'as':_0x251f06(0x17e),'attributes':['id','name']}]});var _0xf37015=await TicketTraking_1['default'][_0x251f06(0x166)]({'where':{'ticketId':_0x5cf186['id']},'attributes':[_0x251f06(0x177),_0x251f06(0x171),_0x251f06(0x15c),_0x251f06(0x178),'createdAt',_0x251f06(0x15e)]});let _0x51974d=await Contact_1[_0x251f06(0x17f)]['findOne']({'attributes':[_0x251f06(0x155),'name',_0x251f06(0x158)],'where':{'id':_0x5cf186[_0x251f06(0x153)]}}),_0x42c0ab=![];_0x51974d&&(_0x42c0ab=(0x0,moment_1[_0x251f06(0x17f)])(_0x51974d['createdAt'])[_0x251f06(0x180)]((0x0,moment_1['default'])(_0x5cf186[_0x251f06(0x155)])[_0x251f06(0x15a)](0x1,_0x251f06(0x14f)),(0x0,moment_1[_0x251f06(0x17f)])(_0x5cf186[_0x251f06(0x155)])[_0x251f06(0x162)](0x1,'minute'))),_0x4b04f1[_0x251f06(0x16d)]({'id':_0x5cf186['id'],'contactName':_0x51974d?.['name']||_0x251f06(0x165),'contactNumber':_0x51974d?.[_0x251f06(0x158)]||_0x251f06(0x165),'createdAt':_0x5cf186?.[_0x251f06(0x155)],'startedAt':_0xf37015?.['startedAt'],'queuedAt':_0xf37015?.[_0x251f06(0x171)],'ratingAt':_0xf37015?.['ratingAt'],'rated':_0xf37015?.[_0x251f06(0x178)],'status':_0x5cf186[_0x251f06(0x185)],'user':_0x5cf186[_0x251f06(0x173)]?.[_0x251f06(0x181)]||'N/A','userId':_0x5cf186['userId'],'queue':_0x5cf186[_0x251f06(0x157)]?.[_0x251f06(0x181)]||_0x251f06(0x165),'queueId':_0x5cf186[_0x251f06(0x169)],'connection':_0x5cf186[_0x251f06(0x17a)][_0x251f06(0x181)],'connectionId':_0x5cf186[_0x251f06(0x17a)]['id'],'firstSentMessageAt':_0xf37015?.[_0x251f06(0x155)],'resolvedAt':_0xf37015?.[_0x251f06(0x15e)],'isNewContact':_0x42c0ab,'tags':_0x39dd32[_0x251f06(0x170)](_0x34406e=>_0x34406e[_0x251f06(0x17e)]['name'])[_0x251f06(0x15f)](',')});}return _0x30caca[_0x251f06(0x182)](_0x4b04f1);}};exports[a31_0x1a1c4d(0x17f)]=ReportController;