const a33_0x5474f5=a33_0x3b38;(function(_0x19a3e2,_0x7b31db){const _0x4cb3a1=a33_0x3b38,_0x318be3=_0x19a3e2();while(!![]){try{const _0x10d150=-parseInt(_0x4cb3a1(0x9e))/0x1+-parseInt(_0x4cb3a1(0xa9))/0x2*(-parseInt(_0x4cb3a1(0xb9))/0x3)+parseInt(_0x4cb3a1(0xac))/0x4*(parseInt(_0x4cb3a1(0xa6))/0x5)+-parseInt(_0x4cb3a1(0xbe))/0x6+parseInt(_0x4cb3a1(0x95))/0x7+-parseInt(_0x4cb3a1(0xb5))/0x8*(-parseInt(_0x4cb3a1(0x97))/0x9)+parseInt(_0x4cb3a1(0x9a))/0xa;if(_0x10d150===_0x7b31db)break;else _0x318be3['push'](_0x318be3['shift']());}catch(_0x3408aa){_0x318be3['push'](_0x318be3['shift']());}}}(a33_0x2c48,0x45d03));function a33_0x2c48(){const _0x88bd67=['973332aWwaUP','rated','(((.+)+)+)+$','finishedAt','toDate','createdAt','constructor','queue','moment/moment','startOf','push','apply','DESC','startedAt','json','../models/TicketTag','body','2677773YSTAtk','tag','162fnMtQm','minute','__esModule','636250XwzOwC','../models/Queue','number','../models/Ticket','309422ZTcmWN','contactId','name','defineProperty','N/A','search','userId','queuedAt','10IZTRxi','ratingAt','day','119202UrKcZi','../models/Whatsapp','endOf','395344sUQuvL','toString','whatsapp','subtract','between','user','status','../models/TicketTraking','sequelize','24072vFBVKV','join','default','add','3XjpCPN','queueId','../models/User','isBetween','findAll'];a33_0x2c48=function(){return _0x88bd67;};return a33_0x2c48();}const a33_0x1c50c3=(function(){let _0x3019a5=!![];return function(_0x53e1e8,_0x43e0db){const _0x412fe0=_0x3019a5?function(){const _0x57feac=a33_0x3b38;if(_0x43e0db){const _0x4f9ae1=_0x43e0db[_0x57feac(0x8f)](_0x53e1e8,arguments);return _0x43e0db=null,_0x4f9ae1;}}:function(){};return _0x3019a5=![],_0x412fe0;};}()),a33_0x2bf2e1=a33_0x1c50c3(this,function(){const _0x459a84=a33_0x3b38;return a33_0x2bf2e1[_0x459a84(0xad)]()[_0x459a84(0xa3)](_0x459a84(0xc0))[_0x459a84(0xad)]()[_0x459a84(0x8a)](a33_0x2bf2e1)[_0x459a84(0xa3)](_0x459a84(0xc0));});a33_0x2bf2e1();'use strict';var __importDefault=this&&this['__importDefault']||function(_0x1f090e){const _0x44d85d=a33_0x3b38;return _0x1f090e&&_0x1f090e[_0x44d85d(0x99)]?_0x1f090e:{'default':_0x1f090e};};Object[a33_0x5474f5(0xa1)](exports,a33_0x5474f5(0x99),{'value':!![]});const Ticket_1=__importDefault(require(a33_0x5474f5(0x9d))),sequelize_1=require(a33_0x5474f5(0xb4)),moment_1=__importDefault(require(a33_0x5474f5(0x8c))),User_1=__importDefault(require(a33_0x5474f5(0xbb))),Queue_1=__importDefault(require(a33_0x5474f5(0x9b))),TicketTag_1=__importDefault(require(a33_0x5474f5(0x93))),Tag_1=__importDefault(require('../models/Tag')),Whatsapp_1=__importDefault(require(a33_0x5474f5(0xaa))),TicketTraking_1=__importDefault(require(a33_0x5474f5(0xb3))),Contact_1=__importDefault(require('../models/Contact')),ReportController={'tickets':async(_0x81eec9,_0x5834b1)=>{const _0x1821f7=a33_0x5474f5,{companyId:_0x5bf0a3}=_0x81eec9[_0x1821f7(0xb1)];let {dateStart:_0x4d8a62,dateEnd:_0x16432a,status:_0x430e13,queueId:_0x217865}=_0x81eec9[_0x1821f7(0x94)],_0x22212a={'companyId':_0x5bf0a3};_0x217865&&(_0x22212a['queueId']=_0x217865);_0x430e13&&(_0x22212a[_0x1821f7(0xb2)]=_0x430e13);let _0x47f995=await Ticket_1[_0x1821f7(0xb7)]['findAll']({'where':{..._0x22212a,'createdAt':{[sequelize_1['Op'][_0x1821f7(0xb0)]]:[(0x0,moment_1[_0x1821f7(0xb7)])(_0x4d8a62)[_0x1821f7(0x8d)](_0x1821f7(0xa8))[_0x1821f7(0xc2)](),(0x0,moment_1['default'])(_0x16432a)[_0x1821f7(0xab)]('day')['toDate']()]}},'include':[{'model':User_1['default'],'as':_0x1821f7(0xb1),'attributes':['id',_0x1821f7(0xa0),'profile']},{'model':Queue_1[_0x1821f7(0xb7)],'as':_0x1821f7(0x8b),'attributes':['id',_0x1821f7(0xa0)]},{'model':Whatsapp_1['default'],'as':_0x1821f7(0xae),'attributes':['id',_0x1821f7(0xa0)]}],'attributes':['id',_0x1821f7(0x89),_0x1821f7(0xb2),_0x1821f7(0xba),_0x1821f7(0xa4),_0x1821f7(0x9f)],'order':[['createdAt',_0x1821f7(0x90)]]}),_0x32dddc=[];for(let _0x1bc255 of _0x47f995){const _0x5e48bd=await TicketTag_1[_0x1821f7(0xb7)][_0x1821f7(0xbd)]({'attributes':['tagId'],'where':{'ticketId':_0x1bc255['id']},'include':[{'model':Tag_1[_0x1821f7(0xb7)],'as':_0x1821f7(0x96),'attributes':['id',_0x1821f7(0xa0)]}]});var _0x5ab8bb=await TicketTraking_1[_0x1821f7(0xb7)]['findOne']({'where':{'ticketId':_0x1bc255['id']},'attributes':[_0x1821f7(0x91),_0x1821f7(0xa5),_0x1821f7(0xa7),_0x1821f7(0xbf),_0x1821f7(0x89),_0x1821f7(0xc1)]});let _0x496a1b=await Contact_1[_0x1821f7(0xb7)]['findOne']({'attributes':['createdAt',_0x1821f7(0xa0),_0x1821f7(0x9c)],'where':{'id':_0x1bc255['contactId']}}),_0x4df1ff=![];_0x496a1b&&(_0x4df1ff=(0x0,moment_1['default'])(_0x496a1b[_0x1821f7(0x89)])[_0x1821f7(0xbc)]((0x0,moment_1['default'])(_0x1bc255['createdAt'])[_0x1821f7(0xaf)](0x1,_0x1821f7(0x98)),(0x0,moment_1['default'])(_0x1bc255[_0x1821f7(0x89)])[_0x1821f7(0xb8)](0x1,_0x1821f7(0x98)))),_0x32dddc[_0x1821f7(0x8e)]({'id':_0x1bc255['id'],'contactName':_0x496a1b?.[_0x1821f7(0xa0)]||_0x1821f7(0xa2),'contactNumber':_0x496a1b?.[_0x1821f7(0x9c)]||_0x1821f7(0xa2),'createdAt':_0x1bc255?.[_0x1821f7(0x89)],'startedAt':_0x5ab8bb?.[_0x1821f7(0x91)],'queuedAt':_0x5ab8bb?.[_0x1821f7(0xa5)],'ratingAt':_0x5ab8bb?.['ratingAt'],'rated':_0x5ab8bb?.[_0x1821f7(0xbf)],'status':_0x1bc255['status'],'user':_0x1bc255[_0x1821f7(0xb1)]?.[_0x1821f7(0xa0)]||_0x1821f7(0xa2),'userId':_0x1bc255[_0x1821f7(0xa4)],'queue':_0x1bc255[_0x1821f7(0x8b)]?.['name']||'N/A','queueId':_0x1bc255['queueId'],'connection':_0x1bc255[_0x1821f7(0xae)][_0x1821f7(0xa0)],'connectionId':_0x1bc255[_0x1821f7(0xae)]['id'],'firstSentMessageAt':_0x5ab8bb?.['createdAt'],'resolvedAt':_0x5ab8bb?.['finishedAt'],'isNewContact':_0x4df1ff,'tags':_0x5e48bd['map'](_0x491fdc=>_0x491fdc[_0x1821f7(0x96)]['name'])[_0x1821f7(0xb6)](',')});}return _0x5834b1[_0x1821f7(0x92)](_0x32dddc);}};function a33_0x3b38(_0x34436b,_0x122046){const _0x1c8309=a33_0x2c48();return a33_0x3b38=function(_0x2bf2e1,_0x1c50c3){_0x2bf2e1=_0x2bf2e1-0x89;let _0x2c4853=_0x1c8309[_0x2bf2e1];return _0x2c4853;},a33_0x3b38(_0x34436b,_0x122046);}exports[a33_0x5474f5(0xb7)]=ReportController;