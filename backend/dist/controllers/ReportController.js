const a33_0x3f5e6b=a33_0x2d4e;function a33_0x2d4e(_0x24e2c5,_0x540da1){const _0x34ac72=a33_0x1682();return a33_0x2d4e=function(_0x27dd0b,_0x2f3ee7){_0x27dd0b=_0x27dd0b-0x1c5;let _0x1682ba=_0x34ac72[_0x27dd0b];return _0x1682ba;},a33_0x2d4e(_0x24e2c5,_0x540da1);}(function(_0xef40bc,_0x486344){const _0x2bb11a=a33_0x2d4e,_0x411fe4=_0xef40bc();while(!![]){try{const _0x182b3b=parseInt(_0x2bb11a(0x1cc))/0x1+-parseInt(_0x2bb11a(0x1db))/0x2+-parseInt(_0x2bb11a(0x1da))/0x3*(-parseInt(_0x2bb11a(0x1f3))/0x4)+parseInt(_0x2bb11a(0x1e5))/0x5*(-parseInt(_0x2bb11a(0x1e7))/0x6)+-parseInt(_0x2bb11a(0x1c5))/0x7+-parseInt(_0x2bb11a(0x1f1))/0x8+parseInt(_0x2bb11a(0x1cf))/0x9;if(_0x182b3b===_0x486344)break;else _0x411fe4['push'](_0x411fe4['shift']());}catch(_0x307b9a){_0x411fe4['push'](_0x411fe4['shift']());}}}(a33_0x1682,0xdbf3d));const a33_0x2f3ee7=(function(){let _0xd797d7=!![];return function(_0x46cf8a,_0x8d09f5){const _0x391cb3=_0xd797d7?function(){const _0x4305ce=a33_0x2d4e;if(_0x8d09f5){const _0x22ae7c=_0x8d09f5[_0x4305ce(0x1f2)](_0x46cf8a,arguments);return _0x8d09f5=null,_0x22ae7c;}}:function(){};return _0xd797d7=![],_0x391cb3;};}()),a33_0x27dd0b=a33_0x2f3ee7(this,function(){const _0x597dda=a33_0x2d4e;return a33_0x27dd0b[_0x597dda(0x1e3)]()[_0x597dda(0x1f8)]('(((.+)+)+)+$')[_0x597dda(0x1e3)]()['constructor'](a33_0x27dd0b)[_0x597dda(0x1f8)]('(((.+)+)+)+$');});a33_0x27dd0b();function a33_0x1682(){const _0x2e6b7f=['ratingAt','add','toDate','status','finishedAt','createdAt','json','260571TCaraF','3462658oocNxf','queueId','queuedAt','queue','findOne','tag','../models/TicketTraking','__esModule','toString','../models/User','58660XYSlhh','defineProperty','786DRlpPq','DESC','default','tagId','../models/Tag','findAll','push','__importDefault','day','between','8166480zZpHJY','apply','68yfnXKg','../models/Contact','startOf','userId','contactId','search','11463767IIJEgo','map','startedAt','name','minute','user','../models/TicketTag','385498rZOSfW','rated','profile','44690130AWcEVd','whatsapp','number','N/A'];a33_0x1682=function(){return _0x2e6b7f;};return a33_0x1682();}'use strict';var __importDefault=this&&this[a33_0x3f5e6b(0x1ee)]||function(_0xf7b6bd){const _0x351688=a33_0x3f5e6b;return _0xf7b6bd&&_0xf7b6bd[_0x351688(0x1e2)]?_0xf7b6bd:{'default':_0xf7b6bd};};Object[a33_0x3f5e6b(0x1e6)](exports,a33_0x3f5e6b(0x1e2),{'value':!![]});const Ticket_1=__importDefault(require('../models/Ticket')),sequelize_1=require('sequelize'),moment_1=__importDefault(require('moment/moment')),User_1=__importDefault(require(a33_0x3f5e6b(0x1e4))),Queue_1=__importDefault(require('../models/Queue')),TicketTag_1=__importDefault(require(a33_0x3f5e6b(0x1cb))),Tag_1=__importDefault(require(a33_0x3f5e6b(0x1eb))),Whatsapp_1=__importDefault(require('../models/Whatsapp')),TicketTraking_1=__importDefault(require(a33_0x3f5e6b(0x1e1))),Contact_1=__importDefault(require(a33_0x3f5e6b(0x1f4))),ReportController={'tickets':async(_0x3fc124,_0x17399b)=>{const _0x5e6360=a33_0x3f5e6b,{companyId:_0x213732}=_0x3fc124[_0x5e6360(0x1ca)];let {dateStart:_0x12200c,dateEnd:_0x374d33,status:_0x15c0f3,queueId:_0x40096d}=_0x3fc124['body'],_0x38a777={'companyId':_0x213732};_0x40096d&&(_0x38a777[_0x5e6360(0x1dc)]=_0x40096d);_0x15c0f3&&(_0x38a777[_0x5e6360(0x1d6)]=_0x15c0f3);let _0x47b919=await Ticket_1[_0x5e6360(0x1e9)][_0x5e6360(0x1ec)]({'where':{..._0x38a777,'createdAt':{[sequelize_1['Op'][_0x5e6360(0x1f0)]]:[(0x0,moment_1['default'])(_0x12200c)[_0x5e6360(0x1f5)](_0x5e6360(0x1ef))[_0x5e6360(0x1d5)](),(0x0,moment_1['default'])(_0x374d33)['endOf'](_0x5e6360(0x1ef))[_0x5e6360(0x1d5)]()]}},'include':[{'model':User_1[_0x5e6360(0x1e9)],'as':_0x5e6360(0x1ca),'attributes':['id','name',_0x5e6360(0x1ce)]},{'model':Queue_1[_0x5e6360(0x1e9)],'as':_0x5e6360(0x1de),'attributes':['id',_0x5e6360(0x1c8)]},{'model':Whatsapp_1['default'],'as':_0x5e6360(0x1d0),'attributes':['id',_0x5e6360(0x1c8)]}],'attributes':['id','createdAt',_0x5e6360(0x1d6),_0x5e6360(0x1dc),_0x5e6360(0x1f6),_0x5e6360(0x1f7)],'order':[[_0x5e6360(0x1d8),_0x5e6360(0x1e8)]]}),_0x32b9f5=[];for(let _0x184c29 of _0x47b919){const _0x169af4=await TicketTag_1[_0x5e6360(0x1e9)]['findAll']({'attributes':[_0x5e6360(0x1ea)],'where':{'ticketId':_0x184c29['id']},'include':[{'model':Tag_1[_0x5e6360(0x1e9)],'as':_0x5e6360(0x1e0),'attributes':['id',_0x5e6360(0x1c8)]}]});var _0x33d346=await TicketTraking_1[_0x5e6360(0x1e9)][_0x5e6360(0x1df)]({'where':{'ticketId':_0x184c29['id']},'attributes':[_0x5e6360(0x1c7),_0x5e6360(0x1dd),_0x5e6360(0x1d3),_0x5e6360(0x1cd),_0x5e6360(0x1d8),_0x5e6360(0x1d7)]});let _0x5b26a5=await Contact_1[_0x5e6360(0x1e9)][_0x5e6360(0x1df)]({'attributes':['createdAt',_0x5e6360(0x1c8),_0x5e6360(0x1d1)],'where':{'id':_0x184c29[_0x5e6360(0x1f7)]}}),_0x10d6c2=![];_0x5b26a5&&(_0x10d6c2=(0x0,moment_1[_0x5e6360(0x1e9)])(_0x5b26a5[_0x5e6360(0x1d8)])['isBetween']((0x0,moment_1[_0x5e6360(0x1e9)])(_0x184c29[_0x5e6360(0x1d8)])['subtract'](0x1,_0x5e6360(0x1c9)),(0x0,moment_1[_0x5e6360(0x1e9)])(_0x184c29[_0x5e6360(0x1d8)])[_0x5e6360(0x1d4)](0x1,_0x5e6360(0x1c9)))),_0x32b9f5[_0x5e6360(0x1ed)]({'id':_0x184c29['id'],'contactName':_0x5b26a5?.['name']||_0x5e6360(0x1d2),'contactNumber':_0x5b26a5?.['number']||_0x5e6360(0x1d2),'createdAt':_0x184c29?.[_0x5e6360(0x1d8)],'startedAt':_0x33d346?.[_0x5e6360(0x1c7)],'queuedAt':_0x33d346?.[_0x5e6360(0x1dd)],'ratingAt':_0x33d346?.[_0x5e6360(0x1d3)],'rated':_0x33d346?.[_0x5e6360(0x1cd)],'status':_0x184c29['status'],'user':_0x184c29[_0x5e6360(0x1ca)]?.[_0x5e6360(0x1c8)]||_0x5e6360(0x1d2),'userId':_0x184c29[_0x5e6360(0x1f6)],'queue':_0x184c29[_0x5e6360(0x1de)]?.[_0x5e6360(0x1c8)]||_0x5e6360(0x1d2),'queueId':_0x184c29['queueId'],'connection':_0x184c29[_0x5e6360(0x1d0)][_0x5e6360(0x1c8)],'connectionId':_0x184c29[_0x5e6360(0x1d0)]['id'],'firstSentMessageAt':_0x33d346?.[_0x5e6360(0x1d8)],'resolvedAt':_0x33d346?.[_0x5e6360(0x1d7)],'isNewContact':_0x10d6c2,'tags':_0x169af4[_0x5e6360(0x1c6)](_0x43ad1=>_0x43ad1[_0x5e6360(0x1e0)][_0x5e6360(0x1c8)])['join'](',')});}return _0x17399b[_0x5e6360(0x1d9)](_0x32b9f5);}};exports[a33_0x3f5e6b(0x1e9)]=ReportController;