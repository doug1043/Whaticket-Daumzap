const a31_0xc27dd1=a31_0x4f33;(function(_0x204519,_0xc3d5ee){const _0x480438=a31_0x4f33,_0x488d62=_0x204519();while(!![]){try{const _0x1d5261=parseInt(_0x480438(0x1f6))/0x1*(-parseInt(_0x480438(0x202))/0x2)+parseInt(_0x480438(0x1f4))/0x3+parseInt(_0x480438(0x214))/0x4*(-parseInt(_0x480438(0x221))/0x5)+-parseInt(_0x480438(0x223))/0x6+-parseInt(_0x480438(0x20f))/0x7*(parseInt(_0x480438(0x1f1))/0x8)+-parseInt(_0x480438(0x219))/0x9*(-parseInt(_0x480438(0x20b))/0xa)+parseInt(_0x480438(0x21a))/0xb;if(_0x1d5261===_0xc3d5ee)break;else _0x488d62['push'](_0x488d62['shift']());}catch(_0x256760){_0x488d62['push'](_0x488d62['shift']());}}}(a31_0x2760,0x77eb8));const a31_0x14f3db=(function(){let _0x34cbec=!![];return function(_0x2b9d03,_0x12cbed){const _0x4f9666=_0x34cbec?function(){if(_0x12cbed){const _0x2e9d63=_0x12cbed['apply'](_0x2b9d03,arguments);return _0x12cbed=null,_0x2e9d63;}}:function(){};return _0x34cbec=![],_0x4f9666;};}()),a31_0x2b4a79=a31_0x14f3db(this,function(){const _0x10cfc5=a31_0x4f33;return a31_0x2b4a79[_0x10cfc5(0x1f7)]()['search'](_0x10cfc5(0x200))[_0x10cfc5(0x1f7)]()['constructor'](a31_0x2b4a79)[_0x10cfc5(0x205)]('(((.+)+)+)+$');});function a31_0x2760(){const _0x50a825=['tag','finishedAt','search','user','../models/Contact','../models/User','../models/Queue','json','10rEuNYP','between','../models/TicketTraking','day','344673FRfddX','findAll','isBetween','body','userId','83104GIOoVE','rated','N/A','profile','tagId','2857104lrBtRq','14851903RPPIlP','whatsapp','push','startOf','DESC','minute','__esModule','40QhxIcG','defineProperty','753132laELXq','startedAt','findOne','queuedAt','toDate','../models/Tag','name','number','88HcmktI','ratingAt','../models/Whatsapp','182049UfDJOu','sequelize','3YEMHNP','toString','contactId','map','status','../models/TicketTag','endOf','createdAt','queue','default','(((.+)+)+)+$','queueId','269174ZmmllS'];a31_0x2760=function(){return _0x50a825;};return a31_0x2760();}a31_0x2b4a79();'use strict';var __importDefault=this&&this['__importDefault']||function(_0x1ba0be){const _0x2cfff9=a31_0x4f33;return _0x1ba0be&&_0x1ba0be[_0x2cfff9(0x220)]?_0x1ba0be:{'default':_0x1ba0be};};Object[a31_0xc27dd1(0x222)](exports,a31_0xc27dd1(0x220),{'value':!![]});function a31_0x4f33(_0x1590f3,_0x227986){const _0x5a5b71=a31_0x2760();return a31_0x4f33=function(_0x2b4a79,_0x14f3db){_0x2b4a79=_0x2b4a79-0x1ec;let _0x2760d5=_0x5a5b71[_0x2b4a79];return _0x2760d5;},a31_0x4f33(_0x1590f3,_0x227986);}const Ticket_1=__importDefault(require('../models/Ticket')),sequelize_1=require(a31_0xc27dd1(0x1f5)),moment_1=__importDefault(require('moment/moment')),User_1=__importDefault(require(a31_0xc27dd1(0x208))),Queue_1=__importDefault(require(a31_0xc27dd1(0x209))),TicketTag_1=__importDefault(require(a31_0xc27dd1(0x1fb))),Tag_1=__importDefault(require(a31_0xc27dd1(0x1ee))),Whatsapp_1=__importDefault(require(a31_0xc27dd1(0x1f3))),TicketTraking_1=__importDefault(require(a31_0xc27dd1(0x20d))),Contact_1=__importDefault(require(a31_0xc27dd1(0x207))),ReportController={'tickets':async(_0x5912b6,_0x371e8b)=>{const _0x483e49=a31_0xc27dd1,{companyId:_0x5e16ed}=_0x5912b6[_0x483e49(0x206)];let {dateStart:_0x5f23b9,dateEnd:_0x251776,status:_0x10df6e,queueId:_0x539c56}=_0x5912b6[_0x483e49(0x212)],_0x29243c={'companyId':_0x5e16ed};_0x539c56&&(_0x29243c[_0x483e49(0x201)]=_0x539c56);_0x10df6e&&(_0x29243c[_0x483e49(0x1fa)]=_0x10df6e);let _0x19afa3=await Ticket_1[_0x483e49(0x1ff)][_0x483e49(0x210)]({'where':{..._0x29243c,'createdAt':{[sequelize_1['Op'][_0x483e49(0x20c)]]:[(0x0,moment_1[_0x483e49(0x1ff)])(_0x5f23b9)[_0x483e49(0x21d)](_0x483e49(0x20e))['toDate'](),(0x0,moment_1[_0x483e49(0x1ff)])(_0x251776)[_0x483e49(0x1fc)]('day')[_0x483e49(0x1ed)]()]}},'include':[{'model':User_1[_0x483e49(0x1ff)],'as':_0x483e49(0x206),'attributes':['id','name',_0x483e49(0x217)]},{'model':Queue_1[_0x483e49(0x1ff)],'as':_0x483e49(0x1fe),'attributes':['id',_0x483e49(0x1ef)]},{'model':Whatsapp_1['default'],'as':'whatsapp','attributes':['id',_0x483e49(0x1ef)]}],'attributes':['id',_0x483e49(0x1fd),_0x483e49(0x1fa),_0x483e49(0x201),_0x483e49(0x213),_0x483e49(0x1f8)],'order':[[_0x483e49(0x1fd),_0x483e49(0x21e)]]}),_0x234cdb=[];for(let _0x45ee08 of _0x19afa3){const _0x1ebdfe=await TicketTag_1['default'][_0x483e49(0x210)]({'attributes':[_0x483e49(0x218)],'where':{'ticketId':_0x45ee08['id']},'include':[{'model':Tag_1[_0x483e49(0x1ff)],'as':'tag','attributes':['id',_0x483e49(0x1ef)]}]});var _0x572e49=await TicketTraking_1[_0x483e49(0x1ff)]['findOne']({'where':{'ticketId':_0x45ee08['id']},'attributes':[_0x483e49(0x224),_0x483e49(0x1ec),_0x483e49(0x1f2),_0x483e49(0x215),'createdAt','finishedAt']});let _0x38f3f8=await Contact_1[_0x483e49(0x1ff)][_0x483e49(0x225)]({'attributes':[_0x483e49(0x1fd),'name',_0x483e49(0x1f0)],'where':{'id':_0x45ee08[_0x483e49(0x1f8)]}}),_0x3bdde5=![];_0x38f3f8&&(_0x3bdde5=(0x0,moment_1[_0x483e49(0x1ff)])(_0x38f3f8[_0x483e49(0x1fd)])[_0x483e49(0x211)]((0x0,moment_1[_0x483e49(0x1ff)])(_0x45ee08['createdAt'])['subtract'](0x1,_0x483e49(0x21f)),(0x0,moment_1['default'])(_0x45ee08[_0x483e49(0x1fd)])['add'](0x1,_0x483e49(0x21f)))),_0x234cdb[_0x483e49(0x21c)]({'id':_0x45ee08['id'],'contactName':_0x38f3f8?.[_0x483e49(0x1ef)]||_0x483e49(0x216),'contactNumber':_0x38f3f8?.[_0x483e49(0x1f0)]||_0x483e49(0x216),'createdAt':_0x45ee08?.['createdAt'],'startedAt':_0x572e49?.[_0x483e49(0x224)],'queuedAt':_0x572e49?.['queuedAt'],'ratingAt':_0x572e49?.[_0x483e49(0x1f2)],'rated':_0x572e49?.[_0x483e49(0x215)],'status':_0x45ee08['status'],'user':_0x45ee08[_0x483e49(0x206)]?.['name']||_0x483e49(0x216),'userId':_0x45ee08[_0x483e49(0x213)],'queue':_0x45ee08[_0x483e49(0x1fe)]?.['name']||_0x483e49(0x216),'queueId':_0x45ee08[_0x483e49(0x201)],'connection':_0x45ee08[_0x483e49(0x21b)]['name'],'connectionId':_0x45ee08[_0x483e49(0x21b)]['id'],'firstSentMessageAt':_0x572e49?.[_0x483e49(0x1fd)],'resolvedAt':_0x572e49?.[_0x483e49(0x204)],'isNewContact':_0x3bdde5,'tags':_0x1ebdfe[_0x483e49(0x1f9)](_0x1adf40=>_0x1adf40[_0x483e49(0x203)][_0x483e49(0x1ef)])['join'](',')});}return _0x371e8b[_0x483e49(0x20a)](_0x234cdb);}};exports['default']=ReportController;