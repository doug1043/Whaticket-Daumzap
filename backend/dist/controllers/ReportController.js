const a33_0x3cf343=a33_0x2793;(function(_0x25ef4a,_0x1a4b5c){const _0x3870b9=a33_0x2793,_0x4fd62c=_0x25ef4a();while(!![]){try{const _0x4ff510=-parseInt(_0x3870b9(0xb9))/0x1*(-parseInt(_0x3870b9(0x88))/0x2)+parseInt(_0x3870b9(0xab))/0x3*(parseInt(_0x3870b9(0xb0))/0x4)+parseInt(_0x3870b9(0x8f))/0x5*(-parseInt(_0x3870b9(0x9e))/0x6)+parseInt(_0x3870b9(0xb3))/0x7*(parseInt(_0x3870b9(0xbb))/0x8)+-parseInt(_0x3870b9(0xba))/0x9*(parseInt(_0x3870b9(0xa6))/0xa)+-parseInt(_0x3870b9(0x93))/0xb+parseInt(_0x3870b9(0xb5))/0xc;if(_0x4ff510===_0x1a4b5c)break;else _0x4fd62c['push'](_0x4fd62c['shift']());}catch(_0x1875a0){_0x4fd62c['push'](_0x4fd62c['shift']());}}}(a33_0x47d0,0xc4632));function a33_0x47d0(){const _0x100cbf=['finishedAt','10wZhjjW','ratingAt','queueId','minute','6051243bJvbQc','profile','../models/Ticket','createdAt','../models/TicketTag','join','apply','findOne','contactId','add','default','4031634vTgpUb','rated','between','isBetween','startedAt','day','status','search','970nBGTWm','json','whatsapp','toDate','number','110652NgXwjg','body','startOf','name','(((.+)+)+)+$','4lVIIem','__esModule','user','2416421CAMJXx','DESC','8296176jBLYHe','../models/User','N/A','queuedAt','14006OWASkP','15111KaXmFN','16kkERdj','endOf','toString','findAll','__importDefault','userId','206lzLBSW','push','../models/Contact','subtract','../models/Queue','queue'];a33_0x47d0=function(){return _0x100cbf;};return a33_0x47d0();}const a33_0x4bf780=(function(){let _0x39e496=!![];return function(_0x38f4cb,_0x52f3d1){const _0x24cafa=_0x39e496?function(){const _0x37709b=a33_0x2793;if(_0x52f3d1){const _0x229950=_0x52f3d1[_0x37709b(0x99)](_0x38f4cb,arguments);return _0x52f3d1=null,_0x229950;}}:function(){};return _0x39e496=![],_0x24cafa;};}()),a33_0x10ee1e=a33_0x4bf780(this,function(){const _0x4a9bdd=a33_0x2793;return a33_0x10ee1e[_0x4a9bdd(0xbd)]()[_0x4a9bdd(0xa5)](_0x4a9bdd(0xaf))['toString']()['constructor'](a33_0x10ee1e)[_0x4a9bdd(0xa5)](_0x4a9bdd(0xaf));});function a33_0x2793(_0x113d07,_0x2cea79){const _0x45242c=a33_0x47d0();return a33_0x2793=function(_0x10ee1e,_0x4bf780){_0x10ee1e=_0x10ee1e-0x88;let _0x47d057=_0x45242c[_0x10ee1e];return _0x47d057;},a33_0x2793(_0x113d07,_0x2cea79);}a33_0x10ee1e();'use strict';var __importDefault=this&&this[a33_0x3cf343(0xbf)]||function(_0x3e42a8){const _0x40d99e=a33_0x3cf343;return _0x3e42a8&&_0x3e42a8[_0x40d99e(0xb1)]?_0x3e42a8:{'default':_0x3e42a8};};Object['defineProperty'](exports,a33_0x3cf343(0xb1),{'value':!![]});const Ticket_1=__importDefault(require(a33_0x3cf343(0x95))),sequelize_1=require('sequelize'),moment_1=__importDefault(require('moment/moment')),User_1=__importDefault(require(a33_0x3cf343(0xb6))),Queue_1=__importDefault(require(a33_0x3cf343(0x8c))),TicketTag_1=__importDefault(require(a33_0x3cf343(0x97))),Tag_1=__importDefault(require('../models/Tag')),Whatsapp_1=__importDefault(require('../models/Whatsapp')),TicketTraking_1=__importDefault(require('../models/TicketTraking')),Contact_1=__importDefault(require(a33_0x3cf343(0x8a))),ReportController={'tickets':async(_0x3e4a85,_0x16e444)=>{const _0x172f5f=a33_0x3cf343,{companyId:_0x53782d}=_0x3e4a85['user'];let {dateStart:_0xee0f24,dateEnd:_0x520a83,status:_0x5bdc3a,queueId:_0x4be8b5}=_0x3e4a85[_0x172f5f(0xac)],_0x599ae5={'companyId':_0x53782d};_0x4be8b5&&(_0x599ae5[_0x172f5f(0x91)]=_0x4be8b5);_0x5bdc3a&&(_0x599ae5['status']=_0x5bdc3a);let _0x28abf0=await Ticket_1[_0x172f5f(0x9d)]['findAll']({'where':{..._0x599ae5,'createdAt':{[sequelize_1['Op'][_0x172f5f(0xa0)]]:[(0x0,moment_1[_0x172f5f(0x9d)])(_0xee0f24)[_0x172f5f(0xad)]('day')[_0x172f5f(0xa9)](),(0x0,moment_1[_0x172f5f(0x9d)])(_0x520a83)[_0x172f5f(0xbc)](_0x172f5f(0xa3))['toDate']()]}},'include':[{'model':User_1[_0x172f5f(0x9d)],'as':_0x172f5f(0xb2),'attributes':['id',_0x172f5f(0xae),_0x172f5f(0x94)]},{'model':Queue_1[_0x172f5f(0x9d)],'as':'queue','attributes':['id',_0x172f5f(0xae)]},{'model':Whatsapp_1['default'],'as':_0x172f5f(0xa8),'attributes':['id',_0x172f5f(0xae)]}],'attributes':['id',_0x172f5f(0x96),_0x172f5f(0xa4),_0x172f5f(0x91),_0x172f5f(0xc0),_0x172f5f(0x9b)],'order':[[_0x172f5f(0x96),_0x172f5f(0xb4)]]}),_0x2226fa=[];for(let _0xf21620 of _0x28abf0){const _0x4f741f=await TicketTag_1[_0x172f5f(0x9d)][_0x172f5f(0xbe)]({'attributes':['tagId'],'where':{'ticketId':_0xf21620['id']},'include':[{'model':Tag_1[_0x172f5f(0x9d)],'as':'tag','attributes':['id',_0x172f5f(0xae)]}]});var _0x2cf6c9=await TicketTraking_1[_0x172f5f(0x9d)][_0x172f5f(0x9a)]({'where':{'ticketId':_0xf21620['id']},'attributes':['startedAt',_0x172f5f(0xb8),_0x172f5f(0x90),_0x172f5f(0x9f),'createdAt',_0x172f5f(0x8e)]});let _0x3b6b09=await Contact_1[_0x172f5f(0x9d)][_0x172f5f(0x9a)]({'attributes':['createdAt','name','number'],'where':{'id':_0xf21620[_0x172f5f(0x9b)]}}),_0x188ee9=![];_0x3b6b09&&(_0x188ee9=(0x0,moment_1[_0x172f5f(0x9d)])(_0x3b6b09[_0x172f5f(0x96)])[_0x172f5f(0xa1)]((0x0,moment_1[_0x172f5f(0x9d)])(_0xf21620['createdAt'])[_0x172f5f(0x8b)](0x1,_0x172f5f(0x92)),(0x0,moment_1[_0x172f5f(0x9d)])(_0xf21620[_0x172f5f(0x96)])[_0x172f5f(0x9c)](0x1,'minute'))),_0x2226fa[_0x172f5f(0x89)]({'id':_0xf21620['id'],'contactName':_0x3b6b09?.[_0x172f5f(0xae)]||_0x172f5f(0xb7),'contactNumber':_0x3b6b09?.[_0x172f5f(0xaa)]||_0x172f5f(0xb7),'createdAt':_0xf21620?.[_0x172f5f(0x96)],'startedAt':_0x2cf6c9?.[_0x172f5f(0xa2)],'queuedAt':_0x2cf6c9?.[_0x172f5f(0xb8)],'ratingAt':_0x2cf6c9?.[_0x172f5f(0x90)],'rated':_0x2cf6c9?.[_0x172f5f(0x9f)],'status':_0xf21620[_0x172f5f(0xa4)],'user':_0xf21620[_0x172f5f(0xb2)]?.['name']||_0x172f5f(0xb7),'userId':_0xf21620[_0x172f5f(0xc0)],'queue':_0xf21620[_0x172f5f(0x8d)]?.[_0x172f5f(0xae)]||_0x172f5f(0xb7),'queueId':_0xf21620[_0x172f5f(0x91)],'connection':_0xf21620['whatsapp'][_0x172f5f(0xae)],'connectionId':_0xf21620[_0x172f5f(0xa8)]['id'],'firstSentMessageAt':_0x2cf6c9?.['createdAt'],'resolvedAt':_0x2cf6c9?.[_0x172f5f(0x8e)],'isNewContact':_0x188ee9,'tags':_0x4f741f['map'](_0x523928=>_0x523928['tag'][_0x172f5f(0xae)])[_0x172f5f(0x98)](',')});}return _0x16e444[_0x172f5f(0xa7)](_0x2226fa);}};exports[a33_0x3cf343(0x9d)]=ReportController;