const a21_0x161c77=a21_0x2f01;(function(_0x1a317e,_0x2fbe5c){const _0x424698=a21_0x2f01,_0x45db5e=_0x1a317e();while(!![]){try{const _0x21c931=-parseInt(_0x424698(0x1d4))/0x1+parseInt(_0x424698(0x1df))/0x2+parseInt(_0x424698(0x1e0))/0x3*(parseInt(_0x424698(0x1e2))/0x4)+-parseInt(_0x424698(0x1d6))/0x5*(parseInt(_0x424698(0x1f9))/0x6)+parseInt(_0x424698(0x1c2))/0x7+parseInt(_0x424698(0x1e7))/0x8*(-parseInt(_0x424698(0x1db))/0x9)+parseInt(_0x424698(0x1be))/0xa*(-parseInt(_0x424698(0x1c6))/0xb);if(_0x21c931===_0x2fbe5c)break;else _0x45db5e['push'](_0x45db5e['shift']());}catch(_0x1a9c52){_0x45db5e['push'](_0x45db5e['shift']());}}}(a21_0xc0cf,0xd9809));function a21_0x2f01(_0x13afaf,_0x3bc9a3){const _0x2a7472=a21_0xc0cf();return a21_0x2f01=function(_0x20182d,_0x2ee6c0){_0x20182d=_0x20182d-0x1bb;let _0xc0cf0=_0x2a7472[_0x20182d];return _0xc0cf0;},a21_0x2f01(_0x13afaf,_0x3bc9a3);}const a21_0x2ee6c0=(function(){let _0x1cb06a=!![];return function(_0x51958b,_0x18ccc1){const _0x58881a=_0x1cb06a?function(){const _0x2b3d78=a21_0x2f01;if(_0x18ccc1){const _0x5de85a=_0x18ccc1[_0x2b3d78(0x1ed)](_0x51958b,arguments);return _0x18ccc1=null,_0x5de85a;}}:function(){};return _0x1cb06a=![],_0x58881a;};}()),a21_0x20182d=a21_0x2ee6c0(this,function(){const _0xfd14b9=a21_0x2f01;return a21_0x20182d[_0xfd14b9(0x1cd)]()[_0xfd14b9(0x1c5)]('(((.+)+)+)+$')['toString']()['constructor'](a21_0x20182d)[_0xfd14b9(0x1c5)](_0xfd14b9(0x1bb));});a21_0x20182d();'use strict';var __importDefault=this&&this[a21_0x161c77(0x1ee)]||function(_0x1bcaf0){const _0x1c7286=a21_0x161c77;return _0x1bcaf0&&_0x1bcaf0[_0x1c7286(0x1d2)]?_0x1bcaf0:{'default':_0x1bcaf0};};Object[a21_0x161c77(0x1e8)](exports,a21_0x161c77(0x1d2),{'value':!![]}),exports[a21_0x161c77(0x1e1)]=exports[a21_0x161c77(0x1eb)]=exports[a21_0x161c77(0x1c4)]=exports[a21_0x161c77(0x1e9)]=exports[a21_0x161c77(0x1de)]=exports['show']=exports[a21_0x161c77(0x1f3)]=exports[a21_0x161c77(0x1d1)]=void 0x0;const socket_1=require(a21_0x161c77(0x1f5)),AppError_1=__importDefault(require(a21_0x161c77(0x1d9))),lodash_1=require('lodash'),CreateService_1=__importDefault(require(a21_0x161c77(0x1bd))),ListService_1=__importDefault(require('../services/FileServices/ListService')),UpdateService_1=__importDefault(require(a21_0x161c77(0x1c9))),ShowService_1=__importDefault(require(a21_0x161c77(0x1dc))),DeleteService_1=__importDefault(require(a21_0x161c77(0x1ce))),SimpleListService_1=__importDefault(require('../services/FileServices/SimpleListService')),DeleteAllService_1=__importDefault(require(a21_0x161c77(0x1f8))),FilesOptions_1=__importDefault(require('../models/FilesOptions')),StorageService_1=__importDefault(require(a21_0x161c77(0x1e5))),index=async(_0x2ec6ff,_0x732a61)=>{const _0x4e70eb=a21_0x161c77,{pageNumber:_0x5f543d,searchParam:_0x47f379}=_0x2ec6ff['query'],{companyId:_0x345b82}=_0x2ec6ff[_0x4e70eb(0x1c1)],{files:_0x5eda0f,count:_0x4588f9,hasMore:_0x416230}=await(0x0,ListService_1['default'])({'searchParam':_0x47f379,'pageNumber':_0x5f543d,'companyId':_0x345b82});return _0x732a61[_0x4e70eb(0x1f6)]({'files':_0x5eda0f,'count':_0x4588f9,'hasMore':_0x416230});};exports[a21_0x161c77(0x1d1)]=index;const store=async(_0x5d8846,_0x46234b)=>{const _0x30194e=a21_0x161c77,{name:_0x3bea6a,message:_0x5f5701,options:_0x22138e}=_0x5d8846[_0x30194e(0x1d8)],{companyId:_0x4ff9c5}=_0x5d8846[_0x30194e(0x1c1)],_0x4cb3ec=await(0x0,CreateService_1[_0x30194e(0x1c0)])({'name':_0x3bea6a,'message':_0x5f5701,'options':_0x22138e,'companyId':_0x4ff9c5}),_0x5250f0=(0x0,socket_1[_0x30194e(0x1f1)])();return _0x5250f0['to'](_0x30194e(0x1dd)+_0x4ff9c5+_0x30194e(0x1d3))['emit'](_0x30194e(0x1d0)+_0x4ff9c5+'-file',{'action':_0x30194e(0x1da),'fileList':_0x4cb3ec}),_0x46234b[_0x30194e(0x1d7)](0xc8)['json'](_0x4cb3ec);};exports[a21_0x161c77(0x1f3)]=store;const show=async(_0xb678b2,_0x140948)=>{const _0x134e8d=a21_0x161c77,{fileId:_0x4c498d}=_0xb678b2[_0x134e8d(0x1f4)],{companyId:_0x2ee84d}=_0xb678b2[_0x134e8d(0x1c1)],_0x4f9630=await(0x0,ShowService_1[_0x134e8d(0x1c0)])(_0x4c498d,_0x2ee84d);return _0x140948[_0x134e8d(0x1d7)](0xc8)['json'](_0x4f9630);};exports[a21_0x161c77(0x1cc)]=show;const uploadMedias=async(_0x581477,_0x2a1f7c)=>{const _0x175f60=a21_0x161c77,{fileId:_0x1eb0ea,id:_0x1f0cb2,mediaType:_0x188e1b}=_0x581477['body'],{companyId:_0x2aa661}=_0x581477[_0x175f60(0x1c1)],_0x20247b=_0x581477['files'],_0xe31356=(0x0,lodash_1['head'])(_0x20247b);try{let _0x18d79a;if(_0x20247b[_0x175f60(0x1c8)]>0x0)for(const [_0x38af1f,_0x5d253c]of _0x20247b[_0x175f60(0x1c3)]()){const {url:_0x27f2bb}=await StorageService_1[_0x175f60(0x1c0)][_0x175f60(0x1f0)](_0x2aa661,_0x175f60(0x1ec),_0x5d253c[_0x175f60(0x1d5)][_0x175f60(0x1f2)]('/','-'),_0x5d253c[_0x175f60(0x1cb)],_0x5d253c['mimetype']);_0x18d79a=await FilesOptions_1[_0x175f60(0x1c0)][_0x175f60(0x1e3)]({'where':{'fileId':_0x1eb0ea,'id':Array['isArray'](_0x1f0cb2)?_0x1f0cb2[_0x38af1f]:_0x1f0cb2}}),_0x18d79a[_0x175f60(0x1e9)]({'path':_0x27f2bb,'mediaType':Array[_0x175f60(0x1c7)](_0x188e1b)?_0x188e1b[_0x38af1f]:_0x188e1b});}return _0x2a1f7c['send']({'mensagem':_0x175f60(0x1ca)});}catch(_0x4907f3){throw new AppError_1[(_0x175f60(0x1c0))](_0x4907f3[_0x175f60(0x1e6)]);}};exports[a21_0x161c77(0x1de)]=uploadMedias;const update=async(_0x40f566,_0x3e71a4)=>{const _0x4bc777=a21_0x161c77;if(_0x40f566['user']['profile']!=='admin')throw new AppError_1['default'](_0x4bc777(0x1bc),0x193);const {fileId:_0x11c748}=_0x40f566[_0x4bc777(0x1f4)],_0xd97dae=_0x40f566[_0x4bc777(0x1d8)],{companyId:_0x11aba6}=_0x40f566[_0x4bc777(0x1c1)],_0x47d1e2=await(0x0,UpdateService_1[_0x4bc777(0x1c0)])({'fileData':_0xd97dae,'id':_0x11c748,'companyId':_0x11aba6}),_0x21d830=(0x0,socket_1[_0x4bc777(0x1f1)])();return _0x21d830['to'](_0x4bc777(0x1dd)+_0x11aba6+_0x4bc777(0x1d3))[_0x4bc777(0x1ea)](_0x4bc777(0x1d0)+_0x11aba6+_0x4bc777(0x1bf),{'action':'update','fileList':_0x47d1e2}),_0x3e71a4[_0x4bc777(0x1d7)](0xc8)[_0x4bc777(0x1f6)](_0x47d1e2);};exports[a21_0x161c77(0x1e9)]=update;function a21_0xc0cf(){const _0x277ea7=['127664gNDVHW','defineProperty','update','emit','removeAll','uploads','apply','__importDefault','delete','uploadFile','getIO','replace','store','params','../libs/socket','json','File\x20List\x20deleted','../services/FileServices/DeleteAllService','10338byIirw','(((.+)+)+)+$','ERR_NO_PERMISSION','../services/FileServices/CreateService','572440dPdOWr','-file','default','user','8496271tnKPgo','entries','remove','search','77KBBGrJ','isArray','length','../services/FileServices/UpdateService','Arquivos\x20atualizados','path','show','toString','../services/FileServices/DeleteService','query','company','index','__esModule','-mainchannel','534621LPTzmC','filename','2375DFADcw','status','body','../errors/AppError','create','144licmcS','../services/FileServices/ShowService','company-','uploadMedias','1269964cuATeq','18ERkxWJ','list','700824hZcjJV','findOne','send','../services/StorageService/StorageService','message'];a21_0xc0cf=function(){return _0x277ea7;};return a21_0xc0cf();}const remove=async(_0x138d17,_0x261d0f)=>{const _0xca2ad8=a21_0x161c77,{fileId:_0x2a2d62}=_0x138d17[_0xca2ad8(0x1f4)],{companyId:_0x38afb2}=_0x138d17['user'];await(0x0,DeleteService_1[_0xca2ad8(0x1c0)])(_0x2a2d62,_0x38afb2);const _0x4df6d5=(0x0,socket_1[_0xca2ad8(0x1f1)])();return _0x4df6d5['to']('company-'+_0x38afb2+_0xca2ad8(0x1d3))[_0xca2ad8(0x1ea)](_0xca2ad8(0x1d0)+_0x38afb2+'-file',{'action':_0xca2ad8(0x1ef),'fileId':_0x2a2d62}),_0x261d0f[_0xca2ad8(0x1d7)](0xc8)[_0xca2ad8(0x1f6)]({'message':_0xca2ad8(0x1f7)});};exports[a21_0x161c77(0x1c4)]=remove;const removeAll=async(_0x5e5a28,_0x3fbd0f)=>{const _0x5e6589=a21_0x161c77,{companyId:_0x4284ec}=_0x5e5a28['user'];return await(0x0,DeleteAllService_1[_0x5e6589(0x1c0)])(_0x4284ec),_0x3fbd0f[_0x5e6589(0x1e4)]();};exports[a21_0x161c77(0x1eb)]=removeAll;const list=async(_0x3e18ad,_0xf465d2)=>{const _0x397d0f=a21_0x161c77,{searchParam:_0x42196c}=_0x3e18ad[_0x397d0f(0x1cf)],{companyId:_0x58eece}=_0x3e18ad[_0x397d0f(0x1c1)],_0x246a37=await(0x0,SimpleListService_1[_0x397d0f(0x1c0)])({'searchParam':_0x42196c,'companyId':_0x58eece});return _0xf465d2['json'](_0x246a37);};exports['list']=list;