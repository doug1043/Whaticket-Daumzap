const a28_0x2a66b8=a28_0x267f;(function(_0x4c0a44,_0x1cddcd){const _0x24498c=a28_0x267f,_0x1c08cc=_0x4c0a44();while(!![]){try{const _0x24c254=parseInt(_0x24498c(0x74))/0x1+-parseInt(_0x24498c(0x88))/0x2+-parseInt(_0x24498c(0x6c))/0x3+-parseInt(_0x24498c(0x84))/0x4+parseInt(_0x24498c(0x81))/0x5+-parseInt(_0x24498c(0x8c))/0x6+parseInt(_0x24498c(0x6f))/0x7;if(_0x24c254===_0x1cddcd)break;else _0x1c08cc['push'](_0x1c08cc['shift']());}catch(_0x115084){_0x1c08cc['push'](_0x1c08cc['shift']());}}}(a28_0x221f,0x81f8a));const a28_0x16e1cc=(function(){let _0x524777=!![];return function(_0x23bd14,_0x36817c){const _0x35ad01=_0x524777?function(){const _0x307dff=a28_0x267f;if(_0x36817c){const _0x30f5a0=_0x36817c[_0x307dff(0x6b)](_0x23bd14,arguments);return _0x36817c=null,_0x30f5a0;}}:function(){};return _0x524777=![],_0x35ad01;};}()),a28_0x156d6e=a28_0x16e1cc(this,function(){const _0x162757=a28_0x267f;return a28_0x156d6e[_0x162757(0x76)]()[_0x162757(0x89)](_0x162757(0x83))['toString']()[_0x162757(0x86)](a28_0x156d6e)[_0x162757(0x89)](_0x162757(0x83));});a28_0x156d6e();'use strict';function a28_0x221f(){const _0x4fde7f=['prompt','(((.+)+)+)+$','824636ybRIxF','index','constructor','findAndCountAll','2123600fqmzcB','search','jsonwebtoken','emit','2267610sUtXYE','body','delete','../services/PromptServices/UpdatePromptService','Prompt\x20deleted','store','secret','query','authorization','apply','1623972iGpkYK','json','__esModule','8247169ZIznIs','status','remove','update','split','527452qJvArf','../services/PromptServices/ListPromptsService','toString','default','defineProperty','../libs/socket','headers','../services/PromptServices/ShowPromptService','params','getIO','verify','company-','show','5069805NuHVht'];a28_0x221f=function(){return _0x4fde7f;};return a28_0x221f();}var __importDefault=this&&this['__importDefault']||function(_0x380ef6){const _0x259cbf=a28_0x267f;return _0x380ef6&&_0x380ef6[_0x259cbf(0x6e)]?_0x380ef6:{'default':_0x380ef6};};Object[a28_0x2a66b8(0x78)](exports,'__esModule',{'value':!![]}),exports[a28_0x2a66b8(0x71)]=exports[a28_0x2a66b8(0x72)]=exports['show']=exports['store']=exports[a28_0x2a66b8(0x85)]=void 0x0;const socket_1=require(a28_0x2a66b8(0x79)),CreatePromptService_1=__importDefault(require('../services/PromptServices/CreatePromptService')),DeletePromptService_1=__importDefault(require('../services/PromptServices/DeletePromptService')),ListPromptsService_1=__importDefault(require(a28_0x2a66b8(0x75))),ShowPromptService_1=__importDefault(require(a28_0x2a66b8(0x7b))),UpdatePromptService_1=__importDefault(require(a28_0x2a66b8(0x65))),Whatsapp_1=__importDefault(require('../models/Whatsapp')),jsonwebtoken_1=require(a28_0x2a66b8(0x8a)),auth_1=__importDefault(require('../config/auth')),index=async(_0x85c07c,_0x4fe4e1)=>{const _0x59219d=a28_0x2a66b8,{pageNumber:_0x26481d,searchParam:_0x225eaf}=_0x85c07c[_0x59219d(0x69)],_0x106330=_0x85c07c['headers']['authorization'],[,_0x3683b8]=_0x106330[_0x59219d(0x73)]('\x20'),_0x5213cb=(0x0,jsonwebtoken_1[_0x59219d(0x7e)])(_0x3683b8,auth_1[_0x59219d(0x77)][_0x59219d(0x68)]),{companyId:_0x559e38}=_0x5213cb,{prompts:_0x1929f1,count:_0x5b5ba4,hasMore:_0x5850ad}=await(0x0,ListPromptsService_1[_0x59219d(0x77)])({'searchParam':_0x225eaf,'pageNumber':_0x26481d,'companyId':_0x559e38});return _0x4fe4e1[_0x59219d(0x70)](0xc8)[_0x59219d(0x6d)]({'prompts':_0x1929f1,'count':_0x5b5ba4,'hasMore':_0x5850ad});};exports[a28_0x2a66b8(0x85)]=index;const store=async(_0x34261b,_0x288503)=>{const _0x1a7c8b=a28_0x2a66b8,_0x54a79b=_0x34261b['headers']['authorization'],[,_0x563916]=_0x54a79b[_0x1a7c8b(0x73)]('\x20'),_0x59b029=(0x0,jsonwebtoken_1[_0x1a7c8b(0x7e)])(_0x563916,auth_1[_0x1a7c8b(0x77)][_0x1a7c8b(0x68)]),{companyId:_0x4fffd6}=_0x59b029,{name:_0x269ed7,apiKey:_0x283e65,prompt:_0x418a11,maxTokens:_0x12ff07,temperature:_0x14a77f,promptTokens:_0x291233,completionTokens:_0x365a9c,totalTokens:_0xf64a37,queueId:_0x22d058,maxMessages:_0x2c88fc,voice:_0x5efca5,voiceKey:_0x3ba7ce,voiceRegion:_0x2f3f17}=_0x34261b['body'],_0x25f3ac=await(0x0,CreatePromptService_1['default'])({'name':_0x269ed7,'apiKey':_0x283e65,'prompt':_0x418a11,'maxTokens':_0x12ff07,'temperature':_0x14a77f,'promptTokens':_0x291233,'completionTokens':_0x365a9c,'totalTokens':_0xf64a37,'queueId':_0x22d058,'maxMessages':_0x2c88fc,'companyId':_0x4fffd6,'voice':_0x5efca5,'voiceKey':_0x3ba7ce,'voiceRegion':_0x2f3f17}),_0x309c5b=(0x0,socket_1[_0x1a7c8b(0x7d)])();return _0x309c5b['to'](_0x1a7c8b(0x7f)+_0x4fffd6+'-mainchannel')[_0x1a7c8b(0x8b)]('prompt',{'action':_0x1a7c8b(0x72),'prompt':_0x25f3ac}),_0x288503[_0x1a7c8b(0x70)](0xc8)[_0x1a7c8b(0x6d)](_0x25f3ac);};exports[a28_0x2a66b8(0x67)]=store;const show=async(_0x4ed53f,_0xc44caf)=>{const _0x5335ad=a28_0x2a66b8,{promptId:_0x116b97}=_0x4ed53f[_0x5335ad(0x7c)],_0x572227=_0x4ed53f['headers']['authorization'],[,_0x47e38a]=_0x572227[_0x5335ad(0x73)]('\x20'),_0x55ed49=(0x0,jsonwebtoken_1[_0x5335ad(0x7e)])(_0x47e38a,auth_1[_0x5335ad(0x77)][_0x5335ad(0x68)]),{companyId:_0x207061}=_0x55ed49,_0x4e8600=await(0x0,ShowPromptService_1[_0x5335ad(0x77)])({'promptId':_0x116b97,'companyId':_0x207061});return _0xc44caf[_0x5335ad(0x70)](0xc8)[_0x5335ad(0x6d)](_0x4e8600);};function a28_0x267f(_0xf25ddd,_0x458fa3){const _0x5770be=a28_0x221f();return a28_0x267f=function(_0x156d6e,_0x16e1cc){_0x156d6e=_0x156d6e-0x65;let _0x221f6f=_0x5770be[_0x156d6e];return _0x221f6f;},a28_0x267f(_0xf25ddd,_0x458fa3);}exports[a28_0x2a66b8(0x80)]=show;const update=async(_0x9fd767,_0x386d43)=>{const _0x31a988=a28_0x2a66b8,{promptId:_0x3cd17b}=_0x9fd767[_0x31a988(0x7c)],_0x4b946f=_0x9fd767[_0x31a988(0x8d)],_0x4bc3cd=_0x9fd767[_0x31a988(0x7a)][_0x31a988(0x6a)],[,_0x5efa72]=_0x4bc3cd['split']('\x20'),_0x3d7c41=(0x0,jsonwebtoken_1[_0x31a988(0x7e)])(_0x5efa72,auth_1[_0x31a988(0x77)][_0x31a988(0x68)]),{companyId:_0x192647}=_0x3d7c41,_0x419df5=await(0x0,UpdatePromptService_1[_0x31a988(0x77)])({'promptData':_0x4b946f,'promptId':_0x3cd17b,'companyId':_0x192647}),_0xf0d8e=(0x0,socket_1[_0x31a988(0x7d)])();return _0xf0d8e[_0x31a988(0x8b)](_0x31a988(0x82),{'action':'update','prompt':_0x419df5}),_0x386d43[_0x31a988(0x70)](0xc8)[_0x31a988(0x6d)](_0x419df5);};exports[a28_0x2a66b8(0x72)]=update;const remove=async(_0x379db1,_0x23d4d1)=>{const _0x140151=a28_0x2a66b8,{promptId:_0x18cd66}=_0x379db1[_0x140151(0x7c)],_0x5b8255=_0x379db1[_0x140151(0x7a)]['authorization'],[,_0x22baed]=_0x5b8255[_0x140151(0x73)]('\x20'),_0x58bed6=(0x0,jsonwebtoken_1[_0x140151(0x7e)])(_0x22baed,auth_1[_0x140151(0x77)][_0x140151(0x68)]),{companyId:_0x21c55e}=_0x58bed6;try{const {count:_0x10e4f3}=await Whatsapp_1[_0x140151(0x77)][_0x140151(0x87)]({'where':{'promptId':+_0x18cd66,'companyId':_0x21c55e}});if(_0x10e4f3>0x0)return _0x23d4d1[_0x140151(0x70)](0xc8)[_0x140151(0x6d)]({'message':'Não\x20foi\x20possível\x20excluir!\x20Verifique\x20se\x20este\x20prompt\x20está\x20sendo\x20usado\x20nas\x20conexões\x20Whatsapp!'});await(0x0,DeletePromptService_1[_0x140151(0x77)])(_0x18cd66,_0x21c55e);const _0x185868=(0x0,socket_1[_0x140151(0x7d)])();return _0x185868[_0x140151(0x8b)](_0x140151(0x82),{'action':_0x140151(0x8e),'intelligenceId':+_0x18cd66}),_0x23d4d1[_0x140151(0x70)](0xc8)['json']({'message':_0x140151(0x66)});}catch(_0x1976f0){return _0x23d4d1['status'](0x1f4)['json']({'message':'Não\x20foi\x20possível\x20excluir!\x20Verifique\x20se\x20este\x20prompt\x20está\x20sendo\x20usado!'});}};exports['remove']=remove;