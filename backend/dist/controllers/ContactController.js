'use strict';const a16_0x65d6c2=a16_0x5c1e;(function(_0xf04237,_0x2ba2a0){const _0x388f8f=a16_0x5c1e,_0x40f2d5=_0xf04237();while(!![]){try{const _0x320060=-parseInt(_0x388f8f(0x1a2))/0x1+-parseInt(_0x388f8f(0x1b8))/0x2*(parseInt(_0x388f8f(0x19b))/0x3)+parseInt(_0x388f8f(0x1ec))/0x4*(parseInt(_0x388f8f(0x1f4))/0x5)+parseInt(_0x388f8f(0x1fd))/0x6*(-parseInt(_0x388f8f(0x1f8))/0x7)+parseInt(_0x388f8f(0x1b7))/0x8+-parseInt(_0x388f8f(0x1ef))/0x9+parseInt(_0x388f8f(0x1e5))/0xa;if(_0x320060===_0x2ba2a0)break;else _0x40f2d5['push'](_0x40f2d5['shift']());}catch(_0x433338){_0x40f2d5['push'](_0x40f2d5['shift']());}}}(a16_0x30b0,0xc6597));var __createBinding=this&&this[a16_0x65d6c2(0x1f1)]||(Object['create']?function(_0x4d829f,_0x58b6f3,_0x2dd5b5,_0x47df21){const _0x407b69=a16_0x65d6c2;if(_0x47df21===undefined)_0x47df21=_0x2dd5b5;var _0x439885=Object[_0x407b69(0x1a5)](_0x58b6f3,_0x2dd5b5);(!_0x439885||(_0x407b69(0x201)in _0x439885?!_0x58b6f3['__esModule']:_0x439885[_0x407b69(0x1df)]||_0x439885['configurable']))&&(_0x439885={'enumerable':!![],'get':function(){return _0x58b6f3[_0x2dd5b5];}}),Object[_0x407b69(0x208)](_0x4d829f,_0x47df21,_0x439885);}:function(_0x60eb12,_0x424d5d,_0x1effde,_0xc06f0e){if(_0xc06f0e===undefined)_0xc06f0e=_0x1effde;_0x60eb12[_0xc06f0e]=_0x424d5d[_0x1effde];}),__setModuleDefault=this&&this[a16_0x65d6c2(0x1bc)]||(Object[a16_0x65d6c2(0x1f9)]?function(_0x3a8e8a,_0x4d3a13){const _0x458bc3=a16_0x65d6c2;Object[_0x458bc3(0x208)](_0x3a8e8a,_0x458bc3(0x1a0),{'enumerable':!![],'value':_0x4d3a13});}:function(_0x7abceb,_0x7bdd4c){const _0x4d3150=a16_0x65d6c2;_0x7abceb[_0x4d3150(0x1a0)]=_0x7bdd4c;}),__importStar=this&&this[a16_0x65d6c2(0x1b4)]||(function(){const _0x451caf=(function(){let _0x5d9fca=!![];return function(_0x599950,_0x2f4864){const _0x326bb5=_0x5d9fca?function(){const _0x336be0=a16_0x5c1e;if(_0x2f4864){const _0x1788a1=_0x2f4864[_0x336be0(0x20f)](_0x599950,arguments);return _0x2f4864=null,_0x1788a1;}}:function(){};return _0x5d9fca=![],_0x326bb5;};}()),_0x58a536=_0x451caf(this,function(){const _0x52ef0f=a16_0x5c1e;return _0x58a536[_0x52ef0f(0x1ad)]()[_0x52ef0f(0x1db)](_0x52ef0f(0x1d1))['toString']()[_0x52ef0f(0x1c9)](_0x58a536)[_0x52ef0f(0x1db)](_0x52ef0f(0x1d1));});_0x58a536();var _0x14608b=function(_0x44c189){const _0x15c4f7=a16_0x5c1e;return _0x14608b=Object[_0x15c4f7(0x1bb)]||function(_0x5ad5bb){const _0x2cb075=_0x15c4f7;var _0x538a2a=[];for(var _0x32bc5e in _0x5ad5bb)if(Object['prototype'][_0x2cb075(0x1ab)]['call'](_0x5ad5bb,_0x32bc5e))_0x538a2a[_0x538a2a[_0x2cb075(0x1bf)]]=_0x32bc5e;return _0x538a2a;},_0x14608b(_0x44c189);};return function(_0x427dca){if(_0x427dca&&_0x427dca['__esModule'])return _0x427dca;var _0x440fd7={};if(_0x427dca!=null){for(var _0x5bd057=_0x14608b(_0x427dca),_0x532e36=0x0;_0x532e36<_0x5bd057['length'];_0x532e36++)if(_0x5bd057[_0x532e36]!=='default')__createBinding(_0x440fd7,_0x427dca,_0x5bd057[_0x532e36]);}return __setModuleDefault(_0x440fd7,_0x427dca),_0x440fd7;};}()),__importDefault=this&&this[a16_0x65d6c2(0x210)]||function(_0x2eb981){const _0x20491a=a16_0x65d6c2;return _0x2eb981&&_0x2eb981[_0x20491a(0x1b3)]?_0x2eb981:{'default':_0x2eb981};};Object[a16_0x65d6c2(0x208)](exports,'__esModule',{'value':!![]}),exports[a16_0x65d6c2(0x20c)]=exports[a16_0x65d6c2(0x197)]=exports[a16_0x65d6c2(0x1bd)]=exports[a16_0x65d6c2(0x1aa)]=exports[a16_0x65d6c2(0x1b6)]=exports[a16_0x65d6c2(0x204)]=exports[a16_0x65d6c2(0x1c5)]=exports[a16_0x65d6c2(0x1fe)]=exports[a16_0x65d6c2(0x206)]=exports[a16_0x65d6c2(0x19a)]=void 0x0;const Yup=__importStar(require(a16_0x65d6c2(0x1a3))),csv_1=require(a16_0x65d6c2(0x1b2)),fs_1=__importDefault(require('fs')),path_1=require(a16_0x65d6c2(0x1a9)),socket_1=require(a16_0x65d6c2(0x20b)),GetPublicPath_1=require(a16_0x65d6c2(0x1f7)),ListContactsService_1=__importDefault(require(a16_0x65d6c2(0x196))),CreateContactService_1=__importDefault(require('../services/ContactServices/CreateContactService')),ShowContactService_1=__importDefault(require('../services/ContactServices/ShowContactService')),UpdateContactService_1=__importDefault(require(a16_0x65d6c2(0x1ba))),DeleteContactService_1=__importDefault(require(a16_0x65d6c2(0x1dc))),GetContactService_1=__importDefault(require(a16_0x65d6c2(0x211))),CheckNumber_1=__importDefault(require(a16_0x65d6c2(0x200))),AppError_1=__importDefault(require(a16_0x65d6c2(0x1e7))),SimpleListService_1=__importDefault(require(a16_0x65d6c2(0x20d))),ContactCustomField_1=__importDefault(require(a16_0x65d6c2(0x20e))),logger_1=require(a16_0x65d6c2(0x1cf)),Contact_1=__importDefault(require('../models/Contact')),index=async(_0x2ae728,_0x2c8e97)=>{const _0x50914e=a16_0x65d6c2,{searchParam:_0x4a366f,pageNumber:_0x895ef5}=_0x2ae728[_0x50914e(0x1c4)],{companyId:_0x5c25e0}=_0x2ae728[_0x50914e(0x216)],{contacts:_0x347791,count:_0xc9d4dc,hasMore:_0x297f94}=await(0x0,ListContactsService_1[_0x50914e(0x1a0)])({'searchParam':_0x4a366f,'pageNumber':_0x895ef5,'companyId':_0x5c25e0});return _0x2c8e97['json']({'contacts':_0x347791,'count':_0xc9d4dc,'hasMore':_0x297f94});};exports['index']=index;function a16_0x30b0(){const _0x47f4b1=['object','index','12DZMjJU','set','toUpperCase','info','isGroup','default','ExtraInfo','170471ijBjGw','yup','emit','getOwnPropertyDescriptor','Error\x20processing\x20CSV\x20file:\x20','end','Invalid\x20number\x20format.\x20Only\x20numbers\x20is\x20allowed.','path','list','hasOwnProperty','Invalid\x20phone\x20number\x20after\x20cleaning:\x20','toString','createReadStream',',\x20Errors:\x20','rmSync','push','csv','__esModule','__importStar','validate','remove','7408920eiZXui','305842vUwQEK','Error\x20deleting\x20all\x20contacts:\x20','../services/ContactServices/UpdateContactService','getOwnPropertyNames','__setModuleDefault','importCsv','number','length','-mainchannel','Detected\x20CSV\x20delimiter:\x20','Content-disposition','unlinkSync','query','show','getIO','media','UTF-8\x20BOM\x20detected,\x20removing\x20it','constructor','readFileSync','string','name','attachment;\x20filename=contacts.csv','forEach','../utils/logger','status','(((.+)+)+)+$','company-','ERR_GENERATING_CSV','shape','findAll','charCodeAt','\x20-\x20','message','matches','required','search','../services/ContactServices/DeleteContactService','keys','destroy','writable','-contact','All\x20contacts\x20have\x20been\x20deleted','error','email','debug','17708490LHiOrH','replace','../errors/AppError','join','logger','json','substring','609724epKSWK','extraInfo','utf8','13440591HfDAjO','delete-all','__createBinding','Content-Type','Number','35xqgwWA','Missing\x20phone\x20number\x20in\x20record:\x20','body','../helpers/GetPublicPath','2365958gNBpJr','create','trim','text/csv','Email','12wSVpYD','store','CSV\x20import\x20finished.\x20Processed:\x20','../services/WbotServices/CheckNumber','get','includes','whatsapp','update','delete','getContact','split','defineProperty','stringify','map','../libs/socket','exportCsv','../services/ContactServices/SimpleListService','../models/ContactCustomField','apply','__importDefault','../services/ContactServices/GetContactService','Error\x20converting\x20scientific\x20notation:\x20','Contacts\x20being\x20imported','ERR_EMPTY_CSV','Contact\x20created\x20successfully:\x20','user','send','test','Error\x20creating\x20contact:\x20','getPublicPath','Contact\x20deleted','ERR_INVALID_CSV','writeFileSync','jid','../services/ContactServices/ListContactsService','removeAll','value'];a16_0x30b0=function(){return _0x47f4b1;};return a16_0x30b0();}const getContact=async(_0x5f3e4e,_0x41b15d)=>{const _0x14d420=a16_0x65d6c2,{name:_0x34df62,number:_0x3cac9a}=_0x5f3e4e[_0x14d420(0x1f6)],{companyId:_0x373273}=_0x5f3e4e[_0x14d420(0x216)],_0x2b420c=await(0x0,GetContactService_1[_0x14d420(0x1a0)])({'name':_0x34df62,'number':_0x3cac9a,'companyId':_0x373273});return _0x41b15d['status'](0xc8)[_0x14d420(0x1ea)](_0x2b420c);};exports['getContact']=getContact;const store=async(_0x34ed7c,_0x5ce2f1)=>{const _0x47cc52=a16_0x65d6c2,{companyId:_0x498394}=_0x34ed7c[_0x47cc52(0x216)],_0x3bd3d8=_0x34ed7c[_0x47cc52(0x1f6)];_0x3bd3d8[_0x47cc52(0x1be)]=_0x3bd3d8[_0x47cc52(0x1be)][_0x47cc52(0x1e6)]('-','')[_0x47cc52(0x1e6)]('\x20','');const _0x422bd7=Yup['object']()[_0x47cc52(0x1d4)]({'name':Yup[_0x47cc52(0x1cb)]()[_0x47cc52(0x1da)](),'number':Yup[_0x47cc52(0x1cb)]()[_0x47cc52(0x1da)]()[_0x47cc52(0x1d9)](/^\d+$/,_0x47cc52(0x1a8))});try{await _0x422bd7[_0x47cc52(0x1b5)](_0x3bd3d8);}catch(_0x472c58){throw new AppError_1[(_0x47cc52(0x1a0))](_0x472c58[_0x47cc52(0x1d8)]);}if(!_0x3bd3d8[_0x47cc52(0x19f)]){const _0x191f0b=await(0x0,CheckNumber_1[_0x47cc52(0x1a0)])(_0x3bd3d8['number'],_0x498394),_0x109a4c=_0x191f0b['jid'][_0x47cc52(0x1e6)](/\D/g,'');_0x3bd3d8['number']=_0x109a4c;}const _0x417d1e=await(0x0,CreateContactService_1[_0x47cc52(0x1a0)])({..._0x3bd3d8,'companyId':_0x498394}),_0xe1a1a1=(0x0,socket_1[_0x47cc52(0x1c6)])();return _0xe1a1a1['to']('company-'+_0x498394+_0x47cc52(0x1c0))['emit'](_0x47cc52(0x1d2)+_0x498394+'-contact',{'action':_0x47cc52(0x1f9),'contact':_0x417d1e}),_0x5ce2f1[_0x47cc52(0x1d0)](0xc8)[_0x47cc52(0x1ea)](_0x417d1e);};exports['store']=store;const show=async(_0x4622cc,_0x53454e)=>{const _0x228b04=a16_0x65d6c2,{contactId:_0x265d7d}=_0x4622cc['params'],{companyId:_0x3e479c}=_0x4622cc[_0x228b04(0x216)],_0x158d9d=await(0x0,ShowContactService_1['default'])(_0x265d7d,_0x3e479c);return _0x53454e[_0x228b04(0x1d0)](0xc8)['json'](_0x158d9d);};exports[a16_0x65d6c2(0x1c5)]=show;const update=async(_0xd829a0,_0x3c0adb)=>{const _0x2cbbf4=a16_0x65d6c2,_0x2f8557=_0xd829a0['body'],{companyId:_0x363f1c}=_0xd829a0[_0x2cbbf4(0x216)],_0x38db76=Yup[_0x2cbbf4(0x199)]()['shape']({'name':Yup[_0x2cbbf4(0x1cb)](),'number':Yup['string']()[_0x2cbbf4(0x1d9)](/^\d+$/,_0x2cbbf4(0x1a8))});try{await _0x38db76[_0x2cbbf4(0x1b5)](_0x2f8557);}catch(_0x23efde){throw new AppError_1[(_0x2cbbf4(0x1a0))](_0x23efde[_0x2cbbf4(0x1d8)]);}if(!_0x2f8557[_0x2cbbf4(0x19f)]){const _0x543af6=await(0x0,CheckNumber_1[_0x2cbbf4(0x1a0)])(_0x2f8557[_0x2cbbf4(0x1be)],_0x363f1c),_0x44ae7b=_0x543af6[_0x2cbbf4(0x195)][_0x2cbbf4(0x1e6)](/\D/g,'');_0x2f8557[_0x2cbbf4(0x1be)]=_0x44ae7b;}const {contactId:_0x3fe212}=_0xd829a0['params'],_0x236461=await(0x0,UpdateContactService_1['default'])({'contactData':_0x2f8557,'contactId':_0x3fe212,'companyId':_0x363f1c}),_0x1e55a4=(0x0,socket_1['getIO'])();return _0x1e55a4['to'](_0x2cbbf4(0x1d2)+_0x363f1c+_0x2cbbf4(0x1c0))['emit']('company-'+_0x363f1c+_0x2cbbf4(0x1e0),{'action':'update','contact':_0x236461}),_0x3c0adb[_0x2cbbf4(0x1d0)](0xc8)[_0x2cbbf4(0x1ea)](_0x236461);};function a16_0x5c1e(_0xa6851e,_0x161613){const _0x77cde4=a16_0x30b0();return a16_0x5c1e=function(_0x42d6f2,_0x2101a1){_0x42d6f2=_0x42d6f2-0x193;let _0x30b07b=_0x77cde4[_0x42d6f2];return _0x30b07b;},a16_0x5c1e(_0xa6851e,_0x161613);}exports[a16_0x65d6c2(0x204)]=update;const remove=async(_0x52c193,_0x5f6f0a)=>{const _0x29294f=a16_0x65d6c2,{contactId:_0x105ac0}=_0x52c193['params'],{companyId:_0x241175}=_0x52c193['user'];await(0x0,ShowContactService_1[_0x29294f(0x1a0)])(_0x105ac0,_0x241175),await(0x0,DeleteContactService_1['default'])(_0x105ac0);const _0x324dc5=(0x0,socket_1[_0x29294f(0x1c6)])();return _0x324dc5['to']('company-'+_0x241175+_0x29294f(0x1c0))[_0x29294f(0x1a4)](_0x29294f(0x1d2)+_0x241175+_0x29294f(0x1e0),{'action':_0x29294f(0x205),'contactId':_0x105ac0}),_0x5f6f0a[_0x29294f(0x1d0)](0xc8)[_0x29294f(0x1ea)]({'message':_0x29294f(0x21b)});};exports[a16_0x65d6c2(0x1b6)]=remove;const list=async(_0x1e444c,_0xf99fce)=>{const _0x416893=a16_0x65d6c2,{name:_0x336af1}=_0x1e444c[_0x416893(0x1c4)],{companyId:_0x2a3520}=_0x1e444c[_0x416893(0x216)],_0x25c893=await(0x0,SimpleListService_1[_0x416893(0x1a0)])({'name':_0x336af1,'companyId':_0x2a3520});return _0xf99fce[_0x416893(0x1ea)](_0x25c893);};exports[a16_0x65d6c2(0x1aa)]=list;const importCsv=async(_0x2b647e,_0x142cfc)=>{const _0x3fce84=a16_0x65d6c2,{companyId:_0x4580c7}=_0x2b647e['user'],{file:_0x4198ed}=_0x2b647e;if(!_0x4198ed)throw new AppError_1[(_0x3fce84(0x1a0))]('ERR_NO_FILE',0x190);let _0x1dd2eb=',';try{let _0x3eef7c=fs_1[_0x3fce84(0x1a0)][_0x3fce84(0x1ca)](_0x4198ed['path'],{'encoding':_0x3fce84(0x1ee)});_0x3eef7c[_0x3fce84(0x1d6)](0x0)===0xfeff&&(logger_1[_0x3fce84(0x1e9)]['info'](_0x3fce84(0x1c8)),_0x3eef7c=_0x3eef7c[_0x3fce84(0x1eb)](0x1),fs_1['default'][_0x3fce84(0x194)](_0x4198ed[_0x3fce84(0x1a9)],_0x3eef7c,{'encoding':_0x3fce84(0x1ee)}));const _0x1c859c=_0x3eef7c[_0x3fce84(0x207)]('\x0a')[0x0];if(_0x1c859c[_0x3fce84(0x202)](';'))_0x1dd2eb=';';else _0x1c859c[_0x3fce84(0x202)]('\x09')&&(_0x1dd2eb='\x09');logger_1['logger'][_0x3fce84(0x19e)](_0x3fce84(0x1c1)+_0x1dd2eb);}catch(_0x597459){logger_1[_0x3fce84(0x1e9)][_0x3fce84(0x1e2)](_0x3fce84(0x1a6)+_0x597459['message']);}const _0xb7a482=(0x0,csv_1['parse'])({'delimiter':_0x1dd2eb,'columns':!![],'trim':!![],'relaxColumnCount':!![]},async(_0x4eeb05,_0x2bb4d6)=>{const _0x13979f=_0x3fce84;if(_0x4eeb05){logger_1[_0x13979f(0x1e9)]['error']('CSV\x20parsing\x20error:\x20'+_0x4eeb05[_0x13979f(0x1d8)]);throw new AppError_1['default'](_0x13979f(0x193),0x190);}if(!_0x2bb4d6||_0x2bb4d6['length']===0x0){logger_1['logger']['error']('CSV\x20file\x20is\x20empty\x20or\x20invalid');throw new AppError_1['default'](_0x13979f(0x214),0x190);}_0x2bb4d6[_0x13979f(0x1ce)](async _0x251f5f=>{const _0x524dde=_0x13979f;_0x5ec058++;let _0x5eae6b;try{_0x5eae6b=JSON['parse'](_0x251f5f[_0x524dde(0x1a1)]);}catch(_0xc526b9){_0x5eae6b=[];}let _0x24e426=_0x251f5f[_0x524dde(0x1be)]||_0x251f5f[_0x524dde(0x1f3)];if(!_0x24e426){logger_1[_0x524dde(0x1e9)][_0x524dde(0x1e2)](_0x524dde(0x1f5)+JSON[_0x524dde(0x209)](_0x251f5f));return;}_0x24e426=String(_0x24e426)[_0x524dde(0x1fa)]();if(_0x24e426[_0x524dde(0x19d)]()[_0x524dde(0x202)]('E+')||/^\d+([.,]\d+)?[eE][+-]?\d+$/[_0x524dde(0x218)](_0x24e426))try{const _0x111365=_0x24e426[_0x524dde(0x1e6)](',','.');_0x24e426=parseFloat(_0x111365)['toString']();}catch(_0x205e2e){logger_1[_0x524dde(0x1e9)][_0x524dde(0x1e2)](_0x524dde(0x212)+_0x24e426);}_0x24e426=_0x24e426['replace'](/\D/g,'');if(!_0x24e426||_0x24e426['length']<0x8){logger_1[_0x524dde(0x1e9)]['error'](_0x524dde(0x1ac)+_0x24e426);return;}const _0x4b70fa={'companyId':_0x4580c7,'name':_0x251f5f['name']||_0x251f5f['Name'],'number':_0x24e426,'email':_0x251f5f['email']||_0x251f5f[_0x524dde(0x1fc)],'extraInfo':_0x5eae6b};Object[_0x524dde(0x1dd)](_0x251f5f)[_0x524dde(0x1ce)](_0x536c41=>{const _0x30ae3d=_0x524dde;_0x536c41!==_0x30ae3d(0x1cc)&&_0x536c41!==_0x30ae3d(0x1be)&&_0x536c41!==_0x30ae3d(0x1e3)&&_0x536c41!=='Name'&&_0x536c41!==_0x30ae3d(0x1f3)&&_0x536c41!==_0x30ae3d(0x1fc)&&_0x536c41!==_0x30ae3d(0x1a1)&&_0x251f5f[_0x536c41]&&_0x4b70fa[_0x30ae3d(0x1ed)][_0x30ae3d(0x1b1)]({'name':_0x536c41,'value':_0x251f5f[_0x536c41]});});try{const _0x288145=await(0x0,CreateContactService_1['default'])(_0x4b70fa);_0x57e874++,logger_1[_0x524dde(0x1e9)][_0x524dde(0x1e4)](_0x524dde(0x215)+_0x4b70fa[_0x524dde(0x1cc)]+_0x524dde(0x1d7)+_0x4b70fa[_0x524dde(0x1be)]);const _0x28b8fd=(0x0,socket_1[_0x524dde(0x1c6)])();_0x28b8fd['to']('company-'+_0x4580c7+_0x524dde(0x1c0))[_0x524dde(0x1a4)](_0x524dde(0x1d2)+_0x4580c7+_0x524dde(0x1e0),{'action':_0x524dde(0x204),'contact':_0x288145});}catch(_0x756176){_0x942054++,logger_1[_0x524dde(0x1e9)][_0x524dde(0x1e2)]({'contact':_0x4b70fa},_0x524dde(0x219)+_0x756176[_0x524dde(0x1d8)]);}});}),_0x2de17a=fs_1['default'][_0x3fce84(0x1ae)](_0x4198ed[_0x3fce84(0x1a9)]);let _0x5ec058=0x0,_0x57e874=0x0,_0x942054=0x0;return _0xb7a482['on'](_0x3fce84(0x1a7),()=>{const _0x3f3c23=_0x3fce84;_0x2de17a['destroy'](),fs_1[_0x3f3c23(0x1a0)][_0x3f3c23(0x1c3)](_0x4198ed[_0x3f3c23(0x1a9)]),logger_1[_0x3f3c23(0x1e9)][_0x3f3c23(0x19e)](_0x3f3c23(0x1ff)+_0x5ec058+',\x20Success:\x20'+_0x57e874+_0x3f3c23(0x1af)+_0x942054);}),_0x2de17a['pipe'](_0xb7a482),_0x142cfc[_0x3fce84(0x1d0)](0xc8)[_0x3fce84(0x1ea)]({'message':_0x3fce84(0x213)});};exports['importCsv']=importCsv;const removeAll=async(_0x182fca,_0x373116)=>{const _0x479b15=a16_0x65d6c2,{companyId:_0x26a2d5}=_0x182fca['user'];try{const _0x136861=await Contact_1[_0x479b15(0x1a0)][_0x479b15(0x1d5)]({'where':{'companyId':_0x26a2d5}});for(const _0x58ef0e of _0x136861){const _0x21bfa6=(0x0,path_1[_0x479b15(0x1e8)])((0x0,GetPublicPath_1[_0x479b15(0x21a)])(),_0x479b15(0x1c7),_0x58ef0e['companyId']+'/'+_0x58ef0e['id']);fs_1[_0x479b15(0x1a0)][_0x479b15(0x1b0)](_0x21bfa6,{'recursive':!![],'force':!![]});}await Contact_1[_0x479b15(0x1a0)][_0x479b15(0x1de)]({'where':{'companyId':_0x26a2d5}});const _0x51ecf9=(0x0,socket_1[_0x479b15(0x1c6)])();return _0x51ecf9['to'](_0x479b15(0x1d2)+_0x26a2d5+_0x479b15(0x1c0))[_0x479b15(0x1a4)](_0x479b15(0x1d2)+_0x26a2d5+_0x479b15(0x1e0),{'action':_0x479b15(0x1f0)}),_0x373116[_0x479b15(0x1d0)](0xc8)[_0x479b15(0x1ea)]({'message':_0x479b15(0x1e1)});}catch(_0x8e9c1d){logger_1[_0x479b15(0x1e9)][_0x479b15(0x1e2)]({'companyId':_0x26a2d5},_0x479b15(0x1b9)+_0x8e9c1d[_0x479b15(0x1d8)]);throw new AppError_1['default']('ERR_DELETING_CONTACTS',0x1f4);}};exports[a16_0x65d6c2(0x197)]=removeAll;const exportCsv=async(_0x5306d1,_0x555df8)=>{const _0x147fe3=a16_0x65d6c2,{companyId:_0x1e2025}=_0x5306d1[_0x147fe3(0x216)],_0x414110=await Contact_1[_0x147fe3(0x1a0)]['findAll']({'where':{'companyId':_0x1e2025,'channel':_0x147fe3(0x203),'isGroup':![]},'include':[{'model':ContactCustomField_1[_0x147fe3(0x1a0)],'as':_0x147fe3(0x1ed)}]}),_0x405ccd=_0x414110[_0x147fe3(0x20a)](_0x547566=>{const _0x48646c=_0x147fe3,_0x5c62b7=_0x547566[_0x48646c(0x1ed)][_0x48646c(0x20a)](_0x315184=>({'name':_0x315184[_0x48646c(0x1cc)],'value':_0x315184[_0x48646c(0x198)]}));return{'Name':_0x547566[_0x48646c(0x1cc)],'Number':_0x547566['number'],'Email':_0x547566[_0x48646c(0x1e3)]||'','ExtraInfo':JSON[_0x48646c(0x209)](_0x5c62b7)};});return(0x0,csv_1[_0x147fe3(0x209)])(_0x405ccd,{'header':!![]},(_0x2a8b05,_0x424d06)=>{const _0x3ebeae=_0x147fe3;if(_0x2a8b05)throw new AppError_1[(_0x3ebeae(0x1a0))](_0x3ebeae(0x1d3),0x1f4);_0x555df8['setHeader'](_0x3ebeae(0x1c2),_0x3ebeae(0x1cd)),_0x555df8[_0x3ebeae(0x19c)](_0x3ebeae(0x1f2),_0x3ebeae(0x1fb)),_0x555df8[_0x3ebeae(0x1d0)](0xc8)[_0x3ebeae(0x217)](_0x424d06);}),_0x555df8;};exports[a16_0x65d6c2(0x20c)]=exportCsv;