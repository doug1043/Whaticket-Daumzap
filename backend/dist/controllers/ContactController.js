'use strict';const a13_0x3fc779=a13_0x469c;(function(_0x35b0df,_0x127f19){const _0x4aecb8=a13_0x469c,_0x430a1a=_0x35b0df();while(!![]){try{const _0x2f6a9f=parseInt(_0x4aecb8(0x1d9))/0x1*(parseInt(_0x4aecb8(0x1d4))/0x2)+parseInt(_0x4aecb8(0x18d))/0x3+-parseInt(_0x4aecb8(0x1b9))/0x4+-parseInt(_0x4aecb8(0x1fe))/0x5*(parseInt(_0x4aecb8(0x1f0))/0x6)+parseInt(_0x4aecb8(0x1e7))/0x7*(-parseInt(_0x4aecb8(0x209))/0x8)+parseInt(_0x4aecb8(0x1c3))/0x9*(-parseInt(_0x4aecb8(0x1bc))/0xa)+-parseInt(_0x4aecb8(0x1ca))/0xb*(-parseInt(_0x4aecb8(0x1af))/0xc);if(_0x2f6a9f===_0x127f19)break;else _0x430a1a['push'](_0x430a1a['shift']());}catch(_0x4b801){_0x430a1a['push'](_0x430a1a['shift']());}}}(a13_0x433a,0xd56a8));function a13_0x469c(_0x9a1101,_0x505be9){const _0xe5bfda=a13_0x433a();return a13_0x469c=function(_0x913c71,_0x403475){_0x913c71=_0x913c71-0x18c;let _0x433a25=_0xe5bfda[_0x913c71];return _0x433a25;},a13_0x469c(_0x9a1101,_0x505be9);}function a13_0x433a(){const _0x3f8802=['removeAll','findAll','../libs/socket','Detected\x20CSV\x20delimiter:\x20','error','remove','yup','../services/WbotServices/CheckNumber','All\x20contacts\x20have\x20been\x20deleted','pipe','string','destroy','number','email','7980636HenVZW','required','../services/ContactServices/GetContactService','importCsv','apply','CSV\x20parsing\x20error:\x20','call','jid','-contact','path','6220492rsZXrR','trim','name','70cWKbNy','split','join','create','status','prototype','list','1063818HgaPDN','length','-mainchannel','delete-all','../services/ContactServices/DeleteContactService','UTF-8\x20BOM\x20detected,\x20removing\x20it','ExtraInfo','77PWMPOP','ERR_INVALID_CSV','Invalid\x20number\x20format.\x20Only\x20numbers\x20is\x20allowed.','keys','parse','params','substring','logger','../models/Contact','toString','106174ZBgcmL','../services/ContactServices/ListContactsService','forEach','query','CSV\x20file\x20is\x20empty\x20or\x20invalid','4HVdPfa','configurable','extraInfo','matches','(((.+)+)+)+$','Contact\x20created\x20successfully:\x20','index','getContact','getOwnPropertyNames','ERR_DELETING_CONTACTS','map','rmSync','constructor','body','14ukqMHi','company-','csv','includes','ERR_NO_FILE',',\x20Errors:\x20','../errors/AppError','end','__esModule','33618uEhLRh','writable','../utils/logger','json','Content-Type','default','replace','exportCsv','get','text/csv','Number','../services/ContactServices/ShowContactService','ERR_EMPTY_CSV','companyId','995TrxMcI','readFileSync','../models/ContactCustomField','__createBinding','Name','../services/ContactServices/SimpleListService','getPublicPath','shape','media','Email','whatsapp','4731784AXqfjL','__importDefault','info','store','user','utf8','2060739IvEJXN','message','writeFileSync','../services/ContactServices/CreateContactService','getIO','stringify','setHeader','unlinkSync','attachment;\x20filename=contacts.csv','object','Missing\x20phone\x20number\x20in\x20record:\x20','update','emit','Error\x20deleting\x20all\x20contacts:\x20','createReadStream','validate','isGroup','defineProperty','Contact\x20deleted','hasOwnProperty'];a13_0x433a=function(){return _0x3f8802;};return a13_0x433a();}var __createBinding=this&&this[a13_0x3fc779(0x201)]||(Object[a13_0x3fc779(0x1bf)]?function(_0xc464e1,_0xa9d99e,_0x539799,_0x326312){const _0x5a32ff=a13_0x3fc779;if(_0x326312===undefined)_0x326312=_0x539799;var _0x161228=Object['getOwnPropertyDescriptor'](_0xa9d99e,_0x539799);(!_0x161228||(_0x5a32ff(0x1f8)in _0x161228?!_0xa9d99e[_0x5a32ff(0x1ef)]:_0x161228[_0x5a32ff(0x1f1)]||_0x161228[_0x5a32ff(0x1da)]))&&(_0x161228={'enumerable':!![],'get':function(){return _0xa9d99e[_0x539799];}}),Object['defineProperty'](_0xc464e1,_0x326312,_0x161228);}:function(_0x507f9f,_0x36e191,_0x4cc4fa,_0xbaf450){if(_0xbaf450===undefined)_0xbaf450=_0x4cc4fa;_0x507f9f[_0xbaf450]=_0x36e191[_0x4cc4fa];}),__setModuleDefault=this&&this['__setModuleDefault']||(Object[a13_0x3fc779(0x1bf)]?function(_0x5df3a7,_0x23782b){const _0x3fc6cf=a13_0x3fc779;Object['defineProperty'](_0x5df3a7,_0x3fc6cf(0x1f5),{'enumerable':!![],'value':_0x23782b});}:function(_0x1f0576,_0x1d377e){const _0x59ed0b=a13_0x3fc779;_0x1f0576[_0x59ed0b(0x1f5)]=_0x1d377e;}),__importStar=this&&this['__importStar']||(function(){const _0x447a4d=(function(){let _0x175cdd=!![];return function(_0x1529f5,_0x5365e7){const _0x47c31e=_0x175cdd?function(){const _0x293b44=a13_0x469c;if(_0x5365e7){const _0x4bc47a=_0x5365e7[_0x293b44(0x1b3)](_0x1529f5,arguments);return _0x5365e7=null,_0x4bc47a;}}:function(){};return _0x175cdd=![],_0x47c31e;};}()),_0x43b83f=_0x447a4d(this,function(){const _0xea21aa=a13_0x469c;return _0x43b83f[_0xea21aa(0x1d3)]()['search'](_0xea21aa(0x1dd))[_0xea21aa(0x1d3)]()[_0xea21aa(0x1e5)](_0x43b83f)['search'](_0xea21aa(0x1dd));});_0x43b83f();var _0x3dd902=function(_0x1b6855){const _0x519300=a13_0x469c;return _0x3dd902=Object[_0x519300(0x1e1)]||function(_0x27cfd1){const _0x57024b=_0x519300;var _0x216045=[];for(var _0x338747 in _0x27cfd1)if(Object[_0x57024b(0x1c1)][_0x57024b(0x1a0)][_0x57024b(0x1b5)](_0x27cfd1,_0x338747))_0x216045[_0x216045[_0x57024b(0x1c4)]]=_0x338747;return _0x216045;},_0x3dd902(_0x1b6855);};return function(_0x3de33e){const _0x5dd702=a13_0x469c;if(_0x3de33e&&_0x3de33e[_0x5dd702(0x1ef)])return _0x3de33e;var _0x59434c={};if(_0x3de33e!=null){for(var _0xb2c30f=_0x3dd902(_0x3de33e),_0x57f49f=0x0;_0x57f49f<_0xb2c30f[_0x5dd702(0x1c4)];_0x57f49f++)if(_0xb2c30f[_0x57f49f]!=='default')__createBinding(_0x59434c,_0x3de33e,_0xb2c30f[_0x57f49f]);}return __setModuleDefault(_0x59434c,_0x3de33e),_0x59434c;};}()),__importDefault=this&&this[a13_0x3fc779(0x20a)]||function(_0x22cb25){const _0x4e3947=a13_0x3fc779;return _0x22cb25&&_0x22cb25[_0x4e3947(0x1ef)]?_0x22cb25:{'default':_0x22cb25};};Object[a13_0x3fc779(0x19e)](exports,a13_0x3fc779(0x1ef),{'value':!![]}),exports[a13_0x3fc779(0x1f7)]=exports[a13_0x3fc779(0x1a1)]=exports[a13_0x3fc779(0x1b2)]=exports[a13_0x3fc779(0x1c2)]=exports[a13_0x3fc779(0x1a6)]=exports['update']=exports['show']=exports[a13_0x3fc779(0x20c)]=exports[a13_0x3fc779(0x1e0)]=exports[a13_0x3fc779(0x1df)]=void 0x0;const Yup=__importStar(require(a13_0x3fc779(0x1a7))),csv_1=require(a13_0x3fc779(0x1e9)),fs_1=__importDefault(require('fs')),path_1=require(a13_0x3fc779(0x1b8)),socket_1=require(a13_0x3fc779(0x1a3)),GetPublicPath_1=require('../helpers/GetPublicPath'),ListContactsService_1=__importDefault(require(a13_0x3fc779(0x1d5))),CreateContactService_1=__importDefault(require(a13_0x3fc779(0x190))),ShowContactService_1=__importDefault(require(a13_0x3fc779(0x1fb))),UpdateContactService_1=__importDefault(require('../services/ContactServices/UpdateContactService')),DeleteContactService_1=__importDefault(require(a13_0x3fc779(0x1c7))),GetContactService_1=__importDefault(require(a13_0x3fc779(0x1b1))),CheckNumber_1=__importDefault(require(a13_0x3fc779(0x1a8))),AppError_1=__importDefault(require(a13_0x3fc779(0x1ed))),SimpleListService_1=__importDefault(require(a13_0x3fc779(0x203))),ContactCustomField_1=__importDefault(require(a13_0x3fc779(0x200))),logger_1=require(a13_0x3fc779(0x1f2)),Contact_1=__importDefault(require(a13_0x3fc779(0x1d2))),index=async(_0x13eeff,_0x3dad0d)=>{const _0x293f5c=a13_0x3fc779,{searchParam:_0x4d9126,pageNumber:_0x15ab6f}=_0x13eeff[_0x293f5c(0x1d7)],{companyId:_0x1201d6}=_0x13eeff[_0x293f5c(0x20d)],{contacts:_0x3a8015,count:_0x4bc25b,hasMore:_0xa1d37d}=await(0x0,ListContactsService_1[_0x293f5c(0x1f5)])({'searchParam':_0x4d9126,'pageNumber':_0x15ab6f,'companyId':_0x1201d6});return _0x3dad0d[_0x293f5c(0x1f3)]({'contacts':_0x3a8015,'count':_0x4bc25b,'hasMore':_0xa1d37d});};exports['index']=index;const getContact=async(_0x2092d4,_0x496899)=>{const _0x1b586f=a13_0x3fc779,{name:_0x3d536f,number:_0x49ef56}=_0x2092d4[_0x1b586f(0x1e6)],{companyId:_0x35664d}=_0x2092d4[_0x1b586f(0x20d)],_0x1d0074=await(0x0,GetContactService_1[_0x1b586f(0x1f5)])({'name':_0x3d536f,'number':_0x49ef56,'companyId':_0x35664d});return _0x496899['status'](0xc8)[_0x1b586f(0x1f3)](_0x1d0074);};exports[a13_0x3fc779(0x1e0)]=getContact;const store=async(_0x813a2b,_0x4bcc4e)=>{const _0x4cd3b9=a13_0x3fc779,{companyId:_0x2f90b2}=_0x813a2b[_0x4cd3b9(0x20d)],_0x11027f=_0x813a2b[_0x4cd3b9(0x1e6)];_0x11027f[_0x4cd3b9(0x1ad)]=_0x11027f[_0x4cd3b9(0x1ad)]['replace']('-','')[_0x4cd3b9(0x1f6)]('\x20','');const _0x54b2d8=Yup['object']()[_0x4cd3b9(0x205)]({'name':Yup[_0x4cd3b9(0x1ab)]()['required'](),'number':Yup[_0x4cd3b9(0x1ab)]()[_0x4cd3b9(0x1b0)]()[_0x4cd3b9(0x1dc)](/^\d+$/,_0x4cd3b9(0x1cc))});try{await _0x54b2d8[_0x4cd3b9(0x19c)](_0x11027f);}catch(_0x101868){throw new AppError_1[(_0x4cd3b9(0x1f5))](_0x101868[_0x4cd3b9(0x18e)]);}if(!_0x11027f[_0x4cd3b9(0x19d)]){const _0x5bb7b0=await(0x0,CheckNumber_1[_0x4cd3b9(0x1f5)])(_0x11027f['number'],_0x2f90b2),_0x470394=_0x5bb7b0[_0x4cd3b9(0x1b6)][_0x4cd3b9(0x1f6)](/\D/g,'');_0x11027f[_0x4cd3b9(0x1ad)]=_0x470394;}const _0x4c722a=await(0x0,CreateContactService_1['default'])({..._0x11027f,'companyId':_0x2f90b2}),_0x2807b6=(0x0,socket_1[_0x4cd3b9(0x191)])();return _0x2807b6['to'](_0x4cd3b9(0x1e8)+_0x2f90b2+_0x4cd3b9(0x1c5))[_0x4cd3b9(0x199)](_0x4cd3b9(0x1e8)+_0x2f90b2+_0x4cd3b9(0x1b7),{'action':_0x4cd3b9(0x1bf),'contact':_0x4c722a}),_0x4bcc4e[_0x4cd3b9(0x1c0)](0xc8)['json'](_0x4c722a);};exports[a13_0x3fc779(0x20c)]=store;const show=async(_0x2406c3,_0x527e55)=>{const _0x294c0a=a13_0x3fc779,{contactId:_0x2d2baa}=_0x2406c3[_0x294c0a(0x1cf)],{companyId:_0x973a55}=_0x2406c3[_0x294c0a(0x20d)],_0x4d6fa4=await(0x0,ShowContactService_1[_0x294c0a(0x1f5)])(_0x2d2baa,_0x973a55);return _0x527e55[_0x294c0a(0x1c0)](0xc8)[_0x294c0a(0x1f3)](_0x4d6fa4);};exports['show']=show;const update=async(_0x10905f,_0x44cddf)=>{const _0xaa67b8=a13_0x3fc779,_0x53c5a6=_0x10905f[_0xaa67b8(0x1e6)],{companyId:_0x3e01a3}=_0x10905f[_0xaa67b8(0x20d)],_0x3bafd1=Yup[_0xaa67b8(0x196)]()[_0xaa67b8(0x205)]({'name':Yup[_0xaa67b8(0x1ab)](),'number':Yup[_0xaa67b8(0x1ab)]()[_0xaa67b8(0x1dc)](/^\d+$/,_0xaa67b8(0x1cc))});try{await _0x3bafd1[_0xaa67b8(0x19c)](_0x53c5a6);}catch(_0x50a9e2){throw new AppError_1[(_0xaa67b8(0x1f5))](_0x50a9e2['message']);}if(!_0x53c5a6['isGroup']){const _0x3f095b=await(0x0,CheckNumber_1[_0xaa67b8(0x1f5)])(_0x53c5a6['number'],_0x3e01a3),_0xd882fa=_0x3f095b[_0xaa67b8(0x1b6)][_0xaa67b8(0x1f6)](/\D/g,'');_0x53c5a6[_0xaa67b8(0x1ad)]=_0xd882fa;}const {contactId:_0x3876fb}=_0x10905f['params'],_0x132123=await(0x0,UpdateContactService_1[_0xaa67b8(0x1f5)])({'contactData':_0x53c5a6,'contactId':_0x3876fb,'companyId':_0x3e01a3}),_0x4c88c4=(0x0,socket_1[_0xaa67b8(0x191)])();return _0x4c88c4['to'](_0xaa67b8(0x1e8)+_0x3e01a3+'-mainchannel')[_0xaa67b8(0x199)]('company-'+_0x3e01a3+'-contact',{'action':_0xaa67b8(0x198),'contact':_0x132123}),_0x44cddf[_0xaa67b8(0x1c0)](0xc8)[_0xaa67b8(0x1f3)](_0x132123);};exports['update']=update;const remove=async(_0x1c813c,_0xd56125)=>{const _0x4bfc14=a13_0x3fc779,{contactId:_0xe0bbd5}=_0x1c813c[_0x4bfc14(0x1cf)],{companyId:_0x33dfff}=_0x1c813c['user'];await(0x0,ShowContactService_1[_0x4bfc14(0x1f5)])(_0xe0bbd5,_0x33dfff),await(0x0,DeleteContactService_1[_0x4bfc14(0x1f5)])(_0xe0bbd5);const _0x54488e=(0x0,socket_1[_0x4bfc14(0x191)])();return _0x54488e['to'](_0x4bfc14(0x1e8)+_0x33dfff+'-mainchannel')[_0x4bfc14(0x199)]('company-'+_0x33dfff+_0x4bfc14(0x1b7),{'action':'delete','contactId':_0xe0bbd5}),_0xd56125[_0x4bfc14(0x1c0)](0xc8)[_0x4bfc14(0x1f3)]({'message':_0x4bfc14(0x19f)});};exports[a13_0x3fc779(0x1a6)]=remove;const list=async(_0x3eab64,_0x57cc60)=>{const _0x3b1fb5=a13_0x3fc779,{name:_0x622b3c}=_0x3eab64[_0x3b1fb5(0x1d7)],{companyId:_0x4bf2b7}=_0x3eab64[_0x3b1fb5(0x20d)],_0x3d1adf=await(0x0,SimpleListService_1[_0x3b1fb5(0x1f5)])({'name':_0x622b3c,'companyId':_0x4bf2b7});return _0x57cc60[_0x3b1fb5(0x1f3)](_0x3d1adf);};exports[a13_0x3fc779(0x1c2)]=list;const importCsv=async(_0x3c6bf3,_0x592862)=>{const _0x52966a=a13_0x3fc779,{companyId:_0x51b4ce}=_0x3c6bf3[_0x52966a(0x20d)],{file:_0x445283}=_0x3c6bf3;if(!_0x445283)throw new AppError_1[(_0x52966a(0x1f5))](_0x52966a(0x1eb),0x190);let _0x1e6254=',';try{let _0x14d18a=fs_1[_0x52966a(0x1f5)][_0x52966a(0x1ff)](_0x445283[_0x52966a(0x1b8)],{'encoding':_0x52966a(0x18c)});_0x14d18a['charCodeAt'](0x0)===0xfeff&&(logger_1['logger']['info'](_0x52966a(0x1c8)),_0x14d18a=_0x14d18a[_0x52966a(0x1d0)](0x1),fs_1[_0x52966a(0x1f5)][_0x52966a(0x18f)](_0x445283[_0x52966a(0x1b8)],_0x14d18a,{'encoding':_0x52966a(0x18c)}));const _0x251c57=_0x14d18a[_0x52966a(0x1bd)]('\x0a')[0x0];if(_0x251c57['includes'](';'))_0x1e6254=';';else _0x251c57['includes']('\x09')&&(_0x1e6254='\x09');logger_1['logger'][_0x52966a(0x20b)](_0x52966a(0x1a4)+_0x1e6254);}catch(_0x24bb1c){logger_1[_0x52966a(0x1d1)][_0x52966a(0x1a5)]('Error\x20processing\x20CSV\x20file:\x20'+_0x24bb1c[_0x52966a(0x18e)]);}const _0x11cb85=(0x0,csv_1[_0x52966a(0x1ce)])({'delimiter':_0x1e6254,'columns':!![],'trim':!![],'relaxColumnCount':!![]},async(_0x10d99f,_0x59a5de)=>{const _0x32484d=_0x52966a;if(_0x10d99f){logger_1[_0x32484d(0x1d1)][_0x32484d(0x1a5)](_0x32484d(0x1b4)+_0x10d99f[_0x32484d(0x18e)]);throw new AppError_1[(_0x32484d(0x1f5))](_0x32484d(0x1cb),0x190);}if(!_0x59a5de||_0x59a5de[_0x32484d(0x1c4)]===0x0){logger_1[_0x32484d(0x1d1)][_0x32484d(0x1a5)](_0x32484d(0x1d8));throw new AppError_1['default'](_0x32484d(0x1fc),0x190);}_0x59a5de[_0x32484d(0x1d6)](async _0x31fcb0=>{const _0x530928=_0x32484d;_0x54d854++;let _0x160125;try{_0x160125=JSON['parse'](_0x31fcb0[_0x530928(0x1c9)]);}catch(_0x2d4890){_0x160125=[];}let _0xc67d80=_0x31fcb0['number']||_0x31fcb0[_0x530928(0x1fa)];if(!_0xc67d80){logger_1['logger'][_0x530928(0x1a5)](_0x530928(0x197)+JSON[_0x530928(0x192)](_0x31fcb0));return;}_0xc67d80=String(_0xc67d80)[_0x530928(0x1ba)]();if(_0xc67d80['toUpperCase']()[_0x530928(0x1ea)]('E+')||/^\d+([.,]\d+)?[eE][+-]?\d+$/['test'](_0xc67d80))try{const _0x59ea63=_0xc67d80['replace'](',','.');_0xc67d80=parseFloat(_0x59ea63)[_0x530928(0x1d3)]();}catch(_0x4329ae){logger_1[_0x530928(0x1d1)]['error']('Error\x20converting\x20scientific\x20notation:\x20'+_0xc67d80);}_0xc67d80=_0xc67d80['replace'](/\D/g,'');if(!_0xc67d80||_0xc67d80['length']<0x8){logger_1[_0x530928(0x1d1)][_0x530928(0x1a5)]('Invalid\x20phone\x20number\x20after\x20cleaning:\x20'+_0xc67d80);return;}const _0x3a4515={'companyId':_0x51b4ce,'name':_0x31fcb0[_0x530928(0x1bb)]||_0x31fcb0['Name'],'number':_0xc67d80,'email':_0x31fcb0[_0x530928(0x1ae)]||_0x31fcb0['Email'],'extraInfo':_0x160125};Object[_0x530928(0x1cd)](_0x31fcb0)[_0x530928(0x1d6)](_0xf01747=>{const _0x44d0cb=_0x530928;_0xf01747!==_0x44d0cb(0x1bb)&&_0xf01747!==_0x44d0cb(0x1ad)&&_0xf01747!=='email'&&_0xf01747!==_0x44d0cb(0x202)&&_0xf01747!==_0x44d0cb(0x1fa)&&_0xf01747!==_0x44d0cb(0x207)&&_0xf01747!=='ExtraInfo'&&_0x31fcb0[_0xf01747]&&_0x3a4515[_0x44d0cb(0x1db)]['push']({'name':_0xf01747,'value':_0x31fcb0[_0xf01747]});});try{const _0x3b6702=await(0x0,CreateContactService_1[_0x530928(0x1f5)])(_0x3a4515);_0x14e28e++,logger_1[_0x530928(0x1d1)]['debug'](_0x530928(0x1de)+_0x3a4515['name']+'\x20-\x20'+_0x3a4515[_0x530928(0x1ad)]);const _0x1939b9=(0x0,socket_1[_0x530928(0x191)])();_0x1939b9['to'](_0x530928(0x1e8)+_0x51b4ce+'-mainchannel')[_0x530928(0x199)]('company-'+_0x51b4ce+_0x530928(0x1b7),{'action':_0x530928(0x198),'contact':_0x3b6702});}catch(_0x52a45f){_0x45e848++,logger_1[_0x530928(0x1d1)][_0x530928(0x1a5)]({'contact':_0x3a4515},'Error\x20creating\x20contact:\x20'+_0x52a45f[_0x530928(0x18e)]);}});}),_0x53cb57=fs_1['default'][_0x52966a(0x19b)](_0x445283[_0x52966a(0x1b8)]);let _0x54d854=0x0,_0x14e28e=0x0,_0x45e848=0x0;return _0x11cb85['on'](_0x52966a(0x1ee),()=>{const _0x210450=_0x52966a;_0x53cb57[_0x210450(0x1ac)](),fs_1[_0x210450(0x1f5)][_0x210450(0x194)](_0x445283[_0x210450(0x1b8)]),logger_1[_0x210450(0x1d1)][_0x210450(0x20b)]('CSV\x20import\x20finished.\x20Processed:\x20'+_0x54d854+',\x20Success:\x20'+_0x14e28e+_0x210450(0x1ec)+_0x45e848);}),_0x53cb57[_0x52966a(0x1aa)](_0x11cb85),_0x592862[_0x52966a(0x1c0)](0xc8)['json']({'message':'Contacts\x20being\x20imported'});};exports[a13_0x3fc779(0x1b2)]=importCsv;const removeAll=async(_0x12057c,_0x4af92a)=>{const _0x13724c=a13_0x3fc779,{companyId:_0x41e2f0}=_0x12057c[_0x13724c(0x20d)];try{const _0x52e5be=await Contact_1[_0x13724c(0x1f5)][_0x13724c(0x1a2)]({'where':{'companyId':_0x41e2f0}});for(const _0x246efc of _0x52e5be){const _0x56ae61=(0x0,path_1[_0x13724c(0x1be)])((0x0,GetPublicPath_1[_0x13724c(0x204)])(),_0x13724c(0x206),_0x246efc[_0x13724c(0x1fd)]+'/'+_0x246efc['id']);fs_1[_0x13724c(0x1f5)][_0x13724c(0x1e4)](_0x56ae61,{'recursive':!![],'force':!![]});}await Contact_1[_0x13724c(0x1f5)][_0x13724c(0x1ac)]({'where':{'companyId':_0x41e2f0}});const _0x350e78=(0x0,socket_1[_0x13724c(0x191)])();return _0x350e78['to'](_0x13724c(0x1e8)+_0x41e2f0+_0x13724c(0x1c5))[_0x13724c(0x199)](_0x13724c(0x1e8)+_0x41e2f0+_0x13724c(0x1b7),{'action':_0x13724c(0x1c6)}),_0x4af92a['status'](0xc8)[_0x13724c(0x1f3)]({'message':_0x13724c(0x1a9)});}catch(_0x5ee091){logger_1[_0x13724c(0x1d1)]['error']({'companyId':_0x41e2f0},_0x13724c(0x19a)+_0x5ee091['message']);throw new AppError_1[(_0x13724c(0x1f5))](_0x13724c(0x1e2),0x1f4);}};exports['removeAll']=removeAll;const exportCsv=async(_0x12c036,_0xef322)=>{const _0x5a816f=a13_0x3fc779,{companyId:_0x1b890f}=_0x12c036[_0x5a816f(0x20d)],_0x1f25e1=await Contact_1[_0x5a816f(0x1f5)][_0x5a816f(0x1a2)]({'where':{'companyId':_0x1b890f,'channel':_0x5a816f(0x208),'isGroup':![]},'include':[{'model':ContactCustomField_1[_0x5a816f(0x1f5)],'as':_0x5a816f(0x1db)}]}),_0x89c368=_0x1f25e1[_0x5a816f(0x1e3)](_0x49dd2b=>{const _0x590daf=_0x5a816f,_0x4794a9=_0x49dd2b[_0x590daf(0x1db)][_0x590daf(0x1e3)](_0x3cfb32=>({'name':_0x3cfb32[_0x590daf(0x1bb)],'value':_0x3cfb32['value']}));return{'Name':_0x49dd2b[_0x590daf(0x1bb)],'Number':_0x49dd2b['number'],'Email':_0x49dd2b[_0x590daf(0x1ae)]||'','ExtraInfo':JSON[_0x590daf(0x192)](_0x4794a9)};});return(0x0,csv_1['stringify'])(_0x89c368,{'header':!![]},(_0x39d0c0,_0x489119)=>{const _0x138d71=_0x5a816f;if(_0x39d0c0)throw new AppError_1['default']('ERR_GENERATING_CSV',0x1f4);_0xef322[_0x138d71(0x193)]('Content-disposition',_0x138d71(0x195)),_0xef322['set'](_0x138d71(0x1f4),_0x138d71(0x1f9)),_0xef322[_0x138d71(0x1c0)](0xc8)['send'](_0x489119);}),_0xef322;};exports[a13_0x3fc779(0x1f7)]=exportCsv;