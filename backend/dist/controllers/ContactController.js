'use strict';const a16_0x105395=a16_0x591c;(function(_0x3cd165,_0x3ef9f8){const _0x56e85e=a16_0x591c,_0x1f4794=_0x3cd165();while(!![]){try{const _0x1cdf3a=-parseInt(_0x56e85e(0xe3))/0x1+parseInt(_0x56e85e(0x110))/0x2*(-parseInt(_0x56e85e(0x131))/0x3)+parseInt(_0x56e85e(0x148))/0x4+parseInt(_0x56e85e(0x132))/0x5*(-parseInt(_0x56e85e(0x150))/0x6)+parseInt(_0x56e85e(0xf0))/0x7*(-parseInt(_0x56e85e(0x130))/0x8)+parseInt(_0x56e85e(0x10c))/0x9*(-parseInt(_0x56e85e(0xed))/0xa)+-parseInt(_0x56e85e(0x11f))/0xb*(-parseInt(_0x56e85e(0xe1))/0xc);if(_0x1cdf3a===_0x3ef9f8)break;else _0x1f4794['push'](_0x1f4794['shift']());}catch(_0x27b989){_0x1f4794['push'](_0x1f4794['shift']());}}}(a16_0x2acc,0x227f9));var __createBinding=this&&this[a16_0x105395(0xee)]||(Object['create']?function(_0x4f057f,_0x5b5bca,_0x2b8da5,_0x195870){const _0x15c28a=a16_0x105395;if(_0x195870===undefined)_0x195870=_0x2b8da5;var _0x4a7e26=Object[_0x15c28a(0x118)](_0x5b5bca,_0x2b8da5);(!_0x4a7e26||(_0x15c28a(0x13a)in _0x4a7e26?!_0x5b5bca['__esModule']:_0x4a7e26['writable']||_0x4a7e26['configurable']))&&(_0x4a7e26={'enumerable':!![],'get':function(){return _0x5b5bca[_0x2b8da5];}}),Object[_0x15c28a(0xe8)](_0x4f057f,_0x195870,_0x4a7e26);}:function(_0xecd5c1,_0x5eae15,_0x34496e,_0x54f73a){if(_0x54f73a===undefined)_0x54f73a=_0x34496e;_0xecd5c1[_0x54f73a]=_0x5eae15[_0x34496e];}),__setModuleDefault=this&&this[a16_0x105395(0x14e)]||(Object[a16_0x105395(0x115)]?function(_0x33164d,_0x377280){const _0x5ed0b9=a16_0x105395;Object[_0x5ed0b9(0xe8)](_0x33164d,'default',{'enumerable':!![],'value':_0x377280});}:function(_0x4c49ca,_0xfabcf3){const _0x2712b3=a16_0x105395;_0x4c49ca[_0x2712b3(0x122)]=_0xfabcf3;}),__importStar=this&&this['__importStar']||(function(){const _0x6dfde3=(function(){let _0x3f5261=!![];return function(_0x1b087c,_0x223319){const _0x20f7bf=_0x3f5261?function(){const _0x54cb16=a16_0x591c;if(_0x223319){const _0x27ea22=_0x223319[_0x54cb16(0xfb)](_0x1b087c,arguments);return _0x223319=null,_0x27ea22;}}:function(){};return _0x3f5261=![],_0x20f7bf;};}()),_0x1fbcef=_0x6dfde3(this,function(){const _0x31a2b7=a16_0x591c;return _0x1fbcef[_0x31a2b7(0x13e)]()['search'](_0x31a2b7(0x14d))[_0x31a2b7(0x13e)]()[_0x31a2b7(0x10e)](_0x1fbcef)[_0x31a2b7(0x13d)]('(((.+)+)+)+$');});_0x1fbcef();var _0x4bdc04=function(_0x48e22d){const _0x428c19=a16_0x591c;return _0x4bdc04=Object[_0x428c19(0x12b)]||function(_0x1309f4){const _0x5def69=_0x428c19;var _0x5716c0=[];for(var _0x544924 in _0x1309f4)if(Object[_0x5def69(0x138)][_0x5def69(0x116)][_0x5def69(0xda)](_0x1309f4,_0x544924))_0x5716c0[_0x5716c0[_0x5def69(0x126)]]=_0x544924;return _0x5716c0;},_0x4bdc04(_0x48e22d);};return function(_0x38b10d){const _0x583a2f=a16_0x591c;if(_0x38b10d&&_0x38b10d['__esModule'])return _0x38b10d;var _0x5462f7={};if(_0x38b10d!=null){for(var _0x3e11cb=_0x4bdc04(_0x38b10d),_0x1c53a7=0x0;_0x1c53a7<_0x3e11cb[_0x583a2f(0x126)];_0x1c53a7++)if(_0x3e11cb[_0x1c53a7]!==_0x583a2f(0x122))__createBinding(_0x5462f7,_0x38b10d,_0x3e11cb[_0x1c53a7]);}return __setModuleDefault(_0x5462f7,_0x38b10d),_0x5462f7;};}()),__importDefault=this&&this[a16_0x105395(0x11b)]||function(_0x2dfff6){const _0x1aca4c=a16_0x105395;return _0x2dfff6&&_0x2dfff6[_0x1aca4c(0x101)]?_0x2dfff6:{'default':_0x2dfff6};};Object[a16_0x105395(0xe8)](exports,'__esModule',{'value':!![]}),exports[a16_0x105395(0xce)]=exports['removeAll']=exports[a16_0x105395(0x136)]=exports[a16_0x105395(0x129)]=exports['remove']=exports[a16_0x105395(0xd5)]=exports[a16_0x105395(0x114)]=exports[a16_0x105395(0x10a)]=exports[a16_0x105395(0x107)]=exports[a16_0x105395(0xe4)]=void 0x0;const Yup=__importStar(require(a16_0x105395(0x142))),csv_1=require(a16_0x105395(0x145)),fs_1=__importDefault(require('fs')),path_1=require(a16_0x105395(0x149)),socket_1=require(a16_0x105395(0xeb)),GetPublicPath_1=require('../helpers/GetPublicPath'),ListContactsService_1=__importDefault(require(a16_0x105395(0xfe))),CreateContactService_1=__importDefault(require(a16_0x105395(0xdb))),ShowContactService_1=__importDefault(require(a16_0x105395(0x123))),UpdateContactService_1=__importDefault(require('../services/ContactServices/UpdateContactService')),DeleteContactService_1=__importDefault(require(a16_0x105395(0x124))),GetContactService_1=__importDefault(require('../services/ContactServices/GetContactService')),CheckNumber_1=__importDefault(require(a16_0x105395(0xd9))),AppError_1=__importDefault(require(a16_0x105395(0xf4))),SimpleListService_1=__importDefault(require(a16_0x105395(0xe5))),ContactCustomField_1=__importDefault(require(a16_0x105395(0x112))),logger_1=require(a16_0x105395(0xef)),Contact_1=__importDefault(require('../models/Contact')),index=async(_0x45f78f,_0x5f0856)=>{const _0x453c9f=a16_0x105395,{searchParam:_0x3de447,pageNumber:_0x38c545}=_0x45f78f[_0x453c9f(0x12e)],{companyId:_0xb759c4}=_0x45f78f[_0x453c9f(0xe7)],{contacts:_0x5cd8f7,count:_0x49b670,hasMore:_0x5edbf1}=await(0x0,ListContactsService_1[_0x453c9f(0x122)])({'searchParam':_0x3de447,'pageNumber':_0x38c545,'companyId':_0xb759c4});return _0x5f0856[_0x453c9f(0x105)]({'contacts':_0x5cd8f7,'count':_0x49b670,'hasMore':_0x5edbf1});};exports['index']=index;const getContact=async(_0x27d323,_0x224b91)=>{const _0x416f72=a16_0x105395,{name:_0x444ced,number:_0xa232a0}=_0x27d323['body'],{companyId:_0x38e8ab}=_0x27d323['user'],_0x697f75=await(0x0,GetContactService_1['default'])({'name':_0x444ced,'number':_0xa232a0,'companyId':_0x38e8ab});return _0x224b91[_0x416f72(0x14a)](0xc8)[_0x416f72(0x105)](_0x697f75);};exports[a16_0x105395(0x107)]=getContact;const store=async(_0x49b002,_0x3bc777)=>{const _0x1e0279=a16_0x105395,{companyId:_0x54d95f}=_0x49b002[_0x1e0279(0xe7)],_0x132a46=_0x49b002[_0x1e0279(0x11a)];_0x132a46['number']=_0x132a46[_0x1e0279(0xd3)][_0x1e0279(0x125)]('-','')[_0x1e0279(0x125)]('\x20','');const _0x1ab123=Yup[_0x1e0279(0x113)]()[_0x1e0279(0xf8)]({'name':Yup['string']()[_0x1e0279(0x11c)](),'number':Yup[_0x1e0279(0x127)]()[_0x1e0279(0x11c)]()['matches'](/^\d+$/,_0x1e0279(0xd2))});try{await _0x1ab123['validate'](_0x132a46);}catch(_0x49ddaf){throw new AppError_1[(_0x1e0279(0x122))](_0x49ddaf[_0x1e0279(0xea)]);}if(!_0x132a46[_0x1e0279(0x108)]){const _0x3c92ac=await(0x0,CheckNumber_1[_0x1e0279(0x122)])(_0x132a46['number'],_0x54d95f),_0x18d5af=_0x3c92ac[_0x1e0279(0xf3)][_0x1e0279(0x125)](/\D/g,'');_0x132a46[_0x1e0279(0xd3)]=_0x18d5af;}const _0x48be58=await(0x0,CreateContactService_1[_0x1e0279(0x122)])({..._0x132a46,'companyId':_0x54d95f}),_0x3d9aa8=(0x0,socket_1['getIO'])();return _0x3d9aa8['to'](_0x1e0279(0xd0)+_0x54d95f+_0x1e0279(0xe9))[_0x1e0279(0x135)](_0x1e0279(0xd0)+_0x54d95f+'-contact',{'action':_0x1e0279(0x115),'contact':_0x48be58}),_0x3bc777[_0x1e0279(0x14a)](0xc8)[_0x1e0279(0x105)](_0x48be58);};exports[a16_0x105395(0x10a)]=store;const show=async(_0x54f1c5,_0x3c64de)=>{const _0x346db1=a16_0x105395,{contactId:_0x40fbb0}=_0x54f1c5[_0x346db1(0xd8)],{companyId:_0x1b88d8}=_0x54f1c5[_0x346db1(0xe7)],_0x2d545e=await(0x0,ShowContactService_1[_0x346db1(0x122)])(_0x40fbb0,_0x1b88d8);return _0x3c64de['status'](0xc8)[_0x346db1(0x105)](_0x2d545e);};exports[a16_0x105395(0x114)]=show;const update=async(_0x4504fd,_0x5bdbf0)=>{const _0x470f25=a16_0x105395,_0x52cded=_0x4504fd[_0x470f25(0x11a)],{companyId:_0x50a8de}=_0x4504fd[_0x470f25(0xe7)],_0x371d87=Yup[_0x470f25(0x113)]()[_0x470f25(0xf8)]({'name':Yup[_0x470f25(0x127)](),'number':Yup[_0x470f25(0x127)]()[_0x470f25(0x14b)](/^\d+$/,_0x470f25(0xd2))});try{await _0x371d87[_0x470f25(0xf1)](_0x52cded);}catch(_0x131036){throw new AppError_1[(_0x470f25(0x122))](_0x131036['message']);}if(!_0x52cded[_0x470f25(0x108)]){const _0x96f9d5=await(0x0,CheckNumber_1['default'])(_0x52cded[_0x470f25(0xd3)],_0x50a8de),_0x614cfe=_0x96f9d5[_0x470f25(0xf3)][_0x470f25(0x125)](/\D/g,'');_0x52cded[_0x470f25(0xd3)]=_0x614cfe;}const {contactId:_0x21a52e}=_0x4504fd[_0x470f25(0xd8)],_0x325751=await(0x0,UpdateContactService_1['default'])({'contactData':_0x52cded,'contactId':_0x21a52e,'companyId':_0x50a8de}),_0x3379cf=(0x0,socket_1[_0x470f25(0xe0)])();return _0x3379cf['to'](_0x470f25(0xd0)+_0x50a8de+'-mainchannel')[_0x470f25(0x135)](_0x470f25(0xd0)+_0x50a8de+_0x470f25(0xd6),{'action':'update','contact':_0x325751}),_0x5bdbf0[_0x470f25(0x14a)](0xc8)['json'](_0x325751);};exports[a16_0x105395(0xd5)]=update;const remove=async(_0x4be2d9,_0x25517d)=>{const _0x1061eb=a16_0x105395,{contactId:_0x4e0208}=_0x4be2d9[_0x1061eb(0xd8)],{companyId:_0x3c4747}=_0x4be2d9[_0x1061eb(0xe7)];await(0x0,ShowContactService_1[_0x1061eb(0x122)])(_0x4e0208,_0x3c4747),await(0x0,DeleteContactService_1[_0x1061eb(0x122)])(_0x4e0208);const _0x3d14bb=(0x0,socket_1[_0x1061eb(0xe0)])();return _0x3d14bb['to'](_0x1061eb(0xd0)+_0x3c4747+_0x1061eb(0xe9))[_0x1061eb(0x135)]('company-'+_0x3c4747+_0x1061eb(0xd6),{'action':_0x1061eb(0xf9),'contactId':_0x4e0208}),_0x25517d[_0x1061eb(0x14a)](0xc8)[_0x1061eb(0x105)]({'message':_0x1061eb(0x11e)});};exports[a16_0x105395(0x119)]=remove;function a16_0x591c(_0x2866cc,_0x8ffb76){const _0x45590a=a16_0x2acc();return a16_0x591c=function(_0x131690,_0x2e9a62){_0x131690=_0x131690-0xcd;let _0x2accad=_0x45590a[_0x131690];return _0x2accad;},a16_0x591c(_0x2866cc,_0x8ffb76);}const list=async(_0x512e5d,_0x9486b6)=>{const _0x2e1a1b=a16_0x105395,{name:_0x5cac84}=_0x512e5d[_0x2e1a1b(0x12e)],{companyId:_0x4ea3e9}=_0x512e5d[_0x2e1a1b(0xe7)],_0x50dbbb=await(0x0,SimpleListService_1[_0x2e1a1b(0x122)])({'name':_0x5cac84,'companyId':_0x4ea3e9});return _0x9486b6[_0x2e1a1b(0x105)](_0x50dbbb);};exports[a16_0x105395(0x129)]=list;const importCsv=async(_0x2b5cdf,_0x155ae6)=>{const _0x4387a5=a16_0x105395,{companyId:_0x339418}=_0x2b5cdf['user'],{file:_0x34477e}=_0x2b5cdf;if(!_0x34477e)throw new AppError_1[(_0x4387a5(0x122))]('ERR_NO_FILE',0x190);let _0x150ba5=',';try{let _0x117efa=fs_1['default']['readFileSync'](_0x34477e[_0x4387a5(0x149)],{'encoding':_0x4387a5(0x12f)});_0x117efa[_0x4387a5(0x137)](0x0)===0xfeff&&(logger_1[_0x4387a5(0x117)][_0x4387a5(0x14c)]('UTF-8\x20BOM\x20detected,\x20removing\x20it'),_0x117efa=_0x117efa['substring'](0x1),fs_1[_0x4387a5(0x122)][_0x4387a5(0xdd)](_0x34477e[_0x4387a5(0x149)],_0x117efa,{'encoding':_0x4387a5(0x12f)}));const _0x3c99a9=_0x117efa['split']('\x0a')[0x0];if(_0x3c99a9['includes'](';'))_0x150ba5=';';else _0x3c99a9['includes']('\x09')&&(_0x150ba5='\x09');logger_1[_0x4387a5(0x117)][_0x4387a5(0x14c)](_0x4387a5(0xec)+_0x150ba5);}catch(_0x228c90){logger_1[_0x4387a5(0x117)][_0x4387a5(0xf5)](_0x4387a5(0x128)+_0x228c90['message']);}const _0x55d270=(0x0,csv_1[_0x4387a5(0x13f)])({'delimiter':_0x150ba5,'columns':!![],'trim':!![],'relaxColumnCount':!![]},async(_0x54a1a9,_0x5398b3)=>{const _0x2cb7f7=_0x4387a5;if(_0x54a1a9){logger_1['logger'][_0x2cb7f7(0xf5)]('CSV\x20parsing\x20error:\x20'+_0x54a1a9[_0x2cb7f7(0xea)]);throw new AppError_1[(_0x2cb7f7(0x122))](_0x2cb7f7(0x14f),0x190);}if(!_0x5398b3||_0x5398b3[_0x2cb7f7(0x126)]===0x0){logger_1['logger'][_0x2cb7f7(0xf5)](_0x2cb7f7(0xde));throw new AppError_1['default']('ERR_EMPTY_CSV',0x190);}_0x5398b3[_0x2cb7f7(0xfc)](async _0x334ad2=>{const _0xdcb555=_0x2cb7f7;_0x33d435++;let _0x200bed;try{_0x200bed=JSON[_0xdcb555(0x13f)](_0x334ad2['ExtraInfo']);}catch(_0x509ae4){_0x200bed=[];}let _0x2be0ad=_0x334ad2[_0xdcb555(0xd3)]||_0x334ad2[_0xdcb555(0x12a)];if(!_0x2be0ad){logger_1[_0xdcb555(0x117)][_0xdcb555(0xf5)](_0xdcb555(0xf2)+JSON[_0xdcb555(0xf7)](_0x334ad2));return;}_0x2be0ad=String(_0x2be0ad)[_0xdcb555(0x13c)]();if(_0x2be0ad['toUpperCase']()[_0xdcb555(0xe6)]('E+')||/^\d+([.,]\d+)?[eE][+-]?\d+$/[_0xdcb555(0xf6)](_0x2be0ad))try{const _0x1c1393=_0x2be0ad[_0xdcb555(0x125)](',','.');_0x2be0ad=parseFloat(_0x1c1393)['toString']();}catch(_0x177010){logger_1[_0xdcb555(0x117)][_0xdcb555(0xf5)](_0xdcb555(0x12c)+_0x2be0ad);}_0x2be0ad=_0x2be0ad['replace'](/\D/g,'');if(!_0x2be0ad||_0x2be0ad[_0xdcb555(0x126)]<0x8){logger_1[_0xdcb555(0x117)]['error'](_0xdcb555(0x109)+_0x2be0ad);return;}const _0x5342f3={'companyId':_0x339418,'name':_0x334ad2[_0xdcb555(0xfa)]||_0x334ad2[_0xdcb555(0x100)],'number':_0x2be0ad,'email':_0x334ad2[_0xdcb555(0x12d)]||_0x334ad2['Email'],'extraInfo':_0x200bed};Object['keys'](_0x334ad2)[_0xdcb555(0xfc)](_0x309f0e=>{const _0x41f699=_0xdcb555;_0x309f0e!=='name'&&_0x309f0e!==_0x41f699(0xd3)&&_0x309f0e!=='email'&&_0x309f0e!==_0x41f699(0x100)&&_0x309f0e!==_0x41f699(0x12a)&&_0x309f0e!==_0x41f699(0x140)&&_0x309f0e!=='ExtraInfo'&&_0x334ad2[_0x309f0e]&&_0x5342f3['extraInfo'][_0x41f699(0xd7)]({'name':_0x309f0e,'value':_0x334ad2[_0x309f0e]});});try{const _0xc3a73=await(0x0,CreateContactService_1[_0xdcb555(0x122)])(_0x5342f3);_0x4c8f2a++,logger_1['logger'][_0xdcb555(0xd4)](_0xdcb555(0xfd)+_0x5342f3[_0xdcb555(0xfa)]+_0xdcb555(0xe2)+_0x5342f3[_0xdcb555(0xd3)]);const _0x5de67c=(0x0,socket_1[_0xdcb555(0xe0)])();_0x5de67c['to'](_0xdcb555(0xd0)+_0x339418+_0xdcb555(0xe9))['emit'](_0xdcb555(0xd0)+_0x339418+'-contact',{'action':_0xdcb555(0xd5),'contact':_0xc3a73});}catch(_0x1a75db){_0x21a157++,logger_1['logger'][_0xdcb555(0xf5)]({'contact':_0x5342f3},_0xdcb555(0x10d)+_0x1a75db[_0xdcb555(0xea)]);}});}),_0x42872=fs_1[_0x4387a5(0x122)][_0x4387a5(0x141)](_0x34477e[_0x4387a5(0x149)]);let _0x33d435=0x0,_0x4c8f2a=0x0,_0x21a157=0x0;return _0x55d270['on']('end',()=>{const _0x4bd03c=_0x4387a5;_0x42872[_0x4bd03c(0x10b)](),fs_1[_0x4bd03c(0x122)][_0x4bd03c(0x134)](_0x34477e[_0x4bd03c(0x149)]),logger_1['logger'][_0x4bd03c(0x14c)](_0x4bd03c(0xff)+_0x33d435+_0x4bd03c(0x120)+_0x4c8f2a+_0x4bd03c(0x139)+_0x21a157);}),_0x42872[_0x4387a5(0x143)](_0x55d270),_0x155ae6[_0x4387a5(0x14a)](0xc8)[_0x4387a5(0x105)]({'message':'Contacts\x20being\x20imported'});};function a16_0x2acc(){const _0x1283a4=['../libs/socket','Detected\x20CSV\x20delimiter:\x20','10ZmjPbh','__createBinding','../utils/logger','35yisLro','validate','Missing\x20phone\x20number\x20in\x20record:\x20','jid','../errors/AppError','error','test','stringify','shape','delete','name','apply','forEach','Contact\x20created\x20successfully:\x20','../services/ContactServices/ListContactsService','CSV\x20import\x20finished.\x20Processed:\x20','Name','__esModule','All\x20contacts\x20have\x20been\x20deleted','getPublicPath','Content-Type','json','setHeader','getContact','isGroup','Invalid\x20phone\x20number\x20after\x20cleaning:\x20','store','destroy','347778RMSnmx','Error\x20creating\x20contact:\x20','constructor','whatsapp','200elAeyy','text/csv','../models/ContactCustomField','object','show','create','hasOwnProperty','logger','getOwnPropertyDescriptor','remove','body','__importDefault','required','Content-disposition','Contact\x20deleted','2576123OnvyiM',',\x20Success:\x20','Error\x20deleting\x20all\x20contacts:\x20','default','../services/ContactServices/ShowContactService','../services/ContactServices/DeleteContactService','replace','length','string','Error\x20processing\x20CSV\x20file:\x20','list','Number','getOwnPropertyNames','Error\x20converting\x20scientific\x20notation:\x20','email','query','utf8','263544ydsMqn','4923DLhZee','780VWqVKb','extraInfo','unlinkSync','emit','importCsv','charCodeAt','prototype',',\x20Errors:\x20','get','ERR_DELETING_CONTACTS','trim','search','toString','parse','Email','createReadStream','yup','pipe','join','csv','media','map','1065628bzNSfL','path','status','matches','info','(((.+)+)+)+$','__setModuleDefault','ERR_INVALID_CSV','7446cawDVt','value','exportCsv','send','company-','rmSync','Invalid\x20number\x20format.\x20Only\x20numbers\x20is\x20allowed.','number','debug','update','-contact','push','params','../services/WbotServices/CheckNumber','call','../services/ContactServices/CreateContactService','removeAll','writeFileSync','CSV\x20file\x20is\x20empty\x20or\x20invalid','set','getIO','24LZymGS','\x20-\x20','32435CazmjY','index','../services/ContactServices/SimpleListService','includes','user','defineProperty','-mainchannel','message'];a16_0x2acc=function(){return _0x1283a4;};return a16_0x2acc();}exports['importCsv']=importCsv;const removeAll=async(_0x34b9cd,_0x18730e)=>{const _0x4e7262=a16_0x105395,{companyId:_0x3f50a5}=_0x34b9cd[_0x4e7262(0xe7)];try{const _0x6568af=await Contact_1[_0x4e7262(0x122)]['findAll']({'where':{'companyId':_0x3f50a5}});for(const _0x1ca022 of _0x6568af){const _0x54cb87=(0x0,path_1[_0x4e7262(0x144)])((0x0,GetPublicPath_1[_0x4e7262(0x103)])(),_0x4e7262(0x146),_0x1ca022['companyId']+'/'+_0x1ca022['id']);fs_1[_0x4e7262(0x122)][_0x4e7262(0xd1)](_0x54cb87,{'recursive':!![],'force':!![]});}await Contact_1[_0x4e7262(0x122)][_0x4e7262(0x10b)]({'where':{'companyId':_0x3f50a5}});const _0x59c409=(0x0,socket_1[_0x4e7262(0xe0)])();return _0x59c409['to'](_0x4e7262(0xd0)+_0x3f50a5+_0x4e7262(0xe9))[_0x4e7262(0x135)](_0x4e7262(0xd0)+_0x3f50a5+'-contact',{'action':'delete-all'}),_0x18730e['status'](0xc8)[_0x4e7262(0x105)]({'message':_0x4e7262(0x102)});}catch(_0xa8437a){logger_1[_0x4e7262(0x117)][_0x4e7262(0xf5)]({'companyId':_0x3f50a5},_0x4e7262(0x121)+_0xa8437a[_0x4e7262(0xea)]);throw new AppError_1['default'](_0x4e7262(0x13b),0x1f4);}};exports[a16_0x105395(0xdc)]=removeAll;const exportCsv=async(_0x4ee758,_0x557385)=>{const _0x31b77c=a16_0x105395,{companyId:_0x535d1a}=_0x4ee758[_0x31b77c(0xe7)],_0x53c306=await Contact_1[_0x31b77c(0x122)]['findAll']({'where':{'companyId':_0x535d1a,'channel':_0x31b77c(0x10f),'isGroup':![]},'include':[{'model':ContactCustomField_1[_0x31b77c(0x122)],'as':'extraInfo'}]}),_0x15dade=_0x53c306[_0x31b77c(0x147)](_0x2a213e=>{const _0x3c3dba=_0x31b77c,_0x3ee41f=_0x2a213e[_0x3c3dba(0x133)]['map'](_0x27ced3=>({'name':_0x27ced3[_0x3c3dba(0xfa)],'value':_0x27ced3[_0x3c3dba(0xcd)]}));return{'Name':_0x2a213e[_0x3c3dba(0xfa)],'Number':_0x2a213e['number'],'Email':_0x2a213e[_0x3c3dba(0x12d)]||'','ExtraInfo':JSON[_0x3c3dba(0xf7)](_0x3ee41f)};});return(0x0,csv_1[_0x31b77c(0xf7)])(_0x15dade,{'header':!![]},(_0x27425f,_0x542d38)=>{const _0x4289ea=_0x31b77c;if(_0x27425f)throw new AppError_1['default']('ERR_GENERATING_CSV',0x1f4);_0x557385[_0x4289ea(0x106)](_0x4289ea(0x11d),'attachment;\x20filename=contacts.csv'),_0x557385[_0x4289ea(0xdf)](_0x4289ea(0x104),_0x4289ea(0x111)),_0x557385[_0x4289ea(0x14a)](0xc8)[_0x4289ea(0xcf)](_0x542d38);}),_0x557385;};exports[a16_0x105395(0xce)]=exportCsv;