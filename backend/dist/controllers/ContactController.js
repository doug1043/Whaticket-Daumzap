'use strict';function a13_0x13a4(){const _0x365b61=['map','getPublicPath','CSV\x20file\x20is\x20empty\x20or\x20invalid','update','list','-mainchannel','logger','prototype','debug','index','Invalid\x20phone\x20number\x20after\x20cleaning:\x20','removeAll','company-','status','message','../services/ContactServices/ListContactsService','configurable','send','params','media','delete-all','\x20-\x20','utf8','createReadStream','../services/WbotServices/CheckNumber','../helpers/GetPublicPath','4uOmIiF','object','value','5117896hrfeQK','Missing\x20phone\x20number\x20in\x20record:\x20','toString','Name','Contact\x20deleted','pipe','16976240dpNIpW','set','../models/ContactCustomField','990277AhccYZ','5857884qZsZIM','email','7YTNYbQ','json','query','1127780hSZAJV','matches','exportCsv','attachment;\x20filename=contacts.csv','../utils/logger','parse','Contact\x20created\x20successfully:\x20','CSV\x20import\x20finished.\x20Processed:\x20','length','__importDefault','search','default','extraInfo','forEach','charCodeAt','name','constructor','Contacts\x20being\x20imported','ERR_NO_FILE','All\x20contacts\x20have\x20been\x20deleted','writable','readFileSync','defineProperty','findAll','store','Content-Type','info','Email','stringify','body','toUpperCase','csv',',\x20Errors:\x20','keys','user','error','show','unlinkSync','ERR_GENERATING_CSV','required','test','text/csv','ERR_EMPTY_CSV','remove','string','../services/ContactServices/ShowContactService','__importStar','../services/ContactServices/DeleteContactService','isGroup','hasOwnProperty','../errors/AppError','Invalid\x20number\x20format.\x20Only\x20numbers\x20is\x20allowed.','path','910560kGeEWi','getIO','Detected\x20CSV\x20delimiter:\x20','1791282UlgpeC','__setModuleDefault','yup','emit','validate','setHeader','__esModule','Number','Error\x20deleting\x20all\x20contacts:\x20','shape','2UYRaKc','Error\x20processing\x20CSV\x20file:\x20','create','ExtraInfo','getOwnPropertyDescriptor','get','replace','importCsv','CSV\x20parsing\x20error:\x20','push','includes','(((.+)+)+)+$','../models/Contact',',\x20Success:\x20','apply','UTF-8\x20BOM\x20detected,\x20removing\x20it','Content-disposition','whatsapp','number','trim','-contact','../services/ContactServices/UpdateContactService','destroy','jid','getContact','companyId'];a13_0x13a4=function(){return _0x365b61;};return a13_0x13a4();}const a13_0x3f747d=a13_0x5592;(function(_0x7442b,_0x24ff75){const _0x51ce38=a13_0x5592,_0x40d0db=_0x7442b();while(!![]){try{const _0x4e7941=parseInt(_0x51ce38(0xd6))/0x1*(-parseInt(_0x51ce38(0x96))/0x2)+parseInt(_0x51ce38(0x89))/0x3*(parseInt(_0x51ce38(0xca))/0x4)+-parseInt(_0x51ce38(0xdc))/0x5+-parseInt(_0x51ce38(0x8c))/0x6+-parseInt(_0x51ce38(0xd9))/0x7*(parseInt(_0x51ce38(0xcd))/0x8)+parseInt(_0x51ce38(0xd7))/0x9+parseInt(_0x51ce38(0xd3))/0xa;if(_0x4e7941===_0x24ff75)break;else _0x40d0db['push'](_0x40d0db['shift']());}catch(_0x281f0d){_0x40d0db['push'](_0x40d0db['shift']());}}}(a13_0x13a4,0x798ef));var __createBinding=this&&this['__createBinding']||(Object[a13_0x3f747d(0x98)]?function(_0x34c349,_0x3864af,_0x1d4d56,_0x496198){const _0x585eda=a13_0x3f747d;if(_0x496198===undefined)_0x496198=_0x1d4d56;var _0x2caac6=Object[_0x585eda(0x9a)](_0x3864af,_0x1d4d56);(!_0x2caac6||(_0x585eda(0x9b)in _0x2caac6?!_0x3864af['__esModule']:_0x2caac6[_0x585eda(0x68)]||_0x2caac6[_0x585eda(0xc0)]))&&(_0x2caac6={'enumerable':!![],'get':function(){return _0x3864af[_0x1d4d56];}}),Object[_0x585eda(0x6a)](_0x34c349,_0x496198,_0x2caac6);}:function(_0x4e1152,_0x33d972,_0x1765f0,_0x5e1b5c){if(_0x5e1b5c===undefined)_0x5e1b5c=_0x1765f0;_0x4e1152[_0x5e1b5c]=_0x33d972[_0x1765f0];}),__setModuleDefault=this&&this[a13_0x3f747d(0x8d)]||(Object[a13_0x3f747d(0x98)]?function(_0x53017d,_0x3f1d2d){const _0xd8586a=a13_0x3f747d;Object[_0xd8586a(0x6a)](_0x53017d,_0xd8586a(0xe7),{'enumerable':!![],'value':_0x3f1d2d});}:function(_0x571282,_0x54b0e5){const _0x1d7bc3=a13_0x3f747d;_0x571282[_0x1d7bc3(0xe7)]=_0x54b0e5;}),__importStar=this&&this[a13_0x3f747d(0x82)]||(function(){const _0x2e2a19=(function(){let _0x59dceb=!![];return function(_0x4b704c,_0x3c7e36){const _0x1fbb40=_0x59dceb?function(){const _0x1e2f86=a13_0x5592;if(_0x3c7e36){const _0x4abb20=_0x3c7e36[_0x1e2f86(0xa4)](_0x4b704c,arguments);return _0x3c7e36=null,_0x4abb20;}}:function(){};return _0x59dceb=![],_0x1fbb40;};}()),_0x1de126=_0x2e2a19(this,function(){const _0x199cb3=a13_0x5592;return _0x1de126['toString']()[_0x199cb3(0xe6)](_0x199cb3(0xa1))[_0x199cb3(0xcf)]()[_0x199cb3(0xec)](_0x1de126)[_0x199cb3(0xe6)](_0x199cb3(0xa1));});_0x1de126();var _0x4c9c97=function(_0x516d20){return _0x4c9c97=Object['getOwnPropertyNames']||function(_0x3686bc){const _0x40c9e4=a13_0x5592;var _0x5242e7=[];for(var _0x3d3dfa in _0x3686bc)if(Object[_0x40c9e4(0xb7)][_0x40c9e4(0x85)]['call'](_0x3686bc,_0x3d3dfa))_0x5242e7[_0x5242e7[_0x40c9e4(0xe4)]]=_0x3d3dfa;return _0x5242e7;},_0x4c9c97(_0x516d20);};return function(_0x2962e7){const _0x41c583=a13_0x5592;if(_0x2962e7&&_0x2962e7['__esModule'])return _0x2962e7;var _0x1fea5e={};if(_0x2962e7!=null){for(var _0x2d3447=_0x4c9c97(_0x2962e7),_0x4272d1=0x0;_0x4272d1<_0x2d3447[_0x41c583(0xe4)];_0x4272d1++)if(_0x2d3447[_0x4272d1]!==_0x41c583(0xe7))__createBinding(_0x1fea5e,_0x2962e7,_0x2d3447[_0x4272d1]);}return __setModuleDefault(_0x1fea5e,_0x2962e7),_0x1fea5e;};}()),__importDefault=this&&this[a13_0x3f747d(0xe5)]||function(_0x16a018){const _0x52b8c3=a13_0x3f747d;return _0x16a018&&_0x16a018[_0x52b8c3(0x92)]?_0x16a018:{'default':_0x16a018};};Object[a13_0x3f747d(0x6a)](exports,'__esModule',{'value':!![]}),exports[a13_0x3f747d(0xde)]=exports['removeAll']=exports['importCsv']=exports[a13_0x3f747d(0xb4)]=exports[a13_0x3f747d(0x7f)]=exports[a13_0x3f747d(0xb3)]=exports[a13_0x3f747d(0x78)]=exports[a13_0x3f747d(0x6c)]=exports[a13_0x3f747d(0xae)]=exports[a13_0x3f747d(0xb9)]=void 0x0;const Yup=__importStar(require(a13_0x3f747d(0x8e))),csv_1=require(a13_0x3f747d(0x73)),fs_1=__importDefault(require('fs')),path_1=require(a13_0x3f747d(0x88)),socket_1=require('../libs/socket'),GetPublicPath_1=require(a13_0x3f747d(0xc9)),ListContactsService_1=__importDefault(require(a13_0x3f747d(0xbf))),CreateContactService_1=__importDefault(require('../services/ContactServices/CreateContactService')),ShowContactService_1=__importDefault(require(a13_0x3f747d(0x81))),UpdateContactService_1=__importDefault(require(a13_0x3f747d(0xab))),DeleteContactService_1=__importDefault(require(a13_0x3f747d(0x83))),GetContactService_1=__importDefault(require('../services/ContactServices/GetContactService')),CheckNumber_1=__importDefault(require(a13_0x3f747d(0xc8))),AppError_1=__importDefault(require(a13_0x3f747d(0x86))),SimpleListService_1=__importDefault(require('../services/ContactServices/SimpleListService')),ContactCustomField_1=__importDefault(require(a13_0x3f747d(0xd5))),logger_1=require(a13_0x3f747d(0xe0)),Contact_1=__importDefault(require(a13_0x3f747d(0xa2))),index=async(_0x2982cd,_0xf58dbe)=>{const _0x192e71=a13_0x3f747d,{searchParam:_0x113482,pageNumber:_0x4c1d62}=_0x2982cd[_0x192e71(0xdb)],{companyId:_0x15cf48}=_0x2982cd['user'],{contacts:_0x5ee325,count:_0x4b99c1,hasMore:_0xb5e7cd}=await(0x0,ListContactsService_1['default'])({'searchParam':_0x113482,'pageNumber':_0x4c1d62,'companyId':_0x15cf48});return _0xf58dbe[_0x192e71(0xda)]({'contacts':_0x5ee325,'count':_0x4b99c1,'hasMore':_0xb5e7cd});};exports['index']=index;const getContact=async(_0x1f5a68,_0x5a87ae)=>{const _0x3845c2=a13_0x3f747d,{name:_0x45ee35,number:_0x22d35c}=_0x1f5a68[_0x3845c2(0x71)],{companyId:_0x2e60bf}=_0x1f5a68[_0x3845c2(0x76)],_0x568109=await(0x0,GetContactService_1[_0x3845c2(0xe7)])({'name':_0x45ee35,'number':_0x22d35c,'companyId':_0x2e60bf});return _0x5a87ae['status'](0xc8)['json'](_0x568109);};exports[a13_0x3f747d(0xae)]=getContact;const store=async(_0x5d8048,_0x10af10)=>{const _0x1ad00a=a13_0x3f747d,{companyId:_0x58e109}=_0x5d8048[_0x1ad00a(0x76)],_0x37d44d=_0x5d8048[_0x1ad00a(0x71)];_0x37d44d[_0x1ad00a(0xa8)]=_0x37d44d[_0x1ad00a(0xa8)][_0x1ad00a(0x9c)]('-','')[_0x1ad00a(0x9c)]('\x20','');const _0x111ff4=Yup[_0x1ad00a(0xcb)]()[_0x1ad00a(0x95)]({'name':Yup['string']()['required'](),'number':Yup[_0x1ad00a(0x80)]()[_0x1ad00a(0x7b)]()[_0x1ad00a(0xdd)](/^\d+$/,_0x1ad00a(0x87))});try{await _0x111ff4[_0x1ad00a(0x90)](_0x37d44d);}catch(_0x13bdc3){throw new AppError_1[(_0x1ad00a(0xe7))](_0x13bdc3[_0x1ad00a(0xbe)]);}if(!_0x37d44d[_0x1ad00a(0x84)]){const _0x4e624f=await(0x0,CheckNumber_1[_0x1ad00a(0xe7)])(_0x37d44d['number'],_0x58e109),_0x3dea02=_0x4e624f['jid'][_0x1ad00a(0x9c)](/\D/g,'');_0x37d44d['number']=_0x3dea02;}const _0x33b140=await(0x0,CreateContactService_1['default'])({..._0x37d44d,'companyId':_0x58e109}),_0x5849de=(0x0,socket_1[_0x1ad00a(0x8a)])();return _0x5849de['to'](_0x1ad00a(0xbc)+_0x58e109+_0x1ad00a(0xb5))[_0x1ad00a(0x8f)](_0x1ad00a(0xbc)+_0x58e109+_0x1ad00a(0xaa),{'action':_0x1ad00a(0x98),'contact':_0x33b140}),_0x10af10['status'](0xc8)[_0x1ad00a(0xda)](_0x33b140);};exports[a13_0x3f747d(0x6c)]=store;const show=async(_0x59c19d,_0x511586)=>{const _0xf9c42e=a13_0x3f747d,{contactId:_0x325f01}=_0x59c19d[_0xf9c42e(0xc2)],{companyId:_0x20594d}=_0x59c19d[_0xf9c42e(0x76)],_0x1050ec=await(0x0,ShowContactService_1[_0xf9c42e(0xe7)])(_0x325f01,_0x20594d);return _0x511586['status'](0xc8)['json'](_0x1050ec);};exports[a13_0x3f747d(0x78)]=show;const update=async(_0x5475bc,_0x1f9cbe)=>{const _0x331325=a13_0x3f747d,_0x2c1485=_0x5475bc['body'],{companyId:_0x53613c}=_0x5475bc[_0x331325(0x76)],_0x29f1de=Yup[_0x331325(0xcb)]()[_0x331325(0x95)]({'name':Yup[_0x331325(0x80)](),'number':Yup['string']()[_0x331325(0xdd)](/^\d+$/,'Invalid\x20number\x20format.\x20Only\x20numbers\x20is\x20allowed.')});try{await _0x29f1de['validate'](_0x2c1485);}catch(_0x2d2b7f){throw new AppError_1[(_0x331325(0xe7))](_0x2d2b7f[_0x331325(0xbe)]);}if(!_0x2c1485[_0x331325(0x84)]){const _0xdd9258=await(0x0,CheckNumber_1['default'])(_0x2c1485[_0x331325(0xa8)],_0x53613c),_0x4e7e08=_0xdd9258[_0x331325(0xad)]['replace'](/\D/g,'');_0x2c1485[_0x331325(0xa8)]=_0x4e7e08;}const {contactId:_0x112c45}=_0x5475bc['params'],_0x18c830=await(0x0,UpdateContactService_1[_0x331325(0xe7)])({'contactData':_0x2c1485,'contactId':_0x112c45,'companyId':_0x53613c}),_0x242ecd=(0x0,socket_1[_0x331325(0x8a)])();return _0x242ecd['to'](_0x331325(0xbc)+_0x53613c+_0x331325(0xb5))[_0x331325(0x8f)](_0x331325(0xbc)+_0x53613c+'-contact',{'action':_0x331325(0xb3),'contact':_0x18c830}),_0x1f9cbe[_0x331325(0xbd)](0xc8)[_0x331325(0xda)](_0x18c830);};exports[a13_0x3f747d(0xb3)]=update;const remove=async(_0x31c2dd,_0x10c3bb)=>{const _0x1d7b66=a13_0x3f747d,{contactId:_0x1c7cb3}=_0x31c2dd['params'],{companyId:_0x3275b8}=_0x31c2dd['user'];await(0x0,ShowContactService_1[_0x1d7b66(0xe7)])(_0x1c7cb3,_0x3275b8),await(0x0,DeleteContactService_1[_0x1d7b66(0xe7)])(_0x1c7cb3);const _0x36b08a=(0x0,socket_1[_0x1d7b66(0x8a)])();return _0x36b08a['to'](_0x1d7b66(0xbc)+_0x3275b8+_0x1d7b66(0xb5))[_0x1d7b66(0x8f)]('company-'+_0x3275b8+'-contact',{'action':'delete','contactId':_0x1c7cb3}),_0x10c3bb[_0x1d7b66(0xbd)](0xc8)['json']({'message':_0x1d7b66(0xd1)});};exports[a13_0x3f747d(0x7f)]=remove;const list=async(_0x316b81,_0x5c5dd2)=>{const _0x6b875b=a13_0x3f747d,{name:_0x3aa7ff}=_0x316b81[_0x6b875b(0xdb)],{companyId:_0x35bca}=_0x316b81['user'],_0x54fdb1=await(0x0,SimpleListService_1[_0x6b875b(0xe7)])({'name':_0x3aa7ff,'companyId':_0x35bca});return _0x5c5dd2[_0x6b875b(0xda)](_0x54fdb1);};function a13_0x5592(_0x269209,_0x5a9cd5){const _0x4bec2e=a13_0x13a4();return a13_0x5592=function(_0x296d6d,_0x4b380a){_0x296d6d=_0x296d6d-0x67;let _0x13a458=_0x4bec2e[_0x296d6d];return _0x13a458;},a13_0x5592(_0x269209,_0x5a9cd5);}exports[a13_0x3f747d(0xb4)]=list;const importCsv=async(_0xb3ef31,_0x2e540a)=>{const _0x234826=a13_0x3f747d,{companyId:_0x2a570d}=_0xb3ef31[_0x234826(0x76)],{file:_0x2e6af1}=_0xb3ef31;if(!_0x2e6af1)throw new AppError_1[(_0x234826(0xe7))](_0x234826(0xee),0x190);let _0x50eac8=',';try{let _0x2ab748=fs_1[_0x234826(0xe7)][_0x234826(0x69)](_0x2e6af1[_0x234826(0x88)],{'encoding':_0x234826(0xc6)});_0x2ab748[_0x234826(0xea)](0x0)===0xfeff&&(logger_1[_0x234826(0xb6)][_0x234826(0x6e)](_0x234826(0xa5)),_0x2ab748=_0x2ab748['substring'](0x1),fs_1['default']['writeFileSync'](_0x2e6af1[_0x234826(0x88)],_0x2ab748,{'encoding':'utf8'}));const _0xad0655=_0x2ab748['split']('\x0a')[0x0];if(_0xad0655[_0x234826(0xa0)](';'))_0x50eac8=';';else _0xad0655['includes']('\x09')&&(_0x50eac8='\x09');logger_1[_0x234826(0xb6)][_0x234826(0x6e)](_0x234826(0x8b)+_0x50eac8);}catch(_0x184e13){logger_1[_0x234826(0xb6)][_0x234826(0x77)](_0x234826(0x97)+_0x184e13[_0x234826(0xbe)]);}const _0x21fb9f=(0x0,csv_1[_0x234826(0xe1)])({'delimiter':_0x50eac8,'columns':!![],'trim':!![],'relaxColumnCount':!![]},async(_0x73ac37,_0xb3745a)=>{const _0x1d2285=_0x234826;if(_0x73ac37){logger_1[_0x1d2285(0xb6)][_0x1d2285(0x77)](_0x1d2285(0x9e)+_0x73ac37['message']);throw new AppError_1[(_0x1d2285(0xe7))]('ERR_INVALID_CSV',0x190);}if(!_0xb3745a||_0xb3745a[_0x1d2285(0xe4)]===0x0){logger_1[_0x1d2285(0xb6)]['error'](_0x1d2285(0xb2));throw new AppError_1[(_0x1d2285(0xe7))](_0x1d2285(0x7e),0x190);}_0xb3745a[_0x1d2285(0xe9)](async _0x3ca6f6=>{const _0x5ba3d8=_0x1d2285;_0x439e8f++;let _0x5aeb6e;try{_0x5aeb6e=JSON[_0x5ba3d8(0xe1)](_0x3ca6f6[_0x5ba3d8(0x99)]);}catch(_0x240ebe){_0x5aeb6e=[];}let _0x4912b0=_0x3ca6f6[_0x5ba3d8(0xa8)]||_0x3ca6f6[_0x5ba3d8(0x93)];if(!_0x4912b0){logger_1[_0x5ba3d8(0xb6)][_0x5ba3d8(0x77)](_0x5ba3d8(0xce)+JSON['stringify'](_0x3ca6f6));return;}_0x4912b0=String(_0x4912b0)[_0x5ba3d8(0xa9)]();if(_0x4912b0[_0x5ba3d8(0x72)]()[_0x5ba3d8(0xa0)]('E+')||/^\d+([.,]\d+)?[eE][+-]?\d+$/[_0x5ba3d8(0x7c)](_0x4912b0))try{const _0x587e6e=_0x4912b0['replace'](',','.');_0x4912b0=parseFloat(_0x587e6e)[_0x5ba3d8(0xcf)]();}catch(_0x2abbbd){logger_1[_0x5ba3d8(0xb6)][_0x5ba3d8(0x77)]('Error\x20converting\x20scientific\x20notation:\x20'+_0x4912b0);}_0x4912b0=_0x4912b0['replace'](/\D/g,'');if(!_0x4912b0||_0x4912b0['length']<0x8){logger_1[_0x5ba3d8(0xb6)][_0x5ba3d8(0x77)](_0x5ba3d8(0xba)+_0x4912b0);return;}const _0x736f73={'companyId':_0x2a570d,'name':_0x3ca6f6['name']||_0x3ca6f6[_0x5ba3d8(0xd0)],'number':_0x4912b0,'email':_0x3ca6f6[_0x5ba3d8(0xd8)]||_0x3ca6f6[_0x5ba3d8(0x6f)],'extraInfo':_0x5aeb6e};Object[_0x5ba3d8(0x75)](_0x3ca6f6)['forEach'](_0x1a88b0=>{const _0x4048b3=_0x5ba3d8;_0x1a88b0!==_0x4048b3(0xeb)&&_0x1a88b0!==_0x4048b3(0xa8)&&_0x1a88b0!==_0x4048b3(0xd8)&&_0x1a88b0!==_0x4048b3(0xd0)&&_0x1a88b0!==_0x4048b3(0x93)&&_0x1a88b0!=='Email'&&_0x1a88b0!==_0x4048b3(0x99)&&_0x3ca6f6[_0x1a88b0]&&_0x736f73[_0x4048b3(0xe8)][_0x4048b3(0x9f)]({'name':_0x1a88b0,'value':_0x3ca6f6[_0x1a88b0]});});try{const _0x4fb4a5=await(0x0,CreateContactService_1['default'])(_0x736f73);_0x51bd54++,logger_1[_0x5ba3d8(0xb6)][_0x5ba3d8(0xb8)](_0x5ba3d8(0xe2)+_0x736f73[_0x5ba3d8(0xeb)]+_0x5ba3d8(0xc5)+_0x736f73[_0x5ba3d8(0xa8)]);const _0x9fc548=(0x0,socket_1['getIO'])();_0x9fc548['to'](_0x5ba3d8(0xbc)+_0x2a570d+_0x5ba3d8(0xb5))[_0x5ba3d8(0x8f)]('company-'+_0x2a570d+_0x5ba3d8(0xaa),{'action':_0x5ba3d8(0xb3),'contact':_0x4fb4a5});}catch(_0x4f521e){_0x1f356b++,logger_1[_0x5ba3d8(0xb6)]['error']({'contact':_0x736f73},'Error\x20creating\x20contact:\x20'+_0x4f521e['message']);}});}),_0x343327=fs_1[_0x234826(0xe7)][_0x234826(0xc7)](_0x2e6af1[_0x234826(0x88)]);let _0x439e8f=0x0,_0x51bd54=0x0,_0x1f356b=0x0;return _0x21fb9f['on']('end',()=>{const _0x5dcefe=_0x234826;_0x343327[_0x5dcefe(0xac)](),fs_1[_0x5dcefe(0xe7)][_0x5dcefe(0x79)](_0x2e6af1[_0x5dcefe(0x88)]),logger_1[_0x5dcefe(0xb6)][_0x5dcefe(0x6e)](_0x5dcefe(0xe3)+_0x439e8f+_0x5dcefe(0xa3)+_0x51bd54+_0x5dcefe(0x74)+_0x1f356b);}),_0x343327[_0x234826(0xd2)](_0x21fb9f),_0x2e540a['status'](0xc8)['json']({'message':_0x234826(0xed)});};exports[a13_0x3f747d(0x9d)]=importCsv;const removeAll=async(_0x30bac7,_0xd08915)=>{const _0x2aaf2f=a13_0x3f747d,{companyId:_0x11e42f}=_0x30bac7[_0x2aaf2f(0x76)];try{const _0x27a391=await Contact_1[_0x2aaf2f(0xe7)][_0x2aaf2f(0x6b)]({'where':{'companyId':_0x11e42f}});for(const _0x1bb8c0 of _0x27a391){const _0x3a690b=(0x0,path_1['join'])((0x0,GetPublicPath_1[_0x2aaf2f(0xb1)])(),_0x2aaf2f(0xc3),_0x1bb8c0[_0x2aaf2f(0xaf)]+'/'+_0x1bb8c0['id']);fs_1[_0x2aaf2f(0xe7)]['rmSync'](_0x3a690b,{'recursive':!![],'force':!![]});}await Contact_1[_0x2aaf2f(0xe7)][_0x2aaf2f(0xac)]({'where':{'companyId':_0x11e42f}});const _0x18c3a3=(0x0,socket_1[_0x2aaf2f(0x8a)])();return _0x18c3a3['to'](_0x2aaf2f(0xbc)+_0x11e42f+_0x2aaf2f(0xb5))[_0x2aaf2f(0x8f)](_0x2aaf2f(0xbc)+_0x11e42f+_0x2aaf2f(0xaa),{'action':_0x2aaf2f(0xc4)}),_0xd08915[_0x2aaf2f(0xbd)](0xc8)['json']({'message':_0x2aaf2f(0x67)});}catch(_0x409734){logger_1[_0x2aaf2f(0xb6)][_0x2aaf2f(0x77)]({'companyId':_0x11e42f},_0x2aaf2f(0x94)+_0x409734['message']);throw new AppError_1[(_0x2aaf2f(0xe7))]('ERR_DELETING_CONTACTS',0x1f4);}};exports[a13_0x3f747d(0xbb)]=removeAll;const exportCsv=async(_0x5f5793,_0xdf0e4d)=>{const _0xf5746c=a13_0x3f747d,{companyId:_0x429bed}=_0x5f5793[_0xf5746c(0x76)],_0x34c727=await Contact_1[_0xf5746c(0xe7)][_0xf5746c(0x6b)]({'where':{'companyId':_0x429bed,'channel':_0xf5746c(0xa7),'isGroup':![]},'include':[{'model':ContactCustomField_1[_0xf5746c(0xe7)],'as':_0xf5746c(0xe8)}]}),_0x461766=_0x34c727[_0xf5746c(0xb0)](_0x30cba5=>{const _0x1648cd=_0xf5746c,_0x3287e6=_0x30cba5[_0x1648cd(0xe8)][_0x1648cd(0xb0)](_0x1d8dd3=>({'name':_0x1d8dd3[_0x1648cd(0xeb)],'value':_0x1d8dd3[_0x1648cd(0xcc)]}));return{'Name':_0x30cba5['name'],'Number':_0x30cba5[_0x1648cd(0xa8)],'Email':_0x30cba5[_0x1648cd(0xd8)]||'','ExtraInfo':JSON[_0x1648cd(0x70)](_0x3287e6)};});return(0x0,csv_1['stringify'])(_0x461766,{'header':!![]},(_0x576206,_0x185210)=>{const _0x26a1de=_0xf5746c;if(_0x576206)throw new AppError_1[(_0x26a1de(0xe7))](_0x26a1de(0x7a),0x1f4);_0xdf0e4d[_0x26a1de(0x91)](_0x26a1de(0xa6),_0x26a1de(0xdf)),_0xdf0e4d[_0x26a1de(0xd4)](_0x26a1de(0x6d),_0x26a1de(0x7d)),_0xdf0e4d['status'](0xc8)[_0x26a1de(0xc1)](_0x185210);}),_0xdf0e4d;};exports[a13_0x3f747d(0xde)]=exportCsv;