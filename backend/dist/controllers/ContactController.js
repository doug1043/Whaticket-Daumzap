'use strict';const a16_0x435775=a16_0x3a05;function a16_0x3a05(_0x15e1b5,_0x3cd004){const _0x53f339=a16_0x177c();return a16_0x3a05=function(_0x592dbf,_0x7c0f41){_0x592dbf=_0x592dbf-0x1e1;let _0x177c64=_0x53f339[_0x592dbf];return _0x177c64;},a16_0x3a05(_0x15e1b5,_0x3cd004);}(function(_0x5d18c9,_0x554394){const _0x31db17=a16_0x3a05,_0xb0cd3d=_0x5d18c9();while(!![]){try{const _0x2a5377=parseInt(_0x31db17(0x251))/0x1*(parseInt(_0x31db17(0x245))/0x2)+parseInt(_0x31db17(0x257))/0x3+-parseInt(_0x31db17(0x207))/0x4*(parseInt(_0x31db17(0x249))/0x5)+parseInt(_0x31db17(0x24d))/0x6*(-parseInt(_0x31db17(0x224))/0x7)+parseInt(_0x31db17(0x1f7))/0x8*(parseInt(_0x31db17(0x20c))/0x9)+-parseInt(_0x31db17(0x21f))/0xa+-parseInt(_0x31db17(0x247))/0xb*(-parseInt(_0x31db17(0x21a))/0xc);if(_0x2a5377===_0x554394)break;else _0xb0cd3d['push'](_0xb0cd3d['shift']());}catch(_0x152c6e){_0xb0cd3d['push'](_0xb0cd3d['shift']());}}}(a16_0x177c,0x50ca8));function a16_0x177c(){const _0x4e7fd5=['company-','Detected\x20CSV\x20delimiter:\x20','Error\x20processing\x20CSV\x20file:\x20','../services/ContactServices/GetContactService','__importStar','replace','body','error','UTF-8\x20BOM\x20detected,\x20removing\x20it','index','unlinkSync','csv',',\x20Errors:\x20','56yNfDKV','get','../services/WbotServices/CheckNumber','delete-all','setHeader','9NwZWYv','extraInfo','length','jid','search','importCsv','list','name','getContact','emit','../helpers/GetPublicPath','../services/ContactServices/UpdateContactService','(((.+)+)+)+$','send','132wAWujr','set','getIO','../services/ContactServices/CreateContactService','parse','5858950yXcYOV','logger','required','Content-Type','validate','424522VUMnDK','ERR_INVALID_CSV','../services/ContactServices/DeleteContactService','rmSync','Invalid\x20number\x20format.\x20Only\x20numbers\x20is\x20allowed.','Contact\x20created\x20successfully:\x20','number','message','../services/ContactServices/SimpleListService','split','params','update','prototype','constructor','companyId','ExtraInfo','Contact\x20deleted','stringify','Email','end','keys','-contact','ERR_GENERATING_CSV','../libs/socket','Name','__importDefault','-mainchannel','toUpperCase','shape','attachment;\x20filename=contacts.csv','isGroup','All\x20contacts\x20have\x20been\x20deleted','ERR_NO_FILE','18BemeAt','yup','918962CBiKEy','substring','167095bdsYyq','create','configurable','Number','42ORVLCP','default','trim','utf8','53763VgSkXg','email','getOwnPropertyNames','join','__esModule','\x20-\x20','431208CQKxXl','Contacts\x20being\x20imported','ERR_EMPTY_CSV','../models/Contact','Invalid\x20phone\x20number\x20after\x20cleaning:\x20','defineProperty','remove','call','../errors/AppError','user','whatsapp','findAll','__createBinding','status','apply','getPublicPath','__setModuleDefault','forEach','json','includes','string','store','Error\x20converting\x20scientific\x20notation:\x20','destroy','readFileSync',',\x20Success:\x20','info','test','../services/ContactServices/ShowContactService','show','path','CSV\x20parsing\x20error:\x20','toString','matches','debug','2101104IwATIn','CSV\x20file\x20is\x20empty\x20or\x20invalid','Missing\x20phone\x20number\x20in\x20record:\x20'];a16_0x177c=function(){return _0x4e7fd5;};return a16_0x177c();}var __createBinding=this&&this[a16_0x435775(0x263)]||(Object[a16_0x435775(0x24a)]?function(_0x31f95c,_0x4f0d21,_0xbf408c,_0x2eeeaa){const _0x3c0714=a16_0x435775;if(_0x2eeeaa===undefined)_0x2eeeaa=_0xbf408c;var _0x1a0372=Object['getOwnPropertyDescriptor'](_0x4f0d21,_0xbf408c);(!_0x1a0372||(_0x3c0714(0x208)in _0x1a0372?!_0x4f0d21[_0x3c0714(0x255)]:_0x1a0372['writable']||_0x1a0372[_0x3c0714(0x24b)]))&&(_0x1a0372={'enumerable':!![],'get':function(){return _0x4f0d21[_0xbf408c];}}),Object[_0x3c0714(0x25c)](_0x31f95c,_0x2eeeaa,_0x1a0372);}:function(_0x39f002,_0x52c6eb,_0x5205de,_0x3a9c0e){if(_0x3a9c0e===undefined)_0x3a9c0e=_0x5205de;_0x39f002[_0x3a9c0e]=_0x52c6eb[_0x5205de];}),__setModuleDefault=this&&this[a16_0x435775(0x1e4)]||(Object['create']?function(_0x637e83,_0x309904){const _0xc777ef=a16_0x435775;Object[_0xc777ef(0x25c)](_0x637e83,_0xc777ef(0x24e),{'enumerable':!![],'value':_0x309904});}:function(_0x5048ef,_0x58970c){const _0x561424=a16_0x435775;_0x5048ef[_0x561424(0x24e)]=_0x58970c;}),__importStar=this&&this[a16_0x435775(0x1fe)]||(function(){const _0x58d345=(function(){let _0xe816ac=!![];return function(_0x3aeec9,_0x2b61b8){const _0x38d025=_0xe816ac?function(){const _0x82caa4=a16_0x3a05;if(_0x2b61b8){const _0x1c26f1=_0x2b61b8[_0x82caa4(0x1e2)](_0x3aeec9,arguments);return _0x2b61b8=null,_0x1c26f1;}}:function(){};return _0xe816ac=![],_0x38d025;};}()),_0x3fab89=_0x58d345(this,function(){const _0x21bc46=a16_0x3a05;return _0x3fab89[_0x21bc46(0x1f4)]()[_0x21bc46(0x210)](_0x21bc46(0x218))[_0x21bc46(0x1f4)]()[_0x21bc46(0x231)](_0x3fab89)['search'](_0x21bc46(0x218));});_0x3fab89();var _0x2480ee=function(_0x288b10){const _0x1db62f=a16_0x3a05;return _0x2480ee=Object[_0x1db62f(0x253)]||function(_0x4fcfcb){const _0x498177=_0x1db62f;var _0x32bc97=[];for(var _0x40c45d in _0x4fcfcb)if(Object[_0x498177(0x230)]['hasOwnProperty'][_0x498177(0x25e)](_0x4fcfcb,_0x40c45d))_0x32bc97[_0x32bc97['length']]=_0x40c45d;return _0x32bc97;},_0x2480ee(_0x288b10);};return function(_0x34e551){const _0x5bc5fa=a16_0x3a05;if(_0x34e551&&_0x34e551[_0x5bc5fa(0x255)])return _0x34e551;var _0xaaae6a={};if(_0x34e551!=null){for(var _0x535dcf=_0x2480ee(_0x34e551),_0x161ce9=0x0;_0x161ce9<_0x535dcf[_0x5bc5fa(0x20e)];_0x161ce9++)if(_0x535dcf[_0x161ce9]!=='default')__createBinding(_0xaaae6a,_0x34e551,_0x535dcf[_0x161ce9]);}return __setModuleDefault(_0xaaae6a,_0x34e551),_0xaaae6a;};}()),__importDefault=this&&this[a16_0x435775(0x23d)]||function(_0x10eb23){const _0x6d6c74=a16_0x435775;return _0x10eb23&&_0x10eb23[_0x6d6c74(0x255)]?_0x10eb23:{'default':_0x10eb23};};Object['defineProperty'](exports,'__esModule',{'value':!![]}),exports['exportCsv']=exports['removeAll']=exports[a16_0x435775(0x211)]=exports['list']=exports[a16_0x435775(0x25d)]=exports['update']=exports[a16_0x435775(0x1f1)]=exports['store']=exports[a16_0x435775(0x214)]=exports[a16_0x435775(0x203)]=void 0x0;const Yup=__importStar(require(a16_0x435775(0x246))),csv_1=require(a16_0x435775(0x205)),fs_1=__importDefault(require('fs')),path_1=require(a16_0x435775(0x1f2)),socket_1=require(a16_0x435775(0x23b)),GetPublicPath_1=require(a16_0x435775(0x216)),ListContactsService_1=__importDefault(require('../services/ContactServices/ListContactsService')),CreateContactService_1=__importDefault(require(a16_0x435775(0x21d))),ShowContactService_1=__importDefault(require(a16_0x435775(0x1f0))),UpdateContactService_1=__importDefault(require(a16_0x435775(0x217))),DeleteContactService_1=__importDefault(require(a16_0x435775(0x226))),GetContactService_1=__importDefault(require(a16_0x435775(0x1fd))),CheckNumber_1=__importDefault(require(a16_0x435775(0x209))),AppError_1=__importDefault(require(a16_0x435775(0x25f))),SimpleListService_1=__importDefault(require(a16_0x435775(0x22c))),ContactCustomField_1=__importDefault(require('../models/ContactCustomField')),logger_1=require('../utils/logger'),Contact_1=__importDefault(require(a16_0x435775(0x25a))),index=async(_0x4d399a,_0x3f3fc5)=>{const _0x21e05e=a16_0x435775,{searchParam:_0x2af53d,pageNumber:_0x3f3db4}=_0x4d399a['query'],{companyId:_0x1056e1}=_0x4d399a[_0x21e05e(0x260)],{contacts:_0x34263f,count:_0x5b6334,hasMore:_0x17d7cd}=await(0x0,ListContactsService_1[_0x21e05e(0x24e)])({'searchParam':_0x2af53d,'pageNumber':_0x3f3db4,'companyId':_0x1056e1});return _0x3f3fc5[_0x21e05e(0x1e6)]({'contacts':_0x34263f,'count':_0x5b6334,'hasMore':_0x17d7cd});};exports[a16_0x435775(0x203)]=index;const getContact=async(_0x543f44,_0x1049e7)=>{const _0x6ffd8c=a16_0x435775,{name:_0x1871df,number:_0x1f7d44}=_0x543f44[_0x6ffd8c(0x200)],{companyId:_0x3e18ac}=_0x543f44[_0x6ffd8c(0x260)],_0x4753da=await(0x0,GetContactService_1[_0x6ffd8c(0x24e)])({'name':_0x1871df,'number':_0x1f7d44,'companyId':_0x3e18ac});return _0x1049e7[_0x6ffd8c(0x1e1)](0xc8)[_0x6ffd8c(0x1e6)](_0x4753da);};exports[a16_0x435775(0x214)]=getContact;const store=async(_0x567ebc,_0x5c03b3)=>{const _0x41c4c5=a16_0x435775,{companyId:_0xcf1f97}=_0x567ebc[_0x41c4c5(0x260)],_0x4fc900=_0x567ebc[_0x41c4c5(0x200)];_0x4fc900[_0x41c4c5(0x22a)]=_0x4fc900['number'][_0x41c4c5(0x1ff)]('-','')[_0x41c4c5(0x1ff)]('\x20','');const _0xc008b1=Yup['object']()['shape']({'name':Yup[_0x41c4c5(0x1e8)]()['required'](),'number':Yup['string']()[_0x41c4c5(0x221)]()[_0x41c4c5(0x1f5)](/^\d+$/,_0x41c4c5(0x228))});try{await _0xc008b1[_0x41c4c5(0x223)](_0x4fc900);}catch(_0x5cf8eb){throw new AppError_1[(_0x41c4c5(0x24e))](_0x5cf8eb[_0x41c4c5(0x22b)]);}if(!_0x4fc900['isGroup']){const _0x1a8093=await(0x0,CheckNumber_1[_0x41c4c5(0x24e)])(_0x4fc900[_0x41c4c5(0x22a)],_0xcf1f97),_0x37fe2b=_0x1a8093['jid'][_0x41c4c5(0x1ff)](/\D/g,'');_0x4fc900['number']=_0x37fe2b;}const _0x39ee75=await(0x0,CreateContactService_1[_0x41c4c5(0x24e)])({..._0x4fc900,'companyId':_0xcf1f97}),_0x5545a6=(0x0,socket_1[_0x41c4c5(0x21c)])();return _0x5545a6['to'](_0x41c4c5(0x1fa)+_0xcf1f97+_0x41c4c5(0x23e))['emit'](_0x41c4c5(0x1fa)+_0xcf1f97+'-contact',{'action':_0x41c4c5(0x24a),'contact':_0x39ee75}),_0x5c03b3[_0x41c4c5(0x1e1)](0xc8)['json'](_0x39ee75);};exports[a16_0x435775(0x1e9)]=store;const show=async(_0x1a34f5,_0x25be09)=>{const _0x48cf73=a16_0x435775,{contactId:_0x347a34}=_0x1a34f5[_0x48cf73(0x22e)],{companyId:_0x38627e}=_0x1a34f5['user'],_0x2be574=await(0x0,ShowContactService_1['default'])(_0x347a34,_0x38627e);return _0x25be09[_0x48cf73(0x1e1)](0xc8)[_0x48cf73(0x1e6)](_0x2be574);};exports['show']=show;const update=async(_0x580ee1,_0x6cb54f)=>{const _0x4cef47=a16_0x435775,_0x37e989=_0x580ee1[_0x4cef47(0x200)],{companyId:_0x1b9559}=_0x580ee1[_0x4cef47(0x260)],_0x576198=Yup['object']()[_0x4cef47(0x240)]({'name':Yup[_0x4cef47(0x1e8)](),'number':Yup['string']()[_0x4cef47(0x1f5)](/^\d+$/,_0x4cef47(0x228))});try{await _0x576198[_0x4cef47(0x223)](_0x37e989);}catch(_0xab71c9){throw new AppError_1['default'](_0xab71c9[_0x4cef47(0x22b)]);}if(!_0x37e989[_0x4cef47(0x242)]){const _0x18cb4a=await(0x0,CheckNumber_1['default'])(_0x37e989[_0x4cef47(0x22a)],_0x1b9559),_0x32722c=_0x18cb4a[_0x4cef47(0x20f)]['replace'](/\D/g,'');_0x37e989['number']=_0x32722c;}const {contactId:_0x161232}=_0x580ee1[_0x4cef47(0x22e)],_0x2dc313=await(0x0,UpdateContactService_1[_0x4cef47(0x24e)])({'contactData':_0x37e989,'contactId':_0x161232,'companyId':_0x1b9559}),_0x201278=(0x0,socket_1[_0x4cef47(0x21c)])();return _0x201278['to'](_0x4cef47(0x1fa)+_0x1b9559+_0x4cef47(0x23e))[_0x4cef47(0x215)](_0x4cef47(0x1fa)+_0x1b9559+'-contact',{'action':_0x4cef47(0x22f),'contact':_0x2dc313}),_0x6cb54f[_0x4cef47(0x1e1)](0xc8)['json'](_0x2dc313);};exports[a16_0x435775(0x22f)]=update;const remove=async(_0x25ded6,_0x297117)=>{const _0x386f78=a16_0x435775,{contactId:_0x1a9752}=_0x25ded6['params'],{companyId:_0x19d815}=_0x25ded6[_0x386f78(0x260)];await(0x0,ShowContactService_1[_0x386f78(0x24e)])(_0x1a9752,_0x19d815),await(0x0,DeleteContactService_1[_0x386f78(0x24e)])(_0x1a9752);const _0x1eda5d=(0x0,socket_1[_0x386f78(0x21c)])();return _0x1eda5d['to']('company-'+_0x19d815+_0x386f78(0x23e))[_0x386f78(0x215)](_0x386f78(0x1fa)+_0x19d815+_0x386f78(0x239),{'action':'delete','contactId':_0x1a9752}),_0x297117[_0x386f78(0x1e1)](0xc8)[_0x386f78(0x1e6)]({'message':_0x386f78(0x234)});};exports['remove']=remove;const list=async(_0x2989d7,_0x249e05)=>{const _0xe7efc4=a16_0x435775,{name:_0x23120c}=_0x2989d7['query'],{companyId:_0x54478e}=_0x2989d7['user'],_0x1fcb54=await(0x0,SimpleListService_1[_0xe7efc4(0x24e)])({'name':_0x23120c,'companyId':_0x54478e});return _0x249e05[_0xe7efc4(0x1e6)](_0x1fcb54);};exports[a16_0x435775(0x212)]=list;const importCsv=async(_0xde952,_0x150e16)=>{const _0x11ca00=a16_0x435775,{companyId:_0xcea759}=_0xde952[_0x11ca00(0x260)],{file:_0x2afd77}=_0xde952;if(!_0x2afd77)throw new AppError_1[(_0x11ca00(0x24e))](_0x11ca00(0x244),0x190);let _0x4b18f2=',';try{let _0x32ea19=fs_1[_0x11ca00(0x24e)][_0x11ca00(0x1ec)](_0x2afd77[_0x11ca00(0x1f2)],{'encoding':_0x11ca00(0x250)});_0x32ea19['charCodeAt'](0x0)===0xfeff&&(logger_1[_0x11ca00(0x220)][_0x11ca00(0x1ee)](_0x11ca00(0x202)),_0x32ea19=_0x32ea19[_0x11ca00(0x248)](0x1),fs_1[_0x11ca00(0x24e)]['writeFileSync'](_0x2afd77['path'],_0x32ea19,{'encoding':_0x11ca00(0x250)}));const _0x11bc3d=_0x32ea19[_0x11ca00(0x22d)]('\x0a')[0x0];if(_0x11bc3d[_0x11ca00(0x1e7)](';'))_0x4b18f2=';';else _0x11bc3d[_0x11ca00(0x1e7)]('\x09')&&(_0x4b18f2='\x09');logger_1['logger'][_0x11ca00(0x1ee)](_0x11ca00(0x1fb)+_0x4b18f2);}catch(_0x17a40c){logger_1['logger'][_0x11ca00(0x201)](_0x11ca00(0x1fc)+_0x17a40c[_0x11ca00(0x22b)]);}const _0x5e2eff=(0x0,csv_1[_0x11ca00(0x21e)])({'delimiter':_0x4b18f2,'columns':!![],'trim':!![],'relaxColumnCount':!![]},async(_0x2581f8,_0xc128fa)=>{const _0x37b986=_0x11ca00;if(_0x2581f8){logger_1[_0x37b986(0x220)]['error'](_0x37b986(0x1f3)+_0x2581f8[_0x37b986(0x22b)]);throw new AppError_1[(_0x37b986(0x24e))](_0x37b986(0x225),0x190);}if(!_0xc128fa||_0xc128fa[_0x37b986(0x20e)]===0x0){logger_1[_0x37b986(0x220)][_0x37b986(0x201)](_0x37b986(0x1f8));throw new AppError_1[(_0x37b986(0x24e))](_0x37b986(0x259),0x190);}_0xc128fa['forEach'](async _0x482bd9=>{const _0x1b4f08=_0x37b986;_0x4dd2de++;let _0x3ef9c6;try{_0x3ef9c6=JSON['parse'](_0x482bd9[_0x1b4f08(0x233)]);}catch(_0x38a833){_0x3ef9c6=[];}let _0xa1032b=_0x482bd9[_0x1b4f08(0x22a)]||_0x482bd9[_0x1b4f08(0x24c)];if(!_0xa1032b){logger_1[_0x1b4f08(0x220)][_0x1b4f08(0x201)](_0x1b4f08(0x1f9)+JSON['stringify'](_0x482bd9));return;}_0xa1032b=String(_0xa1032b)[_0x1b4f08(0x24f)]();if(_0xa1032b[_0x1b4f08(0x23f)]()[_0x1b4f08(0x1e7)]('E+')||/^\d+([.,]\d+)?[eE][+-]?\d+$/[_0x1b4f08(0x1ef)](_0xa1032b))try{const _0x1a9c95=_0xa1032b[_0x1b4f08(0x1ff)](',','.');_0xa1032b=parseFloat(_0x1a9c95)[_0x1b4f08(0x1f4)]();}catch(_0x2948ed){logger_1[_0x1b4f08(0x220)][_0x1b4f08(0x201)](_0x1b4f08(0x1ea)+_0xa1032b);}_0xa1032b=_0xa1032b[_0x1b4f08(0x1ff)](/\D/g,'');if(!_0xa1032b||_0xa1032b[_0x1b4f08(0x20e)]<0x8){logger_1[_0x1b4f08(0x220)][_0x1b4f08(0x201)](_0x1b4f08(0x25b)+_0xa1032b);return;}const _0x262593={'companyId':_0xcea759,'name':_0x482bd9[_0x1b4f08(0x213)]||_0x482bd9['Name'],'number':_0xa1032b,'email':_0x482bd9[_0x1b4f08(0x252)]||_0x482bd9[_0x1b4f08(0x236)],'extraInfo':_0x3ef9c6};Object[_0x1b4f08(0x238)](_0x482bd9)[_0x1b4f08(0x1e5)](_0x30089c=>{const _0x2116d1=_0x1b4f08;_0x30089c!==_0x2116d1(0x213)&&_0x30089c!==_0x2116d1(0x22a)&&_0x30089c!=='email'&&_0x30089c!==_0x2116d1(0x23c)&&_0x30089c!==_0x2116d1(0x24c)&&_0x30089c!=='Email'&&_0x30089c!==_0x2116d1(0x233)&&_0x482bd9[_0x30089c]&&_0x262593[_0x2116d1(0x20d)]['push']({'name':_0x30089c,'value':_0x482bd9[_0x30089c]});});try{const _0x3d784a=await(0x0,CreateContactService_1[_0x1b4f08(0x24e)])(_0x262593);_0x3aa6bc++,logger_1[_0x1b4f08(0x220)][_0x1b4f08(0x1f6)](_0x1b4f08(0x229)+_0x262593['name']+_0x1b4f08(0x256)+_0x262593[_0x1b4f08(0x22a)]);const _0x474efe=(0x0,socket_1[_0x1b4f08(0x21c)])();_0x474efe['to'](_0x1b4f08(0x1fa)+_0xcea759+_0x1b4f08(0x23e))[_0x1b4f08(0x215)](_0x1b4f08(0x1fa)+_0xcea759+_0x1b4f08(0x239),{'action':'update','contact':_0x3d784a});}catch(_0x28e8d6){_0x1da2ab++,logger_1[_0x1b4f08(0x220)]['error']({'contact':_0x262593},'Error\x20creating\x20contact:\x20'+_0x28e8d6['message']);}});}),_0x341fbf=fs_1[_0x11ca00(0x24e)]['createReadStream'](_0x2afd77[_0x11ca00(0x1f2)]);let _0x4dd2de=0x0,_0x3aa6bc=0x0,_0x1da2ab=0x0;return _0x5e2eff['on'](_0x11ca00(0x237),()=>{const _0x228d2f=_0x11ca00;_0x341fbf[_0x228d2f(0x1eb)](),fs_1[_0x228d2f(0x24e)][_0x228d2f(0x204)](_0x2afd77[_0x228d2f(0x1f2)]),logger_1[_0x228d2f(0x220)]['info']('CSV\x20import\x20finished.\x20Processed:\x20'+_0x4dd2de+_0x228d2f(0x1ed)+_0x3aa6bc+_0x228d2f(0x206)+_0x1da2ab);}),_0x341fbf['pipe'](_0x5e2eff),_0x150e16[_0x11ca00(0x1e1)](0xc8)[_0x11ca00(0x1e6)]({'message':_0x11ca00(0x258)});};exports[a16_0x435775(0x211)]=importCsv;const removeAll=async(_0x1758a3,_0x1c3ca6)=>{const _0x2753f4=a16_0x435775,{companyId:_0x54151e}=_0x1758a3[_0x2753f4(0x260)];try{const _0x9ccc2c=await Contact_1[_0x2753f4(0x24e)][_0x2753f4(0x262)]({'where':{'companyId':_0x54151e}});for(const _0x4ce3d5 of _0x9ccc2c){const _0x27ab28=(0x0,path_1[_0x2753f4(0x254)])((0x0,GetPublicPath_1[_0x2753f4(0x1e3)])(),'media',_0x4ce3d5[_0x2753f4(0x232)]+'/'+_0x4ce3d5['id']);fs_1['default'][_0x2753f4(0x227)](_0x27ab28,{'recursive':!![],'force':!![]});}await Contact_1[_0x2753f4(0x24e)][_0x2753f4(0x1eb)]({'where':{'companyId':_0x54151e}});const _0x1239d8=(0x0,socket_1[_0x2753f4(0x21c)])();return _0x1239d8['to']('company-'+_0x54151e+_0x2753f4(0x23e))['emit'](_0x2753f4(0x1fa)+_0x54151e+_0x2753f4(0x239),{'action':_0x2753f4(0x20a)}),_0x1c3ca6['status'](0xc8)[_0x2753f4(0x1e6)]({'message':_0x2753f4(0x243)});}catch(_0x21aff2){logger_1['logger'][_0x2753f4(0x201)]({'companyId':_0x54151e},'Error\x20deleting\x20all\x20contacts:\x20'+_0x21aff2['message']);throw new AppError_1['default']('ERR_DELETING_CONTACTS',0x1f4);}};exports['removeAll']=removeAll;const exportCsv=async(_0x557b01,_0x2d75e5)=>{const _0x31541f=a16_0x435775,{companyId:_0x7bc4a3}=_0x557b01[_0x31541f(0x260)],_0x138a78=await Contact_1[_0x31541f(0x24e)][_0x31541f(0x262)]({'where':{'companyId':_0x7bc4a3,'channel':_0x31541f(0x261),'isGroup':![]},'include':[{'model':ContactCustomField_1['default'],'as':_0x31541f(0x20d)}]}),_0x2ef6b9=_0x138a78['map'](_0x2032fb=>{const _0x2fd488=_0x31541f,_0x4c7b28=_0x2032fb[_0x2fd488(0x20d)]['map'](_0x22058f=>({'name':_0x22058f[_0x2fd488(0x213)],'value':_0x22058f['value']}));return{'Name':_0x2032fb[_0x2fd488(0x213)],'Number':_0x2032fb[_0x2fd488(0x22a)],'Email':_0x2032fb[_0x2fd488(0x252)]||'','ExtraInfo':JSON[_0x2fd488(0x235)](_0x4c7b28)};});return(0x0,csv_1[_0x31541f(0x235)])(_0x2ef6b9,{'header':!![]},(_0x48ff64,_0x430f69)=>{const _0x3897fd=_0x31541f;if(_0x48ff64)throw new AppError_1[(_0x3897fd(0x24e))](_0x3897fd(0x23a),0x1f4);_0x2d75e5[_0x3897fd(0x20b)]('Content-disposition',_0x3897fd(0x241)),_0x2d75e5[_0x3897fd(0x21b)](_0x3897fd(0x222),'text/csv'),_0x2d75e5[_0x3897fd(0x1e1)](0xc8)[_0x3897fd(0x219)](_0x430f69);}),_0x2d75e5;};exports['exportCsv']=exportCsv;