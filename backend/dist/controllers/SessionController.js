const a33_0xf5a1c0=a33_0xce04;(function(_0xf12f36,_0x1005a9){const _0x2bc9ae=a33_0xce04,_0x36df5f=_0xf12f36();while(!![]){try{const _0x5456c6=-parseInt(_0x2bc9ae(0xa6))/0x1+-parseInt(_0x2bc9ae(0xb2))/0x2+parseInt(_0x2bc9ae(0xa4))/0x3*(parseInt(_0x2bc9ae(0xb8))/0x4)+-parseInt(_0x2bc9ae(0xa3))/0x5*(parseInt(_0x2bc9ae(0xc0))/0x6)+parseInt(_0x2bc9ae(0xa1))/0x7+-parseInt(_0x2bc9ae(0xbd))/0x8+parseInt(_0x2bc9ae(0x94))/0x9;if(_0x5456c6===_0x1005a9)break;else _0x36df5f['push'](_0x36df5f['shift']());}catch(_0x4e44d5){_0x36df5f['push'](_0x36df5f['shift']());}}}(a33_0x101d,0x68be2));const a33_0x580878=(function(){let _0x11253e=!![];return function(_0x4dd7ec,_0x35688c){const _0x3d61b4=_0x11253e?function(){if(_0x35688c){const _0x362833=_0x35688c['apply'](_0x4dd7ec,arguments);return _0x35688c=null,_0x362833;}}:function(){};return _0x11253e=![],_0x3d61b4;};}()),a33_0x1613a3=a33_0x580878(this,function(){const _0x41e11c=a33_0xce04;return a33_0x1613a3['toString']()[_0x41e11c(0xbe)](_0x41e11c(0x91))['toString']()[_0x41e11c(0x95)](a33_0x1613a3)[_0x41e11c(0xbe)](_0x41e11c(0x91));});a33_0x1613a3();function a33_0xce04(_0xb4495b,_0x1b3b6c){const _0x104ec8=a33_0x101d();return a33_0xce04=function(_0x1613a3,_0x580878){_0x1613a3=_0x1613a3-0x90;let _0x101d01=_0x104ec8[_0x1613a3];return _0x101d01;},a33_0xce04(_0xb4495b,_0x1b3b6c);}'use strict';var __importDefault=this&&this[a33_0xf5a1c0(0x9f)]||function(_0x45448a){const _0x4ef1bf=a33_0xf5a1c0;return _0x45448a&&_0x45448a[_0x4ef1bf(0x9a)]?_0x45448a:{'default':_0x45448a};};Object[a33_0xf5a1c0(0xb0)](exports,a33_0xf5a1c0(0x9a),{'value':!![]}),exports[a33_0xf5a1c0(0xb6)]=exports[a33_0xf5a1c0(0xb3)]=exports['me']=exports[a33_0xf5a1c0(0xaf)]=exports[a33_0xf5a1c0(0xb9)]=void 0x0;const AppError_1=__importDefault(require(a33_0xf5a1c0(0x99))),socket_1=require(a33_0xf5a1c0(0xa5)),AuthUserService_1=__importDefault(require(a33_0xf5a1c0(0xa8))),SendRefreshToken_1=require('../helpers/SendRefreshToken'),RefreshTokenService_1=require(a33_0xf5a1c0(0x93)),FindUserFromToken_1=__importDefault(require(a33_0xf5a1c0(0x92))),User_1=__importDefault(require('../models/User')),SerializeUser_1=require(a33_0xf5a1c0(0xb7)),CreateTokens_1=require(a33_0xf5a1c0(0x90)),Company_1=__importDefault(require(a33_0xf5a1c0(0x9e))),Setting_1=__importDefault(require(a33_0xf5a1c0(0x9c))),store=async(_0x27022b,_0x5a37f5)=>{const _0x3b2098=a33_0xf5a1c0,{email:_0x41e162,password:_0x4eb2af}=_0x27022b[_0x3b2098(0xb1)],{token:_0x19dd64,serializedUser:_0x3db65c,refreshToken:_0x37668c}=await(0x0,AuthUserService_1[_0x3b2098(0xbf)])({'email':_0x41e162,'password':_0x4eb2af});(0x0,SendRefreshToken_1[_0x3b2098(0xad)])(_0x5a37f5,_0x37668c);const _0x151185=(0x0,socket_1[_0x3b2098(0xba)])();return _0x151185['to']('user-'+_0x3db65c['id'])[_0x3b2098(0xb5)](_0x3b2098(0xbb)+_0x3db65c[_0x3b2098(0x9d)]+'-auth',{'action':_0x3b2098(0xaf),'user':{'id':_0x3db65c['id'],'email':_0x3db65c[_0x3b2098(0xa9)],'companyId':_0x3db65c[_0x3b2098(0x9d)]}}),_0x5a37f5[_0x3b2098(0xbc)](0xc8)[_0x3b2098(0x98)]({'token':_0x19dd64,'user':_0x3db65c});};exports[a33_0xf5a1c0(0xb9)]=store;const update=async(_0x4a62f5,_0x235d3b)=>{const _0x515c33=a33_0xf5a1c0,_0x58152c=_0x4a62f5['cookies']['jrt'];if(!_0x58152c)throw new AppError_1[(_0x515c33(0xbf))]('ERR_SESSION_EXPIRED',0x191);const {user:_0x332572,newToken:_0x36a784,refreshToken:_0x5f36e7}=await(0x0,RefreshTokenService_1['RefreshTokenService'])(_0x235d3b,_0x58152c);return(0x0,SendRefreshToken_1[_0x515c33(0xad)])(_0x235d3b,_0x5f36e7),_0x235d3b[_0x515c33(0x98)]({'token':_0x36a784,'user':_0x332572});};exports['update']=update;const me=async(_0x52d5c0,_0x4d0ab8)=>{const _0x52ca6c=a33_0xf5a1c0,_0x4521ed=_0x52d5c0[_0x52ca6c(0xa0)]['jrt'],_0x26cb5e=await(0x0,FindUserFromToken_1['default'])(_0x4521ed),{id:_0x542e2d,profile:_0x401100,email:_0x1f46e5,super:_0x5d3e2a}=_0x26cb5e;if(!_0x4521ed)throw new AppError_1[(_0x52ca6c(0xbf))]('ERR_SESSION_EXPIRED',0x191);return _0x4d0ab8[_0x52ca6c(0x98)]({'id':_0x542e2d,'profile':_0x401100,'email':_0x1f46e5,'super':_0x5d3e2a});};function a33_0x101d(){const _0x27d9ce=['search','default','4558152IiPnZC','../helpers/CreateTokens','(((.+)+)+)+$','../services/AuthServices/FindUserFromToken','../services/AuthServices/RefreshTokenService','8380377CdeBFc','constructor','user-','-auth','json','../errors/AppError','__esModule','admin','../models/Setting','companyId','../models/Company','__importDefault','cookies','222439JygbRq','queues','5YyxNUS','1259859hBSAyi','../libs/socket','192318TexZKW','findByPk','../services/UserServices/AuthUserService','email','ERR_SESSION_EXPIRED','SerializeUser','createAccessToken','SendRefreshToken','jrt','update','defineProperty','body','767562mbcLRu','remove','findOne','emit','impersonate','../helpers/SerializeUser','8nbammt','store','getIO','company-','status','304152xwpBTU'];a33_0x101d=function(){return _0x27d9ce;};return a33_0x101d();}exports['me']=me;const remove=async(_0x1c7ef3,_0x1dd51f)=>{const _0xab73f2=a33_0xf5a1c0,{id:_0x3e6070}=_0x1c7ef3['user'],_0x183c0a=await User_1['default'][_0xab73f2(0xa7)](_0x3e6070);return await _0x183c0a[_0xab73f2(0xaf)]({'online':![]}),_0x1dd51f['clearCookie'](_0xab73f2(0xae)),_0x1dd51f['send']();};exports[a33_0xf5a1c0(0xb3)]=remove;const impersonate=async(_0x335aab,_0x1d4aa6)=>{const _0x580ad3=a33_0xf5a1c0,_0x2ded54=_0x335aab[_0x580ad3(0xa0)]['jrt'],{companyId:_0x268d88}=_0x335aab['params'];if(!_0x2ded54)throw new AppError_1[(_0x580ad3(0xbf))](_0x580ad3(0xaa),0x191);const _0x415423=await User_1[_0x580ad3(0xbf)][_0x580ad3(0xb4)]({'where':{'companyId':Number(_0x268d88),'profile':_0x580ad3(0x9b)},'include':[_0x580ad3(0xa2),{'model':Company_1[_0x580ad3(0xbf)],'include':[{'model':Setting_1[_0x580ad3(0xbf)]}]}]});if(!_0x415423)throw new AppError_1[(_0x580ad3(0xbf))]('ERR_NO_USER_FOUND',0x194);const _0x3a62b2=(0x0,CreateTokens_1[_0x580ad3(0xac)])(_0x415423),_0x4d447c=(0x0,CreateTokens_1['createRefreshToken'])(_0x415423),_0x4b1044=await(0x0,SerializeUser_1[_0x580ad3(0xab)])(_0x415423);(0x0,SendRefreshToken_1['SendRefreshToken'])(_0x1d4aa6,_0x4d447c);const _0x3b81ec=(0x0,socket_1[_0x580ad3(0xba)])();return _0x3b81ec['to'](_0x580ad3(0x96)+_0x4b1044['id'])[_0x580ad3(0xb5)](_0x580ad3(0xbb)+_0x4b1044[_0x580ad3(0x9d)]+_0x580ad3(0x97),{'action':_0x580ad3(0xaf),'user':{'id':_0x4b1044['id'],'email':_0x4b1044['email'],'companyId':_0x4b1044[_0x580ad3(0x9d)],'impersonated':!![]}}),_0x1d4aa6[_0x580ad3(0xbc)](0xc8)[_0x580ad3(0x98)]({'token':_0x3a62b2,'user':_0x4b1044});};exports[a33_0xf5a1c0(0xb6)]=impersonate;