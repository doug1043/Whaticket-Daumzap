const a33_0xdd1b70=a33_0x5e51;(function(_0x58b5c0,_0x5a539a){const _0x3da8a6=a33_0x5e51,_0x785a2a=_0x58b5c0();while(!![]){try{const _0x5b5ca8=parseInt(_0x3da8a6(0x14a))/0x1+parseInt(_0x3da8a6(0x12b))/0x2*(-parseInt(_0x3da8a6(0x156))/0x3)+-parseInt(_0x3da8a6(0x13e))/0x4+-parseInt(_0x3da8a6(0x15b))/0x5+parseInt(_0x3da8a6(0x148))/0x6+parseInt(_0x3da8a6(0x130))/0x7+parseInt(_0x3da8a6(0x147))/0x8*(parseInt(_0x3da8a6(0x12c))/0x9);if(_0x5b5ca8===_0x5a539a)break;else _0x785a2a['push'](_0x785a2a['shift']());}catch(_0x5820d7){_0x785a2a['push'](_0x785a2a['shift']());}}}(a33_0x16f1,0x4b2da));const a33_0x5d99c7=(function(){let _0x3c5471=!![];return function(_0x4b71e9,_0x3d0025){const _0x23b1cc=_0x3c5471?function(){const _0x2cc837=a33_0x5e51;if(_0x3d0025){const _0x19a10b=_0x3d0025[_0x2cc837(0x146)](_0x4b71e9,arguments);return _0x3d0025=null,_0x19a10b;}}:function(){};return _0x3c5471=![],_0x23b1cc;};}()),a33_0xcd9a43=a33_0x5d99c7(this,function(){const _0x25465e=a33_0x5e51;return a33_0xcd9a43['toString']()[_0x25465e(0x152)](_0x25465e(0x14d))[_0x25465e(0x155)]()['constructor'](a33_0xcd9a43)['search'](_0x25465e(0x14d));});a33_0xcd9a43();'use strict';var __importDefault=this&&this[a33_0xdd1b70(0x13c)]||function(_0x20d133){const _0x4a54bb=a33_0xdd1b70;return _0x20d133&&_0x20d133[_0x4a54bb(0x142)]?_0x20d133:{'default':_0x20d133};};Object[a33_0xdd1b70(0x157)](exports,a33_0xdd1b70(0x142),{'value':!![]}),exports['impersonate']=exports[a33_0xdd1b70(0x158)]=exports['me']=exports[a33_0xdd1b70(0x14b)]=exports[a33_0xdd1b70(0x15a)]=void 0x0;const AppError_1=__importDefault(require(a33_0xdd1b70(0x134))),socket_1=require(a33_0xdd1b70(0x138)),AuthUserService_1=__importDefault(require(a33_0xdd1b70(0x151))),SendRefreshToken_1=require(a33_0xdd1b70(0x141)),RefreshTokenService_1=require(a33_0xdd1b70(0x154)),FindUserFromToken_1=__importDefault(require('../services/AuthServices/FindUserFromToken')),User_1=__importDefault(require(a33_0xdd1b70(0x12e))),SerializeUser_1=require(a33_0xdd1b70(0x15f)),CreateTokens_1=require(a33_0xdd1b70(0x160)),Company_1=__importDefault(require(a33_0xdd1b70(0x137))),Setting_1=__importDefault(require(a33_0xdd1b70(0x132))),store=async(_0x27383d,_0x23f739)=>{const _0x459b22=a33_0xdd1b70,{email:_0x88cf57,password:_0x3f6b0b}=_0x27383d[_0x459b22(0x14e)],{token:_0x2b6741,serializedUser:_0x5ba9be,refreshToken:_0x1d1c0f}=await(0x0,AuthUserService_1[_0x459b22(0x159)])({'email':_0x88cf57,'password':_0x3f6b0b});(0x0,SendRefreshToken_1['SendRefreshToken'])(_0x23f739,_0x1d1c0f);const _0x59440f=(0x0,socket_1[_0x459b22(0x145)])();return _0x59440f['to']('user-'+_0x5ba9be['id'])[_0x459b22(0x139)](_0x459b22(0x15d)+_0x5ba9be[_0x459b22(0x15e)]+'-auth',{'action':_0x459b22(0x14b),'user':{'id':_0x5ba9be['id'],'email':_0x5ba9be[_0x459b22(0x13d)],'companyId':_0x5ba9be['companyId']}}),_0x23f739['status'](0xc8)[_0x459b22(0x131)]({'token':_0x2b6741,'user':_0x5ba9be});};function a33_0x16f1(){const _0x2050e1=['send','ERR_NO_USER_FOUND','__importDefault','email','2128152vHCskd','SendRefreshToken','user','../helpers/SendRefreshToken','__esModule','findOne','params','getIO','apply','2765512bggxzq','2334804sFahNP','admin','434025XUYOvH','update','findByPk','(((.+)+)+)+$','body','impersonate','createRefreshToken','../services/UserServices/AuthUserService','search','ERR_SESSION_EXPIRED','../services/AuthServices/RefreshTokenService','toString','413931qbeMWT','defineProperty','remove','default','store','2924310DOeKUZ','SerializeUser','company-','companyId','../helpers/SerializeUser','../helpers/CreateTokens','2SaGjss','18xdatYO','RefreshTokenService','../models/User','user-','337890lfzSfR','json','../models/Setting','jrt','../errors/AppError','clearCookie','cookies','../models/Company','../libs/socket','emit'];a33_0x16f1=function(){return _0x2050e1;};return a33_0x16f1();}exports[a33_0xdd1b70(0x15a)]=store;const update=async(_0x10ac1b,_0x4e1226)=>{const _0x5c62ae=a33_0xdd1b70,_0x3a11af=_0x10ac1b[_0x5c62ae(0x136)][_0x5c62ae(0x133)];if(!_0x3a11af)throw new AppError_1[(_0x5c62ae(0x159))](_0x5c62ae(0x153),0x191);const {user:_0x82d889,newToken:_0x81a5f5,refreshToken:_0x1f7035}=await(0x0,RefreshTokenService_1[_0x5c62ae(0x12d)])(_0x4e1226,_0x3a11af);return(0x0,SendRefreshToken_1[_0x5c62ae(0x13f)])(_0x4e1226,_0x1f7035),_0x4e1226['json']({'token':_0x81a5f5,'user':_0x82d889});};exports[a33_0xdd1b70(0x14b)]=update;const me=async(_0x2d8cd9,_0x100aeb)=>{const _0x41822d=a33_0xdd1b70,_0x590015=_0x2d8cd9[_0x41822d(0x136)][_0x41822d(0x133)],_0x46f258=await(0x0,FindUserFromToken_1['default'])(_0x590015),{id:_0x65b16e,profile:_0xfe4897,email:_0x1f6973,super:_0x577218}=_0x46f258;if(!_0x590015)throw new AppError_1[(_0x41822d(0x159))]('ERR_SESSION_EXPIRED',0x191);return _0x100aeb[_0x41822d(0x131)]({'id':_0x65b16e,'profile':_0xfe4897,'email':_0x1f6973,'super':_0x577218});};exports['me']=me;const remove=async(_0x257e9a,_0x5d7a08)=>{const _0x49e981=a33_0xdd1b70,{id:_0x53a88a}=_0x257e9a[_0x49e981(0x140)],_0x3ce05e=await User_1['default'][_0x49e981(0x14c)](_0x53a88a);return await _0x3ce05e[_0x49e981(0x14b)]({'online':![]}),_0x5d7a08[_0x49e981(0x135)](_0x49e981(0x133)),_0x5d7a08[_0x49e981(0x13a)]();};exports[a33_0xdd1b70(0x158)]=remove;function a33_0x5e51(_0x12cd6e,_0x15acbd){const _0x1a8b1d=a33_0x16f1();return a33_0x5e51=function(_0xcd9a43,_0x5d99c7){_0xcd9a43=_0xcd9a43-0x12b;let _0x16f100=_0x1a8b1d[_0xcd9a43];return _0x16f100;},a33_0x5e51(_0x12cd6e,_0x15acbd);}const impersonate=async(_0x324782,_0x416921)=>{const _0x34325f=a33_0xdd1b70,_0x2deb33=_0x324782['cookies'][_0x34325f(0x133)],{companyId:_0x106c4e}=_0x324782[_0x34325f(0x144)];if(!_0x2deb33)throw new AppError_1[(_0x34325f(0x159))](_0x34325f(0x153),0x191);const _0x242346=await User_1[_0x34325f(0x159)][_0x34325f(0x143)]({'where':{'companyId':Number(_0x106c4e),'profile':_0x34325f(0x149)},'include':['queues',{'model':Company_1['default'],'include':[{'model':Setting_1[_0x34325f(0x159)]}]}]});if(!_0x242346)throw new AppError_1['default'](_0x34325f(0x13b),0x194);const _0x361934=(0x0,CreateTokens_1['createAccessToken'])(_0x242346),_0x103f3c=(0x0,CreateTokens_1[_0x34325f(0x150)])(_0x242346),_0x3fd6e6=await(0x0,SerializeUser_1[_0x34325f(0x15c)])(_0x242346);(0x0,SendRefreshToken_1[_0x34325f(0x13f)])(_0x416921,_0x103f3c);const _0x12ed67=(0x0,socket_1[_0x34325f(0x145)])();return _0x12ed67['to'](_0x34325f(0x12f)+_0x3fd6e6['id'])[_0x34325f(0x139)](_0x34325f(0x15d)+_0x3fd6e6['companyId']+'-auth',{'action':_0x34325f(0x14b),'user':{'id':_0x3fd6e6['id'],'email':_0x3fd6e6[_0x34325f(0x13d)],'companyId':_0x3fd6e6[_0x34325f(0x15e)],'impersonated':!![]}}),_0x416921['status'](0xc8)[_0x34325f(0x131)]({'token':_0x361934,'user':_0x3fd6e6});};exports[a33_0xdd1b70(0x14f)]=impersonate;