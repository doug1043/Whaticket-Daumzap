const a33_0x152353=a33_0x54a9;(function(_0x307ea2,_0x14d64f){const _0x2bd1ea=a33_0x54a9,_0x37e4b2=_0x307ea2();while(!![]){try{const _0x3319bb=parseInt(_0x2bd1ea(0x11b))/0x1*(parseInt(_0x2bd1ea(0x143))/0x2)+parseInt(_0x2bd1ea(0x12a))/0x3*(parseInt(_0x2bd1ea(0x135))/0x4)+parseInt(_0x2bd1ea(0x121))/0x5+parseInt(_0x2bd1ea(0x128))/0x6+parseInt(_0x2bd1ea(0x12e))/0x7*(-parseInt(_0x2bd1ea(0x148))/0x8)+parseInt(_0x2bd1ea(0x147))/0x9+-parseInt(_0x2bd1ea(0x12f))/0xa*(parseInt(_0x2bd1ea(0x122))/0xb);if(_0x3319bb===_0x14d64f)break;else _0x37e4b2['push'](_0x37e4b2['shift']());}catch(_0x4258c1){_0x37e4b2['push'](_0x37e4b2['shift']());}}}(a33_0xc7db,0x930c5));const a33_0xde8512=(function(){let _0x3a9f0f=!![];return function(_0x1cae1e,_0x47a7a3){const _0x58e864=_0x3a9f0f?function(){if(_0x47a7a3){const _0x4a5be3=_0x47a7a3['apply'](_0x1cae1e,arguments);return _0x47a7a3=null,_0x4a5be3;}}:function(){};return _0x3a9f0f=![],_0x58e864;};}()),a33_0x275976=a33_0xde8512(this,function(){const _0x1bea80=a33_0x54a9;return a33_0x275976[_0x1bea80(0x141)]()[_0x1bea80(0x13a)]('(((.+)+)+)+$')['toString']()['constructor'](a33_0x275976)['search'](_0x1bea80(0x146));});a33_0x275976();'use strict';var __importDefault=this&&this[a33_0x152353(0x149)]||function(_0x2ec319){return _0x2ec319&&_0x2ec319['__esModule']?_0x2ec319:{'default':_0x2ec319};};Object['defineProperty'](exports,a33_0x152353(0x127),{'value':!![]}),exports[a33_0x152353(0x12d)]=exports[a33_0x152353(0x11d)]=exports['me']=exports[a33_0x152353(0x118)]=exports[a33_0x152353(0x140)]=void 0x0;const AppError_1=__importDefault(require(a33_0x152353(0x11a))),socket_1=require('../libs/socket'),AuthUserService_1=__importDefault(require(a33_0x152353(0x14d))),SendRefreshToken_1=require(a33_0x152353(0x124)),RefreshTokenService_1=require('../services/AuthServices/RefreshTokenService'),FindUserFromToken_1=__importDefault(require(a33_0x152353(0x12b))),User_1=__importDefault(require(a33_0x152353(0x13e))),SerializeUser_1=require(a33_0x152353(0x116)),CreateTokens_1=require('../helpers/CreateTokens'),Company_1=__importDefault(require('../models/Company')),Setting_1=__importDefault(require(a33_0x152353(0x132))),store=async(_0x43e782,_0x1c4a7e)=>{const _0x4af791=a33_0x152353,{email:_0x225f00,password:_0x1a9dc1}=_0x43e782[_0x4af791(0x13c)],{token:_0x2cc55c,serializedUser:_0x34d313,refreshToken:_0x492bf9}=await(0x0,AuthUserService_1['default'])({'email':_0x225f00,'password':_0x1a9dc1});(0x0,SendRefreshToken_1[_0x4af791(0x134)])(_0x1c4a7e,_0x492bf9);const _0x2339e9=(0x0,socket_1['getIO'])();return _0x2339e9['to']('user-'+_0x34d313['id'])[_0x4af791(0x117)]('company-'+_0x34d313[_0x4af791(0x139)]+_0x4af791(0x151),{'action':'update','user':{'id':_0x34d313['id'],'email':_0x34d313[_0x4af791(0x11f)],'companyId':_0x34d313[_0x4af791(0x139)]}}),_0x1c4a7e[_0x4af791(0x13f)](0xc8)[_0x4af791(0x136)]({'token':_0x2cc55c,'user':_0x34d313});};exports[a33_0x152353(0x140)]=store;const update=async(_0x10df58,_0x33483a)=>{const _0x4b1cb8=a33_0x152353,_0x4b0d24=_0x10df58[_0x4b1cb8(0x11e)][_0x4b1cb8(0x133)];if(!_0x4b0d24)throw new AppError_1[(_0x4b1cb8(0x137))](_0x4b1cb8(0x14c),0x191);const {user:_0x100e4d,newToken:_0x40ba73,refreshToken:_0x10830e}=await(0x0,RefreshTokenService_1[_0x4b1cb8(0x126)])(_0x33483a,_0x4b0d24);return(0x0,SendRefreshToken_1[_0x4b1cb8(0x134)])(_0x33483a,_0x10830e),_0x33483a['json']({'token':_0x40ba73,'user':_0x100e4d});};exports[a33_0x152353(0x118)]=update;const me=async(_0x27a3fd,_0x2aac)=>{const _0x4659d7=a33_0x152353,_0x468163=_0x27a3fd[_0x4659d7(0x11e)][_0x4659d7(0x133)],_0xda5068=await(0x0,FindUserFromToken_1['default'])(_0x468163),{id:_0x424018,profile:_0x337bab,email:_0x2e19a9,super:_0x176d12}=_0xda5068;if(!_0x468163)throw new AppError_1['default'](_0x4659d7(0x14c),0x191);return _0x2aac['json']({'id':_0x424018,'profile':_0x337bab,'email':_0x2e19a9,'super':_0x176d12});};exports['me']=me;function a33_0xc7db(){const _0x54d785=['company-','RefreshTokenService','__esModule','1052166ydhviN','send','2769KZsjzt','../services/AuthServices/FindUserFromToken','whatsappId','impersonate','470519UULQcU','60rNRRDX','ERR_NO_USER_FOUND','SerializeUser','../models/Setting','jrt','SendRefreshToken','824rHkUea','json','default','createRefreshToken','companyId','search','user-','body','queues','../models/User','status','store','toString','isTricked','10642ticWsM','allTicket','getIO','(((.+)+)+)+$','2448531oeFqeL','56EswUif','__importDefault','findOne','findByPk','ERR_SESSION_EXPIRED','../services/UserServices/AuthUserService','params','profile','clearCookie','-auth','../helpers/SerializeUser','emit','update','-user','../errors/AppError','127IsOrGX','startWork','remove','cookies','email','createAccessToken','1958315EsGaWL','1158960pDlWzS','defaultMenu','../helpers/SendRefreshToken'];a33_0xc7db=function(){return _0x54d785;};return a33_0xc7db();}const remove=async(_0x2b5048,_0x5bd6aa)=>{const _0x454047=a33_0x152353,{id:_0x3ca3f6}=_0x2b5048['user'],_0x3986cd=await User_1[_0x454047(0x137)][_0x454047(0x14b)](_0x3ca3f6);await _0x3986cd['update']({'online':![]});const _0x30e308=(0x0,socket_1[_0x454047(0x145)])();return _0x30e308[_0x454047(0x117)](_0x454047(0x125)+_0x3986cd['companyId']+_0x454047(0x119),{'action':_0x454047(0x118),'user':{'id':_0x3986cd['id'],'name':_0x3986cd['name'],'email':_0x3986cd[_0x454047(0x11f)],'profile':_0x3986cd[_0x454047(0x14f)],'online':![],'isTricked':_0x3986cd[_0x454047(0x142)],'spy':_0x3986cd['spy'],'allTicket':_0x3986cd[_0x454047(0x144)],'whatsappId':_0x3986cd[_0x454047(0x12c)],'startWork':_0x3986cd[_0x454047(0x11c)],'endWork':_0x3986cd['endWork'],'defaultMenu':_0x3986cd[_0x454047(0x123)]}}),_0x5bd6aa[_0x454047(0x150)](_0x454047(0x133)),_0x5bd6aa[_0x454047(0x129)]();};exports[a33_0x152353(0x11d)]=remove;function a33_0x54a9(_0xe10450,_0x5dab52){const _0x2ede31=a33_0xc7db();return a33_0x54a9=function(_0x275976,_0xde8512){_0x275976=_0x275976-0x116;let _0xc7db52=_0x2ede31[_0x275976];return _0xc7db52;},a33_0x54a9(_0xe10450,_0x5dab52);}const impersonate=async(_0x16186d,_0x25564f)=>{const _0xde7966=a33_0x152353,_0x3fdb7b=_0x16186d[_0xde7966(0x11e)][_0xde7966(0x133)],{companyId:_0x33f19a}=_0x16186d[_0xde7966(0x14e)];if(!_0x3fdb7b)throw new AppError_1[(_0xde7966(0x137))](_0xde7966(0x14c),0x191);const _0x597c9a=await User_1['default'][_0xde7966(0x14a)]({'where':{'companyId':Number(_0x33f19a),'profile':'admin'},'include':[_0xde7966(0x13d),{'model':Company_1[_0xde7966(0x137)],'include':[{'model':Setting_1[_0xde7966(0x137)]}]}]});if(!_0x597c9a)throw new AppError_1['default'](_0xde7966(0x130),0x194);const _0xc69bab=(0x0,CreateTokens_1[_0xde7966(0x120)])(_0x597c9a),_0x55d964=(0x0,CreateTokens_1[_0xde7966(0x138)])(_0x597c9a),_0x2b5eda=await(0x0,SerializeUser_1[_0xde7966(0x131)])(_0x597c9a);(0x0,SendRefreshToken_1[_0xde7966(0x134)])(_0x25564f,_0x55d964);const _0x5837ae=(0x0,socket_1[_0xde7966(0x145)])();return _0x5837ae['to'](_0xde7966(0x13b)+_0x2b5eda['id'])[_0xde7966(0x117)]('company-'+_0x2b5eda[_0xde7966(0x139)]+_0xde7966(0x151),{'action':_0xde7966(0x118),'user':{'id':_0x2b5eda['id'],'email':_0x2b5eda[_0xde7966(0x11f)],'companyId':_0x2b5eda[_0xde7966(0x139)],'impersonated':!![]}}),_0x25564f[_0xde7966(0x13f)](0xc8)[_0xde7966(0x136)]({'token':_0xc69bab,'user':_0x2b5eda});};exports[a33_0x152353(0x12d)]=impersonate;