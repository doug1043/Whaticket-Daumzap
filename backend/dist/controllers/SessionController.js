function a33_0x1786(_0x500cbb,_0x40eba5){const _0x609fdc=a33_0x2b87();return a33_0x1786=function(_0x20306b,_0x1a9667){_0x20306b=_0x20306b-0x165;let _0x2b87f0=_0x609fdc[_0x20306b];return _0x2b87f0;},a33_0x1786(_0x500cbb,_0x40eba5);}const a33_0x269121=a33_0x1786;(function(_0x8e51e6,_0xa3d1f6){const _0x2aed22=a33_0x1786,_0x2176d1=_0x8e51e6();while(!![]){try{const _0x3a2184=parseInt(_0x2aed22(0x183))/0x1+-parseInt(_0x2aed22(0x18a))/0x2*(-parseInt(_0x2aed22(0x180))/0x3)+parseInt(_0x2aed22(0x16d))/0x4*(-parseInt(_0x2aed22(0x191))/0x5)+parseInt(_0x2aed22(0x18e))/0x6+parseInt(_0x2aed22(0x167))/0x7+-parseInt(_0x2aed22(0x193))/0x8+parseInt(_0x2aed22(0x182))/0x9;if(_0x3a2184===_0xa3d1f6)break;else _0x2176d1['push'](_0x2176d1['shift']());}catch(_0x21793a){_0x2176d1['push'](_0x2176d1['shift']());}}}(a33_0x2b87,0xbbbfc));const a33_0x1a9667=(function(){let _0x13d337=!![];return function(_0x3f25bc,_0x4b00cd){const _0x510286=_0x13d337?function(){if(_0x4b00cd){const _0x582820=_0x4b00cd['apply'](_0x3f25bc,arguments);return _0x4b00cd=null,_0x582820;}}:function(){};return _0x13d337=![],_0x510286;};}()),a33_0x20306b=a33_0x1a9667(this,function(){const _0x4a4b7b=a33_0x1786;return a33_0x20306b[_0x4a4b7b(0x169)]()[_0x4a4b7b(0x181)](_0x4a4b7b(0x16e))['toString']()['constructor'](a33_0x20306b)[_0x4a4b7b(0x181)](_0x4a4b7b(0x16e));});a33_0x20306b();'use strict';function a33_0x2b87(){const _0x4dda97=['11370568ifLtCn','remove','findByPk','user','getIO','user-','610589kNQvoJ','impersonate','toString','body','json','queues','1220RXubyD','(((.+)+)+)+$','status','ERR_SESSION_EXPIRED','RefreshTokenService','../libs/socket','SerializeUser','update','clearCookie','createAccessToken','default','jrt','../helpers/SendRefreshToken','SendRefreshToken','../services/UserServices/AuthUserService','../helpers/SerializeUser','admin','findOne','params','6iwEFZs','search','5032665xwPMiE','1213735WgMGKZ','__esModule','email','companyId','createRefreshToken','ERR_NO_USER_FOUND','store','1395070oZyOJP','-auth','../errors/AppError','../services/AuthServices/RefreshTokenService','43194SlisoE','defineProperty','cookies','17575cWNdjr','company-'];a33_0x2b87=function(){return _0x4dda97;};return a33_0x2b87();}var __importDefault=this&&this['__importDefault']||function(_0x192f66){const _0x30830c=a33_0x1786;return _0x192f66&&_0x192f66[_0x30830c(0x184)]?_0x192f66:{'default':_0x192f66};};Object[a33_0x269121(0x18f)](exports,'__esModule',{'value':!![]}),exports[a33_0x269121(0x168)]=exports['remove']=exports['me']=exports[a33_0x269121(0x174)]=exports[a33_0x269121(0x189)]=void 0x0;const AppError_1=__importDefault(require(a33_0x269121(0x18c))),socket_1=require(a33_0x269121(0x172)),AuthUserService_1=__importDefault(require(a33_0x269121(0x17b))),SendRefreshToken_1=require(a33_0x269121(0x179)),RefreshTokenService_1=require(a33_0x269121(0x18d)),FindUserFromToken_1=__importDefault(require('../services/AuthServices/FindUserFromToken')),User_1=__importDefault(require('../models/User')),SerializeUser_1=require(a33_0x269121(0x17c)),CreateTokens_1=require('../helpers/CreateTokens'),Company_1=__importDefault(require('../models/Company')),Setting_1=__importDefault(require('../models/Setting')),store=async(_0x406e85,_0x345bcf)=>{const _0x5c9731=a33_0x269121,{email:_0x399697,password:_0x264fed}=_0x406e85[_0x5c9731(0x16a)],{token:_0x452383,serializedUser:_0x29e4f9,refreshToken:_0x332668}=await(0x0,AuthUserService_1[_0x5c9731(0x177)])({'email':_0x399697,'password':_0x264fed});(0x0,SendRefreshToken_1[_0x5c9731(0x17a)])(_0x345bcf,_0x332668);const _0x1c0d4d=(0x0,socket_1[_0x5c9731(0x165)])();return _0x1c0d4d['to'](_0x5c9731(0x166)+_0x29e4f9['id'])['emit'](_0x5c9731(0x192)+_0x29e4f9['companyId']+_0x5c9731(0x18b),{'action':'update','user':{'id':_0x29e4f9['id'],'email':_0x29e4f9['email'],'companyId':_0x29e4f9[_0x5c9731(0x186)]}}),_0x345bcf[_0x5c9731(0x16f)](0xc8)['json']({'token':_0x452383,'user':_0x29e4f9});};exports['store']=store;const update=async(_0x5be956,_0xe51c9f)=>{const _0x134e08=a33_0x269121,_0x5dc14b=_0x5be956['cookies'][_0x134e08(0x178)];if(!_0x5dc14b)throw new AppError_1['default'](_0x134e08(0x170),0x191);const {user:_0x1897ab,newToken:_0xece1cd,refreshToken:_0x2deafa}=await(0x0,RefreshTokenService_1[_0x134e08(0x171)])(_0xe51c9f,_0x5dc14b);return(0x0,SendRefreshToken_1[_0x134e08(0x17a)])(_0xe51c9f,_0x2deafa),_0xe51c9f['json']({'token':_0xece1cd,'user':_0x1897ab});};exports[a33_0x269121(0x174)]=update;const me=async(_0x423f05,_0x171342)=>{const _0x3f080e=a33_0x269121,_0x51beb3=_0x423f05[_0x3f080e(0x190)][_0x3f080e(0x178)],_0x1aa293=await(0x0,FindUserFromToken_1[_0x3f080e(0x177)])(_0x51beb3),{id:_0x2404fd,profile:_0x21665e,email:_0x3f3bba,super:_0x5df61e}=_0x1aa293;if(!_0x51beb3)throw new AppError_1['default'](_0x3f080e(0x170),0x191);return _0x171342[_0x3f080e(0x16b)]({'id':_0x2404fd,'profile':_0x21665e,'email':_0x3f3bba,'super':_0x5df61e});};exports['me']=me;const remove=async(_0x15a496,_0x48c73c)=>{const _0x476515=a33_0x269121,{id:_0x283e97}=_0x15a496[_0x476515(0x196)],_0xd76a57=await User_1['default'][_0x476515(0x195)](_0x283e97);return await _0xd76a57[_0x476515(0x174)]({'online':![]}),_0x48c73c[_0x476515(0x175)](_0x476515(0x178)),_0x48c73c['send']();};exports[a33_0x269121(0x194)]=remove;const impersonate=async(_0x45d561,_0x2dc2ac)=>{const _0xc0078e=a33_0x269121,_0x3c56d5=_0x45d561['cookies'][_0xc0078e(0x178)],{companyId:_0x5ebcc5}=_0x45d561[_0xc0078e(0x17f)];if(!_0x3c56d5)throw new AppError_1[(_0xc0078e(0x177))](_0xc0078e(0x170),0x191);const _0x7f93fd=await User_1[_0xc0078e(0x177)][_0xc0078e(0x17e)]({'where':{'companyId':Number(_0x5ebcc5),'profile':_0xc0078e(0x17d)},'include':[_0xc0078e(0x16c),{'model':Company_1[_0xc0078e(0x177)],'include':[{'model':Setting_1[_0xc0078e(0x177)]}]}]});if(!_0x7f93fd)throw new AppError_1[(_0xc0078e(0x177))](_0xc0078e(0x188),0x194);const _0x14e49b=(0x0,CreateTokens_1[_0xc0078e(0x176)])(_0x7f93fd),_0x5d3399=(0x0,CreateTokens_1[_0xc0078e(0x187)])(_0x7f93fd),_0x5ebd36=await(0x0,SerializeUser_1[_0xc0078e(0x173)])(_0x7f93fd);(0x0,SendRefreshToken_1['SendRefreshToken'])(_0x2dc2ac,_0x5d3399);const _0x55b021=(0x0,socket_1[_0xc0078e(0x165)])();return _0x55b021['to'](_0xc0078e(0x166)+_0x5ebd36['id'])['emit'](_0xc0078e(0x192)+_0x5ebd36[_0xc0078e(0x186)]+_0xc0078e(0x18b),{'action':_0xc0078e(0x174),'user':{'id':_0x5ebd36['id'],'email':_0x5ebd36[_0xc0078e(0x185)],'companyId':_0x5ebd36[_0xc0078e(0x186)],'impersonated':!![]}}),_0x2dc2ac[_0xc0078e(0x16f)](0xc8)['json']({'token':_0x14e49b,'user':_0x5ebd36});};exports['impersonate']=impersonate;