'use strict';const a361_0xa248f5=a361_0x3393;(function(_0x255b6a,_0x3a3556){const _0x43eca1=a361_0x3393,_0xf18507=_0x255b6a();while(!![]){try{const _0x3c6777=-parseInt(_0x43eca1(0x98))/0x1+parseInt(_0x43eca1(0xb7))/0x2*(-parseInt(_0x43eca1(0xb4))/0x3)+parseInt(_0x43eca1(0x90))/0x4+-parseInt(_0x43eca1(0x8c))/0x5*(parseInt(_0x43eca1(0xdc))/0x6)+-parseInt(_0x43eca1(0x80))/0x7*(parseInt(_0x43eca1(0xb2))/0x8)+-parseInt(_0x43eca1(0xaa))/0x9*(parseInt(_0x43eca1(0xeb))/0xa)+parseInt(_0x43eca1(0xd6))/0xb*(parseInt(_0x43eca1(0x93))/0xc);if(_0x3c6777===_0x3a3556)break;else _0xf18507['push'](_0xf18507['shift']());}catch(_0x2f404e){_0xf18507['push'](_0xf18507['shift']());}}}(a361_0x4304,0x250b3));var __createBinding=this&&this[a361_0xa248f5(0xf7)]||(Object['create']?function(_0x4c445d,_0x433205,_0x24855a,_0x5ac7b2){const _0x2bd887=a361_0xa248f5;if(_0x5ac7b2===undefined)_0x5ac7b2=_0x24855a;var _0x11cecd=Object[_0x2bd887(0x88)](_0x433205,_0x24855a);(!_0x11cecd||('get'in _0x11cecd?!_0x433205['__esModule']:_0x11cecd[_0x2bd887(0xe9)]||_0x11cecd[_0x2bd887(0xf0)]))&&(_0x11cecd={'enumerable':!![],'get':function(){return _0x433205[_0x24855a];}}),Object[_0x2bd887(0x7f)](_0x4c445d,_0x5ac7b2,_0x11cecd);}:function(_0x3e1025,_0x54b800,_0x8ed60,_0x4d12ab){if(_0x4d12ab===undefined)_0x4d12ab=_0x8ed60;_0x3e1025[_0x4d12ab]=_0x54b800[_0x8ed60];}),__setModuleDefault=this&&this[a361_0xa248f5(0xd9)]||(Object[a361_0xa248f5(0x9a)]?function(_0x11741c,_0x18009a){const _0x1d2bef=a361_0xa248f5;Object['defineProperty'](_0x11741c,_0x1d2bef(0xfa),{'enumerable':!![],'value':_0x18009a});}:function(_0x522149,_0x1af4bb){_0x522149['default']=_0x1af4bb;}),__importStar=this&&this['__importStar']||(function(){const _0x54e3b3=(function(){let _0x1d47d4=!![];return function(_0x45da20,_0x1ad145){const _0x595cd2=_0x1d47d4?function(){if(_0x1ad145){const _0x2283a0=_0x1ad145['apply'](_0x45da20,arguments);return _0x1ad145=null,_0x2283a0;}}:function(){};return _0x1d47d4=![],_0x595cd2;};}()),_0x43df8d=_0x54e3b3(this,function(){const _0x4fa089=a361_0x3393;return _0x43df8d['toString']()[_0x4fa089(0x7c)](_0x4fa089(0xc8))[_0x4fa089(0xe6)]()[_0x4fa089(0xde)](_0x43df8d)['search'](_0x4fa089(0xc8));});_0x43df8d();var _0x33c516=function(_0x237876){const _0x1aa131=a361_0x3393;return _0x33c516=Object[_0x1aa131(0xaf)]||function(_0x3eaaef){const _0x10c558=_0x1aa131;var _0x4cb3ca=[];for(var _0x28f9e0 in _0x3eaaef)if(Object[_0x10c558(0xe0)][_0x10c558(0xd2)][_0x10c558(0x8b)](_0x3eaaef,_0x28f9e0))_0x4cb3ca[_0x4cb3ca[_0x10c558(0xf3)]]=_0x28f9e0;return _0x4cb3ca;},_0x33c516(_0x237876);};return function(_0x156ed0){const _0x8734b0=a361_0x3393;if(_0x156ed0&&_0x156ed0['__esModule'])return _0x156ed0;var _0x55daca={};if(_0x156ed0!=null){for(var _0x56e47a=_0x33c516(_0x156ed0),_0x210c3f=0x0;_0x210c3f<_0x56e47a['length'];_0x210c3f++)if(_0x56e47a[_0x210c3f]!==_0x8734b0(0xfa))__createBinding(_0x55daca,_0x156ed0,_0x56e47a[_0x210c3f]);}return __setModuleDefault(_0x55daca,_0x156ed0),_0x55daca;};}()),__importDefault=this&&this[a361_0xa248f5(0xd7)]||function(_0x431542){return _0x431542&&_0x431542['__esModule']?_0x431542:{'default':_0x431542};};Object[a361_0xa248f5(0x7f)](exports,a361_0xa248f5(0xca),{'value':!![]}),exports['initWASocket']=exports[a361_0xa248f5(0xcd)]=exports[a361_0xa248f5(0xbc)]=exports[a361_0xa248f5(0xc3)]=void 0x0;function a361_0x3393(_0x16cbcd,_0xf2146){const _0xcc9c8e=a361_0x4304();return a361_0x3393=function(_0xb2ea98,_0x107be8){_0xb2ea98=_0xb2ea98-0x75;let _0x43048b=_0xcc9c8e[_0xb2ea98];return _0x43048b;},a361_0x3393(_0x16cbcd,_0xf2146);}const Sentry=__importStar(require('@sentry/node')),baileys_1=__importStar(require(a361_0xa248f5(0xa2))),node_cache_1=__importDefault(require('node-cache')),sequelize_1=require(a361_0xa248f5(0x7a)),Whatsapp_1=__importDefault(require(a361_0xa248f5(0x75))),logger_1=require('../utils/logger'),authState_1=__importDefault(require(a361_0xa248f5(0xb8))),AppError_1=__importDefault(require(a361_0xa248f5(0xb0))),socket_1=require(a361_0xa248f5(0xed)),StartWhatsAppSession_1=require(a361_0xa248f5(0xbe)),DeleteBaileysService_1=__importDefault(require(a361_0xa248f5(0x86))),Contact_1=__importDefault(require('../models/Contact')),Ticket_1=__importDefault(require(a361_0xa248f5(0xa4))),GetPublicSettingService_1=__importDefault(require(a361_0xa248f5(0xcc))),Message_1=__importDefault(require('../models/Message')),ExtractPhoneNumber_1=require('../helpers/ExtractPhoneNumber'),sessions=[],retriesQrCodeMap=new Map(),getWbot=_0x497ec0=>{const _0x425f16=a361_0xa248f5,_0x13197c=sessions[_0x425f16(0xdf)](_0x506403=>_0x506403['id']===_0x497ec0);if(_0x13197c===-0x1)throw new AppError_1[(_0x425f16(0xfa))]('ERR_WAPP_NOT_INITIALIZED');return sessions[_0x13197c];};exports[a361_0xa248f5(0xc3)]=getWbot;const removeWbot=async(_0x8532bd,_0x40ff31=!![])=>{const _0x9bef59=a361_0xa248f5;try{const _0xfd0473=sessions[_0x9bef59(0xdf)](_0x4ef191=>_0x4ef191['id']===_0x8532bd);_0xfd0473!==-0x1&&(_0x40ff31&&await sessions[_0xfd0473][_0x9bef59(0xea)](),sessions[_0xfd0473]['ev'][_0x9bef59(0xc6)](_0x9bef59(0x81)),sessions[_0xfd0473]['ev'][_0x9bef59(0xc6)](_0x9bef59(0x7d)),sessions[_0xfd0473]['ev'][_0x9bef59(0xc6)](_0x9bef59(0x99)),sessions[_0xfd0473]['ev'][_0x9bef59(0xc6)](_0x9bef59(0xa7)),sessions[_0xfd0473]['ev'][_0x9bef59(0xc6)]('groups.update'),sessions[_0xfd0473]['ev'][_0x9bef59(0xc6)](_0x9bef59(0xe2)),sessions[_0xfd0473]['ev']['removeAllListeners'](_0x9bef59(0xfd)),sessions[_0xfd0473][_0x9bef59(0xba)](null),sessions[_0xfd0473]['ws'][_0x9bef59(0xc6)](),await sessions[_0xfd0473]['ws'][_0x9bef59(0xa0)](),sessions['splice'](_0xfd0473,0x1));}catch(_0x4a5774){logger_1[_0x9bef59(0x76)][_0x9bef59(0xda)](_0x4a5774);}};exports['removeWbot']=removeWbot;const getVersionWA=async()=>{const _0x5a395d=a361_0xa248f5;try{const _0x3276c6=_0x5a395d(0x85),_0x2b5d0e=0x1,_0x89a64e=await(0x0,GetPublicSettingService_1[_0x5a395d(0xfa)])({'key':_0x3276c6,'companyId':_0x2b5d0e});return _0x89a64e||process[_0x5a395d(0xcf)]['CONFIG_SESSION_WA_CONNECTION'];}catch(_0x357488){return console[_0x5a395d(0xda)](_0x5a395d(0x9b),_0x357488),process['env'][_0x5a395d(0xce)];}},restartWbot=async(_0x4d6f82,_0x1b1ddd)=>{const _0x1e10e9=a361_0xa248f5;try{const _0x59a986={'where':{'companyId':_0x4d6f82},'attributes':['id']},_0x5195d6=await Whatsapp_1[_0x1e10e9(0xfa)][_0x1e10e9(0x77)](_0x59a986);_0x5195d6[_0x1e10e9(0x9e)](async _0x547230=>{const _0x208fd1=_0x1e10e9,_0x278e19=sessions['findIndex'](_0x22f14f=>_0x22f14f['id']===_0x547230['id']);_0x278e19!==-0x1&&sessions[_0x278e19]['ws'][_0x208fd1(0xa0)]();});}catch(_0xc253db){logger_1[_0x1e10e9(0x76)][_0x1e10e9(0xda)](_0xc253db);}};exports[a361_0xa248f5(0xcd)]=restartWbot;const initWASocket=async(_0x47ea84,_0x21e27e)=>{return new Promise((_0x50d275,_0x44309c)=>{const _0x42f7ef=a361_0x3393;try{((async()=>{const _0x5b4290=a361_0x3393,_0x73f06c=(0x0,socket_1[_0x5b4290(0xc5)])(),_0x10f1d8=await Whatsapp_1['default']['findOne']({'where':{'id':_0x47ea84['id']}});if(!_0x10f1d8)return;const {id:_0x57ee9c,name:_0xda03ff,provider:_0x16f6ea}=_0x10f1d8;let _0x3b52e8;const _0x4a029c=_0x16f6ea===_0x5b4290(0xe7);try{_0x3b52e8=await getVersionWA(),logger_1[_0x5b4290(0x76)][_0x5b4290(0xa1)](_0x5b4290(0xfb)+_0x3b52e8+_0x5b4290(0xee)+_0x4a029c);}catch(_0x1cd9b9){console['error']('Erro\x20ao\x20inicializar\x20waVersion:',_0x1cd9b9);}const _0x37011f=_0x3b52e8[_0x5b4290(0x8a)]('.');if(_0x37011f[_0x5b4290(0xf3)]!==0x3)throw new Error('Formato\x20invÃ¡lido\x20para\x20versionWA.\x20Esperado:\x200.0000.0000000000');const [_0x51ef64,_0xa4ae61,_0x2c601f]=_0x37011f[_0x5b4290(0x9e)](Number);logger_1[_0x5b4290(0x76)][_0x5b4290(0xa1)]('using\x20WA\x20v'+_0x3b52e8),logger_1[_0x5b4290(0x76)][_0x5b4290(0xa1)](_0x5b4290(0xe4)+_0x4a029c),logger_1['logger']['info'](_0x5b4290(0x95)+_0xda03ff);let _0x26ea41=0x0,_0x3be3d3=null;const _0x301cf3=new node_cache_1['default']({'stdTTL':0x78,'checkperiod':0x1e,'useClones':![]});async function _0x220658(_0x1ee068){const _0xc727c6=_0x5b4290;if(!_0x1ee068['id'])return null;const _0x1f8bdf=_0x301cf3[_0xc727c6(0x7b)](_0x1ee068['id']);if(_0x1f8bdf)return logger_1['logger'][_0xc727c6(0x7e)]({'message':_0x1f8bdf},_0xc727c6(0xd1)),_0x1f8bdf;logger_1[_0xc727c6(0x76)]['debug']({'key':_0x1ee068},_0xc727c6(0xdd));const _0x31fa00=await Message_1[_0xc727c6(0xfa)][_0xc727c6(0x8f)]({'where':{'id':_0x1ee068['id'],'fromMe':!![]}});try{const _0xf8aa68=JSON[_0xc727c6(0xd5)](_0x31fa00['dataJson']);return logger_1['logger'][_0xc727c6(0x7e)]({'key':_0x1ee068,'data':_0xf8aa68},'cacheMessage:\x20recovered\x20from\x20database'),_0x301cf3[_0xc727c6(0x94)](_0x1ee068['id'],_0xf8aa68['message']),_0xf8aa68[_0xc727c6(0xc1)]||undefined;}catch(_0x47238f){logger_1['logger'][_0xc727c6(0xda)]({'key':_0x1ee068},'cacheMessage:\x20error\x20parsing\x20message\x20from\x20database\x20-\x20'+_0x47238f[_0xc727c6(0xc1)]);}return undefined;}const {state:_0x5ed408,saveState:_0x520208}=await(0x0,authState_1[_0x5b4290(0xfa)])(_0x47ea84),_0x3a621b=new node_cache_1[(_0x5b4290(0xfa))](),_0x433068=new node_cache_1[(_0x5b4290(0xfa))](),_0x105fee=new node_cache_1[(_0x5b4290(0xfa))]({'stdTTL':0x5*0x3c,'useClones':![]}),_0x51ed35={'get':_0x4bb2fe=>{const _0x2effe4=_0x5b4290;logger_1[_0x2effe4(0x76)][_0x2effe4(0x7e)](_0x2effe4(0xa9)+_0x4bb2fe);const _0x12d97d=_0x105fee[_0x2effe4(0x7b)](_0x4bb2fe);return!_0x12d97d&&(logger_1[_0x2effe4(0x76)]['debug'](_0x2effe4(0xa9)+_0x4bb2fe+'\x20not\x20found'),_0x3be3d3[_0x2effe4(0x79)](_0x4bb2fe)[_0x2effe4(0x97)](async _0x31d44f=>{const _0x6945b3=_0x2effe4;logger_1[_0x6945b3(0x76)][_0x6945b3(0x7e)]({'key':_0x4bb2fe,'metadata':_0x31d44f},_0x6945b3(0xa9)+_0x4bb2fe+_0x6945b3(0xa8)),_0x105fee[_0x6945b3(0x94)](_0x4bb2fe,_0x31d44f);})),_0x12d97d;},'set':(_0x415f2c,_0x3a2554)=>{const _0x542b60=_0x5b4290;return logger_1[_0x542b60(0x76)][_0x542b60(0x7e)]({'key':_0x415f2c,'value':_0x3a2554},'groupCache.set\x20'+_0x415f2c),_0x105fee[_0x542b60(0x94)](_0x415f2c,_0x3a2554);},'del':_0xaf058a=>{return logger_1['logger']['debug']('groupCache.del\x20'+_0xaf058a),_0x105fee['del'](_0xaf058a);},'flushAll':()=>{const _0x17219b=_0x5b4290;return logger_1[_0x17219b(0x76)]['debug'](_0x17219b(0x9c)),_0x105fee[_0x17219b(0x9d)]();}};_0x3be3d3=(0x0,baileys_1[_0x5b4290(0xfa)])({'logger':logger_1[_0x5b4290(0xcb)],'printQRInTerminal':![],'browser':[process[_0x5b4290(0xcf)][_0x5b4290(0xd0)]||_0x5b4290(0xe5),process[_0x5b4290(0xcf)][_0x5b4290(0xe3)]||'Chrome',process[_0x5b4290(0xcf)][_0x5b4290(0xc9)]||_0x5b4290(0xf2)],'auth':{'creds':_0x5ed408[_0x5b4290(0xdb)],'keys':(0x0,baileys_1[_0x5b4290(0x89)])(_0x5ed408[_0x5b4290(0x84)],logger_1[_0x5b4290(0xcb)])},'version':[_0x51ef64,_0xa4ae61,_0x2c601f],'defaultQueryTimeoutMs':0xea60,'msgRetryCounterCache':_0x3a621b,'generateHighQualityLinkPreview':!![],'userDevicesCache':_0x433068,'getMessage':_0x220658,'agent':_0x21e27e,'fetchAgent':_0x21e27e,'transactionOpts':{'maxCommitRetries':0x1,'delayBetweenTriesMs':0xa}}),_0x3be3d3['cacheMessage']=_0x14acd3=>{const _0x32cd86=_0x5b4290;if(!_0x14acd3[_0x32cd86(0x82)]['fromMe'])return;logger_1[_0x32cd86(0x76)]['debug']({'message':_0x14acd3[_0x32cd86(0xc1)]},_0x32cd86(0x87)),_0x301cf3[_0x32cd86(0x94)](_0x14acd3[_0x32cd86(0x82)]['id'],_0x14acd3[_0x32cd86(0xc1)]);},_0x3be3d3['ev']['on'](_0x5b4290(0x81),async({connection:_0x1d0ac4,lastDisconnect:_0x391d97,qr:_0x16f87e})=>{const _0x143f97=_0x5b4290;logger_1[_0x143f97(0x76)][_0x143f97(0xa1)]({'lastDisconnect':_0x391d97},_0x143f97(0xc0)+_0xda03ff+_0x143f97(0xb5)+(_0x1d0ac4||''));if(_0x1d0ac4==='close'){const _0x301c1c=_0x391d97?.[_0x143f97(0xda)]?.[_0x143f97(0xa6)]?.[_0x143f97(0xb3)];if(_0x301c1c===0x193)await _0x47ea84[_0x143f97(0xe1)]({'status':_0x143f97(0xae),'session':''}),await(0x0,DeleteBaileysService_1[_0x143f97(0xfa)])(_0x47ea84['id']),_0x73f06c[_0x143f97(0xbf)]('company-'+_0x47ea84['companyId']+_0x143f97(0x78),{'action':_0x143f97(0xe1),'session':_0x47ea84}),(0x0,exports['removeWbot'])(_0x57ee9c,![]);else{if(_0x301c1c===baileys_1['DisconnectReason']['restartRequired']||_0x301c1c===0x1f7)logger_1[_0x143f97(0x76)][_0x143f97(0xa1)](_0xda03ff+_0x143f97(0xa5)),(0x0,exports[_0x143f97(0xbc)])(_0x57ee9c,![])[_0x143f97(0x97)](()=>{setTimeout(async()=>{const _0x5a56ab=a361_0x3393;await _0x47ea84[_0x5a56ab(0x96)](),await(0x0,StartWhatsAppSession_1[_0x5a56ab(0x91)])(_0x47ea84,_0x47ea84[_0x5a56ab(0xf5)]);},0x3e8);});else _0x301c1c!==baileys_1[_0x143f97(0xc4)][_0x143f97(0xab)]?(await _0x47ea84[_0x143f97(0xe1)]({'status':_0x143f97(0xae)}),_0x73f06c[_0x143f97(0xbf)](_0x143f97(0x8d)+_0x47ea84[_0x143f97(0xf5)]+_0x143f97(0x78),{'action':_0x143f97(0xe1),'session':_0x47ea84}),(0x0,exports['removeWbot'])(_0x57ee9c,![])[_0x143f97(0x97)](()=>{const _0x3e76c7=_0x143f97;logger_1[_0x3e76c7(0x76)][_0x3e76c7(0xa1)](_0x3e76c7(0xf4)+_0xda03ff+_0x3e76c7(0xb9)),setTimeout(async()=>{const _0x10aaa7=_0x3e76c7;await _0x47ea84[_0x10aaa7(0x96)](),await(0x0,StartWhatsAppSession_1['StartWhatsAppSession'])(_0x47ea84,_0x47ea84[_0x10aaa7(0xf5)]);},0x7d0);})):(await _0x47ea84[_0x143f97(0xe1)]({'status':_0x143f97(0xae),'session':''}),await(0x0,DeleteBaileysService_1[_0x143f97(0xfa)])(_0x47ea84['id']),_0x73f06c[_0x143f97(0xbf)](_0x143f97(0x8d)+_0x47ea84['companyId']+_0x143f97(0x78),{'action':_0x143f97(0xe1),'session':_0x47ea84}),(0x0,exports[_0x143f97(0xbc)])(_0x57ee9c,![])[_0x143f97(0x97)](()=>{const _0x3882e0=_0x143f97;logger_1[_0x3882e0(0x76)]['info'](_0x3882e0(0xf4)+_0xda03ff+_0x3882e0(0xb9)),setTimeout(async()=>{const _0xfd3030=_0x3882e0;await _0x47ea84[_0xfd3030(0x96)](),await(0x0,StartWhatsAppSession_1[_0xfd3030(0x91)])(_0x47ea84,_0x47ea84['companyId']);},0x7d0);}));}}if(_0x1d0ac4===_0x143f97(0xe8)){await _0x47ea84[_0x143f97(0xe1)]({'status':_0x143f97(0xd8),'qrcode':'','retries':0x0,'number':_0x3be3d3['user']?.['id']?.['replace'](/:\d+/,'')}),_0x73f06c['emit'](_0x143f97(0x8d)+_0x47ea84[_0x143f97(0xf5)]+_0x143f97(0x78),{'action':_0x143f97(0xe1),'session':_0x47ea84});const _0x47271c=sessions[_0x143f97(0xdf)](_0xbd7953=>_0xbd7953['id']===_0x47ea84['id']);_0x47271c===-0x1&&(_0x3be3d3['id']=_0x47ea84['id'],sessions[_0x143f97(0x83)](_0x3be3d3)),_0x50d275(_0x3be3d3);}if(_0x16f87e!==undefined){if(retriesQrCodeMap[_0x143f97(0x7b)](_0x57ee9c)&&retriesQrCodeMap[_0x143f97(0x7b)](_0x57ee9c)>=0x3)await _0x10f1d8[_0x143f97(0xe1)]({'status':_0x143f97(0xac),'qrcode':''}),await(0x0,DeleteBaileysService_1[_0x143f97(0xfa)])(_0x10f1d8['id']),_0x73f06c[_0x143f97(0xbf)](_0x143f97(0xc7),{'action':_0x143f97(0xe1),'session':_0x10f1d8}),_0x3be3d3['ev'][_0x143f97(0xc6)](_0x143f97(0x81)),_0x3be3d3['ws'][_0x143f97(0xa0)](),_0x3be3d3=null,retriesQrCodeMap[_0x143f97(0xfe)](_0x57ee9c);else{logger_1[_0x143f97(0x76)][_0x143f97(0xa1)](_0x143f97(0xad)+_0xda03ff),retriesQrCodeMap['set'](_0x57ee9c,_0x26ea41+=0x1),await _0x47ea84[_0x143f97(0xe1)]({'qrcode':_0x16f87e,'status':_0x143f97(0xef),'retries':0x0});const _0x1beba3=sessions[_0x143f97(0xdf)](_0x2e84db=>_0x2e84db['id']===_0x47ea84['id']);_0x1beba3===-0x1&&(_0x3be3d3['id']=_0x47ea84['id'],sessions[_0x143f97(0x83)](_0x3be3d3)),_0x73f06c[_0x143f97(0xbf)](_0x143f97(0x8d)+_0x47ea84['companyId']+_0x143f97(0x78),{'action':_0x143f97(0xe1),'session':_0x47ea84});}}}),_0x3be3d3['ev']['on'](_0x5b4290(0x7d),_0x520208),_0x3be3d3['ev']['on'](_0x5b4290(0x99),async({id:_0x5720d1,presences:_0xd100ae})=>{const _0x47bbd4=_0x5b4290;try{const _0x23a52a=_0xd100ae[_0x5720d1]?.[_0x47bbd4(0xf1)];if(!_0x23a52a){logger_1[_0x47bbd4(0x76)][_0x47bbd4(0x7e)]('Ignoring\x20presence\x20from\x20possible\x20group');return;}const _0x14c737=(0x0,ExtractPhoneNumber_1[_0x47bbd4(0xfc)])(_0x5720d1),_0x3c7b05=await Contact_1[_0x47bbd4(0xfa)][_0x47bbd4(0x8f)]({'where':{'number':_0x14c737,'companyId':_0x47ea84['companyId']}});if(!_0x3c7b05){logger_1[_0x47bbd4(0x76)][_0x47bbd4(0x7e)](_0x47bbd4(0xc2)+_0x5720d1);return;}logger_1[_0x47bbd4(0x76)][_0x47bbd4(0x7e)](_0x47bbd4(0x92)+_0x3c7b05['id']+_0x47bbd4(0xf6)+_0x5720d1);const _0x53d45e=await Ticket_1[_0x47bbd4(0xfa)][_0x47bbd4(0x8f)]({'where':{'contactId':_0x3c7b05['id'],'whatsappId':_0x47ea84['id'],'status':{[sequelize_1['Op']['or']]:[_0x47bbd4(0xe8),'pending']}}});if(!_0x53d45e){logger_1[_0x47bbd4(0x76)]['debug'](_0x47bbd4(0xbd)+_0x3c7b05['id']);return;}const _0x3f2943=(0x0,socket_1[_0x47bbd4(0xc5)])();_0x3f2943['to'](_0x53d45e['id']['toString']())['to']('company-'+_0x47ea84[_0x47bbd4(0xf5)]+'-'+_0x53d45e['status'])['to'](_0x47bbd4(0x8e)+_0x53d45e['queueId']+'-'+_0x53d45e[_0x47bbd4(0xd3)])[_0x47bbd4(0xbf)](_0x47bbd4(0x8d)+_0x47ea84[_0x47bbd4(0xf5)]+_0x47bbd4(0xd4),{'ticketId':_0x53d45e['id'],'presence':_0x23a52a});}catch(_0x51b9d2){logger_1[_0x47bbd4(0x76)][_0x47bbd4(0xda)](_0x47bbd4(0xf8)+_0x51b9d2[_0x47bbd4(0xc1)]),Sentry[_0x47bbd4(0xa3)](_0x51b9d2);}}),_0x3be3d3['ev']['on']('groups.upsert',_0x13d7ef=>{const _0x2663a8=_0x5b4290;logger_1[_0x2663a8(0x76)]['debug'](_0x2663a8(0xec)),_0x13d7ef[_0x2663a8(0xb6)](_0x818f3d=>{const _0x25befe=_0x2663a8;_0x51ed35[_0x25befe(0x94)](_0x818f3d['id'],_0x818f3d);});}),_0x3be3d3['ev']['on'](_0x5b4290(0xf9),async([_0x4f8e7f])=>{const _0x1668a0=_0x5b4290;logger_1[_0x1668a0(0x76)][_0x1668a0(0x7e)](_0x1668a0(0xbb));const _0x16edee=await _0x3be3d3[_0x1668a0(0x79)](_0x4f8e7f['id']);_0x51ed35[_0x1668a0(0x94)](_0x4f8e7f['id'],_0x16edee);}),_0x3be3d3['ev']['on'](_0x5b4290(0xe2),async _0x313fd4=>{const _0x5b7567=_0x5b4290;logger_1[_0x5b7567(0x76)][_0x5b7567(0x7e)]('Received\x20group\x20participants\x20update');try{const _0x5a9d9c=await _0x3be3d3[_0x5b7567(0x79)](_0x313fd4['id']);_0x51ed35[_0x5b7567(0x94)](_0x313fd4['id'],_0x5a9d9c);}catch(_0xd70537){_0x51ed35[_0x5b7567(0xb1)](_0x313fd4['id']);}});})());}catch(_0x4f2830){Sentry[_0x42f7ef(0xa3)](_0x4f2830),console['log'](_0x4f2830),_0x44309c(_0x4f2830);}});};function a361_0x4304(){const _0x1b9cf4=['12080167nqxoUl','__importDefault','CONNECTED','__setModuleDefault','error','creds','71922rtWzZH','cacheMessage:\x20not\x20found\x20in\x20cache\x20-\x20fallback\x20to\x20database','constructor','findIndex','prototype','update','group-participants.update','BROWSER_NAME','isLegacy:\x20','Daumzap','toString','stable','open','writable','logout','1380QYPzhk','Received\x20new\x20group','./socket',',\x20isLatest:\x20','qrcode','configurable','lastKnownPresence','10.0','length','Reconnecting\x20','companyId','\x20for\x20number:\x20','__createBinding','Error\x20processing\x20presence\x20update:\x20','groups.update','default','Using\x20WA\x20v','getPhoneNumberFromJid','contacts.upsert','delete','../models/Whatsapp','logger','findAll','-whatsappSession','groupMetadata','sequelize','get','search','creds.update','debug','defineProperty','7qghtud','connection.update','key','push','keys','versionWA','../services/BaileysServices/DeleteBaileysService','cacheMessage:\x20saved','getOwnPropertyDescriptor','makeCacheableSignalKeyStore','split','call','105JHUFWg','company-','queue-','findOne','398200CNTWjc','StartWhatsAppSession','Found\x20contact\x20ID:\x20','12lgctWa','set','Starting\x20session\x20','reload','then','247504JgXlNS','presence.update','create','Erro\x20ao\x20obter\x20versionWA:','groupCache.flushAll','flushAll','map','initWASocket','close','info','@whiskeysockets/baileys','captureException','../models/Ticket','\x20restart\x20required\x20(503),\x20reconnecting\x20immediately...','output','groups.upsert','\x20set','groupCache.get\x20','16488IRHMyV','loggedOut','DISCONNECTED','Session\x20QRCode\x20Generate\x20','PENDING','getOwnPropertyNames','../errors/AppError','del','733768qiyKOf','statusCode','6kumZKG','\x20Connection\x20Update\x20','forEach','202248LVMCbA','../helpers/authState','\x20in\x202\x20seconds','end','Received\x20group\x20update','removeWbot','No\x20active\x20ticket\x20found\x20for\x20contact\x20','../services/WbotServices/StartWhatsAppSession','emit','Socket\x20\x20','message','Contact\x20not\x20found\x20for\x20','getWbot','DisconnectReason','getIO','removeAllListeners','whatsappSession','(((.+)+)+)+$','BROWSER_VERSION','__esModule','loggerBaileys','../services/SettingServices/GetPublicSettingService','restartWbot','CONFIG_SESSION_WA_CONNECTION','env','BROWSER_CLIENT','cacheMessage:\x20recovered\x20from\x20cache','hasOwnProperty','status','-presence','parse'];a361_0x4304=function(){return _0x1b9cf4;};return a361_0x4304();}exports[a361_0xa248f5(0x9f)]=initWASocket;