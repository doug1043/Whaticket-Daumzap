'use strict';const a294_0x440969=a294_0x2b51;function a294_0x29da(){const _0x6ce8b1=['keys','groupCache.flushAll','defineProperty','key','findIndex','\x20in\x202\x20seconds','Using\x20WA\x20v','split','companyId','__setModuleDefault','DISCONNECTED','contacts.upsert','queue-','dataJson','update','search','end','Erro\x20ao\x20obter\x20versionWA:','\x20Connection\x20Update\x20','CONFIG_SESSION_WA_CONNECTION','getWbot','Error\x20processing\x20presence\x20update:\x20','10.0','output','../services/BaileysServices/DeleteBaileysService','3155264VtyVWT','@newsletter','1814702SzHyBk','lastKnownPresence','groupCache.get\x20',',\x20isLatest:\x20','\x20for\x20number:\x20','set','default','109994wbphtA','(((.+)+)+)+$','push','then','groups.upsert','toString','getOwnPropertyDescriptor','flushAll','presence.update','versionWA','open','removeWbot','cacheMessage:\x20recovered\x20from\x20cache','../utils/logger','logger','cacheMessage:\x20recovered\x20from\x20database','initWASocket','endsWith','sequelize','-presence','No\x20active\x20ticket\x20found\x20for\x20contact\x20','env','../models/Contact','findAll','Chrome','Reconnecting\x20','delete','captureException','message','pending','4204380MqMUXv','750144XjEIYM','StartWhatsAppSession','Found\x20contact\x20ID:\x20','forEach','queueId','../services/WbotServices/StartWhatsAppSession','close','creds.update','cacheMessage:\x20saved','statusCode','error','loggerBaileys','\x20set','get','call','Session\x20QRCode\x20Generate\x20','BROWSER_NAME','10993451UQtnjq','18ikYsFL','splice','\x20not\x20found','Contact\x20not\x20found\x20for\x20','Received\x20new\x20group','cacheMessage:\x20error\x20parsing\x20message\x20from\x20database\x20-\x20','groupMetadata','DisconnectReason','@whiskeysockets/baileys','groups.update','connection.update','Formato\x20inv√°lido\x20para\x20versionWA.\x20Esperado:\x200.0000.0000000000','stable','getIO','findOne','PENDING','info','prototype','loggedOut','qrcode','hasOwnProperty','group-participants.update','using\x20WA\x20v','__esModule','node-cache','configurable','reload','../services/SettingServices/GetPublicSettingService','getOwnPropertyNames','../errors/AppError','company-','2440045EXtnms','creds','__importDefault','Erro\x20ao\x20inicializar\x20waVersion:','isJidBroadcast','emit','map','constructor','restartWbot','create','groupCache.del\x20','../models/Message','BROWSER_CLIENT','del','apply','ERR_WAPP_NOT_INITIALIZED','__importStar','debug','Daumzap','81bmeHkL','@sentry/node','../models/Whatsapp','length','BROWSER_VERSION','-whatsappSession','isLegacy:\x20','cacheMessage','__createBinding','removeAllListeners','status','makeCacheableSignalKeyStore'];a294_0x29da=function(){return _0x6ce8b1;};return a294_0x29da();}(function(_0x54b7a7,_0x228005){const _0x672bf5=a294_0x2b51,_0x39966e=_0x54b7a7();while(!![]){try{const _0x4f47ad=-parseInt(_0x672bf5(0x143))/0x1+parseInt(_0x672bf5(0x13c))/0x2+parseInt(_0x672bf5(0x161))/0x3+parseInt(_0x672bf5(0x1cb))/0x4+parseInt(_0x672bf5(0x193))/0x5*(-parseInt(_0x672bf5(0x174))/0x6)+-parseInt(_0x672bf5(0x173))/0x7+-parseInt(_0x672bf5(0x162))/0x8*(-parseInt(_0x672bf5(0x1a6))/0x9);if(_0x4f47ad===_0x228005)break;else _0x39966e['push'](_0x39966e['shift']());}catch(_0x208233){_0x39966e['push'](_0x39966e['shift']());}}}(a294_0x29da,0xc2961));var __createBinding=this&&this[a294_0x440969(0x1ae)]||(Object[a294_0x440969(0x19c)]?function(_0xffa0e5,_0x280b29,_0x5c5847,_0x235559){const _0x276dbc=a294_0x440969;if(_0x235559===undefined)_0x235559=_0x5c5847;var _0x1fa339=Object[_0x276dbc(0x149)](_0x280b29,_0x5c5847);(!_0x1fa339||(_0x276dbc(0x16f)in _0x1fa339?!_0x280b29[_0x276dbc(0x18b)]:_0x1fa339['writable']||_0x1fa339[_0x276dbc(0x18d)]))&&(_0x1fa339={'enumerable':!![],'get':function(){return _0x280b29[_0x5c5847];}}),Object['defineProperty'](_0xffa0e5,_0x235559,_0x1fa339);}:function(_0x2aeacf,_0x41f68e,_0x5982fa,_0x41f849){if(_0x41f849===undefined)_0x41f849=_0x5982fa;_0x2aeacf[_0x41f849]=_0x41f68e[_0x5982fa];}),__setModuleDefault=this&&this[a294_0x440969(0x1bb)]||(Object[a294_0x440969(0x19c)]?function(_0x233529,_0x5d5f06){const _0x450273=a294_0x440969;Object[_0x450273(0x1b4)](_0x233529,_0x450273(0x142),{'enumerable':!![],'value':_0x5d5f06});}:function(_0x15895d,_0x325a11){const _0x591b78=a294_0x440969;_0x15895d[_0x591b78(0x142)]=_0x325a11;}),__importStar=this&&this[a294_0x440969(0x1a3)]||(function(){const _0x527206=(function(){let _0x2ddb11=!![];return function(_0x344a8d,_0x29cf9c){const _0x12c8ba=_0x2ddb11?function(){const _0x41350a=a294_0x2b51;if(_0x29cf9c){const _0x470d09=_0x29cf9c[_0x41350a(0x1a1)](_0x344a8d,arguments);return _0x29cf9c=null,_0x470d09;}}:function(){};return _0x2ddb11=![],_0x12c8ba;};}()),_0x5d5cb3=_0x527206(this,function(){const _0x7f4e1c=a294_0x2b51;return _0x5d5cb3[_0x7f4e1c(0x148)]()[_0x7f4e1c(0x1c1)](_0x7f4e1c(0x144))[_0x7f4e1c(0x148)]()[_0x7f4e1c(0x19a)](_0x5d5cb3)[_0x7f4e1c(0x1c1)](_0x7f4e1c(0x144));});_0x5d5cb3();var _0x6fa845=function(_0x5aee94){const _0x11d649=a294_0x2b51;return _0x6fa845=Object[_0x11d649(0x190)]||function(_0x4a0ac0){const _0x2a512e=_0x11d649;var _0x47ce1d=[];for(var _0xda079d in _0x4a0ac0)if(Object[_0x2a512e(0x185)][_0x2a512e(0x188)][_0x2a512e(0x170)](_0x4a0ac0,_0xda079d))_0x47ce1d[_0x47ce1d[_0x2a512e(0x1a9)]]=_0xda079d;return _0x47ce1d;},_0x6fa845(_0x5aee94);};return function(_0x1033a7){const _0x3c6656=a294_0x2b51;if(_0x1033a7&&_0x1033a7[_0x3c6656(0x18b)])return _0x1033a7;var _0x3cc302={};if(_0x1033a7!=null){for(var _0xf114ab=_0x6fa845(_0x1033a7),_0x858939=0x0;_0x858939<_0xf114ab['length'];_0x858939++)if(_0xf114ab[_0x858939]!=='default')__createBinding(_0x3cc302,_0x1033a7,_0xf114ab[_0x858939]);}return __setModuleDefault(_0x3cc302,_0x1033a7),_0x3cc302;};}()),__importDefault=this&&this[a294_0x440969(0x195)]||function(_0x3f8259){const _0x56753d=a294_0x440969;return _0x3f8259&&_0x3f8259[_0x56753d(0x18b)]?_0x3f8259:{'default':_0x3f8259};};Object[a294_0x440969(0x1b4)](exports,a294_0x440969(0x18b),{'value':!![]}),exports['initWASocket']=exports[a294_0x440969(0x19b)]=exports[a294_0x440969(0x14e)]=exports[a294_0x440969(0x1c6)]=void 0x0;function a294_0x2b51(_0x5d848a,_0x547709){const _0x5b9ee2=a294_0x29da();return a294_0x2b51=function(_0x4a0d83,_0x5634f6){_0x4a0d83=_0x4a0d83-0x13b;let _0x29da15=_0x5b9ee2[_0x4a0d83];return _0x29da15;},a294_0x2b51(_0x5d848a,_0x547709);}const Sentry=__importStar(require(a294_0x440969(0x1a7))),baileys_1=__importStar(require(a294_0x440969(0x17c))),node_cache_1=__importDefault(require(a294_0x440969(0x18c))),sequelize_1=require(a294_0x440969(0x155)),Whatsapp_1=__importDefault(require(a294_0x440969(0x1a8))),logger_1=require(a294_0x440969(0x150)),authState_1=__importDefault(require('../helpers/authState')),AppError_1=__importDefault(require(a294_0x440969(0x191))),socket_1=require('./socket'),StartWhatsAppSession_1=require(a294_0x440969(0x167)),DeleteBaileysService_1=__importDefault(require(a294_0x440969(0x1ca))),Contact_1=__importDefault(require(a294_0x440969(0x159))),Ticket_1=__importDefault(require('../models/Ticket')),GetPublicSettingService_1=__importDefault(require(a294_0x440969(0x18f))),Message_1=__importDefault(require(a294_0x440969(0x19e))),sessions=[],retriesQrCodeMap=new Map(),getWbot=_0x107159=>{const _0x5308f4=a294_0x440969,_0x5118ff=sessions[_0x5308f4(0x1b6)](_0x2d5300=>_0x2d5300['id']===_0x107159);if(_0x5118ff===-0x1)throw new AppError_1['default'](_0x5308f4(0x1a2));return sessions[_0x5118ff];};exports[a294_0x440969(0x1c6)]=getWbot;const removeWbot=async(_0x32838f,_0x2ae92a=!![])=>{const _0x1fa397=a294_0x440969;try{const _0x3cb51b=sessions[_0x1fa397(0x1b6)](_0x160563=>_0x160563['id']===_0x32838f);_0x3cb51b!==-0x1&&(_0x2ae92a&&await sessions[_0x3cb51b]['logout'](),sessions[_0x3cb51b]['ev']['removeAllListeners'](_0x1fa397(0x17e)),sessions[_0x3cb51b]['ev']['removeAllListeners']('creds.update'),sessions[_0x3cb51b]['ev'][_0x1fa397(0x1af)]('presence.update'),sessions[_0x3cb51b]['ev'][_0x1fa397(0x1af)](_0x1fa397(0x147)),sessions[_0x3cb51b]['ev']['removeAllListeners'](_0x1fa397(0x17d)),sessions[_0x3cb51b]['ev'][_0x1fa397(0x1af)](_0x1fa397(0x189)),sessions[_0x3cb51b]['ev'][_0x1fa397(0x1af)](_0x1fa397(0x1bd)),sessions[_0x3cb51b][_0x1fa397(0x1c2)](null),sessions[_0x3cb51b]['ws'][_0x1fa397(0x1af)](),await sessions[_0x3cb51b]['ws'][_0x1fa397(0x168)](),sessions[_0x1fa397(0x175)](_0x3cb51b,0x1));}catch(_0x519d9a){logger_1[_0x1fa397(0x151)][_0x1fa397(0x16c)](_0x519d9a);}};exports[a294_0x440969(0x14e)]=removeWbot;const getVersionWA=async()=>{const _0x37cca2=a294_0x440969;try{const _0x512b9d=_0x37cca2(0x14c),_0x180077=0x1,_0x460eaf=await(0x0,GetPublicSettingService_1[_0x37cca2(0x142)])({'key':_0x512b9d,'companyId':_0x180077});return _0x460eaf||process['env'][_0x37cca2(0x1c5)];}catch(_0x4d3f76){return console['error'](_0x37cca2(0x1c3),_0x4d3f76),process[_0x37cca2(0x158)][_0x37cca2(0x1c5)];}},restartWbot=async(_0x35d6cf,_0x4530b1)=>{const _0xf0bc37=a294_0x440969;try{const _0x33e958={'where':{'companyId':_0x35d6cf},'attributes':['id']},_0x42de7a=await Whatsapp_1['default'][_0xf0bc37(0x15a)](_0x33e958);_0x42de7a[_0xf0bc37(0x199)](async _0xaf6a2c=>{const _0x43bbdc=_0xf0bc37,_0x1f57d5=sessions[_0x43bbdc(0x1b6)](_0x557cfb=>_0x557cfb['id']===_0xaf6a2c['id']);_0x1f57d5!==-0x1&&sessions[_0x1f57d5]['ws'][_0x43bbdc(0x168)]();});}catch(_0x2d2abc){logger_1[_0xf0bc37(0x151)]['error'](_0x2d2abc);}};exports['restartWbot']=restartWbot;const initWASocket=async(_0x3ac113,_0x132282)=>{return new Promise((_0x536b50,_0x22d26f)=>{const _0x205767=a294_0x2b51;try{((async()=>{const _0x1fead1=a294_0x2b51,_0xaf0fd9=(0x0,socket_1['getIO'])(),_0x53ca0e=await Whatsapp_1[_0x1fead1(0x142)][_0x1fead1(0x182)]({'where':{'id':_0x3ac113['id']}});if(!_0x53ca0e)return;const {id:_0x60a06e,name:_0x5ed080,provider:_0x449f62}=_0x53ca0e;let _0x4b82e2;const _0xd9b715=_0x449f62===_0x1fead1(0x180);try{_0x4b82e2=await getVersionWA(),logger_1[_0x1fead1(0x151)][_0x1fead1(0x184)](_0x1fead1(0x1b8)+_0x4b82e2+_0x1fead1(0x13f)+_0xd9b715);}catch(_0x24ab29){console[_0x1fead1(0x16c)](_0x1fead1(0x196),_0x24ab29);}const _0x2dc48b=_0x4b82e2[_0x1fead1(0x1b9)]('.');if(_0x2dc48b[_0x1fead1(0x1a9)]!==0x3)throw new Error(_0x1fead1(0x17f));const [_0x57bd5a,_0x2dcd55,_0x41fd4e]=_0x2dc48b[_0x1fead1(0x199)](Number);logger_1[_0x1fead1(0x151)][_0x1fead1(0x184)](_0x1fead1(0x18a)+_0x4b82e2),logger_1[_0x1fead1(0x151)]['info'](_0x1fead1(0x1ac)+_0xd9b715),logger_1[_0x1fead1(0x151)][_0x1fead1(0x184)]('Starting\x20session\x20'+_0x5ed080);let _0x2c3bf2=0x0,_0x5900c9=null;const _0x3ce871=new node_cache_1[(_0x1fead1(0x142))]({'stdTTL':0x78,'checkperiod':0x1e,'useClones':![]});async function _0x4ff1f2(_0x1019b3){const _0x34534b=_0x1fead1;if(!_0x1019b3['id'])return null;const _0x3cc7eb=_0x3ce871[_0x34534b(0x16f)](_0x1019b3['id']);if(_0x3cc7eb)return logger_1['logger']['debug']({'message':_0x3cc7eb},_0x34534b(0x14f)),_0x3cc7eb;logger_1[_0x34534b(0x151)][_0x34534b(0x1a4)]({'key':_0x1019b3},'cacheMessage:\x20not\x20found\x20in\x20cache\x20-\x20fallback\x20to\x20database');const _0x207104=await Message_1[_0x34534b(0x142)][_0x34534b(0x182)]({'where':{'id':_0x1019b3['id'],'fromMe':!![]}});try{const _0x970e85=JSON['parse'](_0x207104[_0x34534b(0x1bf)]);return logger_1[_0x34534b(0x151)][_0x34534b(0x1a4)]({'key':_0x1019b3,'data':_0x970e85},_0x34534b(0x152)),_0x3ce871[_0x34534b(0x141)](_0x1019b3['id'],_0x970e85['message']),_0x970e85[_0x34534b(0x15f)]||undefined;}catch(_0x2a0460){logger_1[_0x34534b(0x151)][_0x34534b(0x16c)]({'key':_0x1019b3},_0x34534b(0x179)+_0x2a0460[_0x34534b(0x15f)]);}return undefined;}const {state:_0x15b679,saveState:_0x2d227c}=await(0x0,authState_1[_0x1fead1(0x142)])(_0x3ac113),_0x4a9363=new node_cache_1[(_0x1fead1(0x142))](),_0x5904d4=new node_cache_1['default'](),_0x4cd64d=new node_cache_1['default']({'stdTTL':0x5*0x3c,'useClones':![]}),_0x25818d={'get':_0x372ee9=>{const _0x22a862=_0x1fead1;logger_1[_0x22a862(0x151)]['debug']('groupCache.get\x20'+_0x372ee9);const _0x3390b9=_0x4cd64d['get'](_0x372ee9);return!_0x3390b9&&(logger_1[_0x22a862(0x151)][_0x22a862(0x1a4)](_0x22a862(0x13e)+_0x372ee9+_0x22a862(0x176)),_0x5900c9[_0x22a862(0x17a)](_0x372ee9)['then'](async _0xff841b=>{const _0x10f0e7=_0x22a862;logger_1[_0x10f0e7(0x151)][_0x10f0e7(0x1a4)]({'key':_0x372ee9,'metadata':_0xff841b},'groupCache.get\x20'+_0x372ee9+_0x10f0e7(0x16e)),_0x4cd64d['set'](_0x372ee9,_0xff841b);})),_0x3390b9;},'set':async(_0x19e0dd,_0x337d60)=>{const _0x352bdb=_0x1fead1;return logger_1['logger'][_0x352bdb(0x1a4)]({'key':_0x19e0dd,'value':_0x337d60},'groupCache.set\x20'+_0x19e0dd),_0x4cd64d[_0x352bdb(0x141)](_0x19e0dd,_0x337d60);},'del':async _0x3ccfa0=>{const _0x387cc9=_0x1fead1;return logger_1[_0x387cc9(0x151)][_0x387cc9(0x1a4)](_0x387cc9(0x19d)+_0x3ccfa0),_0x4cd64d[_0x387cc9(0x1a0)](_0x3ccfa0);},'flushAll':async()=>{const _0x425b3a=_0x1fead1;return logger_1[_0x425b3a(0x151)]['debug'](_0x425b3a(0x1b3)),_0x4cd64d[_0x425b3a(0x14a)]();}};_0x5900c9=(0x0,baileys_1['default'])({'logger':logger_1[_0x1fead1(0x16d)],'printQRInTerminal':![],'emitOwnEvents':![],'browser':[process[_0x1fead1(0x158)][_0x1fead1(0x19f)]||_0x1fead1(0x1a5),process[_0x1fead1(0x158)][_0x1fead1(0x172)]||_0x1fead1(0x15b),process['env'][_0x1fead1(0x1aa)]||_0x1fead1(0x1c8)],'auth':{'creds':_0x15b679[_0x1fead1(0x194)],'keys':(0x0,baileys_1[_0x1fead1(0x1b1)])(_0x15b679[_0x1fead1(0x1b2)],logger_1[_0x1fead1(0x16d)])},'version':[_0x57bd5a,_0x2dcd55,_0x41fd4e],'defaultQueryTimeoutMs':0xea60,'msgRetryCounterCache':_0x4a9363,'generateHighQualityLinkPreview':!![],'userDevicesCache':_0x5904d4,'getMessage':_0x4ff1f2,'agent':_0x132282,'fetchAgent':_0x132282,'cachedGroupMetadata':async _0x1f6034=>_0x25818d[_0x1fead1(0x16f)](_0x1f6034),'shouldIgnoreJid':_0x3120dd=>(0x0,baileys_1[_0x1fead1(0x197)])(_0x3120dd)||_0x3120dd?.[_0x1fead1(0x154)](_0x1fead1(0x13b)),'transactionOpts':{'maxCommitRetries':0x1,'delayBetweenTriesMs':0xa}}),_0x5900c9[_0x1fead1(0x1ad)]=_0x596a4c=>{const _0x3482d6=_0x1fead1;if(!_0x596a4c[_0x3482d6(0x1b5)]['fromMe'])return;logger_1[_0x3482d6(0x151)][_0x3482d6(0x1a4)]({'message':_0x596a4c[_0x3482d6(0x15f)]},_0x3482d6(0x16a)),_0x3ce871[_0x3482d6(0x141)](_0x596a4c[_0x3482d6(0x1b5)]['id'],_0x596a4c[_0x3482d6(0x15f)]);},_0x5900c9['ev']['on'](_0x1fead1(0x17e),async({connection:_0x34132d,lastDisconnect:_0x5dc897,qr:_0x39571e})=>{const _0x55bab7=_0x1fead1;logger_1[_0x55bab7(0x151)][_0x55bab7(0x184)]({'lastDisconnect':_0x5dc897},'Socket\x20\x20'+_0x5ed080+_0x55bab7(0x1c4)+(_0x34132d||''));_0x34132d===_0x55bab7(0x168)&&(_0x5dc897?.[_0x55bab7(0x16c)]?.[_0x55bab7(0x1c9)]?.[_0x55bab7(0x16b)]===0x193&&(await _0x3ac113[_0x55bab7(0x1c0)]({'status':'PENDING','session':''}),await(0x0,DeleteBaileysService_1['default'])(_0x3ac113['id']),_0xaf0fd9[_0x55bab7(0x198)](_0x55bab7(0x192)+_0x3ac113[_0x55bab7(0x1ba)]+_0x55bab7(0x1ab),{'action':_0x55bab7(0x1c0),'session':_0x3ac113}),(0x0,exports[_0x55bab7(0x14e)])(_0x60a06e,![])),_0x5dc897?.[_0x55bab7(0x16c)]?.['output']?.[_0x55bab7(0x16b)]!==baileys_1[_0x55bab7(0x17b)][_0x55bab7(0x186)]?(await _0x3ac113[_0x55bab7(0x1c0)]({'status':'PENDING'}),_0xaf0fd9[_0x55bab7(0x198)](_0x55bab7(0x192)+_0x3ac113[_0x55bab7(0x1ba)]+_0x55bab7(0x1ab),{'action':_0x55bab7(0x1c0),'session':_0x3ac113}),(0x0,exports[_0x55bab7(0x14e)])(_0x60a06e,![])['then'](()=>{const _0xc3cb72=_0x55bab7;logger_1['logger'][_0xc3cb72(0x184)](_0xc3cb72(0x15c)+_0x5ed080+_0xc3cb72(0x1b7)),setTimeout(async()=>{const _0x37693b=_0xc3cb72;await _0x3ac113['reload'](),await(0x0,StartWhatsAppSession_1[_0x37693b(0x163)])(_0x3ac113,_0x3ac113[_0x37693b(0x1ba)]);},0x7d0);})):(await _0x3ac113[_0x55bab7(0x1c0)]({'status':_0x55bab7(0x183),'session':''}),await(0x0,DeleteBaileysService_1[_0x55bab7(0x142)])(_0x3ac113['id']),_0xaf0fd9[_0x55bab7(0x198)]('company-'+_0x3ac113[_0x55bab7(0x1ba)]+_0x55bab7(0x1ab),{'action':'update','session':_0x3ac113}),(0x0,exports[_0x55bab7(0x14e)])(_0x60a06e,![])[_0x55bab7(0x146)](()=>{const _0x1d943e=_0x55bab7;logger_1[_0x1d943e(0x151)][_0x1d943e(0x184)](_0x1d943e(0x15c)+_0x5ed080+'\x20in\x202\x20seconds'),setTimeout(async()=>{const _0x22bd6e=_0x1d943e;await _0x3ac113[_0x22bd6e(0x18e)](),await(0x0,StartWhatsAppSession_1['StartWhatsAppSession'])(_0x3ac113,_0x3ac113[_0x22bd6e(0x1ba)]);},0x7d0);})));if(_0x34132d===_0x55bab7(0x14d)){await _0x3ac113[_0x55bab7(0x1c0)]({'status':'CONNECTED','qrcode':'','retries':0x0}),_0xaf0fd9[_0x55bab7(0x198)](_0x55bab7(0x192)+_0x3ac113['companyId']+_0x55bab7(0x1ab),{'action':_0x55bab7(0x1c0),'session':_0x3ac113});const _0x517c5f=sessions[_0x55bab7(0x1b6)](_0x44f374=>_0x44f374['id']===_0x3ac113['id']);_0x517c5f===-0x1&&(_0x5900c9['id']=_0x3ac113['id'],sessions[_0x55bab7(0x145)](_0x5900c9)),_0x536b50(_0x5900c9);}if(_0x39571e!==undefined){if(retriesQrCodeMap[_0x55bab7(0x16f)](_0x60a06e)&&retriesQrCodeMap[_0x55bab7(0x16f)](_0x60a06e)>=0x3)await _0x53ca0e[_0x55bab7(0x1c0)]({'status':_0x55bab7(0x1bc),'qrcode':''}),await(0x0,DeleteBaileysService_1[_0x55bab7(0x142)])(_0x53ca0e['id']),_0xaf0fd9[_0x55bab7(0x198)]('whatsappSession',{'action':_0x55bab7(0x1c0),'session':_0x53ca0e}),_0x5900c9['ev'][_0x55bab7(0x1af)](_0x55bab7(0x17e)),_0x5900c9['ws'][_0x55bab7(0x168)](),_0x5900c9=null,retriesQrCodeMap[_0x55bab7(0x15d)](_0x60a06e);else{logger_1[_0x55bab7(0x151)][_0x55bab7(0x184)](_0x55bab7(0x171)+_0x5ed080),retriesQrCodeMap[_0x55bab7(0x141)](_0x60a06e,_0x2c3bf2+=0x1),await _0x3ac113['update']({'qrcode':_0x39571e,'status':_0x55bab7(0x187),'retries':0x0});const _0x31fb85=sessions['findIndex'](_0x2b367a=>_0x2b367a['id']===_0x3ac113['id']);_0x31fb85===-0x1&&(_0x5900c9['id']=_0x3ac113['id'],sessions[_0x55bab7(0x145)](_0x5900c9)),_0xaf0fd9[_0x55bab7(0x198)](_0x55bab7(0x192)+_0x3ac113[_0x55bab7(0x1ba)]+_0x55bab7(0x1ab),{'action':_0x55bab7(0x1c0),'session':_0x3ac113});}}}),_0x5900c9['ev']['on'](_0x1fead1(0x169),_0x2d227c),_0x5900c9['ev']['on'](_0x1fead1(0x14b),async({id:_0x8d70dd,presences:_0x3fb014})=>{const _0x126601=_0x1fead1;try{const _0x1f2074=_0x3fb014[_0x8d70dd]?.[_0x126601(0x13d)];if(!_0x1f2074){logger_1[_0x126601(0x151)][_0x126601(0x1a4)]('Ignoring\x20presence\x20from\x20possible\x20group');return;}const _0x5f5b4b=await Contact_1[_0x126601(0x142)]['findOne']({'where':{'number':_0x8d70dd['replace'](/\D/g,''),'companyId':_0x3ac113[_0x126601(0x1ba)]}});if(!_0x5f5b4b){logger_1[_0x126601(0x151)]['debug'](_0x126601(0x177)+_0x8d70dd);return;}logger_1[_0x126601(0x151)][_0x126601(0x1a4)](_0x126601(0x164)+_0x5f5b4b['id']+_0x126601(0x140)+_0x8d70dd);const _0x4d9511=await Ticket_1[_0x126601(0x142)][_0x126601(0x182)]({'where':{'contactId':_0x5f5b4b['id'],'whatsappId':_0x3ac113['id'],'status':{[sequelize_1['Op']['or']]:[_0x126601(0x14d),_0x126601(0x160)]}}});if(!_0x4d9511){logger_1[_0x126601(0x151)][_0x126601(0x1a4)](_0x126601(0x157)+_0x5f5b4b['id']);return;}const _0x32587d=(0x0,socket_1[_0x126601(0x181)])();_0x32587d['to'](_0x4d9511['id'][_0x126601(0x148)]())['to'](_0x126601(0x192)+_0x3ac113[_0x126601(0x1ba)]+'-'+_0x4d9511['status'])['to'](_0x126601(0x1be)+_0x4d9511[_0x126601(0x166)]+'-'+_0x4d9511[_0x126601(0x1b0)])[_0x126601(0x198)](_0x126601(0x192)+_0x3ac113[_0x126601(0x1ba)]+_0x126601(0x156),{'ticketId':_0x4d9511['id'],'presence':_0x1f2074});}catch(_0x5e0460){logger_1['logger'][_0x126601(0x16c)](_0x126601(0x1c7)+_0x5e0460[_0x126601(0x15f)]),Sentry[_0x126601(0x15e)](_0x5e0460);}}),_0x5900c9['ev']['on'](_0x1fead1(0x147),_0x14df23=>{const _0x38e76e=_0x1fead1;logger_1['logger']['debug'](_0x38e76e(0x178)),_0x14df23[_0x38e76e(0x165)](_0x858ca1=>{_0x25818d['set'](_0x858ca1['id'],_0x858ca1);});}),_0x5900c9['ev']['on'](_0x1fead1(0x17d),async([_0x58e078])=>{const _0x25d043=_0x1fead1;logger_1['logger'][_0x25d043(0x1a4)]('Received\x20group\x20update');const _0x294acf=await _0x5900c9['groupMetadata'](_0x58e078['id']);_0x25818d[_0x25d043(0x141)](_0x58e078['id'],_0x294acf);}),_0x5900c9['ev']['on'](_0x1fead1(0x189),async _0x3df988=>{const _0x4dd828=_0x1fead1;logger_1[_0x4dd828(0x151)][_0x4dd828(0x1a4)]('Received\x20group\x20participants\x20update');try{const _0x5be3f0=await _0x5900c9[_0x4dd828(0x17a)](_0x3df988['id']);_0x25818d[_0x4dd828(0x141)](_0x3df988['id'],_0x5be3f0);}catch(_0x124ef2){_0x25818d[_0x4dd828(0x1a0)](_0x3df988['id']);}});})());}catch(_0x2a2258){Sentry[_0x205767(0x15e)](_0x2a2258),console['log'](_0x2a2258),_0x22d26f(_0x2a2258);}});};exports[a294_0x440969(0x153)]=initWASocket;