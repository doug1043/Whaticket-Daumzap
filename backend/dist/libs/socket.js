const a361_0x1d71f7=a361_0x4d63;(function(_0x4f1d59,_0x519931){const _0x4473c8=a361_0x4d63,_0x44eab8=_0x4f1d59();while(!![]){try{const _0x326ad7=-parseInt(_0x4473c8(0xd6))/0x1+-parseInt(_0x4473c8(0xc7))/0x2*(-parseInt(_0x4473c8(0x11f))/0x3)+parseInt(_0x4473c8(0xef))/0x4+-parseInt(_0x4473c8(0xb3))/0x5*(parseInt(_0x4473c8(0xe4))/0x6)+-parseInt(_0x4473c8(0xd5))/0x7+-parseInt(_0x4473c8(0xae))/0x8+parseInt(_0x4473c8(0xa6))/0x9;if(_0x326ad7===_0x519931)break;else _0x44eab8['push'](_0x44eab8['shift']());}catch(_0x454230){_0x44eab8['push'](_0x44eab8['shift']());}}}(a361_0x3fa3,0xeb88c));const a361_0x375e5e=(function(){let _0x53fb23=!![];return function(_0x2bd52f,_0x1f93dc){const _0x1b3bd6=_0x53fb23?function(){if(_0x1f93dc){const _0x47a013=_0x1f93dc['apply'](_0x2bd52f,arguments);return _0x1f93dc=null,_0x47a013;}}:function(){};return _0x53fb23=![],_0x1b3bd6;};}()),a361_0x262641=a361_0x375e5e(this,function(){const _0xd8343d=a361_0x4d63;return a361_0x262641[_0xd8343d(0xa7)]()['search'](_0xd8343d(0x101))['toString']()['constructor'](a361_0x262641)[_0xd8343d(0x10d)](_0xd8343d(0x101));});a361_0x262641();function a361_0x3fa3(){const _0x32f0ed=['recording','Socket\x20IO\x20not\x20initialized','debugConnection','sockets','leaveNotification[','../helpers/CheckSettings','1649604WKUTTm','queues','leave','update','SOCKET_ADMIN','company-','\x20not\x20authorized\x20to\x20join\x20ticket\x20','joinNotification[','get','\x20emitted\x20for\x20ticket\x20','size','Client\x20Connected:\x20','user-','notification','passwordHash','\x20in\x20company\x20','\x20joined\x20queue\x20','\x20for\x20ticket\x20','(((.+)+)+)+$','emit','leaveChatbox[','-pending','User\x20','Admin\x20','\x20for\x20user\x20','joinTickets',']:\x20Channel:\x20','\x20leaved\x20','info','Received\x20checkPresence\x20for\x20ticket\x20','search','onConnect:\x20User\x20','query','queue-','\x20tickets\x20channel.','env','../models/UserSocketSession','initIO','../errors/AppError','incrementCounter','from','groupsTab','logger','admin','\x20by\x20user\x20','emitPresence','instrument','message','6awSeyZ','\x20cannot\x20subscribe\x20to\x20','../utils/logger','joinChatBox','Socket\x20IO\x20not\x20initialized\x20when\x20trying\x20to\x20emit\x20presence','../models/Queue','-notification','jsonwebtoken','join','Socket\x20stats\x20-\x20Main\x20company\x20room:\x20','./counter','some','create','Error\x20fetching\x20ticket\x20','enabled','leaveChatBox','online','-open','\x20leaved\x20queue\x20','save','disabled','started\x20session\x20','email','pending','Ticket\x20room:\x20','forEach','__esModule','Error\x20decoding\x20token:\x20','companyId','Debug\x20connection\x20info\x20sent\x20to\x20user\x20','33437988IzkuYA','toString','\x20joining\x20ticket\x20room:\x20','io-onConnection:\x20tokenData','Sent\x20test\x20presence\x20sequence\x20for\x20ticket\x20','-presence','allTicket','__importDefault','11596328oZeXZt','status-','ticket-','findByPk','leaveNotification','35VVJqfU','getIO','\x20channel.','../models/Ticket','ready','defineProperty','profile','isGroup',']:\x20User:\x20','\x20from\x20user\x20','verify','error','then','\x20clients,\x20','rooms','super','composing','development','queueId','leaveTickets','1625698mDvkwx','debug','basic','GetCompanySetting','\x20clients','\x20not\x20found','adapter','-mainchannel','Invalid\x20attempt\x20to\x20join\x20channel\x20of\x20ticket\x20','toISOString','finished\x20session\x20','joinChatbox[','../models/User','disconnect','12869990hXkxue','394789NouuFd','parse','decrementCounter','\x20joined\x20presence\x20channel\x20for\x20ticket\x20','joinedTicket','null','\x20of\x20company\x20','\x20pending\x20tickets\x20channel.','joinTicket','available','userId','undefined','Error\x20joining\x20ticket\x20room\x20','Broadcasting\x20to\x20channels:\x20','947814dXdjKC','CounterManager','checkPresence','default','Clossing\x20all\x20socket\x20sessions'];a361_0x3fa3=function(){return _0x32f0ed;};return a361_0x3fa3();}'use strict';var __importDefault=this&&this[a361_0x1d71f7(0xad)]||function(_0x33e00c){return _0x33e00c&&_0x33e00c['__esModule']?_0x33e00c:{'default':_0x33e00c};};Object[a361_0x1d71f7(0xb8)](exports,a361_0x1d71f7(0xa2),{'value':!![]}),exports[a361_0x1d71f7(0xb4)]=exports[a361_0x1d71f7(0x11c)]=exports[a361_0x1d71f7(0x114)]=void 0x0;const socket_io_1=require('socket.io'),admin_ui_1=require('@socket.io/admin-ui'),jsonwebtoken_1=require(a361_0x1d71f7(0x126)),AppError_1=__importDefault(require(a361_0x1d71f7(0x115))),logger_1=require(a361_0x1d71f7(0x121)),User_1=__importDefault(require(a361_0x1d71f7(0xd3))),Queue_1=__importDefault(require(a361_0x1d71f7(0x124))),Ticket_1=__importDefault(require(a361_0x1d71f7(0xb6))),auth_1=__importDefault(require('../config/auth')),counter_1=require(a361_0x1d71f7(0x92)),UserSocketSession_1=__importDefault(require(a361_0x1d71f7(0x113))),CheckSettings_1=require(a361_0x1d71f7(0xee));let io;const joinTicketChannel=async(_0x5bc6eb,_0x3d733b,_0x3b562f,_0x327f5d)=>{const _0x23c8b1=a361_0x1d71f7,_0x54c7ed=_0x327f5d[_0x23c8b1(0x116)](_0x23c8b1(0xb0)+_0x3d733b);_0x54c7ed===0x1&&_0x5bc6eb[_0x23c8b1(0x90)](_0x3d733b),logger_1[_0x23c8b1(0x119)][_0x23c8b1(0xc8)](_0x23c8b1(0xd2)+_0x54c7ed+_0x23c8b1(0x109)+_0x3d733b+_0x23c8b1(0x11b)+_0x3b562f['id']);},initIO=_0x34677e=>{const _0x54c5dd=a361_0x1d71f7;return io=new socket_io_1['Server'](_0x34677e,{'cors':{'origin':process[_0x54c5dd(0x112)]['FRONTEND_URL']}}),process['env'][_0x54c5dd(0xf3)]&&JSON[_0x54c5dd(0xd7)](process['env']['SOCKET_ADMIN'])&&User_1[_0x54c5dd(0xe7)]['findByPk'](0x1)[_0x54c5dd(0xbf)](_0x57eebb=>{const _0x4d5858=_0x54c5dd;(0x0,admin_ui_1[_0x4d5858(0x11d)])(io,{'auth':{'type':_0x4d5858(0xc9),'username':_0x57eebb[_0x4d5858(0x9e)],'password':_0x57eebb[_0x4d5858(0xfd)]},'mode':_0x4d5858(0xc4)});}),UserSocketSession_1[_0x54c5dd(0xe7)][_0x54c5dd(0xf2)]({'active':![]},{'where':{'active':!![]}})[_0x54c5dd(0xbf)](_0x190d9d=>{const _0x38843f=_0x54c5dd;logger_1[_0x38843f(0x119)][_0x38843f(0xc8)](_0x38843f(0xe8));}),io['on']('connection',async _0x2bb0be=>{const _0x5205b4=_0x54c5dd;logger_1[_0x5205b4(0x119)][_0x5205b4(0x10b)](_0x5205b4(0xfa)+_0x2bb0be['id']);const {token:_0x202ae4}=_0x2bb0be['handshake'][_0x5205b4(0x10f)];let _0x5ba566=null;try{_0x5ba566=(0x0,jsonwebtoken_1[_0x5205b4(0xbd)])(_0x202ae4,auth_1[_0x5205b4(0xe7)]['secret']),logger_1[_0x5205b4(0x119)][_0x5205b4(0xc8)](_0x5ba566,_0x5205b4(0xa9));}catch(_0x32fba1){return logger_1[_0x5205b4(0x119)][_0x5205b4(0xc8)](_0x5205b4(0xa3)+_0x32fba1?.[_0x5205b4(0x11e)]),_0x2bb0be[_0x5205b4(0xd4)](),io;}const _0x4c7770=new counter_1[(_0x5205b4(0xe5))]();let _0x104d1a=null;const _0x322620=_0x5ba566['id'];if(_0x322620&&_0x322620!==_0x5205b4(0xe1)&&_0x322620!==_0x5205b4(0xdb)){_0x104d1a=await User_1[_0x5205b4(0xe7)][_0x5205b4(0xb1)](_0x322620,{'include':[Queue_1[_0x5205b4(0xe7)]]});if(_0x104d1a)_0x104d1a[_0x5205b4(0x98)]=!![],await _0x104d1a[_0x5205b4(0x9b)]();else return logger_1[_0x5205b4(0x119)][_0x5205b4(0x10b)](_0x5205b4(0x10e)+_0x322620+_0x5205b4(0xcc)),_0x2bb0be[_0x5205b4(0xd4)](),io;}else return logger_1['logger'][_0x5205b4(0x10b)]('onConnect:\x20Missing\x20userId'),_0x2bb0be['disconnect'](),io;return UserSocketSession_1[_0x5205b4(0xe7)][_0x5205b4(0x94)]({'id':_0x2bb0be['id'],'userId':_0x322620,'active':!![]})[_0x5205b4(0xbf)](_0x364aaa=>{const _0x47e4ea=_0x5205b4;logger_1[_0x47e4ea(0x119)][_0x47e4ea(0xc8)](_0x47e4ea(0x9d)+_0x2bb0be['id']+_0x47e4ea(0x107)+_0x322620);}),_0x2bb0be['on'](_0x5205b4(0xd4),async()=>{const _0xc1ec83=_0x5205b4;UserSocketSession_1[_0xc1ec83(0xe7)]['update']({'active':![]},{'where':{'id':_0x2bb0be['id']}})['then'](()=>{const _0xe7df2c=_0xc1ec83;logger_1[_0xe7df2c(0x119)][_0xe7df2c(0xc8)](_0xe7df2c(0xd1)+_0x2bb0be['id']+'\x20for\x20user\x20'+_0x322620);});}),_0x2bb0be[_0x5205b4(0x90)](_0x5205b4(0xf4)+_0x104d1a[_0x5205b4(0xa4)]+_0x5205b4(0xce)),_0x2bb0be[_0x5205b4(0x90)](_0x5205b4(0xfb)+_0x104d1a['id']),_0x104d1a['super']&&_0x2bb0be['join'](_0x5205b4(0xc2)),_0x2bb0be['on'](_0x5205b4(0xde),async _0x2eea66=>{const _0x38cd89=_0x5205b4;try{logger_1[_0x38cd89(0x119)][_0x38cd89(0x10b)](_0x38cd89(0x105)+_0x104d1a['id']+_0x38cd89(0xa8)+_0x2eea66),_0x2bb0be[_0x38cd89(0x90)](_0x2eea66),_0x2bb0be[_0x38cd89(0x102)](_0x38cd89(0xda),{'ticketId':_0x2eea66,'timestamp':new Date()[_0x38cd89(0xd0)](),'success':!![]});}catch(_0x190c84){logger_1[_0x38cd89(0x119)][_0x38cd89(0xbe)](_0x38cd89(0xe2)+_0x2eea66+':\x20'+_0x190c84['message']),_0x2bb0be[_0x38cd89(0x102)]('joinedTicket',{'ticketId':_0x2eea66,'timestamp':new Date()[_0x38cd89(0xd0)](),'success':![],'error':_0x190c84[_0x38cd89(0x11e)]});}}),_0x2bb0be['on'](_0x5205b4(0xe6),async _0x2bf986=>{const _0xcfb5=_0x5205b4;try{const {ticketId:_0x5e4b5d}=_0x2bf986;logger_1[_0xcfb5(0x119)]['info'](_0xcfb5(0x10c)+_0x5e4b5d+_0xcfb5(0xbc)+_0x104d1a['id']),_0x2bb0be[_0xcfb5(0x102)]('company-'+_0x104d1a[_0xcfb5(0xa4)]+_0xcfb5(0xab),{'ticketId':parseInt(_0x5e4b5d),'presence':_0xcfb5(0xc3),'isTest':!![],'timestamp':new Date()[_0xcfb5(0xd0)]()}),setTimeout(()=>{const _0x2732bb=_0xcfb5;_0x2bb0be[_0x2732bb(0x102)](_0x2732bb(0xf4)+_0x104d1a['companyId']+_0x2732bb(0xab),{'ticketId':parseInt(_0x5e4b5d),'presence':_0x2732bb(0xe9),'isTest':!![],'timestamp':new Date()[_0x2732bb(0xd0)]()});},0x7d0),setTimeout(()=>{const _0x3762ef=_0xcfb5;_0x2bb0be[_0x3762ef(0x102)](_0x3762ef(0xf4)+_0x104d1a[_0x3762ef(0xa4)]+_0x3762ef(0xab),{'ticketId':parseInt(_0x5e4b5d),'presence':_0x3762ef(0xdf),'isTest':!![],'timestamp':new Date()[_0x3762ef(0xd0)]()}),logger_1[_0x3762ef(0x119)]['info'](_0x3762ef(0xaa)+_0x5e4b5d);},0xfa0);}catch(_0xcfdb98){logger_1['logger'][_0xcfb5(0xbe)]('Error\x20in\x20checkPresence:\x20'+_0xcfdb98[_0xcfb5(0x11e)]);}}),_0x2bb0be['on'](_0x5205b4(0x122),async _0x2e8fd3=>{const _0x528540=_0x5205b4;if(!_0x2e8fd3||_0x2e8fd3===_0x528540(0xe1))return;Ticket_1[_0x528540(0xe7)][_0x528540(0xb1)](_0x2e8fd3)[_0x528540(0xbf)](async _0x58da7d=>{const _0x4c2d06=_0x528540;if(_0x58da7d&&_0x58da7d[_0x4c2d06(0xa4)]===_0x104d1a[_0x4c2d06(0xa4)]){const _0x2de0f9=_0x58da7d[_0x4c2d06(0xe0)]===_0x104d1a['id'],_0x3d06be=_0x104d1a['profile']===_0x4c2d06(0x11a),_0x55b4b4=_0x104d1a[_0x4c2d06(0xac)]===_0x4c2d06(0x96),_0x58342d=_0x104d1a[_0x4c2d06(0xf0)]?.[_0x4c2d06(0x93)](_0x3b2a93=>_0x3b2a93['id']===_0x58da7d[_0x4c2d06(0xc5)]);_0x2de0f9||_0x3d06be||_0x55b4b4||_0x58342d?(joinTicketChannel(_0x2bb0be,_0x2e8fd3,_0x104d1a,_0x4c7770),_0x2bb0be['join'](_0x4c2d06(0xb0)+_0x2e8fd3+_0x4c2d06(0xab)),logger_1[_0x4c2d06(0x119)][_0x4c2d06(0xc8)](_0x4c2d06(0x105)+_0x104d1a['id']+_0x4c2d06(0xd9)+_0x2e8fd3)):logger_1[_0x4c2d06(0x119)][_0x4c2d06(0x10b)]('User\x20'+_0x104d1a['id']+_0x4c2d06(0xf5)+_0x2e8fd3);}else{if(_0x58da7d[_0x4c2d06(0xba)]&&await(0x0,CheckSettings_1[_0x4c2d06(0xca)])(_0x104d1a[_0x4c2d06(0xa4)],_0x4c2d06(0x118),_0x4c2d06(0x9c))===_0x4c2d06(0x96)){let _0x27e3cc=![];_0x104d1a[_0x4c2d06(0xf0)][_0x4c2d06(0xa1)](_0x48c310=>{_0x48c310['id']===_0x58da7d['queueId']&&(_0x27e3cc=!![]);}),_0x27e3cc?(joinTicketChannel(_0x2bb0be,_0x2e8fd3,_0x104d1a,_0x4c7770),_0x2bb0be[_0x4c2d06(0x90)](_0x4c2d06(0xb0)+_0x2e8fd3+_0x4c2d06(0xab)),logger_1[_0x4c2d06(0x119)][_0x4c2d06(0xc8)](_0x4c2d06(0x105)+_0x104d1a['id']+_0x4c2d06(0xd9)+_0x2e8fd3)):logger_1['logger'][_0x4c2d06(0x10b)](_0x4c2d06(0xcf)+_0x2e8fd3+_0x4c2d06(0x11b)+_0x104d1a['id']);}else logger_1[_0x4c2d06(0x119)][_0x4c2d06(0x10b)](_0x4c2d06(0xcf)+_0x2e8fd3+_0x4c2d06(0x11b)+_0x104d1a['id']);}},_0x54dc9d=>{const _0x57b363=_0x528540;logger_1[_0x57b363(0x119)][_0x57b363(0xbe)](_0x54dc9d,_0x57b363(0x95)+_0x2e8fd3);});}),_0x2bb0be['on'](_0x5205b4(0x97),async _0x5bda4a=>{const _0x52f236=_0x5205b4;if(!_0x5bda4a||_0x5bda4a==='undefined')return;const _0x5b07c9=_0x4c7770[_0x52f236(0xd8)](_0x52f236(0xb0)+_0x5bda4a);_0x5b07c9===0x0&&(_0x2bb0be[_0x52f236(0xf1)](_0x5bda4a),_0x2bb0be['leave'](_0x52f236(0xb0)+_0x5bda4a+_0x52f236(0xab))),logger_1[_0x52f236(0x119)]['debug'](_0x52f236(0x103)+_0x5b07c9+_0x52f236(0x109)+_0x5bda4a+_0x52f236(0x11b)+_0x104d1a['id']);}),_0x2bb0be['on']('joinNotification',async()=>{const _0x59566a=_0x5205b4,_0xbfcedf=_0x4c7770[_0x59566a(0x116)](_0x59566a(0xfc));_0xbfcedf===0x1&&(_0x104d1a[_0x59566a(0xb9)]===_0x59566a(0x11a)?_0x2bb0be[_0x59566a(0x90)]('company-'+_0x104d1a[_0x59566a(0xa4)]+_0x59566a(0x125)):_0x104d1a['queues'][_0x59566a(0xa1)](_0x14e805=>{const _0xf5dfc6=_0x59566a;logger_1[_0xf5dfc6(0x119)][_0xf5dfc6(0xc8)](_0xf5dfc6(0x105)+_0x104d1a['id']+'\x20of\x20company\x20'+_0x104d1a[_0xf5dfc6(0xa4)]+'\x20joined\x20queue\x20'+_0x14e805['id']+_0xf5dfc6(0xb5)),_0x2bb0be[_0xf5dfc6(0x90)](_0xf5dfc6(0x110)+_0x14e805['id']+'-notification');})),logger_1['logger'][_0x59566a(0xc8)](_0x59566a(0xf6)+_0xbfcedf+_0x59566a(0xbb)+_0x104d1a['id']);}),_0x2bb0be['on'](_0x5205b4(0xb2),async()=>{const _0x5752e1=_0x5205b4,_0x465dd5=_0x4c7770[_0x5752e1(0xd8)](_0x5752e1(0xfc));_0x465dd5===0x0&&(_0x104d1a[_0x5752e1(0xb9)]===_0x5752e1(0x11a)?_0x2bb0be[_0x5752e1(0xf1)]('company-'+_0x104d1a[_0x5752e1(0xa4)]+_0x5752e1(0x125)):_0x104d1a[_0x5752e1(0xf0)][_0x5752e1(0xa1)](_0x1390dc=>{const _0x466e9f=_0x5752e1;logger_1[_0x466e9f(0x119)][_0x466e9f(0xc8)](_0x466e9f(0x105)+_0x104d1a['id']+'\x20of\x20company\x20'+_0x104d1a[_0x466e9f(0xa4)]+_0x466e9f(0x9a)+_0x1390dc['id']+_0x466e9f(0xb5)),_0x2bb0be[_0x466e9f(0xf1)](_0x466e9f(0x110)+_0x1390dc['id']+'-notification');})),logger_1['logger']['debug'](_0x5752e1(0xed)+_0x465dd5+_0x5752e1(0xbb)+_0x104d1a['id']);}),_0x2bb0be['on'](_0x5205b4(0x108),_0x43cc20=>{const _0x54b089=_0x5205b4;if(_0x4c7770[_0x54b089(0x116)](_0x54b089(0xaf)+_0x43cc20)===0x1){if(_0x104d1a[_0x54b089(0xb9)]===_0x54b089(0x11a))logger_1[_0x54b089(0x119)]['debug'](_0x54b089(0x106)+_0x104d1a['id']+'\x20of\x20company\x20'+_0x104d1a[_0x54b089(0xa4)]+'\x20joined\x20'+_0x43cc20+_0x54b089(0x111)),_0x2bb0be[_0x54b089(0x90)]('company-'+_0x104d1a[_0x54b089(0xa4)]+'-'+_0x43cc20);else _0x43cc20===_0x54b089(0x9f)?_0x104d1a[_0x54b089(0xf0)]['forEach'](_0x182932=>{const _0x29a19a=_0x54b089;logger_1[_0x29a19a(0x119)][_0x29a19a(0xc8)]('User\x20'+_0x104d1a['id']+_0x29a19a(0xdc)+_0x104d1a[_0x29a19a(0xa4)]+_0x29a19a(0xff)+_0x182932['id']+'\x20pending\x20tickets\x20channel.'),_0x2bb0be[_0x29a19a(0x90)](_0x29a19a(0x110)+_0x182932['id']+_0x29a19a(0x104));}):logger_1['logger'][_0x54b089(0xc8)](_0x54b089(0x105)+_0x104d1a['id']+_0x54b089(0x120)+_0x43cc20);}}),_0x2bb0be['on'](_0x5205b4(0xc6),_0x54fe71=>{const _0xf330eb=_0x5205b4;if(_0x4c7770['decrementCounter']('status-'+_0x54fe71)===0x0){if(_0x104d1a[_0xf330eb(0xb9)]===_0xf330eb(0x11a))logger_1[_0xf330eb(0x119)][_0xf330eb(0xc8)](_0xf330eb(0x106)+_0x104d1a['id']+_0xf330eb(0xdc)+_0x104d1a[_0xf330eb(0xa4)]+_0xf330eb(0x10a)+_0x54fe71+_0xf330eb(0x111)),_0x2bb0be[_0xf330eb(0xf1)](_0xf330eb(0xf4)+_0x104d1a[_0xf330eb(0xa4)]+'-'+_0x54fe71);else _0x54fe71==='pending'&&_0x104d1a[_0xf330eb(0xf0)][_0xf330eb(0xa1)](_0x3860b0=>{const _0x23849b=_0xf330eb;logger_1['logger']['debug'](_0x23849b(0x105)+_0x104d1a['id']+_0x23849b(0xdc)+_0x104d1a[_0x23849b(0xa4)]+'\x20leaved\x20queue\x20'+_0x3860b0['id']+_0x23849b(0xdd)),_0x2bb0be[_0x23849b(0xf1)](_0x23849b(0x110)+_0x3860b0['id']+_0x23849b(0x104));});}}),_0x2bb0be['on'](_0x5205b4(0xeb),()=>{const _0x3d7ef7=_0x5205b4,_0x4e884f=Array[_0x3d7ef7(0x117)](_0x2bb0be[_0x3d7ef7(0xc1)]);_0x2bb0be[_0x3d7ef7(0x102)]('debugInfo',{'socketId':_0x2bb0be['id'],'userId':_0x104d1a['id'],'companyId':_0x104d1a[_0x3d7ef7(0xa4)],'connectedRooms':_0x4e884f,'timestamp':new Date()[_0x3d7ef7(0xd0)]()}),logger_1[_0x3d7ef7(0x119)][_0x3d7ef7(0x10b)](_0x3d7ef7(0xa5)+_0x104d1a['id']);}),_0x2bb0be['emit'](_0x5205b4(0xb7)),io;}),io;};exports[a361_0x1d71f7(0x114)]=initIO;const emitPresence=(_0x17d7e3,_0x89b24b,_0x4eab33)=>{const _0x2f69ce=a361_0x1d71f7;if(!io){logger_1[_0x2f69ce(0x119)][_0x2f69ce(0xbe)](_0x2f69ce(0x123));return;}logger_1[_0x2f69ce(0x119)]['info']('Emitting\x20presence\x20event:\x20'+_0x4eab33+_0x2f69ce(0x100)+_0x89b24b+_0x2f69ce(0xfe)+_0x17d7e3);const _0x1f6279=[_0x2f69ce(0xb0)+_0x89b24b+_0x2f69ce(0xab),_0x2f69ce(0xb0)+_0x89b24b,_0x89b24b['toString'](),_0x2f69ce(0xf4)+_0x17d7e3+_0x2f69ce(0x99),'company-'+_0x17d7e3+'-pending'];logger_1['logger'][_0x2f69ce(0xc8)](_0x2f69ce(0xe3)+_0x1f6279['join'](',\x20')),io['to'](_0x2f69ce(0xf4)+_0x17d7e3+_0x2f69ce(0xce))[_0x2f69ce(0x102)](_0x2f69ce(0xf4)+_0x17d7e3+_0x2f69ce(0xab),{'ticketId':_0x89b24b,'presence':_0x4eab33,'timestamp':new Date()[_0x2f69ce(0xd0)]()}),logger_1[_0x2f69ce(0x119)]['debug']('Presence\x20event\x20'+_0x4eab33+_0x2f69ce(0xf8)+_0x89b24b);try{const _0x56d2c4=io[_0x2f69ce(0xec)][_0x2f69ce(0xcd)][_0x2f69ce(0xc1)][_0x2f69ce(0xf7)](_0x2f69ce(0xf4)+_0x17d7e3+_0x2f69ce(0xce)),_0x62f7e=io['sockets'][_0x2f69ce(0xcd)][_0x2f69ce(0xc1)][_0x2f69ce(0xf7)](_0x89b24b[_0x2f69ce(0xa7)]());logger_1[_0x2f69ce(0x119)]['info'](_0x2f69ce(0x91)+(_0x56d2c4?_0x56d2c4[_0x2f69ce(0xf9)]:0x0)+_0x2f69ce(0xc0)+(_0x2f69ce(0xa0)+(_0x62f7e?_0x62f7e['size']:0x0)+_0x2f69ce(0xcb)));}catch(_0x368193){logger_1[_0x2f69ce(0x119)][_0x2f69ce(0xbe)]('Error\x20counting\x20room\x20clients:\x20'+_0x368193[_0x2f69ce(0x11e)]);}};exports[a361_0x1d71f7(0x11c)]=emitPresence;function a361_0x4d63(_0x3e30ac,_0x5ce371){const _0x14d9bc=a361_0x3fa3();return a361_0x4d63=function(_0x262641,_0x375e5e){_0x262641=_0x262641-0x90;let _0x3fa3b6=_0x14d9bc[_0x262641];return _0x3fa3b6;},a361_0x4d63(_0x3e30ac,_0x5ce371);}const getIO=()=>{const _0x404316=a361_0x1d71f7;if(!io)throw new AppError_1['default'](_0x404316(0xea));return io;};exports[a361_0x1d71f7(0xb4)]=getIO;