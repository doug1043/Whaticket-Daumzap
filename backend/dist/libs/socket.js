const a293_0x183ae7=a293_0xdd57;(function(_0x272ee5,_0x121cb1){const _0x153acb=a293_0xdd57,_0xbd2582=_0x272ee5();while(!![]){try{const _0x5f38c3=parseInt(_0x153acb(0xac))/0x1*(parseInt(_0x153acb(0x11c))/0x2)+parseInt(_0x153acb(0xab))/0x3+-parseInt(_0x153acb(0x12e))/0x4*(-parseInt(_0x153acb(0xc0))/0x5)+-parseInt(_0x153acb(0x137))/0x6+-parseInt(_0x153acb(0xdd))/0x7+-parseInt(_0x153acb(0xe4))/0x8+parseInt(_0x153acb(0x106))/0x9*(parseInt(_0x153acb(0xc3))/0xa);if(_0x5f38c3===_0x121cb1)break;else _0xbd2582['push'](_0xbd2582['shift']());}catch(_0x35c982){_0xbd2582['push'](_0xbd2582['shift']());}}}(a293_0x57a9,0x78695));function a293_0x57a9(){const _0x57b9a4=['Error\x20joining\x20ticket\x20room\x20','sockets','Received\x20checkPresence\x20for\x20ticket\x20','Invalid\x20attempt\x20to\x20join\x20channel\x20of\x20ticket\x20','../helpers/CheckSettings','../config/auth','debugInfo','basic','./counter','SOCKET_ADMIN','ticket-','Error\x20fetching\x20ticket\x20','logger','4SiAVxj','disconnect','composing','error','Debug\x20connection\x20info\x20sent\x20to\x20user\x20','User\x20','size','\x20joined\x20queue\x20','verify','1916178bOcjMw','\x20leaved\x20queue\x20','emit','update','pending','null','started\x20session\x20','enabled','Error\x20in\x20checkPresence:\x20','checkPresence','\x20not\x20found','622530MmjmML','1WDjBQO','\x20for\x20user\x20','Socket\x20IO\x20not\x20initialized\x20when\x20trying\x20to\x20emit\x20presence','Server','leaveNotification','finished\x20session\x20','-mainchannel','groupsTab','onConnect:\x20User\x20','Presence\x20event\x20','Admin\x20','-presence','\x20from\x20user\x20','\x20tickets\x20channel.','toISOString','Error\x20counting\x20room\x20clients:\x20','\x20joined\x20presence\x20channel\x20for\x20ticket\x20','leaveChatBox','../models/Ticket','incrementCounter','725355gcOdiF','apply','leaveTickets','3660uKYkWG','io-onConnection:\x20tokenData','\x20channel.','jsonwebtoken','\x20for\x20ticket\x20','Socket\x20stats\x20-\x20Main\x20company\x20room:\x20','\x20by\x20user\x20','secret','queueId','CounterManager','Broadcasting\x20to\x20channels:\x20','\x20in\x20company\x20','\x20clients,\x20','isGroup','undefined',']:\x20Channel:\x20','query','Error\x20decoding\x20token:\x20','queues','constructor','\x20leaved\x20','default','toString','debugConnection','forEach','notification','2414314hlJaxk','../models/UserSocketSession','FRONTEND_URL','initIO','emitPresence','Emitting\x20presence\x20event:\x20','onConnect:\x20Missing\x20userId','918528MqWMLO','join','instrument','GetCompanySetting','findByPk','profile','\x20joined\x20','queue-','rooms','../utils/logger','joinTickets','-pending','joinTicket','companyId','info','getIO','../models/User','adapter','-open','\x20pending\x20tickets\x20channel.','@socket.io/admin-ui','email','leaveChatbox[','\x20cannot\x20subscribe\x20to\x20','user-','development','then','../errors/AppError','recording',']:\x20User:\x20','\x20emitted\x20for\x20ticket\x20','joinNotification[','\x20joining\x20ticket\x20room:\x20','(((.+)+)+)+$','2214PSZFhN','debug','joinChatBox','message','parse','leaveNotification[','__esModule','decrementCounter','-notification','\x20of\x20company\x20','\x20clients','company-','Ticket\x20room:\x20','userId','get','env','admin','../models/Queue','Client\x20Connected:\x20','disabled','Sent\x20test\x20presence\x20sequence\x20for\x20ticket\x20','joinedTicket','1659338gPsDEu','search','leave','defineProperty','__importDefault'];a293_0x57a9=function(){return _0x57b9a4;};return a293_0x57a9();}const a293_0x485bb7=(function(){let _0x53ad0b=!![];return function(_0x3bf133,_0x17f698){const _0x376e23=_0x53ad0b?function(){const _0x4f4a01=a293_0xdd57;if(_0x17f698){const _0x937554=_0x17f698[_0x4f4a01(0xc1)](_0x3bf133,arguments);return _0x17f698=null,_0x937554;}}:function(){};return _0x53ad0b=![],_0x376e23;};}()),a293_0x5b8693=a293_0x485bb7(this,function(){const _0x463bc7=a293_0xdd57;return a293_0x5b8693['toString']()['search'](_0x463bc7(0x105))['toString']()[_0x463bc7(0xd6)](a293_0x5b8693)[_0x463bc7(0x11d)](_0x463bc7(0x105));});function a293_0xdd57(_0x403977,_0xb47352){const _0x256973=a293_0x57a9();return a293_0xdd57=function(_0x5b8693,_0x485bb7){_0x5b8693=_0x5b8693-0xa5;let _0x57a9de=_0x256973[_0x5b8693];return _0x57a9de;},a293_0xdd57(_0x403977,_0xb47352);}a293_0x5b8693();'use strict';var __importDefault=this&&this[a293_0x183ae7(0x120)]||function(_0x4c1482){const _0x307949=a293_0x183ae7;return _0x4c1482&&_0x4c1482[_0x307949(0x10c)]?_0x4c1482:{'default':_0x4c1482};};Object[a293_0x183ae7(0x11f)](exports,a293_0x183ae7(0x10c),{'value':!![]}),exports[a293_0x183ae7(0xf3)]=exports[a293_0x183ae7(0xe1)]=exports[a293_0x183ae7(0xe0)]=void 0x0;const socket_io_1=require('socket.io'),admin_ui_1=require(a293_0x183ae7(0xf8)),jsonwebtoken_1=require(a293_0x183ae7(0xc6)),AppError_1=__importDefault(require(a293_0x183ae7(0xff))),logger_1=require(a293_0x183ae7(0xed)),User_1=__importDefault(require(a293_0x183ae7(0xf4))),Queue_1=__importDefault(require(a293_0x183ae7(0x117))),Ticket_1=__importDefault(require(a293_0x183ae7(0xbe))),auth_1=__importDefault(require(a293_0x183ae7(0x126))),counter_1=require(a293_0x183ae7(0x129)),UserSocketSession_1=__importDefault(require(a293_0x183ae7(0xde))),CheckSettings_1=require(a293_0x183ae7(0x125));let io;const joinTicketChannel=async(_0x5ef567,_0x47d4c4,_0x1612e1,_0x47c0ab)=>{const _0x3aba4b=a293_0x183ae7,_0x483c2c=_0x47c0ab[_0x3aba4b(0xbf)](_0x3aba4b(0x12b)+_0x47d4c4);_0x483c2c===0x1&&_0x5ef567[_0x3aba4b(0xe5)](_0x47d4c4),logger_1[_0x3aba4b(0x12d)]['debug']('joinChatbox['+_0x483c2c+']:\x20Channel:\x20'+_0x47d4c4+'\x20by\x20user\x20'+_0x1612e1['id']);},initIO=_0x44b7df=>{const _0x22c5ed=a293_0x183ae7;return io=new socket_io_1[(_0x22c5ed(0xaf))](_0x44b7df,{'cors':{'origin':process[_0x22c5ed(0x115)][_0x22c5ed(0xdf)]}}),process[_0x22c5ed(0x115)][_0x22c5ed(0x12a)]&&JSON[_0x22c5ed(0x10a)](process[_0x22c5ed(0x115)][_0x22c5ed(0x12a)])&&User_1['default']['findByPk'](0x1)[_0x22c5ed(0xfe)](_0x4b90f0=>{const _0x11239d=_0x22c5ed;(0x0,admin_ui_1[_0x11239d(0xe6)])(io,{'auth':{'type':_0x11239d(0x128),'username':_0x4b90f0[_0x11239d(0xf9)],'password':_0x4b90f0['passwordHash']},'mode':_0x11239d(0xfd)});}),UserSocketSession_1[_0x22c5ed(0xd8)][_0x22c5ed(0x13a)]({'active':![]},{'where':{'active':!![]}})[_0x22c5ed(0xfe)](_0x15000b=>{const _0x2cbe3e=_0x22c5ed;logger_1[_0x2cbe3e(0x12d)][_0x2cbe3e(0x107)]('Clossing\x20all\x20socket\x20sessions');}),io['on']('connection',async _0x3bed5f=>{const _0x27ed7a=_0x22c5ed;logger_1[_0x27ed7a(0x12d)]['info'](_0x27ed7a(0x118)+_0x3bed5f['id']);const {token:_0x32ef72}=_0x3bed5f['handshake'][_0x27ed7a(0xd3)];let _0x4f32c3=null;try{_0x4f32c3=(0x0,jsonwebtoken_1[_0x27ed7a(0x136)])(_0x32ef72,auth_1[_0x27ed7a(0xd8)][_0x27ed7a(0xca)]),logger_1['logger'][_0x27ed7a(0x107)](_0x4f32c3,_0x27ed7a(0xc4));}catch(_0x11a301){return logger_1['logger'][_0x27ed7a(0x107)](_0x27ed7a(0xd4)+_0x11a301?.[_0x27ed7a(0x109)]),_0x3bed5f[_0x27ed7a(0x12f)](),io;}const _0x3ec9a5=new counter_1[(_0x27ed7a(0xcc))]();let _0x1dc0e1=null;const _0x503e2e=_0x4f32c3['id'];if(_0x503e2e&&_0x503e2e!==_0x27ed7a(0xd1)&&_0x503e2e!==_0x27ed7a(0xa5)){_0x1dc0e1=await User_1['default'][_0x27ed7a(0xe8)](_0x503e2e,{'include':[Queue_1[_0x27ed7a(0xd8)]]});if(_0x1dc0e1)_0x1dc0e1['online']=!![],await _0x1dc0e1['save']();else return logger_1['logger']['info'](_0x27ed7a(0xb4)+_0x503e2e+_0x27ed7a(0xaa)),_0x3bed5f[_0x27ed7a(0x12f)](),io;}else return logger_1[_0x27ed7a(0x12d)]['info'](_0x27ed7a(0xe3)),_0x3bed5f[_0x27ed7a(0x12f)](),io;return UserSocketSession_1[_0x27ed7a(0xd8)]['create']({'id':_0x3bed5f['id'],'userId':_0x503e2e,'active':!![]})[_0x27ed7a(0xfe)](_0x2c56f7=>{const _0x3591a3=_0x27ed7a;logger_1[_0x3591a3(0x12d)][_0x3591a3(0x107)](_0x3591a3(0xa6)+_0x3bed5f['id']+_0x3591a3(0xad)+_0x503e2e);}),_0x3bed5f['on'](_0x27ed7a(0x12f),async()=>{const _0x3f01fb=_0x27ed7a;UserSocketSession_1[_0x3f01fb(0xd8)][_0x3f01fb(0x13a)]({'active':![]},{'where':{'id':_0x3bed5f['id']}})['then'](()=>{const _0x4241b1=_0x3f01fb;logger_1[_0x4241b1(0x12d)][_0x4241b1(0x107)](_0x4241b1(0xb1)+_0x3bed5f['id']+_0x4241b1(0xad)+_0x503e2e);});}),_0x3bed5f[_0x27ed7a(0xe5)](_0x27ed7a(0x111)+_0x1dc0e1[_0x27ed7a(0xf1)]+_0x27ed7a(0xb2)),_0x3bed5f[_0x27ed7a(0xe5)](_0x27ed7a(0xfc)+_0x1dc0e1['id']),_0x1dc0e1['super']&&_0x3bed5f[_0x27ed7a(0xe5)]('super'),_0x3bed5f['on'](_0x27ed7a(0xf0),async _0x387934=>{const _0x32b61a=_0x27ed7a;try{logger_1[_0x32b61a(0x12d)][_0x32b61a(0xf2)]('User\x20'+_0x1dc0e1['id']+_0x32b61a(0x104)+_0x387934),_0x3bed5f[_0x32b61a(0xe5)](_0x387934),_0x3bed5f[_0x32b61a(0x139)](_0x32b61a(0x11b),{'ticketId':_0x387934,'timestamp':new Date()[_0x32b61a(0xba)](),'success':!![]});}catch(_0x34ba3d){logger_1[_0x32b61a(0x12d)][_0x32b61a(0x131)](_0x32b61a(0x121)+_0x387934+':\x20'+_0x34ba3d[_0x32b61a(0x109)]),_0x3bed5f[_0x32b61a(0x139)](_0x32b61a(0x11b),{'ticketId':_0x387934,'timestamp':new Date()[_0x32b61a(0xba)](),'success':![],'error':_0x34ba3d['message']});}}),_0x3bed5f['on'](_0x27ed7a(0xa9),async _0x5a8068=>{const _0x12902f=_0x27ed7a;try{const {ticketId:_0x48aa9f}=_0x5a8068;logger_1[_0x12902f(0x12d)]['info'](_0x12902f(0x123)+_0x48aa9f+_0x12902f(0xb8)+_0x1dc0e1['id']),_0x3bed5f[_0x12902f(0x139)](_0x12902f(0x111)+_0x1dc0e1[_0x12902f(0xf1)]+_0x12902f(0xb7),{'ticketId':parseInt(_0x48aa9f),'presence':_0x12902f(0x130),'isTest':!![],'timestamp':new Date()[_0x12902f(0xba)]()}),setTimeout(()=>{const _0xa8a4ff=_0x12902f;_0x3bed5f[_0xa8a4ff(0x139)](_0xa8a4ff(0x111)+_0x1dc0e1[_0xa8a4ff(0xf1)]+_0xa8a4ff(0xb7),{'ticketId':parseInt(_0x48aa9f),'presence':_0xa8a4ff(0x100),'isTest':!![],'timestamp':new Date()[_0xa8a4ff(0xba)]()});},0x7d0),setTimeout(()=>{const _0x3f3ca4=_0x12902f;_0x3bed5f[_0x3f3ca4(0x139)](_0x3f3ca4(0x111)+_0x1dc0e1[_0x3f3ca4(0xf1)]+_0x3f3ca4(0xb7),{'ticketId':parseInt(_0x48aa9f),'presence':'available','isTest':!![],'timestamp':new Date()[_0x3f3ca4(0xba)]()}),logger_1[_0x3f3ca4(0x12d)][_0x3f3ca4(0xf2)](_0x3f3ca4(0x11a)+_0x48aa9f);},0xfa0);}catch(_0xe48355){logger_1[_0x12902f(0x12d)][_0x12902f(0x131)](_0x12902f(0xa8)+_0xe48355[_0x12902f(0x109)]);}}),_0x3bed5f['on'](_0x27ed7a(0x108),async _0x52b2e1=>{const _0x4d57d7=_0x27ed7a;if(!_0x52b2e1||_0x52b2e1===_0x4d57d7(0xd1))return;Ticket_1['default']['findByPk'](_0x52b2e1)['then'](async _0x5d0d75=>{const _0x57c5f5=_0x4d57d7;if(_0x5d0d75&&_0x5d0d75[_0x57c5f5(0xf1)]===_0x1dc0e1[_0x57c5f5(0xf1)]&&(_0x5d0d75[_0x57c5f5(0x113)]===_0x1dc0e1['id']||_0x1dc0e1[_0x57c5f5(0xe9)]===_0x57c5f5(0x116)))joinTicketChannel(_0x3bed5f,_0x52b2e1,_0x1dc0e1,_0x3ec9a5),_0x3bed5f[_0x57c5f5(0xe5)]('ticket-'+_0x52b2e1+_0x57c5f5(0xb7)),logger_1[_0x57c5f5(0x12d)][_0x57c5f5(0x107)](_0x57c5f5(0x133)+_0x1dc0e1['id']+_0x57c5f5(0xbc)+_0x52b2e1);else{if(_0x5d0d75[_0x57c5f5(0xd0)]&&await(0x0,CheckSettings_1[_0x57c5f5(0xe7)])(_0x1dc0e1[_0x57c5f5(0xf1)],_0x57c5f5(0xb3),_0x57c5f5(0x119))===_0x57c5f5(0xa7)){let _0x2bc7b1=![];_0x1dc0e1[_0x57c5f5(0xd5)][_0x57c5f5(0xdb)](_0x3eb98d=>{const _0x1e1c45=_0x57c5f5;_0x3eb98d['id']===_0x5d0d75[_0x1e1c45(0xcb)]&&(_0x2bc7b1=!![]);}),_0x2bc7b1?(joinTicketChannel(_0x3bed5f,_0x52b2e1,_0x1dc0e1,_0x3ec9a5),_0x3bed5f[_0x57c5f5(0xe5)](_0x57c5f5(0x12b)+_0x52b2e1+_0x57c5f5(0xb7)),logger_1[_0x57c5f5(0x12d)][_0x57c5f5(0x107)](_0x57c5f5(0x133)+_0x1dc0e1['id']+_0x57c5f5(0xbc)+_0x52b2e1)):logger_1['logger'][_0x57c5f5(0xf2)]('Invalid\x20attempt\x20to\x20join\x20channel\x20of\x20ticket\x20'+_0x52b2e1+_0x57c5f5(0xc9)+_0x1dc0e1['id']);}else logger_1[_0x57c5f5(0x12d)][_0x57c5f5(0xf2)](_0x57c5f5(0x124)+_0x52b2e1+_0x57c5f5(0xc9)+_0x1dc0e1['id']);}},_0x2984da=>{const _0x51a8fa=_0x4d57d7;logger_1[_0x51a8fa(0x12d)][_0x51a8fa(0x131)](_0x2984da,_0x51a8fa(0x12c)+_0x52b2e1);});}),_0x3bed5f['on'](_0x27ed7a(0xbd),async _0x2d4901=>{const _0xb0bd71=_0x27ed7a;if(!_0x2d4901||_0x2d4901==='undefined')return;const _0x1d38dd=_0x3ec9a5[_0xb0bd71(0x10d)](_0xb0bd71(0x12b)+_0x2d4901);_0x1d38dd===0x0&&(_0x3bed5f[_0xb0bd71(0x11e)](_0x2d4901),_0x3bed5f[_0xb0bd71(0x11e)](_0xb0bd71(0x12b)+_0x2d4901+_0xb0bd71(0xb7))),logger_1[_0xb0bd71(0x12d)]['debug'](_0xb0bd71(0xfa)+_0x1d38dd+_0xb0bd71(0xd2)+_0x2d4901+'\x20by\x20user\x20'+_0x1dc0e1['id']);}),_0x3bed5f['on']('joinNotification',async()=>{const _0x3fa732=_0x27ed7a,_0x161802=_0x3ec9a5['incrementCounter'](_0x3fa732(0xdc));_0x161802===0x1&&(_0x1dc0e1[_0x3fa732(0xe9)]===_0x3fa732(0x116)?_0x3bed5f['join']('company-'+_0x1dc0e1['companyId']+'-notification'):_0x1dc0e1[_0x3fa732(0xd5)][_0x3fa732(0xdb)](_0x1a3ce7=>{const _0x347cfe=_0x3fa732;logger_1[_0x347cfe(0x12d)][_0x347cfe(0x107)](_0x347cfe(0x133)+_0x1dc0e1['id']+'\x20of\x20company\x20'+_0x1dc0e1['companyId']+'\x20joined\x20queue\x20'+_0x1a3ce7['id']+_0x347cfe(0xc5)),_0x3bed5f['join'](_0x347cfe(0xeb)+_0x1a3ce7['id']+_0x347cfe(0x10e));})),logger_1[_0x3fa732(0x12d)][_0x3fa732(0x107)](_0x3fa732(0x103)+_0x161802+_0x3fa732(0x101)+_0x1dc0e1['id']);}),_0x3bed5f['on'](_0x27ed7a(0xb0),async()=>{const _0xa88f40=_0x27ed7a,_0x8a1a94=_0x3ec9a5['decrementCounter'](_0xa88f40(0xdc));_0x8a1a94===0x0&&(_0x1dc0e1['profile']===_0xa88f40(0x116)?_0x3bed5f[_0xa88f40(0x11e)](_0xa88f40(0x111)+_0x1dc0e1[_0xa88f40(0xf1)]+_0xa88f40(0x10e)):_0x1dc0e1[_0xa88f40(0xd5)][_0xa88f40(0xdb)](_0x3308fd=>{const _0x93b5ce=_0xa88f40;logger_1['logger']['debug']('User\x20'+_0x1dc0e1['id']+_0x93b5ce(0x10f)+_0x1dc0e1[_0x93b5ce(0xf1)]+_0x93b5ce(0x138)+_0x3308fd['id']+_0x93b5ce(0xc5)),_0x3bed5f['leave'](_0x93b5ce(0xeb)+_0x3308fd['id']+_0x93b5ce(0x10e));})),logger_1['logger'][_0xa88f40(0x107)](_0xa88f40(0x10b)+_0x8a1a94+_0xa88f40(0x101)+_0x1dc0e1['id']);}),_0x3bed5f['on'](_0x27ed7a(0xee),_0x276b5b=>{const _0x1aa27c=_0x27ed7a;if(_0x3ec9a5['incrementCounter']('status-'+_0x276b5b)===0x1){if(_0x1dc0e1[_0x1aa27c(0xe9)]===_0x1aa27c(0x116))logger_1[_0x1aa27c(0x12d)][_0x1aa27c(0x107)](_0x1aa27c(0xb6)+_0x1dc0e1['id']+'\x20of\x20company\x20'+_0x1dc0e1[_0x1aa27c(0xf1)]+_0x1aa27c(0xea)+_0x276b5b+_0x1aa27c(0xb9)),_0x3bed5f['join'](_0x1aa27c(0x111)+_0x1dc0e1['companyId']+'-'+_0x276b5b);else _0x276b5b===_0x1aa27c(0x13b)?_0x1dc0e1[_0x1aa27c(0xd5)][_0x1aa27c(0xdb)](_0x9fcc7=>{const _0x2c2fad=_0x1aa27c;logger_1[_0x2c2fad(0x12d)][_0x2c2fad(0x107)]('User\x20'+_0x1dc0e1['id']+_0x2c2fad(0x10f)+_0x1dc0e1[_0x2c2fad(0xf1)]+_0x2c2fad(0x135)+_0x9fcc7['id']+_0x2c2fad(0xf7)),_0x3bed5f['join'](_0x2c2fad(0xeb)+_0x9fcc7['id']+_0x2c2fad(0xef));}):logger_1['logger'][_0x1aa27c(0x107)](_0x1aa27c(0x133)+_0x1dc0e1['id']+_0x1aa27c(0xfb)+_0x276b5b);}}),_0x3bed5f['on'](_0x27ed7a(0xc2),_0x6b9948=>{const _0x1aee14=_0x27ed7a;if(_0x3ec9a5['decrementCounter']('status-'+_0x6b9948)===0x0){if(_0x1dc0e1[_0x1aee14(0xe9)]===_0x1aee14(0x116))logger_1[_0x1aee14(0x12d)][_0x1aee14(0x107)]('Admin\x20'+_0x1dc0e1['id']+_0x1aee14(0x10f)+_0x1dc0e1[_0x1aee14(0xf1)]+_0x1aee14(0xd7)+_0x6b9948+_0x1aee14(0xb9)),_0x3bed5f[_0x1aee14(0x11e)](_0x1aee14(0x111)+_0x1dc0e1[_0x1aee14(0xf1)]+'-'+_0x6b9948);else _0x6b9948===_0x1aee14(0x13b)&&_0x1dc0e1[_0x1aee14(0xd5)][_0x1aee14(0xdb)](_0x50dab4=>{const _0x5e731b=_0x1aee14;logger_1[_0x5e731b(0x12d)]['debug']('User\x20'+_0x1dc0e1['id']+_0x5e731b(0x10f)+_0x1dc0e1['companyId']+_0x5e731b(0x138)+_0x50dab4['id']+'\x20pending\x20tickets\x20channel.'),_0x3bed5f[_0x5e731b(0x11e)]('queue-'+_0x50dab4['id']+_0x5e731b(0xef));});}}),_0x3bed5f['on'](_0x27ed7a(0xda),()=>{const _0x21d07e=_0x27ed7a,_0xdfff4e=Array['from'](_0x3bed5f[_0x21d07e(0xec)]);_0x3bed5f[_0x21d07e(0x139)](_0x21d07e(0x127),{'socketId':_0x3bed5f['id'],'userId':_0x1dc0e1['id'],'companyId':_0x1dc0e1[_0x21d07e(0xf1)],'connectedRooms':_0xdfff4e,'timestamp':new Date()[_0x21d07e(0xba)]()}),logger_1['logger']['info'](_0x21d07e(0x132)+_0x1dc0e1['id']);}),_0x3bed5f[_0x27ed7a(0x139)]('ready'),io;}),io;};exports[a293_0x183ae7(0xe0)]=initIO;const emitPresence=(_0x41866b,_0x5eab2b,_0x5f5a00)=>{const _0x150ee0=a293_0x183ae7;if(!io){logger_1[_0x150ee0(0x12d)][_0x150ee0(0x131)](_0x150ee0(0xae));return;}logger_1[_0x150ee0(0x12d)][_0x150ee0(0xf2)](_0x150ee0(0xe2)+_0x5f5a00+_0x150ee0(0xc7)+_0x5eab2b+_0x150ee0(0xce)+_0x41866b);const _0x141ffe=['ticket-'+_0x5eab2b+'-presence','ticket-'+_0x5eab2b,_0x5eab2b['toString'](),_0x150ee0(0x111)+_0x41866b+_0x150ee0(0xf6),_0x150ee0(0x111)+_0x41866b+_0x150ee0(0xef)];logger_1[_0x150ee0(0x12d)][_0x150ee0(0x107)](_0x150ee0(0xcd)+_0x141ffe[_0x150ee0(0xe5)](',\x20')),io['to'](_0x150ee0(0x111)+_0x41866b+_0x150ee0(0xb2))[_0x150ee0(0x139)](_0x150ee0(0x111)+_0x41866b+_0x150ee0(0xb7),{'ticketId':_0x5eab2b,'presence':_0x5f5a00,'timestamp':new Date()[_0x150ee0(0xba)]()}),logger_1['logger'][_0x150ee0(0x107)](_0x150ee0(0xb5)+_0x5f5a00+_0x150ee0(0x102)+_0x5eab2b);try{const _0x3add98=io[_0x150ee0(0x122)][_0x150ee0(0xf5)]['rooms'][_0x150ee0(0x114)](_0x150ee0(0x111)+_0x41866b+'-mainchannel'),_0x6be27d=io['sockets'][_0x150ee0(0xf5)]['rooms'][_0x150ee0(0x114)](_0x5eab2b[_0x150ee0(0xd9)]());logger_1[_0x150ee0(0x12d)][_0x150ee0(0xf2)](_0x150ee0(0xc8)+(_0x3add98?_0x3add98[_0x150ee0(0x134)]:0x0)+_0x150ee0(0xcf)+(_0x150ee0(0x112)+(_0x6be27d?_0x6be27d[_0x150ee0(0x134)]:0x0)+_0x150ee0(0x110)));}catch(_0x42ba47){logger_1[_0x150ee0(0x12d)][_0x150ee0(0x131)](_0x150ee0(0xbb)+_0x42ba47['message']);}};exports[a293_0x183ae7(0xe1)]=emitPresence;const getIO=()=>{const _0x5106d9=a293_0x183ae7;if(!io)throw new AppError_1[(_0x5106d9(0xd8))]('Socket\x20IO\x20not\x20initialized');return io;};exports[a293_0x183ae7(0xf3)]=getIO;