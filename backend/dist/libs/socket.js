const a360_0x2dc336=a360_0x2ec6;(function(_0x1ce6a1,_0x1d5dc5){const _0x54f8af=a360_0x2ec6,_0x5eabf5=_0x1ce6a1();while(!![]){try{const _0x366448=-parseInt(_0x54f8af(0x176))/0x1*(-parseInt(_0x54f8af(0x161))/0x2)+-parseInt(_0x54f8af(0x126))/0x3+-parseInt(_0x54f8af(0x181))/0x4*(parseInt(_0x54f8af(0x10c))/0x5)+parseInt(_0x54f8af(0x109))/0x6+parseInt(_0x54f8af(0x18e))/0x7*(parseInt(_0x54f8af(0x197))/0x8)+parseInt(_0x54f8af(0x16a))/0x9+parseInt(_0x54f8af(0x135))/0xa*(-parseInt(_0x54f8af(0x128))/0xb);if(_0x366448===_0x1d5dc5)break;else _0x5eabf5['push'](_0x5eabf5['shift']());}catch(_0x1516f9){_0x5eabf5['push'](_0x5eabf5['shift']());}}}(a360_0x33a5,0xcad72));const a360_0x28d57d=(function(){let _0x3bdffc=!![];return function(_0x5a522c,_0xa2b6c2){const _0x37a53b=_0x3bdffc?function(){if(_0xa2b6c2){const _0x17415c=_0xa2b6c2['apply'](_0x5a522c,arguments);return _0xa2b6c2=null,_0x17415c;}}:function(){};return _0x3bdffc=![],_0x37a53b;};}()),a360_0x28c69b=a360_0x28d57d(this,function(){const _0x45093f=a360_0x2ec6;return a360_0x28c69b['toString']()[_0x45093f(0x143)]('(((.+)+)+)+$')[_0x45093f(0x188)]()[_0x45093f(0x168)](a360_0x28c69b)[_0x45093f(0x143)](_0x45093f(0x147));});a360_0x28c69b();'use strict';var __importDefault=this&&this['__importDefault']||function(_0x2f704e){const _0x776c3=a360_0x2ec6;return _0x2f704e&&_0x2f704e[_0x776c3(0x15c)]?_0x2f704e:{'default':_0x2f704e};};function a360_0x2ec6(_0x185006,_0x2bc0aa){const _0x247aad=a360_0x33a5();return a360_0x2ec6=function(_0x28c69b,_0x28d57d){_0x28c69b=_0x28c69b-0x106;let _0x33a50f=_0x247aad[_0x28c69b];return _0x33a50f;},a360_0x2ec6(_0x185006,_0x2bc0aa);}Object['defineProperty'](exports,a360_0x2dc336(0x15c),{'value':!![]}),exports[a360_0x2dc336(0x148)]=exports['emitPresence']=exports[a360_0x2dc336(0x14b)]=void 0x0;const socket_io_1=require('socket.io'),admin_ui_1=require(a360_0x2dc336(0x120)),jsonwebtoken_1=require(a360_0x2dc336(0x152)),AppError_1=__importDefault(require(a360_0x2dc336(0x138))),logger_1=require('../utils/logger'),User_1=__importDefault(require('../models/User')),Queue_1=__importDefault(require(a360_0x2dc336(0x10a))),Ticket_1=__importDefault(require('../models/Ticket')),auth_1=__importDefault(require('../config/auth')),counter_1=require(a360_0x2dc336(0x17b)),UserSocketSession_1=__importDefault(require(a360_0x2dc336(0x17f))),CheckSettings_1=require(a360_0x2dc336(0x172));let io;function a360_0x33a5(){const _0x15da42=['then','\x20leaved\x20queue\x20','pending',']:\x20Channel:\x20','\x20clients','Invalid\x20attempt\x20to\x20join\x20channel\x20of\x20ticket\x20','GetCompanySetting','\x20for\x20ticket\x20','verify','__esModule','create','error','\x20pending\x20tickets\x20channel.','debugInfo','122YjAXTu','env','ticket-','Debug\x20connection\x20info\x20sent\x20to\x20user\x20','handshake','emit','Presence\x20event\x20','constructor','queues','13779576vCzQVr','disabled','\x20joined\x20','queueId','joinChatBox','emitPresence','development','CounterManager','../helpers/CheckSettings','-mainchannel','Emitting\x20presence\x20event:\x20','\x20leaved\x20','9883CtvRqI','io-onConnection:\x20tokenData','\x20not\x20authorized\x20to\x20join\x20ticket\x20','joinedTicket','started\x20session\x20','./counter','sockets','profile','\x20of\x20company\x20','../models/UserSocketSession','-pending','1756tTqBow','companyId','-open','some','message','groupsTab','disconnect','toString','incrementCounter','Clossing\x20all\x20socket\x20sessions','Error\x20joining\x20ticket\x20room\x20','null','Socket\x20IO\x20not\x20initialized','2319569QLDqeL','\x20channel.','undefined','toISOString','parse','Ticket\x20room:\x20','allTicket','\x20cannot\x20subscribe\x20to\x20','-notification','8tfZsiQ','leaveNotification[','leave','\x20not\x20found','3690876omLMiZ','../models/Queue','forEach','14935nZiyFf','joinTicket','recording','online','FRONTEND_URL','super','isGroup','passwordHash','Error\x20decoding\x20token:\x20','available','Client\x20Connected:\x20','join','findByPk','connection','onConnect:\x20Missing\x20userId','Broadcasting\x20to\x20channels:\x20','default','Error\x20in\x20checkPresence:\x20','\x20by\x20user\x20','rooms','@socket.io/admin-ui','userId','User\x20','leaveChatbox[','query','debugConnection','1844160orKnTR','joinNotification[','1661pCIWHu','status-','email','onConnect:\x20User\x20',']:\x20User:\x20','ready','Socket\x20stats\x20-\x20Main\x20company\x20room:\x20','\x20for\x20user\x20','notification','\x20clients,\x20','info','user-','admin','21430fJyFAx','decrementCounter','\x20in\x20company\x20','../errors/AppError','joinNotification','from','-presence','adapter','get','leaveChatBox','company-','\x20joined\x20presence\x20channel\x20for\x20ticket\x20','instrument','\x20tickets\x20channel.','search','SOCKET_ADMIN','logger','Error\x20fetching\x20ticket\x20','(((.+)+)+)+$','getIO','Admin\x20','\x20from\x20user\x20','initIO','finished\x20session\x20','queue-','debug','basic','\x20joined\x20queue\x20','enabled','jsonwebtoken'];a360_0x33a5=function(){return _0x15da42;};return a360_0x33a5();}const joinTicketChannel=async(_0x16340b,_0x5b04cc,_0x4e427c,_0x268d21)=>{const _0x55fcf6=a360_0x2dc336,_0x484ee7=_0x268d21[_0x55fcf6(0x189)]('ticket-'+_0x5b04cc);_0x484ee7===0x1&&_0x16340b['join'](_0x5b04cc),logger_1[_0x55fcf6(0x145)][_0x55fcf6(0x14e)]('joinChatbox['+_0x484ee7+_0x55fcf6(0x156)+_0x5b04cc+_0x55fcf6(0x11e)+_0x4e427c['id']);},initIO=_0x234325=>{const _0x57ef6c=a360_0x2dc336;return io=new socket_io_1['Server'](_0x234325,{'cors':{'origin':process[_0x57ef6c(0x162)][_0x57ef6c(0x110)]}}),process[_0x57ef6c(0x162)][_0x57ef6c(0x144)]&&JSON[_0x57ef6c(0x192)](process[_0x57ef6c(0x162)][_0x57ef6c(0x144)])&&User_1[_0x57ef6c(0x11c)][_0x57ef6c(0x118)](0x1)['then'](_0x1545b6=>{const _0x157811=_0x57ef6c;(0x0,admin_ui_1[_0x157811(0x141)])(io,{'auth':{'type':_0x157811(0x14f),'username':_0x1545b6[_0x157811(0x12a)],'password':_0x1545b6[_0x157811(0x113)]},'mode':_0x157811(0x170)});}),UserSocketSession_1[_0x57ef6c(0x11c)]['update']({'active':![]},{'where':{'active':!![]}})[_0x57ef6c(0x153)](_0x2839be=>{const _0x551cbb=_0x57ef6c;logger_1[_0x551cbb(0x145)][_0x551cbb(0x14e)](_0x551cbb(0x18a));}),io['on'](_0x57ef6c(0x119),async _0x232a34=>{const _0x593e15=_0x57ef6c;logger_1[_0x593e15(0x145)]['info'](_0x593e15(0x116)+_0x232a34['id']);const {token:_0x5e2dbb}=_0x232a34[_0x593e15(0x165)][_0x593e15(0x124)];let _0x4225da=null;try{_0x4225da=(0x0,jsonwebtoken_1[_0x593e15(0x15b)])(_0x5e2dbb,auth_1['default']['secret']),logger_1[_0x593e15(0x145)][_0x593e15(0x14e)](_0x4225da,_0x593e15(0x177));}catch(_0x1d682f){return logger_1[_0x593e15(0x145)][_0x593e15(0x14e)](_0x593e15(0x114)+_0x1d682f?.[_0x593e15(0x185)]),_0x232a34[_0x593e15(0x187)](),io;}const _0x5e60a0=new counter_1[(_0x593e15(0x171))]();let _0x5a11fe=null;const _0x2f5ca2=_0x4225da['id'];if(_0x2f5ca2&&_0x2f5ca2!=='undefined'&&_0x2f5ca2!==_0x593e15(0x18c)){_0x5a11fe=await User_1[_0x593e15(0x11c)][_0x593e15(0x118)](_0x2f5ca2,{'include':[Queue_1['default']]});if(_0x5a11fe)_0x5a11fe[_0x593e15(0x10f)]=!![],await _0x5a11fe['save']();else return logger_1[_0x593e15(0x145)][_0x593e15(0x132)](_0x593e15(0x12b)+_0x2f5ca2+_0x593e15(0x108)),_0x232a34[_0x593e15(0x187)](),io;}else return logger_1[_0x593e15(0x145)][_0x593e15(0x132)](_0x593e15(0x11a)),_0x232a34[_0x593e15(0x187)](),io;return UserSocketSession_1[_0x593e15(0x11c)][_0x593e15(0x15d)]({'id':_0x232a34['id'],'userId':_0x2f5ca2,'active':!![]})['then'](_0x1c4683=>{const _0x51322f=_0x593e15;logger_1[_0x51322f(0x145)][_0x51322f(0x14e)](_0x51322f(0x17a)+_0x232a34['id']+_0x51322f(0x12f)+_0x2f5ca2);}),_0x232a34['on'](_0x593e15(0x187),async()=>{const _0x8360cd=_0x593e15;UserSocketSession_1[_0x8360cd(0x11c)]['update']({'active':![]},{'where':{'id':_0x232a34['id']}})[_0x8360cd(0x153)](()=>{const _0x5b80a0=_0x8360cd;logger_1[_0x5b80a0(0x145)]['debug'](_0x5b80a0(0x14c)+_0x232a34['id']+_0x5b80a0(0x12f)+_0x2f5ca2);});}),_0x232a34['join'](_0x593e15(0x13f)+_0x5a11fe['companyId']+_0x593e15(0x173)),_0x232a34[_0x593e15(0x117)](_0x593e15(0x133)+_0x5a11fe['id']),_0x5a11fe['super']&&_0x232a34[_0x593e15(0x117)](_0x593e15(0x111)),_0x232a34['on'](_0x593e15(0x10d),async _0x1c40d8=>{const _0x2768d7=_0x593e15;try{logger_1['logger'][_0x2768d7(0x132)]('User\x20'+_0x5a11fe['id']+'\x20joining\x20ticket\x20room:\x20'+_0x1c40d8),_0x232a34[_0x2768d7(0x117)](_0x1c40d8),_0x232a34[_0x2768d7(0x166)](_0x2768d7(0x179),{'ticketId':_0x1c40d8,'timestamp':new Date()[_0x2768d7(0x191)](),'success':!![]});}catch(_0x437fcd){logger_1[_0x2768d7(0x145)]['error'](_0x2768d7(0x18b)+_0x1c40d8+':\x20'+_0x437fcd[_0x2768d7(0x185)]),_0x232a34[_0x2768d7(0x166)](_0x2768d7(0x179),{'ticketId':_0x1c40d8,'timestamp':new Date()['toISOString'](),'success':![],'error':_0x437fcd['message']});}}),_0x232a34['on']('checkPresence',async _0x38c1c9=>{const _0xf8bd0f=_0x593e15;try{const {ticketId:_0x3eef2b}=_0x38c1c9;logger_1['logger']['info']('Received\x20checkPresence\x20for\x20ticket\x20'+_0x3eef2b+_0xf8bd0f(0x14a)+_0x5a11fe['id']),_0x232a34[_0xf8bd0f(0x166)](_0xf8bd0f(0x13f)+_0x5a11fe['companyId']+'-presence',{'ticketId':parseInt(_0x3eef2b),'presence':'composing','isTest':!![],'timestamp':new Date()[_0xf8bd0f(0x191)]()}),setTimeout(()=>{const _0x1a4e5d=_0xf8bd0f;_0x232a34[_0x1a4e5d(0x166)](_0x1a4e5d(0x13f)+_0x5a11fe[_0x1a4e5d(0x182)]+_0x1a4e5d(0x13b),{'ticketId':parseInt(_0x3eef2b),'presence':_0x1a4e5d(0x10e),'isTest':!![],'timestamp':new Date()[_0x1a4e5d(0x191)]()});},0x7d0),setTimeout(()=>{const _0x2caaa8=_0xf8bd0f;_0x232a34[_0x2caaa8(0x166)](_0x2caaa8(0x13f)+_0x5a11fe[_0x2caaa8(0x182)]+'-presence',{'ticketId':parseInt(_0x3eef2b),'presence':_0x2caaa8(0x115),'isTest':!![],'timestamp':new Date()[_0x2caaa8(0x191)]()}),logger_1[_0x2caaa8(0x145)][_0x2caaa8(0x132)]('Sent\x20test\x20presence\x20sequence\x20for\x20ticket\x20'+_0x3eef2b);},0xfa0);}catch(_0x49e3fd){logger_1[_0xf8bd0f(0x145)]['error'](_0xf8bd0f(0x11d)+_0x49e3fd[_0xf8bd0f(0x185)]);}}),_0x232a34['on'](_0x593e15(0x16e),async _0x29e578=>{const _0x340d87=_0x593e15;if(!_0x29e578||_0x29e578===_0x340d87(0x190))return;Ticket_1[_0x340d87(0x11c)][_0x340d87(0x118)](_0x29e578)[_0x340d87(0x153)](async _0x1773a7=>{const _0x350dc1=_0x340d87;if(_0x1773a7&&_0x1773a7[_0x350dc1(0x182)]===_0x5a11fe['companyId']){const _0x159625=_0x1773a7[_0x350dc1(0x121)]===_0x5a11fe['id'],_0x51ab09=_0x5a11fe[_0x350dc1(0x17d)]===_0x350dc1(0x134),_0x587f6e=_0x5a11fe[_0x350dc1(0x194)]===_0x350dc1(0x151),_0x57d7e6=_0x5a11fe['queues']?.[_0x350dc1(0x184)](_0x340d28=>_0x340d28['id']===_0x1773a7[_0x350dc1(0x16d)]);_0x159625||_0x51ab09||_0x587f6e||_0x57d7e6?(joinTicketChannel(_0x232a34,_0x29e578,_0x5a11fe,_0x5e60a0),_0x232a34[_0x350dc1(0x117)]('ticket-'+_0x29e578+'-presence'),logger_1[_0x350dc1(0x145)][_0x350dc1(0x14e)](_0x350dc1(0x122)+_0x5a11fe['id']+_0x350dc1(0x140)+_0x29e578)):logger_1[_0x350dc1(0x145)][_0x350dc1(0x132)](_0x350dc1(0x122)+_0x5a11fe['id']+_0x350dc1(0x178)+_0x29e578);}else{if(_0x1773a7[_0x350dc1(0x112)]&&await(0x0,CheckSettings_1[_0x350dc1(0x159)])(_0x5a11fe[_0x350dc1(0x182)],_0x350dc1(0x186),_0x350dc1(0x16b))===_0x350dc1(0x151)){let _0x3dd194=![];_0x5a11fe['queues'][_0x350dc1(0x10b)](_0x5e710e=>{_0x5e710e['id']===_0x1773a7['queueId']&&(_0x3dd194=!![]);}),_0x3dd194?(joinTicketChannel(_0x232a34,_0x29e578,_0x5a11fe,_0x5e60a0),_0x232a34[_0x350dc1(0x117)](_0x350dc1(0x163)+_0x29e578+'-presence'),logger_1[_0x350dc1(0x145)][_0x350dc1(0x14e)](_0x350dc1(0x122)+_0x5a11fe['id']+_0x350dc1(0x140)+_0x29e578)):logger_1['logger'][_0x350dc1(0x132)](_0x350dc1(0x158)+_0x29e578+_0x350dc1(0x11e)+_0x5a11fe['id']);}else logger_1[_0x350dc1(0x145)]['info'](_0x350dc1(0x158)+_0x29e578+'\x20by\x20user\x20'+_0x5a11fe['id']);}},_0x2ccba8=>{const _0x3739ef=_0x340d87;logger_1[_0x3739ef(0x145)][_0x3739ef(0x15e)](_0x2ccba8,_0x3739ef(0x146)+_0x29e578);});}),_0x232a34['on'](_0x593e15(0x13e),async _0x4522cd=>{const _0x3e31ee=_0x593e15;if(!_0x4522cd||_0x4522cd===_0x3e31ee(0x190))return;const _0x883d0b=_0x5e60a0['decrementCounter'](_0x3e31ee(0x163)+_0x4522cd);_0x883d0b===0x0&&(_0x232a34['leave'](_0x4522cd),_0x232a34['leave'](_0x3e31ee(0x163)+_0x4522cd+_0x3e31ee(0x13b))),logger_1[_0x3e31ee(0x145)]['debug'](_0x3e31ee(0x123)+_0x883d0b+']:\x20Channel:\x20'+_0x4522cd+_0x3e31ee(0x11e)+_0x5a11fe['id']);}),_0x232a34['on'](_0x593e15(0x139),async()=>{const _0x382e46=_0x593e15,_0x5db58c=_0x5e60a0[_0x382e46(0x189)](_0x382e46(0x130));_0x5db58c===0x1&&(_0x5a11fe[_0x382e46(0x17d)]==='admin'?_0x232a34[_0x382e46(0x117)]('company-'+_0x5a11fe[_0x382e46(0x182)]+_0x382e46(0x196)):_0x5a11fe[_0x382e46(0x169)][_0x382e46(0x10b)](_0x596c62=>{const _0x141d3d=_0x382e46;logger_1[_0x141d3d(0x145)]['debug']('User\x20'+_0x5a11fe['id']+_0x141d3d(0x17e)+_0x5a11fe['companyId']+_0x141d3d(0x150)+_0x596c62['id']+'\x20channel.'),_0x232a34[_0x141d3d(0x117)](_0x141d3d(0x14d)+_0x596c62['id']+_0x141d3d(0x196));})),logger_1[_0x382e46(0x145)][_0x382e46(0x14e)](_0x382e46(0x127)+_0x5db58c+_0x382e46(0x12c)+_0x5a11fe['id']);}),_0x232a34['on']('leaveNotification',async()=>{const _0x3c1c38=_0x593e15,_0x272b74=_0x5e60a0[_0x3c1c38(0x136)](_0x3c1c38(0x130));_0x272b74===0x0&&(_0x5a11fe[_0x3c1c38(0x17d)]===_0x3c1c38(0x134)?_0x232a34['leave']('company-'+_0x5a11fe['companyId']+_0x3c1c38(0x196)):_0x5a11fe[_0x3c1c38(0x169)][_0x3c1c38(0x10b)](_0xc78a70=>{const _0x227628=_0x3c1c38;logger_1[_0x227628(0x145)]['debug'](_0x227628(0x122)+_0x5a11fe['id']+_0x227628(0x17e)+_0x5a11fe[_0x227628(0x182)]+_0x227628(0x154)+_0xc78a70['id']+_0x227628(0x18f)),_0x232a34[_0x227628(0x107)](_0x227628(0x14d)+_0xc78a70['id']+_0x227628(0x196));})),logger_1[_0x3c1c38(0x145)][_0x3c1c38(0x14e)](_0x3c1c38(0x106)+_0x272b74+']:\x20User:\x20'+_0x5a11fe['id']);}),_0x232a34['on']('joinTickets',_0x443fca=>{const _0x2cb10b=_0x593e15;if(_0x5e60a0[_0x2cb10b(0x189)](_0x2cb10b(0x129)+_0x443fca)===0x1){if(_0x5a11fe['profile']===_0x2cb10b(0x134))logger_1[_0x2cb10b(0x145)][_0x2cb10b(0x14e)](_0x2cb10b(0x149)+_0x5a11fe['id']+_0x2cb10b(0x17e)+_0x5a11fe['companyId']+_0x2cb10b(0x16c)+_0x443fca+_0x2cb10b(0x142)),_0x232a34[_0x2cb10b(0x117)](_0x2cb10b(0x13f)+_0x5a11fe[_0x2cb10b(0x182)]+'-'+_0x443fca);else _0x443fca===_0x2cb10b(0x155)?_0x5a11fe[_0x2cb10b(0x169)][_0x2cb10b(0x10b)](_0x3a2609=>{const _0x8f7073=_0x2cb10b;logger_1[_0x8f7073(0x145)][_0x8f7073(0x14e)](_0x8f7073(0x122)+_0x5a11fe['id']+_0x8f7073(0x17e)+_0x5a11fe[_0x8f7073(0x182)]+_0x8f7073(0x150)+_0x3a2609['id']+_0x8f7073(0x15f)),_0x232a34['join']('queue-'+_0x3a2609['id']+_0x8f7073(0x180));}):logger_1['logger'][_0x2cb10b(0x14e)](_0x2cb10b(0x122)+_0x5a11fe['id']+_0x2cb10b(0x195)+_0x443fca);}}),_0x232a34['on']('leaveTickets',_0x257a54=>{const _0x157561=_0x593e15;if(_0x5e60a0['decrementCounter']('status-'+_0x257a54)===0x0){if(_0x5a11fe['profile']===_0x157561(0x134))logger_1[_0x157561(0x145)][_0x157561(0x14e)](_0x157561(0x149)+_0x5a11fe['id']+'\x20of\x20company\x20'+_0x5a11fe[_0x157561(0x182)]+_0x157561(0x175)+_0x257a54+_0x157561(0x142)),_0x232a34[_0x157561(0x107)](_0x157561(0x13f)+_0x5a11fe[_0x157561(0x182)]+'-'+_0x257a54);else _0x257a54===_0x157561(0x155)&&_0x5a11fe[_0x157561(0x169)]['forEach'](_0x537d2d=>{const _0x4b398b=_0x157561;logger_1[_0x4b398b(0x145)][_0x4b398b(0x14e)]('User\x20'+_0x5a11fe['id']+_0x4b398b(0x17e)+_0x5a11fe[_0x4b398b(0x182)]+'\x20leaved\x20queue\x20'+_0x537d2d['id']+_0x4b398b(0x15f)),_0x232a34[_0x4b398b(0x107)](_0x4b398b(0x14d)+_0x537d2d['id']+_0x4b398b(0x180));});}}),_0x232a34['on'](_0x593e15(0x125),()=>{const _0x51a54f=_0x593e15,_0x3f303b=Array[_0x51a54f(0x13a)](_0x232a34[_0x51a54f(0x11f)]);_0x232a34[_0x51a54f(0x166)](_0x51a54f(0x160),{'socketId':_0x232a34['id'],'userId':_0x5a11fe['id'],'companyId':_0x5a11fe['companyId'],'connectedRooms':_0x3f303b,'timestamp':new Date()['toISOString']()}),logger_1[_0x51a54f(0x145)]['info'](_0x51a54f(0x164)+_0x5a11fe['id']);}),_0x232a34[_0x593e15(0x166)](_0x593e15(0x12d)),io;}),io;};exports['initIO']=initIO;const emitPresence=(_0x49bd47,_0x498dab,_0x1fe414)=>{const _0xc68087=a360_0x2dc336;if(!io){logger_1['logger'][_0xc68087(0x15e)]('Socket\x20IO\x20not\x20initialized\x20when\x20trying\x20to\x20emit\x20presence');return;}logger_1[_0xc68087(0x145)][_0xc68087(0x132)](_0xc68087(0x174)+_0x1fe414+_0xc68087(0x15a)+_0x498dab+_0xc68087(0x137)+_0x49bd47);const _0x214dad=[_0xc68087(0x163)+_0x498dab+'-presence',_0xc68087(0x163)+_0x498dab,_0x498dab[_0xc68087(0x188)](),_0xc68087(0x13f)+_0x49bd47+_0xc68087(0x183),'company-'+_0x49bd47+'-pending'];logger_1[_0xc68087(0x145)][_0xc68087(0x14e)](_0xc68087(0x11b)+_0x214dad[_0xc68087(0x117)](',\x20')),io['to']('company-'+_0x49bd47+_0xc68087(0x173))[_0xc68087(0x166)]('company-'+_0x49bd47+'-presence',{'ticketId':_0x498dab,'presence':_0x1fe414,'timestamp':new Date()[_0xc68087(0x191)]()}),logger_1['logger'][_0xc68087(0x14e)](_0xc68087(0x167)+_0x1fe414+'\x20emitted\x20for\x20ticket\x20'+_0x498dab);try{const _0x17d469=io[_0xc68087(0x17c)]['adapter'][_0xc68087(0x11f)][_0xc68087(0x13d)]('company-'+_0x49bd47+_0xc68087(0x173)),_0x18f9d4=io[_0xc68087(0x17c)][_0xc68087(0x13c)]['rooms'][_0xc68087(0x13d)](_0x498dab['toString']());logger_1[_0xc68087(0x145)][_0xc68087(0x132)](_0xc68087(0x12e)+(_0x17d469?_0x17d469['size']:0x0)+_0xc68087(0x131)+(_0xc68087(0x193)+(_0x18f9d4?_0x18f9d4['size']:0x0)+_0xc68087(0x157)));}catch(_0x2cfef1){logger_1[_0xc68087(0x145)][_0xc68087(0x15e)]('Error\x20counting\x20room\x20clients:\x20'+_0x2cfef1['message']);}};exports[a360_0x2dc336(0x16f)]=emitPresence;const getIO=()=>{const _0x29ef52=a360_0x2dc336;if(!io)throw new AppError_1[(_0x29ef52(0x11c))](_0x29ef52(0x18d));return io;};exports['getIO']=getIO;