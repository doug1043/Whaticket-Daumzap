const a297_0x3515fc=a297_0xede1;(function(_0x17a6e6,_0xe568d3){const _0x558536=a297_0xede1,_0x1b00ed=_0x17a6e6();while(!![]){try{const _0x4fe762=parseInt(_0x558536(0x74))/0x1+parseInt(_0x558536(0xfe))/0x2*(parseInt(_0x558536(0xbe))/0x3)+parseInt(_0x558536(0xd6))/0x4*(parseInt(_0x558536(0xa2))/0x5)+-parseInt(_0x558536(0x76))/0x6+parseInt(_0x558536(0xa8))/0x7+parseInt(_0x558536(0xac))/0x8+-parseInt(_0x558536(0x9f))/0x9*(parseInt(_0x558536(0xe1))/0xa);if(_0x4fe762===_0xe568d3)break;else _0x1b00ed['push'](_0x1b00ed['shift']());}catch(_0x1fa2fb){_0x1b00ed['push'](_0x1b00ed['shift']());}}}(a297_0x5015,0x513cc));const a297_0x507715=(function(){let _0x5d4e94=!![];return function(_0x20da8a,_0x4a44f3){const _0x14a2e9=_0x5d4e94?function(){const _0x345fa4=a297_0xede1;if(_0x4a44f3){const _0x225a05=_0x4a44f3[_0x345fa4(0xab)](_0x20da8a,arguments);return _0x4a44f3=null,_0x225a05;}}:function(){};return _0x5d4e94=![],_0x14a2e9;};}()),a297_0xbecd0=a297_0x507715(this,function(){const _0x3aeccb=a297_0xede1;return a297_0xbecd0[_0x3aeccb(0x89)]()[_0x3aeccb(0xb1)](_0x3aeccb(0xa6))[_0x3aeccb(0x89)]()['constructor'](a297_0xbecd0)['search'](_0x3aeccb(0xa6));});a297_0xbecd0();'use strict';var __importDefault=this&&this['__importDefault']||function(_0x439de2){const _0x3b85bb=a297_0xede1;return _0x439de2&&_0x439de2[_0x3b85bb(0x9a)]?_0x439de2:{'default':_0x439de2};};Object['defineProperty'](exports,a297_0x3515fc(0x9a),{'value':!![]}),exports[a297_0x3515fc(0xa5)]=exports[a297_0x3515fc(0x88)]=exports[a297_0x3515fc(0xdb)]=void 0x0;const socket_io_1=require(a297_0x3515fc(0xf3)),admin_ui_1=require(a297_0x3515fc(0xa0)),jsonwebtoken_1=require(a297_0x3515fc(0x92)),AppError_1=__importDefault(require(a297_0x3515fc(0x8a))),logger_1=require(a297_0x3515fc(0xf2)),User_1=__importDefault(require(a297_0x3515fc(0xd2))),Queue_1=__importDefault(require(a297_0x3515fc(0x103))),Ticket_1=__importDefault(require(a297_0x3515fc(0x75))),auth_1=__importDefault(require(a297_0x3515fc(0x9b))),counter_1=require(a297_0x3515fc(0xde)),UserSocketSession_1=__importDefault(require('../models/UserSocketSession')),CheckSettings_1=require('../helpers/CheckSettings');let io;const joinTicketChannel=async(_0x1f1be8,_0x1a7806,_0x5dffa7,_0x27d5e4)=>{const _0x19bb83=a297_0x3515fc,_0x8f2cdd=_0x27d5e4[_0x19bb83(0xc4)]('ticket-'+_0x1a7806);_0x8f2cdd===0x1&&_0x1f1be8[_0x19bb83(0xca)](_0x1a7806),logger_1['logger'][_0x19bb83(0x93)](_0x19bb83(0xdd)+_0x8f2cdd+_0x19bb83(0xaf)+_0x1a7806+_0x19bb83(0xa1)+_0x5dffa7['id']);},initIO=_0x6f9232=>{const _0x13cece=a297_0x3515fc;return io=new socket_io_1[(_0x13cece(0x100))](_0x6f9232,{'cors':{'origin':process[_0x13cece(0x8e)]['FRONTEND_URL']}}),process[_0x13cece(0x8e)][_0x13cece(0xd4)]&&JSON[_0x13cece(0x9d)](process[_0x13cece(0x8e)][_0x13cece(0xd4)])&&User_1[_0x13cece(0x94)][_0x13cece(0xd3)](0x1)['then'](_0x5d375f=>{const _0x523f0a=_0x13cece;(0x0,admin_ui_1[_0x523f0a(0xa7)])(io,{'auth':{'type':_0x523f0a(0xf6),'username':_0x5d375f[_0x523f0a(0xb9)],'password':_0x5d375f[_0x523f0a(0x8d)]},'mode':_0x523f0a(0xba)});}),UserSocketSession_1[_0x13cece(0x94)][_0x13cece(0xcf)]({'active':![]},{'where':{'active':!![]}})[_0x13cece(0xa4)](_0x562937=>{const _0x5985ed=_0x13cece;logger_1[_0x5985ed(0xe2)][_0x5985ed(0x93)](_0x5985ed(0x73));}),io['on']('connection',async _0x6559ca=>{const _0x4cf004=_0x13cece;logger_1[_0x4cf004(0xe2)][_0x4cf004(0xe4)](_0x4cf004(0x81)+_0x6559ca['id']);const {token:_0x142da2}=_0x6559ca['handshake'][_0x4cf004(0xf0)];let _0x44b69b=null;try{_0x44b69b=(0x0,jsonwebtoken_1[_0x4cf004(0xb6)])(_0x142da2,auth_1[_0x4cf004(0x94)][_0x4cf004(0x96)]),logger_1['logger'][_0x4cf004(0x93)](_0x44b69b,_0x4cf004(0x91));}catch(_0x5460b3){return logger_1[_0x4cf004(0xe2)]['debug'](_0x4cf004(0xd0)+_0x5460b3?.['message']),_0x6559ca[_0x4cf004(0x87)](),io;}const _0x3366e2=new counter_1['CounterManager']();let _0x40712f=null;const _0xd7f07e=_0x44b69b['id'];if(_0xd7f07e&&_0xd7f07e!=='undefined'&&_0xd7f07e!==_0x4cf004(0xc6)){_0x40712f=await User_1[_0x4cf004(0x94)]['findByPk'](_0xd7f07e,{'include':[Queue_1[_0x4cf004(0x94)]]});if(_0x40712f)_0x40712f['online']=!![],await _0x40712f[_0x4cf004(0x102)]();else return logger_1[_0x4cf004(0xe2)][_0x4cf004(0xe4)](_0x4cf004(0x7e)+_0xd7f07e+_0x4cf004(0xec)),_0x6559ca[_0x4cf004(0x87)](),io;}else return logger_1[_0x4cf004(0xe2)][_0x4cf004(0xe4)](_0x4cf004(0xea)),_0x6559ca[_0x4cf004(0x87)](),io;return UserSocketSession_1[_0x4cf004(0x94)][_0x4cf004(0xc8)]({'id':_0x6559ca['id'],'userId':_0xd7f07e,'active':!![]})[_0x4cf004(0xa4)](_0x530afe=>{const _0x2ec80c=_0x4cf004;logger_1[_0x2ec80c(0xe2)]['debug']('started\x20session\x20'+_0x6559ca['id']+_0x2ec80c(0xf4)+_0xd7f07e);}),_0x6559ca['on'](_0x4cf004(0x87),async()=>{const _0x34f03f=_0x4cf004;UserSocketSession_1[_0x34f03f(0x94)][_0x34f03f(0xcf)]({'active':![]},{'where':{'id':_0x6559ca['id']}})[_0x34f03f(0xa4)](()=>{const _0x58fa51=_0x34f03f;logger_1['logger'][_0x58fa51(0x93)](_0x58fa51(0xbf)+_0x6559ca['id']+'\x20for\x20user\x20'+_0xd7f07e);});}),_0x6559ca[_0x4cf004(0xca)](_0x4cf004(0x83)+_0x40712f[_0x4cf004(0xc2)]+_0x4cf004(0xe3)),_0x6559ca[_0x4cf004(0xca)](_0x4cf004(0xfa)+_0x40712f['id']),_0x40712f[_0x4cf004(0xfb)]&&_0x6559ca['join']('super'),_0x6559ca['on'](_0x4cf004(0xae),async _0x1af757=>{const _0x4b51b4=_0x4cf004;try{logger_1[_0x4b51b4(0xe2)][_0x4b51b4(0xe4)](_0x4b51b4(0x8f)+_0x40712f['id']+_0x4b51b4(0xfd)+_0x1af757),_0x6559ca[_0x4b51b4(0xca)](_0x1af757),_0x6559ca[_0x4b51b4(0xda)]('joinedTicket',{'ticketId':_0x1af757,'timestamp':new Date()[_0x4b51b4(0x7f)](),'success':!![]});}catch(_0x281053){logger_1[_0x4b51b4(0xe2)][_0x4b51b4(0xee)](_0x4b51b4(0xed)+_0x1af757+':\x20'+_0x281053[_0x4b51b4(0x84)]),_0x6559ca[_0x4b51b4(0xda)](_0x4b51b4(0x80),{'ticketId':_0x1af757,'timestamp':new Date()[_0x4b51b4(0x7f)](),'success':![],'error':_0x281053[_0x4b51b4(0x84)]});}}),_0x6559ca['on'](_0x4cf004(0xf8),async _0x1472d2=>{const _0x53c83d=_0x4cf004;try{const {ticketId:_0x305033}=_0x1472d2;logger_1[_0x53c83d(0xe2)][_0x53c83d(0xe4)](_0x53c83d(0x95)+_0x305033+_0x53c83d(0xe8)+_0x40712f['id']),_0x6559ca[_0x53c83d(0xda)](_0x53c83d(0x83)+_0x40712f['companyId']+'-presence',{'ticketId':parseInt(_0x305033),'presence':_0x53c83d(0xb5),'isTest':!![],'timestamp':new Date()[_0x53c83d(0x7f)]()}),setTimeout(()=>{const _0x2d7b2c=_0x53c83d;_0x6559ca[_0x2d7b2c(0xda)](_0x2d7b2c(0x83)+_0x40712f[_0x2d7b2c(0xc2)]+_0x2d7b2c(0x77),{'ticketId':parseInt(_0x305033),'presence':_0x2d7b2c(0x97),'isTest':!![],'timestamp':new Date()[_0x2d7b2c(0x7f)]()});},0x7d0),setTimeout(()=>{const _0x3a3d76=_0x53c83d;_0x6559ca['emit']('company-'+_0x40712f['companyId']+_0x3a3d76(0x77),{'ticketId':parseInt(_0x305033),'presence':_0x3a3d76(0xd8),'isTest':!![],'timestamp':new Date()[_0x3a3d76(0x7f)]()}),logger_1[_0x3a3d76(0xe2)]['info'](_0x3a3d76(0x90)+_0x305033);},0xfa0);}catch(_0x55826d){logger_1['logger'][_0x53c83d(0xee)](_0x53c83d(0x8b)+_0x55826d[_0x53c83d(0x84)]);}}),_0x6559ca['on'](_0x4cf004(0xc3),async _0x2725bc=>{const _0x3351b6=_0x4cf004;if(!_0x2725bc||_0x2725bc==='undefined')return;Ticket_1[_0x3351b6(0x94)]['findByPk'](_0x2725bc)[_0x3351b6(0xa4)](async _0x45ce27=>{const _0x4b2794=_0x3351b6;if(_0x45ce27&&_0x45ce27[_0x4b2794(0xc2)]===_0x40712f[_0x4b2794(0xc2)]&&(_0x45ce27[_0x4b2794(0xfc)]===_0x40712f['id']||_0x40712f[_0x4b2794(0xff)]===_0x4b2794(0xb0)))joinTicketChannel(_0x6559ca,_0x2725bc,_0x40712f,_0x3366e2),_0x6559ca['join'](_0x4b2794(0xbd)+_0x2725bc+_0x4b2794(0x77)),logger_1['logger'][_0x4b2794(0x93)]('User\x20'+_0x40712f['id']+_0x4b2794(0xe5)+_0x2725bc);else{if(_0x45ce27[_0x4b2794(0xad)]&&await(0x0,CheckSettings_1[_0x4b2794(0xb8)])(_0x40712f[_0x4b2794(0xc2)],_0x4b2794(0xe7),'disabled')===_0x4b2794(0xce)){let _0x58ddc2=![];_0x40712f[_0x4b2794(0xd5)][_0x4b2794(0xa9)](_0x5be5d9=>{const _0xd2bfc5=_0x4b2794;_0x5be5d9['id']===_0x45ce27[_0xd2bfc5(0xa3)]&&(_0x58ddc2=!![]);}),_0x58ddc2?(joinTicketChannel(_0x6559ca,_0x2725bc,_0x40712f,_0x3366e2),_0x6559ca['join']('ticket-'+_0x2725bc+_0x4b2794(0x77)),logger_1[_0x4b2794(0xe2)][_0x4b2794(0x93)]('User\x20'+_0x40712f['id']+_0x4b2794(0xe5)+_0x2725bc)):logger_1[_0x4b2794(0xe2)][_0x4b2794(0xe4)](_0x4b2794(0xf7)+_0x2725bc+_0x4b2794(0xa1)+_0x40712f['id']);}else logger_1[_0x4b2794(0xe2)][_0x4b2794(0xe4)]('Invalid\x20attempt\x20to\x20join\x20channel\x20of\x20ticket\x20'+_0x2725bc+_0x4b2794(0xa1)+_0x40712f['id']);}},_0x15b77b=>{const _0xd9d9cb=_0x3351b6;logger_1[_0xd9d9cb(0xe2)][_0xd9d9cb(0xee)](_0x15b77b,_0xd9d9cb(0x101)+_0x2725bc);});}),_0x6559ca['on'](_0x4cf004(0xf1),async _0x521d57=>{const _0x310669=_0x4cf004;if(!_0x521d57||_0x521d57==='undefined')return;const _0x31802d=_0x3366e2[_0x310669(0x86)](_0x310669(0xbd)+_0x521d57);_0x31802d===0x0&&(_0x6559ca['leave'](_0x521d57),_0x6559ca[_0x310669(0xd7)](_0x310669(0xbd)+_0x521d57+'-presence')),logger_1[_0x310669(0xe2)][_0x310669(0x93)](_0x310669(0x7d)+_0x31802d+_0x310669(0xaf)+_0x521d57+_0x310669(0xa1)+_0x40712f['id']);}),_0x6559ca['on'](_0x4cf004(0xc9),async()=>{const _0x299aa5=_0x4cf004,_0x30646e=_0x3366e2[_0x299aa5(0xc4)](_0x299aa5(0xe9));_0x30646e===0x1&&(_0x40712f[_0x299aa5(0xff)]===_0x299aa5(0xb0)?_0x6559ca[_0x299aa5(0xca)]('company-'+_0x40712f[_0x299aa5(0xc2)]+_0x299aa5(0x78)):_0x40712f[_0x299aa5(0xd5)][_0x299aa5(0xa9)](_0x331504=>{const _0x2b1b6d=_0x299aa5;logger_1['logger'][_0x2b1b6d(0x93)](_0x2b1b6d(0x8f)+_0x40712f['id']+_0x2b1b6d(0xeb)+_0x40712f['companyId']+_0x2b1b6d(0xaa)+_0x331504['id']+'\x20channel.'),_0x6559ca[_0x2b1b6d(0xca)](_0x2b1b6d(0xe6)+_0x331504['id']+_0x2b1b6d(0x78));})),logger_1[_0x299aa5(0xe2)][_0x299aa5(0x93)](_0x299aa5(0xcc)+_0x30646e+']:\x20User:\x20'+_0x40712f['id']);}),_0x6559ca['on'](_0x4cf004(0x71),async()=>{const _0x587b15=_0x4cf004,_0x12927d=_0x3366e2['decrementCounter'](_0x587b15(0xe9));_0x12927d===0x0&&(_0x40712f[_0x587b15(0xff)]===_0x587b15(0xb0)?_0x6559ca[_0x587b15(0xd7)]('company-'+_0x40712f['companyId']+'-notification'):_0x40712f['queues'][_0x587b15(0xa9)](_0x2e1868=>{const _0x15466c=_0x587b15;logger_1[_0x15466c(0xe2)][_0x15466c(0x93)](_0x15466c(0x8f)+_0x40712f['id']+'\x20of\x20company\x20'+_0x40712f[_0x15466c(0xc2)]+'\x20leaved\x20queue\x20'+_0x2e1868['id']+_0x15466c(0xc1)),_0x6559ca['leave'](_0x15466c(0xe6)+_0x2e1868['id']+_0x15466c(0x78));})),logger_1[_0x587b15(0xe2)]['debug'](_0x587b15(0xbb)+_0x12927d+_0x587b15(0xdc)+_0x40712f['id']);}),_0x6559ca['on'](_0x4cf004(0xc0),_0x55136e=>{const _0x5c6bec=_0x4cf004;if(_0x3366e2[_0x5c6bec(0xc4)](_0x5c6bec(0x85)+_0x55136e)===0x1){if(_0x40712f['profile']===_0x5c6bec(0xb0))logger_1[_0x5c6bec(0xe2)][_0x5c6bec(0x93)](_0x5c6bec(0x7a)+_0x40712f['id']+_0x5c6bec(0xeb)+_0x40712f[_0x5c6bec(0xc2)]+_0x5c6bec(0xb3)+_0x55136e+_0x5c6bec(0x7c)),_0x6559ca[_0x5c6bec(0xca)](_0x5c6bec(0x83)+_0x40712f[_0x5c6bec(0xc2)]+'-'+_0x55136e);else _0x55136e==='pending'?_0x40712f[_0x5c6bec(0xd5)][_0x5c6bec(0xa9)](_0x5eaf23=>{const _0x52ed43=_0x5c6bec;logger_1[_0x52ed43(0xe2)][_0x52ed43(0x93)](_0x52ed43(0x8f)+_0x40712f['id']+'\x20of\x20company\x20'+_0x40712f[_0x52ed43(0xc2)]+_0x52ed43(0xaa)+_0x5eaf23['id']+'\x20pending\x20tickets\x20channel.'),_0x6559ca[_0x52ed43(0xca)](_0x52ed43(0xe6)+_0x5eaf23['id']+_0x52ed43(0x9e));}):logger_1['logger'][_0x5c6bec(0x93)](_0x5c6bec(0x8f)+_0x40712f['id']+'\x20cannot\x20subscribe\x20to\x20'+_0x55136e);}}),_0x6559ca['on'](_0x4cf004(0xdf),_0x2b5add=>{const _0x3d0ac5=_0x4cf004;if(_0x3366e2[_0x3d0ac5(0x86)](_0x3d0ac5(0x85)+_0x2b5add)===0x0){if(_0x40712f[_0x3d0ac5(0xff)]===_0x3d0ac5(0xb0))logger_1[_0x3d0ac5(0xe2)][_0x3d0ac5(0x93)](_0x3d0ac5(0x7a)+_0x40712f['id']+_0x3d0ac5(0xeb)+_0x40712f['companyId']+_0x3d0ac5(0xb2)+_0x2b5add+_0x3d0ac5(0x7c)),_0x6559ca[_0x3d0ac5(0xd7)]('company-'+_0x40712f[_0x3d0ac5(0xc2)]+'-'+_0x2b5add);else _0x2b5add==='pending'&&_0x40712f['queues'][_0x3d0ac5(0xa9)](_0x4def07=>{const _0x4c93ad=_0x3d0ac5;logger_1[_0x4c93ad(0xe2)]['debug'](_0x4c93ad(0x8f)+_0x40712f['id']+'\x20of\x20company\x20'+_0x40712f[_0x4c93ad(0xc2)]+_0x4c93ad(0xcd)+_0x4def07['id']+_0x4c93ad(0xbc)),_0x6559ca[_0x4c93ad(0xd7)](_0x4c93ad(0xe6)+_0x4def07['id']+_0x4c93ad(0x9e));});}}),_0x6559ca['on'](_0x4cf004(0xd1),()=>{const _0x18a95c=_0x4cf004,_0x599e3a=Array[_0x18a95c(0x7b)](_0x6559ca[_0x18a95c(0xef)]);_0x6559ca['emit']('debugInfo',{'socketId':_0x6559ca['id'],'userId':_0x40712f['id'],'companyId':_0x40712f['companyId'],'connectedRooms':_0x599e3a,'timestamp':new Date()[_0x18a95c(0x7f)]()}),logger_1[_0x18a95c(0xe2)][_0x18a95c(0xe4)](_0x18a95c(0x99)+_0x40712f['id']);}),_0x6559ca['emit'](_0x4cf004(0xd9)),io;}),io;};exports[a297_0x3515fc(0xdb)]=initIO;function a297_0x5015(){const _0xe0b02=['2NoFCmj','profile','Server','Error\x20fetching\x20ticket\x20','save','../models/Queue','leaveNotification','\x20emitted\x20for\x20ticket\x20','Clossing\x20all\x20socket\x20sessions','503692BxtDKR','../models/Ticket','3042660BYmxNK','-presence','-notification','adapter','Admin\x20','from','\x20tickets\x20channel.','leaveChatbox[','onConnect:\x20User\x20','toISOString','joinedTicket','Client\x20Connected:\x20','Ticket\x20room:\x20','company-','message','status-','decrementCounter','disconnect','emitPresence','toString','../errors/AppError','Error\x20in\x20checkPresence:\x20','size','passwordHash','env','User\x20','Sent\x20test\x20presence\x20sequence\x20for\x20ticket\x20','io-onConnection:\x20tokenData','jsonwebtoken','debug','default','Received\x20checkPresence\x20for\x20ticket\x20','secret','recording','Error\x20counting\x20room\x20clients:\x20','Debug\x20connection\x20info\x20sent\x20to\x20user\x20','__esModule','../config/auth','-open','parse','-pending','790173lgCiJE','@socket.io/admin-ui','\x20by\x20user\x20','5795kMzAwr','queueId','then','getIO','(((.+)+)+)+$','instrument','1061823mWEjPt','forEach','\x20joined\x20queue\x20','apply','3147920ZXNjwi','isGroup','joinTicket',']:\x20Channel:\x20','admin','search','\x20leaved\x20','\x20joined\x20','Broadcasting\x20to\x20channels:\x20','composing','verify','\x20in\x20company\x20','GetCompanySetting','email','development','leaveNotification[','\x20pending\x20tickets\x20channel.','ticket-','779490tlMcVT','finished\x20session\x20','joinTickets','\x20channel.','companyId','joinChatBox','incrementCounter','Socket\x20IO\x20not\x20initialized','null','Emitting\x20presence\x20event:\x20','create','joinNotification','join','\x20for\x20ticket\x20','joinNotification[','\x20leaved\x20queue\x20','enabled','update','Error\x20decoding\x20token:\x20','debugConnection','../models/User','findByPk','SOCKET_ADMIN','queues','1412aOPliD','leave','available','ready','emit','initIO',']:\x20User:\x20','joinChatbox[','./counter','leaveTickets','Socket\x20IO\x20not\x20initialized\x20when\x20trying\x20to\x20emit\x20presence','100ohFwCM','logger','-mainchannel','info','\x20joined\x20presence\x20channel\x20for\x20ticket\x20','queue-','groupsTab','\x20from\x20user\x20','notification','onConnect:\x20Missing\x20userId','\x20of\x20company\x20','\x20not\x20found','Error\x20joining\x20ticket\x20room\x20','error','rooms','query','leaveChatBox','../utils/logger','socket.io','\x20for\x20user\x20','get','basic','Invalid\x20attempt\x20to\x20join\x20channel\x20of\x20ticket\x20','checkPresence','sockets','user-','super','userId','\x20joining\x20ticket\x20room:\x20'];a297_0x5015=function(){return _0xe0b02;};return a297_0x5015();}function a297_0xede1(_0x442066,_0x204368){const _0x2c99ca=a297_0x5015();return a297_0xede1=function(_0xbecd0,_0x507715){_0xbecd0=_0xbecd0-0x71;let _0x50154e=_0x2c99ca[_0xbecd0];return _0x50154e;},a297_0xede1(_0x442066,_0x204368);}const emitPresence=(_0x19e865,_0x344874,_0x211bd6)=>{const _0x2ab37c=a297_0x3515fc;if(!io){logger_1[_0x2ab37c(0xe2)][_0x2ab37c(0xee)](_0x2ab37c(0xe0));return;}logger_1[_0x2ab37c(0xe2)]['info'](_0x2ab37c(0xc7)+_0x211bd6+_0x2ab37c(0xcb)+_0x344874+_0x2ab37c(0xb7)+_0x19e865);const _0x27e82d=[_0x2ab37c(0xbd)+_0x344874+_0x2ab37c(0x77),_0x2ab37c(0xbd)+_0x344874,_0x344874[_0x2ab37c(0x89)](),_0x2ab37c(0x83)+_0x19e865+_0x2ab37c(0x9c),_0x2ab37c(0x83)+_0x19e865+_0x2ab37c(0x9e)];logger_1[_0x2ab37c(0xe2)][_0x2ab37c(0x93)](_0x2ab37c(0xb4)+_0x27e82d[_0x2ab37c(0xca)](',\x20')),io['to'](_0x2ab37c(0x83)+_0x19e865+_0x2ab37c(0xe3))[_0x2ab37c(0xda)](_0x2ab37c(0x83)+_0x19e865+'-presence',{'ticketId':_0x344874,'presence':_0x211bd6,'timestamp':new Date()[_0x2ab37c(0x7f)]()}),logger_1['logger'][_0x2ab37c(0x93)]('Presence\x20event\x20'+_0x211bd6+_0x2ab37c(0x72)+_0x344874);try{const _0x1b37e5=io['sockets']['adapter']['rooms'][_0x2ab37c(0xf5)](_0x2ab37c(0x83)+_0x19e865+_0x2ab37c(0xe3)),_0x440261=io[_0x2ab37c(0xf9)][_0x2ab37c(0x79)][_0x2ab37c(0xef)][_0x2ab37c(0xf5)](_0x344874[_0x2ab37c(0x89)]());logger_1[_0x2ab37c(0xe2)][_0x2ab37c(0xe4)]('Socket\x20stats\x20-\x20Main\x20company\x20room:\x20'+(_0x1b37e5?_0x1b37e5[_0x2ab37c(0x8c)]:0x0)+'\x20clients,\x20'+(_0x2ab37c(0x82)+(_0x440261?_0x440261[_0x2ab37c(0x8c)]:0x0)+'\x20clients'));}catch(_0xeac659){logger_1['logger']['error'](_0x2ab37c(0x98)+_0xeac659[_0x2ab37c(0x84)]);}};exports[a297_0x3515fc(0x88)]=emitPresence;const getIO=()=>{const _0x48a119=a297_0x3515fc;if(!io)throw new AppError_1[(_0x48a119(0x94))](_0x48a119(0xc5));return io;};exports[a297_0x3515fc(0xa5)]=getIO;