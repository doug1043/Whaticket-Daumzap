const a353_0x432160=a353_0x37f2;(function(_0x5aa29d,_0x47a0f5){const _0x58fbca=a353_0x37f2,_0x3ecae6=_0x5aa29d();while(!![]){try{const _0x328e72=-parseInt(_0x58fbca(0xd0))/0x1+-parseInt(_0x58fbca(0xf3))/0x2+-parseInt(_0x58fbca(0xed))/0x3*(-parseInt(_0x58fbca(0xe4))/0x4)+parseInt(_0x58fbca(0xfa))/0x5*(-parseInt(_0x58fbca(0xc6))/0x6)+-parseInt(_0x58fbca(0xc3))/0x7+-parseInt(_0x58fbca(0xc0))/0x8*(parseInt(_0x58fbca(0xee))/0x9)+-parseInt(_0x58fbca(0xc9))/0xa*(-parseInt(_0x58fbca(0xdb))/0xb);if(_0x328e72===_0x47a0f5)break;else _0x3ecae6['push'](_0x3ecae6['shift']());}catch(_0x3d1952){_0x3ecae6['push'](_0x3ecae6['shift']());}}}(a353_0x5e63,0xae347));const a353_0x4f84ad=(function(){let _0x2abc28=!![];return function(_0x2101d0,_0xcfff64){const _0x25a978=_0x2abc28?function(){const _0x5c8369=a353_0x37f2;if(_0xcfff64){const _0x28bd91=_0xcfff64[_0x5c8369(0xcb)](_0x2101d0,arguments);return _0xcfff64=null,_0x28bd91;}}:function(){};return _0x2abc28=![],_0x25a978;};}()),a353_0x448376=a353_0x4f84ad(this,function(){const _0x34754d=a353_0x37f2;return a353_0x448376['toString']()[_0x34754d(0xf7)](_0x34754d(0xd1))[_0x34754d(0xcf)]()[_0x34754d(0xc1)](a353_0x448376)[_0x34754d(0xf7)]('(((.+)+)+)+$');});a353_0x448376();function a353_0x5e63(){const _0x5b763b=['chatModify','findAll','length','-ticket','9VFWYmb','153lncrcE','set','../models/Message','queueId','defineProperty','837230ubsXBv','map','DESC','createdAt','search','../libs/socket','filter','20WhGIiu','logger','contactId','Marking\x20','../libs/cache','54616elJxmB','constructor','debug','8815793WbswFp','message','slice','210222MtTLQX','emit','key','30VcstCc','status','apply','./GetTicketWbot','../utils/logger','companyId','toString','433116VQqWJh','(((.+)+)+)+$','update','__esModule','remoteJid','dataJson','updateUnread','Could\x20not\x20modify\x20chat.\x20Err:\x20','readMessages','\x20messages\x20of\x20ticket\x20','getIO','10214831yYblwo','company-','parse','default','\x20as\x20read','cacheLayer','catch','contacts:','Could\x20not\x20mark\x20messages\x20as\x20read.\x20Err:\x20','393356MozotU','__importDefault',':unreads','queue-','error'];a353_0x5e63=function(){return _0x5b763b;};return a353_0x5e63();}'use strict';function a353_0x37f2(_0xf0b92a,_0x546710){const _0x23336d=a353_0x5e63();return a353_0x37f2=function(_0x448376,_0x4f84ad){_0x448376=_0x448376-0xbe;let _0x5e6334=_0x23336d[_0x448376];return _0x5e6334;},a353_0x37f2(_0xf0b92a,_0x546710);}var __importDefault=this&&this[a353_0x432160(0xe5)]||function(_0x2818a2){const _0xd4f60b=a353_0x432160;return _0x2818a2&&_0x2818a2[_0xd4f60b(0xd3)]?_0x2818a2:{'default':_0x2818a2};};Object[a353_0x432160(0xf2)](exports,'__esModule',{'value':!![]});const cache_1=require(a353_0x432160(0xbf)),socket_1=require(a353_0x432160(0xf8)),Message_1=__importDefault(require(a353_0x432160(0xf0))),logger_1=require(a353_0x432160(0xcd)),GetTicketWbot_1=__importDefault(require(a353_0x432160(0xcc))),SetTicketMessagesAsRead=async _0x4edae9=>{const _0x3e21a9=a353_0x432160;await _0x4edae9[_0x3e21a9(0xd2)]({'unreadMessages':0x0},{'silent':!![]}),await cache_1[_0x3e21a9(0xe0)][_0x3e21a9(0xef)](_0x3e21a9(0xe2)+_0x4edae9[_0x3e21a9(0xfc)]+_0x3e21a9(0xe6),'0');let _0x4144ac;try{const _0x2fd2d2=await(0x0,GetTicketWbot_1['default'])(_0x4edae9),_0x13df2f=await Message_1['default'][_0x3e21a9(0xea)]({'attributes':['id',_0x3e21a9(0xce),_0x3e21a9(0xd5)],'where':{'ticketId':_0x4edae9['id'],'fromMe':![],'read':![]},'order':[[_0x3e21a9(0xf6),_0x3e21a9(0xf5)]]});if(_0x13df2f[_0x3e21a9(0xeb)]===0x0)return;_0x4144ac=_0x13df2f[0x0]?.[_0x3e21a9(0xce)];const _0xbbfe31=_0x13df2f[_0x3e21a9(0xf4)](_0x2490a5=>{const _0x57c923=_0x3e21a9,_0x11fbee=JSON[_0x57c923(0xdd)](_0x2490a5['dataJson']);return _0x11fbee[_0x57c923(0xc8)];})[_0x3e21a9(0xf9)](_0x4f87ab=>_0x4f87ab!==undefined);logger_1[_0x3e21a9(0xfb)][_0x3e21a9(0xc2)]({'messageKeys':_0xbbfe31,'ticketId':_0x4edae9['id']},_0x3e21a9(0xbe)+_0xbbfe31[_0x3e21a9(0xeb)]+_0x3e21a9(0xd9)+_0x4edae9['id']+_0x3e21a9(0xdf));const _0x4194ea=0xfa;for(let _0x1b3037=0x0;_0x1b3037<_0xbbfe31['length'];_0x1b3037+=_0x4194ea){const _0x9632d9=_0xbbfe31[_0x3e21a9(0xc5)](_0x1b3037,_0x1b3037+_0x4194ea);_0x2fd2d2[_0x3e21a9(0xd8)](_0x9632d9)['catch'](_0x512413=>{const _0x8feb6b=_0x3e21a9;logger_1[_0x8feb6b(0xfb)]['error']({'error':_0x512413},_0x8feb6b(0xe3)+_0x512413?.['message']);});}const _0x33534b=JSON[_0x3e21a9(0xdd)](_0x13df2f[0x0][_0x3e21a9(0xd5)]),_0x2ae953=_0x33534b?.['key'];_0x2ae953?.['remoteJid']&&!_0x2ae953['fromMe']&&_0x2fd2d2[_0x3e21a9(0xe9)]({'markRead':!![],'lastMessages':[_0x33534b]},_0x2ae953[_0x3e21a9(0xd4)])[_0x3e21a9(0xe1)](_0x56eabb=>{const _0x53ec21=_0x3e21a9;logger_1[_0x53ec21(0xfb)][_0x53ec21(0xe8)]({'error':_0x56eabb},_0x53ec21(0xd7)+_0x56eabb?.[_0x53ec21(0xc4)]);}),await Message_1[_0x3e21a9(0xde)]['update']({'read':!![]},{'where':{'ticketId':_0x4edae9['id'],'read':![]}});}catch(_0x357706){logger_1['logger'][_0x3e21a9(0xe8)]({'error':_0x357706},_0x3e21a9(0xe3)+_0x357706?.['message']);}const _0xa2181=(0x0,socket_1[_0x3e21a9(0xda)])();_0x4144ac&&_0xa2181['to'](_0x4edae9['id']['toString']())['to'](_0x3e21a9(0xdc)+_0x4144ac+'-'+_0x4edae9[_0x3e21a9(0xca)])['to'](_0x3e21a9(0xe7)+_0x4edae9[_0x3e21a9(0xf1)]+'-'+_0x4edae9[_0x3e21a9(0xca)])[_0x3e21a9(0xc7)](_0x3e21a9(0xdc)+_0x4144ac+_0x3e21a9(0xec),{'action':_0x3e21a9(0xd6),'ticketId':_0x4edae9['id']});};exports[a353_0x432160(0xde)]=SetTicketMessagesAsRead;