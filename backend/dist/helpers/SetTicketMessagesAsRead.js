const a252_0x142b15=a252_0x345f;(function(_0x489675,_0x1cb97a){const _0x59cd3b=a252_0x345f,_0x3d73c2=_0x489675();while(!![]){try{const _0xb0f294=-parseInt(_0x59cd3b(0x1e4))/0x1*(-parseInt(_0x59cd3b(0x1c8))/0x2)+-parseInt(_0x59cd3b(0x1da))/0x3*(parseInt(_0x59cd3b(0x1bd))/0x4)+-parseInt(_0x59cd3b(0x1c1))/0x5+-parseInt(_0x59cd3b(0x1c2))/0x6*(-parseInt(_0x59cd3b(0x1d2))/0x7)+parseInt(_0x59cd3b(0x1be))/0x8+-parseInt(_0x59cd3b(0x1e6))/0x9+parseInt(_0x59cd3b(0x1e5))/0xa;if(_0xb0f294===_0x1cb97a)break;else _0x3d73c2['push'](_0x3d73c2['shift']());}catch(_0xaa524b){_0x3d73c2['push'](_0x3d73c2['shift']());}}}(a252_0x57c7,0x80105));const a252_0x123194=(function(){let _0x39c224=!![];return function(_0x3ac651,_0x227953){const _0x403c39=_0x39c224?function(){const _0x2cb51b=a252_0x345f;if(_0x227953){const _0x180068=_0x227953[_0x2cb51b(0x1d3)](_0x3ac651,arguments);return _0x227953=null,_0x180068;}}:function(){};return _0x39c224=![],_0x403c39;};}()),a252_0x4c92a5=a252_0x123194(this,function(){const _0x410c8d=a252_0x345f;return a252_0x4c92a5[_0x410c8d(0x1ca)]()[_0x410c8d(0x1e1)](_0x410c8d(0x1c4))['toString']()[_0x410c8d(0x1ce)](a252_0x4c92a5)[_0x410c8d(0x1e1)](_0x410c8d(0x1c4));});a252_0x4c92a5();function a252_0x345f(_0xeca14b,_0x1b24e8){const _0x30533b=a252_0x57c7();return a252_0x345f=function(_0x4c92a5,_0x123194){_0x4c92a5=_0x4c92a5-0x1bb;let _0x57c75f=_0x30533b[_0x4c92a5];return _0x57c75f;},a252_0x345f(_0xeca14b,_0x1b24e8);}'use strict';var __importDefault=this&&this[a252_0x142b15(0x1ec)]||function(_0x137aba){const _0x19472e=a252_0x142b15;return _0x137aba&&_0x137aba[_0x19472e(0x1db)]?_0x137aba:{'default':_0x137aba};};Object[a252_0x142b15(0x1c0)](exports,a252_0x142b15(0x1db),{'value':!![]});const socket_1=require(a252_0x142b15(0x1dd)),Message_1=__importDefault(require(a252_0x142b15(0x1bf))),logger_1=require(a252_0x142b15(0x1d7)),GetTicketWbot_1=__importDefault(require(a252_0x142b15(0x1d6))),cache_1=require(a252_0x142b15(0x1e7)),SetTicketMessagesAsRead=async _0x27df5e=>{const _0x4147c0=a252_0x142b15;async function _0xd91fa5(_0x156810,_0x4ff1f2,_0x15159c,_0x41eb1f){const _0x2597de=a252_0x345f;await _0x156810['sendReceipt'](_0x4ff1f2,_0x15159c,[_0x41eb1f],_0x2597de(0x1e2));}await _0x27df5e[_0x4147c0(0x1cb)]({'unreadMessages':0x0});try{const _0x108109=await(0x0,GetTicketWbot_1['default'])(_0x27df5e),_0x4a70c2=await Message_1[_0x4147c0(0x1de)][_0x4147c0(0x1e3)]({'where':{'ticketId':_0x27df5e['id'],'fromMe':![],'read':![]},'order':[[_0x4147c0(0x1d4),'DESC']]});_0x4a70c2[_0x4147c0(0x1d5)](async _0x20b432=>{const _0x7baa43=_0x4147c0,_0x11bea3=JSON['parse'](_0x20b432[_0x7baa43(0x1eb)]);_0x11bea3[_0x7baa43(0x1dc)]&&await _0x108109[_0x7baa43(0x1d0)]([_0x11bea3['key']]);});if(_0x4a70c2['length']>0x0){const _0x2b4a30=JSON[_0x4147c0(0x1cf)](_0x4a70c2[0x0][_0x4147c0(0x1eb)]),_0x53d072=_0x27df5e[_0x4147c0(0x1c9)]?_0x27df5e[_0x4147c0(0x1e9)][_0x4147c0(0x1df)][_0x4147c0(0x1d1)](0xc,0x0)+'-'+_0x27df5e[_0x4147c0(0x1e9)]['number'][_0x4147c0(0x1d1)](0xc)+'@g.us':_0x27df5e['contact'][_0x4147c0(0x1df)]+_0x4147c0(0x1e0);_0x2b4a30['key']&&_0x2b4a30[_0x4147c0(0x1dc)][_0x4147c0(0x1e8)]===![]&&await _0x108109[_0x4147c0(0x1c5)]({'markRead':!![],'lastMessages':[_0x2b4a30]},_0x53d072);}await Message_1[_0x4147c0(0x1de)][_0x4147c0(0x1cb)]({'read':!![]},{'where':{'ticketId':_0x27df5e['id'],'read':![]}}),await cache_1['cacheLayer'][_0x4147c0(0x1c6)]('contacts:'+_0x27df5e[_0x4147c0(0x1ea)]+':unreads','0');}catch(_0x587065){logger_1[_0x4147c0(0x1bb)][_0x4147c0(0x1cc)](_0x4147c0(0x1cd)+_0x587065);}const _0x308ace=(0x0,socket_1[_0x4147c0(0x1c3)])();_0x308ace['to'](_0x4147c0(0x1ed)+_0x27df5e['companyId']+'-'+_0x27df5e[_0x4147c0(0x1c7)])['to']('company-'+_0x27df5e['companyId']+_0x4147c0(0x1bc))[_0x4147c0(0x1d8)]('company-'+_0x27df5e['companyId']+_0x4147c0(0x1d9),{'action':'updateUnread','ticketId':_0x27df5e['id']});};function a252_0x57c7(){const _0x51f56b=['../utils/logger','emit','-ticket','2127CAbwTq','__esModule','key','../libs/socket','default','number','@s.whatsapp.net','search','read','findAll','264021SpnOoZ','18948360bKFmbp','8047782gVLvdt','../libs/cache','fromMe','contact','contactId','dataJson','__importDefault','company-','logger','-notification','5188atRFHD','2914744KGddMN','../models/Message','defineProperty','4263995JCVAdO','4007514raNbQR','getIO','(((.+)+)+)+$','chatModify','set','status','2zTKGsh','isGroup','toString','update','warn','Could\x20not\x20mark\x20messages\x20as\x20read.\x20Maybe\x20whatsapp\x20session\x20disconnected?\x20Err:\x20','constructor','parse','readMessages','substring','7YeDPal','apply','createdAt','map','./GetTicketWbot'];a252_0x57c7=function(){return _0x51f56b;};return a252_0x57c7();}exports[a252_0x142b15(0x1de)]=SetTicketMessagesAsRead;