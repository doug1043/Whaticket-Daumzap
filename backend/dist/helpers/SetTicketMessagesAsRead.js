function a287_0x4313(){const _0x375053=['updateUnread','3501weivEz','message','toString','-ticket','6937VqFNDF','queueId','key','map','5547IVFbbU','filter','createdAt','default','defineProperty','../models/Message','length','status','error','../libs/socket','Could\x20not\x20modify\x20chat.\x20Err:\x20','update','856wczrQF','../utils/logger','chatModify','remoteJid','Marking\x20',':unreads','172188AfMMzp','company-','set','parse','dataJson','search','__esModule','Could\x20not\x20mark\x20messages\x20as\x20read.\x20Err:\x20','getIO','catch','debug','1626NdIvRZ','DESC','queue-','2809230IwxviT','\x20as\x20read','926244BSTYTr','companyId','124CiXrMx','1009855mEAyYi','emit','./GetTicketWbot','(((.+)+)+)+$','contactId','logger','../libs/cache'];a287_0x4313=function(){return _0x375053;};return a287_0x4313();}const a287_0x204e89=a287_0x33cc;(function(_0x493f86,_0x363cfb){const _0x101dd2=a287_0x33cc,_0x8968fa=_0x493f86();while(!![]){try{const _0x1ce630=parseInt(_0x101dd2(0xea))/0x1+-parseInt(_0x101dd2(0xfc))/0x2*(-parseInt(_0x101dd2(0x10d))/0x3)+-parseInt(_0x101dd2(0xfa))/0x4+parseInt(_0x101dd2(0xfd))/0x5+-parseInt(_0x101dd2(0xf5))/0x6*(parseInt(_0x101dd2(0x109))/0x7)+parseInt(_0x101dd2(0xe4))/0x8*(-parseInt(_0x101dd2(0x105))/0x9)+parseInt(_0x101dd2(0xf8))/0xa;if(_0x1ce630===_0x363cfb)break;else _0x8968fa['push'](_0x8968fa['shift']());}catch(_0x325cf3){_0x8968fa['push'](_0x8968fa['shift']());}}}(a287_0x4313,0x37a87));const a287_0x4ac20a=(function(){let _0x507e93=!![];return function(_0x3df7bc,_0x288cfb){const _0x5b6d06=_0x507e93?function(){if(_0x288cfb){const _0xf79b41=_0x288cfb['apply'](_0x3df7bc,arguments);return _0x288cfb=null,_0xf79b41;}}:function(){};return _0x507e93=![],_0x5b6d06;};}()),a287_0x334ee3=a287_0x4ac20a(this,function(){const _0x4dce4a=a287_0x33cc;return a287_0x334ee3[_0x4dce4a(0x107)]()[_0x4dce4a(0xef)]('(((.+)+)+)+$')[_0x4dce4a(0x107)]()['constructor'](a287_0x334ee3)[_0x4dce4a(0xef)](_0x4dce4a(0x100));});a287_0x334ee3();'use strict';var __importDefault=this&&this['__importDefault']||function(_0x4e3cd0){const _0x1f252c=a287_0x33cc;return _0x4e3cd0&&_0x4e3cd0[_0x1f252c(0xf0)]?_0x4e3cd0:{'default':_0x4e3cd0};};Object[a287_0x204e89(0x111)](exports,a287_0x204e89(0xf0),{'value':!![]});const cache_1=require(a287_0x204e89(0x103)),socket_1=require(a287_0x204e89(0xe1)),Message_1=__importDefault(require(a287_0x204e89(0x112))),logger_1=require(a287_0x204e89(0xe5)),GetTicketWbot_1=__importDefault(require(a287_0x204e89(0xff))),SetTicketMessagesAsRead=async _0x43707a=>{const _0x17fde8=a287_0x204e89;await _0x43707a[_0x17fde8(0xe3)]({'unreadMessages':0x0},{'silent':!![]}),await cache_1['cacheLayer'][_0x17fde8(0xec)]('contacts:'+_0x43707a[_0x17fde8(0x101)]+_0x17fde8(0xe9),'0');let _0x304b9e;try{const _0x3dbce8=await(0x0,GetTicketWbot_1[_0x17fde8(0x110)])(_0x43707a),_0x51f6e6=await Message_1[_0x17fde8(0x110)]['findAll']({'attributes':['id','companyId',_0x17fde8(0xee)],'where':{'ticketId':_0x43707a['id'],'fromMe':![],'read':![]},'order':[[_0x17fde8(0x10f),_0x17fde8(0xf6)]]});if(_0x51f6e6[_0x17fde8(0x113)]===0x0)return;_0x304b9e=_0x51f6e6[0x0]?.[_0x17fde8(0xfb)];const _0x11a792=_0x51f6e6[_0x17fde8(0x10c)](_0x4ae7c0=>{const _0x4c83b2=_0x17fde8,_0x196aa9=JSON['parse'](_0x4ae7c0[_0x4c83b2(0xee)]);return _0x196aa9[_0x4c83b2(0x10b)];})[_0x17fde8(0x10e)](_0x2615b4=>_0x2615b4!==undefined);logger_1[_0x17fde8(0x102)][_0x17fde8(0xf4)]({'messageKeys':_0x11a792,'ticketId':_0x43707a['id']},_0x17fde8(0xe8)+_0x11a792['length']+'\x20messages\x20of\x20ticket\x20'+_0x43707a['id']+_0x17fde8(0xf9));const _0x277374=0xfa;for(let _0x18e421=0x0;_0x18e421<_0x11a792[_0x17fde8(0x113)];_0x18e421+=_0x277374){const _0x4bf809=_0x11a792['slice'](_0x18e421,_0x18e421+_0x277374);_0x3dbce8['readMessages'](_0x4bf809)[_0x17fde8(0xf3)](_0x2b5328=>{const _0x388ea2=_0x17fde8;logger_1[_0x388ea2(0x102)][_0x388ea2(0x115)]({'error':_0x2b5328},_0x388ea2(0xf1)+_0x2b5328?.[_0x388ea2(0x106)]);});}const _0x123cb2=JSON[_0x17fde8(0xed)](_0x51f6e6[0x0][_0x17fde8(0xee)]);_0x123cb2?.[_0x17fde8(0x10b)]?.[_0x17fde8(0xe7)]&&!_0x123cb2['key']['fromMe']&&_0x3dbce8[_0x17fde8(0xe6)]({'markRead':!![],'lastMessages':[_0x123cb2]},_0x123cb2[_0x17fde8(0x10b)][_0x17fde8(0xe7)])['catch'](_0x5e2af0=>{const _0x37f366=_0x17fde8;logger_1[_0x37f366(0x102)][_0x37f366(0x115)]({'error':_0x5e2af0},_0x37f366(0xe2)+_0x5e2af0?.[_0x37f366(0x106)]);}),await Message_1[_0x17fde8(0x110)][_0x17fde8(0xe3)]({'read':!![]},{'where':{'ticketId':_0x43707a['id'],'read':![]}});}catch(_0x158784){logger_1[_0x17fde8(0x102)][_0x17fde8(0x115)]({'error':_0x158784},_0x17fde8(0xf1)+_0x158784?.[_0x17fde8(0x106)]);}const _0x4dccc5=(0x0,socket_1[_0x17fde8(0xf2)])();_0x304b9e&&_0x4dccc5['to'](_0x43707a['id'][_0x17fde8(0x107)]())['to'](_0x17fde8(0xeb)+_0x304b9e+'-'+_0x43707a[_0x17fde8(0x114)])['to'](_0x17fde8(0xf7)+_0x43707a[_0x17fde8(0x10a)]+'-'+_0x43707a['status'])[_0x17fde8(0xfe)](_0x17fde8(0xeb)+_0x304b9e+_0x17fde8(0x108),{'action':_0x17fde8(0x104),'ticketId':_0x43707a['id']});};function a287_0x33cc(_0x143bb2,_0x370235){const _0x5c4c89=a287_0x4313();return a287_0x33cc=function(_0x334ee3,_0x4ac20a){_0x334ee3=_0x334ee3-0xe1;let _0x431399=_0x5c4c89[_0x334ee3];return _0x431399;},a287_0x33cc(_0x143bb2,_0x370235);}exports[a287_0x204e89(0x110)]=SetTicketMessagesAsRead;