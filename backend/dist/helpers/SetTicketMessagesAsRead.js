const a249_0x436ddc=a249_0x3869;function a249_0x3869(_0x40eb83,_0x3a587e){const _0x10c440=a249_0x2538();return a249_0x3869=function(_0x545125,_0x5c26b9){_0x545125=_0x545125-0x172;let _0x253844=_0x10c440[_0x545125];return _0x253844;},a249_0x3869(_0x40eb83,_0x3a587e);}(function(_0x3a7be6,_0x28e90a){const _0x179a6d=a249_0x3869,_0x2f4021=_0x3a7be6();while(!![]){try{const _0x57911f=parseInt(_0x179a6d(0x1a0))/0x1+parseInt(_0x179a6d(0x17c))/0x2*(-parseInt(_0x179a6d(0x173))/0x3)+-parseInt(_0x179a6d(0x172))/0x4+-parseInt(_0x179a6d(0x1a7))/0x5+-parseInt(_0x179a6d(0x19d))/0x6*(parseInt(_0x179a6d(0x17a))/0x7)+-parseInt(_0x179a6d(0x18a))/0x8*(parseInt(_0x179a6d(0x19b))/0x9)+parseInt(_0x179a6d(0x185))/0xa*(parseInt(_0x179a6d(0x177))/0xb);if(_0x57911f===_0x28e90a)break;else _0x2f4021['push'](_0x2f4021['shift']());}catch(_0x3ae33b){_0x2f4021['push'](_0x2f4021['shift']());}}}(a249_0x2538,0xdd0d9));const a249_0x5c26b9=(function(){let _0xa382cc=!![];return function(_0x43ad05,_0x1117a2){const _0x2014b5=_0xa382cc?function(){const _0x146959=a249_0x3869;if(_0x1117a2){const _0x2de186=_0x1117a2[_0x146959(0x175)](_0x43ad05,arguments);return _0x1117a2=null,_0x2de186;}}:function(){};return _0xa382cc=![],_0x2014b5;};}()),a249_0x545125=a249_0x5c26b9(this,function(){const _0x2b522a=a249_0x3869;return a249_0x545125[_0x2b522a(0x181)]()[_0x2b522a(0x196)](_0x2b522a(0x178))[_0x2b522a(0x181)]()['constructor'](a249_0x545125)['search'](_0x2b522a(0x178));});a249_0x545125();'use strict';function a249_0x2538(){const _0x569316=['5141592nsKSOD','3dCtuxw','companyId','apply','cacheLayer','65773081rPJsdQ','(((.+)+)+)+$','../models/Message','308119hbDvBh',':unreads','1887806qSJyJz','dataJson','company-','contacts:','warn','toString','../libs/socket','findAll','createdAt','10UwTuRq','logger','contact','chatModify','DESC','10717528jQFASw','emit','isGroup','substring','set','key','../utils/logger','../libs/cache','update','length','@g.us','Could\x20not\x20mark\x20messages\x20as\x20read.\x20Maybe\x20whatsapp\x20session\x20disconnected?\x20Err:\x20','search','__importDefault','default','readMessages','parse','9eGCSNG','-ticket','210AwGJju','status','./GetTicketWbot','377169gHdWGK','fromMe','sendReceipt','map','getIO','defineProperty','number','1707600VBwpAf'];a249_0x2538=function(){return _0x569316;};return a249_0x2538();}var __importDefault=this&&this[a249_0x436ddc(0x197)]||function(_0x309371){return _0x309371&&_0x309371['__esModule']?_0x309371:{'default':_0x309371};};Object[a249_0x436ddc(0x1a5)](exports,'__esModule',{'value':!![]});const socket_1=require(a249_0x436ddc(0x182)),Message_1=__importDefault(require(a249_0x436ddc(0x179))),logger_1=require(a249_0x436ddc(0x190)),GetTicketWbot_1=__importDefault(require(a249_0x436ddc(0x19f))),cache_1=require(a249_0x436ddc(0x191)),SetTicketMessagesAsRead=async _0x39e282=>{const _0x4059c4=a249_0x436ddc;async function _0x3c03fe(_0x41fae5,_0x435d5d,_0x1d12ef,_0x7bb8a7){const _0x507c3d=a249_0x3869;await _0x41fae5[_0x507c3d(0x1a2)](_0x435d5d,_0x1d12ef,[_0x7bb8a7],'read');}await _0x39e282[_0x4059c4(0x192)]({'unreadMessages':0x0});try{const _0x2c77b9=await(0x0,GetTicketWbot_1[_0x4059c4(0x198)])(_0x39e282),_0xd88cc9=await Message_1[_0x4059c4(0x198)][_0x4059c4(0x183)]({'where':{'ticketId':_0x39e282['id'],'fromMe':![],'read':![]},'order':[[_0x4059c4(0x184),_0x4059c4(0x189)]]});_0xd88cc9[_0x4059c4(0x1a3)](async _0x589aec=>{const _0xda0b28=_0x4059c4,_0x4185fd=JSON['parse'](_0x589aec[_0xda0b28(0x17d)]);_0x4185fd['key']&&await _0x2c77b9[_0xda0b28(0x199)]([_0x4185fd[_0xda0b28(0x18f)]]);});if(_0xd88cc9[_0x4059c4(0x193)]>0x0){const _0x4cf541=JSON[_0x4059c4(0x19a)](_0xd88cc9[0x0][_0x4059c4(0x17d)]),_0x57649b=_0x39e282[_0x4059c4(0x18c)]?_0x39e282[_0x4059c4(0x187)][_0x4059c4(0x1a6)][_0x4059c4(0x18d)](0xc,0x0)+'-'+_0x39e282[_0x4059c4(0x187)][_0x4059c4(0x1a6)][_0x4059c4(0x18d)](0xc)+_0x4059c4(0x194):_0x39e282[_0x4059c4(0x187)][_0x4059c4(0x1a6)]+'@s.whatsapp.net';_0x4cf541[_0x4059c4(0x18f)]&&_0x4cf541['key'][_0x4059c4(0x1a1)]===![]&&await _0x2c77b9[_0x4059c4(0x188)]({'markRead':!![],'lastMessages':[_0x4cf541]},_0x57649b);}await Message_1[_0x4059c4(0x198)][_0x4059c4(0x192)]({'read':!![]},{'where':{'ticketId':_0x39e282['id'],'read':![]}}),await cache_1[_0x4059c4(0x176)][_0x4059c4(0x18e)](_0x4059c4(0x17f)+_0x39e282['contactId']+_0x4059c4(0x17b),'0');}catch(_0x2d2c00){logger_1[_0x4059c4(0x186)][_0x4059c4(0x180)](_0x4059c4(0x195)+_0x2d2c00);}const _0x4b6e5a=(0x0,socket_1[_0x4059c4(0x1a4)])();_0x4b6e5a['to'](_0x4059c4(0x17e)+_0x39e282[_0x4059c4(0x174)]+'-'+_0x39e282[_0x4059c4(0x19e)])['to']('company-'+_0x39e282['companyId']+'-notification')[_0x4059c4(0x18b)](_0x4059c4(0x17e)+_0x39e282[_0x4059c4(0x174)]+_0x4059c4(0x19c),{'action':'updateUnread','ticketId':_0x39e282['id']});};exports[a249_0x436ddc(0x198)]=SetTicketMessagesAsRead;