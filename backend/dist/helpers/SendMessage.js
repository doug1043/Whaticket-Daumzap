const a242_0x526692=a242_0x5bb5;function a242_0x5bb5(_0x1213cd,_0x42c7b1){const _0x3b6d87=a242_0x3dbd();return a242_0x5bb5=function(_0x2dbbae,_0x11df32){_0x2dbbae=_0x2dbbae-0x118;let _0x3dbdb4=_0x3b6d87[_0x2dbbae];return _0x3dbdb4;},a242_0x5bb5(_0x1213cd,_0x42c7b1);}(function(_0x579045,_0x1b5f26){const _0x48b47f=a242_0x5bb5,_0x5f3c92=_0x579045();while(!![]){try{const _0x7b4628=parseInt(_0x48b47f(0x125))/0x1*(parseInt(_0x48b47f(0x142))/0x2)+-parseInt(_0x48b47f(0x129))/0x3+parseInt(_0x48b47f(0x122))/0x4+-parseInt(_0x48b47f(0x13b))/0x5+parseInt(_0x48b47f(0x130))/0x6*(-parseInt(_0x48b47f(0x13e))/0x7)+-parseInt(_0x48b47f(0x136))/0x8*(-parseInt(_0x48b47f(0x140))/0x9)+parseInt(_0x48b47f(0x144))/0xa;if(_0x7b4628===_0x1b5f26)break;else _0x5f3c92['push'](_0x5f3c92['shift']());}catch(_0x332fd0){_0x5f3c92['push'](_0x5f3c92['shift']());}}}(a242_0x3dbd,0xefeda));const a242_0x11df32=(function(){let _0x347871=!![];return function(_0x56cb47,_0x109d00){const _0x5a151b=_0x347871?function(){if(_0x109d00){const _0x372799=_0x109d00['apply'](_0x56cb47,arguments);return _0x109d00=null,_0x372799;}}:function(){};return _0x347871=![],_0x5a151b;};}()),a242_0x2dbbae=a242_0x11df32(this,function(){const _0x2e9f33=a242_0x5bb5;return a242_0x2dbbae[_0x2e9f33(0x12c)]()['search'](_0x2e9f33(0x11c))[_0x2e9f33(0x12c)]()[_0x2e9f33(0x139)](a242_0x2dbbae)['search'](_0x2e9f33(0x11c));});a242_0x2dbbae();'use strict';var __importDefault=this&&this['__importDefault']||function(_0x722e9c){const _0x3fa00c=a242_0x5bb5;return _0x722e9c&&_0x722e9c[_0x3fa00c(0x135)]?_0x722e9c:{'default':_0x722e9c};};Object[a242_0x526692(0x137)](exports,a242_0x526692(0x135),{'value':!![]}),exports[a242_0x526692(0x120)]=void 0x0;const GetWhatsappWbot_1=__importDefault(require('./GetWhatsappWbot')),SendWhatsAppMedia_1=require(a242_0x526692(0x128)),CreateOrUpdateContactService_1=__importDefault(require(a242_0x526692(0x14c))),FindOrCreateTicketService_1=__importDefault(require('../services/TicketServices/FindOrCreateTicketService')),CheckNumber_1=__importDefault(require(a242_0x526692(0x143))),SetTicketMessagesAsRead_1=__importDefault(require(a242_0x526692(0x13a))),Mustache_1=__importDefault(require(a242_0x526692(0x11b))),wbotMessageListener_1=require(a242_0x526692(0x11f)),mime_1=__importDefault(require('mime')),CreateMessageService_1=__importDefault(require(a242_0x526692(0x127))),SendPresenceStatus_1=require(a242_0x526692(0x126)),SendMessage=async(_0x53dbc3,_0x1b7152)=>{const _0x29634a=a242_0x526692;try{const _0x57d973=await(0x0,GetWhatsappWbot_1[_0x29634a(0x121)])(_0x53dbc3),_0x11f334=_0x1b7152[_0x29634a(0x119)],_0xb6045f=_0x1b7152[_0x29634a(0x12e)],_0x2293f8=_0x53dbc3[_0x29634a(0x131)],_0x36e245=await(0x0,CheckNumber_1[_0x29634a(0x121)])(_0x11f334[_0x29634a(0x13c)](),_0x2293f8),_0x253635=_0x36e245[_0x29634a(0x145)][_0x29634a(0x14b)](/\D/g,''),_0x1024cc={'name':''+_0x253635,'number':_0x253635,'isGroup':![],'companyId':_0x2293f8},_0x4877a0=await(0x0,CreateOrUpdateContactService_1[_0x29634a(0x121)])(_0x1024cc,_0x57d973,_0x36e245[_0x29634a(0x145)]),_0x5642d8=await(0x0,FindOrCreateTicketService_1[_0x29634a(0x121)])(_0x4877a0,_0x53dbc3['id'],0x0,_0x2293f8),_0x206b4d=_0x5642d8['contact'][_0x29634a(0x119)]+'@'+(_0x5642d8[_0x29634a(0x12d)]?_0x29634a(0x124):_0x29634a(0x141));let _0x205d31;if(_0x1b7152[_0x29634a(0x134)]){const _0x34a3ec=await(0x0,SendWhatsAppMedia_1[_0x29634a(0x12a)])(_0x1b7152[_0x29634a(0x132)],_0x1b7152[_0x29634a(0x134)],_0x1b7152[_0x29634a(0x12e)],_0x2293f8);if(_0x34a3ec){await(0x0,SendPresenceStatus_1[_0x29634a(0x13d)])(_0x57d973,_0x206b4d,0x0,0x2710);let _0x4b380f=_0x205d31=await _0x57d973[_0x29634a(0x146)](_0x206b4d,{..._0x34a3ec});const _0x5e1437=mime_1[_0x29634a(0x121)][_0x29634a(0x148)](_0x1b7152['mediaPath']),_0x200107=await(0x0,wbotMessageListener_1[_0x29634a(0x12f)])(_0x4b380f),_0x3bb752={'id':_0x4b380f[_0x29634a(0x138)]['id'],'ticketId':_0x5642d8['id'],'contactId':_0x4b380f['key'][_0x29634a(0x14a)]?undefined:_0x4877a0['id'],'body':_0xb6045f?(0x0,Mustache_1['default'])(_0xb6045f,_0x5642d8):_0x1b7152[_0x29634a(0x132)],'fromMe':_0x4b380f[_0x29634a(0x138)][_0x29634a(0x14a)],'read':_0x4b380f[_0x29634a(0x138)][_0x29634a(0x14a)],'mediaUrl':_0x1b7152['finalName'],'mediaType':typeof _0x5e1437===_0x29634a(0x118)?_0x5e1437[_0x29634a(0x149)]('/')[0x0]:_0x29634a(0x123),'quotedMsgId':_0x200107?.['id'],'ack':0x0,'remoteJid':_0x4b380f[_0x29634a(0x138)][_0x29634a(0x11d)],'participant':_0x4b380f['key'][_0x29634a(0x147)],'dataJson':JSON[_0x29634a(0x133)](_0x4b380f)};typeof _0x3bb752[_0x29634a(0x12e)]!=_0x29634a(0x118)&&console['trace'](_0x29634a(0x11e),_0x3bb752[_0x29634a(0x12e)]),await _0x5642d8[_0x29634a(0x13f)]({'lastMessage':_0x3bb752['body']}),await(0x0,CreateMessageService_1['default'])({'messageData':_0x3bb752,'ticket':_0x5642d8,'companyId':_0x5642d8['companyId']});}}else{const _0x2070ac='â€Ž\x20'+_0x1b7152['body'];await(0x0,SendPresenceStatus_1[_0x29634a(0x13d)])(_0x57d973,_0x206b4d);const _0x1be535=await _0x57d973[_0x29634a(0x146)](_0x206b4d,{'text':(0x0,Mustache_1[_0x29634a(0x121)])(_0x2070ac,_0x5642d8)});await(0x0,wbotMessageListener_1[_0x29634a(0x12b)])(_0x1be535,_0x5642d8,_0x5642d8[_0x29634a(0x11a)]);}return typeof _0xb6045f!=_0x29634a(0x118)&&console['trace'](_0x29634a(0x11e),_0xb6045f),await _0x5642d8[_0x29634a(0x13f)]({'lastMessage':_0xb6045f}),(0x0,SetTicketMessagesAsRead_1['default'])(_0x5642d8),_0x205d31;}catch(_0x384997){throw new Error(_0x384997);}};exports[a242_0x526692(0x120)]=SendMessage;function a242_0x3dbd(){const _0x1904a9=['lookup','split','fromMe','replace','../services/ContactServices/CreateOrUpdateContactService','string','number','contact','../helpers/Mustache','(((.+)+)+)+$','remoteJid','body\x20is\x20not\x20a\x20string','../services/WbotServices/wbotMessageListener','SendMessage','default','4601328ZLgTOm','unknown','g.us','8024hNwbDL','./SendPresenceStatus','../services/MessageServices/CreateMessageService','../services/WbotServices/SendWhatsAppMedia','4877052QUHqEF','getMessageOptions','verifyMessage','toString','isGroup','body','verifyQuotedMessage','18iZgiRT','companyId','fileName','stringify','mediaPath','__esModule','40OGGpAx','defineProperty','key','constructor','../helpers/SetTicketMessagesAsRead','9538680OfQBDn','toLocaleString','SendPresenceStatus','2127475hvinZu','update','1338273vLcVsC','s.whatsapp.net','146vknbRd','../services/WbotServices/CheckNumber','29483720jqmYma','jid','sendMessage','participant'];a242_0x3dbd=function(){return _0x1904a9;};return a242_0x3dbd();}