const a246_0x45eebe=a246_0x2c9d;(function(_0x5c441,_0x4cb55c){const _0x4bf114=a246_0x2c9d,_0xde2004=_0x5c441();while(!![]){try{const _0x26bf1e=parseInt(_0x4bf114(0xc1))/0x1*(parseInt(_0x4bf114(0xad))/0x2)+parseInt(_0x4bf114(0xd6))/0x3+-parseInt(_0x4bf114(0xc8))/0x4+parseInt(_0x4bf114(0xe0))/0x5*(-parseInt(_0x4bf114(0xba))/0x6)+-parseInt(_0x4bf114(0xb0))/0x7+-parseInt(_0x4bf114(0xde))/0x8+parseInt(_0x4bf114(0xce))/0x9;if(_0x26bf1e===_0x4cb55c)break;else _0xde2004['push'](_0xde2004['shift']());}catch(_0x586e32){_0xde2004['push'](_0xde2004['shift']());}}}(a246_0x2cce,0x3d890));function a246_0x2cce(){const _0x29d0bf=['contact','941082PbxCNR','body','split','participant','sendMessage','update','default','verifyMessage','3251424wQceXs','SendMessage','110oLVAdt','fromMe','../services/WbotServices/wbotMessageListener','326324udcwsW','remoteJid','../helpers/Mustache','1093015xBFsHd','string','body\x20is\x20not\x20a\x20string','s.whatsapp.net','fileName','./SendPresenceStatus','unknown','number','mediaPath','trace','132072WavWHO','SendPresenceStatus','../services/ContactServices/CreateOrUpdateContactService','../services/WbotServices/SendWhatsAppMedia','companyId','(((.+)+)+)+$','../helpers/SetTicketMessagesAsRead','1yNayZI','getMessageOptions','./GetWhatsappWbot','mime','finalName','__esModule','toLocaleString','1672176fxUfZV','stringify','isGroup','constructor','../services/WbotServices/CheckNumber','toString','11160657nMVVbd','search','__importDefault','apply','key','defineProperty','jid'];a246_0x2cce=function(){return _0x29d0bf;};return a246_0x2cce();}function a246_0x2c9d(_0x57ed87,_0x435c33){const _0x286903=a246_0x2cce();return a246_0x2c9d=function(_0x4e2a53,_0x34a438){_0x4e2a53=_0x4e2a53-0xad;let _0x2cce49=_0x286903[_0x4e2a53];return _0x2cce49;},a246_0x2c9d(_0x57ed87,_0x435c33);}const a246_0x34a438=(function(){let _0x371ffb=!![];return function(_0x55b59e,_0x50def6){const _0xc1b26a=_0x371ffb?function(){const _0x55afd6=a246_0x2c9d;if(_0x50def6){const _0x16a127=_0x50def6[_0x55afd6(0xd1)](_0x55b59e,arguments);return _0x50def6=null,_0x16a127;}}:function(){};return _0x371ffb=![],_0xc1b26a;};}()),a246_0x4e2a53=a246_0x34a438(this,function(){const _0x5ee032=a246_0x2c9d;return a246_0x4e2a53[_0x5ee032(0xcd)]()[_0x5ee032(0xcf)]('(((.+)+)+)+$')['toString']()[_0x5ee032(0xcb)](a246_0x4e2a53)[_0x5ee032(0xcf)](_0x5ee032(0xbf));});a246_0x4e2a53();'use strict';var __importDefault=this&&this[a246_0x45eebe(0xd0)]||function(_0x399b7e){const _0x35c18e=a246_0x45eebe;return _0x399b7e&&_0x399b7e[_0x35c18e(0xc6)]?_0x399b7e:{'default':_0x399b7e};};Object[a246_0x45eebe(0xd3)](exports,a246_0x45eebe(0xc6),{'value':!![]}),exports[a246_0x45eebe(0xdf)]=void 0x0;const GetWhatsappWbot_1=__importDefault(require(a246_0x45eebe(0xc3))),SendWhatsAppMedia_1=require(a246_0x45eebe(0xbd)),CreateOrUpdateContactService_1=__importDefault(require(a246_0x45eebe(0xbc))),FindOrCreateTicketService_1=__importDefault(require('../services/TicketServices/FindOrCreateTicketService')),CheckNumber_1=__importDefault(require(a246_0x45eebe(0xcc))),SetTicketMessagesAsRead_1=__importDefault(require(a246_0x45eebe(0xc0))),Mustache_1=__importDefault(require(a246_0x45eebe(0xaf))),wbotMessageListener_1=require(a246_0x45eebe(0xe2)),mime_1=__importDefault(require(a246_0x45eebe(0xc4))),CreateMessageService_1=__importDefault(require('../services/MessageServices/CreateMessageService')),SendPresenceStatus_1=require(a246_0x45eebe(0xb5)),SendMessage=async(_0x29ca54,_0x1d12ba)=>{const _0x3a24da=a246_0x45eebe;try{const _0x146962=await(0x0,GetWhatsappWbot_1[_0x3a24da(0xdc)])(_0x29ca54),_0x42c411=_0x1d12ba[_0x3a24da(0xb7)],_0x33d232=_0x1d12ba[_0x3a24da(0xd7)],_0x55318b=_0x29ca54['companyId'],_0x2277a0=await(0x0,CheckNumber_1[_0x3a24da(0xdc)])(_0x42c411[_0x3a24da(0xc7)](),_0x55318b),_0x2910f5=_0x2277a0[_0x3a24da(0xd4)]['replace'](/\D/g,''),_0x2e8fbc={'name':''+_0x2910f5,'number':_0x2910f5,'isGroup':![],'companyId':_0x55318b},_0x5dfe95=await(0x0,CreateOrUpdateContactService_1[_0x3a24da(0xdc)])(_0x2e8fbc,_0x146962,_0x2277a0[_0x3a24da(0xd4)]),_0x161fc1=await(0x0,FindOrCreateTicketService_1[_0x3a24da(0xdc)])(_0x5dfe95,_0x29ca54['id'],0x0,_0x55318b),_0x29aacd=_0x161fc1['contact'][_0x3a24da(0xb7)]+'@'+(_0x161fc1[_0x3a24da(0xca)]?'g.us':_0x3a24da(0xb3));let _0x57a5f0;if(_0x1d12ba[_0x3a24da(0xb8)]){const _0x27dfbe=await(0x0,SendWhatsAppMedia_1[_0x3a24da(0xc2)])(_0x1d12ba[_0x3a24da(0xb4)],_0x1d12ba[_0x3a24da(0xb8)],_0x1d12ba[_0x3a24da(0xd7)],_0x55318b);if(_0x27dfbe){await(0x0,SendPresenceStatus_1[_0x3a24da(0xbb)])(_0x146962,_0x29aacd,0x0,0x2710);let _0xa17e02=_0x57a5f0=await _0x146962[_0x3a24da(0xda)](_0x29aacd,{..._0x27dfbe});const _0x2f4180=mime_1[_0x3a24da(0xdc)]['lookup'](_0x1d12ba[_0x3a24da(0xb8)]),_0x3590e3=await(0x0,wbotMessageListener_1['verifyQuotedMessage'])(_0xa17e02),_0x2bb0f6={'id':_0xa17e02[_0x3a24da(0xd2)]['id'],'ticketId':_0x161fc1['id'],'contactId':_0xa17e02[_0x3a24da(0xd2)][_0x3a24da(0xe1)]?undefined:_0x5dfe95['id'],'body':_0x33d232?(0x0,Mustache_1[_0x3a24da(0xdc)])(_0x33d232,_0x161fc1):_0x1d12ba[_0x3a24da(0xb4)],'fromMe':_0xa17e02[_0x3a24da(0xd2)]['fromMe'],'read':_0xa17e02[_0x3a24da(0xd2)][_0x3a24da(0xe1)],'mediaUrl':_0x1d12ba[_0x3a24da(0xc5)],'mediaType':typeof _0x2f4180==='string'?_0x2f4180[_0x3a24da(0xd8)]('/')[0x0]:_0x3a24da(0xb6),'quotedMsgId':_0x3590e3?.['id'],'ack':0x0,'remoteJid':_0xa17e02[_0x3a24da(0xd2)][_0x3a24da(0xae)],'participant':_0xa17e02[_0x3a24da(0xd2)][_0x3a24da(0xd9)],'dataJson':JSON[_0x3a24da(0xc9)](_0xa17e02)};typeof _0x2bb0f6[_0x3a24da(0xd7)]!=_0x3a24da(0xb1)&&console[_0x3a24da(0xb9)](_0x3a24da(0xb2),_0x2bb0f6[_0x3a24da(0xd7)]),await _0x161fc1[_0x3a24da(0xdb)]({'lastMessage':_0x2bb0f6[_0x3a24da(0xd7)]}),await(0x0,CreateMessageService_1[_0x3a24da(0xdc)])({'messageData':_0x2bb0f6,'ticket':_0x161fc1,'companyId':_0x161fc1[_0x3a24da(0xbe)]});}}else{const _0x15bc97='â€Ž\x20'+_0x1d12ba[_0x3a24da(0xd7)];await(0x0,SendPresenceStatus_1[_0x3a24da(0xbb)])(_0x146962,_0x29aacd);const _0x2584b5=await _0x146962[_0x3a24da(0xda)](_0x29aacd,{'text':(0x0,Mustache_1[_0x3a24da(0xdc)])(_0x15bc97,_0x161fc1)});await(0x0,wbotMessageListener_1[_0x3a24da(0xdd)])(_0x2584b5,_0x161fc1,_0x161fc1[_0x3a24da(0xd5)]);}return typeof _0x33d232!=_0x3a24da(0xb1)&&console[_0x3a24da(0xb9)](_0x3a24da(0xb2),_0x33d232),await _0x161fc1['update']({'lastMessage':_0x33d232}),(0x0,SetTicketMessagesAsRead_1[_0x3a24da(0xdc)])(_0x161fc1),_0x57a5f0;}catch(_0x4809bf){throw new Error(_0x4809bf);}};exports[a246_0x45eebe(0xdf)]=SendMessage;