const a245_0x24921c=a245_0x5271;(function(_0x20fee6,_0x30010e){const _0x2da8bb=a245_0x5271,_0x50d00a=_0x20fee6();while(!![]){try{const _0x138e66=parseInt(_0x2da8bb(0x96))/0x1+parseInt(_0x2da8bb(0x7d))/0x2*(parseInt(_0x2da8bb(0x81))/0x3)+parseInt(_0x2da8bb(0x98))/0x4*(parseInt(_0x2da8bb(0x7b))/0x5)+parseInt(_0x2da8bb(0x85))/0x6*(-parseInt(_0x2da8bb(0x88))/0x7)+-parseInt(_0x2da8bb(0x80))/0x8+parseInt(_0x2da8bb(0xa5))/0x9*(parseInt(_0x2da8bb(0x84))/0xa)+-parseInt(_0x2da8bb(0x76))/0xb;if(_0x138e66===_0x30010e)break;else _0x50d00a['push'](_0x50d00a['shift']());}catch(_0x168230){_0x50d00a['push'](_0x50d00a['shift']());}}}(a245_0x32bd,0x67545));const a245_0x1da116=(function(){let _0x3441dc=!![];return function(_0x4a51ab,_0x164498){const _0x1bb849=_0x3441dc?function(){const _0x1a083d=a245_0x5271;if(_0x164498){const _0x6fc1df=_0x164498[_0x1a083d(0x9a)](_0x4a51ab,arguments);return _0x164498=null,_0x6fc1df;}}:function(){};return _0x3441dc=![],_0x1bb849;};}()),a245_0x19d3ac=a245_0x1da116(this,function(){const _0x23a8b0=a245_0x5271;return a245_0x19d3ac[_0x23a8b0(0x9b)]()[_0x23a8b0(0x97)](_0x23a8b0(0x79))[_0x23a8b0(0x9b)]()[_0x23a8b0(0x99)](a245_0x19d3ac)[_0x23a8b0(0x97)](_0x23a8b0(0x79));});function a245_0x32bd(){const _0x1626b8=['(((.+)+)+)+$','./GetWhatsappWbot','79300nYxnCJ','__importDefault','7162UAKVqw','../helpers/Mustache','../services/WbotServices/CheckNumber','3390856McvWJr','561hNrXGJ','body\x20is\x20not\x20a\x20string','string','80efObJy','2227746rWlFda','__esModule','lookup','7Zafpow','update','s.whatsapp.net','sendMessage','trace','unknown','SendMessage','contact','../services/MessageServices/CreateMessageService','isGroup','body','getMessageOptions','mediaPath','number','510973KbLVAe','search','92IHBYPQ','constructor','apply','toString','verifyQuotedMessage','stringify','key','fileName','verifyMessage','companyId','fromMe','../services/WbotServices/SendWhatsAppMedia','finalName','604566EvmRIO','remoteJid','default','split','g.us','9508477PGWRzs','replace','jid'];a245_0x32bd=function(){return _0x1626b8;};return a245_0x32bd();}a245_0x19d3ac();function a245_0x5271(_0x1db36e,_0x458886){const _0x148602=a245_0x32bd();return a245_0x5271=function(_0x19d3ac,_0x1da116){_0x19d3ac=_0x19d3ac-0x76;let _0x32bd02=_0x148602[_0x19d3ac];return _0x32bd02;},a245_0x5271(_0x1db36e,_0x458886);}'use strict';var __importDefault=this&&this[a245_0x24921c(0x7c)]||function(_0x14b959){const _0x593189=a245_0x24921c;return _0x14b959&&_0x14b959[_0x593189(0x86)]?_0x14b959:{'default':_0x14b959};};Object['defineProperty'](exports,a245_0x24921c(0x86),{'value':!![]}),exports[a245_0x24921c(0x8e)]=void 0x0;const GetWhatsappWbot_1=__importDefault(require(a245_0x24921c(0x7a))),SendWhatsAppMedia_1=require(a245_0x24921c(0xa3)),CreateOrUpdateContactService_1=__importDefault(require('../services/ContactServices/CreateOrUpdateContactService')),FindOrCreateTicketService_1=__importDefault(require('../services/TicketServices/FindOrCreateTicketService')),CheckNumber_1=__importDefault(require(a245_0x24921c(0x7f))),SetTicketMessagesAsRead_1=__importDefault(require('../helpers/SetTicketMessagesAsRead')),Mustache_1=__importDefault(require(a245_0x24921c(0x7e))),wbotMessageListener_1=require('../services/WbotServices/wbotMessageListener'),mime_1=__importDefault(require('mime')),CreateMessageService_1=__importDefault(require(a245_0x24921c(0x90))),SendPresenceStatus_1=require('./SendPresenceStatus'),SendMessage=async(_0x220133,_0x27d105)=>{const _0x41c49e=a245_0x24921c;try{const _0x313b51=await(0x0,GetWhatsappWbot_1[_0x41c49e(0xa7)])(_0x220133),_0x2c6e89=_0x27d105[_0x41c49e(0x95)],_0x24477b=_0x27d105[_0x41c49e(0x92)],_0x3607b6=_0x220133['companyId'],_0x270100=await(0x0,CheckNumber_1[_0x41c49e(0xa7)])(_0x2c6e89['toLocaleString'](),_0x3607b6),_0x4949bb=_0x270100[_0x41c49e(0x78)][_0x41c49e(0x77)](/\D/g,''),_0x482b57={'name':''+_0x4949bb,'number':_0x4949bb,'isGroup':![],'companyId':_0x3607b6},_0x329e28=await(0x0,CreateOrUpdateContactService_1['default'])(_0x482b57,_0x313b51,_0x270100[_0x41c49e(0x78)]),_0x29dc37=await(0x0,FindOrCreateTicketService_1[_0x41c49e(0xa7)])(_0x329e28,_0x220133['id'],0x0,_0x3607b6),_0x2d8c2b=_0x29dc37[_0x41c49e(0x8f)]['number']+'@'+(_0x29dc37[_0x41c49e(0x91)]?_0x41c49e(0xa9):_0x41c49e(0x8a));let _0x5033b9;if(_0x27d105[_0x41c49e(0x94)]){const _0xfdb724=await(0x0,SendWhatsAppMedia_1[_0x41c49e(0x93)])(_0x27d105[_0x41c49e(0x9f)],_0x27d105[_0x41c49e(0x94)],_0x27d105[_0x41c49e(0x92)],_0x3607b6);if(_0xfdb724){await(0x0,SendPresenceStatus_1['SendPresenceStatus'])(_0x313b51,_0x2d8c2b,0x0,0x2710);let _0x54bd9c=_0x5033b9=await _0x313b51[_0x41c49e(0x8b)](_0x2d8c2b,{..._0xfdb724});const _0x16f462=mime_1[_0x41c49e(0xa7)][_0x41c49e(0x87)](_0x27d105[_0x41c49e(0x94)]),_0x1908e1=await(0x0,wbotMessageListener_1[_0x41c49e(0x9c)])(_0x54bd9c),_0x400027={'id':_0x54bd9c[_0x41c49e(0x9e)]['id'],'ticketId':_0x29dc37['id'],'contactId':_0x54bd9c[_0x41c49e(0x9e)][_0x41c49e(0xa2)]?undefined:_0x329e28['id'],'body':_0x24477b?(0x0,Mustache_1['default'])(_0x24477b,_0x29dc37):_0x27d105[_0x41c49e(0x9f)],'fromMe':_0x54bd9c[_0x41c49e(0x9e)][_0x41c49e(0xa2)],'read':_0x54bd9c[_0x41c49e(0x9e)][_0x41c49e(0xa2)],'mediaUrl':_0x27d105[_0x41c49e(0xa4)],'mediaType':typeof _0x16f462===_0x41c49e(0x83)?_0x16f462[_0x41c49e(0xa8)]('/')[0x0]:_0x41c49e(0x8d),'quotedMsgId':_0x1908e1?.['id'],'ack':0x0,'remoteJid':_0x54bd9c[_0x41c49e(0x9e)][_0x41c49e(0xa6)],'participant':_0x54bd9c['key']['participant'],'dataJson':JSON[_0x41c49e(0x9d)](_0x54bd9c)};typeof _0x400027[_0x41c49e(0x92)]!=_0x41c49e(0x83)&&console[_0x41c49e(0x8c)](_0x41c49e(0x82),_0x400027[_0x41c49e(0x92)]),await _0x29dc37[_0x41c49e(0x89)]({'lastMessage':_0x400027[_0x41c49e(0x92)]}),await(0x0,CreateMessageService_1[_0x41c49e(0xa7)])({'messageData':_0x400027,'ticket':_0x29dc37,'companyId':_0x29dc37[_0x41c49e(0xa1)]});}}else{const _0x4cf7af='â€Ž\x20'+_0x27d105['body'];await(0x0,SendPresenceStatus_1['SendPresenceStatus'])(_0x313b51,_0x2d8c2b);const _0x5f2bf5=await _0x313b51['sendMessage'](_0x2d8c2b,{'text':(0x0,Mustache_1[_0x41c49e(0xa7)])(_0x4cf7af,_0x29dc37)});await(0x0,wbotMessageListener_1[_0x41c49e(0xa0)])(_0x5f2bf5,_0x29dc37,_0x29dc37[_0x41c49e(0x8f)]);}return typeof _0x24477b!=_0x41c49e(0x83)&&console[_0x41c49e(0x8c)](_0x41c49e(0x82),_0x24477b),await _0x29dc37[_0x41c49e(0x89)]({'lastMessage':_0x24477b}),(0x0,SetTicketMessagesAsRead_1[_0x41c49e(0xa7)])(_0x29dc37),_0x5033b9;}catch(_0x40b5f7){throw new Error(_0x40b5f7);}};exports['SendMessage']=SendMessage;