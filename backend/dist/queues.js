'use strict';const a346_0x4b1108=a346_0x2427;(function(_0x262520,_0x7bef9a){const _0x5f3db7=a346_0x2427,_0x4aa835=_0x262520();while(!![]){try{const _0x44acd0=parseInt(_0x5f3db7(0x208))/0x1*(parseInt(_0x5f3db7(0x1ab))/0x2)+parseInt(_0x5f3db7(0x1e7))/0x3+-parseInt(_0x5f3db7(0x1eb))/0x4+parseInt(_0x5f3db7(0x216))/0x5*(parseInt(_0x5f3db7(0x1ce))/0x6)+-parseInt(_0x5f3db7(0x18f))/0x7+-parseInt(_0x5f3db7(0x1f6))/0x8+parseInt(_0x5f3db7(0x1f7))/0x9*(parseInt(_0x5f3db7(0x1e2))/0xa);if(_0x44acd0===_0x7bef9a)break;else _0x4aa835['push'](_0x4aa835['shift']());}catch(_0x171492){_0x4aa835['push'](_0x4aa835['shift']());}}}(a346_0x5eaa,0xafcc9));var __createBinding=this&&this[a346_0x4b1108(0x1a6)]||(Object[a346_0x4b1108(0x21a)]?function(_0x277e61,_0x47d4a3,_0x4f4ece,_0x2e29a0){const _0x137527=a346_0x4b1108;if(_0x2e29a0===undefined)_0x2e29a0=_0x4f4ece;var _0x495901=Object['getOwnPropertyDescriptor'](_0x47d4a3,_0x4f4ece);(!_0x495901||(_0x137527(0x1b1)in _0x495901?!_0x47d4a3['__esModule']:_0x495901[_0x137527(0x238)]||_0x495901[_0x137527(0x1fe)]))&&(_0x495901={'enumerable':!![],'get':function(){return _0x47d4a3[_0x4f4ece];}}),Object[_0x137527(0x23e)](_0x277e61,_0x2e29a0,_0x495901);}:function(_0x298660,_0x4a5fcf,_0x55cc34,_0x40a0d1){if(_0x40a0d1===undefined)_0x40a0d1=_0x55cc34;_0x298660[_0x40a0d1]=_0x4a5fcf[_0x55cc34];}),__setModuleDefault=this&&this[a346_0x4b1108(0x1bf)]||(Object[a346_0x4b1108(0x21a)]?function(_0x34f020,_0x46f6c1){const _0x27f737=a346_0x4b1108;Object['defineProperty'](_0x34f020,_0x27f737(0x1c0),{'enumerable':!![],'value':_0x46f6c1});}:function(_0x58e209,_0x39fc58){_0x58e209['default']=_0x39fc58;}),__importStar=this&&this[a346_0x4b1108(0x1e9)]||(function(){const _0x314a20=(function(){let _0x1164f2=!![];return function(_0x4c55c2,_0x593016){const _0x60a799=_0x1164f2?function(){if(_0x593016){const _0x39e9a0=_0x593016['apply'](_0x4c55c2,arguments);return _0x593016=null,_0x39e9a0;}}:function(){};return _0x1164f2=![],_0x60a799;};}()),_0x3e864c=_0x314a20(this,function(){const _0x10f563=a346_0x2427;return _0x3e864c[_0x10f563(0x214)]()['search'](_0x10f563(0x215))[_0x10f563(0x214)]()['constructor'](_0x3e864c)[_0x10f563(0x1c6)](_0x10f563(0x215));});_0x3e864c();var _0xf1521c=function(_0x2cdaeb){const _0x46aa1e=a346_0x2427;return _0xf1521c=Object[_0x46aa1e(0x1e0)]||function(_0xca9b62){const _0x16a569=_0x46aa1e;var _0x48a4e9=[];for(var _0x151573 in _0xca9b62)if(Object[_0x16a569(0x21d)]['hasOwnProperty'][_0x16a569(0x201)](_0xca9b62,_0x151573))_0x48a4e9[_0x48a4e9['length']]=_0x151573;return _0x48a4e9;},_0xf1521c(_0x2cdaeb);};return function(_0x3e2a00){const _0x211ada=a346_0x2427;if(_0x3e2a00&&_0x3e2a00[_0x211ada(0x19e)])return _0x3e2a00;var _0x906ce9={};if(_0x3e2a00!=null){for(var _0x9f143=_0xf1521c(_0x3e2a00),_0xdd633d=0x0;_0xdd633d<_0x9f143[_0x211ada(0x228)];_0xdd633d++)if(_0x9f143[_0xdd633d]!==_0x211ada(0x1c0))__createBinding(_0x906ce9,_0x3e2a00,_0x9f143[_0xdd633d]);}return __setModuleDefault(_0x906ce9,_0x3e2a00),_0x906ce9;};}()),__importDefault=this&&this[a346_0x4b1108(0x1e1)]||function(_0x5f116b){const _0x32c659=a346_0x4b1108;return _0x5f116b&&_0x5f116b[_0x32c659(0x19e)]?_0x5f116b:{'default':_0x5f116b};};Object['defineProperty'](exports,'__esModule',{'value':!![]}),exports[a346_0x4b1108(0x190)]=exports[a346_0x4b1108(0x19d)]=exports[a346_0x4b1108(0x230)]=exports[a346_0x4b1108(0x1fd)]=exports[a346_0x4b1108(0x227)]=exports['scheduleMonitor']=exports['messageQueue']=exports[a346_0x4b1108(0x23a)]=void 0x0,exports[a346_0x4b1108(0x233)]=handleWhatsappAutoRestart,exports[a346_0x4b1108(0x237)]=parseToMilliseconds,exports[a346_0x4b1108(0x1a4)]=sleep,exports[a346_0x4b1108(0x1d1)]=randomValue,exports[a346_0x4b1108(0x23d)]=startQueueProcess;const Sentry=__importStar(require(a346_0x4b1108(0x1d6))),bull_1=__importDefault(require(a346_0x4b1108(0x173))),moment_1=__importDefault(require('moment')),sequelize_1=require(a346_0x4b1108(0x196)),lodash_1=require(a346_0x4b1108(0x242)),path_1=__importDefault(require(a346_0x4b1108(0x1ea))),cron_1=require(a346_0x4b1108(0x1f9)),SendMessage_1=require(a346_0x4b1108(0x1db)),Whatsapp_1=__importDefault(require('./models/Whatsapp')),logger_1=require(a346_0x4b1108(0x220)),Schedule_1=__importDefault(require(a346_0x4b1108(0x1b7))),Contact_1=__importDefault(require(a346_0x4b1108(0x19c))),GetDefaultWhatsApp_1=__importDefault(require(a346_0x4b1108(0x1c4))),Campaign_1=__importDefault(require(a346_0x4b1108(0x1ae))),ContactList_1=__importDefault(require('./models/ContactList')),ContactListItem_1=__importDefault(require('./models/ContactListItem')),CampaignSetting_1=__importDefault(require(a346_0x4b1108(0x1e3))),CampaignShipping_1=__importDefault(require('./models/CampaignShipping')),GetWhatsappWbot_1=__importDefault(require(a346_0x4b1108(0x1d3))),database_1=__importDefault(require(a346_0x4b1108(0x17a))),SendWhatsAppMedia_1=require(a346_0x4b1108(0x20a)),socket_1=require(a346_0x4b1108(0x24a)),User_1=__importDefault(require('./models/User')),Company_1=__importDefault(require(a346_0x4b1108(0x1a0))),Plan_1=__importDefault(require('./models/Plan')),wbotMessageListener_1=require(a346_0x4b1108(0x17d)),ShowService_1=__importDefault(require(a346_0x4b1108(0x1d2))),Ticket_1=__importDefault(require('./models/Ticket')),SendWhatsAppMessage_1=__importDefault(require(a346_0x4b1108(0x1bc))),wbot_1=require('./libs/wbot'),StartWhatsAppSession_1=require(a346_0x4b1108(0x16a)),connection=process['env'][a346_0x4b1108(0x171)]||'',limiterMax=process[a346_0x4b1108(0x1ba)][a346_0x4b1108(0x18c)]||0x1,limiterDuration=process[a346_0x4b1108(0x1ba)]['REDIS_OPT_LIMITER_DURATION']||0xbb8;exports[a346_0x4b1108(0x23a)]=new bull_1['default'](a346_0x4b1108(0x24f),connection),exports[a346_0x4b1108(0x24b)]=new bull_1[(a346_0x4b1108(0x1c0))](a346_0x4b1108(0x203),connection,{'limiter':{'max':limiterMax,'duration':limiterDuration}}),exports[a346_0x4b1108(0x21c)]=new bull_1['default']('ScheduleMonitor',connection),exports[a346_0x4b1108(0x227)]=new bull_1['default'](a346_0x4b1108(0x1f3),connection),exports[a346_0x4b1108(0x1fd)]=new bull_1[(a346_0x4b1108(0x1c0))](a346_0x4b1108(0x210),connection);function a346_0x2427(_0x2d8f9c,_0x22457c){const _0x603664=a346_0x5eaa();return a346_0x2427=function(_0x365f9e,_0x1a530c){_0x365f9e=_0x365f9e-0x167;let _0x5eaa3d=_0x603664[_0x365f9e];return _0x5eaa3d;},a346_0x2427(_0x2d8f9c,_0x22457c);}async function handleWhatsappAutoRestart(){const _0x3de74a=a346_0x4b1108;try{const _0x29c8f=await Whatsapp_1[_0x3de74a(0x1c0)][_0x3de74a(0x1aa)]({'where':{'automaticRestart':!![],'status':_0x3de74a(0x1c5)}}),_0x4f202f=new Date();for(const _0xa58703 of _0x29c8f){const _0x24cbde=_0xa58703[_0x3de74a(0x178)]||_0xa58703[_0x3de74a(0x168)]||_0xa58703[_0x3de74a(0x1b0)];shouldRestart(_0x4f202f,_0x24cbde,_0xa58703[_0x3de74a(0x23c)])&&(logger_1[_0x3de74a(0x177)][_0x3de74a(0x192)](_0x3de74a(0x225)+_0xa58703[_0x3de74a(0x184)]+'\x20(ID:\x20'+_0xa58703['id']+')\x20de\x20acordo\x20com\x20o\x20período\x20('+_0xa58703['period']+')'),await(0x0,wbot_1[_0x3de74a(0x172)])(_0xa58703['id'],![]),await new Promise(_0x1d6463=>setTimeout(_0x1d6463,0xbb8)),await(0x0,StartWhatsAppSession_1[_0x3de74a(0x1bb)])(_0xa58703,_0xa58703[_0x3de74a(0x241)]),await _0xa58703['update']({'lastRestartAt':new Date()}));}}catch(_0x4b97ac){logger_1['logger'][_0x3de74a(0x1ef)]('Erro\x20ao\x20reiniciar\x20conexões\x20WhatsApp\x20periodicamente:\x20'+_0x4b97ac[_0x3de74a(0x1f5)]);}}exports[a346_0x4b1108(0x230)]=new bull_1[(a346_0x4b1108(0x1c0))](a346_0x4b1108(0x1c3),connection),exports[a346_0x4b1108(0x19d)]=new bull_1['default']('WhatsappRestartQueue',connection);function shouldRestart(_0x3b19ac,_0x45c8b2,_0x406be4){const _0x5478af=a346_0x4b1108;if(_0x406be4==='diariamente')return(0x0,moment_1[_0x5478af(0x1c0)])(_0x3b19ac)[_0x5478af(0x191)]((0x0,moment_1[_0x5478af(0x1c0)])(_0x45c8b2),_0x5478af(0x246))>=0x1;if(_0x406be4===_0x5478af(0x16b))return(0x0,moment_1[_0x5478af(0x1c0)])(_0x3b19ac)[_0x5478af(0x191)]((0x0,moment_1['default'])(_0x45c8b2),_0x5478af(0x22b))>=0x1;if(_0x406be4==='mensalmente')return(0x0,moment_1[_0x5478af(0x1c0)])(_0x3b19ac)[_0x5478af(0x191)]((0x0,moment_1[_0x5478af(0x1c0)])(_0x45c8b2),_0x5478af(0x1e8))>=0x1;return![];}async function handleVerifyTicketExpiration(){const _0x404c78=a346_0x4b1108;try{const _0x1e778b=await database_1['default']['query'](_0x404c78(0x1f2),{'type':sequelize_1[_0x404c78(0x18b)]['SELECT']});for(const _0x2d5bf9 of _0x1e778b){let _0xc36cc4={};_0x2d5bf9[_0x404c78(0x202)]===_0x404c78(0x200)&&(_0xc36cc4={'fromMe':!![]});if(_0x2d5bf9[_0x404c78(0x187)]>0x0&&_0x2d5bf9[_0x404c78(0x206)]){const _0x51d55e=_0x2d5bf9['expiresTicket']-_0x2d5bf9[_0x404c78(0x187)];if(_0x51d55e>0x0){const _0x3c5e51=await Ticket_1[_0x404c78(0x1c0)][_0x404c78(0x1aa)]({'where':{'status':_0x404c78(0x174),'whatsappId':_0x2d5bf9['id'],'companyId':_0x2d5bf9[_0x404c78(0x241)],'ticketsWithWarning':![],..._0xc36cc4,'updatedAt':{[sequelize_1['Op']['lt']]:(0x0,moment_1[_0x404c78(0x1c0)])()[_0x404c78(0x244)](_0x51d55e,_0x404c78(0x193))[_0x404c78(0x217)](),[sequelize_1['Op']['gt']]:(0x0,moment_1['default'])()[_0x404c78(0x244)](_0x2d5bf9[_0x404c78(0x16c)],'minutes')[_0x404c78(0x217)]()}},'include':[{'model':Contact_1[_0x404c78(0x1c0)],'as':'contact'}]});for(const _0x1ec37c of _0x3c5e51){try{await(0x0,SendWhatsAppMessage_1[_0x404c78(0x1c0)])({'ticket':_0x1ec37c,'body':_0x2d5bf9[_0x404c78(0x206)]}),await Ticket_1[_0x404c78(0x1c0)][_0x404c78(0x1cf)]({'ticketsWithWarning':!![]},{'where':{'id':_0x1ec37c['id']},'silent':!![]}),logger_1[_0x404c78(0x177)]['info'](_0x404c78(0x1c2)+_0x1ec37c['id']);}catch(_0x27c3fa){Sentry[_0x404c78(0x1b8)](_0x27c3fa),logger_1[_0x404c78(0x177)][_0x404c78(0x1ef)]('Erro\x20ao\x20enviar\x20aviso\x20de\x20inatividade:\x20'+_0x27c3fa[_0x404c78(0x1f5)]);}}}}const _0xc0b8b3=await Ticket_1['default'][_0x404c78(0x1aa)]({'where':{'status':'open','whatsappId':_0x2d5bf9['id'],'companyId':_0x2d5bf9[_0x404c78(0x241)],..._0xc36cc4,'updatedAt':{[sequelize_1['Op']['lt']]:(0x0,moment_1[_0x404c78(0x1c0)])()[_0x404c78(0x244)](_0x2d5bf9['expiresTicket'],_0x404c78(0x193))['toDate']()}},'include':[{'model':Contact_1[_0x404c78(0x1c0)],'as':'contact'}]});for(const _0x243a11 of _0xc0b8b3){try{_0x2d5bf9[_0x404c78(0x1d7)]&&(await(0x0,SendWhatsAppMessage_1[_0x404c78(0x1c0)])({'ticket':_0x243a11,'body':_0x2d5bf9['expiresInactiveMessage']}),await new Promise(_0x33b365=>setTimeout(_0x33b365,0x3e8)));await _0x243a11['update']({'status':_0x404c78(0x1b2),'amountUsedBotQueues':0x0,'ticketsWithWarning':![]});const _0x3392e0=(0x0,socket_1[_0x404c78(0x1a9)])();_0x3392e0['to'](_0x404c78(0x17f)+_0x243a11[_0x404c78(0x241)]+_0x404c78(0x19f))['to'](_0x404c78(0x1c1)+_0x243a11[_0x404c78(0x1b5)]+_0x404c78(0x19f))[_0x404c78(0x16f)](_0x404c78(0x17f)+_0x243a11['companyId']+_0x404c78(0x1d8),{'action':_0x404c78(0x1cf),'ticket':{..._0x243a11['dataValues'],'status':_0x404c78(0x1b2)}}),_0x3392e0['to'](_0x404c78(0x17f)+_0x243a11[_0x404c78(0x241)]+_0x404c78(0x232))['emit']('company-'+_0x243a11[_0x404c78(0x241)]+_0x404c78(0x1d8),{'action':_0x404c78(0x1cf),'ticket':{..._0x243a11[_0x404c78(0x18a)],'status':_0x404c78(0x1b2)}}),logger_1[_0x404c78(0x177)][_0x404c78(0x192)](_0x404c78(0x20b)+_0x243a11['id']+_0x404c78(0x1f4)+_0x2d5bf9[_0x404c78(0x16c)]+'\x20minutos.');}catch(_0x1ca95c){Sentry[_0x404c78(0x1b8)](_0x1ca95c),logger_1[_0x404c78(0x177)][_0x404c78(0x1ef)]({'error':_0x1ca95c},'Erro\x20ao\x20fechar\x20ticket\x20por\x20inatividade');}}_0xc0b8b3[_0x404c78(0x228)]>0x0&&logger_1[_0x404c78(0x177)][_0x404c78(0x192)](_0xc0b8b3['length']+_0x404c78(0x1fb)+_0x2d5bf9[_0x404c78(0x241)]);}}catch(_0x281a73){Sentry[_0x404c78(0x1b8)](_0x281a73),logger_1[_0x404c78(0x177)][_0x404c78(0x1ef)]({'error':_0x281a73},'TicketMonitor\x20->\x20VerifyTicketExpiration:\x20erro');}}function a346_0x5eaa(){const _0x268f60=['ticketInactiveWarningQueue','configurable','VerifyTicketExpiration','agent','call','whenExpireTicket','MessageQueue','confirmationRequestedAt','message5','inactiveMessage','Sleep\x20de\x20','2391rVuLIg','start','./services/WbotServices/SendWhatsAppMedia','Ticket\x20#','keys','select\x20id\x20from\x20\x22Users\x22\x20where\x20\x22updatedAt\x22\x20<\x20now()\x20-\x20\x275\x20minutes\x27::interval\x20and\x20online\x20=\x20true','contactId','push','TicketInactiveWarning','ERRO','seconds','resolve','toString','(((.+)+)+)+$','5qenfOT','toDate','confirmation','YYYY-MM-DD\x20HH:mm:ss','create','\x20AND\x20\x22dueDate\x22::text\x20LIKE\x20\x27','scheduleMonitor','prototype','0\x20*\x20*\x20*\x20*\x20*','isEmpty','./utils/logger','SELECT','-campaign','Iniciando\x20processamento\x20de\x20filas','number','Reiniciando\x20conexão\x20WhatsApp\x20','handleMessage','sendScheduledMessages','length','messageInterval','\x27,\x20','weeks','gte','Campanha\x20enviada\x20para\x20a\x20fila\x20de\x20processamento:\x20Campanha=','\x20segundos\x20finalizado:\x20','deliveredAt','ticketMonitor',';Registro=','-closed','handleWhatsappAutoRestart','message1','set','contactList','parseToMilliseconds','writable','planId','userMonitor','includes','period','startQueueProcess','defineProperty','MessageQueue\x20->\x20SendMessage:\x20error','asDays','companyId','lodash','\x27,\x20\x27open\x27,\x20\x27','subtract','confirmationMessage5','days','HH:mm:ss','scheduledAt','campaignId','./libs/socket','messageQueue','contact','body','whatsappId','UserMonitor','isNil','%\x27;','updatedAt','message3','./services/WbotServices/StartWhatsAppSession','semanalmente','expiresTicket','DispatchConfirmedCampaign','yyyy-MM-DD','emit','floor','REDIS_URI','removeWbot','bull','open','DD/MM/yyyy','Usuário\x20passado\x20para\x20offline:\x20','logger','lastRestartAt','Mensagem\x20agendada\x20enviada\x20para:\x20','./database','lte','mycount','./services/WbotServices/wbotMessageListener','valids','company-','value','longerIntervalAfter','SendScheduledMessage\x20->\x20SendMessage:\x20error','parse','name','findOrCreate','\x27,\x20\x27','inactiveMessageTime','variables','confirmationMessage1','dataValues','QueryTypes','REDIS_OPT_LIMITER_MAX','Erro\x20ao\x20tentar\x20consultar\x20agendamento:\x20','confirmationMessage2','2705815dupUVg','campaignQueue','diff','info','minutes','Campanha\x20enviada\x20para:\x20Campanha=','*\x20*\x20*\x20*\x20*','sequelize','confirmationMessage','SELECT\x20COUNT(*)\x20mycount\x20FROM\x20\x22Invoices\x22\x20WHERE\x20\x22companyId\x22\x20=\x20','@s.whatsapp.net','add','greaterInterval','./models/Contact','whatsappRestartQueue','__esModule','-open','./models/Company','*/5\x20*\x20*\x20*\x20*\x20*','query','Disparo\x20de\x20campanha\x20solicitado:\x20Campanha=','sleep','key','__createBinding','random','forEach','getIO','findAll','1192AbJTpW','*/20\x20*\x20*\x20*\x20*\x20*','email','./models/Campaign','contacts','createdAt','get','closed','CronJob','Verify','queueId','confirmationMessage3','./models/Schedule','captureException','process','env','StartWhatsAppSession','./services/WbotServices/SendWhatsAppMessage','data','confirmationMessage4','__setModuleDefault','default','queue-','Aviso\x20de\x20inatividade\x20enviado\x20para\x20o\x20ticket\x20#','TicketMonitor','./helpers/GetDefaultWhatsApp','CONNECTED','search','public','Registro\x20enviado\x20pra\x20fila\x20de\x20disparo:\x20Campanha=','whatsapp','getMessageOptions','format','replace','VerifyCampaignsDaatabase','2450208AmpeDF','update','ENVIADA','randomValue','./services/CampaignService/ShowService','./helpers/GetWhatsappWbot','Whatsapp\x20não\x20identificado','findByPk','@sentry/node','expiresInactiveMessage','-ticket','Campanhas\x20encontradas:\x20','\x20segundos\x20iniciado:\x20','./helpers/SendMessage','ProcessCampaign','0\x20*\x20*\x20*\x20*','Disparo\x20agendado\x20para:\x20','INSERT\x20INTO\x20\x22Invoices\x22\x20(detail,\x20status,\x20value,\x20\x22updatedAt\x22,\x20\x22createdAt\x22,\x20\x22dueDate\x22,\x20\x22companyId\x22)\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20VALUES\x20(\x27','getOwnPropertyNames','__importDefault','1854640LIPvNc','./models/CampaignSetting','{email}','message4','map','1230975RtoZko','months','__importStar','path','199148zdcnhA','SendMessage',';Delay=','completed','error','message2','shipping','SELECT\x20id,\x20\x22expiresTicket\x22,\x20\x22companyId\x22,\x20\x22whenExpireTicket\x22,\x0a\x20\x20\x20\x22expiresInactiveMessage\x22,\x20\x22inactiveMessage\x22,\x20\x22inactiveMessageTime\x22\x0a\x20\x20\x20FROM\x20\x22Whatsapps\x22\x20WHERE\x20\x22expiresTicket\x22\x20>\x200','SendSacheduledMessages','\x20fechado\x20por\x20inatividade\x20após\x20','message','10182304tNFhvN','9vczWXs','AutoRestart','cron','then','\x20tickets\x20fechados\x20por\x20inatividade\x20para\x20a\x20empresa\x20','DispatchCampaign'];a346_0x5eaa=function(){return _0x268f60;};return a346_0x5eaa();}exports['campaignQueue']=new bull_1[(a346_0x4b1108(0x1c0))]('CampaignQueue',connection);async function handleSendMessage(_0x2d000c){const _0x4d459f=a346_0x4b1108;try{const {data:_0x4f4788}=_0x2d000c,_0x54b173=await Whatsapp_1[_0x4d459f(0x1c0)][_0x4d459f(0x1d5)](_0x4f4788[_0x4d459f(0x24e)]);if(_0x54b173==null)throw Error(_0x4d459f(0x1d4));const _0x48962f=_0x4f4788['data'];await(0x0,SendMessage_1['SendMessage'])(_0x54b173,_0x48962f);}catch(_0x4e6ded){Sentry[_0x4d459f(0x1b8)](_0x4e6ded),logger_1[_0x4d459f(0x177)][_0x4d459f(0x1ef)]({'error':_0x4e6ded},_0x4d459f(0x23f));throw _0x4e6ded;}}async function handleVerifySchedules(){const _0x39babb=a346_0x4b1108;try{const {count:_0x590887,rows:_0x307ee2}=await Schedule_1['default']['findAndCountAll']({'where':{'status':'PENDENTE','sentAt':null,'sendAt':{[sequelize_1['Op'][_0x39babb(0x22c)]]:(0x0,moment_1[_0x39babb(0x1c0)])()['format'](_0x39babb(0x219)),[sequelize_1['Op'][_0x39babb(0x17b)]]:(0x0,moment_1['default'])()[_0x39babb(0x19a)]('30',_0x39babb(0x212))[_0x39babb(0x1cb)](_0x39babb(0x219))}},'include':[{'model':Contact_1[_0x39babb(0x1c0)],'as':_0x39babb(0x24c)}]});_0x590887>0x0&&_0x307ee2[_0x39babb(0x1e6)](async _0x4bdc22=>{const _0x4ceb2b=_0x39babb;await _0x4bdc22['update']({'status':'AGENDADA'}),exports[_0x4ceb2b(0x227)][_0x4ceb2b(0x19a)](_0x4ceb2b(0x1ec),{'schedule':_0x4bdc22},{'delay':0x9c40}),logger_1['logger'][_0x4ceb2b(0x192)](_0x4ceb2b(0x1de)+_0x4bdc22['contact'][_0x4ceb2b(0x184)]);});}catch(_0x1a8e97){Sentry['captureException'](_0x1a8e97),logger_1['logger']['error']({'error':_0x1a8e97},'SendScheduledMessage\x20->\x20Verify:\x20error');throw _0x1a8e97;}}async function handleSendScheduledMessage(_0x4e0003){const _0xd13a99=a346_0x4b1108,{data:{schedule:_0x3036ef}}=_0x4e0003;let _0x5c1ffd=null;try{_0x5c1ffd=await Schedule_1[_0xd13a99(0x1c0)]['findByPk'](_0x3036ef['id']);}catch(_0xa8f86e){Sentry['captureException'](_0xa8f86e),logger_1[_0xd13a99(0x177)][_0xd13a99(0x192)](_0xd13a99(0x18d)+_0x3036ef['id']);}try{const _0x9992f=await(0x0,GetDefaultWhatsApp_1['default'])(_0x3036ef[_0xd13a99(0x241)]),_0x54a915=await(0x0,SendMessage_1[_0xd13a99(0x1ec)])(_0x9992f,{'number':_0x3036ef[_0xd13a99(0x24c)][_0xd13a99(0x224)],'body':_0x3036ef[_0xd13a99(0x24d)]});_0x3036ef['saveMessage']&&(0x0,wbotMessageListener_1[_0xd13a99(0x226)])(_0x54a915,await(0x0,GetWhatsappWbot_1[_0xd13a99(0x1c0)])(_0x9992f),_0x3036ef[_0xd13a99(0x241)]),await _0x5c1ffd?.['update']({'sentAt':new Date(),'status':_0xd13a99(0x1d0)}),logger_1[_0xd13a99(0x177)][_0xd13a99(0x192)](_0xd13a99(0x179)+_0x3036ef['contact'][_0xd13a99(0x184)]),exports[_0xd13a99(0x227)]['clean'](0x3a98,_0xd13a99(0x1ee));}catch(_0x47c7d6){Sentry[_0xd13a99(0x1b8)](_0x47c7d6),await _0x5c1ffd?.['update']({'status':_0xd13a99(0x211)}),logger_1['logger'][_0xd13a99(0x1ef)]({'error':_0x47c7d6},_0xd13a99(0x182));throw _0x47c7d6;}}async function handleVerifyCampaigns(){const _0x2802fb=a346_0x4b1108,_0x3172b9=await database_1[_0x2802fb(0x1c0)][_0x2802fb(0x1a2)]('select\x20id,\x20\x22scheduledAt\x22\x20from\x20\x22Campaigns\x22\x20c\x0a\x20\x20\x20\x20where\x20\x22scheduledAt\x22\x20between\x20now()\x20and\x20now()\x20+\x20\x271\x20hour\x27::interval\x20and\x20status\x20=\x20\x27PROGRAMADA\x27',{'type':sequelize_1[_0x2802fb(0x18b)][_0x2802fb(0x221)]});_0x3172b9['length']&&logger_1[_0x2802fb(0x177)][_0x2802fb(0x192)](_0x2802fb(0x1d9)+_0x3172b9[_0x2802fb(0x228)]),_0x3172b9[_0x2802fb(0x1a8)](_0x1f5e1b=>{const _0x2cd68e=_0x2802fb;try{const _0x2880fb=(0x0,moment_1[_0x2cd68e(0x1c0)])(),_0x43000f=(0x0,moment_1[_0x2cd68e(0x1c0)])(_0x1f5e1b[_0x2cd68e(0x248)]),_0x554831=_0x43000f[_0x2cd68e(0x191)](_0x2880fb,'milliseconds');logger_1['logger']['info'](_0x2cd68e(0x22d)+_0x1f5e1b['id']+',\x20Delay\x20Inicial='+_0x554831),exports[_0x2cd68e(0x190)][_0x2cd68e(0x19a)]('ProcessCampaign',{'id':_0x1f5e1b['id'],'delay':_0x554831},{'removeOnComplete':!![]});}catch(_0x9acc68){Sentry[_0x2cd68e(0x1b8)](_0x9acc68);}});}async function getCampaign(_0x4d940b){const _0x59bc56=a346_0x4b1108;return Campaign_1['default'][_0x59bc56(0x1d5)](_0x4d940b,{'include':[{'model':ContactList_1[_0x59bc56(0x1c0)],'as':_0x59bc56(0x236),'attributes':['id',_0x59bc56(0x184)],'include':[{'model':ContactListItem_1[_0x59bc56(0x1c0)],'as':_0x59bc56(0x1af),'attributes':['id','name',_0x59bc56(0x224),_0x59bc56(0x1ad),'isWhatsappValid'],'where':{'isWhatsappValid':!![]}}]},{'model':Whatsapp_1['default'],'as':_0x59bc56(0x1c9),'attributes':['id',_0x59bc56(0x184)]},{'model':CampaignShipping_1[_0x59bc56(0x1c0)],'as':_0x59bc56(0x1f1),'include':[{'model':ContactListItem_1['default'],'as':_0x59bc56(0x24c)}]}]});}async function getSettings(_0x3bd51e){const _0x117b55=a346_0x4b1108,_0x1c72d8=await CampaignSetting_1[_0x117b55(0x1c0)][_0x117b55(0x1aa)]({'where':{'companyId':_0x3bd51e[_0x117b55(0x241)]},'attributes':[_0x117b55(0x1a5),'value']});let _0x168f5a=0x14,_0x5acce8=0x14,_0x290ea9=0x3c,_0x45a6ee=[];return _0x1c72d8[_0x117b55(0x1a8)](_0x3bc535=>{const _0x460440=_0x117b55;_0x3bc535[_0x460440(0x1a5)]==='messageInterval'&&(_0x168f5a=JSON[_0x460440(0x183)](_0x3bc535[_0x460440(0x180)])),_0x3bc535[_0x460440(0x1a5)]===_0x460440(0x181)&&(_0x5acce8=JSON[_0x460440(0x183)](_0x3bc535[_0x460440(0x180)])),_0x3bc535[_0x460440(0x1a5)]===_0x460440(0x19b)&&(_0x290ea9=JSON[_0x460440(0x183)](_0x3bc535[_0x460440(0x180)])),_0x3bc535[_0x460440(0x1a5)]===_0x460440(0x188)&&(_0x45a6ee=JSON[_0x460440(0x183)](_0x3bc535['value']));}),{'messageInterval':_0x168f5a,'longerIntervalAfter':_0x5acce8,'greaterInterval':_0x290ea9,'variables':_0x45a6ee};}function parseToMilliseconds(_0x4466d6){return _0x4466d6*0x3e8;}async function sleep(_0x570218){const _0x116761=a346_0x4b1108;return logger_1[_0x116761(0x177)]['info'](_0x116761(0x207)+_0x570218+_0x116761(0x1da)+(0x0,moment_1['default'])()[_0x116761(0x1cb)](_0x116761(0x247))),new Promise(_0xa63d9d=>{setTimeout(()=>{const _0xd2c659=a346_0x2427;logger_1[_0xd2c659(0x177)][_0xd2c659(0x192)](_0xd2c659(0x207)+_0x570218+_0xd2c659(0x22e)+(0x0,moment_1[_0xd2c659(0x1c0)])()[_0xd2c659(0x1cb)](_0xd2c659(0x247))),_0xa63d9d(!![]);},parseToMilliseconds(_0x570218));});}function getCampaignValidMessages(_0x20c399){const _0x18d3f3=a346_0x4b1108,_0x40ef27=[];return!(0x0,lodash_1['isEmpty'])(_0x20c399[_0x18d3f3(0x234)])&&!(0x0,lodash_1[_0x18d3f3(0x250)])(_0x20c399[_0x18d3f3(0x234)])&&_0x40ef27[_0x18d3f3(0x20f)](_0x20c399['message1']),!(0x0,lodash_1[_0x18d3f3(0x21f)])(_0x20c399[_0x18d3f3(0x1f0)])&&!(0x0,lodash_1[_0x18d3f3(0x250)])(_0x20c399[_0x18d3f3(0x1f0)])&&_0x40ef27[_0x18d3f3(0x20f)](_0x20c399[_0x18d3f3(0x1f0)]),!(0x0,lodash_1[_0x18d3f3(0x21f)])(_0x20c399['message3'])&&!(0x0,lodash_1['isNil'])(_0x20c399[_0x18d3f3(0x169)])&&_0x40ef27[_0x18d3f3(0x20f)](_0x20c399[_0x18d3f3(0x169)]),!(0x0,lodash_1['isEmpty'])(_0x20c399[_0x18d3f3(0x1e5)])&&!(0x0,lodash_1['isNil'])(_0x20c399['message4'])&&_0x40ef27[_0x18d3f3(0x20f)](_0x20c399[_0x18d3f3(0x1e5)]),!(0x0,lodash_1['isEmpty'])(_0x20c399[_0x18d3f3(0x205)])&&!(0x0,lodash_1[_0x18d3f3(0x250)])(_0x20c399[_0x18d3f3(0x205)])&&_0x40ef27['push'](_0x20c399[_0x18d3f3(0x205)]),_0x40ef27;}function getCampaignValidConfirmationMessages(_0x7ca9cc){const _0x1c4429=a346_0x4b1108,_0x1d6d5c=[];return!(0x0,lodash_1['isEmpty'])(_0x7ca9cc[_0x1c4429(0x189)])&&!(0x0,lodash_1[_0x1c4429(0x250)])(_0x7ca9cc[_0x1c4429(0x189)])&&_0x1d6d5c[_0x1c4429(0x20f)](_0x7ca9cc[_0x1c4429(0x189)]),!(0x0,lodash_1[_0x1c4429(0x21f)])(_0x7ca9cc[_0x1c4429(0x18e)])&&!(0x0,lodash_1[_0x1c4429(0x250)])(_0x7ca9cc[_0x1c4429(0x18e)])&&_0x1d6d5c[_0x1c4429(0x20f)](_0x7ca9cc[_0x1c4429(0x18e)]),!(0x0,lodash_1[_0x1c4429(0x21f)])(_0x7ca9cc[_0x1c4429(0x1b6)])&&!(0x0,lodash_1['isNil'])(_0x7ca9cc[_0x1c4429(0x1b6)])&&_0x1d6d5c[_0x1c4429(0x20f)](_0x7ca9cc['confirmationMessage3']),!(0x0,lodash_1[_0x1c4429(0x21f)])(_0x7ca9cc[_0x1c4429(0x1be)])&&!(0x0,lodash_1[_0x1c4429(0x250)])(_0x7ca9cc[_0x1c4429(0x1be)])&&_0x1d6d5c[_0x1c4429(0x20f)](_0x7ca9cc[_0x1c4429(0x1be)]),!(0x0,lodash_1['isEmpty'])(_0x7ca9cc[_0x1c4429(0x245)])&&!(0x0,lodash_1['isNil'])(_0x7ca9cc['confirmationMessage5'])&&_0x1d6d5c[_0x1c4429(0x20f)](_0x7ca9cc[_0x1c4429(0x245)]),_0x1d6d5c;}function getProcessedMessage(_0x32b094,_0x352fec,_0x43efd7){const _0x5bfa87=a346_0x4b1108;let _0x5abc14=_0x32b094;return _0x5abc14[_0x5bfa87(0x23b)]('{nome}')&&(_0x5abc14=_0x5abc14['replace'](/{nome}/g,_0x43efd7[_0x5bfa87(0x184)])),_0x5abc14[_0x5bfa87(0x23b)](_0x5bfa87(0x1e4))&&(_0x5abc14=_0x5abc14['replace'](/{email}/g,_0x43efd7['email'])),_0x5abc14['includes']('{numero}')&&(_0x5abc14=_0x5abc14[_0x5bfa87(0x1cc)](/{numero}/g,_0x43efd7[_0x5bfa87(0x224)])),_0x352fec[_0x5bfa87(0x1a8)](_0x2a9d43=>{const _0x5c9d2f=_0x5bfa87;if(_0x5abc14[_0x5c9d2f(0x23b)]('{'+_0x2a9d43[_0x5c9d2f(0x1a5)]+'}')){const _0x225a31=new RegExp('{'+_0x2a9d43['key']+'}','g');_0x5abc14=_0x5abc14[_0x5c9d2f(0x1cc)](_0x225a31,_0x2a9d43['value']);}}),_0x5abc14;}function randomValue(_0x12596c,_0x48c530){const _0x4fff17=a346_0x4b1108;return Math[_0x4fff17(0x170)](Math[_0x4fff17(0x1a7)]()*_0x48c530)+_0x12596c;}async function verifyAndFinalizeCampaign(_0x4c85fa){const _0x133d4e=a346_0x4b1108,_0x1cc7cd=await(0x0,ShowService_1[_0x133d4e(0x1c0)])(_0x4c85fa['id']);_0x1cc7cd[_0x133d4e(0x17e)]===_0x1cc7cd['delivered']&&await _0x4c85fa['update']({'status':'FINALIZADA','completedAt':(0x0,moment_1[_0x133d4e(0x1c0)])()});const _0x48dcbd=(0x0,socket_1[_0x133d4e(0x1a9)])();_0x48dcbd['emit'](_0x133d4e(0x17f)+_0x4c85fa[_0x133d4e(0x241)]+'-campaign',_0x1cc7cd);}async function prepareContact(_0x36caed,_0x4d0763,_0x48e81b,_0x3e4566,_0xb383ea,_0x3e884e){const _0x2a05ec=a346_0x4b1108,_0x43181c={};_0x43181c[_0x2a05ec(0x224)]=_0x48e81b[_0x2a05ec(0x224)],_0x43181c['contactId']=_0x48e81b['id'],_0x43181c[_0x2a05ec(0x249)]=_0x36caed['id'];if(_0xb383ea[_0x2a05ec(0x228)]){const _0x2e870e=randomValue(0x0,_0xb383ea[_0x2a05ec(0x228)]),_0x5d3b73=getProcessedMessage(_0xb383ea[_0x2e870e],_0x4d0763,_0x48e81b);_0x43181c[_0x2a05ec(0x1f5)]=''+_0x5d3b73;}if(_0x36caed['confirmation']){if(_0x3e884e[_0x2a05ec(0x228)]){const _0x2478bd=randomValue(0x0,_0x3e884e['length']),_0x199929=getProcessedMessage(_0x3e884e[_0x2478bd],_0x4d0763,_0x48e81b);_0x43181c[_0x2a05ec(0x197)]=''+_0x199929;}}const [_0x1c0a2f,_0x1eab0a]=await CampaignShipping_1[_0x2a05ec(0x1c0)][_0x2a05ec(0x185)]({'where':{'campaignId':_0x43181c[_0x2a05ec(0x249)],'contactId':_0x43181c[_0x2a05ec(0x20e)]},'defaults':_0x43181c});!_0x1eab0a&&_0x1c0a2f['deliveredAt']===null&&_0x1c0a2f[_0x2a05ec(0x204)]===null&&(_0x1c0a2f[_0x2a05ec(0x235)](_0x43181c),await _0x1c0a2f['save']());if(_0x1c0a2f[_0x2a05ec(0x22f)]===null&&_0x1c0a2f[_0x2a05ec(0x204)]===null){const _0x46ca62=await exports[_0x2a05ec(0x190)]['add'](_0x2a05ec(0x1fc),{'campaignId':_0x36caed['id'],'campaignShippingId':_0x1c0a2f['id'],'contactListItemId':_0x48e81b['id']},{'delay':_0x3e4566});await _0x1c0a2f[_0x2a05ec(0x1cf)]({'jobId':''+_0x46ca62['id']});}}async function handleProcessCampaign(_0x16037e){const _0x5271af=a346_0x4b1108;try{const {id:_0x23ce90}=_0x16037e['data'];let {delay:_0x335ccf}=_0x16037e[_0x5271af(0x1bd)];const _0x31b6dc=await getCampaign(_0x23ce90),_0x4ea4bd=await getSettings(_0x31b6dc);if(_0x31b6dc){const {contacts:_0x1e528d}=_0x31b6dc[_0x5271af(0x236)],_0x581e3f=getCampaignValidMessages(_0x31b6dc),_0x3a170c=_0x31b6dc['confirmation']?getCampaignValidConfirmationMessages(_0x31b6dc):null;if((0x0,lodash_1['isArray'])(_0x1e528d)){let _0x394e6a=0x0;_0x1e528d[_0x5271af(0x1a8)](_0x565db7=>{const _0x2e5a6e=_0x5271af;prepareContact(_0x31b6dc,_0x4ea4bd[_0x2e5a6e(0x188)],_0x565db7,_0x335ccf,_0x581e3f,_0x3a170c)[_0x2e5a6e(0x1fa)](()=>{const _0x2d1942=_0x2e5a6e;logger_1[_0x2d1942(0x177)][_0x2d1942(0x192)](_0x2d1942(0x1c8)+_0x31b6dc['id']+';Contato='+_0x565db7['name']+_0x2d1942(0x1ed)+_0x335ccf);}),_0x394e6a+=0x1,_0x394e6a%_0x4ea4bd[_0x2e5a6e(0x181)]===0x0?_0x335ccf+=parseToMilliseconds(_0x4ea4bd[_0x2e5a6e(0x19b)]):_0x335ccf+=parseToMilliseconds(randomValue(0x0,_0x4ea4bd[_0x2e5a6e(0x229)]));}),await _0x31b6dc[_0x5271af(0x1cf)]({'status':'EM_ANDAMENTO'});}}}catch(_0x38ead5){Sentry[_0x5271af(0x1b8)](_0x38ead5);}}async function handleDispatchCampaign(_0x4663aa){const _0x7c5a05=a346_0x4b1108;try{const {data:_0x5c28b8}=_0x4663aa,{campaignShippingId:_0x3b366e,campaignId:_0x563f19}=_0x5c28b8,_0xb2333f=await Campaign_1['default'][_0x7c5a05(0x1d5)](_0x563f19,{'include':[{'model':Whatsapp_1[_0x7c5a05(0x1c0)],'as':'whatsapp'}]});if(!_0xb2333f){logger_1[_0x7c5a05(0x177)][_0x7c5a05(0x1ef)]({'data':_0x5c28b8},'Campaign\x20not\x20found');return;}const _0x37af00=await(0x0,GetWhatsappWbot_1[_0x7c5a05(0x1c0)])(_0xb2333f['whatsapp']);logger_1['logger']['info'](_0x7c5a05(0x1a3)+_0x563f19+_0x7c5a05(0x231)+_0x3b366e);const _0x4027c0=await CampaignShipping_1[_0x7c5a05(0x1c0)][_0x7c5a05(0x1d5)](_0x3b366e,{'include':[{'model':ContactListItem_1['default'],'as':'contact'}]}),_0x2bfd08=_0x4027c0[_0x7c5a05(0x224)]+_0x7c5a05(0x199);if(_0xb2333f[_0x7c5a05(0x218)]&&_0x4027c0[_0x7c5a05(0x218)]===null)await _0x37af00['sendMessage'](_0x2bfd08,{'text':_0x4027c0['confirmationMessage']}),await _0x4027c0[_0x7c5a05(0x1cf)]({'confirmationRequestedAt':(0x0,moment_1['default'])()});else{await _0x37af00['sendMessage'](_0x2bfd08,{'text':_0x4027c0[_0x7c5a05(0x1f5)]});if(_0xb2333f['mediaPath']){const _0x488f94=path_1[_0x7c5a05(0x1c0)][_0x7c5a05(0x213)](_0x7c5a05(0x1c7),_0xb2333f['mediaPath']),_0x5d2cee=await(0x0,SendWhatsAppMedia_1[_0x7c5a05(0x1ca)])(_0xb2333f['mediaName'],_0x488f94);Object[_0x7c5a05(0x20c)](_0x5d2cee)[_0x7c5a05(0x228)]&&await _0x37af00['sendMessage'](_0x2bfd08,{..._0x5d2cee});}await _0x4027c0['update']({'deliveredAt':(0x0,moment_1[_0x7c5a05(0x1c0)])()});}await verifyAndFinalizeCampaign(_0xb2333f);const _0x4c263b=(0x0,socket_1[_0x7c5a05(0x1a9)])();_0x4c263b[_0x7c5a05(0x16f)](_0x7c5a05(0x17f)+_0xb2333f[_0x7c5a05(0x241)]+_0x7c5a05(0x222),{'action':_0x7c5a05(0x1cf),'record':_0xb2333f}),logger_1['logger'][_0x7c5a05(0x192)](_0x7c5a05(0x194)+_0x563f19+';Contato='+_0x4027c0['contact'][_0x7c5a05(0x184)]);}catch(_0x43d3bc){Sentry[_0x7c5a05(0x1b8)](_0x43d3bc),logger_1[_0x7c5a05(0x177)][_0x7c5a05(0x1ef)](_0x43d3bc[_0x7c5a05(0x1f5)]);}}async function handleLoginStatus(){const _0xe78a27=a346_0x4b1108,_0x494d17=await database_1[_0xe78a27(0x1c0)][_0xe78a27(0x1a2)](_0xe78a27(0x20d),{'type':sequelize_1[_0xe78a27(0x18b)][_0xe78a27(0x221)]});_0x494d17[_0xe78a27(0x1a8)](async _0x33d1da=>{const _0x169eb1=_0xe78a27;try{const _0x9b15d=await User_1[_0x169eb1(0x1c0)]['findByPk'](_0x33d1da['id']);await _0x9b15d[_0x169eb1(0x1cf)]({'online':![]}),logger_1[_0x169eb1(0x177)][_0x169eb1(0x192)](_0x169eb1(0x176)+_0x33d1da['id']);}catch(_0x10bf73){Sentry[_0x169eb1(0x1b8)](_0x10bf73);}});}async function handleInvoiceCreate(){const _0x4ffdc0=a346_0x4b1108,_0x4928c3=new cron_1[(_0x4ffdc0(0x1b3))](_0x4ffdc0(0x21e),async()=>{const _0x2326d8=_0x4ffdc0,_0x56661d=await Company_1[_0x2326d8(0x1c0)][_0x2326d8(0x1aa)]();_0x56661d['map'](async _0x39279c=>{const _0x535ee3=_0x2326d8,{dueDate:_0x56e378}=_0x39279c,_0x3857ae=(0x0,moment_1['default'])(_0x56e378)[_0x535ee3(0x1cb)](),_0x1aff4b=(0x0,moment_1[_0x535ee3(0x1c0)])()[_0x535ee3(0x1cb)](),_0x3b9269=(0x0,moment_1['default'])((0x0,moment_1[_0x535ee3(0x1c0)])())[_0x535ee3(0x1cb)](_0x535ee3(0x175)),_0x28db38=(0x0,moment_1[_0x535ee3(0x1c0)])(_0x56e378)[_0x535ee3(0x1cb)](_0x535ee3(0x175)),_0x5d28f1=(0x0,moment_1[_0x535ee3(0x1c0)])(_0x28db38,_0x535ee3(0x175))[_0x535ee3(0x191)]((0x0,moment_1[_0x535ee3(0x1c0)])(_0x3b9269,_0x535ee3(0x175))),_0x3c642d=moment_1[_0x535ee3(0x1c0)]['duration'](_0x5d28f1)[_0x535ee3(0x240)]();if(_0x3c642d<0x14){const _0x14277c=await Plan_1[_0x535ee3(0x1c0)]['findByPk'](_0x39279c[_0x535ee3(0x239)]),_0xeb3d7f=_0x535ee3(0x198)+_0x39279c['id']+_0x535ee3(0x21b)+(0x0,moment_1['default'])(_0x56e378)[_0x535ee3(0x1cb)](_0x535ee3(0x16e))+_0x535ee3(0x167),_0x363cc1=await database_1[_0x535ee3(0x1c0)][_0x535ee3(0x1a2)](_0xeb3d7f,{'type':sequelize_1[_0x535ee3(0x18b)][_0x535ee3(0x221)]});if(+_0x363cc1[0x0][_0x535ee3(0x17c)]===0x0){const _0x40dfb1=_0x535ee3(0x1df)+_0x14277c[_0x535ee3(0x184)]+_0x535ee3(0x243)+_0x14277c[_0x535ee3(0x180)]+_0x535ee3(0x186)+_0x1aff4b+_0x535ee3(0x186)+_0x1aff4b+_0x535ee3(0x186)+_0x3857ae+_0x535ee3(0x22a)+_0x39279c['id']+');';await database_1[_0x535ee3(0x1c0)][_0x535ee3(0x1a2)](_0x40dfb1,{'type':sequelize_1[_0x535ee3(0x18b)]['INSERT']});}}});});_0x4928c3[_0x4ffdc0(0x209)]();}handleInvoiceCreate();async function startQueueProcess(){const _0x5f1039=a346_0x4b1108;logger_1[_0x5f1039(0x177)][_0x5f1039(0x192)](_0x5f1039(0x223)),exports[_0x5f1039(0x24b)][_0x5f1039(0x1b9)](_0x5f1039(0x1ec),handleSendMessage),exports[_0x5f1039(0x21c)]['process'](_0x5f1039(0x1b4),handleVerifySchedules),exports[_0x5f1039(0x227)][_0x5f1039(0x1b9)](_0x5f1039(0x1ec),handleSendScheduledMessage),exports[_0x5f1039(0x190)][_0x5f1039(0x1b9)](_0x5f1039(0x1cd),handleVerifyCampaigns),exports[_0x5f1039(0x190)][_0x5f1039(0x1b9)](_0x5f1039(0x1dc),handleProcessCampaign),exports[_0x5f1039(0x190)][_0x5f1039(0x1b9)](_0x5f1039(0x1fc),handleDispatchCampaign),exports[_0x5f1039(0x23a)][_0x5f1039(0x1b9)]('VerifyLoginStatus',handleLoginStatus),exports[_0x5f1039(0x190)][_0x5f1039(0x1b9)](_0x5f1039(0x16d),handleDispatchCampaign),exports['ticketMonitor'][_0x5f1039(0x1b9)](_0x5f1039(0x1ff),handleVerifyTicketExpiration),exports['whatsappRestartQueue'][_0x5f1039(0x1b9)](_0x5f1039(0x1f8),handleWhatsappAutoRestart),exports[_0x5f1039(0x21c)][_0x5f1039(0x19a)](_0x5f1039(0x1b4),{},{'repeat':{'cron':_0x5f1039(0x1a1)},'removeOnComplete':!![]}),exports[_0x5f1039(0x190)][_0x5f1039(0x19a)](_0x5f1039(0x1cd),{},{'repeat':{'cron':_0x5f1039(0x1ac)},'removeOnComplete':!![]}),exports[_0x5f1039(0x23a)][_0x5f1039(0x19a)]('VerifyLoginStatus',{},{'repeat':{'cron':'*\x20*\x20*\x20*\x20*'},'removeOnComplete':!![]}),exports[_0x5f1039(0x230)][_0x5f1039(0x19a)](_0x5f1039(0x1ff),{},{'repeat':{'cron':_0x5f1039(0x195)},'removeOnComplete':!![]}),exports[_0x5f1039(0x19d)][_0x5f1039(0x19a)](_0x5f1039(0x1f8),{},{'repeat':{'cron':_0x5f1039(0x1dd)},'removeOnComplete':!![]});}